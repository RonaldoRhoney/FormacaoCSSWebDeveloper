'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1105:function(x,G,a){a.d(G,"a",function(){return A});var c=a(69);x=a(0);var b=a(253),f=a(257),e=a(252),h=a(292),u=a(350),m=a(264),n=a(256),l=a(708),r=a(897),w=a(414),y=a(491),z=a(417);class A{constructor(B,H,v,C,F,D,N,U){this.LD=B;this.pa=H;this.hh=v;this.sha=C;this.Ia=F;this.BH=D;this.xH=N;this.v1=U;this.select=({scope:W,text:L,index:O})=>Object(c.b)(this,void 0,void 0,function*(){var M=[];let K=[];var P=null!==
W&&void 0!==W?W:"Selection";if("Selection"===P){var V=this.pa.Ua.mb;V?(V=V.toArray().filter(Y=>b.ParagraphReader.me(Y.node)),0<V.length?M.push(...V):(V=this.pa.ud(),0<V.length&&this.v1.K5b(12,V,M))):(V=this.pa.mg(),this.v1.Hta(12,V,M));0!==M.length||W||(P="Presentation")}if(Array.isArray(P)&&0<P.length&&P[0]instanceof w.a)this.v1.Hta(12,P,M);else if(Array.isArray(P)&&0<P.length&&P[0]instanceof r.a)this.v1.K5b(12,P,M);else if("Presentation"===P&&this.Hd){P=this.Hd.Sy.presentation.slides;if(null===
P)throw Error("Could not cast from ISlide to ISlide on presentation slides.");this.v1.Hta(12,P,M)}if(L)for(const Y of M){M=b.ParagraphReader.text(Y.node);M=this.matchAll(M,L);for(const ta of M)ta[0]&&void 0!==ta.index&&(M=ta.index,P=ta.index+ta[0].length,V=m.a.yj(Y.node,M),this.xH.fZc(V),V=m.a.yj(Y.node,P+1),this.xH.fZc(V),K.push(m.a.createTextRange(Y.node,M,P)))}else K=M;if("number"===typeof O){0>O&&(O=K.length+O);if(0<=O&&O<K.length)return[K[O]];throw Error.argumentOutOfRange("index");}return K});
this.bQg=(W,L)=>{const O=new e.GraphIterator;O.set(W);O.pc(11);O.ug(11);W=W.gg.dv(O);const M=L?1:16;L=L?1:0;W?W.oda(M,L):(L=u.a.JK(M,L),this.BH.isa(O,L))};this.MQg=(W,L)=>{switch(L){case "Left":L=1;break;case "Center":L=2;break;case "Right":L=3;break;case "Distributed":L=7;break;case "Justify":L=6;break;default:L=1}this.sha.zG(W,L)};this.mSg=(W,L)=>{if(W=this.Ia.ln(W)){switch(L){case "Top":L=0;break;case "Middle":L=1;break;case "Bottom":L=2;break;default:L=0}W.setValue(n.a.kL,L)}};this.format=({textRanges:W,
color:L,bold:O,italic:M,underline:K,fontName:P,size:V,bulleted:Y,horizontalAlignment:ta,verticalAlignment:fa})=>Object(c.b)(this,void 0,void 0,function*(){if(!W)throw Error.argumentNull("textRanges");const Ta=[];if(W&&0<W.length){for(const qa of W){var ha=[];if(qa.contextId===f.a.paragraph){const ra=h.a.lCe(qa.node,!1);for(const I of ra)ha.push(I.formatting)}else ha.push(h.a.xs(qa));for(const ra of ha)ra&&(L&&(ha=y.a.V7(L),L=""===ha?L:ha,this.hh.kp(ra,L,null)),void 0!==O&&this.hh.OE(ra,O),void 0!==
M&&this.hh.setItalic(ra,M),K&&this.hh.OP(ra,"None"!==K),P&&this.hh.MP(ra,P),void 0!==V&&this.hh.Mo(ra,2*V),void 0!==Y&&this.bQg(qa.node,Y),ta&&this.MQg(qa.node,ta),fa&&this.mSg(qa.node,fa));Ta.push(new Promise(ra=>z.a.GJ(ra,qa.node).bind(this)))}yield Promise.all(Ta)}});this.FLg=(W,L)=>Object(c.b)(this,void 0,void 0,function*(){const O=(new DOMParser).parseFromString(L,"text/html");if(0<O.body.innerHTML.trim().length)return W.Ebb=O.body.innerHTML.trim(),new Promise(M=>z.a.GJ(M,W).bind(this))});this.insert=
({precededBy:W,text:L})=>Object(c.b)(this,void 0,void 0,function*(){if(!W)throw Error.argumentNull("precededBy");const O=[];for(var M of W){var K=M.node,P=-1===M.Ib?K.characterData.length:M.Ib+1;P=M.contextId===f.a.ng?M:m.a.yj(K,P);this.xH.replaceTextRange(P,L,!0);K=m.a.createTextRange(K,M.Ib+1,M.Ib+L.length);O.push(K)}M=[];for(const V of O)M.push(new Promise(Y=>z.a.GJ(Y,V).bind(this)));return Promise.all(M)});this.delete=({textRanges:W})=>Object(c.b)(this,void 0,void 0,function*(){if(!W)throw Error.argumentNull("textRanges");
const L=[],O=[];for(let M of W){M.node instanceof l.a&&M.contextId!==f.a.textRange&&(M=m.a.createTextRange(M.node,0,M.node.characterData.length));this.xH.replaceTextRange(M,"",!0);const K=m.a.yj(M.node,M.Va);L.push(K);O.push(new Promise(P=>z.a.GJ(P,M.node).bind(this)))}yield Promise.all(O);return 0===L.length?[]:[L[0]]});if(!B)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!H)throw Error.argumentNull("m_selectionManager");if(!v)throw Error.argumentNull("m_formattingEditor");if(!C)throw Error.argumentNull("m_paragraphEditor");
if(!F)throw Error.argumentNull("m_shapeReader");if(!D)throw Error.argumentNull("m_listEditor");if(!N)throw Error.argumentNull("m_characterPropertiesEditor");if(!U)throw Error.argumentNull("m_odslGraphUtils");this.LD&&this.LD.execute(W=>{this.Hd=W})}matchAll(B,H){H=H instanceof RegExp?H:new RegExp(H,"g");const v=[];let C;for(;null!==(C=H.exec(B));)v.push(C);return v}}Object(x.a)(A,"ODSLText",null,[852])},1106:function(x,G,a){a.d(G,"a",function(){return F});var c=a(69);x=a(0);var b=a(719),f=a(1580),
e=a(1506),h=a(19),u=a(231),m=a(414),n=a(278),l=a(274),r=a(493),w=a(661),y=a(260),z=a(302),A=a(831),B=a(662),H=a(357),v=a(491),C=a(417);class F{constructor(D,N,U,W,L,O,M,K,P,V,Y){this.LD=D;this.pa=N;this.kj=U;this.HBb=W;this.jza=L;this.Ia=O;this.Qk=M;this.ij=K;this.xb=P;this.Xn=V;this.yv=Y;this.a3a=this.Toa=0;this.N5b=(ta,fa)=>{for(const Ta of ta)fa.push(...Ta.xj())};this.select=({scope:ta,name:fa,index:Ta=-1})=>Object(c.b)(this,void 0,void 0,function*(){const ha=[],qa=[];var ra=null!==ta&&void 0!==
ta?ta:"Selection";if("Selection"===ra){const I=this.pa.ud();0<I.length?ha.push(...I):this.N5b(this.pa.mg(),ha);0!==ha.length||ta||(ra="Presentation")}if("Presentation"===ra&&this.Hd){ra=this.Hd.Sy.presentation.slides;if(null===ra)throw Error("Could not cast from ISlide to ISlide on presentation slides.");this.N5b(ra,ha)}else Array.isArray(ra)&&0<ra.length&&ra[0]instanceof m.a&&this.N5b(ra,ha);if(fa)for(const I of ha)I.shapeName===fa&&qa.push(I);else qa.push(...ha);if("number"===typeof Ta){0>Ta&&(Ta=
qa.length+Ta);if(0<=Ta&&Ta<qa.length)return[qa[Ta]];throw Error.argumentOutOfRange("index");}return qa});this.format=({shapes:ta,left:fa,top:Ta,height:ha,width:qa,lineColor:ra,lineDashStyle:I,lineWeight:ba,lineTransparency:Ga,fillColor:Oa,fillTransparency:Ja})=>Object(c.b)(this,void 0,void 0,function*(){if(!ta)throw Error.argumentNull("shapes");if(ta&&0<ta.length){const Pa=[];for(const ja of ta){void 0!==fa&&(ja.hx=fa);void 0!==Ta&&(ja.ix=Ta);void 0!==ha&&(ja.Ez=ha);void 0!==qa&&(ja.Tv=qa);if(ra){var Qa=
v.a.V7(ra);ra=""===Qa?ra:Qa;Qa=H.a.parse(ra);ja.j7=JSON.stringify(Qa)}if(I)switch(I){case "Dash":ja.rz=0;break;case "DashDot":ja.rz=1;break;case "DashDotDot":ja.rz=2;break;case "LongDash":ja.rz=3;break;case "LongDashDot":ja.rz=4;break;case "RoundDot":ja.rz=5;break;case "Solid":ja.rz=6;break;case "SquareDot":ja.rz=7;break;case "LongDashDotDot":ja.rz=8;break;case "SystemDash":ja.rz=9;break;case "SystemDot":ja.rz=10;break;case "SystemDashDot":ja.rz=11;break;default:ja.rz=6}void 0!==ba&&(ja.outlineWidth=
ba);void 0!==Ga&&(Qa=H.a.parse(ja.j7),Qa.Alpha=100*Ga,ja.j7=JSON.stringify(Qa));Oa&&(Oa=""===v.a.V7(Oa)?Oa:v.a.V7(Oa),Qa=H.a.parse(Oa),ja.s2=JSON.stringify(Qa));void 0!==Ja&&(Qa=H.a.parse(ja.s2),Qa.Alpha=100*Ja,ja.s2=JSON.stringify(Qa));Pa.push(new Promise(va=>C.a.GJ(va,ja).bind(this)))}yield Promise.all(Pa)}});this.insert=({slides:ta,shapeType:fa})=>{if(!ta)throw Error.argumentNull("slides");if(!this.Hd)throw Error("Cannot insert shapes without appForOfficeManager instance.");const Ta=[];for(const Oa of ta){ta=
Oa;if(!ta)throw Error("Cannot find selected slide to insert shape.");const Ja=ta.Xb;if(n.a.Ax(Ja))throw Error("Cannot insert on fake slide node.");const Qa=this.aKa(fa);if(!Qa)throw Error("Could not load props for shapeType.");if(!this.kj.zC(ta,1))throw this.kj.dI(ta),Error("Too many shapes on the slide.");const Pa=this.HBb.zE;var ha=ta.Oe.HasDefaultShape,qa=ta.Oe.HasDefaultLine,ra=95===Qa.PP||97===Qa.PP||Array.contains(w.a.Hbc,Qa.PP);qa=qa&&ra;ha=ha&&!ra;this.y7(0);var I=void 0;let ja,va;var ba=
this.Hd.Sy.presentation.slideWidth,Ga=this.Hd.Sy.presentation.slideHeight;I=new l.a((ba-Qa.width*b.a.ay)/2,(Ga-Qa.height*b.a.ay)/2);ra=I.x+f.a.vf(this.OD*r.a.pJ,e.a.horizontal);va=I.y+f.a.vf(this.OD*r.a.pJ,e.a.vertical);Pa?(I=Qa.width*b.a.ay,ja=Qa.height*b.a.ay):(I=f.a.vf(F.y9a,e.a.horizontal),ja=f.a.vf(F.x9a,e.a.vertical),ra=ba/2-f.a.vf(F.y9a/2-this.OD*r.a.pJ,e.a.horizontal),va=Ga/2-f.a.vf(F.x9a/2-this.OD*r.a.pJ,e.a.vertical));this.OD++;this.OD>this.Toa&&(this.OD=this.a3a);ba=ta.Ju();Ga=Object(u.a)(278,
this.Hd.Sy.Ga.Qg(this.xb.Oa));y.a.Ab&&(qa||ha)&&y.a.Ab.Ya(z.a.lEd,qa?"HasDefaultLine":"HasDefaultShape");let Ha=null;Ha=!Pa||"TextBox"===fa||ha||qa?this.Qk.QDa(!1,Ja.cid,Ja.sid,0,Qa.shapeType,ra,va,I,ja,ba+1):w.a.HMb(Ja,Qa,Ga.WK,null,new A.a,ra,va,I,ja,ba,this.Ia,this.Qk,this.xb,this.Hd.Sy,this.ij);this.Xn.WM([Ha],ta,null);this.yv.zI=Ha;this.Dxb();Ta.push(Ha)}fa=[];for(const Oa of Ta)fa.push(new Promise(Ja=>C.a.GJ(Ja,Oa).bind(this)));return Promise.all(fa)};this.delete=({shapes:ta})=>Object(c.b)(this,
void 0,void 0,function*(){if(!ta)throw Error.argumentNull("shapes");for(const fa of ta)this.Qk.mNb(fa);return new Promise(fa=>C.a.GJ(fa,this.Hd.Sy.Ga).bind(this))});if(!D)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!N)throw Error.argumentNull("m_selectionManager");if(!U)throw Error.argumentNull("m_shapeCountValidator");if(!W)throw Error.argumentNull("m_shapeSVGDependencyLoader");this.LD&&this.LD.execute(ta=>{this.Hd=ta});this.OD=0}y7(D){this.jza.yfd(D)}Dxb(){const D=h.a.instance.Na("Common.ISystemInitiatedFeedback");
D&&D.execute(N=>{N.logActivity("InsertShapeActivity",null)})}aKa(D){switch(D){case "Textbox":return new B.a(34,16,.5,3);case "Ellipse":return new B.a(34,9,1,1);case "Triangle":return new B.a(2,17,1,1.16);case "RightTriangle":return new B.a(3,55,1,1);case "Parallelogram":return new B.a(6,56,1,1.33);case "Trapezoid":return new B.a(7,57,1.33,1);case "Diamond":return new B.a(5,58,1,1);case "SPentagon":return new B.a(9,59,1,1.05);case "Hexagon":return new B.a(10,60,1,1.16);case "Heptagon":return new B.a(11,
61,1,1);case "Octagon":return new B.a(12,62,1,1);case "Decagon":return new B.a(13,63,1,1);case "Dodecagon":return new B.a(14,64,1,1);case "Pie":return new B.a(39,65,1,1);case "Chord":return new B.a(87,66,1,1);case "Teardrop":return new B.a(35,67,1,1);case "Frame":return new B.a(83,68,1,1);case "HalfFrame":return new B.a(84,69,1,1);case "LShape":return new B.a(85,70,1,1);case "DiagonalStripe":return new B.a(86,71,1,1);case "Cross":return new B.a(130,72,1,1);case "Plaque":return new B.a(33,73,1,1);
case "Can":return new B.a(73,7,1.33,1);case "Cube":return new B.a(72,8,1.33,1.33);case "Bevel":return new B.a(82,74,1.14,1.14);case "Donut":return new B.a(41,75,1,1);case "NoSymbol":return new B.a(42,76,1,1);case "BlockArc":return new B.a(40,77,1,1);case "FoldedCorner":return new B.a(81,78,1,1);case "SmileyFace":return new B.a(78,79,1,1);case "Heart":return new B.a(75,18,1,1);case "LightningBolt":return new B.a(74,80,1,1);case "Sun":return new B.a(76,81,1,1);case "Moon":return new B.a(77,82,1,.5);
case "Cloud":return new B.a(120,83,1,1);case "Arc":return new B.a(88,84,1,1);case "DoubleBracket":return new B.a(93,85,1,1);case "DoubleBrace":return new B.a(94,86,1,1.17);case "LeftBracket":return new B.a(89,87,1,.08);case "RightBracket":return new B.a(90,88,1,.08);case "LeftBrace":return new B.a(91,89,1,.17);case "RightBrace":return new B.a(92,90,1,.17);case "MathPlus":return new B.a(175,19,1,1);case "MathMinus":return new B.a(176,20,1,1);case "MathMultiply":return new B.a(177,21,1,1);case "MathDivide":return new B.a(178,
22,1,1);case "MathEqual":return new B.a(179,23,1,1);case "MathNotEqual":return new B.a(180,24,1,1);case "StraightConnector":return new B.a(95,12,1,1);case "StraightConnectorArrow":return new B.a(95,13,1,1);case "StraightConnectorTwoArrow":return new B.a(95,14,1,1);case "ElbowConnector":return new B.a(97,26,1,1);case "ElbowArrowConnector":return new B.a(97,155,1,1);case "ElbowDoubleArrowConnector":return new B.a(97,156,1,1);case "CurvedConnector":return new B.a(101,25,1,1);case "CurvedArrowConnector":return new B.a(101,
153,1,1);case "CurvedDoubleArrowConnector":return new B.a(101,154,1,1);case "DownArrow":return new B.a(46,0,1.07,.53);case "LeftArrow":return new B.a(44,1,.53,1.07);case "LeftRightArrow":return new B.a(50,2,.53,1.33);case "RightArrow":return new B.a(43,3,.53,1.07);case "UpArrow":return new B.a(45,4,1.07,.53);case "UpDownArrow":return new B.a(51,5,1.33,.53);case "LeftRightUpArrow":return new B.a(53,27,.93,1.33);case "BentArrow":return new B.a(62,28,.95,.89);case "UTurnArrow":return new B.a(63,29,.96,
.97);case "LeftUpArrow":return new B.a(52,30,.93,.93);case "BentUpArrow":return new B.a(49,31,.8,.93);case "CurvedRightArrow":return new B.a(67,32,1.33,.8);case "CurvedLeftArrow":return new B.a(68,33,1.33,.8);case "CurvedUpArrow":return new B.a(69,34,.8,1.33);case "CurvedDownArrow":return new B.a(70,46,.8,1.33);case "StripedRightArrow":return new B.a(47,35,.53,1.07);case "NotchedRightArrow":return new B.a(48,36,.53,1.07);case "Pentagon":return new B.a(36,37,.53,1.07);case "Chevron":return new B.a(37,
38,.53,.53);case "RightArrowCallout":return new B.a(56,39,1,1);case "DownArrowCallout":return new B.a(58,40,1,1);case "LeftArrowCallout":return new B.a(55,41,1,1);case "UpArrowCallout":return new B.a(57,42,1,1);case "LeftRightArrowCallout":return new B.a(59,43,.63,1.33);case "QuadArrowCallout":return new B.a(61,44,1.33,1.33);case "CircularArrow":return new B.a(64,45,1.07,1.07);case "QuadArrow":return new B.a(54,47,1.33,1.33);case "Rectangle":return new B.a(4,10,1,1);case "RoundedRectangle":return new B.a(25,
11,1,1);case "RoundDiagonalCornerRectangle":return new B.a(28,48,1,1);case "RoundSameSideCornerRectangle":return new B.a(27,49,1,1);case "RoundSingleCornerRectangle":return new B.a(26,50,1,1);case "SnipRoundSingleCornerRectangle":return new B.a(29,51,1,1);case "SnipDiagonalCornerRectangle":return new B.a(32,52,1,1);case "SnipSameSideCornerRectangle":return new B.a(31,53,1,1);case "SnipSingleCornerRectangle":return new B.a(30,54,1,1);case "RectangularCallout":return new B.a(116,91,.67,1);case "RoundedRectangleCallout":return new B.a(117,
6,.67,1);case "OvalCallout":return new B.a(118,92,.67,1);case "CloudCallout":return new B.a(119,93,.67,1);case "LineCallout1":return new B.a(104,94,.67,1);case "LineCallout2":return new B.a(105,95,.67,1);case "LineCallout3":return new B.a(106,96,.67,1);case "LineCallout1Accent":return new B.a(107,97,.67,1);case "LineCallout2Accent":return new B.a(108,98,.67,1);case "LineCallout3Accent":return new B.a(109,99,.67,1);case "LineCallout1BorderAccent":return new B.a(110,100,.67,1);case "LineCallout2BorderAccent":return new B.a(111,
101,.67,1);case "LineCallout3BorderAccent":return new B.a(112,102,.67,1);case "LineCallout1NoBorder":return new B.a(113,103,.67,1);case "LineCallout2NoBorder":return new B.a(114,104,.67,1);case "LineCallout3NoBorder":return new B.a(115,105,.67,1);case "Explosion1":return new B.a(79,106,1,1);case "Explosion2":return new B.a(80,107,1,1);case "Star4":return new B.a(15,108,1,1);case "Star5":return new B.a(16,15,1,1);case "Star6":return new B.a(17,109,1,1);case "Star7":return new B.a(18,110,1,1);case "Star8":return new B.a(19,
111,1,1);case "Star10":return new B.a(20,112,1,1);case "Star12":return new B.a(21,113,1,1);case "Star16":return new B.a(22,114,1,1);case "Star24":return new B.a(23,115,1,1);case "Star32":return new B.a(24,116,1,1);case "UpRibbon":return new B.a(122,117,.67,1.33);case "DownRibbon":return new B.a(121,118,.67,1.33);case "CurvedUpRibbon":return new B.a(124,119,.83,1.33);case "CurvedDownRibbon":return new B.a(123,120,.83,1.33);case "VerticalScroll":return new B.a(126,121,1.25,1.13);case "HorizontalScroll":return new B.a(127,
122,1.13,1.25);case "Wave":return new B.a(128,123,1,1);case "DoubleWave":return new B.a(129,124,1,1);case "Process":return new B.a(131,125,.67,1);case "AlternateProcess":return new B.a(158,126,.67,1);case "Decision":return new B.a(132,127,.67,1);case "Data":return new B.a(133,128,.67,1);case "PredefinedProcess":return new B.a(134,129,.67,1);case "InternalStorage":return new B.a(135,130,.67,.67);case "Document":return new B.a(136,131,.67,1);case "Multidocument":return new B.a(137,132,.83,1.16);case "Terminator":return new B.a(138,
133,.33,1);case "Preparation":return new B.a(139,134,.67,1.16);case "ManualInput":return new B.a(140,135,.5,1);case "ManualOperation":return new B.a(141,136,.67,1);case "Connector":return new B.a(142,137,.5,.5);case "OffpageConnector":return new B.a(159,138,.67,.67);case "Card":return new B.a(143,139,.88,1);case "PunchedTape":return new B.a(144,140,.88,1);case "SummingJunction":return new B.a(145,141,.67,.67);case "Or":return new B.a(146,142,.67,.67);case "Collate":return new B.a(147,143,1,.5);case "Sort":return new B.a(148,
144,1,.5);case "Extract":return new B.a(149,145,.75,.75);case "Merge":return new B.a(150,146,.75,.75);case "StoredData":return new B.a(152,147,.67,1);case "Delay":return new B.a(157,148,.67,.67);case "SequentialActionStorage":return new B.a(153,149,.67,.67);case "MagneticDisk":return new B.a(154,150,.67,1);case "DirectAccessStorage":return new B.a(155,151,.75,1);case "Display":return new B.a(156,152,.67,1);default:return null}}}F.y9a=110;F.x9a=75;Object(x.a)(F,"ODSLShape",null,[852])},1107:function(x,
G,a){a.d(G,"a",function(){return u});var c=a(69);x=a(0);var b=a(231),f=a(414),e=a(595),h=a(417);class u{constructor(m,n,l,r){this.LD=m;this.pa=n;this.hf=l;this.aq=r;this.select=({scope:w,index:y=-1})=>Object(c.b)(this,void 0,void 0,function*(){const z=[];var A=null!==w&&void 0!==w?w:"Selection";if("Selection"===A){const B=this.pa.mg();0<B.length&&z.push(...B);0!==z.length||w||(A="Presentation")}if("Presentation"===A&&this.Hd){A=this.Hd.Sy.presentation.slides;if(null===A)throw Error("Could not cast from ISlide to ISlide on presentation slides.");
z.push(...A)}return-1!==y&&y<z.length?[z[y]]:z});this.format=()=>Object(c.b)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.lHd=w=>w?w.lj:this.Hd.Sy.presentation.QY[0].Id;this.uBf=w=>{const y=this.Hd.Sy.presentation.QY;for(let z=0;z<y.length;z++)if(w===y[z].Id)return y[z].ContentMasters[0].Id;return 0};this.vBf=(w,y)=>{const z=this.Hd.Sy.presentation.QY.find(A=>A.Id===y).ContentMasters.find(A=>A.Name===w);if(!z)throw Error("Could not find content master for layout "+
w);return z.Id};this.insert=({slides:w,layout:y})=>Object(c.b)(this,void 0,void 0,function*(){if(!w)throw Error("Could not insert slide due to invalid preceding slides");if(!this.Hd)throw Error("Cannot insert slides without appForOfficeManager instance.");const z=[];for(var A of w){var B=this.lHd(A);const H=y?this.vBf(y,B):this.uBf(B);B=this.Hd.Sy.presentation.EJb(A,null,B,H);z.push(Object(b.a)(f.a,B))}A=[];for(const H of z)A.push(new Promise(v=>h.a.GJ(v,H).bind(this)));return Promise.all(A)});this.delete=
({slides:w})=>Object(c.b)(this,void 0,void 0,function*(){if(!w)throw Error.argumentNull("slides");if(!this.Hd)throw Error("Cannot delete slides without appForOfficeManager instance.");for(const y of w){const z=y;z&&!this.hf.Cd(z)&&z.isConnected&&(this.pa.Ti(),this.Hd.Sy.presentation.UC(z),this.aq.Edc(new e.a([z])))}return new Promise(y=>h.a.GJ(y,this.Hd.Sy.presentation).bind(this))});if(!m)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!n)throw Error.argumentNull("m_selectionManager");
if(!l)throw Error.argumentNull("m_actionBlockingManager");if(!r)throw Error.argumentNull("m_graphOperationEventNotifier");this.LD&&this.LD.execute(w=>{this.Hd=w})}}Object(x.a)(u,"ODSLSlide",null,[852])},1108:function(x,G,a){a.d(G,"a",function(){return f});var c=a(69);x=a(0);var b=a(417);class f{constructor(e,h){this.LD=e;this.pa=h;this.select=()=>Object(c.b)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.format=()=>Object(c.b)(this,void 0,void 0,function*(){throw Error("Method not implemented.");
});this.insert=({slides:u,imageData:m})=>Object(c.b)(this,void 0,void 0,function*(){if(!u)throw Error.argumentNull("slides");if(!m)throw Error("Could not get imageData in Base64.");if(!this.Hd)throw Error("Cannot insert images without appForOfficeManager instance.");this.k1a(m)&&(m=yield f.cAf(m));const n=[];for(const l of u)this.pa.NP.apply(this.pa,l),this.Hd.pP.vwh(m,!0,null,null,null,null,0,""),n.push(new Promise(r=>b.a.GJ(r,l).bind(this)));yield Promise.all(n)});this.delete=()=>Object(c.b)(this,
void 0,void 0,function*(){throw Error("Method not implemented.");});if(!e)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!h)throw Error.argumentNull("m_selectionManager");this.LD&&this.LD.execute(u=>{this.Hd=u})}static cAf(e){return Object(c.b)(this,void 0,void 0,function*(){try{e.startsWith("//")&&(e="https:"+e);const h=yield fetch(e);if(h.ok){const u=yield h.arrayBuffer();return btoa((new Uint8Array(u)).reduce((m,n)=>m+String.fromCharCode(n),""))}}catch(h){}return""})}k1a(e){try{return new URL(e),
!0}catch(h){return!1}}}Object(x.a)(f,"ODSLImage",null,[852])},1109:function(x,G,a){a.d(G,"a",function(){return n});var c=a(69);x=a(0);var b=a(1616),f=a(1617),e=a(257),h=a(248),u=a(265),m=a(819);a.n(m);class n{constructor(l,r,w,y,z,A,B,H){this.pa=l;this.va=r;this.Mb=w;this.gW=y;this.nha=z;this.Fab=A;this.Gad=B;this.Fad=H;if(!this.pa)throw Error.argumentNull("m_selectionManager");if(!this.va)throw Error.argumentNull("m_graphTopologyManager");if(!this.Mb)throw Error.argumentNull("m_transactionFactory");
if(!this.gW)throw Error.argumentNull("m_odslText");if(!this.nha)throw Error.argumentNull("m_odslShape");if(!this.Fab)throw Error.argumentNull("m_odslSlide");if(!this.Gad)throw Error.argumentNull("m_odslTable");if(!this.Fad)throw Error.argumentNull("m_odslImage");}Vhh(l){switch(l){case m.ActionRecommendationTrigger.TextSelection:case m.ActionRecommendationTrigger.TextBoxSelection:return this.VHf();default:throw Error.argumentOutOfRange("trigger");}}Kbh(l){Object(c.b)(this,void 0,void 0,function*(){const r=
JSON.parse(l),w=this.Mb.qe(15),y=r.scenario;try{if(!y)throw Error("No scenario provided in modelData");w.rc(this.va.presentation);switch(y){case "textToTable":const z=Object.assign({},r);this.Clf(z);break;case "summarizeText":const A=Object.assign({},r);if(!A.summarizeText)throw Error("No summarizeText provided in modelData");this.oKb(y,A.summarizeText);break;case "rewriteText":const B=Object.assign({},r);if(!B.rewriteText)throw Error("No rewriteText provided in modelData");this.oKb(y,B.rewriteText);
break;case "continueText":const H=Object.assign({},r);if(!H.continueText)throw Error("No continueText provided in modelData");this.oKb(y,H.newWholeText);break;case "slideGeneration":const v=Object.assign({},r);this.jcf(v);break;default:throw Error.argumentOutOfRange("scenario");}}catch(z){h.a.J(509085824,b.a.grh,f.a.warning,`SmartRecommendation: Exception thrown while applying recommendation. ${z}`)}finally{w&&w.dispose()}})}VHf(){const l=this.pa.ud().map(y=>y.wI().map(z=>z.characterData).join("\n")).join("\n");
let r="";const w=this.pa.Ua.mb;w&&(r=w.toArray().filter(y=>y.contextId===e.a.textRange).map(y=>y.node.characterData.substring(y.e9a,y.sJb)).join("\n"));return JSON.stringify({shapeText:l,selectedText:r})}Clf(l){Object(c.b)(this,void 0,void 0,function*(){if(!l)throw Error.argumentNull("modelData");if(!l.transformedData)throw Error("No transformedData provided in modelData");if(l.usedData){var r=l.usedData.split("\n");for(var w of r)r=yield this.gW.select({text:w}),yield this.gW.delete({textRanges:r})}else w=
yield this.nha.select({}),yield this.nha.delete({shapes:w});w=yield this.Fab.select({});yield this.Gad.insert({slides:w,html:l.transformedData})})}oKb(l,r){Object(c.b)(this,void 0,void 0,function*(){if("summarizeText"===l||"rewriteText"===l)var w=yield this.gW.select({});else"continueText"===l&&(w=yield this.nha.select({}),w=yield this.gW.select({scope:w}));w=yield this.gW.delete({textRanges:w});w=yield this.gW.insert({precededBy:w,text:r});0<w.length&&(w=w[w.length-1],this.pa.setSelection(u.SelectionFactory.Ig(w.node,
w.Ib)))})}jcf(l){Object(c.b)(this,void 0,void 0,function*(){if(!l)throw Error.argumentNull("modelData");var r=yield this.Fab.select({});r=yield this.Fab.insert({slides:r,layout:"Two Content"});var w=r[0];this.pa.fJa();this.va.Ga=w;l.title&&(w=yield this.nha.select({scope:r,index:0}),w=yield this.gW.select({scope:w}),yield this.gW.insert({precededBy:w,text:l.title}));if(l.text){w=yield this.nha.select({scope:r,index:1});const y=`<ul>${l.text.map(z=>`<li>${z}</li>`).join("")}</ul>`;yield this.gW.FLg(w[0],
y)}l.image&&(w=(yield this.nha.select({scope:r,index:2}))[0],this.pa.setSelection(u.SelectionFactory.zk(w)),yield this.Fad.insert({slides:r,imageData:l.image}))})}}Object(x.a)(n,"SmartRecommendations",null,[])},1110:function(x,G){Object.defineProperty(G,"__esModule",{value:!0});G.ActionRecommendationPrompt=void 0;x=G.ActionRecommendationPrompt||(G.ActionRecommendationPrompt={});x.ODSLPPT="ODSLPPT";x.TextToTableAndSmartArtPPT="TextToTableAndSmartArtPPT";x.NextSlidePPT="NextSlidePPT";x.TextGenerationForSelectedTextPPT=
"TextGenerationForSelectedTextPPT";x.TextGenerationForTextBoxPPT="TextGenerationForTextBoxPPT"},1111:function(x,G,a){Object.defineProperty(G,"__esModule",{value:!0});G.ActionRecommendationAnnotation=void 0;const c=a(346);class b{constructor(f){c.SchemaObject.assign(b,this,f)}get metadata(){return this.M_}set metadata(f){this.M_=f}static getTypeName(){return"AugLoop_ActionRecommendation_ActionRecommendationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(f){return c.SchemaObject.matchesTypesFor(f,
[b.getTypeName()])}}G.ActionRecommendationAnnotation=b;b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()}},1112:function(x,G){Object.defineProperty(G,"__esModule",{value:!0});G.ActionRecommendationTrigger=void 0;x=G.ActionRecommendationTrigger||(G.ActionRecommendationTrigger={});x.TextBoxSelection="TextBoxSelection";x.TextSelection="TextSelection"},1113:function(x,G,a){Object.defineProperty(G,"__esModule",{value:!0});G.ActionRecommendationSignal=void 0;const c=a(346);class b{constructor(f){c.SchemaObject.assign(b,
this,f)}static getTypeName(){return"AugLoop_ActionRecommendation_ActionRecommendationSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(f){return c.SchemaObject.matchesTypesFor(f,[b.getTypeName()])}}G.ActionRecommendationSignal=b;b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()}},1118:function(x,G,a){a.d(G,"a",function(){return m});x=a(0);var c=a(1580),b=a(1506),f=a(291),e=a(252),h=a(253),u=a(357);class m{constructor(n,l,r){this.LD=n;this.pa=l;this.Ia=r;if(!n)throw Error.argumentNull("m_appForOfficeManagerFuture");
if(!l)throw Error.argumentNull("m_selectionManager");if(!r)throw Error.argumentNull("m_shapeReader");this.LD&&this.LD.execute(w=>{this.Hd=w})}OHf(n){if(!n.hasText)return null;const l=this.Ia.kAb(n).cache;let r;switch(l.Qp){case 0:r="None";break;case 1:r="Single";break;case 2:r="Double";break;case 3:r="Heavy";break;case 4:r="Dotted";break;case 5:r="DottedHeavy";break;case 6:r="Dash";break;case 7:r="DashHeavy";break;case 8:r="DashLong";break;case 9:r="DashLongHeavy";break;case 10:r="DotDash";break;
case 11:r="DotDashHeavy";break;case 12:r="DotDotDash";break;case 13:r="DotDotDashHeavy";break;case 14:r="Wavy";break;case 15:r="WavyHeavy";break;case 16:r="WavyDouble";break;default:r="None"}var w=n.wI()[0],y=new e.GraphIterator;y.set(w);y.pc(11);y.ug(11);y=(y=w.gg.dv(y))?1===y.listType:!1;switch(h.ParagraphReader.BJ(w)){case 1:w="Left";break;case 2:w="Center";break;case 3:w="Right";break;case 7:w="Distributed";break;case 6:w="Justify";break;default:w="Left"}return{text:n.Kfa(),color:f.a.vE(l.fontColor),
bold:l.isBold,italic:l.isItalic,underline:r,fontName:l.AJ,size:l.fontSize/2,bulleted:y,horizontalAlignment:w}}HGf(n,l){const r=n.get_shapeTypeString(),w=n.shapeName;var y=n.MR;const z=c.a.ke(y._x,b.a.horizontal);y=c.a.ke(y._y,b.a.vertical);var A=n.bV;const B=A.BottomRight.Y-A.TopLeft.Y;A=A.BottomRight.X-A.TopLeft.X;var H=u.a.parse(n.j7);const v=H?H.RGBColor:"";H=H?H.Alpha:-1;let C;switch(n.rz){case 0:C="Dash";break;case 1:C="DashDot";break;case 2:C="DashDotDot";break;case 3:C="LongDash";break;case 4:C=
"LongDashDot";break;case 5:C="RoundDot";break;case 6:C="Solid";break;case 7:C="SquareDot";break;case 8:C="LongDashDotDot";break;case 9:C="SystemDash";break;case 10:C="SystemDot";break;case 11:C="SystemDashDot";break;default:C="None"}const F=n.outlineWidth;var D=u.a.parse(n.s2);const N=D?D.RGBColor:"";D=D?D.Alpha:-1;n=this.OHf(n);return{index:l,textRange:n,type:r,name:w,left:z,top:y,height:B,width:A,lineColor:v,lineDashStyle:C,lineWeight:F,lineTransparency:H,fillColor:N,fillTransparency:D}}WGf(n,l){l=
{index:l,shapes:[]};n=n.xj();for(let r=0;r<n.length;r++)l.shapes.push(this.HGf(n[r],r));return l}Z7c(){if(!this.Hd)throw Error("Cannot create contextTree without valid AppForOfficeManager instance.");const n={slides:[],selectionNames:[]};n.slides.push(this.WGf(this.Hd.Sy.Ga,0));const l=this.pa.ud();for(const r of l)n.selectionNames.push(r.shapeName);return n}}Object(x.a)(m,"ODSLContext",null,[874])},1143:function(x,G,a){a.d(G,"a",function(){return B});x=a(0);class c{constructor(){this.results=null;
this.totalResultCount=0;this.hasTooManyResults=!1}}Object(x.a)(c,"DocumentContentSearchResults",null,[]);class b{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(H,v,C,F,D){this.selectRange(v,C,F,D)}selectRangeV3(){}search(){}searchV2(H,v){this.search(H,C=>{v(Object.assign(new c,{results:C,totalResultCount:C.length,hasTooManyResults:100<C.length}))})}searchWithParam(H,v){this.search(H.query,v)}searchWithParamV2(H,v){this.searchWithParam(H,C=>{v(Object.assign(new c,{results:C,
totalResultCount:C.length,hasTooManyResults:C.length>H.totalResultLimit}))})}highlight(){}highlightWithParam(H){this.highlight(H.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(x.a)(b,"BaseDocumentContentExecutor",null,[1370,1393]);class f{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0;this.authorName=this.authorEmail=null}}Object(x.a)(f,"DocumentContentSearchResult",null,[]);var e=a(83),h=a(4),u=a(5),m=a(68),n=a(286),l=a(253),r=a(264),w=a(17),y=a(660),z=a(251),A=a(284);class B extends b{constructor(H,v,C,F,D,N,U,W,
L,O,M){super();if(!H)throw Error("pageNode is null");if(!v)throw Error("interactiveViewManager is null");if(!C)throw Error("selectionFactory is null");if(!F)throw Error("slideReader is null");if(!D)throw Error("workspace is null");if(!N)throw Error("graphTopologyManager is null");if(!U)throw Error("searchContextFactory is null");if(!W)throw Error("actionManager is null");if(!L)throw Error("selectionManager is null");if(!O)throw Error("clipServiceManager is null");if(!M)throw Error("presentationReader is null");
this.zdg=H;this.kA=v;this.GBb=C;this.nc=F;this.$b=D;this.va=N;this.Ung=U;this.ia=W;this.pa=L;this.XL=O;this.oc=M}getAllParagraphsInDocument(){const H=this.ZPb(),v=new m.a;for(const C of H)v.add(B.XPb(C));return v.toArray()}selectRange(H,v,C,F){if(!(0>H||0>v||0>C||0>F||H>C||H===C&&v>F)){var D=this.ZPb();D.count<=C||(H=D.ha(H),C=D.ha(C),B.S9c(H,v)&&B.S9c(C,F)&&(D=this.nc.Cg(H),this.va.Ga!==D&&this.$b.DMe(D,!1),v=this.GBb.Ig(H,v),F=this.GBb.NK(v,r.a.yj(C,F+1)),this.kA.zed(this.$b.oI,F)))}}search(H,v){const C=
new m.a,F=H.toLowerCase();var D=this.ZPb();let N=0;for(const W of D){D=B.XPb(W);const L=D.toLowerCase();let O=0;for(;-1<(O=L.indexOf(F,O));){var U=this.Ung.znf(D,O,O+H.length,"");U=Object.assign(new f,{snippet:U.llf,startOffsetInSnippet:U.RMg,endOffsetInSnippet:U.QMg-1,paragraphIndex:N,startOffsetInParagraph:O,endOffsetInParagraph:O+H.length-1});C.add(U);O+=H.length}N++}C.Sc((W,L)=>W.paragraphIndex===L.paragraphIndex?W.startOffsetInParagraph-L.startOffsetInParagraph:W.paragraphIndex-L.paragraphIndex);
v(C.toArray())}getSelectedSlidesAsPPTXStream(){const H=this.pa.mg();if(H&&H.length)return this.V7c(H);w.ULS.sendTraceTag(509642065,1313,10,"Unable to get selected slides. getAllSelectedSlideNodes returned undefined or empty")}getAllSlidesAsPPTXStream(){const H=this.oc.tKd();if(H&&H.length)return this.V7c(H);w.ULS.sendTraceTag(509437598,1313,10,"Unable to get slides in presentaiton. Calling getSortedSlideNodes returnd no slides")}V7c(H){var v=this.XL.Mqc(1,H.length,!1),C=e.a.create().toString();C=
new y.a(v,C,H);var F=8;F=this.ia.Qa(z.a.b6c,2,C);v.BQ=F;C=h.AFrameworkApplication.ga.La(A.a.$l);F=u.a.Sj(v.fp);const D=u.a.Sj(v.aC);v=u.a.Sj(v.Fx);if(F&&D&&v)return{url:`${C}GetClipboardBytes.ashx?Id=${F}&DC=${D}&pkey=${v}&wdwaccluster=${D}&DataType=${1}`,selectedSlideIDs:H.map(N=>N.id.toString())}}ZPb(){var H=l.ParagraphReader.Nac(this.zdg.value,!0,!1);const v=new m.a;for(const C of H)H=this.nc.Cg(C),H.wP||H.jmb||v.add(C);return v}static XPb(H){H=l.ParagraphReader.text(H);return n.AParagraphNode.Pdc(H,
" ")}static S9c(H,v){H=B.XPb(H);return v<H.length}}Object(x.a)(B,"PPTDocumentContentExecutor",b,[])},1169:function(x,G,a){a.d(G,"a",function(){return A});var c=a(69);x=a(0);var b=a(83),f=a(1507),e;(function(B){B[B.P8l=0]="unattempted";B[B.e8=1]="inProgress";B[B.notHandled=2]="notHandled";B[B.fyl=4]="handleExternally";B[B.failed=8]="failed";B[B.error=16]="error";B[B.succeeded=32]="succeeded";B[B.Dnl=64]="delayed"})(e||(e={}));Object(x.b)("ActionResponse",e);var h=a(256),u=a(414),m=a(418),n=a(491),
l=a(333),r=a(417),w=a(231),y=a(251),z=a(490);class A{constructor(B,H,v,C,F,D,N,U,W,L,O){this.va=B;this.pa=H;this.kj=v;this.Ma=C;this.Qk=F;this.yv=D;this.uS=N;this.hf=U;this.ia=W;this.Xn=L;this.v1=O;this.select=({scope:M,index:K=-1})=>Object(c.b)(this,void 0,void 0,function*(){const P=[],V=[];var Y=null!==M&&void 0!==M?M:"Selection";if("Selection"===Y){var ta=this.pa.nm();ta?V.push(ta):(ta=this.pa.mg(),0<ta.length&&this.v1.Hta(14,ta,P),0!=P.length||M||(Y="Presentation"))}if(Array.isArray(Y)&&0<Y.length&&
Y[0]instanceof u.a)this.v1.Hta(14,Y,P);else if("Presentation"===Y&&this.va.presentation){Y=this.va.presentation.slides;if(null===Y)throw Error("Could not cast from ISlide to ISlide on presentation slides");this.v1.Hta(14,Y,P)}V.push(...P.map(fa=>fa.node));return-1!==K&&K<V.length?[V[K]]:V});this.format=({tables:M,color:K,fillColor:P,styles:V,cellColor:Y,border:ta,borderColor:fa,mergeCells:Ta,splitCells:ha})=>Object(c.b)(this,void 0,void 0,function*(){var qa;let ra=!1;var I=!1,ba=!1;const Ga=[];for(const Ja of M){let Qa=
this.pa.hr();1===M.length&&Qa&&0<Qa.length?ra=!0:Qa=Ja.r_a();Qa.filter(Pa=>!Pa.isGhostCell);var Oa=this.tHf(null!==(qa=null!==V&&void 0!==V?V:P)&&void 0!==qa?qa:K);Oa&&0<Oa.length&&Ja.setValue(h.a.Ika,b.a.Xf(Oa));if(Y&&n.a.x5c(Y)&&!I){I=this.zQb(Y);for(const Pa of Qa)Oa=Pa.cellShading,m.b(Oa),Oa.solidFillField=I,Pa.cellShading=Oa;I=ra&&1===M.length}if((ta||fa)&&!ba){if(ta)ba=fa&&n.a.x5c(fa)?this.zQb(fa):void 0,this.ia.Qa(y.a.t7,f.a.execute,{["TableNode"]:Ja,["CellNodes"]:Qa,["SourceControlId"]:this.bKa(ta),
["BorderColor"]:ba,["DoNotCreateTransaction"]:!0});else{ba=n.a.V7(fa);this.ia.Qa(y.a.Ota,f.a.execute,{["TableNode"]:Ja,["Color"]:ba});ba=this.zQb(fa);for(const Pa of Qa)l.Box4ColorHelper.Yxa(Pa.ira)||(Pa.ira=ba),l.Box4ColorHelper.Yxa(Pa.r7)||(Pa.r7=ba),l.Box4ColorHelper.Yxa(Pa.hra)||(Pa.hra=ba),l.Box4ColorHelper.Yxa(Pa.s7)||(Pa.s7=ba)}ba=ra&&1===M.length}(Ta||ha)&&ra&&this.ia.Qa(Ta?y.a.mergeTableCells:y.a.splitTableCells,f.a.execute,{["rows"]:1,["columns"]:2});Ga.push(new Promise(Pa=>r.a.GJ(Pa,Ja,
!0).bind(this)))}yield Promise.all(Ga)});this.HOf=M=>{M=Object.assign(new z.a,{Vqa:!1,tda:[M]});if(this.ia.Qa(y.a.pka,f.a.execute,M)!==e.succeeded)throw Error("Table insertion from HTML failed.");return this.pa.lo()};this.JOf=(M,K,P)=>{const V=[];if(!K||Number.isNaN(K)||!P||Number.isNaN(P))throw Error("Invalid rows and columns provided.");this.pa.Rw();this.pa.Ti();this.Ma.Wd();for(const ta of M){M=ta;if(!M)throw Error("Cannot find selected slide to insert table.");if(!this.hf.Cd(M)){if(!this.kj.zC(M,
1))throw this.kj.dI(M),Error("Too many shapes on the slide.");var Y=M.Xb;Y=M.OZ(Y.sid,Y.cid,0,K,P,M.Ju());V.push(Y);this.Xn.WM([Y],M,null);this.yv.zI=Y}}return V};this.insert=({slides:M,rows:K,columns:P,html:V})=>Object(c.b)(this,void 0,void 0,function*(){if(!M)throw Error("No slide context provided to insert table.");const Y=[];V?Y.push(this.HOf(V)):Y.push(...this.JOf(M,K,P));const ta=[];for(const fa of Y)ta.push(new Promise(Ta=>r.a.GJ(Ta,fa,!0).bind(this)));return Promise.all(ta)});this.delete=
({tables:M})=>Object(c.b)(this,void 0,void 0,function*(){if(!M)throw Error.argumentNull("tables");for(const V of M){var K=this.pa.lo();K&&K.Zc&&this.hf.Cd(K)||(K=Object(w.a)(426,V),this.Qk.mNb(K))}const P=this.va.Ga;P&&this.hf.vx(P,"handleDeleteTable");return new Promise(V=>r.a.GJ(V,P).bind(this))});if(!B)throw Error.argumentNull("m_graphTopologyManager");if(!H)throw Error.argumentNull("m_selectionManager");if(!v)throw Error.argumentNull("m_shapeCountValidator");if(!C)throw Error.argumentNull("m_focusManager");
if(!F)throw Error.argumentNull("m_shapeEditor");if(!D)throw Error.argumentNull("m_ribbonChangeManager");if(!N)throw Error.argumentNull("m_tableStyleGalleryManager");if(!U)throw Error.argumentNull("m_actionBlockingManager");if(!W)throw Error.argumentNull("m_actionManager");if(!L)throw Error.argumentNull("m_transactionHelper");if(!O)throw Error.argumentNull("m_odslGraphUtils");}YHf(){var B=this.pa.mg();return B&&0!=B.length?(B=B[0])?B.Oe:null:null}dBf(B,H){B=n.a.W7c(B);return(Math.abs(B.r-H.r)^2)+(Math.abs(B.g-
H.g)^2)+(Math.abs(B.b-H.b)^2)}tHf(B){if(!B)return"";var H=B.toLowerCase();this.uS.$6c();B=this.uS.Fac();if(!B||!B.length)return"";if(H.includes("transparent")||H.includes("none")){var v=B[0].sh(h.a.tableStyle);return v.sM?v.sM.styleIdField:""}H=n.a.V7(H);if(!H.length)return"";const C=this.YHf();if(!C)return"";let F=999999,D="";for(let U=0;7>U;++U){const W=B[U].sh(h.a.tableStyle);if(!W.sM)continue;var N=null!==(v=W.sM.firstRowField)&&void 0!==v?v:W.sM.wholeTblField;if(!N||!N.tcStyleField)continue;
N=N.tcStyleField.fillField;if(!N||N.noFillField)continue;let L;N.solidFillField?L=l.Box4ColorHelper.ME(l.Box4ColorHelper.K8(N.solidFillField),C):N.gradFillField&&(L=m.f(N.gradFillField,C).stops[0].color);L&&(N=this.dBf(H,L),N<=F&&(F=N,D=W.sM.styleIdField))}return D}zQb(B){const H={};H.Color=n.a.V7(B);return l.Box4ColorHelper.RP(H)}bKa(B){B=B.toLowerCase();if(B.includes("no"))return"TableBordersNoBorder";if(!B.includes("all")){if(B.includes("outside"))return"TableBordersOutsideBorders";if(B.includes("horizontal"))return"TableBordersInsideHorizontalBorder";
if(B.includes("vertical"))return"TableBordersInsideVerticalBorder";if(B.includes("inside"))return"TableBordersInsideBorders";if(B.includes("top"))return"TableBordersTopBorder";if(B.includes("bottom"))return"TableBordersBottomBorder";if(B.includes("left"))return"TableBordersLeftBorder";if(B.includes("right"))return"TableBordersRightBorder";if(B.includes("up"))return"TableBordersDiagonalUpBorder";if(B.includes("down"))return"TableBordersDiagonalDownBorder";if(B.includes("diagonal"))return"TableBordersDiagonalUpBorder"}return"TableBordersAllBorders"}}
Object(x.a)(A,"ODSLTable",null,[852])},1207:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(x.a)(c,"InsightsParameters",null,[])},1506:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b[b.horizontal=0]="horizontal";b[b.vertical=1]="vertical"})(c||(c={}));Object(x.b)("Orientation",c)},1535:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);class c{constructor(f,e,h,u){this.oVe=
f;this.k5e=e;this.j5e=h;this.l5e=u}get llf(){return this.oVe}get RMg(){return this.k5e}get QMg(){return this.j5e}get resultType(){return this.l5e}}Object(x.a)(c,"SearchContext",null,[905]);class b{znf(f,e,h,u){var m=h-e;let n;if(100<=m)m=e,n=h;else{m=Math.max(0,e+Math.ceil(m/2)-50);n=Math.min(f.length,m+100);m=Math.max(0,n-100);let r;if(m&&" "!==f.charAt(m-1)){r=Math.min(e,m+10);for(var l=m;l<r;++l)if(" "===f.charAt(l)){m=l+1;break}}if(n!==f.length&&" "!==f.charAt(n))for(r=Math.max(h,n-10),l=n-1;l>=
r;--l)if(" "===f.charAt(l)){n=l;break}}return new c(f.substring(m,n),e-m,h-m,u)}}Object(x.a)(b,"SearchContextFactory",null,[886])},1681:function(x,G,a){a.r(G);var c=a(0),b=a(151),f=a(1535),e=a(4),h=a(425),u=a(62),m=a(118),n=a(68);class l{constructor(Pb){Pb.Na("Common.App.SearchCommon.SearchHostRuntime").execute(()=>{})}}Object(c.a)(l,"DocumentContentExtractionManager",null,[1394]);var r=a(17),w=a(40),y=a(219),z=a(6);class A{}A.rRn="mso_smartLookup";A.channelId="SmartLookup";A.qRn="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";
A.Q5l="https://uci.edog.cdn.office.net/mirrored/smartlookup/";A.R5l="https://uci.cdn.office.net/mirrored/smartlookup/";A.pRn="https://hedwigtestserver.blob.core.windows.net/builds/";A.oRn="http://localhost:8080/";A.OVg="current";A.P5l="next";A.Wtn=2;A.$Ie=Object(z.a)("SmartLookupPaneTitle");A.JUa="InsightsTaskPane";A.width=400;A.f7l="appCorrelationId";A.g7l="message";Object(c.a)(A,"InsightsConstants",null,[]);var B=a(1207),H=a(24);class v{}Object(c.a)(v,"ActivityContractInfo",null,[]);class C{}Object(c.a)(C,
"BrowserPaneDataField",null,[]);class F{}Object(c.a)(F,"BrowserPaneTelemetryEvent",null,[]);var D=a(43),N=a(19),U=a(84),W=a(93);class L{static JR(Pb,qc){const Uc=new F;Uc.eventName="Diagnostics";Uc.isActivity=!1;Uc.activityContract=Object.assign(new v,{success:!0});const pd=[],Od=new C;Od.name="Message";Od.dataType=0;Od.value=Pb;Pb=new C;Pb.name="Level";Pb.dataType=0;Pb.value=L.bQm(qc);Array.add(pd,Od);Array.add(pd,Pb);Uc.dataFields=pd;L.sendTelemetryEvent(Uc)}static Fvh(Pb,qc){const Uc=new F;Uc.eventName=
Pb;Uc.isActivity=!1;Uc.activityContract=Object.assign(new v,{success:!0});Pb=[];const pd=new C;pd.name="AppCorrelationId";pd.dataType=0;pd.value=qc;Array.add(Pb,pd);Uc.dataFields=Pb;L.sendTelemetryEvent(Uc)}static dKn(Pb,qc,Uc,pd,Od,be){const te=new F;te.eventName="LaunchPaneWithError";te.isActivity=!1;te.activityContract=Object.assign(new v,{success:!0});const Le=[],kf=new C;kf.name="IsNetworkConnected";kf.dataType=0;kf.value=Pb?"true":"false";Pb=new C;Pb.name="IsHostruntimeAvailable";Pb.dataType=
0;Pb.value=qc?"true":"false";qc=new C;qc.name="EntryPoint";qc.dataType=0;qc.value=Uc;Uc=new C;Uc.name="RuntimeVersion";Uc.dataType=0;Uc.value=pd;pd=new C;pd.name="IsFirstRelease";pd.dataType=1;pd.value=Od?"true":"false";Od=new C;Od.name="IsZeroTerm";Od.dataType=1;Od.value=be?"true":"false";be=new C;be.name="IsClientSideRendering";be.dataType=1;be.value="false";Array.add(Le,kf);Array.add(Le,qc);Array.add(Le,Pb);Array.add(Le,Uc);Array.add(Le,pd);Array.add(Le,Od);Array.add(Le,be);te.dataFields=Le;L.sendTelemetryEvent(te)}static rxk(Pb,
qc,Uc){const pd=new F;pd.eventName="CDNDownloadLatency";pd.isActivity=!0;pd.activityContract=Object.assign(new v,{duration:Uc,success:!0});Uc=[];const Od=new C;Od.name="CDNHostname";Od.dataType=0;Od.value=Pb;Pb=new C;Pb.name="Filename";Pb.dataType=0;Pb.value=qc;Array.add(Uc,Od);Array.add(Uc,Pb);pd.dataFields=Uc;L.sendTelemetryEvent(pd,1)}static DPg(Pb,qc,Uc,pd,Od,be,te,Le){const kf=new F;kf.eventName="LaunchPane";kf.isActivity=!0;kf.activityContract=Object.assign(new v,{duration:qc,success:!0});qc=
[];const fg=new C;fg.name="AppCorrelationId";fg.dataType=0;fg.value=Pb;Pb=new C;Pb.name="EntryPoint";Pb.dataType=0;Pb.value=Uc;Uc=new C;Uc.name="IsServerSideRendering";Uc.dataType=1;Uc.value="true";const pe=new C;pe.name="UxVersion";pe.dataType=0;pe.value=pd;pd=new C;pd.name="FeatureGates";pd.dataType=0;pd.value=Od;Od=new C;Od.name="IsFirstRelease";Od.dataType=1;Od.value=be?"true":"false";be=new C;be.name="IsZeroTerm";be.dataType=1;be.value=te?"true":"false";te=new C;te.name="IsClientSideRendering";
te.dataType=1;te.value=Le?"true":"false";Array.add(qc,fg);Array.add(qc,Pb);Array.add(qc,Uc);Array.add(qc,pe);Array.add(qc,pd);Array.add(qc,Od);Array.add(qc,be);Array.add(qc,te);kf.dataFields=qc;L.sendTelemetryEvent(kf)}static sendTelemetryEvent(Pb,qc=2){if(Pb.isFeedbackActivity)L.e$m(Pb.eventName);else{var Uc=-1<Pb.eventName.indexOf(L.e7l)?Pb.eventName:L.e7l+Pb.eventName,pd=L.HNm(Pb.dataFields);Pb.isActivity?(Pb=Object.assign(new U.a,{name:Uc,samplingPolicy:qc,dataFields:pd,succeeded:Pb.activityContract.success,
durationMs:Pb.activityContract.duration}),D.a.sendActivityEvent(Pb)):(Pb=Object.assign(new W.a,{name:Uc,samplingPolicy:qc,dataFields:pd}),D.a.sendTelemetryEvent(Pb))}}static bQm(Pb){switch(Pb){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static HNm(Pb){const qc=[];if(Pb&&0<Pb.length)for(const Uc of Pb)(Pb=H.a.iEa(Uc.name,Uc.value,L.Vzm(Uc.dataType)))&&Array.add(qc,Pb);return qc}static Vzm(Pb){switch(Pb){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}}static e$m(Pb){const qc=
N.a.instance.yb("Common.ISystemInitiatedFeedback");qc?qc.logActivity(Pb,null):r.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}L.e7l="Office.Insights.SmartLookup.";Object(c.a)(L,"TelemetryUtils",null,[]);var O=a(893),M=a(598),K=a(821),P=a(401),V=a(20),Y=a(83);class ta{static uEa(Pb,qc,Uc,pd,Od,be){if(1===Uc)return P.SessionStatusManager.instance.gga?32:8;if(Od.value.WOn())return L.JR("Skipping Serplet launch",10),32;qc=be;if(!qc)return 8;Pb=ta.lGd();if(Uc=qc.CommandValueId)try{qc=
V.a(Uc)}catch(te){return r.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",Uc),8}Uc=qc;qc.selection||(qc.neighborhood?Uc=Object.assign(new M.a,{selection:qc}):(qc=Od.value.gId(),Uc.selection=Object.assign(new K.a,{neighborhood:qc.neighborhood,mentionStart:qc.mentionStart,mentionLength:qc.mentionLength})));Uc.selection.clientDetectedLanguage=null;return ta.EBe(be,null,Uc,Pb,0,Od)}static EBe(Pb,qc,Uc,pd,Od,be){const te={};te.controlId=Pb?Pb.SourceControlId:
"shortcut";Uc&&(te.entryPoint=O.a[Uc.entryPoint]);r.ULS.sendTraceTag(594044172,1303,50,ta.ROb("Show insights",pd,te));qc?be.value.YPn(qc,pd,Od):Uc&&(e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?be.value.lPn(Uc,pd):be.value.ZPn(Uc,pd,Od));return 32}static ROb(Pb,qc,Uc=null){Pb={["appCorrelationId"]:qc,["message"]:Pb};if(Uc)for(const pd in Uc)Pb[pd]=Uc[pd];return V.c(Pb)}static lGd(){return Y.a.create().toString()}}Object(c.a)(ta,"InvokingPaneUtils",
null,[]);class fa{}Object(c.a)(fa,"LaunchDataInDoc",null,[]);class Ta{}Object(c.a)(Ta,"LaunchDataPasteAsSlide",null,[]);class ha{}Object(c.a)(ha,"LaunchDataSlidesCompression",null,[]);var qa=a(709),ra=a(349),I=a(51),ba=a(599),Ga=a(39),Oa=a(26),Ja=a(41),Qa=a(700),Pa=a(10);class ja{constructor(Pb,qc,Uc,pd,Od,be,te,Le,kf){this.qWe=this.$2c=this.XE=null;this.vwc=fg=>{this.XE||3!==fg.state||(this.XE=fg,this.$2c=this.XE.bda)};this.W2=Pb;this.ya=qc||e.AFrameworkApplication.vb;this.yV=Uc;this.Je=pd;this.u8k=
Le;this.u3c=Od;this.Ba=be;this.ze=te;this.Z1m();this.QFb=new b.a(()=>new qa.a(kf.value,this.vwc))}Hb(){this.ya.za(Pa.a.U2m,Ja.a.frame,Object(w.a)(this,this.WPn,"showInsights"));this.ya.za(Pa.a.V2m,Ja.a.frame,Object(w.a)(this,this.XPn,"showInsightsForTellMe"));this.ya.za(Pa.a.definitions,Ja.a.frame,Object(w.a)(this,this.BPn,"showDefinitions"));this.ya.za(Pa.a.tDm,Ja.a.frame,Object(w.a)(this,this.CPn,"showDefinitionsForTellMe"));this.ya.za(Pa.a.AIk,Ja.a.frame,Object(w.a)(this,this.AIk,"showInsightsForSuggestion"));
this.u8k&&(this.ya.za(Pa.a.pPf,Ja.a.frame,Object(w.a)(this,this.uEa,"invokeSmartLookupPane")),this.ya.za(Pa.a.wej,Ja.a.frame,Object(w.a)(this,this.wej,"invokeInDocSerplet")),this.ya.za(Pa.a.rPf,Ja.a.frame,Object(w.a)(this,this.rPf,"invokeSerpletRibbon")),this.ya.za(Pa.a.qPf,Ja.a.frame,Object(w.a)(this,this.qPf,"invokeSerpletContextMenu")),this.ya.za(Pa.a.Iej,Ja.a.frame,Object(w.a)(this,this.Iej,"invokeSerpletTellMeZeroTerm")),this.ya.za(Pa.a.Hej,Ja.a.frame,Object(w.a)(this,this.Hej,"invokeSerpletTellMeNotes")),
this.ya.za(Pa.a.vej,Ja.a.frame,Object(w.a)(this,this.vej,"invokeImageSerpletContextMenu")),this.ya.za(Pa.a.uPf,Ja.a.frame,Object(w.a)(this,this.uPf,"invokeSynonymsSerpletContextMenu")),this.ya.za(Pa.a.sej,Ja.a.frame,Object(w.a)(this,this.sej,"invokeDictionarySerpletContextMenu")),this.ya.za(Pa.a.Lej,Ja.a.frame,Object(w.a)(this,this.Lej,"invokeZeroTermSerpletContextMenu")),this.ya.za(Pa.a.qej,Ja.a.frame,Object(w.a)(this,this.qej,"invokeDefinitionSearchFromFloatie")),this.ya.za(Pa.a.akh,Ja.a.frame,
Object(w.a)(this,this.akh,"invokeSerpletBrowseFiles")),this.ya.za(Pa.a.xej,Ja.a.frame,Object(w.a)(this,this.xej,"invokeInDocSerpletWithLaunchData")),this.ya.za(Pa.a.Yek,Ja.a.frame,Object(w.a)(this,this.Yek,"queryToggleSerplet")),this.ya.za(Pa.a.vAk,Ja.a.frame,Object(w.a)(this,this.vAk,"setInDocSearchParameter")),this.ya.za(Pa.a.sPf,Ja.a.frame,Object(w.a)(this,this.sPf,"invokeSerpletSlidesCompression")),this.ya.za(Pa.a.Gej,Ja.a.frame,Object(w.a)(this,this.Gej,"invokeSerpletPasteAsNewSlide")),e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",
!1)&&(this.ya.za(Pa.a.i3m,Ja.a.frame,Object(w.a)(this,this.j3m,"invokeSmartLookupPaneConversations")),this.ya.za(Pa.a.pej,Ja.a.frame,Object(w.a)(this,this.pej,"invokeAutoLaunchSearchRequest"))),this.qEn().continueWith(()=>{e.AFrameworkApplication.Ea&&e.AFrameworkApplication.Ea.Zf(!0)}))}Wdl(){this.ya.sa(Pa.a.pRd,Ja.a.frame,Object(w.a)(this,this.pRd,"invokeFilesSerplet"),4);this.ya.sa(Pa.a.mBl,Ja.a.frame,Object(w.a)(this,this.pRd,"invokeFilesSerplet"),4);this.ya.sa(Pa.a.nBl,Ja.a.frame,Object(w.a)(this,
this.f3m,"invokeLinkFilesSerplet"),4);if(this.Ba.getBooleanAppSetting("IsTellMeUpSellEnterpriseEnabled")&&this.Ba.getBooleanAppSetting("SmartLookupTokenPrefetchIsEnabled")){const Pb=Ga.a.Xzd(0,Object(w.a)(this,this.tVl,"prefetchToken"),0,177);this.ze.Qb(Pb)}}J_h(){I.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ya.za(Pa.a.pRd,Ja.a.frame,Object(w.a)(this,this.uej,"invokeFilesSerpletUnavailable")),this.ya.za(Pa.a.mBl,
Ja.a.frame,Object(w.a)(this,this.uej,"invokeFilesSerpletUnavailable")),this.ya.za(Pa.a.nBl,Ja.a.frame,Object(w.a)(this,this.uej,"invokeFilesSerpletUnavailable")))}tVl(Pb){r.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",Pb.interval,!!Pb.data);this.j8a().then(qc=>{let Uc=1;if(qc)r.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.Zxk("SmartLookupFiles: Token prefetch succeeded",!0),qc=6E4*this.Ba.Jc("SmartLookupTokenRenewalWaitDurationInMinutes",
30);else{r.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.Zxk("SmartLookupFiles: Token prefetch failed",!1);Uc=parseInt(Pb.data||"1");if(Uc>this.Ba.Jc("SmartLookupTokenRenewalRetryThreshold",5)){r.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.Zxk("SmartLookupFiles: Token prefetch max retry count reached",!1);return}qc=6E4*this.Ba.Jc("SmartLookupTokenRetryWaitDurationInMinutes",10);Uc++}qc=new Ga.a(3,1,qc,Object(w.a)(this,
this.tVl,"prefetchToken"),177);qc.data=Uc.toString();this.ze.Qb(qc)})}Zxk(Pb="",qc=!1){this.u3c.execute(Uc=>{Uc&&Uc.vMe("PrefetchToken",qc,0,"SmartLookup",Pb)})}j8a(){return this.u3c?new Promise(Pb=>{this.u3c.execute(qc=>{if(qc){var Uc=Date.now();qc.getToken("SmartLookup",this.Ba.La("SmartLookupShredderServiceEndpoint")).then(pd=>{Pb(!!pd&&0<pd.length);qc.vMe("TryGetTokenInternal",!!pd&&0<pd.length,Date.now()-Uc,"SmartLookup")})}else Pb(!1)})}):Promise.resolve(!1)}qEn(){const Pb=new y.a;if(this.Ba.getBooleanAppSetting("BrowserSupportsInsightsPaneSSO"))this.Wdl(),
Pb.vj(!0);else{if(!this.u3c)return r.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),Pb.vj(!1),this.J_h(),Pb.task;this.u3c.execute(qc=>{qc?qc.getToken("SmartLookup",this.Ba.La("SmartLookupShredderServiceEndpoint")).then(Uc=>{r.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!Uc&&0<Uc.length);Uc&&0<Uc.length?(this.Wdl(),Pb.vj(!0)):this.J_h()}):(r.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),Pb.vj(!1),this.J_h())})}return Pb.task}WPn(Pb,qc,Uc,pd,Od){if(1===
Uc)return e.AFrameworkApplication.Ea&&e.AFrameworkApplication.ga.getBooleanAppSetting("OneNoteDelayLoadContextActivationManager")&&!e.AFrameworkApplication.plf?8:this.W2.value.CCl()?32:8;Pb=ta.lGd();qc=this.W2.value.gId();return this.u8k?(qc=Object.assign(new K.a,{neighborhood:qc.neighborhood,mentionStart:qc.mentionStart,mentionLength:qc.mentionLength}),qc=Object.assign(new M.a,{selection:qc,userIntent:null,entryPoint:0,launchData:Object.assign(new ba.a,{landingTab:"All"})}),ta.EBe(Od,null,qc,Pb,
0,this.W2)):ta.EBe(Od,qc,null,Pb,0,this.W2)}BPn(Pb,qc,Uc,pd,Od){if(1===Uc)return this.W2.value.CCl()?32:8;Pb=ta.lGd();qc=this.W2.value.gId();return ta.EBe(Od,qc,null,Pb,1,this.W2)}XPn(Pb,qc,Uc,pd,Od){return 1===Uc?32:this.Iql(Od,0)}CPn(Pb,qc,Uc,pd,Od){return 1===Uc?32:this.Iql(Od,1)}Iql(Pb,qc){const Uc=ta.lGd(),pd=Pb.CommandValueId;let Od;try{Od=V.a(pd)}catch(be){return r.ULS.sendTraceTag(6295941,1303,15,ta.ROb(String.format("Insights parameters [{0}] is not in proper format.",pd),Uc)),8}return ta.EBe(Pb,
Od,null,Uc,qc,this.W2)}AIk(Pb,qc,Uc,pd,Od){if(1===Uc)return 32;if(!Od)return 8;Pb=Od.query?Od.query:"";qc=ta.lGd();Uc=new B.a;Uc.neighborhood=Pb;Uc.mentionStart=0;Uc.mentionLength=Pb.length;return ta.EBe(Od,Uc,null,qc,0,this.W2)}f3m(Pb,qc,Uc,pd){if(1===Uc)return P.SessionStatusManager.instance.gga?32:8;const Od=e.AFrameworkApplication.ga.getBooleanAppSetting("InsertFileLinkSerpletIsEnabled"),be=this.W2.value.h8c();return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{selection:Object.assign(new K.a,
{neighborhood:be.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new ba.a,{landingTab:"File"}),entryPoint:Od?32:10}))}pRd(Pb,qc,Uc,pd){if(1===Uc)return P.SessionStatusManager.instance.gga?32:8;const Od=e.AFrameworkApplication.ga.getBooleanAppSetting("InvokeReuseSlidesSerpletIsEnabled"),be=this.W2.value.h8c();return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{selection:Object.assign(new K.a,{neighborhood:be.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new ba.a,
{landingTab:Od?"Slide":"File"}),entryPoint:Od?20:10}))}uej(){return 2}wej(Pb,qc,Uc,pd,Od){if(1===Uc)return P.SessionStatusManager.instance.QKa?8:32;const be=this.W2.value.h8c();Od=void 0===Od||null===Od?18:19;return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{selection:Object.assign(new K.a,{neighborhood:be.neighborhood,mentionStart:be.mentionStart,mentionLength:be.mentionLength}),launchData:Object.assign(new ba.a,{landingTab:"Indoc"}),entryPoint:Od}))}xej(Pb,qc,Uc,pd,Od){Od=Od.CommandValueId;if(!Od||
Od&&this.qWe&&Od.query===this.qWe.query&&Od.matchCase===this.qWe.matchCase&&Od.matchWholeWordOnly===this.qWe.matchWholeWordOnly)return 32;const be=this.W2.value.h8c();return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{selection:Object.assign(new K.a,{neighborhood:be.neighborhood,mentionStart:be.mentionStart,mentionLength:be.mentionLength}),launchData:Object.assign(new ba.a,{landingTab:"Indoc",data:Object.assign(new fa,{type:4,query:Od.query,matchCase:Od.matchCase,matchWholeWord:Od.matchWholeWordOnly})}),
entryPoint:18}))}Yek(Pb,qc,Uc,pd,Od){Od&&(Od[Qa.a.On]=this.W2.value.ITf);return 32}vAk(Pb,qc,Uc,pd,Od){if(Pb=Od.CommandValueId)this.qWe=Pb;return 32}j3m(Pb,qc,Uc){if(1===Uc)return P.SessionStatusManager.instance.gga?32:8;Pb=this.W2.value.h8c();Pb=Object.assign(new M.a,{selection:Object.assign(new K.a,{neighborhood:Pb.neighborhood,mentionStart:Pb.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new ba.a,{landingTab:"All"})});this.W2.value.Psj(Pb);return 32}pej(Pb,qc,Uc){if(1===
Uc)return P.SessionStatusManager.instance.gga?32:8;Pb=this.W2.value.h8c();Pb=Object.assign(new M.a,{selection:Object.assign(new K.a,{neighborhood:Pb.neighborhood,mentionStart:Pb.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new ba.a,{landingTab:"All",data:e.AFrameworkApplication.cac})});qc=ta.lGd();this.W2.value.Hvh(Pb,qc);return 32}rPf(Pb,qc,Uc,pd){if(1===Uc)return P.SessionStatusManager.instance.gga?32:8;const Od=this.W2.value.JPm();return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,
{selection:Object.assign(new K.a,{neighborhood:Od.neighborhood,mentionStart:Od.mentionStart,mentionLength:Od.mentionLength}),entryPoint:4,launchData:Object.assign(new ba.a,{landingTab:"All"})}))}qPf(Pb,qc,Uc,pd){return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{entryPoint:5,launchData:Object.assign(new ba.a,{landingTab:"All"})}))}Iej(Pb,qc,Uc,pd){if(1===Uc)return P.SessionStatusManager.instance.gga?32:8;const Od=this.W2.value.h8c();return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{selection:Object.assign(new K.a,
{neighborhood:Od.neighborhood,mentionStart:Od.mentionStart,mentionLength:0}),launchData:Object.assign(new ba.a,{landingTab:"All"}),entryPoint:26}))}sej(Pb,qc,Uc,pd){return 1===Uc?(Pb=this.W2.value.gId())&&0<Pb.mentionLength?32:8:this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{entryPoint:22,launchData:Object.assign(new ba.a,{landingTab:"All"})}))}qej(Pb,qc,Uc,pd){return 1===Uc?(Pb=this.W2.value.gId())&&0<Pb.mentionLength?32:8:this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{entryPoint:7,launchData:Object.assign(new ba.a,
{landingTab:"All"})}))}vej(Pb,qc,Uc,pd){return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{launchData:Object.assign(new ba.a,{landingTab:"Image"}),entryPoint:9}))}uPf(Pb,qc,Uc,pd){return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{launchData:Object.assign(new ba.a,{landingTab:"All"}),entryPoint:24}))}Hej(Pb,qc,Uc,pd){return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{launchData:Object.assign(new ba.a,{landingTab:"Notes"}),entryPoint:33}))}Lej(Pb,qc,Uc,pd){if(1===Uc)return P.SessionStatusManager.instance.gga?
32:8;const Od=this.W2.value.h8c();return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{selection:Object.assign(new K.a,{neighborhood:Od.neighborhood,mentionStart:Od.mentionStart,mentionLength:0}),launchData:Object.assign(new ba.a,{landingTab:"All"}),entryPoint:27}))}sPf(Pb,qc,Uc,pd,Od){if(!Od)return 8;const be=Od.url;Od=Od.selectedSlideIDs;return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{launchData:Object.assign(new ba.a,{landingTab:"All",data:Object.assign(new ha,{type:6,url:be,selectedSlideIDs:Od})}),
entryPoint:37}))}Gej(Pb,qc,Uc,pd,Od){if(!Od)return 8;const be=Od.Selection;Od=Od.CurrentDocTitle;return this.uEa(Pb,qc,Uc,pd,Object.assign(new M.a,{launchData:Object.assign(new ba.a,{landingTab:"All",data:Object.assign(new Ta,{type:5,selection:be,currentDocTitle:Od})}),entryPoint:36}))}uEa(Pb,qc,Uc,pd,Od){return ta.uEa(Pb,qc,Uc,pd,this.W2,Od)}akh(Pb,qc,Uc){if(1===Uc)return 32;this.XE||this.QFb.value.Ci("Browse File from Search pane",!0);if(!this.$2c||""===this.$2c)return r.ULS.sendTraceTag(558409934,
1303,10,"InsightsActor: Failed to get host url to browse files."),8;Oa.a.jq(this.$2c,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}Z1m(){const Pb=this.Je.gd(A.JUa);Pb.parent=ra.AFrame.vl;Pb.G9(Object(w.a)(this,this.Exk,"sendIFrameTakeFocusMessage"));this.yV.zja(A.JUa)}Exk(){document.activeElement.blur();e.AFrameworkApplication.Ea&&e.AFrameworkApplication.Ea.Kb.joj||(this.W2.value.uQg(),this.W2.value.bKn())}dispose(){this.W2.value&&this.W2.value.dispose()}}Object(c.a)(ja,"InsightsActor",null,
[24]);var va=a(231),Ha=a(870),gb=a(7),Gb=a(180),Mb=a(5);const hb=Pb=>{Pb=Pb.split("-");return Pb[Pb.length-1]},Da=Pb=>18===Pb||19===Pb||15===Pb,Bb=()=>{var Pb=sb();if(Pb)return Promise.resolve(Pb);Pb=uc().replace("SearchWeb","searchweb");Pb=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?Pb+A.P5l+"/":Pb+A.OVg+"/";Pb+="version.json";if(gb.a.eA)return Za(Pb);try{const qc=new Sys.Net.WebRequest;qc.set_httpVerb("GET");qc.set_url(Pb);Pb=
{};Pb.method=qc.get_httpVerb();return"function"!==typeof window.fetch?(L.JR("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(qc.getResolvedUrl(),Pb).then(Uc=>Uc.json()).catch(()=>{L.JR("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(Uc=>{Uc=V.b(JSON.stringify(Uc));return Uc.version?Uc.version:""},Uc=>{L.JR("InsightsUtils - Failed to deserialize version: "+Uc.toString(),10);r.ULS.sendTraceTag(591971029,
1303,15,"Insights: Failed to deserialize version: "+Uc.toString());return""}).then(Uc=>Uc)}catch(qc){return L.JR("InsightsUtils - Failed to download version.json: "+qc.toString(),10),r.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+qc.toString()),Promise.resolve("")}},Za=Pb=>{const qc=e.AFrameworkApplication.ye;return new Promise(Uc=>{const pd=new Ha.a(Pb,1,null,null,!0,2,null);qc.send(pd).vUc(Od=>{Od&&Od.data?Od.data.responseData||(L.JR("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+
Od.data.Ze,10),Uc("")):(L.JR("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),Uc(""));try{const be=V.b(Od.data.responseData);be.version&&Uc(be.version)}catch(be){L.JR("InsightsUtils - Failed to deserialize version: "+be.toString(),10),Uc("")}},Od=>{Od&&Od.data?L.JR("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+Od.data.Ze,10):L.JR("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",
10);Uc("")})})},mb=()=>e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableLocalOverride")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),vb=()=>{const Pb=uc();return mb()||e.AFrameworkApplication.ga.La("SmartLookupPRClientVersion")?Pb+sb()+"/":e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?Pb+A.P5l:Pb+A.OVg},sb=()=>mb()?"dev":e.AFrameworkApplication.ga.La("SmartLookupPRClientVersion")?
e.AFrameworkApplication.ga.La("SmartLookupPRClientVersion").split("/")[1]:e.AFrameworkApplication.ga.La("SmartLookupClientVersion"),bc=Pb=>{var qc=3===e.AFrameworkApplication.Ea.Kb.Im?"wordwac":2===e.AFrameworkApplication.Ea.Kb.Im?"pptwac":"excelwac";var Uc=Gb.a.Ne(e.AFrameworkApplication.lcid);const pd=Uc?Uc.name:"en-us";Uc=uc();const Od=wc();qc="main_ssr_wac.html?appName="+qc+"&culture="+pd;return"LOCAL"===Od?Uc+qc:Uc+((""!==Pb?Pb:A.OVg)+"/")+qc},yb=Pb=>uc()+(""!==Pb?Pb:A.OVg)+"/scripts/microsoft.office.smartlookup.host.runtime.js",
uc=()=>{switch(wc()){case "LOCAL":return A.oRn;case "PR":const Pb=e.AFrameworkApplication.ga.La("SmartLookupPRClientVersion").split("/");return A.pRn+Pb[0]+"/";case "INT":return A.qRn;case "EDOG":return A.Q5l;default:return A.R5l}},vc=()=>{if(!e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(wc()){case "EDOG":return A.Q5l;case "PROD":return A.R5l;default:return""}},wc=()=>{if(e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableEdogSourceLocationOverride")||
e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableProdSourceLocationOverride")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableIntSourceLocationOverride")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",
!1))return"INT";if(e.AFrameworkApplication.ga.La("SmartLookupPRClientVersion")&&e.AFrameworkApplication.ga.La("SmartLookupPRIntentSvc"))return"PR";if(mb())return"LOCAL";switch(Object(va.a)(String,e.AFrameworkApplication.Rf.AudienceGroup)||""){case "Dogfood":if(e.AFrameworkApplication.ga&&e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let Pb=e.AFrameworkApplication.ga.La("UserPrincipalName");Pb=Mb.a.mj(Pb);const qc=e.AFrameworkApplication.ga.Tz("SmartLookupINTEnabledForSKITeam")?
e.AFrameworkApplication.ga.tF("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(qc,Pb))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},ub=()=>{let Pb;Pb=e.AFrameworkApplication.ga.getBooleanAppSetting("IntentSvcEnableEdogSourceLocationOverride")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":e.AFrameworkApplication.ga.getBooleanAppSetting("IntentSvcEnableProdSourceLocationOverride")||
e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":e.AFrameworkApplication.ga.getBooleanAppSetting("IntentSvcEnableIntSourceLocationOverride")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":wc();const qc=e.AFrameworkApplication.ga.La("IntentServiceEndpoint"),Uc=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===Pb&&""!==qc)return qc+"searchendpointv2/";switch(Pb){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return e.AFrameworkApplication.ga.La("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(Uc?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(Uc?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},aa=()=>{const Pb=wc(),qc=e.AFrameworkApplication.ga.La("IntentServiceEndpoint");switch(Pb){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===Pb&&""!==qc?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class Na{sendTelemetryEvent(Pb){L.sendTelemetryEvent(Pb)}}
Object(c.a)(Na,"OtelTelemetrySink",null,[1445]);class ia{}Object(c.a)(ia,"ApplicationProperties",null,[]);class wa{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(c.a)(wa,"CurrentDocumentProperties",null,[]);class pa{}Object(c.a)(pa,"EnterpriseUserInfo",null,[]);class Ea{}Object(c.a)(Ea,"FeatureGates",null,[]);var La=a(33);class Aa{constructor(Pb,qc){this.bM=this.Vq=null;this.LM="Search";this.FJl=!0;this.Bsd=qc;this.Cda=Pb;this.Cda.execute(Uc=>{Uc.isFeatureEnabled("mso_sendASmile",
!0).then(pd=>{this.FJl=pd}).catch(pd=>{L.JR("SearchHelper - Failed to check if Feedback feature is enabled: "+pd.toString(),15)})});Pb=ub();qc=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentSearch")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupFeatureGateV2")){this.bM={};const Uc=this.WSm();if(Uc&&0<Uc.length)for(let pd=0;pd<Uc.length;pd++){const Od=
Uc[pd],be=this.lTm(Od);switch(be.toLowerCase()){case "true":this.bM[Od]=!0;break;case "false":this.bM[Od]=!1;break;default:this.bM[Od]=be}}this.bM.EnableInDocumentSearch=qc;this.bM.EnableInDocumentSearchReplace=!0;this.bM.EnableInDocumentParamLocalSearch=!0;this.bM.EnableInDocumentQuerySuggest=qc&&e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentQuerySuggest")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",
!1);this.bM.EnableInDocumentQuestionGeneration=qc&&e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentQuestionGeneration")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.bM.EnableInDocumentExperiment1=qc&&e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment1")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",
!1);this.bM.EnableInDocumentExperiment2=qc&&e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment2")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.bM.EnableInDocumentExperiment3=qc&&e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment3")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",
!1);this.bM.EnableZeroTermAutoRefresh=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.bM.EnableTap3SZeroTerm=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableTap3SZeroTerm")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.bM.EnableLocalSearch=!0;this.bM.EnableInDocumentStickyFilters=!0;this.bM.IntentServiceEndpoint=Pb;this.bM.EnablePDFShredding=
e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableSharepointPDFIsEnabled")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.bM.FilterNonPPTFilesForReuseSlides=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupFilterNonPPTFilesForReuseSlides");this.bM.UXBundleVersion=sb();this.bM.SmartLookupServicePath=vb();this.bM.EnableAcronymSearch=!0;this.bM.UseAltAnswerEndpoint1=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint1")||
e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.bM.UseAltAnswerEndpoint2=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint2")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.bM.UseAltAnswerEndpoint3=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint3")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",
!1);this.bM.UseNextUXVersion=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.bM.IgnoreNeighborhoodContext=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.bM.ShowDebugInfo="INT"===wc();this.bM.DebugCommands=e.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.bM.ChangeGates=e.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",
"");this.bM.QnaInMixSection=!0;this.bM.EnableNoteSearch=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.bM.EnableWikiL2=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.bM.EnableFilteringOutRedundantKPE=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",
!1);this.bM.EnableZeroTermEntitySuggestion=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.bM.RankingModels=e.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.bM.EnableClientSideRendering=!0}else this.Vq=new Ea,this.Vq.EnableInDocumentSearch=qc,this.Vq.EnableInDocumentSearchReplace=!0,this.Vq.EnableInDocumentParamLocalSearch=!0,this.Vq.EnableInDocumentQuerySuggest=
qc&&e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentQuerySuggest")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Vq.EnableInDocumentQuestionGeneration=qc&&e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentQuestionGeneration")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.Vq.EnableInDocumentExperiment1=
qc&&e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment1")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Vq.EnableInDocumentExperiment2=qc&&e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment2")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Vq.EnableInDocumentExperiment3=
qc&&e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment3")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Vq.EnableZeroTermAutoRefresh=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Vq.EnableTap3SZeroTerm=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableTap3SZeroTerm")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Vq.EnableLocalSearch=!0,this.Vq.EnableInDocumentStickyFilters=!0,this.Vq.IntentServiceEndpoint=Pb,this.Vq.EnablePDFShredding=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableSharepointPDFIsEnabled")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Vq.FilterNonPPTFilesForReuseSlides=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Vq.UXBundleVersion=
sb(),this.Vq.SmartLookupServicePath=vb(),this.Vq.EnableAcronymSearch=!0,this.Vq.UseAltAnswerEndpoint1=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint1")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Vq.UseAltAnswerEndpoint2=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint2")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",
!1),this.Vq.UseAltAnswerEndpoint3=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint3")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Vq.UseNextUXVersion=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Vq.IgnoreNeighborhoodContext=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupIgnoreNeighborhoodContextIsEnabled"),
this.Vq.ShowDebugInfo="INT"===wc(),this.Vq.DebugCommands=e.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",""),this.Vq.ChangeGates=e.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Vq.QnaInMixSection=!0,this.Vq.EnableNoteSearch=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1),this.Vq.EnableWikiL2=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Vq.EnableFilteringOutRedundantKPE=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Vq.EnableZeroTermEntitySuggestion=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Vq.RankingModels=e.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",
""),this.Vq.EnableClientSideRendering=!0,this.Vq.SharedSerpletFeatureGate1=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",!1),this.Vq.SharedSerpletFeatureGate2=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Vq.SharedSerpletFeatureGate3=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Vq.SharedSerpletFeatureGate4=
e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Vq.SharedSerpletFeatureGate5=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",!1),this.Vq.SharedSerpletFeatureGate6=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Vq.SharedSerpletFeatureGate7=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",
!1),this.Vq.SharedSerpletFeatureGate8=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Vq.SharedSerpletFeatureGate9=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",!1),this.Vq.SharedSerpletFeatureGate10=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Vq.SharedSerpletFeatureGate11=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",
!1),this.Vq.SharedSerpletFeatureGate12=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Vq.SharedSerpletFeatureGate13=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",!1),this.Vq.SharedSerpletFeatureGate14=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Vq.SharedSerpletFeatureGate15=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",
!1),this.Vq.SharedSerpletFeatureGate16=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Vq.SharedSerpletFeatureGate17=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",!1),this.Vq.SharedSerpletFeatureGate18=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Vq.SharedSerpletFeatureGate19=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",
!1),this.Vq.SharedSerpletFeatureGate20=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Vq.SharedSerpletFeatureGate21=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",!1),this.Vq.SharedSerpletFeatureGate22=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Vq.SharedSerpletFeatureGate23=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",
!1),this.Vq.SharedSerpletFeatureGate24=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Vq.SharedSerpletFeatureGate25=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",!1),this.Vq.SharedSerpletFeatureGate26=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Vq.SharedSerpletFeatureGate27=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",
!1),this.Vq.SharedSerpletFeatureGate28=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Vq.SharedSerpletFeatureGate29=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",!1),this.Vq.SharedSerpletFeatureGate30=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Vq.SharedSerpletFeatureGate31=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",
!1),this.Vq.SharedSerpletFeatureGate32=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Vq.SharedSerpletFeatureGate33=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",!1),this.Vq.SharedSerpletFeatureGate34=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Vq.SharedSerpletFeatureGate35=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",
!1),this.Vq.SharedSerpletFeatureGate36=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Vq.SharedSerpletFeatureGate37=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",!1),this.Vq.SharedSerpletFeatureGate38=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Vq.SharedSerpletFeatureGate39=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",
!1),this.Vq.SharedSerpletFeatureGate40=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.a2e=N.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");this.$7f=Aa.isEnterpriseUser();this.j7d=e.AFrameworkApplication.ga.La("SmartLookupShredderServiceEndpoint");this.Hen=La.a.aN(e.AFrameworkApplication.ga.La("AppCatalogUrl")||"");this.Xen=e.AFrameworkApplication.ga.La("UserPrincipalName");this.$7f&&this.Cwl()}lTm(Pb){return e.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.SharedOnline."+
Pb,"")}WSm(){const Pb=e.AFrameworkApplication.ga.uuc,qc=e.AFrameworkApplication.ga.tF("SmartLookupFlightKeywordList"),Uc=[];if(Pb&&qc&&0<qc.length)for(const Od in Pb){var pd={key:Od,value:Pb[Od]};pd=pd&&pd.key?pd.key:"";for(let be=0;be<qc.length;be++)if(-1<pd.toLowerCase().indexOf(qc[be].toLowerCase())){const te=pd.split(".");te&&4===te.length&&Array.add(Uc,te[te.length-1])}}return Uc}hHf(Pb,qc,Uc,pd){return new Promise(Od=>{this.F6m().then(be=>{const te=new ia;te.anid="";te.applicationName=3===e.AFrameworkApplication.Ea.Kb.Im?
"WORD":"POWERPNT";te.applicationVersion=e.AFrameworkApplication.buildVersion;te.appCorrelationId=Pb?Pb:ta.lGd();te.themePlatform="web";te.lcid=e.AFrameworkApplication.lcid;te.launchUtcTime=(new Date).toUTCString();e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupFeatureGateV2")?te.featureGates=V.c(this.bM):te.featureGates=V.c(this.Vq);var Le=Gb.a.Ne(e.AFrameworkApplication.lcid);Le=Le?Le.name:null;te.market=hb(Le);te.uiLanguage=Le;te.sessionId=e.AFrameworkApplication.userSessionId;te.themeId=
Uc;te.parentalControl="yes";te.processorOnlyMode=be;te.isEditingAllowed=qc.isEditingAllowed();te.isFeedbackEnabled=this.FJl;te.isClientSideRendering=Da(pd);te.disableClipboard=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&e.AFrameworkApplication.RA&&!e.AFrameworkApplication.ZSa;te.accessToken=this.$7f?this.Cwl():"";be=new pa;be.CountryCode=hb(Le);be.ServiceEndpoint=this.j7d;be.IsGoLocal=e.AFrameworkApplication.ga.getBooleanAppSetting("IsGoLocalEnvironment");
be.IsEnabled=this.$7f;be.IsEnterpriseEnabled=this.$7f;be.TenantRoot=this.Hen;be.Upn=this.Xen;Le=wc();be.IsEUDB="PROD"===Le&&""!==e.AFrameworkApplication.ga.La("IntentServiceEndpoint");te.enterpriseUserInfo=be;be=new wa;be.filePath=e.AFrameworkApplication.ga.La("EditDocInClientUrl");be.docName=e.AFrameworkApplication.ga.La("FileName");be.author=99!==pd?qc.author():null;be.createdDate=99!==pd?qc.createdDate():null;te.currentDocument=be;Od(te)})})}F6m(){return new Promise(Pb=>{this.Cda?this.Cda.execute(qc=>
{qc.isFeatureEnabled(A.rRn,!0).then(Uc=>{Pb(!Uc)}).catch(Uc=>{L.JR("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+Uc.toString(),10);Pb(!0)})}):Pb(!0)})}FTl(Pb){this.a2e&&this.$7f&&this.uih(this.j7d).then(qc=>{Pb(qc)})}Cwl(){return"Dev Box"===e.AFrameworkApplication.ga.La("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.a2e?this.a2e.yUm(this.LM,
this.j7d):""}uih(Pb){return"Dev Box"===e.AFrameworkApplication.ga.La("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(qc=>{qc(window.SearchPaneShredderTokenOverride)}):this.a2e?this.a2e.getToken(this.LM,Pb):Promise.resolve("")}rKd(){return this.Bsd?this.Bsd.getVersion():""}Dul(){return e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupFeatureGateV2")?V.c(this.bM):V.c(this.Vq)}static isEnterpriseUser(){const Pb=
e.AFrameworkApplication.ga.La("SovereignEnvironmentName"),qc=e.AFrameworkApplication.ga.getBooleanAppSetting("IsTellMeUpSellEnterpriseEnabled");return(!Pb||!Pb.length)&&qc}}Object(c.a)(Aa,"SearchHelper",null,[1395]);class nb{constructor(){nb.Wa=""}getVersion(){return nb.Wa}yNn(Pb){nb.Wa=Pb}}nb.Wa=null;Object(c.a)(nb,"SmartLookupVersion",null,[]);class Wa{}Object(c.a)(Wa,"ConfigurationProvider",null,[]);class ea{constructor(Pb){ea.Wa=Pb}BOi(){return ea.Wa}}ea.Wa=null;Object(c.a)(ea,"SearchHostRuntime",
null,[]);var Kb=a(25),kc=a(181),ac=a(103),eb=a(485);class Hb{constructor(){this.Yra=this.fwe=this.Ha=null}get name(){return"Common.App.Insights"}lc(Pb){this.Ha=Pb;const qc=eb.a.aG(N.a.instance.Na("Common.IEventEmitter<Common.IGetMoreInfoResult>")),Uc=e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableNativePane")||e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupIsEnabled");Pb.register(ja,"Common.App.Insights.InsightsActor").ma().na(()=>new ja(Pb.ge("Common.App.Insights.IInsightsManager"),
e.AFrameworkApplication.vb,h.a.instance,u.FocusManager.instance(),Pb.Na("Common.App.SearchCommon.ISearchOAuthManager"),e.AFrameworkApplication.ga,Kb.TaskManager.instance,Uc,new b.a(()=>qc.result)));Pb.register(1394,"Common.App.Insights.IDocumentContentExtractionManager").ma().na(()=>new l(Pb));Uc&&(Pb.register(nb,"Common.App.Insights.SmartLookupVersion").ma().na(()=>new nb),Pb.register(1395,"Common.App.SearchCommon.ISearchHelper").ma().na(()=>new Aa(N.a.instance.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
Pb.yb("Common.App.Insights.SmartLookupVersion"))))}init(){e.AFrameworkApplication.ibc&&(this.fwe=this.Ha.yb("Common.App.Insights.InsightsActor"),this.fwe.Hb())}VDn(){if(e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",!1)){var Pb=e.AFrameworkApplication.ga.La("SmartLookupShredderServiceEndpoint");this.Ha.resolve("Common.App.SearchCommon.ISearchHelper").uih(Pb).then(qc=>{var Uc={};Uc.Authorization="Bearer "+qc;qc=aa();const pd=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",
!0);Uc=new Ha.a(qc+("?isTelemetryOnly="+pd),1,null,Uc,!0,2,null);e.AFrameworkApplication.ye.send(Uc).vUc(()=>{L.JR("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+pd,50)},Od=>{L.JR("InsightsPackage - Failed to send refreshmemory API request. Error: "+Od.toString(),10)})})}}HFm(){this.$2m();this.VDn()}$2m(){Bb().then(Pb=>{if(""!==Pb){const qc=this.Ha.yb("Common.App.Insights.SmartLookupVersion");qc&&qc.yNn(Pb)}this.BCd();this.fwe=this.Ha.resolve("Common.App.Insights.InsightsActor");
Pb=yb(Pb);Pb=ac.a.create(Pb);Pb.lma((qc,Uc)=>{Uc.succeeded?this.NNn()&&this.prefetchZeroTerm():L.JR("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+Uc.NE,10);this.fwe.Hb()});kc.a.HL(Pb)})}NNn(){const Pb=Object.assign(new Wa,{channelId:A.channelId,approvedOriginPattern:mb()?"^(http)?://(localhost:8080)$":e.AFrameworkApplication.ga.La("SmartLookupApprovedOriginPattern")});var qc=this.Ha.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const Uc=this.Ha.resolve("Common.App.SearchCommon.ISerpletExecutor"),
pd=this.Ha.resolve("Common.App.SearchCommon.IInsertContentExecutor"),Od=new n.a;qc&&Od.add(qc);Uc&&Od.add(Uc);pd&&Od.add(pd);qc=ub();try{const be=new Na,te=SmartLookupHostRuntime.setup(Pb,Od.toArray(),!0,qc,be);this.Ha.register(ea,"Common.App.SearchCommon.SearchHostRuntime").ma().na(()=>new ea(te));return!0}catch(be){return L.JR("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+be,10),!1}}prefetchZeroTerm(){if(e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableInDocumentSearch")||
e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var Pb=N.a.instance.yb("Common.App.SearchCommon.SearchHostRuntime");if(Pb){const qc=this.Ha.resolve("Common.App.SearchCommon.ISearchHelper"),Uc=this.Ha.resolve("Common.App.SearchCommon.IDocumentHelper");qc.hHf(null,Uc,0,99).then(pd=>{Pb.BOi().prefetchZeroTerm(pd,e.AFrameworkApplication.userSessionId,vb(),!0,"Indoc",null)})}else L.JR("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",
15)}}BCd(){var Pb=this.Ha.resolve("Common.App.SearchCommon.ISearchHelper");const qc=bc(Pb.rKd());Pb=Pb.rKd();Pb=uc()+(""!==Pb?Pb:A.OVg)+"/scripts/microsoft.office.smartlookup.ssr.js";const Uc=vc();gb.a.eA?this.FFm(qc,Pb):(this.DFm(qc,Uc),this.EFm(Pb,Uc))}DFm(Pb,qc){const Uc=new Sys.Net.WebRequest;Uc.set_httpVerb("GET");const pd={};pd.method=Uc.get_httpVerb();Uc.set_url(Pb);const Od=(new Date).getTime();try{window.fetch(Uc.getResolvedUrl(),pd).then(()=>{""!==qc&&L.rxk(qc,Pb,(new Date).getTime()-Od);
this.Ha.yb("Common.App.Insights.SmartLookupVersion")})}catch(be){L.JR("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+be.toString(),10)}}EFm(Pb,qc){var Uc=new Sys.Net.WebRequest;Uc.set_httpVerb("GET");const pd={};pd.method=Uc.get_httpVerb();Uc.set_url(Pb);let Od=-1;if(e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))Uc=e.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",
3E5),Kb.TaskManager.instance.Qb(new Ga.a(5,1,Uc,()=>{const be=ac.a.create(Pb);be.y0h(()=>{Od=Date.now()});be.lma((te,Le)=>{Le.succeeded?""!==qc&&L.rxk(qc,Pb,Date.now()-Od):L.JR("InsightsPackage - Failed to prefetch JS file.",10)});kc.a.HL(be)}));else{Od=Date.now();try{window.fetch(Uc.getResolvedUrl(),pd).then(()=>{""!==qc&&L.rxk(qc,Pb,Date.now()-Od)})}catch(be){L.JR("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+be.toString(),10)}}}FFm(Pb,qc){if(gb.a.eA){var Uc=e.AFrameworkApplication.ye;
Pb=new Ha.a(Pb,1,null,null,!0,2,null);Uc.send(Pb).vUc(pd=>{pd&&pd.data?pd.data.responseData?this.Ha.yb("Common.App.Insights.SmartLookupVersion"):L.JR("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+pd.data.Ze,10):L.JR("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},pd=>{pd&&pd.data?L.JR("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+pd.data.Ze,10):L.JR("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",
10)});e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupPrefetchJSIsEnabled")&&(qc=new Ha.a(qc,1,null,null,!0,2,null),Uc.send(qc).vUc(pd=>{pd&&pd.data?pd.data.responseData||L.JR("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+pd.data.Ze,10):L.JR("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},pd=>{pd&&pd.data?L.JR("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+
pd.data.Ze,10):L.JR("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.fwe&&this.fwe.dispose()}}Object(c.a)(Hb,"InsightsPackage",null,[3,4]);var ua=a(249),Va=a(299),Yb=a(801),Cb=a(1265),ca=a(1222),Ra=a(273),bb=a(254);class wb{constructor(Pb,qc,Uc,pd=!0){this.streamUrl=Pb;this.objectType=qc;this.formatType=Uc;this.renderAfterInsert=pd}}Object(c.a)(wb,"InsertContentFromStreamData",null,[]);var Fa=a(490),rb=a(251),$b=a(642),ec=a.n($b),
pc=a(250);class dd{constructor(Pb,qc,Uc){this.ia=Pb;this.pa=qc;this.va=Uc}insertOnlinePicture(Pb){const qc=Object(va.a)(31,this.va.Ga);Pb&&qc&&(Pb=Object.assign(new ca.a,{Action:"Insert",Caption:Pb.caption,OriginalUrl:Pb.sourceUrl,Height:Pb.height,Width:Pb.width,LicenseDisplayName:Pb.licenseDisplayName,LicenseUrl:Pb.licenseUrl,ThumbnailUrl:Pb.thumbnailUrl,PageUrl:Pb.pageUrl}),this.ia.Qa(rb.a.gbc,2,Pb))}insertHtmlText(Pb){if(Pb)if(1===this.pa.ud().length){var qc=new Cb.a;pc.a("SanitizeHtmlTextData")?
qc.setValue(Ra.a.mW,ec.a.sanitize(Pb.htmlText)):qc.setValue(Ra.a.mW,Pb.htmlText);qc.setValue(Ra.a.ide,!1);qc=this.ia.Qa(bb.a.ede,2,qc);8!==qc&&2!==qc||this.aBl(Pb)}else this.aBl(Pb)}aBl(Pb){Pb=Object.assign(new Fa.a,{Vqa:!1,oN:Pb.htmlText});this.ia.Qa(rb.a.pka,2,Pb)}insertContentFromStreamUrl(Pb){Pb&&(Pb=new wb(Pb.streamUrl,Pb.objectType,Pb.formatType,Pb.renderAfterInsert),this.ia.Qa(rb.a.Gzc,2,Pb))}getId(){return"InsertContentExecutor"}}Object(c.a)(dd,"InsertContentExecutor",null,[1372,1393]);var Ad=
a(1143),Jb=a(57);class Bc{}Object(c.a)(Bc,"CommandMetadataResponse",null,[]);class Mc{constructor(){this.B9i=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){Jb.PrivacyDialogManager.tUg()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(Pb){const qc=
new Bc;Pb.iconNames&&(qc.svgData=this.getCommandIconSvg(Pb.iconNames));if(!Pb.commandId||""===Pb.commandId)return qc.isVisible=!1,qc;try{qc.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),Pb.commandId);qc.isDisabled=appChrome.selectors.isControlDisabled(Pb.commandId);qc.label=appChrome.selectors.getControlLabel(Pb.commandId);if(qc.svgData&&""!==qc.svgData)return qc;const Uc=appChrome.selectors.getControlIconSet(Pb.commandId),pd=Array(2);pd[0]=Uc["default"];pd[1]=Uc.icon32;qc.svgData=
this.getCommandIconSvg(pd)}catch(Uc){return null}return qc}getCommandIconSvg(Pb){if(!this.B9i)return"";for(let qc=0;qc<Pb.length;qc++){const Uc=Pb[qc];if(Uc in this.B9i)return this.B9i[Uc]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(Pb){const qc={SourceControlId:"GiveFeedback"};qc.feedbackType="true"===Pb.IsPosFeedback?0:1;const Uc={};Uc.featureArea=Mc.AIm;qc.telemetryGroup=Uc;qc.appData=Pb;return qc}}
Mc.BYm="FA000000012";Mc.queryPrefix="AssetID=";Mc.AIm="SearchPane";Object(c.a)(Mc,"BaseSerpletExecutor",null,[1371,1393]);var ed=a(248);class Yc extends Mc{constructor(Pb,qc,Uc){super();this.ia=Pb;this.CKl=qc;this.Qcg=Uc;if(!Pb)throw Error.argumentNull("m_actionManager");}openFeedbackPane(Pb){this.ia.Qa(Pa.a.G5b,2,this.createFeedbackPropertiesFromData(Pb))}openHelpTaskPane(Pb){const qc={};qc.query=Mc.queryPrefix+Pb;Pb={};Pb.assetId=Mc.BYm;Pb.nonPersistedSettings=qc;this.ia.Qa(rb.a.mFa,2,Pb)}browseFiles(){this.ia.Qa(Pa.a.akh,
2,null)}executeCommand(Pb){if(Pb)switch(Pb.CommandId){case 3:appChrome.api.executeCommand(Pb.Data.CommandId,Pb.Data.Payload);break;case 4:if(this.CKl&&this.Qcg)try{this.CKl.b3m(Pb.Data.AST)}catch(qc){ed.a.J(509449952,1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${qc}`)}}}}Object(c.a)(Yc,"PPTSerpletExecutor",Mc,[]);class ab{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(c.a)(ab,"BaseDocumentHelper",null,[1373]);
class jb extends ab{constructor(){super()}isEditingAllowed(){return ua.App.Vb.Pd.isEditingAllowed}}Object(c.a)(jb,"PptDocumentHelper",ab,[]);class cc{constructor(){this.O7g=this.vla=null}kmi(){return null}h8c(){return this.gId()}JPm(){return this.gId()}YPn(Pb,qc,Uc){this.vla||(this.vla=this.Tdh());this.vla.Rn(Pb,qc,Uc)}ZPn(Pb,qc,Uc){this.vla||(this.vla=this.Tdh());this.vla.QIk(Pb,qc,Uc)}lPn(Pb,qc){this.O7g||(this.O7g=this.kmi());this.O7g&&this.O7g.QIk(Pb,qc)}Hvh(Pb,qc){this.vla||(this.vla=this.Tdh());
this.vla.Hvh(Pb,qc)}Psj(Pb){this.vla||(this.vla=this.Tdh());this.vla.Psj(Pb)}bKn(){this.vla&&this.vla.Exk()}uQg(){this.vla&&this.vla.VLn()}WOn(){var Pb=e.AFrameworkApplication.ga.Jc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);Pb=window.performance.now()-cc.MEl<=Pb;Pb||(cc.MEl=window.performance.now());return Pb}dispose(){this.vla&&(this.vla.dispose(),this.vla=null)}get ITf(){return this.vla?this.vla.isVisible:!1}}cc.MEl=0;Object(c.a)(cc,"InsightsManager",null,[68,24]);class Hc{constructor(Pb,
qc,Uc,pd,Od,be=!0,te=null,Le=null){this.Qra=this.eJ=this.jGb=null;this.f3c=!1;this.Yra=null;this.Je=qc;this.dMh=be;this.tWe=Le?Le:new ab;this.Cda=te;this.yV=Pb;this.dMh&&(N.a.instance.yb("Common.App.SearchCommon.SearchHostRuntime")&&(this.Yra=N.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").BOi()),this.gSa=N.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.Bsd=this.gSa.rKd())}jbe(Pb){if(this.dMh){Pb=Pb.rawEvent;try{var qc=V.a(Pb.data)}catch(Uc){r.ULS.sendTraceTag(595161728,
1303,15,this.ROb("Message data from Serplet [{0}] failed to deserialize.",Pb.data));return}switch(qc.actionType){case 101:Pb=0;this.eJ&&(Pb=this.eJ.entryPoint);this.gSa.hHf(this.Qra,this.tWe,this.Rac(),Pb).then(Uc=>{qc.data=Uc;this.xJe(qc)});break;case 118:qc.data=this.eJ?this.eJ:Object.assign(new M.a,{selection:Object.assign(new K.a,{neighborhood:this.jGb.neighborhood,mentionStart:this.jGb.mentionStart,mentionLength:this.jGb.mentionLength})});this.xJe(qc);break;case 103:Pb=V.a(Object(va.a)(String,
qc.data));L.sendTelemetryEvent(Pb);break;case 206:this.gSa.uih(qc.data).then(Uc=>{qc.data=Uc;this.xJe(qc)});break;case 112:qc.data.shiftPressed?(gb.a.zg&&document.activeElement.blur(),this.yV.GLd(0,null,2,null,null),r.ULS.sendTraceTag(592545156,1303,50,this.ROb("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.yV.xAb(0,null,2,null,null),r.ULS.sendTraceTag(592545155,1303,50,this.ROb("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Tw()}}}Ole(Pb){if(this.Yra){var qc=0;this.eJ&&
(qc=this.eJ.entryPoint);this.gSa.hHf(this.Qra,this.tWe,this.Rac(),qc).then(Uc=>{L.Fvh("SearchFromHost",this.Qra);this.eJ.launchData||(this.eJ.launchData=new ba.a);const pd=vb();try{this.Yra.search(this.eJ,Uc,e.AFrameworkApplication.userSessionId,pd,Pb),this.gSa.FTl(Od=>{L.Fvh("SearchFromHostWithToken",this.Qra);this.Yra.searchAuthenticatedProviders(this.eJ,Uc,e.AFrameworkApplication.userSessionId,pd,null,Od)})}catch(Od){L.JR("BaseSmartLookupPane - Fail to search from host. Error: "+Od,10)}}).catch(Uc=>
{L.JR("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+Uc.toString(),10)})}}DPg(Pb){this.dMh&&L.DPg(this.Qra,Math.round(window.performance.now()-Pb),this.eJ?O.a[this.eJ.entryPoint]:"",this.gSa.rKd(),this.gSa.Dul(),e.AFrameworkApplication.tbh,this.f3c,Da(this.eJ?this.eJ.entryPoint:0))}}Object(c.a)(Hc,"BaseSmartLookupPane",null,[1468,24]);class Vc{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(c.a)(Vc,"SmartLookupTaskPaneProps",null,[]);var Tc=a(1028);
class cd{}Object(c.a)(cd,"ActionDescriptor",null,[]);var Lb=a(22);class Rc extends Hc{constructor(Pb,qc,Uc,pd=null,Od=null,be=null,te=!0,Le=null,kf=null){super(qc,Uc,pd,Od,be,te,Le,kf);this.OUh=!!e.AFrameworkApplication.Ea&&!!e.AFrameworkApplication.Ea.Kb&&e.AFrameworkApplication.Ea.Kb.qlh;this.cxe=this.mRh=!1;this.Pjm=e.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.Ojm=e.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",
844);this.Rjm=e.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.Qjm=e.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);this.URl=()=>{if(this.Yra)this.Yra.onPaneThemeChanged(this.Rac());return I.a("getTheme")?appChrome.api.getTheme():null};this.Hxg=()=>{L.JR("ReactSmartLookupPane - Iframe component failed to load.",10)};this.jqn=()=>{e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",
!1)||window.navigator.onLine||L.JR("ReactSmartLookupPane - Onload detected no network.",50)};te||L.JR("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.G9b=Pb;this.B7k=bc(this.Bsd)}get isVisible(){return this.cxe}Hvh(Pb,qc){this.eJ=Pb;this.jGb=Pb=Object.assign(new B.a,{neighborhood:Pb.selection.neighborhood,mentionStart:Pb.selection.mentionStart,mentionLength:Pb.selection.mentionLength});this.f3c=!Pb.mentionLength;this.Qra=qc;this.Ole(!1)}Psj(Pb){this.eJ=
Pb;this.uwb(Object.assign(new B.a,{neighborhood:Pb.selection.neighborhood,mentionStart:Pb.selection.mentionStart,mentionLength:Pb.selection.mentionLength}),!1)}Rn(Pb,qc){this.Qra=qc;this.uwb(Pb,!0)}QIk(Pb,qc,Uc){this.eJ=Pb;this.Rn(Object.assign(new B.a,{neighborhood:Pb.selection.neighborhood,mentionStart:Pb.selection.mentionStart,mentionLength:Pb.selection.mentionLength}),qc,Uc)}Tw(){this.hwh();this.G9b.hideTaskPane()}uwb(Pb,qc){P.SessionStatusManager.instance.gga&&this.Yra?(this.jGb=Pb,this.f3c=
!Pb.mentionLength,Pb=window.performance.now(),this.initialize(),this.isVisible?e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupDisableRefreshPaneIsEnabled")?(this.G9b.updateTaskPane(null),qc&&this.qKn()):(qc&&this.Ole(!1),this.mRh=!this.mRh,this.G9b.updateTaskPane(this.OYa())):(qc&&this.Ole(this.isVisible),this.G9b.showTaskPane(this.OYa())),this.DPg(Pb)):(this.G9b.showTaskPane(this.OYa()),L.dKn(P.SessionStatusManager.instance.gga,!!this.Yra,this.eJ?O.a[this.eJ.entryPoint]:"",this.gSa.rKd(),
e.AFrameworkApplication.tbh,this.f3c))}qKn(){if(!this.eJ){const Pb=Object.assign(new K.a,{neighborhood:this.jGb.neighborhood,mentionStart:this.jGb.mentionStart,mentionLength:this.jGb.mentionLength});this.eJ=Object.assign(new M.a,{selection:Pb,userIntent:null,entryPoint:0,launchData:null})}this.Ole(this.isVisible)}lKn(){const Pb=new cd;Pb.transactionId=this.Qra;Pb.actionType=15;Pb.channelId=A.channelId;this.xJe(Pb)}jbe(Pb){const qc=Pb.rawEvent;document.getElementById(A.JUa)&&qc.source!==document.getElementById(A.JUa).contentWindow||
this.SCn(Pb)}SCn(Pb){const qc=Pb.rawEvent;let Uc;try{Uc=V.b(qc.data)}catch(pd){r.ULS.sendTraceTag(545604257,1303,15,this.ROb("Message data from Serplet [{0}] failed to deserialize.",qc.data));return}switch(Uc.actionType){case 32:e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(Lb.a.dDe()>=this.Pjm?this.G9b.updateTaskPane(this.wqi(this.Ojm)):Lb.a.dDe()>=this.Rjm&&this.G9b.updateTaskPane(this.wqi(this.Qjm)));break;case 33:e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",
!1)&&this.G9b.updateTaskPane(this.wqi(Uc.data));break;case 42:this.G9b.updateTaskPane(this.DCm(Uc.data));break;case 43:this.G9b.updateTaskPane(this.OYa());break;default:super.jbe(Pb)}}dispose(){}initialize(){this.v6b()}v6b(){const Pb=this.Je.gd(A.JUa);Pb.parent=ra.AFrame.vl;Pb.$V=!0}iwh(){this.Je.gh(A.JUa)}hwh(){this.pqj()&&this.Je.gh(this.Je.SDa)}ulk(){$addHandler(window,"message",Object(w.a)(this,this.jbe,"onIFrameMessage"))}eWk(){$removeHandler(window,"message",Object(w.a)(this,this.jbe,"onIFrameMessage"))}pqj(){return!!this.Je.currentScope&&
this.Je.currentScope.name===A.JUa}xJe(Pb){Pb=V.c(Pb);document.getElementById(A.JUa)&&document.getElementById(A.JUa).contentWindow.postMessage(Pb,La.a.getOrigin(this.B7k))}ROb(Pb,...qc){const Uc={};this.Qra&&(Uc[A.f7l]=this.Qra);Uc[A.g7l]=String.format.apply(null,[Pb].concat(qc));return V.c(Uc)}Rac(){return I.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}Exk(){}VLn(){document.getElementById(A.JUa)&&u.FocusManager.UA(document.getElementById(A.JUa).contentWindow)}rOm(){let Pb="";
return this.eJ?Pb=10===this.eJ.entryPoint?2===e.AFrameworkApplication.Ea.Kb.Im?Object(z.a)("ReuseSlidesPaneTitle"):Object(z.a)("ReuseFilesPaneTitle"):18===this.eJ.entryPoint?Object(z.a)("FindInDocumentPaneTitle"):37===this.eJ.entryPoint?Object(z.a)("SummarizePaneTitle"):36===this.eJ.entryPoint||38===this.eJ.entryPoint?Object(z.a)("ConvertToDeckPaneTitle"):Object(z.a)("SmartLookupPaneTitle"):Pb}OYa(){var Pb=Object(z.a)("SmartLookupPaneTitle");e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",
!1)&&(Pb=this.rOm());const qc=new Vc;qc.src=this.B7k;qc.id=A.JUa;qc.refreshPane=this.mRh;qc.onError=this.Hxg;qc.onLoad=this.jqn;qc.title=Pb;P.SessionStatusManager.instance.gga?this.Yra||(qc.errorMessage=Object(z.a)("SmartLookupPaneInitializationError"),qc.errorType=1):(qc.errorMessage=Object(z.a)("SmartLookupPaneNetworkDisconnected"),qc.errorType=0);Pb=Object.assign(new Tc.a,{title:Pb,hideHeader:!1,width:A.width,location:A.Wtn,contentProps:qc,isModernPane:!0,onOpen:()=>{this.iwh();this.cxe=!0;this.ulk();
I.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(this.URl);e.AFrameworkApplication.Ea.Zf();if(this.Yra)this.Yra.onPaneStateChanged(!0)},onClose:()=>{this.lKn();this.hwh();this.cxe=!1;this.eWk();I.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(this.URl);e.AFrameworkApplication.Ea.Zf();if(this.Yra)this.Yra.onPaneStateChanged(!1)}});this.OUh&&(Pb.enableResize=!0,Pb.minResizeWidth=320,Pb.maxResizeWidth=920);return Pb}DCm(Pb){const qc=this.OYa();
qc.title=Pb;qc.contentProps.title=Pb;return qc}wqi(Pb){const qc=this.OYa();qc.resizeWidth=Pb;return qc}}Object(c.a)(Rc,"ReactSmartLookupPane",Hc,[]);var md=a(55);class Zc{constructor(){this.y8k=e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartLookupPaneResizingEnabled",!1)}showTaskPane(Pb){md.a.Py().then(qc=>{this.y8k||(Pb.enableResize=!1);qc.showTaskPane(A.JUa,Pb);return null})}updateTaskPane(Pb=null){md.a.Py().then(qc=>{qc.setSelectedTaskPane(A.JUa);Pb&&(this.y8k||
(Pb.enableResize=!1),qc.updateTaskPane(A.JUa,Pb));return null})}hideTaskPane(){md.a.Py().then(Pb=>{Pb.hideTaskPane(A.JUa,2);return null})}}Object(c.a)(Zc,"PptReactSmartLookupPaneHandler",null,[1444]);var ld=a(284);class fe{static vWi(){switch(e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableProdSourceLocationOverride")?"PROD":e.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableIntSourceLocationOverride")?
"INT":fe.EOm()){case "INT":return"WAC.INT.URL";case "EDOG":return"WAC.EDOG.URL";default:return"WAC.PROD.URL"}}static EOm(){switch(Object(va.a)(String,e.AFrameworkApplication.Rf.AudienceGroup)||""){case "Dogfood":if(e.AFrameworkApplication.ga){let Pb=e.AFrameworkApplication.ga.La("UserPrincipalName");Pb=Mb.a.mj(Pb);const qc=e.AFrameworkApplication.ga.Tz("SmartLookupINTEnabledForSKITeam")?e.AFrameworkApplication.ga.tF("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(qc,Pb)?"INT":"EDOG"}return"EDOG";
default:return"PROD"}}}Object(c.a)(fe,"Utils",null,[]);class Ac{constructor(Pb,qc=null){this.Qra=this.eJ=this.jGb=null;this.f3c=!1;this.Yra=null;this.yV=Pb;this.tWe=qc?qc:new ab;N.a.instance.yb("Common.App.SearchCommon.SearchHostRuntime")&&(this.Yra=N.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").BOi());this.gSa=N.a.instance.resolve("Common.App.SearchCommon.ISearchHelper");this.Bsd=this.gSa.rKd()}Ole(Pb){if(this.Yra){var qc=0;this.eJ&&(qc=this.eJ.entryPoint);this.gSa.hHf(this.Qra,
this.tWe,this.Rac(),qc).then(Uc=>{L.Fvh("SearchFromHost",this.Qra);this.eJ.launchData||(this.eJ.launchData=new ba.a);const pd=vb();try{this.Yra.search(this.eJ,Uc,e.AFrameworkApplication.userSessionId,pd,Pb),this.gSa.FTl(Od=>{L.Fvh("SearchFromHostWithToken",this.Qra);this.Yra.searchAuthenticatedProviders(this.eJ,Uc,e.AFrameworkApplication.userSessionId,pd,null,Od)})}catch(Od){L.JR("BaseSmartLookupPane - Fail to search from host. Error: "+Od,10)}}).catch(Uc=>{L.JR("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+
Uc.toString(),10)})}}ulk(){$addHandler(window,"message",Object(w.a)(this,this.jbe,"onIFrameMessage"))}eWk(){$removeHandler(window,"message",Object(w.a)(this,this.jbe,"onIFrameMessage"))}xJe(Pb){Pb=V.c(Pb);document.getElementById(this.jJd())&&document.getElementById(this.jJd()).contentWindow.postMessage(Pb,La.a.getOrigin(uc()))}jbe(Pb){let qc;Pb=Pb.rawEvent;try{qc=V.b(Pb.data)}catch(Uc){r.ULS.sendTraceTag(509614105,1303,15,this.ROb("Message data from Serplet [{0}] failed to deserialize.",Pb.data));
return}switch(qc.actionType){case 103:Pb=V.b(Object(va.a)(String,qc.data));L.sendTelemetryEvent(Pb);break;case 206:this.gSa.uih(qc.data).then(Uc=>{qc.data=Uc;this.xJe(qc)});break;case 112:qc.data.shiftPressed?(gb.a.zg&&document.activeElement.blur(),this.yV.GLd(0,null,2,null,null),r.ULS.sendTraceTag(509614104,1303,50,this.ROb("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.yV.xAb(0,null,2,null,null),r.ULS.sendTraceTag(509614103,1303,50,this.ROb("Serplet UX lost focus through Ctrl + F6")));
break;case 40:this.Tw()}}ROb(Pb,...qc){const Uc={};this.Qra&&(Uc[A.f7l]=this.Qra);Uc[A.g7l]=String.format.apply(null,[Pb].concat(qc));return V.c(Uc)}DPg(Pb){L.DPg(this.Qra,Math.round(window.performance.now()-Pb),this.eJ?O.a[this.eJ.entryPoint]:"",this.gSa.rKd(),this.gSa.Dul(),e.AFrameworkApplication.tbh,this.f3c,Da(this.eJ?this.eJ.entryPoint:0))}}Ac.esm="AppProperties";Ac.nRn="SmartLookupApplicationInterface";Object(c.a)(Ac,"BaseCopilotAddin",null,[1467,24]);class R extends Ac{constructor(Pb,qc,Uc,
pd){if(!Pb)throw Error.argumentNull("actionManager");if(!qc)throw Error.argumentNull("appForOfficeManager");if(!pd)throw Error.argumentNull("f6Manager");super(pd,Uc);this.mc=!1;this.HJl=!0;this.HGl="FA000000006";this.ia=Pb;this.Hd=qc;this.yH={};this.zen=fe.vWi();this.yH.sourceLocationOverrideResourceId=this.zen;this.yH.JB="Copilot";this.yH.assetId=this.HGl}QIk(Pb,qc){this.eJ=Pb;const Uc=Object.assign(new B.a,{neighborhood:Pb.selection.neighborhood,mentionStart:Pb.selection.mentionStart,mentionLength:Pb.selection.mentionLength});
this.Qra=qc;this.jGb=Uc;this.f3c=!Uc.mentionLength;P.SessionStatusManager.instance.gga&&this.Yra?(this.Ole(!1),this.gSa.hHf(this.Qra,this.tWe,this.Rac(),Pb.entryPoint).then(pd=>{pd.isFirstLaunch=this.HJl;this.HJl=!1;const Od={};Od[Ac.nRn]=this.eJ;Od[Ac.esm]=pd;this.yH.nonPersistedSettings=Od;this.yH.LU=Object(w.a)(this,this.eQc,"onPaneRendered");this.ia.Qa(rb.a.mFa,2,this.yH);this.mc=!0})):(this.ia.Qa(rb.a.mFa,2,this.yH),this.mc=!0)}eQc(){this.ulk()}Tw(){const Pb=this.jJd();this.eWk();Pb&&this.ia&&
this.ia.Qa(rb.a.JLb,2,Pb);this.mc=!1}Hvh(Pb,qc){this.eJ=Pb;this.jGb=Pb=Object.assign(new B.a,{neighborhood:Pb.selection.neighborhood,mentionStart:Pb.selection.mentionStart,mentionLength:Pb.selection.mentionLength});this.f3c=!Pb.mentionLength;this.Qra=qc;this.Ole(!1)}dispose(){}jJd(){if(this.Hd.instance){const Pb=this.Hd.instance.xT(this.HGl+"."+this.yH.sourceLocationOverrideResourceId);if(Pb)return Pb.Kp;ed.a.J(509433935,1313,15,"PPT Copilot Addin: Could not find task pane from ID.")}else ed.a.J(509433934,
1313,15,"PPT Copilot Addin: AppForOfficeManager is unavailable.");return null}Rac(){return I.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}get isVisible(){return this.mc}}Object(c.a)(R,"PptCopilotAddin",Ac,[]);class za extends cc{constructor(Pb,qc,Uc,pd,Od){super();this.FLl=Pb;this.Fb=Uc;this.ia=pd;this.Hd=Od}Tdh(){const Pb=this.Fb.getBooleanAppSetting(ld.a.kUa);return new Rc(new Zc,h.a.instance,u.FocusManager.instance(),N.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),
N.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),N.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),Pb,N.a.instance.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))}kmi(){return this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?new R(this.ia,this.Hd,null,h.a.instance):super.kmi()}gId(){return this.FLl.getSelectedText()}CCl(){return this.FLl.zhj()}}Object(c.a)(za,"SmartLookupManager",cc,[]);var X=a(69);class lb{constructor(Pb,
qc,Uc,pd,Od,be,te){this.LD=Pb;this.Mb=qc;this.Jen=Uc;this.een=pd;this.ven=Od;this.kcn=be;this.uMl=te;this.WFc=new Map;if(!Pb)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!qc)throw Error.argumentNull("m_transactionFactory");if(!Uc)throw Error.argumentNull("m_textODSLEntity");if(!pd)throw Error.argumentNull("m_shapeODSLEntity");if(!Od)throw Error.argumentNull("m_slideODSLEntity");if(!be)throw Error.argumentNull("m_imageODSLEntity");if(!te)throw Error.argumentNull("m_tablesODSLEntity");
this.LD&&this.LD.execute(Le=>{this.Hd=Le});this.WFc=new Map;this.WFc.set("text",this.Jen);this.WFc.set("shapes",this.een);this.WFc.set("slides",this.ven);this.WFc.set("images",this.kcn);this.WFc.set("tables",this.uMl);this.WFc.set("table",this.uMl)}mzm(Pb,qc){return Object.assign({},...Pb.map(Uc=>qc.has(Uc.value)?{[Uc.name]:qc.get(Uc.value)}:{[Uc.name]:JSON.parse(Uc.value)}))}b3m(Pb){Object(X.b)(this,void 0,void 0,function*(){if(this.Hd){var qc=this.Mb.qe(15);try{qc.rc(this.Hd.Sy.presentation);const Uc=
new Map;for(const pd of Pb.statements){const Od=pd.name.split("_");if(2!==Od.length)throw Error.argumentOutOfRange("statement",Od,"Provided ODSL statement does not have expected format of action_entity.");const be=Od[0],te=Od[1];if(!this.WFc.has(te))throw Error.argumentOutOfRange("entityName",te,"Provided entity name in ODSL statement is not supported.");const Le=this.WFc.get(te);if(!Le)throw Error.argumentOutOfRange("entity",Le,"Could not access entity for provided ODSL statement.");const kf=this.mzm(pd.arguments,
Uc);if(!kf)throw Error.argumentOutOfRange("args",kf,"Could not construct ODSL statement input from provided args.");let fg;switch(be){case "select":fg=yield Le.select(kf);break;case "format":fg=yield Le.format(kf);break;case "insert":fg=yield Le.insert(kf);break;case "delete":fg=yield Le.delete(kf);break;case "default":throw Error.argumentOutOfRange("action",be,"Provided action in ODSL statement is not supported.");}pd.returnVariable&&fg&&Uc.set(pd.returnVariable,fg)}}catch(Uc){ed.a.J(509440020,1313,
15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${Uc}`)}finally{qc&&qc.dispose()}}else ed.a.J(509440021,1313,15,"SmartLookup ODSLInterpreter interpret: Skipping execution because no AppForOfficeManager instance exists.")})}}Object(c.a)(lb,"ODSLInterpreter",null,[1392]);var oc=a(267),Oc;(function(Pb){Pb.Idle="Idle";Pb.TranscribingVoice="TranscribingVoice";Pb.EndPending="EndPending";Pb.EndPendingWithCancel="EndPendingWithCancel";Pb.CancelPending="CancelPending"})(Oc||
(Oc={}));Object(c.b)("DictationState",Oc);class sd{constructor(Pb,qc,Uc,pd,Od){this.$b=Pb;this.ia=qc;this.qj=Uc;this.Ma=pd;this.QEj=[];this.Bmh=[];this.Eoa=Oc.Idle;this.uoh=!1;this.uYd=oc.a.Hdh;this.onAction=be=>{if(be)switch(be.actionType){case "SubmitQuery":this.KXm(be.query);break;case "ToggleDictation":this.GWm();break;case "CancelQuery":this.JXm()}};this.NLi=()=>[this.QEj.join(" "),this.Bmh.join()].join(" ");if(!this.$b)throw Error.argumentNull("m_workspace");if(!this.ia)throw Error.argumentNull("m_actionManager");
if(!this.qj)throw Error.argumentNull("m_f6Manager");if(!this.Ma)throw Error.argumentNull("m_focusManager");if(!Od)throw Error.argumentNull("actorFuture");Od.execute(()=>{this.start().catch(be=>{r.ULS.sendTraceTag(509440287,1313,10,`Unable to start Copilot UX, error: ${be}`)})})}QXi(){this.IXm();return""}bxl(){return""}HWg(){this.CXm();return!0}jtc(){this.lWm()}Hgl(Pb){this.VVm(Pb);return!0}$Al(Pb){this.nWm(Pb);return!0}QNl(){}XLe(Pb){var qc,Uc;r.ULS.sendTraceTag(509113183,1313,15,`Unexpected "${Pb}" called for Dictation FSM state: "${this.Eoa}". Listening: "${this.uoh}"`);
this.uoh?(this.Eoa=Oc.EndPending,this.Iyh()):(this.Eoa=Oc.Idle,null===(Uc=null===(qc=this.kFc)||void 0===qc?void 0:qc.setMicState)||void 0===Uc?void 0:Uc.call(qc,!1))}M9l(Pb){var qc,Uc;null===(Uc=null===(qc=this.kFc)||void 0===qc?void 0:qc.setMicState)||void 0===Uc?void 0:Uc.call(qc,Pb)}IXm(){this.Eoa!==Oc.Idle&&this.Eoa!==Oc.EndPending?this.XLe("handleTextBeforeSelection"):(this.Eoa=Oc.TranscribingVoice,this.M9l(!0))}CXm(){this.Eoa!==Oc.TranscribingVoice&&this.Eoa!==Oc.EndPending?this.XLe("handleStartTurn"):
this.Eoa=Oc.TranscribingVoice}lWm(){switch(this.Eoa){case Oc.EndPending:case Oc.EndPendingWithCancel:this.M9l(!1);const Pb=this.NLi();0<Pb.length&&this.Eoa===Oc.EndPending&&this.$Ql(Pb);this.QEj=[];this.Bmh=[];this.Eoa=Oc.Idle;break;case Oc.CancelPending:this.Eoa=Oc.EndPendingWithCancel;break;case Oc.TranscribingVoice:this.Eoa=Oc.EndPending;break;case Oc.Idle:break;default:this.XLe("handleEndTurn")}}LXm(){this.Eoa!==Oc.TranscribingVoice?this.XLe("handleTimeout"):this.Eoa=Oc.CancelPending}VVm(Pb){var qc,
Uc;this.Eoa!==Oc.TranscribingVoice?this.XLe("handleAppendText"):this.kFc&&(this.Bmh.push(Pb),null===(Uc=(qc=this.kFc).setQuery)||void 0===Uc?void 0:Uc.call(qc,this.NLi()))}nWm(Pb){var qc,Uc;this.Eoa!==Oc.TranscribingVoice?this.XLe("handleFinalText"):(this.Bmh=[],""===Pb?this.LXm():this.kFc&&(this.QEj.push(Pb),null===(Uc=(qc=this.kFc).setQuery)||void 0===Uc?void 0:Uc.call(qc,this.NLi())))}KXm(Pb){this.Eoa!=Oc.Idle?this.Iyh():this.$Ql(Pb)}JXm(){this.Eoa!==Oc.Idle&&(this.Iyh(),this.Eoa=Oc.CancelPending)}GWm(){this.Iyh()}Iyh(){this.ia.Qa(bb.a.pse,
2,{gol:sd.Zbm});this.uoh=!this.uoh}$Ql(Pb){Pb=Object.assign(new M.a,{selection:Object.assign(new K.a,{neighborhood:Pb,mentionStart:0,mentionLength:Pb.length}),launchData:Object.assign(new ba.a,{landingTab:"Copilot"}),entryPoint:0});this.ia.Qa(Pa.a.pPf,2,Pb)}nNm(){var Pb;this.waa||(this.waa=document.createElement("div"),this.waa.id="copilotHost",(null!==(Pb=document.getElementById(sd.Uvm))&&void 0!==Pb?Pb:document.body).appendChild(this.waa));return this.waa}MNn(){this.Ma.Atd(this.uYd);const Pb=this.Ma.gd(this.uYd);
Pb.parent=ra.AFrame.vl;Pb.$V=!0;Pb.G9(()=>{var qc;null===(qc=this.kFc)||void 0===qc?void 0:qc.focus()});this.qj.zja(this.uYd);this.qj.XW(this.uYd);this.waa.addEventListener("focusin",qc=>{var Uc;qc.preventDefault();qc.stopPropagation();(null===(Uc=this.Ma.currentScope)||void 0===Uc?void 0:Uc.name)!==this.uYd&&this.Ma.yia(this.uYd,!1)});this.waa.addEventListener("focusout",qc=>{var Uc,pd,Od;qc.preventDefault();qc.stopPropagation();for(qc=null!==(Uc=qc.relatedTarget)&&void 0!==Uc?Uc:document.activeElement;qc;){if(qc===
this.waa)return;qc=qc.parentElement}null===(Od=null===(pd=this.kFc)||void 0===pd?void 0:pd.collapse)||void 0===Od?void 0:Od.call(pd);this.Ma.qka(this.uYd,!1)})}start(){return Object(X.b)(this,void 0,void 0,function*(){const Pb=this.nNm();this.kFc=yield(yield md.a.lNm()).renderCopilot(Pb,{onAction:this.onAction});if(!this.kFc)throw Error("Copilot control interface is not returned.");this.MNn()})}}sd.Uvm="WACViewPanelContainer";sd.Zbm="PowerPointWebEditor.SmartLookup.FABDictationHost";Object(c.a)(sd,
"PptCopilot",null,[1165]);var Ld=a(1108),Qd=a(1106),Id=a(1107),he=a(1169),xb=a(1105),Sb=a(1118),Cc=a(417),qb=a(1109);class Ob extends Hb{constructor(){super()}get name(){return"Ppt.SmartLookup"}init(){e.AFrameworkApplication.j7b&&this.HFm()}lc(Pb){super.lc(Pb);Pb.register(Yb.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().na(()=>new Yb.a);Pb.register(za,"PowerPointWebEditor.SmartLookup.SmartLookupManager").as("Common.App.Insights.IInsightsManager").ma().na(()=>
new za(Pb.resolve("Common.App.Insights.IInsightsSelection"),Pb,Pb.resolve("Common.IAppSettingsManager"),Pb.resolve("Common.IActionManagerExtended"),Pb.Na("PowerPointWebEditor.IAppForOfficeManager")));Pb.register(1370,"Common.App.SearchCommon.IDocumentContentExecutor").as("Common.App.SearchCommon.IDocumentContentExecutor").ma().na(()=>new Ad.a(new b.a(()=>ua.App.Vb?ua.App.Vb.Pd.gj:null),Va.InteractiveViewManager.instance,Pb.resolve("Box4.ISelectionFactory"),Pb.resolve("PowerPointWebEditor.ISlideReader"),
Pb.resolve("PowerPointWebEditor.IPPTWorkspace"),Pb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new f.a,Pb.resolve("Common.IActionManagerExtended"),Pb.resolve("PowerPointWebEditor.IPptSelectionManager"),Pb.resolve("PowerPointWebEditor.IClipServiceManager"),Pb.resolve("PowerPointWebEditor.IPresentationReader")));e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableHALO",!1)&&(Pb.register(Cc.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").as("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").ma().na(()=>
new Cc.a(Pb.resolve("Box4.Graph.IGraphIteratorFactory"),Pb.resolve("Box4.IOutlineEditor"),Pb.resolve("Box4.IOutlineElementNavigator"),Pb.resolve("Box4.ICharacterPropertiesEditor"))),Pb.register(xb.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").ma().na(()=>new xb.a(Pb.Na("PowerPointWebEditor.AppForOfficeManager"),Pb.resolve("PowerPointWebEditor.IPptSelectionManager"),Pb.resolve("Box4.IFormattingEditor"),Pb.resolve("Box4.IParagraphEditor"),
Pb.resolve("PowerPointWebEditor.IShapeReader"),Pb.resolve("Box4.List.IListEditor"),Pb.resolve("Box4.ICharacterPropertiesEditor"),Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),Pb.register(Qd.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").ma().na(()=>new Qd.a(Pb.Na("PowerPointWebEditor.AppForOfficeManager"),Pb.resolve("PowerPointWebEditor.IPptSelectionManager"),Pb.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),
Pb.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),Pb.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),Pb.resolve("PowerPointWebEditor.IShapeReader"),Pb.resolve("PowerPointWebEditor.IShapeEditor"),Pb.resolve("PowerPointWebEditor.IPPTUnitConversion"),Pb.resolve("PowerPointWebEditor.View.IPPTPageView"),Pb.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Pb.resolve("PowerPointWebEditor.IRibbonChangeManager"))),Pb.register(Id.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").ma().na(()=>
new Id.a(Pb.Na("PowerPointWebEditor.AppForOfficeManager"),Pb.resolve("PowerPointWebEditor.IPptSelectionManager"),Pb.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Pb.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"))),Pb.register(Ld.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").ma().na(()=>new Ld.a(Pb.Na("PowerPointWebEditor.AppForOfficeManager"),Pb.resolve("PowerPointWebEditor.IPptSelectionManager"))),
Pb.register(he.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").ma().na(()=>new he.a(Pb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Pb.resolve("PowerPointWebEditor.IPptSelectionManager"),Pb.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Pb.resolve("PowerPointWebEditor.IFocusManager"),Pb.resolve("PowerPointWebEditor.IShapeEditor"),Pb.resolve("PowerPointWebEditor.IRibbonChangeManager"),Pb.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),
Pb.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Pb.resolve("Common.IActionManagerExtended"),Pb.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),Pb.register(Sb.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLContext").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext").ma().na(()=>new Sb.a(Pb.Na("PowerPointWebEditor.AppForOfficeManager"),Pb.resolve("PowerPointWebEditor.IPptSelectionManager"),
Pb.resolve("PowerPointWebEditor.IShapeReader"))),Pb.register(lb,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLInterpreter").as("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter").ma().na(()=>new lb(Pb.Na("PowerPointWebEditor.AppForOfficeManager"),Pb.resolve("Common.Transaction.ITransactionFactory"),Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),
Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"),Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"))),Pb.register(qb.a,"PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").as("PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").ma().na(()=>new qb.a(Pb.resolve("PowerPointWebEditor.IPptSelectionManager"),Pb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Pb.resolve("Common.Transaction.ITransactionFactory"),
Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"),Pb.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"))));Pb.register(1371,"Common.App.SearchCommon.ISerpletExecutor").as("Common.App.SearchCommon.ISerpletExecutor").ma().na(()=>new Yc(Pb.resolve("Common.IActionManagerExtended"),
Pb.yb("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter"),Pb.yb("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext")));Pb.register(1372,"Common.App.SearchCommon.IInsertContentExecutor").as("Common.App.SearchCommon.IInsertContentExecutor").ma().na(()=>new dd(e.AFrameworkApplication.vb,Pb.resolve("PowerPointWebEditor.IPptSelectionManager"),Pb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));Pb.register(1373,"Common.App.SearchCommon.IDocumentHelper").ma().na(()=>new jb);
e.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotUxIsEnabled",!1)&&(Pb.register(sd,"PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.FABDictationHost").ma().na(()=>new sd(Pb.resolve("PowerPointWebEditor.IPPTWorkspace"),Pb.resolve("Common.IActionManagerExtended"),h.a.instance,u.FocusManager.instance(),Pb.Na("Common.App.Insights.InsightsActor"))),Pb.resolve("PowerPointWebEditor.SmartLookup.PptCopilot"))}static main(){m.a.instance.Fc(new Ob)}}
Object(c.a)(Ob,"PptSmartLookupPackage",Hb,[]);Type.registerNamespace("PowerPointWebEditor.SmartLookup");Ob.main()},346:function(x,G,a){a.r(G);a.d(G,"AnnotationState",function(){return c});a.d(G,"OperationErrorCode",function(){return h});a.d(G,"ItemOperation",function(){return f});a.d(G,"ItemChanges",function(){return e});a.d(G,"EntryPoint",function(){return b});a.d(G,"ecsMetadataBlockHeight",function(){return 512});a.d(G,"ecsMetadataBlockWidth",function(){return 32});a.d(G,"BlobRefType",function(){return u});
a.d(G,"OpenType",function(){return m});a.d(G,"GridConstants",function(){return n});a.d(G,"Annotation",function(){return r});a.d(G,"BinaryClassificationAnnotation",function(){return w});a.d(G,"Event",function(){return y});a.d(G,"UserCommand",function(){return z});a.d(G,"ItemDelta",function(){return A.f});a.d(G,"ItemChangesDelta",function(){return A.e});a.d(G,"Operation",function(){return A.i});a.d(G,"OperationWithSiblingContext",function(){return A.j});a.d(G,"AddOperation",function(){return A.a});
a.d(G,"MoveOperation",function(){return A.h});a.d(G,"UpdateAnnotationMetaDataOperation",function(){return A.n});a.d(G,"UpdateOperation",function(){return A.o});a.d(G,"DeleteOperation",function(){return A.b});a.d(G,"PurgeOperation",function(){return A.k});a.d(G,"PurgeSubtreeOperation",function(){return A.l});a.d(G,"FocusOperation",function(){return A.d});a.d(G,"VisibilityOperation",function(){return A.p});a.d(G,"DeltaUpdateOperation",function(){return A.c});a.d(G,"MicroSyncOperation",function(){return A.g});
a.d(G,"SignalOperation",function(){return A.m});a.d(G,"SchemaObject",function(){return l.a});a.d(G,"Signal",function(){return B});a.d(G,"DirtyAreaSignal",function(){return H});a.d(G,"Blob",function(){return v});a.d(G,"Binary",function(){return C});a.d(G,"TileGroup",function(){return F});a.d(G,"Session",function(){return D});a.d(G,"Document",function(){return N});a.d(G,"SubDocument",function(){return U});a.d(G,"GridCell",function(){return W});a.d(G,"GridNeighborhoodContext",function(){return L});a.d(G,
"ItemFilter",function(){return O});a.d(G,"DynamicContext",function(){return M});a.d(G,"ContextHolder",function(){return K});a.d(G,"UserContextHolder",function(){return P});a.d(G,"TenantContextHolder",function(){return V});a.d(G,"EventsHolder",function(){return Y});a.d(G,"UserCommandsHolder",function(){return ta});var c;(function(fa){fa[fa.Undefined=0]="Undefined";fa[fa.Created=10]="Created";fa[fa.Sent=20]="Sent";fa[fa.Duplicated=30]="Duplicated";fa[fa.Seen=40]="Seen";fa[fa.Tried=50]="Tried";fa[fa.Kept=
60]="Kept";fa[fa.Rejected=70]="Rejected"})(c||(c={}));var b;(function(fa){fa.Canvas="Canvas";fa.CopilotChat="CopilotChat";fa.Test="Test"})(b||(b={}));var f;(function(fa){fa[fa.None=0]="None";fa[fa.Added=1]="Added";fa[fa.Updated=2]="Updated";fa[fa.Deleted=3]="Deleted"})(f||(f={}));var e;(function(fa){fa[fa.ContentChanged=0]="ContentChanged";fa[fa.ContentWasEmpty=1]="ContentWasEmpty";fa[fa.FormattingChanged=2]="FormattingChanged";fa[fa.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"})(e||
(e={}));var h;(function(fa){fa[fa.AddOfZeroElements=0]="AddOfZeroElements";fa[fa.AddOfItemsWithExtraOrMissingIds=1]="AddOfItemsWithExtraOrMissingIds";fa[fa.AddOfItemWithUndefinedId=2]="AddOfItemWithUndefinedId";fa[fa.AddOfUndefinedItem=3]="AddOfUndefinedItem";fa[fa.AddOfItemsWithDuplicateIds=4]="AddOfItemsWithDuplicateIds";fa[fa.SetHeadToNonExistingItem=5]="SetHeadToNonExistingItem";fa[fa.DeleteOfNonExistingItem=6]="DeleteOfNonExistingItem";fa[fa.UpdateOfNonExistentItem=7]="UpdateOfNonExistentItem";
fa[fa.UpdateOfStubbedItem=8]="UpdateOfStubbedItem";fa[fa.MoveOfNonExistentItem=9]="MoveOfNonExistentItem";fa[fa.UpdateMetaDataOfNonAnnotationType=10]="UpdateMetaDataOfNonAnnotationType";fa[fa.SequentialyInvertedUpdate=11]="SequentialyInvertedUpdate";fa[fa.DeltaOfNonExistingItem=100]="DeltaOfNonExistingItem"})(h||(h={}));var u;(function(fa){fa[fa.None=0]="None";fa[fa.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl";fa[fa.AlCodedLocation=2]="AlCodedLocation";fa[fa.Token=3]="Token"})(u||(u={}));var m;(function(fa){fa[fa.NewDocument=
0]="NewDocument";fa[fa.EditDocument=1]="EditDocument";fa[fa.ViewOnlyDocument=2]="ViewOnlyDocument"})(m||(m={}));class n{}n.lowerIndexBound=1;n.maxNumberOfRows=1048576;n.maxNumberOfColumns=16384;n.firstColumnName="A";n.lastColumnName="XFD";var l=a(364);class r{get metadata(){return this.M_}set metadata(fa){this.M_=fa}constructor(fa){l.a.assign(r,this,fa)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[r.getTypeName()])}}
r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class w{get metadata(){return this.M_}set metadata(fa){this.M_=fa}constructor(fa){l.a.assign(w,this,fa)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class y{constructor(fa){l.a.assign(y,this,fa)}static getTypeName(){return"AugLoop_Core_Event"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,
[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class z{constructor(fa){l.a.assign(z,this,fa)}static getTypeName(){return"AugLoop_Core_UserCommand"}static getBaseTypes(){return["AugLoop_Core_Event"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};var A=a(566);class B{constructor(fa){l.a.assign(B,this,fa)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,
[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class H{constructor(fa){l.a.assign(H,this,fa)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class v{constructor(fa){l.a.assign(v,this,fa)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,
[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class C{constructor(fa){l.a.assign(C,this,fa)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class F{constructor(fa){l.a.assign(F,this,fa)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[F.getTypeName()])}}
F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class D{constructor(fa){l.a.assign(D,this,fa)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class N{constructor(fa){l.a.assign(N,this,fa)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,
[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class U{constructor(fa){l.a.assign(U,this,fa)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class W{constructor(fa){l.a.assign(W,this,fa)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[W.getTypeName()])}}
W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class L{constructor(fa){l.a.assign(L,this,fa)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class O{constructor(fa){l.a.assign(O,this,fa)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[O.getTypeName()])}}
O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class M{constructor(fa){l.a.assign(M,this,fa)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class K{constructor(fa){l.a.assign(K,this,fa)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[K.getTypeName()])}}
K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class P{constructor(fa){l.a.assign(P,this,fa)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class V{constructor(fa){l.a.assign(V,this,fa)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,
[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class Y{constructor(fa){l.a.assign(Y,this,fa)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class ta{constructor(fa){l.a.assign(ta,this,fa)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,
[ta.getTypeName()])}}ta.H_={T_:ta.getTypeName(),B_:ta.getBaseTypes()}},417:function(x,G,a){a.d(G,"a",function(){return u});x=a(0);var c=a(252),b=a(264),f=a(68),e=a(253),h=a(574);class u{constructor(m,n,l,r){this.Pb=m;this.spb=n;this.Jza=l;this.xH=r;if(!m)throw Error.argumentNull("m_graphIteratorFactory");if(!n)throw Error.argumentNull("m_outlineEditor");if(!l)throw Error.argumentNull("m_outlineElementNavigator");if(!r)throw Error.argumentNull("m_characterPropertiesEditor");}gDf(m,n,l,r){m=this.jDf(m,
n,l,r);n=new f.a;for(const w of m)n.add(b.a.create(w));return n}jDf(m,n,l,r){const w=new c.GraphIterator;w.set(n);n=new f.a;this.m$a(m,w,l,r,n);return n}m$a(m,n,l,r,w){let y=null;if(n&&(y=n.hj())){do{switch(y.type){case 12:break;case 35:r&&this.m$a(m,n,l,r,w);break;case 14:l&&this.m$a(m,n,l,r,w);break;default:this.m$a(m,n,l,r,w)}if(m===y.type&&12===m){if(null===y)throw Error("Could not cast node of NodeType.Paragraph to ParagraphNode");w.add(y)}}while(y=n.hp());n.wc()}}K5b(m,n,l){for(const r of n){if(12===
m&&(r.Cz||r.Vsa&&0===r.wI().length)){n=this.Pb.Hc(r);r.deleteParagraph();this.spb.mT(n,!0);this.Jza.ii(n);n=n.currentNode;const w=e.ParagraphReader.textLength(n);n=b.a.createTextRange(n,0,w);this.xH.replaceTextRange(n,"")}l.push(...this.gDf(m,r,14===m,!1).toArray())}}Hta(m,n,l){for(const r of n)this.K5b(m,r.xj(),l)}}u.GJ=(m,n,l=!1)=>{const r=()=>{if(n){var w=l?n.t$a():n;m(w);h.a.instance.zLe(r)}};h.a.instance.Vtd(r);return r};Object(x.a)(u,"ODSLGraphHelper",null,[])},490:function(x,G,a){a.d(G,"a",
function(){return c});x=a(0);class c{constructor(){this.tda=this.IX=this.oN=null;this.S0a=this.Vqa=!1;this.tsb=0;this.hc=null;this.oya=this.vSb=this.nya=!1;this.eya=!0;this.reset()}reset(){this.IX=[];this.oN=null;this.tda=[];this.S0a=this.Vqa=!1;this.tsb=0;this.hc=null;this.oya=this.vSb=this.nya=!1;this.eya=!0}}Object(x.a)(c,"HtmlPasteContext",null,[])},566:function(x,G,a){a.d(G,"f",function(){return b});a.d(G,"e",function(){return f});a.d(G,"i",function(){return e});a.d(G,"j",function(){return h});
a.d(G,"a",function(){return u});a.d(G,"h",function(){return m});a.d(G,"n",function(){return n});a.d(G,"o",function(){return l});a.d(G,"b",function(){return r});a.d(G,"k",function(){return w});a.d(G,"l",function(){return y});a.d(G,"d",function(){return z});a.d(G,"p",function(){return A});a.d(G,"c",function(){return B});a.d(G,"g",function(){return H});a.d(G,"m",function(){return v});var c=a(364);class b{constructor(C){c.a.assign(b,this,C)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(C){return c.a.matchesTypesFor(C,
[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class f{constructor(C){c.a.assign(f,this,C)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(C){return c.a.matchesTypesFor(C,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class e{constructor(C){c.a.assign(e,this,C)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(C){return c.a.matchesTypesFor(C,
[e.getTypeName()])}}e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class h{constructor(C){c.a.assign(h,this,C)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class u{constructor(C){c.a.assign(u,this,C)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class m{constructor(C){c.a.assign(m,this,C)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class n{constructor(C){c.a.assign(n,this,C)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,
[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class l{constructor(C){c.a.assign(l,this,C)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class r{constructor(C){c.a.assign(r,this,C)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,
[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class w{constructor(C){c.a.assign(w,this,C)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class y{constructor(C){c.a.assign(y,this,C)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,
[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class z{constructor(C){c.a.assign(z,this,C)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class A{constructor(C){c.a.assign(A,this,C)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,
[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class B{constructor(C){c.a.assign(B,this,C)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class H{constructor(C){c.a.assign(H,this,C)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,
[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class v{constructor(C){c.a.assign(v,this,C)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()}},660:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);a=a(816);class c extends a.a{constructor(b,f,e){super(b,f);this.yNe=e}}Object(x.a)(c,"ClipServiceSlideCopyParams",
a.a,[])},661:function(x,G,a){a.d(G,"a",function(){return u});x=a(0);var c=a(1580),b=a(258),f=a(256),e=a(278),h=a(260);class u{static HMb(m,n,l,r,w,y,z,A,B,H,v,C,F,D,N){y=C.QDa(!1,m.cid,m.sid,0,n.shapeType,y,z,A,B,H+1);y.setValue(f.a.nJ,n.PP);const {Wne:U,Rne:W}=w.dKd(r,n,l,N,F,D);r=F.yd;y.setValue(b.a.Tv,r.vf(N.YF(U,l),0));y.setValue(b.a.Ez,r.vf(N.YF(W,l),1));y.setValue(f.a.qcb,y.Tv);y.setValue(f.a.E$a,y.Ez);y.setValue(f.a.Sdc,!0);y.RZ=c.a.jqa(U,0);y.QZ=c.a.jqa(W,1);y.setValue(f.a.WDa,0);y.setValue(f.a.XDa,
0);y.setValue(f.a.xEa,!0);y.setValue(f.a.isResizable,!0);y.setValue(f.a.OJ,!0);y.XK=!0;y.wEa=!0;N=(r=95===n.PP||97===n.PP)||Array.contains(u.Hbc,n.PP);y.OJ=!r;y.isResizable=!0;y.setValue(f.a.au,r);y.setValue(f.a.ZV,95===n.PP);y.jD=e.a.Yq(m.sid,m.cid);y.rFa=y.get_shapeId();y.setValue(f.a.Gca,!0);m=w.Czd(U,W,l);y.bV=m;(v.YC(y)||v.j8(y))&&h.a.Ab&&(h.a.Ab.Xi=!0);N?w.Ume(y):w.bne(y);return y}}u.Hbc=[88,93,94,89,90,91,92];Object(x.a)(u,"InsertContentShapeNodeFactory",null,[])},662:function(x,G,a){a.d(G,
"a",function(){return c});x=a(0);class c{constructor(b,f,e,h){this.PP=b;this.shapeType=f;this.height=e;this.width=h}}Object(x.a)(c,"AutoShapeProps",null,[])},801:function(x,G,a){a.d(G,"a",function(){return n});x=a(0);var c=a(17),b=a(5),f=a(1207),e=a(249),h=a(261),u=a(286),m=a(253);class n{constructor(l=2E3){this.I7=l}zhj(){const l=n.$M();return this.TVf(l)}TVf(l){return 0<this.Qac(l).mentionLength}getSelectedText(){const l=n.$M();return this.Qac(l)}Qac(l){return this.yGf(l,!0)}yGf(l,r){var w=null;
r&&l&&l.X7&&h.SelectionEditor.Wg(l.Xa)&&h.SelectionEditor.V$a(l.Xa)&&(c.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),w=h.SelectionEditor.bEa(l.Xa,!1));w&&(l=w);if(!l)return Object.assign(new f.a,{neighborhood:"",mentionStart:0,mentionLength:0});const y=new Sys.StringBuilder;w=r=0;const z=[],A=l.length;for(let H=0;H<A;H++){const v=l.ha(H);if(!m.ParagraphReader.me(v.node)||Array.contains(z,v.node.qV))continue;z.push(v.node.qV);let C=m.ParagraphReader.text(v.node),
F=0;var B=m.ParagraphReader.Ana(v.node,!0,!0,!0);let D=m.ParagraphReader.Ana(v.node,!1,!0,!0),N=0;for(;C.length<this.I7&&(B||D);){if(!(N%2)&&B){const U=m.ParagraphReader.text(B);C=U+" "+C;F+=U.length+1;B=m.ParagraphReader.Ana(B,!0,!0,!0)}1===N%2&&D&&(C=C+" "+m.ParagraphReader.text(D),D=m.ParagraphReader.Ana(D,!1,!0,!0));N++}B=H===A-1;H||-1===v.Va||(r=v.Va);w+=B&&-1!==v.Ib?v.Ib:C.length;y.append(C);r+=F;w+=F;B||(y.append(" "),w++)}for(l=u.AParagraphNode.Pdc(y.toString()," ");r<w&&b.a.RB(l.charCodeAt(r));)r++;
for(;w>r&&b.a.RB(l.charCodeAt(w-1));)w--;return this.Yaf(l,r,w)}Yaf(l,r,w){if(l.length>this.I7){var y=w-r;if(y>this.I7)l=l.substr(r,this.I7),w=this.I7,r=0;else{y=Math.max(r-Math.floor((this.I7-y)/2),0);let z;z=Math.min(y+this.I7,l.length);y=Math.max(z-this.I7,0);r-=y;w-=y;l=l.substring(y,z)}}return Object.assign(new f.a,{neighborhood:l,mentionStart:r,mentionLength:w-r})}static $M(){var l=e.App.Vb.Pd.An;if(!l)return c.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;l=l.Jb;return l&&l.Ua&&
l.Ua.length?l.Ua.mb:(c.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(x.a)(n,"Box4InsightsSelection",null,[765,766])},816:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b,f){this.gp=b;this.hc=f}}Object(x.a)(c,"ClipServiceCopyParams",null,[])},817:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.bevelField=null;this.capField=0;this.capFieldSpecified=
!1;this.cmpdField=0;this.cmpdFieldSpecified=!1;this.tailEndField=this.solidFillField=this.roundField=this.prstDashField=this.pattFillField=this.noFillField=this.miterField=this.headEndField=this.gradFillField=this.extLstField=this.custDashField=null;this.wField=0;this.wFieldSpecified=!1}}Object(x.a)(c,"CT_LineProperties",null,[])},818:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.valField=0;this.valFieldSpecified=!1}}Object(x.a)(c,"CT_PresetLineDashProperties",
null,[])},819:function(x,G,a){var c=this&&this.c7g||(Object.create?function(f,e,h,u){void 0===u&&(u=h);var m=Object.getOwnPropertyDescriptor(e,h);if(!m||("get"in m?!e.H8a:m.writable||m.configurable))m={enumerable:!0,get:function(){return e[h]}};Object.defineProperty(f,u,m)}:function(f,e,h,u){void 0===u&&(u=h);f[u]=e[h]}),b=this&&this.__exportStar||function(f,e){for(var h in f)"default"===h||Object.prototype.hasOwnProperty.call(e,h)||c(e,f,h)};Object.defineProperty(G,"__esModule",{value:!0});b(a(1110),
G);b(a(1111),G);b(a(1112),G);b(a(1113),G)},831:function(x,G,a){a.d(G,"a",function(){return y});x=a(0);var c=a(719),b=a(231),f=a(427),e=a(590);class h{constructor(){this.limField=0;this.limFieldSpecified=!1}}Object(x.a)(h,"CT_LineJoinMiterProperties",null,[]);var u=a(817);class m{constructor(){this.valField=0}}Object(x.a)(m,"CT_PositiveFixedPercentage",null,[]);var n=a(818),l=a(486),r=a(456),w=a(438);class y{dKd(z,A,B,H,v,C){z=Object(b.a)(278,C.Ga.Qg(v.Oa));B=v.yd;v=Math.round(H.cP(B.ke(A.width*c.a.ay,
0),z.WK));A=Math.round(H.cP(B.ke(A.height*c.a.ay,1),z.WK));return{Wne:v,Rne:A}}Czd(z,A){return Object.assign(new f.a,{TopLeft:Object.assign(new w.a,{X:0,Y:0}),TopRight:Object.assign(new w.a,{X:z,Y:0}),BottomLeft:Object.assign(new w.a,{X:0,Y:A}),BottomRight:Object.assign(new w.a,{X:z,Y:A})})}Ume(z){z.lineStyle=Object.assign(new u.a,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new h,{limField:8E5,limFieldSpecified:!0}),
prstDashField:Object.assign(new n.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new r.a,{schemeClrField:Object.assign(new l.a,{valField:4})}),wField:6350,wFieldSpecified:!0})}bne(z){z.fill=Object.assign(new e.a,{solidFillField:Object.assign(new r.a,{schemeClrField:Object.assign(new l.a,{valField:4})})});z.lineStyle=Object.assign(new u.a,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new h,{limField:8E5,
limFieldSpecified:!0}),prstDashField:Object.assign(new n.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new r.a,{schemeClrField:this.ynf(26,Object.assign(new m,{valField:5E4}),4)}),wField:12700,wFieldSpecified:!0})}ynf(z,A,B){const H={};H.itemsElementNameField=[z];H.itemsField=[A];H.valField=B;return H}}Object(x.a)(y,"InsertShapeActorHelper",null,[869])},893:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b[b.other=0]="other";b[b.n1l=1]="searchBoxSearch";
b[b.i1l=2]="searchBoxDictionary";b[b.m1l=3]="searchBoxQuickAnswer";b[b.S5l=4]="smartLookupRibbon";b[b.Kxh=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.ool=7]="dictionary";b[b.Q$l=8]="web";b[b.OTl=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.Ofa=12]="help";b[b.wjl=13]="chartRecommendation";b[b.bFl=14]="linkSkill";b[b.k1l=15]="searchBoxFindInDocument";b[b.j1l=16]="searchBoxEntity";b[b.p1l=17]="searchSkill";b[b.zll=18]="controlF";b[b.X_l=19]="ribbonFindButton";b[b.Q_l=
20]="reuseSlides";b[b.data=21]="data";b[b.pll=22]="contextMenuDictionary";b[b.sll=23]="contextMenuSearchSuggestion";b[b.vll=24]="contextMenuSynonyms";b[b.rll=25]="contextMenuSearchBoxSearch";b[b.o1l=26]="searchBoxSearchZeroTerm";b[b.tll=27]="contextMenuSearchZeroTerm";b[b.tOl=28]="note";b[b.O5l=29]="smartLookupAutoLaunch";b[b.ull=30]="contextMenuSmartLookupInSubMenu";b[b.mnl=31]="dataDisambiguate";b[b.aFl=32]="linkFiles";b[b.l1l=33]="searchBoxNoteL2";b[b.qll=34]="contextMenuLaunchL2Document";b[b.Ddl=
35]="actionAI";b[b.kTl=36]="pasteAsNewSlide";b[b.J5l=37]="slidesCompression";b[b.xvh=38]="searchBoxGenerateDeck";b[b.Ksh=39]="powerPointCopilot";b[b.l7l=40]="tellMeService";b[b.sVl=99]="prefetch"})(c||(c={}));Object(x.b)("EntryPoint",c)}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.smartlookup.js.map