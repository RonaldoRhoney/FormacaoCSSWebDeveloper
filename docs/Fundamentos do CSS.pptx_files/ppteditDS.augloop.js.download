'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1119:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.completion=new Promise((b,f)=>{this.resolve=b;this.reject=f})}}Object(x.a)(c,"ControlledPromise",null,[])},1120:function(x,G,a){a.d(G,"a",function(){return c});const c=b=>{if((b=b.Jc("AugLoopEndpointOverride",0))&&!(1>b))return{[1]:"https://augloop-test.officeppe.com",[2]:"https://augloop-int.officeppe.com",[3]:"https://augloop-dogfood.officeppe.com",
[4]:"https://augloop.office.com",[5]:"http://localhost:20080"}[b]}},1225:function(x,G,a){var c=this&&this.c7g||(Object.create?function(f,e,h,u){void 0===u&&(u=h);var m=Object.getOwnPropertyDescriptor(e,h);if(!m||("get"in m?!e.H8a:m.writable||m.configurable))m={enumerable:!0,get:function(){return e[h]}};Object.defineProperty(f,u,m)}:function(f,e,h,u){void 0===u&&(u=h);f[u]=e[h]}),b=this&&this.__exportStar||function(f,e){for(var h in f)"default"===h||Object.prototype.hasOwnProperty.call(e,h)||c(e,f,
h)};Object.defineProperty(G,"__esModule",{value:!0});b(a(1632),G);b(a(1633),G);b(a(1634),G);b(a(1635),G)},1351:function(x,G,a){a.d(G,"a",function(){return h});x=a(0);var c=a(68),b=a(22),f=a(249),e=a(263);a(297);class h{constructor(){this.qEa=null}get W8c(){return!1}XSk(u,m){let n=new c.a;const l=new e.GraphTransaction(3);try{l.hd(f.App.Vb.Pd.An.Zg),this.SVf(m)&&(n=this.dPf(m,n)),m!==u&&this.SVf(u)&&(n=this.dPf(u,n))}finally{l&&l.dispose()}return n.toArray()}SVf(u){return!!u}euh(u){let m=!1;for(const n of this.z8i)m||
!Sys.UI.DomElement.containsCssClass(u,n.className)&&!Sys.UI.DomElement.containsCssClass(u,n.xJf)||(m=!0),b.a.uub(u,n.className),b.a.uub(u,n.xJf)}}Object(x.a)(h,"AHighlightActor",null,[1339])},1352:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b,f){this.className=b;this.xJf=f}}Object(x.a)(c,"HighlightCssClassPair",null,[])},1353:function(x,G,a){a.d(G,"b",function(){return e});a.d(G,"a",function(){return h});var c=a(22);a(249);var b=a(263);a(253);a(293);var f=a(297);const e=
u=>{const m=new b.GraphTransaction(3);try{m.hd(u),u.Fq(32,!0)}finally{m&&m.dispose()}},h=u=>{if(u){u=c.a.sna(u);if(-1===u.indexOf(f.a.x0)&&-1!==u.indexOf(f.a.ON)&&-1===u.indexOf(f.a.yAd))return 2;if(-1===u.indexOf(f.a.x0)&&(-1!==u.indexOf(f.a.q6c)||-1!==u.indexOf(f.a.WN)||-1!==u.indexOf(f.a.yAd)||-1!==u.indexOf(f.a.wyd)||-1!==u.indexOf(f.a.NMb)||-1!==u.indexOf(f.a.xAd)||-1!==u.indexOf(f.a.prc)||-1!==u.indexOf(f.a.qrc)||-1!==u.indexOf(f.a.nrc)||-1!==u.indexOf(f.a.orc)||-1!==u.indexOf(f.a.mof)||-1!==
u.indexOf(f.a.iof)||-1!==u.indexOf(f.a.jof)||-1!==u.indexOf(f.a.uAd)||-1!==u.indexOf(f.a.gof)))return 1;if(-1!==u.indexOf("WACImageContainer"))return 3}return 0}},1354:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.type=this.action=0;this.JSc=this.F$a=null}}Object(x.a)(c,"HighlightOperation",null,[])},1356:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(68);class b{static SXl(f){b.DMf.add(f)}static G1l(f){for(const e of b.DMf)e(f)}static $Xl(f){b.Lle.add(f);
if(0<b.QTc.count){for(const e of b.QTc)f(e);b.QTc=new c.a}}static K1l(f){if(0<b.Lle.count)for(const e of b.Lle)e(f);else b.QTc.add(f)}}b.QTc=new c.a;b.Lle=new c.a;b.DMf=new c.a;Object(x.a)(b,"AugLoopEventUtils",null,[])},1504:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(693);class b{constructor(f){this.rI=f}xMe(f,e,h,u){return c.a.then(this.rI.GHa(f,e,h,{"Content-Type":"application/json; charset=utf-8"},!1,u,null,void 0,void 0,void 0,void 0,void 0,"2"),m=>this.aGf(m))}aGf(f){return f&&
f.Wi&&f.Wi.data?f.Wi.data.responseData:null}}Object(x.a)(b,"SimpleRequestManager",null,[1825])},1630:function(x,G,a){a.d(G,"b",function(){return c});a.d(G,"a",function(){return b});const {AugLoopTextEncoder:c,AugLoopTextDecoder:b}=(()=>{if("undefined"===typeof TextEncoder){a(1631);const f={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};TextDecoder=TextEncoder=void 0;return f}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})()},1631:function(x,G,a){(function(c,
b){(function(f){function e(v,C,F){if(v)throw Error("".concat("Failed to ").concat(C,": the '").concat(F,"' option is unsupported."));}function h(v){return b.from(v)}function u(v,C){var F;return v instanceof b?F=v:F=b.from(v.buffer,v.byteOffset,v.byteLength),F.toString(C)}function m(v){for(var C=0,F=Math.min(65536,v.length+1),D=new Uint16Array(F),N=[],U=0;;){var W=C<v.length;if(!W||U>=F-1){if(N.push(String.fromCharCode.apply(null,D.subarray(0,U))),!W)return N.join("");v=v.subarray(C);U=C=0}W=v[C++];
if(0===(W&128))D[U++]=W;else if(192===(W&224)){var L=v[C++]&63;D[U++]=(W&31)<<6|L}else if(224===(W&240)){L=v[C++]&63;var O=v[C++]&63;D[U++]=(W&31)<<12|L<<6|O}else if(240===(W&248)){L=v[C++]&63;O=v[C++]&63;var M=v[C++]&63;W=(W&7)<<18|L<<12|O<<6|M;65535<W&&(W-=65536,D[U++]=W>>>10&1023|55296,W=56320|W&1023);D[U++]=W}}}function n(v){for(var C=0,F=v.length,D=0,N=Math.max(32,F+(F>>>1)+7),U=new Uint8Array(N>>>3<<3);C<F;){var W=v.charCodeAt(C++);if(55296<=W&&56319>=W){if(C<F){var L=v.charCodeAt(C);56320===
(L&64512)&&(++C,W=((W&1023)<<10)+(L&1023)+65536)}if(55296<=W&&56319>=W)continue}D+4>U.length&&(N+=8,N*=1+C/v.length*2,N=N>>>3<<3,L=new Uint8Array(N),L.set(U),U=L);if(0===(W&4294967168))U[D++]=W;else{if(0===(W&4294965248))U[D++]=W>>>6&31|192;else if(0===(W&4294901760))U[D++]=W>>>12&15|224,U[D++]=W>>>6&63|128;else if(0===(W&4292870144))U[D++]=W>>>18&7|240,U[D++]=W>>>12&63|128,U[D++]=W>>>6&63|128;else continue;U[D++]=W&63|128}}return U.slice?U.slice(0,D):U.subarray(0,D)}function l(){this.encoding="utf-8"}
function r(v,C){e(C&&C.fatal,"construct 'TextDecoder'","fatal");v=v||"utf-8";var F;if(w?F=b.yij(v):F=-1!==A.indexOf(v.toLowerCase()),!F)throw new RangeError("".concat(H," encoding label provided ('").concat(v,"') is invalid."));this.encoding=v;this.ignoreBOM=this.fatal=!1}var w="function"==typeof b&&b.from,y=w?h:n;l.prototype.encode=function(v,C){return e(C&&C.stream,"encode","stream"),y(v)};var z=!w&&"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL,A=["utf-8",
"utf8","unicode-1-1-utf-8"],B=m;w?B=u:z&&(B=function(v){try{a:{try{var C=URL.createObjectURL(new Blob([v],{type:"text/plain;charset=UTF-8"}));var F=new XMLHttpRequest;var D=(F.open("GET",C,!1),F.send(),F.responseText);break a}finally{C&&URL.revokeObjectURL(C)}D=void 0}return D}catch(N){return m(v)}});var H="".concat("Failed to "," ").concat("construct 'TextDecoder'",": the ");r.prototype.decode=function(v,C){e(C&&C.stream,"decode","stream");var F;return v instanceof Uint8Array?F=v:v.buffer instanceof
ArrayBuffer?F=new Uint8Array(v.buffer):F=new Uint8Array(v),B(F,this.encoding)};f.TextEncoder=f.TextEncoder||l;f.TextDecoder=f.TextDecoder||r})("undefined"!==typeof window?window:"undefined"!==typeof c?c:this)}).call(this,a(191),a(218).Buffer)},1632:function(x,G){Object.defineProperty(G,"__esModule",{value:!0});G.RewriteCompletionStatus=G.ContentType=G.RewriteSuggestionType=void 0;(function(a){a[a.Bullet=0]="Bullet";a[a.Concise=1]="Concise";a[a.Paraphrase=2]="Paraphrase";a[a.Title=3]="Title"})(G.RewriteSuggestionType||
(G.RewriteSuggestionType={}));(function(a){a[a.PLAIN_TEXT=0]="PLAIN_TEXT";a[a.HTML=1]="HTML";a[a.JSON=2]="JSON"})(G.ContentType||(G.ContentType={}));(function(a){a[a.Success=0]="Success";a[a.OffensiveContentInput=1]="OffensiveContentInput";a[a.OffensiveContentOutput=2]="OffensiveContentOutput";a[a.EmptyResponse=3]="EmptyResponse";a[a.OpenAiModelError=4]="OpenAiModelError";a[a.UnsupportedLanguage=5]="UnsupportedLanguage";a[a.Timeout=6]="Timeout";a[a.BadRequest=7]="BadRequest";a[a.Unknown=8]="Unknown";
a[a.UserNotAuthorized=9]="UserNotAuthorized";a[a.ParseFailure=10]="ParseFailure";a[a.RepeatedTitle=11]="RepeatedTitle"})(G.RewriteCompletionStatus||(G.RewriteCompletionStatus={}))},1633:function(x,G,a){Object.defineProperty(G,"__esModule",{value:!0});G.RewriteAnswer=void 0;const c=a(346);class b{constructor(f){c.SchemaObject.assign(b,this,f)}get metadata(){return this.M_}set metadata(f){this.M_=f}static getTypeName(){return"AugLoop_Rewrite_RewriteAnswer"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(f){return c.SchemaObject.matchesTypesFor(f,
[b.getTypeName()])}}G.RewriteAnswer=b;b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()}},1634:function(x,G){Object.defineProperty(G,"__esModule",{value:!0});G.RewriteType=void 0;x=G.RewriteType||(G.RewriteType={});x[x.Title=0]="Title";x[x.Subtitle=1]="Subtitle";x[x.Content=2]="Content"},1635:function(x,G,a){Object.defineProperty(G,"__esModule",{value:!0});G.RewriteSignal=void 0;const c=a(346);class b{constructor(f){c.SchemaObject.assign(b,this,f)}static getTypeName(){return"AugLoop_Rewrite_RewriteSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(f){return c.SchemaObject.matchesTypesFor(f,
[b.getTypeName()])}}G.RewriteSignal=b;b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()}},1673:function(x,G,a){(function(c){a.d(G,"a",function(){return f});var b=a(1630);class f{static deserialize(e,h=u=>u){if(e[0]!==f.IDENTIFIERBYTE)throw Error("Invalid Binary: Incorrect Identifier");let u=1;const m=[],n=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;u<e.byteLength;){if(u+4>e.byteLength)throw Error("Invalid Binary: Error reading fragment length");const l=n.getUint32(u);if(u+l+4>e.byteLength)throw Error("Invalid Binary: Fragment out of range");
"undefined"!==typeof c&&c.from?m.push(c.from(e.buffer,e.byteOffset+u+4,l)):m.push(new Uint8Array(e.buffer,e.byteOffset+u+4,l));u+=4+l}if(1>m.length)throw Error("Invalid Binary: No fragments found");e=f.textDecoder.decode(m[0]);return JSON.parse(e,(l,r)=>{if("string"===typeof r){if(r.substring(0,f.BINARYKEYWORD.length)===f.BINARYKEYWORD){l=parseInt(r.substring(f.BINARYKEYWORD.length),10);if("number"!==typeof l||l>=m.length-1)throw Error("Invalid Binary: Binary index out of range");return h(m[l+1])}if(r.substring(0,
f.ESCAPEKEYWORD.length)===f.ESCAPEKEYWORD)return r.substring(f.ESCAPEKEYWORD.length)}return r})}static serialize(e){const h=[void 0];e=JSON.stringify(e,(n,l)=>ArrayBuffer.isView(l)?(h.push(l),`${f.BINARYKEYWORD}${h.length-2}`):l&&"Buffer"===l.type&&Array.isArray(l.data)?(h.push(new Uint8Array(l.data)),`${f.BINARYKEYWORD}${h.length-2}`):"string"===typeof l&&l.substring(0,f.ESCAPEKEYWORD.length)===f.ESCAPEKEYWORD?f.ESCAPEKEYWORD+l:l);h[0]=f.textEncoder.encode(e);e=h.reduce((n,l)=>n+4+l.byteLength,0);
e=new Uint8Array(e+1);e[0]=f.IDENTIFIERBYTE;let u=1;const m=new DataView(e.buffer,e.byteOffset,e.byteLength);for(const n of h)m.setUint32(u,n.byteLength),e.set(n,u+4),u+=4+n.byteLength;return e}}f.IDENTIFIERBYTE=3;f.BINARYKEYWORD=":b";f.ESCAPEKEYWORD=":";f.textDecoder=new b.a;f.textEncoder=new b.b}).call(this,a(218).Buffer)},1679:function(x,G,a){a.r(G);var c=a(0),b=a(17),f=a(4),e=a(7),h=a(118),u=a(68);class m{constructor(){this.ContextId=this.SessionId=this.AppId=this.Payload=this.Topic=null}}Object(c.a)(m,
"AugmentationServiceRequest",null,[]);var n=a(20),l=a(92);class r{constructor(tb,Kc,ad){this.lye=this.bzb=null;this.m6a=id=>{!f.AFrameworkApplication.mi&&id&&id.data&&this.oon(id.data.responseData)};this.j6a=id=>{!f.AFrameworkApplication.mi&&id&&id.data&&b.ULS.sendTraceTag(25747918,306,15,"{0}",id.data.responseData)};this.Afm=ad;this.Ba=Kc;this.$m=tb}initialize(){b.ULS.sendTraceTag(25747911,306,50,"Start initialing augmentation loop ...");const tb=this.Ba.La("AugmentationLoopWebServiceBase"),Kc=this.Ba.La("WebServiceBase");
this.bzb=(void 0===tb?Kc:tb)+"proofing.ashx?"+f.AFrameworkApplication.ui+"&apitype=AL";this.lye=new l.a;b.ULS.sendTraceTag(25747912,306,50,"Augmentation Loop initialized")}addEventHandler(tb,Kc){if(tb&&""!==tb)if(Kc){if(!({value:ad}=this.lye.Uh(tb)).returnValue){var ad=new u.a;this.lye.add(tb,ad)}ad.contains(Kc)||ad.add(Kc)}else b.ULS.sendTraceTag(25747914,306,15,"eventHandler is null");else b.ULS.sendTraceTag(25747913,306,15,"topic is empty or null")}removeEventHandler(tb,Kc){tb&&""!==tb?Kc?this.lye.Ob(tb)?
({value:tb}=this.lye.Uh(tb),tb&&tb.contains(Kc)&&tb.remove(Kc)):b.ULS.sendTraceTag(25747917,306,15,"Topic {0} doesn't exist in handler map.",tb):b.ULS.sendTraceTag(25747916,306,15,"Try to remove null handler"):b.ULS.sendTraceTag(25747915,306,15,"topic is empty or null")}oxk(tb,Kc,ad){this.WLe(tb,Kc,ad,this.m6a,this.j6a)}WLe(tb,Kc,ad,id,ud,ke=null){tb=Object.assign(new m,{Topic:tb,Payload:Kc,AppId:this.Afm,SessionId:this.$m.userSessionId,ContextId:ad});this.$m.rk(this.bzb,2,n.c(tb),{"Content-Type":"application/json; charset=utf-8"},
!1,3,id,ud,ke?ke:tb,void 0,void 0,void 0,void 0,"18")}oon(tb){if(tb){try{var Kc=n.a(tb)}catch(ad){b.ULS.sendTraceTag(36284437,306,10,"Try parse aug response failed:{0}",ad.message);return}if(({value:tb}=this.lye.Uh(Kc.Topic)).returnValue)for(const ad of tb)ad(Kc.ContextId,Kc.Payload);else b.ULS.sendTraceTag(25747919,306,50,"Cannot find handlers for Topic:{0};",Kc.Topic)}}}Object(c.a)(r,"AugmentationManager",null,[1438]);var w=a(231);class y{}Object(c.a)(y,"HostMetadata",null,[]);var z=a(1356);class A{sendMessage(tb){b.ULS.sendTraceTag(508965922,
306,100,"AL send SDX message");z.a.G1l(tb)}registerMessageReceivedCallback(tb){b.ULS.sendTraceTag(508965921,306,50,"AL handle SDX message");z.a.$Xl(tb)}}Object(c.a)(A,"SdxMessageBridge",null,[1466]);class B{}Object(c.a)(B,"Lambda",null,[]);class H extends B{constructor(){super()}}Object(c.a)(H,"WrapperLambda",B,[]);var v=a(139),C=a(36),F=a(94),D=a(43);class N{constructor(){this.handler=this.schemaName=null}}Object(c.a)(N,"AddEventHandlerParameters",null,[]);var U=a(1043);class W{constructor(){this.lambda=
this.name=null}}Object(c.a)(W,"RegisterSimpleLocalWorkflowParameters",null,[]);class L{constructor(){this.lambdaAfter=this.lambdaRemote=this.lambdaBefore=this.name=null}}Object(c.a)(L,"RegisterSimpleRemoteWorkflowParameters",null,[]);var O=a(1516);class M{constructor(){this.bridge=null}}Object(c.a)(M,"SetMessageBridgeParameters",null,[]);class K{constructor(){this.requestAuthTokenCallback=null}}Object(c.a)(K,"SetRequestAuthTokenCallbackParameters",null,[]);class P{constructor(){this.sendOTelEvent=
null}}Object(c.a)(P,"SetSendOTelEventCallbackParameters",null,[]);class V{constructor(){this.ulsLogger=null}}Object(c.a)(V,"SetULSLoggerParameters",null,[]);var Y=a(777);class ta{constructor(){this.correlationVector=this.input=this.inputSchema=null}}Object(c.a)(ta,"SubmitParameters",null,[]);var fa=a(794);class Ta{constructor(tb,Kc=null){this.fVa=null;new l.a;new y;this.uHn=()=>{const ad=f.AFrameworkApplication.ga.La("AugLoopOAuthResourceUriV2");if(this.u3c)return new Promise(id=>{this.u3c.execute(ud=>
{ud.qN("AugLoop",ad).then(ke=>{ke.IsSuccess?id(ke.Token):(b.ULS.sendTraceTag(51499467,306,15,ke.ErrorMessage),id(f.AFrameworkApplication.ga.La("AugloopACLPUserDataSignature")||""));return{}})})});b.ULS.sendTraceTag(51499468,306,50,"Auth requested without a IOAuthManager");return Promise.resolve("")};this.sendOTelEvent=ad=>{D.a.sendOtelEvent(Object.assign(new fa.a,{otelEvent:ad}))};this.Nlm=tb;this.u3c=Kc}initialize(tb){this.fVa?b.ULS.sendTraceTag(51185349,306,15,"Initialize called multiple times."):
(tb||(tb=new U.a),this.fVa=new Promise(Kc=>{b.ULS.sendTraceTag(51185350,306,50,"Start download and initialize augloop runtime ...");const ad=f.AFrameworkApplication.xh("al",2);this.Nlm.Jbc(ad).continueWith(()=>{b.ULS.sendTraceTag(51185351,306,50,"augloop: Successfully loaded script");const id=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();id.setRequestAuthTokenCallback(Object.assign(new K,{requestAuthTokenCallback:this.uHn}));id.setULSLogger(Object.assign(new V,{ulsLogger:new v.a}));id.setSendOTelEventCallback(Object.assign(new P,
{sendOTelEvent:this.sendOTelEvent}));let ud=f.AFrameworkApplication.ga.La("OfficeApplicationName")||"";ud=ud.replace("Web","");tb.appName=tb.appName||ud;tb.serviceUrl=tb.serviceUrl||f.AFrameworkApplication.ga.La("AugLoopCloudALServiceUrl");tb.appVersion=tb.appVersion||f.AFrameworkApplication.ga.La("BuildVersion")||"";tb.releaseAudienceGroup=tb.releaseAudienceGroup||(f.AFrameworkApplication.Rf?Object(w.a)(String,f.AFrameworkApplication.Rf.AudienceGroup)||"":"");tb.sessionId=tb.sessionId||f.AFrameworkApplication.ga.La("SessionId")||
"";tb.uiLanguage=tb.uiLanguage||f.AFrameworkApplication.uiCulture;tb.flights=tb.flights||this.mLm();tb.initSession=tb.initSession||!0;tb.downloadBaseUrl=tb.downloadBaseUrl||f.AFrameworkApplication.ga.La("AugLoopDownloadBaseUrl");id.initialize(tb);id.setMessageBridge(Object.assign(new M,{bridge:new A}));Kc({})})}))}registerSchemas(){b.ULS.sendTraceTag(51185352,306,50,"RegisterSchemas is a No-Op");return this.fVa}registerSimpleLocalWorkflow(tb,Kc){return this.fVa.then(()=>{b.ULS.sendTraceTag(51185353,
306,50,"Registering local workflow: {0} to AugLoop.",tb);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleLocalWorkflow(Object.assign(new W,{name:tb,lambda:this.Vyh(Kc)}))})}registerSimpleRemoteWorkflow(tb,Kc,ad,id){return this.fVa.then(()=>{b.ULS.sendTraceTag(51185354,306,50,"Registering remote workflow: {0} to AugLoop.",tb);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleRemoteWorkflow(Object.assign(new L,{name:tb,lambdaBefore:this.Vyh(Kc),lambdaRemote:this.Vyh(ad),
lambdaAfter:this.Vyh(id)}))})}registerReduceWorkflow(){b.ULS.sendTraceTag(51185355,306,100,"RegisterReduceWorkflow is NYI");return this.fVa}submit(tb,Kc){this.fVa.then(()=>{b.ULS.sendTraceTag(51185356,306,100,"Submitting event: {0} to AugLoop.",tb);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submit(Object.assign(new ta,{inputSchema:tb,input:Kc}))})}flushTelemetry(){b.ULS.sendTraceTag(51185357,306,100,"FlushTelemetry is NYI")}submitOperation(tb){this.fVa.then(()=>{b.ULS.sendTraceTag(51185358,
306,100,"Submitting Operation: {0} to AugLoop.",tb);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:tb}))})}setSessionDataCallback(tb){this.fVa.then(()=>{b.ULS.sendTraceTag(592318537,306,100,"Setting SessionData Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionDataCallback(tb)})}setInitSessionCallback(tb){this.fVa.then(()=>{b.ULS.sendTraceTag(594384065,306,100,"Setting init session override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setInitSessionCallback(tb)})}setSessionInitOverrideCallback(tb){this.fVa.then(()=>
{b.ULS.sendTraceTag(594384064,306,100,"Setting session init override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionInitOverrideCallback(tb)})}setAnnotationResultCallback(tb){this.fVa.then(()=>{b.ULS.sendTraceTag(51185359,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setAnnotationResultCallback(Object.assign(new O.a,{handler:tb}))})}activateAnnotation(tb){return this.fVa.then(()=>{b.ULS.sendTraceTag(51226247,306,100,"Activating Annotation: {0}",
tb.annotationType);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation(tb)})}releaseAnnotation(tb){return this.fVa.then(()=>{b.ULS.sendTraceTag(51226248,306,100,"Releasing Annotation: {0}",tb.token);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().releaseAnnotation(tb)})}addEventHandler(tb,Kc){tb&&""!==tb?Kc?this.fVa.then(()=>{b.ULS.sendTraceTag(51185362,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().addEventHandler(Object.assign(new N,
{schemaName:tb,handler:ad=>{ad&&Kc(ad.inputSchema,ad.input,ad.outputSchema,ad.output)}}))}):b.ULS.sendTraceTag(51185361,306,15,"eventHandler is null"):b.ULS.sendTraceTag(51185360,306,15,"schemaName is empty or null")}removeEventHandler(){b.ULS.sendTraceTag(51185363,306,100,"RemoveEventHandler is NYI.")}Vyh(tb){if(tb){let Kc=null;tb.func&&(Kc=(ad,id,ud,ke)=>{tb.func(ad,id,ke)});return Object.assign(new H,{name:tb.name,inputSchema:tb.inputSchema,outputSchema:tb.outputSchema,func:Kc})}return null}mLm(){var tb=
f.AFrameworkApplication.ga.La("FlightId");if(f.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ALFlightForwardingTreatmentVariablesFix")){var Kc=f.AFrameworkApplication.ga.uuc,ad=f.AFrameworkApplication.ga.tF("AugLoopFlightKeywordList");Kc=Ta.Owf(tb,Kc,Array.isArray(ad)?ad:null);ad="";Kc&&0<Kc.length&&(ad=Kc.join(";"));return ad}Kc=f.AFrameworkApplication.ga.tF("AugLoopFlightKeywordList");ad=[];if(tb&&""!==tb&&Kc&&0<Kc.length){tb=tb.split(";");for(let id=0;id<
tb.length;id++)for(let ud=0;ud<Kc.length;ud++)-1<tb[id].toLowerCase().indexOf(Kc[ud].toLowerCase())&&Array.add(ad,tb[id])}return 0<ad.length?ad.join(";"):""}static Owf(tb,Kc,ad){const id=new u.a;if(ad&&0<ad.length){for(var ud=0;ud<ad.length;ud++)ad[ud]=ad[ud].toLowerCase();if(tb&&""!==tb){tb=tb.toLowerCase().split(";");for(const ke of tb)F.a.any(ad,of=>-1<ke.indexOf(of))&&id.add(ke)}if(Kc)for(const ke in Kc){ud=(tb={key:ke,value:Kc[ke]},tb.key)?tb.key:"";const of=C.d(ud);F.a.any(ad,Yf=>-1<of.indexOf(Yf))&&
id.add(String.format("{0}:{1}",ud,tb.value))}}return id.toArray()}}Object(c.a)(Ta,"NewAugLoopRuntimeManager",null,[61]);var ha=a(69),qa=a(19),ra=a(1504),I=a(5),ba=a(40);class Ga{}Object(c.a)(Ga,"Lambda",null,[1469]);var Oa=a(1199);class Ja{constructor(){this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null}}Object(c.a)(Ja,"PowerPointParameters",null,[]);class Qa{constructor(){this.initSessionCallback=null}}Object(c.a)(Qa,"SetInitSessionCallbackParameters",null,[]);class Pa{constructor(){this.sessionDataCallback=
this.handler=null}}Object(c.a)(Pa,"SetSessionDataCallbackParameters",null,[]);class ja{constructor(){this.handler=null}}Object(c.a)(ja,"SetSessionInitOverrideCallbackParameters",null,[]);var va=a(431),Ha=a(778),gb=a(330);class Gb extends Ha.a{constructor(){super();this.isTriggeredBySyncDelta=null;this.H_=Object.assign(new gb.a,{T_:Gb.getTypeName(),B_:Gb.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(c.a)(Gb,
"DeleteOperation",Ha.a,[]);var Mb=a(696),hb=a(454);class Da extends hb.a{constructor(){super();this.bridgeId=this.cv=this.messageId=null;this.H_=Object.assign(new gb.a,{T_:Da.getTypeName(),B_:Da.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}}Object(c.a)(Da,"Message",hb.a,[]);class Bb extends Da{constructor(){super();this.protocolVersion=0;this.enableRemoteExecutionNotification=this.enableSessionInspectorLogs=this.returnWorkflowInputTypes=
this.extensionConfigs=this.authToken=this.origin=this.sessionKey=this.serviceUrl=this.clientMetadata=null;this.H_=Object.assign(new gb.a,{T_:Bb.getTypeName(),B_:Bb.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}}Object(c.a)(Bb,"SessionInitMessage",Da,[]);class Za extends Bb{constructor(){super();this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null;this.H_=Object.assign(new gb.a,
{T_:Za.getTypeName(),B_:Za.getBaseTypes()})}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}}Object(c.a)(Za,"PowerPointSessionInitMessage",Bb,[]);var mb=a(250);class vb{constructor(){this.authToken=this.origin=this.sessionUrl=null}}Object(c.a)(vb,"SessionData",null,[]);var sb=a(812),bc=a(1120);class yb{constructor(){this.Lch=new Map}Btl(tb,Kc){const ad=
this.Lch.get(tb);if(ad){var id=ad.get(Kc);ad.delete(Kc);0===ad.size&&this.Lch.delete(tb);return id}}fLn(tb,Kc,ad){let id=this.Lch.get(tb);id||(id=new Map,this.Lch.set(tb,id));id.set(Kc,ad)}}Object(c.a)(yb,"AugLoopSessionCallbackStorage",null,[]);var uc=a(364);class vc{constructor(tb){uc.a.assign(vc,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[vc.getTypeName()])}}vc.H_={T_:vc.getTypeName(),
B_:vc.getBaseTypes()};class wc{constructor(tb){uc.a.assign(wc,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[wc.getTypeName()])}}wc.H_={T_:wc.getTypeName(),B_:wc.getBaseTypes()};class ub{constructor(tb){uc.a.assign(ub,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[ub.getTypeName()])}}ub.H_={T_:ub.getTypeName(),B_:ub.getBaseTypes()};class aa{constructor(tb){uc.a.assign(aa,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[aa.getTypeName()])}}aa.H_={T_:aa.getTypeName(),B_:aa.getBaseTypes()};class Na{constructor(tb){uc.a.assign(Na,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_RateLimitErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse",
"AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Na.getTypeName()])}}Na.H_={T_:Na.getTypeName(),B_:Na.getBaseTypes()};class ia{constructor(tb){uc.a.assign(ia,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[ia.getTypeName()])}}ia.H_={T_:ia.getTypeName(),B_:ia.getBaseTypes()};class wa{constructor(tb){uc.a.assign(wa,
this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[wa.getTypeName()])}}wa.H_={T_:wa.getTypeName(),B_:wa.getBaseTypes()};class pa{constructor(tb){uc.a.assign(pa,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[pa.getTypeName()])}}pa.H_={T_:pa.getTypeName(),B_:pa.getBaseTypes()};class Ea{constructor(tb){uc.a.assign(Ea,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Ea.getTypeName()])}}Ea.H_={T_:Ea.getTypeName(),B_:Ea.getBaseTypes()};class La{constructor(tb){uc.a.assign(La,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[La.getTypeName()])}}La.H_={T_:La.getTypeName(),B_:La.getBaseTypes()};class Aa{constructor(tb){uc.a.assign(Aa,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Aa.getTypeName()])}}Aa.H_={T_:Aa.getTypeName(),B_:Aa.getBaseTypes()};class nb{constructor(tb){uc.a.assign(nb,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[nb.getTypeName()])}}nb.H_={T_:nb.getTypeName(),B_:nb.getBaseTypes()};class Wa{constructor(tb){uc.a.assign(Wa,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Wa.getTypeName()])}}Wa.H_={T_:Wa.getTypeName(),B_:Wa.getBaseTypes()};class ea{constructor(tb){uc.a.assign(ea,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[ea.getTypeName()])}}ea.H_={T_:ea.getTypeName(),B_:ea.getBaseTypes()};class Kb{constructor(tb){uc.a.assign(Kb,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Kb.getTypeName()])}}Kb.H_={T_:Kb.getTypeName(),B_:Kb.getBaseTypes()};class kc{constructor(tb){uc.a.assign(kc,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[kc.getTypeName()])}}kc.H_={T_:kc.getTypeName(),B_:kc.getBaseTypes()};class ac{constructor(tb){uc.a.assign(ac,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[ac.getTypeName()])}}ac.H_={T_:ac.getTypeName(),B_:ac.getBaseTypes()};class eb{constructor(tb){uc.a.assign(eb,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[eb.getTypeName()])}}eb.H_={T_:eb.getTypeName(),B_:eb.getBaseTypes()};class Hb{constructor(tb){uc.a.assign(Hb,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Hb.getTypeName()])}}Hb.H_={T_:Hb.getTypeName(),B_:Hb.getBaseTypes()};class ua{constructor(tb){uc.a.assign(ua,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[ua.getTypeName()])}}ua.H_={T_:ua.getTypeName(),B_:ua.getBaseTypes()};class Va{constructor(tb){uc.a.assign(Va,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Va.getTypeName()])}}Va.H_={T_:Va.getTypeName(),B_:Va.getBaseTypes()};class Yb{constructor(tb){uc.a.assign(Yb,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_BatchedMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[Yb.getTypeName()])}}Yb.H_={T_:Yb.getTypeName(),B_:Yb.getBaseTypes()};class Cb{constructor(tb){uc.a.assign(Cb,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Cb.getTypeName()])}}Cb.H_={T_:Cb.getTypeName(),B_:Cb.getBaseTypes()};class ca{constructor(tb){uc.a.assign(ca,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[ca.getTypeName()])}}ca.H_={T_:ca.getTypeName(),B_:ca.getBaseTypes()};class Ra{constructor(tb){uc.a.assign(Ra,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Ra.getTypeName()])}}Ra.H_={T_:Ra.getTypeName(),B_:Ra.getBaseTypes()};class bb{constructor(tb){uc.a.assign(bb,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[bb.getTypeName()])}}bb.H_={T_:bb.getTypeName(),B_:bb.getBaseTypes()};class wb{constructor(tb){uc.a.assign(wb,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[wb.getTypeName()])}}wb.H_={T_:wb.getTypeName(),B_:wb.getBaseTypes()};class Fa{constructor(tb){uc.a.assign(Fa,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[Fa.getTypeName()])}}Fa.H_={T_:Fa.getTypeName(),B_:Fa.getBaseTypes()};class rb{constructor(tb){uc.a.assign(rb,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[rb.getTypeName()])}}rb.H_={T_:rb.getTypeName(),B_:rb.getBaseTypes()};class $b{constructor(tb){uc.a.assign($b,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[$b.getTypeName()])}}$b.H_={T_:$b.getTypeName(),B_:$b.getBaseTypes()};class ec{constructor(tb){uc.a.assign(ec,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[ec.getTypeName()])}}ec.H_={T_:ec.getTypeName(),B_:ec.getBaseTypes()};class pc{constructor(tb){uc.a.assign(pc,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[pc.getTypeName()])}}pc.H_={T_:pc.getTypeName(),B_:pc.getBaseTypes()};class dd{constructor(tb){uc.a.assign(dd,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[dd.getTypeName()])}}dd.H_={T_:dd.getTypeName(),B_:dd.getBaseTypes()};class Ad{constructor(tb){uc.a.assign(Ad,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[Ad.getTypeName()])}}Ad.H_={T_:Ad.getTypeName(),B_:Ad.getBaseTypes()};class Jb{constructor(tb){uc.a.assign(Jb,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Jb.getTypeName()])}}Jb.H_={T_:Jb.getTypeName(),B_:Jb.getBaseTypes()};class Bc{constructor(tb){uc.a.assign(Bc,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[Bc.getTypeName()])}}Bc.H_={T_:Bc.getTypeName(),B_:Bc.getBaseTypes()};class Mc{constructor(tb){uc.a.assign(Mc,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Mc.getTypeName()])}}Mc.H_={T_:Mc.getTypeName(),B_:Mc.getBaseTypes()};class ed{constructor(tb){uc.a.assign(ed,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[ed.getTypeName()])}}ed.H_={T_:ed.getTypeName(),B_:ed.getBaseTypes()};class Yc{constructor(tb){uc.a.assign(Yc,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Yc.getTypeName()])}}Yc.H_={T_:Yc.getTypeName(),B_:Yc.getBaseTypes()};class ab{constructor(tb){uc.a.assign(ab,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[ab.getTypeName()])}}ab.H_={T_:ab.getTypeName(),B_:ab.getBaseTypes()};class jb{constructor(tb){uc.a.assign(jb,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[jb.getTypeName()])}}jb.H_={T_:jb.getTypeName(),B_:jb.getBaseTypes()};class cc{constructor(tb){uc.a.assign(cc,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[cc.getTypeName()])}}cc.H_={T_:cc.getTypeName(),B_:cc.getBaseTypes()};class Hc{constructor(tb){uc.a.assign(Hc,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Hc.getTypeName()])}}Hc.H_={T_:Hc.getTypeName(),B_:Hc.getBaseTypes()};class Vc{constructor(tb){uc.a.assign(Vc,this,tb)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,
[Vc.getTypeName()])}}Vc.H_={T_:Vc.getTypeName(),B_:Vc.getBaseTypes()};var Tc=a(1673);class cd{constructor(tb,Kc,ad,id){var ud;this.o_f=new Map;this.eXd=new Map;this.p_f=new Map;this.TFe=new Map;this.lLc=this.scc=this.W$c=this.iA=null;this.G3h=new yb;this.rah=new Map;this.C7f=!1;this.MGl=[];if(!tb)throw Error.argumentNull("augLoopRuntimeManager");if(!Kc)throw Error.argumentNull("applicationSettings");if(!ad)throw Error.argumentNull("outboundHelper");if(!id)throw Error.argumentNull("pathManager");this.LA=
tb;this.Aa=Kc;this.qm=ad;this.rf=id;const ke=new U.a;ke.powerpoint=new Ja;tb=new U.a;mb.a("AL.SendNewInitParams")&&(tb.serviceUrl=null!==(ud=Object(bc.a)(Kc))&&void 0!==ud?ud:void 0);if(mb.a("AL.SendSlideTile"))if(mb.a("AL.EnableRehydration"))this.LA.initialize(tb),this.LA.setInitSessionCallback(Object.assign(new Qa,{initSessionCallback:Object(ba.a)(this,this.Yrn,"onSessionInit")})),this.LA.setSessionInitOverrideCallback(Object.assign(new ja,{handler:Object(ba.a)(this,this.Zrn,"onSessionInitOverride")})),
this.lLc=this.Ljh(),this.LA.setAnnotationResultCallback(Object(ba.a)(this,this.onAnnotationResult,"onAnnotationResult")),this.KEa=Promise.resolve(null);else{Kc=qa.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;ud=qa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").$l;Kc=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",ud,Kc);ud=qa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").Gsa?qa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").n$a:
qa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").$l;var of=String.format("{0}getitems.ashx",ud);ud=new ra.a(f.AFrameworkApplication.ye);this.KEa=sb.b(ud.xMe(Kc,1,"",0));this.KEa.then(Yf=>{try{const If=JSON.parse(Yf),Jf=If.downloadUrl;I.a.rb(Jf)?b.ULS.sendTraceTag(509112976,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",If):(ke.powerpoint.downloadUrl=Jf,ke.powerpoint.getItemsEndPoint=of,this.Aa.etc&&(ke.powerpoint.documentOpenType=this.Mvl()))}catch(If){b.ULS.sendTraceTag(509112975,
306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",If)}this.LA.initialize(ke);this.lLc=this.Ljh();this.LA.setAnnotationResultCallback(Object(ba.a)(this,this.onAnnotationResult,"onAnnotationResult"));return null}).catch(Yf=>{b.ULS.sendTraceTag(509112974,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Yf);this.LA.initialize(ke);this.lLc=this.Ljh();this.LA.setAnnotationResultCallback(Object(ba.a)(this,this.onAnnotationResult,"onAnnotationResult"))})}else this.KEa=
new Promise(Yf=>{this.LA.initialize(ke);this.lLc=this.Ljh();this.LA.setAnnotationResultCallback(Object(ba.a)(this,this.onAnnotationResult,"onAnnotationResult"));Yf("")})}Rbd(tb){this.MGl.push(tb)}e0(tb){this.KEa.then(Kc=>{if(!this.rah.has(tb))return this.LA.activateAnnotation(Object.assign(new Oa.a,{annotationType:tb})),this.rah.set(tb,Kc),Kc})}releaseAnnotation(tb){return Object(ha.b)(this,void 0,void 0,function*(){yield this.KEa;var Kc=this.rah.get(tb);return Kc?((Kc=yield this.LA.releaseAnnotation({token:Kc}))&&
this.rah.delete(tb),Kc):!1})}GBa(tb,Kc){if(tb)if(Kc){if(this.o_f.has(tb))var ad=this.o_f.get(tb);else ad=new u.a,this.o_f.set(tb,ad);ad&&!ad.contains(Kc)&&ad.add(Kc)}else b.ULS.sendTraceTag(509112972,306,15,"AnnotationHandler is null");else b.ULS.sendTraceTag(509112973,306,15,"Annotation Type is null or empty")}KXl(tb,Kc){if(tb)if(Kc){if(this.p_f.has(tb))var ad=this.p_f.get(tb);else ad=new u.a,this.p_f.set(tb,ad);ad&&!ad.contains(Kc)&&ad.add(Kc)}else b.ULS.sendTraceTag(509116945,306,15,"AnnotationHandler is null");
else b.ULS.sendTraceTag(509116947,306,15,"Annotation Type is null or empty")}LXl(tb,Kc){if(tb)if(Kc){if(this.eXd.has(tb))var ad=this.eXd.get(tb);else ad=new u.a,this.eXd.set(tb,ad);ad&&!ad.contains(Kc)&&ad.add(Kc)}else b.ULS.sendTraceTag(509112970,306,15,"AnnotationHandler is null");else b.ULS.sendTraceTag(509112971,306,15,"Annotation Type is null or empty")}addEventHandler(tb,Kc){this.KEa.then(()=>{this.LA.addEventHandler(tb,Kc);return null})}removeEventHandler(tb,Kc){this.KEa.then(()=>{this.LA.removeEventHandler(tb,
Kc);return null})}registerSimpleLocalWorkflow(tb,Kc){return this.KEa.then(()=>this.LA.registerSimpleLocalWorkflow(tb,this.Wyh(Kc)))}registerSimpleRemoteWorkflow(tb,Kc,ad,id){return this.KEa.then(()=>this.LA.registerSimpleRemoteWorkflow(tb,this.Wyh(Kc),this.Wyh(ad),this.Wyh(id)))}submit(tb,Kc){this.Aa.Yja||this.KEa.then(()=>{this.LA.submit(tb,Kc);return null})}submitOperation(tb){this.KEa.then(()=>{this.LA.submitOperation(tb);return null})}GIm(tb,Kc){return this.lLc.then(()=>Object(ha.b)(this,void 0,
void 0,function*(){return yield fetch(this.scc.sessionUrl,{method:"POST",headers:{"Content-Type":"application/jsond","X-Origin":this.scc.origin,Authorization:`Bearer ${this.scc.authToken}`},body:Tc.a.serialize(tb),signal:Kc.signal})}))}XSn(tb,Kc=1E4){return Object(ha.b)(this,void 0,void 0,function*(){const ad=new AbortController,id=window.setTimeout(()=>{ad.abort()},Kc);try{if(!(yield this.GIm(tb,ad)).ok)throw Error("Network response was not ok");}catch(ud){if(ud instanceof DOMException&&"AbortError"===
ud.name)throw Error("Request timed out");throw ud;}finally{clearTimeout(id)}})}submitBinarySignal(tb,Kc,ad,id,ud=1E4){return Object(ha.b)(this,void 0,void 0,function*(){this.lLc.then(()=>Object(ha.b)(this,void 0,void 0,function*(){this.G3h.fLn(Kc,id,ad);void 0!==this.mtm&&clearInterval(this.mtm);try{yield this.XSn(new ca({parentPath:["session","img"],item:{id,body:tb}}),ud)}catch(ke){throw this.G3h.Btl(Kc,id),ke;}}))})}DIm(tb){return this.lLc.then(()=>fetch(`${this.scc.sessionUrl}/blob/${tb}`,{headers:{"X-Origin":this.scc.origin,
Authorization:`Bearer ${this.scc.authToken}`}}))}getBlob(tb,Kc=1E4){return Object(ha.b)(this,void 0,void 0,function*(){const ad=new AbortController,id=window.setTimeout(()=>{ad.abort()},Kc);yield this.KEa;try{const ud=yield this.DIm(tb);if(!ud.ok)throw Error("Network response was not ok");return ud.blob()}catch(ud){if(ud instanceof DOMException&&"AbortError"===ud.name)throw Error("Request timed out");throw ud;}finally{clearTimeout(id)}})}UYn(tb,Kc,ad,id,ud){this.lLc&&this.lLc.then(()=>{this.qm.augmentImage(tb,
Kc,ad,!0,this.scc.sessionUrl,this.scc.origin,this.scc.authToken,id,ud);return null})}Zrn(tb){b.ULS.sendTraceTag(509112969,306,50,"PPTAugLoopRuntimeManager: OnSessionInitOverride");const Kc=Object.assign(new Za,{protocolVersion:tb.protocolVersion,clientMetadata:tb.clientMetadata,sessionKey:tb.sessionKey,origin:tb.origin,authToken:tb.authToken,messageId:tb.messageId,cv:tb.cv,fileUrl:this.rf.documentUrl});try{this.Aa.etc&&(Kc.documentOpenType=this.Mvl())}catch(ad){b.ULS.sendTraceTag(509112968,306,10,
"PPTWebEditorAugLoopRunTimeManager::OnSessionInitOverride exception:{0}",ad)}this.SLn(tb);if(I.a.rb(this.iA)||I.a.rb(this.W$c))return b.ULS.sendTraceTag(509112967,306,15,"PPTAugLoopRuntimeManager: Failed to override sessionInitMessage, null or empty downloadUrl obtained"),tb;Kc.downloadUrl=this.iA;Kc.getItemsEndPoint=this.W$c;this.W$c=this.iA=null;return Kc}Yrn(){b.ULS.sendTraceTag(509112966,306,50,"PPTAugLoopRuntimeManager: OnSessionInit");this.C7f=!0;if(mb.a("AugLoopSessionCreationCallback"))for(var tb of this.MGl)tb();
var Kc=qa.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const ad=qa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").$l;tb=qa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").Gsa?qa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").n$a:qa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").$l;Kc=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",ad,Kc);const id=String.format("{0}getitems.ashx",
tb);tb=new ra.a(f.AFrameworkApplication.ye);return sb.b(tb.xMe(Kc,1,"",0)).then(ud=>{try{const ke=JSON.parse(ud),of=ke.downloadUrl;I.a.rb(of)?b.ULS.sendTraceTag(509112965,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",ke):(this.iA=of,this.W$c=id)}catch(ke){b.ULS.sendTraceTag(509112964,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",ke)}return null}).catch(ud=>{b.ULS.sendTraceTag(509112963,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",
ud)})}Ljh(){return new Promise(tb=>{this.LA.setSessionDataCallback(Object.assign(new Pa,{sessionDataCallback:(Kc,ad,id)=>{this.scc=Object.assign(new vb,{sessionUrl:Kc,origin:ad,authToken:id});tb(null)}}))})}UVm(tb,Kc,ad){tb=this.G3h.Btl(tb,Kc);void 0!==tb&&tb(ad)}onAnnotationResult(tb){if(tb&&tb.items)if(this.Aa.Yja&&this.TJn(tb),hb.a.getTypeNameFor(tb)!==va.a.getTypeName()&&hb.a.getTypeNameFor(tb)!==Mb.a.getTypeName())this.Aa.lyi&&hb.a.getTypeNameFor(tb)===Gb.getTypeName()&&this.dpn(tb);else for(const ad of tb.items){if(!ad||
!ad.body)continue;const id=hb.a.getTypeNameFor(ad.body);if(!id)continue;var Kc=ad.body||{};tb.parentPath&&(Kc.parentPath=tb.parentPath);let ud;if(this.o_f.has(id)){if(ud=this.o_f.get(id))for(const ke of ud)ke(Kc)}else b.ULS.sendTraceTag(509112962,306,50,"Cannot find handlers for annotation:{0};",id);id&&tb.parentPath&&this.UVm(id,tb.parentPath[2],ad.body);if(this.Aa.lyi){if(this.eXd.has(id)&&(Kc=this.eXd.get(id)))for(const ke of Kc)ke(ad,!1);I.a.rb(ad.id)||this.TFe.set(ad.id,id)}}}TJn(tb){const Kc=
new Map,ad=hb.a.getTypeNameFor(tb)!==va.a.getTypeName()&&hb.a.getTypeNameFor(tb)!==Mb.a.getTypeName();for(var id of tb.items){tb=ad&&this.TFe.has(id.id)?this.TFe.get(id.id):hb.a.getTypeNameFor(id.body);let ud;Kc.has(tb)?ud=Kc.get(tb):(ud=new u.a,Kc.set(tb,ud));ud.add(id)}for(const ud of Kc.keys())if(this.p_f.has(ud)){if(id=this.p_f.get(ud))for(const ke of id)ke(Kc.get(ud).toArray(),ad)}else b.ULS.sendTraceTag(509116952,306,50,"Cannot find handlers for annotation:{0};",ud)}dpn(tb){for(const Kc of tb.items)if(Kc&&
Kc.id&&this.TFe.has(Kc.id)){tb=this.TFe.get(Kc.id);if(this.eXd.has(tb)&&(tb=this.eXd.get(tb)))for(const ad of tb)ad(Kc,!0);this.TFe.delete(Kc.id)}}Wyh(tb){return tb?Object.assign(new Ga,{name:tb.name,inputSchema:tb.inputSchema,outputSchema:tb.outputSchema,func:tb.func}):null}Mvl(){try{return this.Aa.isCreateNew?0:this.Aa.m1a?2:1}catch(tb){return b.ULS.sendTraceTag(509112961,306,50,"PPTWebEditorAugLoopRunTimeManager::GetOpenType :{0};",tb),2}}SLn(tb){try{I.a.rb(tb.clientMetadata.flights)?tb.clientMetadata.flights=
";":tb.clientMetadata.flights+=";",this.Aa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)?tb.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Treatment;":tb.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Control;",this.Aa.getBooleanAppSetting("ChatPPTCIQDocMenuEnabled")&&(tb.clientMetadata.flights+="PPTOChatPPTCIQDocMenuEnabled;ciq.user-init.enabled:true;",
tb.clientMetadata.flights+="mc-editor-oa;mc-editor-oa-ecc-annotation;"),this.Aa.getBooleanAppSetting("StorytellerCiqEnabled")&&(tb.clientMetadata.flights+="mc-editor-oa;mc-editor-oa-ecc-annotation;"),this.Aa.Y$a&&(tb.clientMetadata.flights+="StorytellerBypassLicenseCheckEnabled;"),this.Aa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotRewrite",!1)&&mb.a("RewriteBypassLicenseCheckEnabled")&&(tb.clientMetadata.flights+="RewriteBypassLicenseCheckEnabled;")}catch(Kc){b.ULS.sendTraceTag(509112960,
306,50,"PPTWebEditorAugLoopRunTimeManager::SetFlights :{0};",Kc)}}}Object(c.a)(cd,"PPTAugLoopRuntimeManager",null,[1437]);class Lb{constructor(tb){this.Mya=tb;this.Mya.initialize()}addEventHandler(tb,Kc){this.Mya.addEventHandler(tb,Kc)}removeEventHandler(tb,Kc){this.Mya.removeEventHandler(tb,Kc)}oxk(tb,Kc,ad){this.Mya.oxk(tb,Kc,ad)}WLe(tb,Kc,ad,id,ud,ke=null){this.Mya.WLe(tb,Kc,ad,id,ud,ke)}}Object(c.a)(Lb,"PPTAugmentationManager",null,[1436]);var Rc=a(495),md=a(83);class Zc{constructor(tb){uc.a.assign(Zc,
this,tb)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Zc.getTypeName()])}}Zc.H_={T_:Zc.getTypeName(),B_:Zc.getBaseTypes()};class ld{constructor(tb){uc.a.assign(ld,this,tb)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[ld.getTypeName()])}}ld.H_={T_:ld.getTypeName(),B_:ld.getBaseTypes()};class fe{constructor(tb){uc.a.assign(fe,
this,tb)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[fe.getTypeName()])}}fe.H_={T_:fe.getTypeName(),B_:fe.getBaseTypes()};class Ac{constructor(tb){uc.a.assign(Ac,this,tb)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[Ac.getTypeName()])}}Ac.H_={T_:Ac.getTypeName(),B_:Ac.getBaseTypes()};class R{constructor(tb){uc.a.assign(R,
this,tb)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(tb){return uc.a.matchesTypesFor(tb,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};var za=a(248);class X{constructor(tb){this.fL=tb;tb.body&&(tb=tb.body,this.ID=tb.id,this.Status=tb.status,this.Text=tb.text,this.FCh=this.TSm())}TSm(){return this.fL.parentPath&&0<this.fL.parentPath.length?this.fL.parentPath[this.fL.parentPath.length-1]:""}}Object(c.a)(X,
"ALChatHelperResponse",null,[1476]);class lb{constructor(tb,Kc){this.kdn=0;this.oLl=new Map;this.LA=Kc;const ad=["session","chats"],id=(new Rc.a(md.a.create(),1)).toString(),ud=[...ad,id];this.$cn=[...ud,"messages"];this.LA.execute(ke=>{ke.submitOperation(lb.bki(ad,id,tb.Bzb));ke.submitOperation(lb.bki(ud,"messages",new fe));ke.e0(tb.responseType);ke.LXl(tb.responseType,this.Fna.bind(this))})}Fna(tb){tb=new X(tb);if(tb.FCh){const Kc=this.oLl.get(tb.FCh);if(Kc){Kc(tb);this.oLl.delete(tb.FCh);return}}this.tbn?
this.tbn(tb):za.a.J(509366417,822,15,"No handler found")}send(tb){const Kc=`${this.kdn++}`;this.LA.execute(ad=>{ad.submitOperation(lb.bki(this.$cn,Kc,tb))})}static bki(tb,Kc,ad){return Object.assign(new va.a,{parentPath:tb,items:[{id:Kc,body:ad}]})}}Object(c.a)(lb,"ALChatHelper",null,[1465]);class oc{constructor(tb){this.Dmh=tb}create(tb){return new lb(tb,this.Dmh)}}Object(c.a)(oc,"ALChatHelperFactory",null,[1439]);var Oc=a(30);class sd{constructor(){this.YQk="TML";this.Bkk="RTA";this.CKk="SR";this.ua=
new Oc.a}Sqm(tb){this.ua.addHandler(this.YQk,tb)}yGn(tb){this.ua.removeHandler(this.YQk,tb)}ACn(tb){this.ua.raiseEvent(this.YQk,tb)}rqm(tb){this.ua.addHandler(this.Bkk,tb)}eGn(tb){this.ua.removeHandler(this.Bkk,tb)}Gth(tb){this.ua.raiseEvent(this.Bkk,tb)}zqm(tb){this.ua.addHandler(this.CKk,tb)}mGn(tb){this.ua.removeHandler(this.CKk,tb)}Jth(tb){this.ua.raiseEvent(this.CKk,tb)}}Object(c.a)(sd,"TilingEventSource",null,[1433,1434,1435]);class Ld{constructor(){this.$=null}get name(){return"PowerPointWebEditor.AugmentationLoop"}lc(tb){this.$=
tb;this.$.register(Lb,"PowerPointWebEditor.AugmentationLoop.PPTAugmentationManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager").ma().na(()=>new Lb(new r(f.AFrameworkApplication.ye,tb.resolve("Common.IAppSettingsManager"),"PowerPoint_Online")));this.$.register(cd,"PowerPointWebEditor.AugmentationLoop.PPTAugLoopRuntimeManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").ma().na(()=>{const Kc=e.a.B7m();b.ULS.sendTraceTag(509441561,306,50,"IsWebSocketSupported: {0}",
Kc);f.AFrameworkApplication.ga.appSettings.AugLoopUseWebSocket=Kc.toString();return new cd(new Ta(tb.resolve("Common.ISharedDependencyLoader"),tb.Na("Common.App.OAuth.IOAuthManager")),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.$.resolve("PowerPoint.IPathManager"))});Object(mb.a)("EnableALChatHelper")&&this.$.register(oc,"PowerPointWebEditor.AugmentationLoop.ALChatHelperFactory").as("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory").ma().na(()=>
new oc(this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")));this.$.register(sd,"PowerPointWebEditor.AugmentationLoop.TilingEventSource").as("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier").as("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers").as("PowerPointWebEditor.AugmentationLoop.ITilingEventSource").ma().na(()=>new sd)}init(){this.$.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager");this.$.resolve("PowerPointWebEditor.IApplicationSettings").cfe&&
(this.$.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),Object(mb.a)("EnableALChatHelper")&&this.$.resolve("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory"))}dispose(){}static main(){h.a.instance.Fc(new Ld)}}Object(c.a)(Ld,"PPTWebEditorAugmentationLoopPackage",null,[3,4]);var Qd=a(151),Id=a(1200),he=a(1198),xb=a(826),Sb=a(276),Cc=a(253);class qb{constructor(tb){if(!tb)throw Error.argumentNull("Handler for Text Prediction is Null- unable to retrieve initial text prediction signal state");
this.X3a=tb}oDe(tb){this.I_g(tb)}I_g(tb){if(tb){try{const ud=tb.parentPath;if(!ud||4>ud.length){za.a.J(507843231,820,50,"ParentPath is Null or Empty.");return}const ke=ud[3];var Kc=ud[2];if(!ke){za.a.J(507843230,820,50,"Unable to retreive original paragraph text");return}var ad=this.X3a.HPm(ke);this.X3a.BFn(ke);const of=tb.predictions;if(!of||!of.length){za.a.J(507843229,820,50,"Augloop Annotations Null or Empty.");return}const Yf=of[0];if(!Yf)return;var id=Yf.text;if(!id||!id.length){za.a.J(507843228,
820,50,"Text Predictions Null or Empty.");return}}catch(ud){za.a.J(507843227,820,10,"Unable to parse output because of modified output type from Augloop");return}id&&qb.fFm(id,ad,Kc)}else za.a.J(507843232,820,50,"Annotations returned from service is null.")}static fFm(tb,Kc,ad){tb&&tb.length&&(Kc=qb.JRm(tb,Kc),-1!==Kc&&(Kc=tb.substring(Kc,tb.length),ad=Object.assign(new he.a,{text:tb,z$:Kc,jx:ad}),xb.a.jF.pba=ad,xb.a.mcf(tb,Kc)))}static JRm(tb,Kc){var ad=Sb.a.instance.Ua.mb.mf.node;if(!ad||!Kc)return-1;
ad=Cc.ParagraphReader.text(ad);if(!ad)return-1;if(ad!==Kc)if(ad.length>Kc.length&&ad.substring(0,Kc.length)===Kc){if(!tb.startsWith(ad.substring(Kc.length,ad.length-Kc.length)))return-1;za.a.J(507843226,820,50,"Ghost Text matches part of the Prediction Text.")}else return-1;return" "===ad.substring(ad.length-1,1)?0:qb.EPi(ad)}static EPi(tb){return tb?tb.length-1-tb.lastIndexOf(" "):-1}}Object(c.a)(qb,"TextPredictionAugLoopResponseManager",null,[]);var Ob=a(422);class Pb extends Ha.a{constructor(){super();
this.H_=Object.assign(new gb.a,{T_:Pb.getTypeName(),B_:Pb.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(c.a)(Pb,"SignalOperation",Ha.a,[]);var qc=a(901);class Uc{constructor(){this.gbk=!1}}Object(c.a)(Uc,"PredictionSettings",null,[]);class pd{constructor(tb,Kc){this.Oph=null;this.oGj={};this.LA=tb;this.Db=Kc;this.Db.F4c(Object(ba.a)(this,this.Eyl,"handleResize"))}HPm(tb){return this.oGj[tb]}jMn(tb,Kc){this.oGj[tb]=
Kc}BFn(tb){tb&&delete this.oGj[tb]}get settings(){this.Oph||(this.Oph=Object.assign(new Uc,{gbk:!1}));return this.Oph}set settings(tb){this.Oph=tb}NVn(tb){if(this.settings.gbk&&tb){var Kc=tb.id.toString(),ad=xb.a.jF.pba,id=Sb.a.instance.Ua.mb;if(id&&1===id.length&&id.mf){id=id.mf;var ud=id.node;if(Cc.ParagraphReader.textLength(ud)===id.Va){if(ad&&ud&&Kc===ad.jx&&Kc===ud.id.toString()&&(id=this.dDf(ad,ud))){ad.z$=id;xb.a.mcf(ad.text,id);return}xb.a.jF.pba=null;ad=md.a.create().toString();id=Cc.ParagraphReader.text(tb);
this.jMn(ad,id);tb=["Signal",qc.a.getTypeName(),Kc,ad];ad=pd.OQm(id);Kc=[Object.assign(new Ob.a,{id:Kc,body:ad})];var ke=Object.assign(new Pb,{parentPath:tb,items:Kc});this.LA.execute(of=>{of.submitOperation(ke);za.a.J(512493778,820,50,"TextPrediction Signal sent to Augloop Service")})}}}}qLe(){xb.a.jF.pba=null;xb.a.R_a()}iXm(tb){!tb||1<tb.length?this.qLe():1>tb.length||((tb=tb[0])&&tb.context?(tb=tb.context,tb.Va===tb.Ib&&Cc.ParagraphReader.textLength(tb.node)===tb.Va||this.qLe()):this.qLe())}dDf(tb,
Kc){var ad=null;if(tb&&Kc){Kc=Cc.ParagraphReader.text(Kc);tb=tb.text;if(!Kc||!tb)return ad;Kc=Kc.replace(RegExp("\\u00a0","g")," ");tb=tb.replace(RegExp("\\u00a0","g")," ");if(Kc){if(Kc.endsWith(tb))return this.qLe(),ad;ad=pd.hRm(Kc,tb);ad=tb.substring(ad,tb.length)}}return ad}Eyl(){xb.a.R_a()}dispose(){this.Db.Fdd(Object(ba.a)(this,this.Eyl,"handleResize"))}static OQm(tb){return Object.assign(new qc.a,{languageId:"en-US",startOfSentence:!0,text:tb})}static hRm(tb,Kc){for(let ad=Kc.length;0<ad;ad--){const id=
Kc.substring(0,ad);if(tb.endsWith(id.trimStart()))return id.length}return 0}}pd.yTa=!1;Object(c.a)(pd,"TextPredictionHandler",null,[1430]);var Od=a(269),be=a(251);class te{constructor(tb,Kc){this.ia=tb;this.oc=Kc}Hb(){this.ia.za(be.a.rVl,Od.a.application,Object(ba.a)(this,this.eAn,"predictionHandler"))}eAn(tb,Kc,ad){return f.AFrameworkApplication.ga.getBooleanAppSetting("PPTOTextPredictionIsEnabled")?1===ad?this.oc.hl()?32:2:8:8}}Object(c.a)(te,"TextPredictorActor",null,[]);class Le{constructor(){this.lQj=
this.$=null}get name(){return"PowerPointWebEditor.TextPrediction"}lc(tb){this.$=tb;tb.register(te,"PowerPointWebEditor.TextPrediction.TextPredictorActor").ma().na(()=>new te(tb.resolve("Common.IActionManagerExtended"),tb.resolve("PowerPointWebEditor.IPresentationReader")));tb.register(1430,"PowerPointWebEditor.TextPrediction.ITextPredictionHandler").ma().na(()=>new pd(tb.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),tb.resolve("PowerPointWebEditor.Core.IPPTAppFrame")))}init(){this.$.resolve("PowerPointWebEditor.TextPrediction.TextPredictorActor").Hb();
this.lQj=new Qd.a(()=>new qb(this.$.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(tb=>{tb.e0(Id.a.getTypeName());tb.GBa(Id.a.getTypeName(),Object(ba.a)(this.lQj.value,this.lQj.value.oDe,"handleResponse"))})}dispose(){}static main(){h.a.instance.Fc(new Le)}}Object(c.a)(Le,"TextPredictionPackage",null,[3,4]);var kf=a(180),fg=a(249);class pe{}Object(c.a)(pe,"AugContextId",null,[]);class me{}Object(c.a)(me,
"AugParagraph",null,[]);class Ke{}Object(c.a)(Ke,"AugShape",null,[]);class Ie{}Object(c.a)(Ie,"ShapeTextTile",null,[]);class Ef{constructor(tb,Kc,ad,id){this.Ia=ad;this.Cj=id;this.Pb=tb;this.un=Kc}JAe(tb,Kc){return tb&&tb.isConnected&&this.Ia.ATa(tb)?(tb=Object(w.a)(426,tb))?Object.assign(new Ie,{Topic:"ShapeText",ContextId:n.c(Ef.jzm(tb,Kc)),Data:n.c(this.kzm(tb))}):null:null}Zlf(tb){return tb&&tb.get_shapeId()&&tb.hasText&&!tb.isLocked?tb.GEe:!1}kzm(tb){const Kc=[];tb=this.Pb.Hc(tb);for(tb=this.un.oca(tb,
tb.currentNode);tb.moveNext();){var ad=tb.currentNode;const id=ad;this.Cj.me(id)&&(ad=Object.assign(new me,{t:this.Cj.text(id),l:this.Cj.P1b(ad)}),Array.add(Kc,ad))}return Object.assign(new Ke,{p:Kc,c:kf.a.Ne(f.AFrameworkApplication.lcid).Mib})}static jzm(tb,Kc){return Object.assign(new pe,{gid:tb.id,sid:tb.slideSid,cid:tb.slideCid,shapeId:tb.get_shapeId(),rid:(tb.W9c||tb.FTa||fg.App.ep).toString(),t:Kc,c:(new Date).getTime()})}}Object(c.a)(Ef,"ShapeTextTileManager",null,[1415,1479]);var We=a(21),
Ae=a(1599),se=a(39),pf;(function(tb){tb[tb.none=0]="none";tb[tb.onParagraphPropertyChanged=1]="onParagraphPropertyChanged";tb[tb.onSelectionFinished=2]="onSelectionFinished";tb[tb.onActiveSlideDomReady=4]="onActiveSlideDomReady";tb[tb.onShapeChildTopologyChanged=8]="onShapeChildTopologyChanged";tb[tb.onParagraphDisconnect=16]="onParagraphDisconnect";tb[tb.onNumberListPropertyChanged=32]="onNumberListPropertyChanged";tb[tb.onNumberListDisconnect=64]="onNumberListDisconnect";tb[tb.onSlideConnected=
128]="onSlideConnected";tb[tb.onSlideDisconnected=256]="onSlideDisconnected";tb[tb.onRefreshTileAnnotations=512]="onRefreshTileAnnotations";tb[tb.onSlideReorder=1024]="onSlideReorder"})(pf||(pf={}));Object(c.b)("EventNames",pf);class eg{constructor(){this.Y_c=this.graphNode=null;this.b$c=0;this.XQk=null}}Object(c.a)(eg,"TileGraphNode",null,[]);class pg{constructor(){this.S0l=this.Pvk=this.K_i=this.Uxl=0}}Object(c.a)(pg,"TileTelemetry",null,[]);var ne;(function(tb){tb[tb.unknown=0]="unknown";tb[tb.activeSlideChanged=
1]="activeSlideChanged";tb[tb.shapeSelected=2]="shapeSelected";tb[tb.listLevelChanged=3]="listLevelChanged";tb[tb.richEditTextUnicodeChanged=4]="richEditTextUnicodeChanged";tb[tb.shapeChildTopologyChanged=5]="shapeChildTopologyChanged";tb[tb.paragraphDeleted=6]="paragraphDeleted";tb[tb.numberListDeleted=7]="numberListDeleted";tb[tb.numberListPropertyChanged=8]="numberListPropertyChanged";tb[tb.slideAdded=9]="slideAdded";tb[tb.slideDeleted=10]="slideDeleted";tb[tb.refreshTileAnnotations=11]="refreshTileAnnotations";
tb[tb.slideReorder=12]="slideReorder"})(ne||(ne={}));Object(c.b)("TriggerName",ne);var sf=a(694);class Ye{constructor(tb,Kc,ad,id){this.ZRl=(ud,ke)=>{ud=new sf.a(!1,null,ke.Ga);this.aAb(ud,4)};this.Tb=Kc;this.Vbn=ad;this.Men=tb;this.wQj={};this.S2f={};this.Db=id}initialize(){this.Jz()}dispose(){this.xFa()}onParagraphPropertyChanged(tb,Kc){this.aAb(Kc,1)}Qcc(tb,Kc){this.aAb(Kc,2)}onActiveSlideDomReady(tb,Kc){this.aAb(Kc,4)}onShapeChildTopologyChanged(tb,Kc){this.aAb(Kc,8)}ZBb(tb,Kc){this.aAb(Kc,16)}get pV(){return this.Men}get gJa(){return this.wQj}get iNb(){return this.S2f}aAb(tb,
Kc){try{if(2===this.Db.mode&&Object(Ae.a)(pf,Kc)in this.wQj){var ad=Date.now();Object(w.a)(1474,this.wQj[Object(Ae.a)(pf,Kc)]).gTa(tb,(id,ud)=>{this.fpn(id,ud,ad)})}}catch(id){za.a.J(508879877,306,10,"Exception thrown at DetectTiles: "+id)}}fpn(tb,Kc,ad){if(!F.a.rb(tb))try{for(const id of tb){if(!We.a.count(this.S2f)){const of=new se.a(3,1,this.Vbn,Object(ba.a)(this,this.fireTileEvents,"fireTileEvents"),90,"24");this.Tb.Qb(of)}let ud;if(id.id.toString()in this.S2f)ud=Object(w.a)(eg,this.S2f[id.id.toString()]),
ud.b$c=Kc;else{const of=new pg;ud=Object.assign(new eg,{graphNode:id,b$c:Kc,Y_c:{},XQk:of});this.S2f[id.id.toString()]=ud;this.Tnn(of,ad)}const ke=ne[Kc];ud.Y_c[ke]=(ke in ud.Y_c?ud.Y_c[ke]:0)+1}}catch(id){za.a.J(508879876,306,10,"Exception thrown at FireTiles: "+id)}}Tnn(tb,Kc){tb&&(tb.Uxl=Kc,tb.K_i=Date.now())}WOl(tb,Kc){tb&&(tb.Pvk=Kc,tb.S0l=Date.now())}htl(tb){return tb?String.format("GraphDetectDuration: {0}, QueueDuration: {1}, ScanGraphSpaceDuration: {2}",tb.K_i-tb.Uxl,tb.Pvk-tb.K_i,tb.S0l-
tb.Pvk):""}}Object(c.a)(Ye,"TileTriggerControllerBase",null,[1475,24]);class Yd extends Ye{constructor(tb,Kc,ad,id,ud,ke,of,Yf,If,Jf,Th,yh,yi){super(of&31,Yf,Jf,yh);this.lta=tb.Sd(12);this.HP=tb.Sd(10);this.pa=Kc;this.kd=ad;this.Mya=id;this.B1=ud;this.TNa=ke;this.va=If;this.tAa=Th;this.Zen=yi}Jz(){1===(this.pV&1)&&(this.lta.Am(Object(ba.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.gJa[Object(Ae.a)(pf,1)]=this.tAa.ZBm());2===(this.pV&2)&&(this.pa.QM(Object(ba.a)(this,
this.Qcc,"onProcessSetSelectionFinished")),this.gJa[Object(Ae.a)(pf,2)]=this.tAa.$Bm());4===(this.pV&4)&&(this.kd.Fea(Object(ba.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.gJa[Object(Ae.a)(pf,4)]=this.tAa.XBm());8===(this.pV&8)&&(this.HP.fG(Object(ba.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.gJa[Object(Ae.a)(pf,8)]=this.tAa.aCm());16===(this.pV&16)&&(this.lta.h9a(Object(ba.a)(this,this.ZBb,"onBeforeParagraphDisconnect")),this.gJa[Object(Ae.a)(pf,
16)]=this.tAa.YBm())}xFa(){this.lta.Pq(Object(ba.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.pa.Bbb(Object(ba.a)(this,this.Qcc,"onProcessSetSelectionFinished"));this.kd.b6a(Object(ba.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.HP.PO(Object(ba.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"));this.lta.zbb(Object(ba.a)(this,this.ZBb,"onBeforeParagraphDisconnect"))}fireTileEvents(){try{if(this.va&&this.va.Ga){var tb=this.va.Ga.xj();
for(const Kc of tb){const ad=Kc.id.toString();ad in this.iNb&&(this.Gxf(Object(w.a)(eg,this.iNb[ad])),delete this.iNb[ad])}We.a.forEach(this.iNb,Kc=>{delete this.iNb[Kc]},null)}}catch(Kc){za.a.J(507843605,306,10,"Exception thrown at FireTileEvents: "+Kc)}}Gxf(tb){if(tb){var Kc=Date.now(),ad=this.TNa.JAe(tb.graphNode,ne[tb.b$c]);if(ad){this.Zen?this.B1.execute(ud=>{ud.submit("ShapeTextTile",ad)}):this.Mya.execute(ud=>{ud.oxk(ad.Topic,ad.Data,ad.ContextId)});const id=tb.XQk;this.WOl(id,Kc);za.a.J(507843604,
306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, {2}",ne[tb.b$c],tb.Y_c,this.htl(id))}}}}Object(c.a)(Yd,"ShapeTextTileTriggerController",Ye,[]);var Lg=a(134),Yg=a(286),Ng=a(258),df=a(292),Pg=a(288),ig=a(345),ji=a(256);class Ca{constructor(){this.lcid=this.end=this.start=0;this.noProof=!1}}Object(c.a)(Ca,"TextSpan",null,[]);class cb{}Object(c.a)(cb,"AugCharFormat",null,[]);class Eb{}Object(c.a)(Eb,"AugCharFormatRun",null,[]);class fc{}Object(c.a)(fc,"AugDrawingElement",null,[]);class Ec{}
Object(c.a)(Ec,"AugDrawingElementMoniker",null,[]);class Ya{}Object(c.a)(Ya,"AugPara",null,[]);class Ub{}Object(c.a)(Ub,"AugParaFormat",null,[]);class rc{}Object(c.a)(rc,"AugParaFormatRun",null,[]);class fd{}Object(c.a)(fd,"AugSlide",null,[]);class Cd{}Object(c.a)(Cd,"AugSlideMoniker",null,[]);class Jd{}Object(c.a)(Jd,"AugText",null,[]);class Rd{}Object(c.a)(Rd,"AugTextTile",null,[]);class Me{constructor(tb,Kc,ad,id,ud,ke,of,Yf,If,Jf,Th,yh){this.Cj=tb;this.gq=Kc;this.dmg=ad;this.Pb=id;this.LY=ud;
this.Ac=ke;this.un=of;this.WYb=Th;this.ZGe=Yf;this.T5d=If;this.sB=Jf;this.S5d=yh}JAe(tb){if(!tb||!tb.isConnected)return null;var Kc=Object(w.a)(32,tb);if(!Kc)return null;let ad=tb=0;Kc=({qsh:tb,Ceh:ad}=this.sCm(Kc)).returnValue;if(!Kc)return null;Kc=Object.assign(new Rd,{Id:md.a.create().toString(),Content:n.c(Kc)});za.a.J(508945997,306,50,"TileId: {0}; ParaCount: {1}; DirtyParaCount: {2};",Kc.Id,tb,ad);return Kc}sCm(tb){let Kc=0,ad=0;const id=[];var ud=tb?tb.xj():[];for(var ke of ud)if(!this.gq.S$a(ke)||
this.WYb)if(ke.Zc){if(ud=this.Ac.NQ(ke))ud=this.Pb.Hc(ud),this.LY.t7c(ud,of=>{(of=Object(w.a)(502,of.currentNode))&&!of.isGhostCell&&({qsh:Kc,Ceh:ad}=this.btl(of,Kc,ad,id));return!0})}else({qsh:Kc,Ceh:ad}=this.btl(ke,Kc,ad,id));ke=Kc;ud=ad;return{returnValue:Object.assign(new fd,{id:tb.id.toString(),mk:Object.assign(new Cd,{sId:tb.sid,cId:tb.cid}),drawingElems:id,isSlideCritiqueReady:tb.isSlideCritiqueReady,sourceTimestamp:Date.now()}),qsh:ke,Ceh:ud}}btl(tb,Kc,ad,id){const ud=[];let ke=0;var of=this.Pb.Hc(tb);
for(of=this.un.oca(of,of.currentNode);of.moveNext();){var Yf=of.currentNode;Yf&&this.Cj.me(Yf)&&Yf.Ra(Ng.a.tq)&&(Yf=this.KKm(Yf))&&(Yf.pfRuns&&0<Yf.pfRuns.length&&Yf.pfRuns[0].pf.proofingDirty&&ke++,Array.add(ud,Yf))}0<ud.length&&(Kc+=ud.length,ad+=ke,tb=Object.assign(new fc,{id:tb.id.toString(),mk:this.IKm(tb),text:Object.assign(new Jd,{paragraphs:ud})}),Array.add(id,tb));return{qsh:Kc,Ceh:ad}}IKm(tb){if(!tb)return null;var Kc="";let ad=0,id=0;if(Object(Lg.a)(502,tb))Kc=Object(w.a)(502,tb),id=3,
Kc=Kc.cellId.toString();else if(Object(Lg.a)(426,tb))if(tb=Object(w.a)(426,tb),Kc=tb.get_shapeId().toString(),ad=tb.get_cid(),tb.Lca)id=1;else if(tb.rg)id=2;else if(tb.Uq||tb.pl)id=4;return Object.assign(new Ec,{id:Kc,cId:ad,type:id})}KKm(tb){if(!tb)return null;tb=Object(w.a)(Yg.AParagraphNode,tb);if(!tb)return null;var Kc=tb.oa(ji.a.nS,!1);Kc=Object.assign(new Ya,{id:tb.id.toString(),chars:Kc?"":this.Cj.text(tb)});const ad=this.JKm(tb);ad&&0<ad.length&&(Kc.pfRuns=ad);(tb=this.HKm(tb))&&0<tb.length&&
(Kc.cfRuns=tb);return Kc}JKm(tb){const Kc=[],ad=Object(w.a)(Pg.a,this.T5d.CId(tb));let id=16,ud="",ke=0,of=0;if(ad&&this.S5d){const Yf=this.sB.Hsa(ad);if(Yf)if(id=Yf.listType,1===id)ud=this.ZGe.gBb(ad);else if(0===id){ke=ad.oa(ji.a.autonumberBulletType,8);const If=Object(w.a)(1478,this.ZGe);If&&(of=If.hvl(Yf,ad))}}tb=Object.assign(new rc,{pf:Object.assign(new Ub,{lvl:this.Cj.P1b(tb),proofingDirty:!tb.oa(ig.a.Ica,!1),revisionId:tb.oa(ig.a.$9c,0).toString(),listType:id,listTag:ud,listNumeration:ke,
listElementIndex:of})});Array.add(Kc,tb);return Kc}HKm(tb){const Kc=[];let ad=this.ZPm(tb);if(0<ad.count){ad=this.Ytm(this.dmg.a8c(tb),ad);for(const id of ad)tb=id.end-id.start,Array.add(Kc,Object.assign(new Eb,{len:tb,cf:Object.assign(new cb,{lang:id.lcid,noProof:id.noProof})}))}return Kc}ZPm(tb){const Kc=new u.a,ad=tb.characterData;let id=-1,ud=-1,ke=0;for(let of=0;of<tb.Za.length;of++){const Yf=tb.Za.ha(of).formatting;Yf&&(ud=df.a.language(Yf),-1!==id&&id!==ud&&(Kc.add(Object.assign(new Ca,{start:ke,
end:tb.Za.ha(of).cp,lcid:id,noProof:!1})),ke=tb.Za.ha(of).cp),id=ud)}Kc.add(Object.assign(new Ca,{start:ke,end:ad.length,lcid:ud,noProof:!1}));return Kc}Ytm(tb,Kc){if(!tb)return Kc;for(const ad of tb){tb=!1;for(let id=0;id<Kc.count;id++){if(!tb)if(Kc.ha(id).start===ad.begin)tb=!0,Kc.ha(id).noProof=!0;else if(ad.begin>Kc.ha(id).start&&ad.begin<Kc.ha(id).end){Kc.insert(id+1,Object.assign(new Ca,{start:ad.begin,end:Kc.ha(id).end,lcid:Kc.ha(id).lcid,noProof:!0}));tb=!0;Kc.ha(id).end=ad.begin;continue}if(tb)if(ad.end>
Kc.ha(id).end)Kc.ha(id).noProof=!0;else{if(ad.end===Kc.ha(id).end){Kc.ha(id).noProof=!0;break}if(ad.end<Kc.ha(id).end){Kc.insert(id+1,Object.assign(new Ca,{start:ad.end,end:Kc.ha(id).end,lcid:Kc.ha(id).lcid,noProof:!1}));Kc.ha(id).end=ad.end;Kc.ha(id).noProof=!0;break}}}}return Kc}}Object(c.a)(Me,"SlideTextTileManager",null,[1416,1479]);var lf=a(699);class yf extends Ye{constructor(tb,Kc,ad,id,ud,ke,of,Yf,If,Jf,Th,yh){super(Kc&125,ad,id,Th);this.kd=tb;this.tAa=ud;this.ren=ke;this.lta=of.Sd(12);this.HP=
of.Sd(10);this.B1=Yf;this.va=If;this.$7d=Jf;this.Ooh=of.Sd(22);this.Aa=yh}Jz(){this.Aa.Yja||4!==(this.pV&4)||(this.kd.Fea(Object(ba.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.$7d.Sqm(this.ZRl),this.gJa[Object(Ae.a)(pf,4)]=this.tAa.mCm());16===(this.pV&16)&&(this.lta.h9a(Object(ba.a)(this,this.ZBb,"onBeforeParagraphDisconnect")),this.gJa[Object(Ae.a)(pf,16)]=this.tAa.pCm());1===(this.pV&1)&&(this.lta.Am(Object(ba.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),
this.gJa[Object(Ae.a)(pf,1)]=this.tAa.qCm());8===(this.pV&8)&&(this.HP.fG(Object(ba.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.gJa[Object(Ae.a)(pf,8)]=this.tAa.rCm());64===(this.pV&64)&&(this.Ooh.h9a(Object(ba.a)(this,this.lPl,"onBeforeNumberListDicsonnect")),this.gJa[Object(Ae.a)(pf,64)]=this.tAa.nCm());32===(this.pV&32)&&(this.Ooh.Am(Object(ba.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged")),this.gJa[Object(Ae.a)(pf,32)]=this.tAa.oCm())}xFa(){this.Aa.Yja||
this.kd.b6a(Object(ba.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.lta.Pq(Object(ba.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.lta.zbb(Object(ba.a)(this,this.ZBb,"onBeforeParagraphDisconnect"));this.$7d.yGn(this.ZRl);this.Ooh.zbb(Object(ba.a)(this,this.lPl,"onBeforeNumberListDicsonnect"));this.Ooh.Pq(Object(ba.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"))}lPl(tb,Kc){this.aAb(Kc,64)}onNumberListPropertyChanged(tb,Kc){this.aAb(Kc,
32)}fireTileEvents(){try{We.a.forEach(this.iNb,tb=>{this.Gxf(Object(w.a)(eg,this.iNb[tb]));delete this.iNb[tb]},null)}catch(tb){za.a.J(508944718,306,10,"Exception thrown at FireTileEvents: "+tb)}}Gxf(tb){if(tb&&this.va.Ga&&tb.graphNode&&this.va.Ga.id===tb.graphNode.id){var Kc=Date.now(),ad=this.ren.JAe(tb.graphNode,ne[tb.b$c]);if(ad){Object(mb.a)("PPTOAugLoopProofingTelemetry")&&za.a.J(508944719,375,20,"ALv1: submitting proofing operation");this.B1.execute(ud=>{ud.submit(lf.a.Yed,ad)});const id=tb.XQk;
this.WOl(id,Kc);za.a.J(508944717,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, TileSize: {2}, TileId: {3}, {4}",ne[tb.b$c],tb.Y_c,n.c(ad).length,ad.Id,this.htl(id))}}}}Object(c.a)(yf,"SlideTextTileTriggerController",Ye,[]);var ff=a(1232),jf=a(1006),Nf=a(867),og=a(278),Tg=a(1231);class Ce extends Ye{constructor(tb,Kc,ad,id,ud,ke,of,Yf,If,Jf,Th,yh){super(Kc&1937,ad,id,Th);this.onRefreshTileAnnotations=(yi,Xi)=>{this.aAb(Xi,512)};this.onSlideReorder=(yi,Xi)=>{this.aAb(Xi,1024)};this.Lab=
tb.Sd(8);this.lta=tb.Sd(12);this.tAa=ud;this.dMl=ke;this.B1=Yf;this.$7d=If;this.Aa=yh;Object(jf.b)()&&(this.eMl=of);this.ata=new Tg.a(Jf,Yf)}Jz(){16===(this.pV&16)&&(this.lta.h9a(Object(ba.a)(this,this.ZBb,"onBeforeParagraphDisconnect")),this.gJa[Object(Ae.a)(pf,16)]=this.tAa.iCm());1===(this.pV&1)&&(this.lta.Am(Object(ba.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.gJa[Object(Ae.a)(pf,1)]=this.tAa.jCm());128===(this.pV&128)&&(this.Lab.gca(Object(ba.a)(this,this.onSlideConnected,
"onSlideConnected")),this.gJa[Object(Ae.a)(pf,128)]=this.tAa.gCm());256===(this.pV&256)&&(this.Lab.R7(Object(ba.a)(this,this.onSlideDisconnected,"onSlideDisconnected")),this.gJa[Object(Ae.a)(pf,256)]=this.tAa.hCm());this.Aa.Yja&&512===(this.pV&512)&&(this.$7d.rqm(this.onRefreshTileAnnotations),this.gJa[Object(Ae.a)(pf,512)]=this.tAa.kCm());this.elh()&&1024===(this.pV&1024)&&(Object(jf.b)()&&this.eMl.Jz(),this.$7d.zqm(this.onSlideReorder),this.gJa[Object(Ae.a)(pf,1024)]=this.tAa.lCm())}xFa(){this.lta.Pq(Object(ba.a)(this,
this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.lta.zbb(Object(ba.a)(this,this.ZBb,"onBeforeParagraphDisconnect"));this.Lab.ida(Object(ba.a)(this,this.onSlideConnected,"onSlideConnected"));this.Lab.Cta(Object(ba.a)(this,this.onSlideDisconnected,"onSlideDisconnected"));this.Aa.Yja&&this.$7d.eGn(this.onRefreshTileAnnotations);this.elh()&&(Object(jf.b)()&&this.eMl.xFa(),this.$7d.mGn(this.onSlideReorder))}onSlideConnected(tb,Kc){this.aAb(Kc,128)}onSlideDisconnected(tb,Kc){this.aAb(Kc,
256)}fireTileEvents(){try{We.a.forEach(this.iNb,tb=>{this.Gxf(Object(w.a)(eg,this.iNb[tb]));delete this.iNb[tb]},null)}catch(tb){za.a.J(512496604,306,10,"Exception thrown at FireTileEvents: "+tb)}}Gxf(tb){if(tb&&tb.graphNode){var Kc=this.dMl.JAe(tb.graphNode,ne[tb.b$c]),ad=null,id=Object(w.a)(32,tb.graphNode);if(id&&!id.wP&&!id.jmb){var ud=(this.Aa.Yja||this.Aa.tAc)&&mb.a("ALSlideTileIdNewFormat")?id.sid.toString()+"#"+id.cid.toString():id.sid.toString()+id.cid.toString();var ke=["session","doc"];
Kc=[Object.assign(new Ob.a,{id:ud,body:Kc,sourceTimestamp:Date.now()})];this.elh()&&"slideReorder"in tb.Y_c?(this.XGn(id,ke,Kc),mb.a("ALUpdateSections")&&this.ata.WCa()):(10===tb.b$c?"slideAdded"in tb.Y_c||(ad=Object.assign(new Gb,{parentPath:ke,items:Kc})):"slideAdded"in tb.Y_c?this.elh()?(id=this.dMl.x8c(id),tb=id[0],id=id[1],ad=Object.assign(new va.a,{parentPath:ke,items:Kc,prevId:tb,nextId:id})):ad=Object.assign(new va.a,{parentPath:ke,items:Kc}):ad=Object.assign(new Mb.a,{parentPath:ke,items:Kc}),
ad&&(mb.a("PPTOAugLoopProofingTelemetry")&&za.a.J(508953108,375,20,"ALv2: submitting operation {0}",ad.H_.T_),this.B1.execute(of=>{of.submitOperation(ad)}),mb.a("ALUpdateSections")&&this.ata.WCa()))}}}XGn(tb,Kc,ad){const id=Object.assign(new Gb,{parentPath:Kc,items:ad}),ud=tb.jck?og.a.Yq(tb.jck.sid,tb.jck.cid).toString():Nf.a;tb=tb.HWj?og.a.Yq(tb.HWj.sid,tb.HWj.cid).toString():Nf.b;const ke=Object.assign(new va.a,{parentPath:Kc,items:ad,prevId:ud,nextId:tb});this.B1.execute(of=>{of.submitOperation(id);
of.submitOperation(ke)})}elh(){return this.Aa.tAc&&mb.a("SlideReorderOnALEnabled")}}Object(c.a)(Ce,"SlideTileTriggerController",Ye,[]);var vf=a(1580),Eg=a(252),hf;(function(tb){tb[tb.Unspecified=0]="Unspecified";tb[tb.Inline=1]="Inline";tb[tb.Floating=2]="Floating"})(hf||(hf={}));var Qh;(function(tb){tb[tb.Undefined=0]="Undefined";tb[tb.Bullet=1]="Bullet";tb[tb.Numbered=2]="Numbered";tb[tb.Lim=3]="Lim";tb[tb.Nil=4]="Nil";tb[tb.Any=5]="Any";tb[tb.NoList=6]="NoList";tb[tb.Invalid=7]="Invalid"})(Qh||
(Qh={}));var hi;(function(tb){tb[tb.DontCare=1]="DontCare";tb[tb.Thin=2]="Thin";tb[tb.ExtraLight=3]="ExtraLight";tb[tb.Light=4]="Light";tb[tb.Normal=5]="Normal";tb[tb.Medium=6]="Medium";tb[tb.SemiBold=7]="SemiBold";tb[tb.Bold=8]="Bold";tb[tb.ExtraBold=9]="ExtraBold";tb[tb.Heavy=10]="Heavy"})(hi||(hi={}));var Vg;(function(tb){tb[tb.NoCaps=0]="NoCaps";tb[tb.SmallCaps=1]="SmallCaps";tb[tb.AllCaps=2]="AllCaps";tb[tb.AllPetiteCaps=3]="AllPetiteCaps";tb[tb.PetiteCaps=4]="PetiteCaps";tb[tb.Unicase=5]="Unicase";
tb[tb.Titling=6]="Titling";tb[tb.Other=7]="Other"})(Vg||(Vg={}));var uh;(function(tb){tb[tb.None=0]="None";tb[tb.Words=1]="Words";tb[tb.SingleLine=2]="SingleLine";tb[tb.DoubleLine=3]="DoubleLine";tb[tb.HeavyLine=4]="HeavyLine";tb[tb.DottedLine=5]="DottedLine";tb[tb.DottedHeavyLine=6]="DottedHeavyLine";tb[tb.DashLine=7]="DashLine";tb[tb.DashHeavyLine=8]="DashHeavyLine";tb[tb.DashLongLine=9]="DashLongLine";tb[tb.DashLongHeavyLine=10]="DashLongHeavyLine";tb[tb.DotDashLine=11]="DotDashLine";tb[tb.DotDashHeavyLine=
12]="DotDashHeavyLine";tb[tb.DotDotDashLine=13]="DotDotDashLine";tb[tb.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";tb[tb.WavyLine=15]="WavyLine";tb[tb.WavyHeavyLine=16]="WavyHeavyLine";tb[tb.WavyDoubleLine=17]="WavyDoubleLine"})(uh||(uh={}));var Eh;(function(tb){tb[tb.Left=0]="Left";tb[tb.Right=1]="Right";tb[tb.Center=2]="Center";tb[tb.Justified=3]="Justified";tb[tb.Other=4]="Other";tb[tb.None=5]="None";tb[tb.JustifyLow=6]="JustifyLow";tb[tb.Distributed=7]="Distributed";tb[tb.ThaiDistributed=8]=
"ThaiDistributed"})(Eh||(Eh={}));var Bh;(function(tb){tb[tb.Image=0]="Image";tb[tb.TextBox=1]="TextBox";tb[tb.Chart=2]="Chart";tb[tb.SmartArt=3]="SmartArt";tb[tb.Drawing=4]="Drawing";tb[tb.EquationObject=5]="EquationObject";tb[tb.Ink=6]="Ink";tb[tb.InkSpace=7]="InkSpace";tb[tb.InkEndOfLine=8]="InkEndOfLine";tb[tb.LineBreak=9]="LineBreak";tb[tb.PageBreak=10]="PageBreak";tb[tb.PageNumbers=11]="PageNumbers";tb[tb.FootnoteEndnote=12]="FootnoteEndnote";tb[tb.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";
tb[tb.Tab=14]="Tab";tb[tb.UnsupportedObject=15]="UnsupportedObject";tb[tb.Other=16]="Other";tb[tb.Person=17]="Person";tb[tb.Date=18]="Date"})(Bh||(Bh={}));var ag;(function(tb){tb[tb.Initial=0]="Initial";tb[tb.FirstLine=1]="FirstLine";tb[tb.Hanging=2]="Hanging"})(ag||(ag={}));class zf{constructor(tb,Kc){this.sB=tb;this.uha=Kc}dUl(tb){const Kc={};try{Kc.listType=this.MPb(tb),Kc.outlineLevel=Cc.ParagraphReader.q8c(tb),Kc.indentation=zf.aQm(this.uha.u$(tb))}catch(ad){za.a.J(509203979,822,50,"Exception message: "+
ad.message)}return Kc}MPb(tb){const Kc=new Eg.GraphIterator;Kc.set(tb);Kc.pc(11);Kc.ug(11);return(tb=this.sB.dv(Kc))?zf.Ozm(tb.listType):Qh.NoList}static Ozm(tb){switch(tb){case 15:return Qh.Any;case 1:return Qh.Bullet;case 42:return Qh.Invalid;case 13:return Qh.Lim;case 14:return Qh.Nil;case 16:return Qh.NoList;case 0:return Qh.Numbered;default:return Qh.Invalid}}static aQm(tb){return 2===tb.unit?Math.floor(vf.a.Ych(tb.value)/20):Math.floor(tb.value/20)}}Object(c.a)(zf,"TextTileFormatter",null,[1417]);
class Df{}Df.VNn="ShapeTextOnActiveSlideDomReady";Df.YNn="ShapeTextOnSelectionFinished";Df.XNn="ShapeTextOnParagraphPropertyChanged";Df.ZNn="ShapeTextOnShapeChildTopologyChanged";Df.WNn="ShapeTextOnParagraphDisconnect";Df.fRn="SlideTextOnActiveSlideDomReady";Df.jRn="SlideTextOnParagraphPropertyChanged";Df.iRn="SlideTextOnParagraphDisconnect";Df.kRn="SlideTextOnShapeChildTopologyChanged";Df.hRn="SlideTextOnNumberListPropertyChanged";Df.gRn="SlideTextOnNumberListDisconnect";Df.aRn="SlideOnParagraphPropertyChanged";
Df.$Qn="SlideOnParagraphDisconnect";Df.YQn="SlideOnConnect";Df.ZQn="SlideOnDisconnect";Df.bRn="SlideOnRefreshTileAnnotations";Df.cRn="SlideOnReorder";Object(c.a)(Df,"DetectStrategyName",null,[]);class $f{constructor(tb){this.TNa=tb}get pV(){return 4}gTa(tb,Kc){const ad=[];if((tb=Object(w.a)(sf.a,tb))&&tb.Ga&&(tb=Object(w.a)(32,tb.Ga))){tb=tb.xj();for(const id of tb)this.TNa.Zlf(id)&&Array.add(ad,id);0<ad.length&&Kc(ad,1)}}}Object(c.a)($f,"ShapeTextOnActiveSlideDomReadyDetectStrategy",null,[1474]);
var Kg=a(453);class ug{constructor(tb,Kc,ad){this.Ia=tb;this.TNa=Kc;this.pa=ad}get pV(){return 16}gTa(tb,Kc){if((tb=Object(w.a)(Kg.a,tb))&&tb.node&&12===tb.node.type&&(tb=this.Ia.ln(tb.node))&&this.TNa.Zlf(tb)){var ad=this.pa.c8();ad&&ad.id===tb.id&&(ad=[],Array.add(ad,tb),Kc(ad,6))}}}Object(c.a)(ug,"ShapeTextOnParagraphDisconnectDetectStrategy",null,[1474]);var rh=a(259),gh=a(607);class Mh{constructor(tb,Kc,ad){this.Ia=tb;this.TNa=Kc;this.pa=ad}get pV(){return 1}gTa(tb,Kc){if((tb=Object(w.a)(gh.a,
tb))&&tb.node&&12===tb.node.type){const id=this.Ia.ln(tb.node);if(id&&this.TNa.Zlf(id)){var ad=this.pa.c8();ad&&ad.id===id.id&&(tb.property===rh.a.listLevel?this.UAe(3,id,Kc):tb.property===Ng.a.tq&&this.UAe(4,id,Kc))}}}UAe(tb,Kc,ad){if(Kc){var id=[];Array.add(id,Kc);ad(id,tb)}}}Object(c.a)(Mh,"ShapeTextOnParagraphPropertyChangedDetectStrategy",null,[1474]);var Rh=a(1179);class Ch{constructor(tb,Kc,ad,id){this.pa=tb;this.TNa=Kc;this.X3a=ad;this.tqg=id}get pV(){return 2}gTa(tb,Kc){const ad=[];if(tb=
Object(w.a)(Rh.a,tb))if(this.tqg&&this.X3a&&this.X3a.iXm(tb.gD),!this.pa.v5())this.tqg&&this.X3a&&this.X3a.qLe();else if(tb.RH&&tb.RH.length){this.tqg&&this.X3a&&this.X3a.qLe();tb=this.pa.ud();for(const id of tb)this.TNa.Zlf(id)&&Array.add(ad,id);0<ad.length&&Kc(ad,2)}}}Object(c.a)(Ch,"ShapeTextOnSelectionFinishedDetectStrategy",null,[1474]);var ih=a(929);class Mi{constructor(tb,Kc){this.pa=tb;this.TNa=Kc}get pV(){return 8}gTa(tb,Kc){const ad=[];if((tb=Object(w.a)(ih.a,tb))&&tb.node&&10===tb.node.type&&
1===tb.MZ&&(tb=Object(w.a)(426,tb.node))&&this.TNa.Zlf(tb)){var id=this.pa.c8();id&&id.get_shapeId()===tb.get_shapeId()&&(Array.add(ad,tb),Kc(ad,5))}}}Object(c.a)(Mi,"ShapeTextOnShapeChildTopologyChangedDetectStrategy",null,[1474]);class Oi{constructor(tb){this.kGl=tb}get pV(){return 1===this.kGl?128:256}gTa(tb,Kc){if((tb=Object(w.a)(Kg.a,tb))&&tb.node&&8===tb.node.type){const ad=[];Array.add(ad,tb.node);1===this.kGl?Kc(ad,9):Kc(ad,10)}}}Object(c.a)(Oi,"SlideOnConnectOrDisconnectDetectStrategy",null,
[1474]);class Ti{constructor(tb){this.nc=tb}get pV(){return 16}gTa(tb,Kc){if((tb=Object(w.a)(Kg.a,tb))&&tb.node&&12===tb.node.type){const ad=this.nc.Cg(tb.node);ad&&(tb=[],Array.add(tb,ad),Kc(tb,6))}}}Object(c.a)(Ti,"SlideOnParagraphDisconnectDetectStrategy",null,[1474]);class xi{constructor(tb){this.nc=tb}get pV(){return 1}gTa(tb,Kc){var ad=Object(w.a)(gh.a,tb);if(ad&&ad.node&&12===ad.node.type){const id=this.nc.Cg(ad.node);id&&Object(w.a)(Yg.AParagraphNode,ad.node)&&(tb=0,ad.property===rh.a.listLevel?
tb=3:ad.property===Ng.a.tq&&(tb=4),ad=[],Array.add(ad,id),Kc(ad,tb))}}}Object(c.a)(xi,"SlideOnParagraphPropertyChangedDetectStrategy",null,[1474]);class uj{get pV(){return 4}gTa(tb,Kc){if((tb=Object(w.a)(sf.a,tb))&&tb.Ga&&(tb=Object(w.a)(32,tb.Ga))){var ad=tb.xj();for(var id of ad)if(id.hasText){id=[];Array.add(id,tb);Kc(id,1);break}}}}Object(c.a)(uj,"SlideTextOnActiveSlideDomReadyDetectStrategy",null,[1474]);class Ma{constructor(tb,Kc){this.nc=tb;this.va=Kc}get pV(){return 64}gTa(tb,Kc){if((tb=Object(w.a)(Kg.a,
tb))&&this.va.Ga&&tb.node&&22===tb.node.type&&(tb=this.nc.Cg(tb.node))&&tb.id===this.va.Ga.id){const ad=[];Array.add(ad,tb);Kc(ad,7)}}}Object(c.a)(Ma,"SlideTextOnNumberListDisconnectDetectStrategy",null,[1474]);class jc{constructor(tb,Kc){this.nc=tb;this.va=Kc}get pV(){return 32}gTa(tb,Kc){var ad=Object(w.a)(gh.a,tb);ad&&ad.node&&22===ad.node.type&&(tb=this.nc.Cg(ad.node))&&this.va.Ga&&tb.id===this.va.Ga.id&&ad.property===Ng.a.Rg&&(ad=[],Array.add(ad,tb),Kc(ad,8))}}Object(c.a)(jc,"SlideTextOnNumberListPropertyChangedDetectStrategy",
null,[1474]);class Lc{constructor(tb,Kc,ad,id){this.va=tb;this.gq=Kc;this.nc=ad;this.WYb=id}get pV(){return 16}gTa(tb,Kc){if((tb=Object(w.a)(Kg.a,tb))&&tb.node&&this.va.Ga&&12===tb.node.type){const ad=this.nc.Cg(tb.node);!ad||ad.id!==this.va.Ga.id||this.gq.K$(tb.node)&&!this.WYb||(tb=[],Array.add(tb,this.va.Ga),Kc(tb,6))}}}Object(c.a)(Lc,"SlideTextOnParagraphDisconnectDetectStrategy",null,[1474]);class gd{constructor(tb,Kc,ad,id,ud,ke,of,Yf){this.va=tb;this.gq=Kc;this.nc=ad;this.Ia=id;this.WYb=ud;
this.X3a=of;this.tqg=Yf}get pV(){return 1}gTa(tb,Kc){if((tb=Object(w.a)(gh.a,tb))&&tb.node&&this.va.Ga&&12===tb.node.type){var ad=this.nc.Cg(tb.node);if(ad&&ad.id===this.va.Ga.id&&(ad=Object(w.a)(Yg.AParagraphNode,tb.node))&&(!this.gq.K$(ad)||this.WYb)){var id=this.Ia.ln(ad);id.Vsa||id.Uq||id.rg||id.Zc||!id.pl||!this.tqg||(this.X3a.settings.gbk=!0,this.X3a.NVn(ad));tb.property===rh.a.listLevel?this.UAe(3,this.va.Ga,Kc):tb.property===Ng.a.tq?this.UAe(4,this.va.Ga,Kc):tb.property===ig.a.Ica&&(ad.oa(ig.a.Ica,
!1)||this.UAe(4,this.va.Ga,Kc))}}}UAe(tb,Kc,ad){if(Kc){var id=[];Array.add(id,Kc);ad(id,tb)}}}Object(c.a)(gd,"SlideTextOnParagraphPropertyChangedDetectStrategy",null,[1474]);class Md{constructor(tb,Kc){this.va=tb;this.nc=Kc}get pV(){return 8}gTa(tb,Kc){tb=Object(w.a)(ih.a,tb);this.va.Ga&&tb&&tb.node&&10===tb.node.type&&1===tb.MZ&&(tb=Object(w.a)(426,tb.node))&&(tb=this.nc.Cg(tb))&&tb.id===this.va.Ga.id&&(tb=[],Array.add(tb,this.va.Ga),Kc(tb,5))}}Object(c.a)(Md,"SlideTextOnShapeChildTopologyChangedDetectStrategy",
null,[1474]);class Kd{get pV(){return 512}gTa(tb,Kc){if(tb&&tb.Ga&&(tb=tb.Ga)){var ad=tb.xj();ad&&ad.some(id=>this.u7m(id))&&Kc([tb],11)}}u7m(tb){if(!tb||!tb.hasText)return!1;switch(tb.placeholderType){case 0:case 2:case 3:case 15:case 1:return!0;case 8:return!tb.B5;default:return!1}}}Object(c.a)(Kd,"SlideOnRefreshTileAnnotationsDetectStrategy",null,[1474]);class ye{get pV(){return 1024}gTa(tb,Kc){if(tb&&tb.cVj){var ad=tb.cVj;ad?(ad.jck=tb.GVl,ad.HWj=tb.p$d,Kc([ad],12)):za.a.J(508851910,306,15,"Got null slide node for slide reorder strategy")}else za.a.J(508851911,
306,15,"Slide reorder strategy got blank args")}}Object(c.a)(ye,"SlideOnReorderDetectStrategy",null,[1474]);class Se{constructor(tb,Kc,ad,id,ud,ke,of,Yf,If){this.nc=tb;this.Ia=Kc;this.ob=ad;this.TNa=id;this.va=ud;this.gq=ke;this.Aa=of;this.LA=Yf;this.X3a=If}BOm(tb){if(F.a.rb(tb))return 0;let Kc=0;for(const ad of tb)Kc|=this.THn(ad);return Kc}DOm(tb){if(F.a.rb(tb))return 0;let Kc=0;for(const ad of tb)Kc|=this.VHn(ad);return Kc}COm(tb){if(F.a.rb(tb))return 0;let Kc=0;for(const ad of tb)Kc|=this.UHn(ad);
return Kc}ZBm(){return new Mh(this.Ia,this.TNa,this.ob)}$Bm(){return new Ch(this.ob,this.TNa,this.X3a,this.Aa.CSc)}XBm(){return new $f(this.TNa)}aCm(){return new Mi(this.ob,this.TNa)}YBm(){return new ug(this.Ia,this.TNa,this.ob)}mCm(){return new uj}pCm(){return new Lc(this.va,this.gq,this.nc,this.Aa.Qcd)}qCm(){return new gd(this.va,this.gq,this.nc,this.Ia,this.Aa.Qcd,this.LA,this.X3a,this.Aa.CSc)}rCm(){return new Md(this.va,this.nc)}oCm(){return new jc(this.nc,this.va)}nCm(){return new Ma(this.nc,
this.va)}iCm(){return new Ti(this.nc)}jCm(){return new xi(this.nc)}hCm(){return new Oi(2)}gCm(){return new Oi(1)}kCm(){return new Kd}lCm(){return new ye}THn(tb){return tb===Df.XNn?1:tb===Df.YNn?2:tb===Df.VNn?4:tb===Df.ZNn?8:tb===Df.WNn?16:0}VHn(tb){return tb===Df.fRn?4:tb===Df.iRn?16:tb===Df.jRn?1:tb===Df.kRn?8:tb===Df.hRn?32:tb===Df.gRn?64:0}UHn(tb){return tb===Df.$Qn?16:tb===Df.aRn?1:tb===Df.YQn?128:tb===Df.ZQn?256:tb===Df.bRn?512:tb===Df.cRn?1024:0}}Object(c.a)(Se,"TilingFactory",null,[1418]);
class Pe extends Sys.EventArgs{constructor(tb){super();this.Ga=tb}}Object(c.a)(Pe,"TilingModuleLoadEventArgs",Sys.EventArgs,[]);var Qf=a(284);class sg{constructor(){this.$=null;this.SOj=this.CBj=!1}get name(){return"PowerPointWebEditor.ContentUpdateDetection"}lc(tb){this.$=tb;tb.register(1415,"PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager").ma().na(()=>new Ef(tb.resolve("Box4.Graph.IGraphIteratorFactory"),tb.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),tb.resolve("PowerPointWebEditor.IShapeReader"),
tb.resolve("Box4.IParagraphReader")));tb.register(1416,"PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager").ma().na(()=>new Me(tb.resolve("Box4.IParagraphReader"),tb.resolve("PowerPointWebEditor.Graph.INotesReader"),tb.resolve("Box4.Proofing.IProofingTextUtility"),tb.resolve("Box4.Graph.IGraphIteratorFactory"),tb.resolve("Box4.ITableNavigator"),tb.resolve("PowerPointWebEditor.Graph.ITableReader"),tb.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),tb.resolve("Box4.IListMarkerUtility"),
tb.resolve("PowerPointWebEditor.IPPTParagraphReader"),tb.resolve("Box4.List.IListReader"),tb.resolve("PowerPointWebEditor.IApplicationSettings").Qcd,tb.resolve("PowerPointWebEditor.IApplicationSettings").obb));tb.register(1417,"PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter").ma().na(()=>new zf(tb.resolve("Box4.List.IListReader"),tb.resolve("Box4.IParagraphIndentationReader")));tb.register(ff.a,"PowerPointWebEditor.ContentUpdateDetection.SlideTileManager").ma().na(()=>new ff.a(tb.resolve("Box4.Graph.IGraphIteratorFactory"),
tb.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),tb.resolve("PowerPointWebEditor.IApplicationSettings"),tb.resolve("Box4.IParagraphReader"),tb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter"),tb.resolve("PowerPointWebEditor.IPresentationReader")));Object(jf.b)()&&tb.register(jf.a,"PowerPointWebEditor.ContentUpdateDetection.SlideTileOrderTracker").ma().na(()=>new jf.a(tb.resolve("PowerPointWebEditor.IPresentationReader"),tb.resolve("Box4.Graph.IGraphInstance"),tb.Na("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier")));
tb.register(1418,"PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").ma().na(()=>new Se(tb.resolve("PowerPointWebEditor.ISlideReader"),tb.resolve("PowerPointWebEditor.IShapeReader"),tb.resolve("PowerPointWebEditor.IPptSelectionManager"),tb.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),tb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),tb.resolve("PowerPointWebEditor.Graph.INotesReader"),tb.resolve("PowerPointWebEditor.IApplicationSettings"),tb.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
tb.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));tb.register(Yd,"PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").ma().na(()=>new Yd(tb.resolve("Box4.Graph.IGraphInstance"),tb.resolve("PowerPointWebEditor.IPptSelectionManager"),tb.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),tb.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),tb.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),tb.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),
tb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").BOm(tb.resolve("PowerPointWebEditor.IApplicationSettings").Hcd),tb.resolve("Common.ITaskManager"),tb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),tb.resolve("PowerPointWebEditor.IApplicationSettings").EJe,tb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),tb.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),tb.resolve("PowerPointWebEditor.IApplicationSettings").bVc));tb.register(yf,"PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").ma().na(()=>
new yf(tb.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),tb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").DOm(tb.resolve("PowerPointWebEditor.IApplicationSettings").Hcd),tb.resolve("Common.ITaskManager"),tb.resolve("PowerPointWebEditor.IApplicationSettings").Ree,tb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),tb.resolve("PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager"),tb.resolve("Box4.Graph.IGraphInstance"),tb.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
tb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),tb.resolve("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers"),tb.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),tb.resolve("PowerPointWebEditor.IApplicationSettings")));tb.register(Ce,"PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").ma().na(()=>new Ce(tb.resolve("Box4.Graph.IGraphInstance"),tb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").COm(tb.resolve("PowerPointWebEditor.IApplicationSettings").Hcd),
tb.resolve("Common.ITaskManager"),tb.resolve("PowerPointWebEditor.IApplicationSettings").Ree,tb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),tb.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileManager"),Object(jf.b)()?tb.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileOrderTracker"):null,tb.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),tb.resolve("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers"),tb.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),
tb.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),tb.resolve("PowerPointWebEditor.IApplicationSettings")))}lrl(){return mb.a("AL.SendSlideTile")}init(){const tb=this.$.resolve("Common.IAppSettingsManager");tb.fg(()=>{this.CBj=tb.getBooleanAppSetting(Qf.a.zJe);this.SOj=tb.getBooleanAppSetting(Qf.a.pbb)||tb.getBooleanAppSetting(Qf.a.C8);this.CBj&&(tb.getBooleanAppSetting(Qf.a.aSc)&&this.$.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").initialize(),(this.SOj||
this.$.resolve("PowerPointWebEditor.IApplicationSettings").Ecd)&&this.$.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").initialize(),this.lrl()&&this.$.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize());this.$.Na("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier").execute(Kc=>Kc.ACn(new Pe(this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ga)))})}dispose(){this.CBj&&(this.$.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Qf.a.aSc)&&
this.$.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").dispose(),(this.SOj||this.$.resolve("PowerPointWebEditor.IApplicationSettings").Ecd)&&this.$.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").dispose(),this.lrl()&&(mb.a("PPTOnline.BugFix-7758356")?this.$.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").dispose():this.$.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize()))}static main(){h.a.instance.Fc(new sg)}}
Object(c.a)(sg,"PPTWebEditorContentUpdateDetectionPackage",null,[3,4]);var Bf=a(1233),Wf=a(1028),Xf=a(55),Xa=a(341),T=a(697),Ba=a(317),kb=a(267);class Ab{constructor(tb,Kc,ad,id,ud,ke,of,Yf){this.type="EditorPaneProps";this.critiqueCountInclusiveness=this.critiqueCountClarity=this.critiqueCountConciseness=this.critiqueCountVocabulary=this.critiqueCountPunctuationConvention=this.critiqueCountFormality=this.critiqueCountGrammar=this.critiqueCountSpelling=null;this.critiqueCountSpelling=tb;this.critiqueCountGrammar=
Kc;this.critiqueCountFormality=ad;this.critiqueCountPunctuationConvention=id;this.critiqueCountVocabulary=ud;this.critiqueCountConciseness=ke;this.critiqueCountClarity=of;this.critiqueCountInclusiveness=Yf}}Object(c.a)(Ab,"EditorPaneProps",null,[]);class ic{constructor(tb,Kc,ad,id,ud,ke,of,Yf,If,Jf,Th,yh,yi,Xi,Fh){this.mc=!1;this.J$h=320;this.BZb=!1;this.wxb={};if(!tb)throw Error.argumentNull("pptSelectionManager");if(!Kc)throw Error.argumentNull("appFrame");if(!ad)throw Error.argumentNull("actionManager");
if(!id)throw Error.argumentNull("focusManager");if(!ud)throw Error.argumentNull("editorPane");if(!of)throw Error.argumentNull("graphOperationEventHandler");if(!Yf)throw Error.argumentNull("viewElementEventHandlers");if(!If)throw Error.argumentNull("viewEventSource");if(!Jf)throw Error.argumentNull("pageView");if(!yh)throw Error.argumentNull("workspace");if(!yi)throw Error.argumentNull("loadScript");if(!Fh)throw Error.argumentNull("graphTopologyManager");yi("powerpoint-editor-intl").then(()=>{this.BZb=
!0}).catch(Gi=>{za.a.J(512267606,801,10,"Failed to load powerpoint-editor-intl "+Gi.toString())});this.Db=Kc;this.ia=ad;this.W0f=Xi;this.Ma=id;this.ih=of;this.kd=Yf;this.Ad=If;this.B1=Th;this.va=Fh;this.ih.aS(this.cPc.bind(this));this.ih.KHa(this.cPc.bind(this));this.Ad.JXa(this.cPc.bind(this));this.kd.zDa(this.cPc.bind(this));this.Db.PM(this.Av.bind(this));this.initialize()}initialize(){this.B1.execute(tb=>{tb.addEventHandler(T.a.P5c,this.iWm.bind(this))})}dispose(){this.ih.Dia(this.cPc.bind(this));
this.ih.c6a(this.cPc.bind(this));this.Ad.Bub(this.cPc.bind(this));this.kd.Dbb(this.cPc.bind(this));this.Db.R3(this.cPc.bind(this))}Hb(){this.ia.sa(be.a.HYc,Od.a.application,this.HYc.bind(this),4);this.ia.sa(be.a.SKe,Od.a.application,this.SKe.bind(this),96)}ve(){}cPc(){this.mc&&this.Rn(!0)}Av(tb){1===tb.mode&&this.mc&&(this.mc=!1,this.Tw(),this.Ma.lm(kb.a.rca,this.mc))}SKe(tb,Kc,ad,id,ud){(tb=Object(w.a)(Ba.a,ud))&&tb.xg(this.mc);return 32}HYc(tb,Kc,ad){return this.BZb?1===ad?32:2===ad?(this.mc=!this.mc,
Xa.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.mc.toString(),tb,()=>{this.mc?this.Rn():this.Tw();return 32})):8:8}Rn(tb=!1){const Kc=this.ML(),ad=Object.assign(new Wf.a,{title:"Editor Pane",hideHeader:!1,width:this.J$h,location:2,contentProps:Kc,onOpen:()=>{},onClose:()=>{this.mc=!1},isModernPane:!0});Xf.a.Py().then(id=>{tb?id.updateTaskPane(kb.a.rca,ad):id.showTaskPane(kb.a.rca,ad);return null}).catch(id=>{za.a.J(512267605,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+
id.toString())})}Tw(){Xf.a.Py().then(tb=>{tb.hideTaskPane(kb.a.rca,2);return null}).catch(tb=>{za.a.J(512267604,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+tb.toString())})}ML(){let tb=0,Kc=0,ad=0,id=0,ud=0,ke=0,of=0,Yf=0;const If=this.va.Ga?this.va.Ga.cid:void 0;If&&this.wxb[If]&&Object.keys(this.wxb[If]).forEach(Jf=>{this.wxb[If][Jf].forEach(Th=>{switch(Th.CategoryTitle){case "Spelling":tb+=1;break;case "Grammar":Kc+=1;break;case "Conciseness":ke+=1;break;case "Formality":ad+=
1;break;case "PunctuationConventions":id+=1;break;case "Clarity":of+=1;break;case "Inclusiveness":Yf+=1;break;case "Vocabulary":ud+=1;break;default:za.a.J(509727769,822,50,"Unknown Critique Type: "+Th.CategoryTitle)}})});return new Ab(tb,Kc,ad,id,ud,ke,of,Yf)}wXn(tb,Kc){const ad={};Object.keys(tb).forEach(id=>{this.wxb[Kc]?(Object.keys(this.wxb[Kc]).includes(id),this.wxb[Kc][id]=tb[id]):(ad[id]=tb[id],this.wxb[Kc]=ad)})}iWm(tb,Kc,ad,id){Kc&&id&&(tb=JSON.parse(Kc.Content),id=this.W0f.Z5c(id.critiques),
Kc=this.va.Ga.cid,null!=id&&0<id.length?this.wXn(this.FMm(id),Kc):0==id.length&&this.wxb[Kc]&&this.WFm(tb.drawingElems,Kc),this.wxb[Kc]&&this.QFn(tb.drawingElems,Kc),this.Rn(!0))}QFn(tb,Kc){const ad=Object.keys(this.wxb[Kc]),id=this.HUm(tb);ad.forEach(ud=>{id.includes(ud)||delete this.wxb[Kc][ud]})}HUm(tb){const Kc=[];tb.forEach(ad=>{0<ad.text.paragraphs.length&&ad.text.paragraphs.forEach(id=>{Kc.push(id.id)})});return Kc}WFm(tb,Kc){tb.forEach(ad=>{0<ad.text.paragraphs.length&&this.gxm(ad.text.paragraphs,
Kc)})}gxm(tb,Kc){tb.forEach(ad=>{this.wxb[Kc][ad.id]&&(ad.pfRuns[0].pf.proofingDirty||""==ad.chars)&&delete this.wxb[Kc][ad.id]})}FMm(tb){const Kc={};if(tb)for(const ad of tb)ad.TileId in Kc?Array.add(Kc[ad.TileId],ad):Kc[ad.TileId]=[ad];return Kc}}Object(c.a)(ic,"DexLitePaneActor",null,[24,743]);class zc{constructor(){this.ua=new Oc.a}Kfk(tb){this.ua.raiseEvent("OnEditorConsistencyCritiqueOnActiveSlide",tb)}Ael(tb){this.ua.addHandler("OnEditorConsistencyCritiqueOnActiveSlide",tb)}}Object(c.a)(zc,
"EditorRuntimeEventSource",null,[1471,1472,1473]);var Fc=a(126),lc=a(264),nd=a(1354),vd=a(254);class od{constructor(tb,Kc){this.paragraph=tb;this.critiqueId=Kc}}Object(c.a)(od,"CritiqueToHighlight",null,[]);class Bd{constructor(tb,Kc,ad,id,ud,ke,of,Yf,If,Jf){this.qBb=tb;this.obn=Kc;this.va=ad;this.UJ=id;this.Mb=ud;this.xH=ke;this.pa=of;this.DCj=Yf;this.Ma=If;this.Zbn=Jf;this.qBb.mJg(this.obn)}kjh(tb){tb.length?(tb=this.lRm(tb),tb.length&&(tb=Object.assign(new nd.a,{action:0,type:2,F$a:tb,JSc:this.qBb.vDc?
this.qBb.vDc.F$a:null}),this.qBb.HMe(tb))):this.uDm()}uDm(){const tb=this.qBb.vDc?this.qBb.vDc.F$a:null,Kc=new nd.a;Kc.action=1;Kc.type=2;Kc.F$a=tb;Kc.JSc=tb;this.qBb.HMe(Kc)}lRm(tb){const Kc=[];if(!this.DCj.isEnabled(2))return Kc;var ad=this.va.Ga;if(ad&&ad.isSlideCritiqueReady){var id=ad.o7a;if(!id.count)return this.Nxj(2),Kc;ad=0;for(const ke of id)if(id=Object(w.a)(Yg.AParagraphNode,ke)){var ud=this.YOi(id);for(const of of ud)ud=Object(w.a)(593,of.Ji),ud.w0&&Array.contains(tb,ud.w0.TraceId)&&
(ad++,ud=new od(id,ud.w0.TraceId),Array.add(Kc,ud))}ad!==tb.length&&this.Zzj(2,ad,tb.length)}else this.yzj(2,ad);return Kc}Z6l(tb){if(!this.DCj.isEnabled(3))return!1;var Kc=this.va.Ga;if(Kc&&Kc.isSlideCritiqueReady){Kc=Kc.o7a;if(!Kc.count)return this.Nxj(3),!1;let ad=0;const id=this.Mb.Fd(15,void 0,()=>{this.qVl()});try{let ud=!1;id.rc(Kc.ha(0));id.sc=vd.a.kfd;for(const ke of Kc){const of=Object(w.a)(Yg.AParagraphNode,ke);if(of){const Yf=new u.a,If=this.YOi(of);for(const Jf of If){const Th=Object(w.a)(593,
Jf.Ji);if(Th.w0&&tb.Ob(Th.w0.TraceId)){const yh=tb.ha(Th.w0.TraceId);let yi;try{yi=Th.w0.Suggestions[yh].Text;const Xi=new Fc.a(Jf,yi);Yf.add(Xi);ud||(Th.d8a(this.xfn(yh)),ud=!0);ad++}catch(Xi){za.a.J(508692554,375,10,"Take suggestion: Parse failed with exception: {0}",Xi)}}}Yf.count&&(Yf.Sc((Jf,Th)=>Th.key.begin-Jf.key.begin),this.dHn(of,Yf))}}ad!==tb.count&&this.Zzj(3,ad,tb.count)}finally{id&&id.dispose()}}else return this.yzj(3,Kc),!1;return!0}xfn(tb){switch(tb){case 0:return vd.a.Pta;case 1:return vd.a.Qta;
case 2:return vd.a.Rta;case 3:return vd.a.uFa;case 4:return vd.a.vFa;default:return 0}}dHn(tb,Kc){for(const ad of Kc)this.xH.replaceTextRange(lc.a.createTextRange(tb,0<ad.key.begin?ad.key.begin:0,ad.key.end),ad.value,!0,!1)}ignoreCritiques(tb,Kc){if(!this.DCj.isEnabled(Kc))return!1;var ad=this.va.Ga;if(ad&&ad.isSlideCritiqueReady){var id=ad.o7a;if(!id.count)return this.Nxj(Kc),!1;this.qVl();ad=!1;let ud=0;for(const ke of id)if(id=Object(w.a)(Yg.AParagraphNode,ke)){id=this.YOi(id);for(const of of id)id=
Object(w.a)(593,of.Ji),id.w0&&Array.contains(tb,id.w0.TraceId)&&(id.nTa=!0,ad||(id.d8a(vd.a.SDe),ad=!0),ud++)}ud!==tb.length&&this.Zzj(Kc,ud,tb.length)}else return this.yzj(Kc,ad),!1;return!0}YOi(tb){return this.UJ.oG(tb,Kc=>{Kc=Object(w.a)(593,Kc.Ji);return!!Kc&&5===Kc.proofingType&&!Kc.nTa})}Nxj(tb){za.a.J(508692553,375,15,"{0}: No slide critique in active slide. Skipping",tb)}Zzj(tb,Kc,ad){za.a.J(508692552,375,15,"{0}: ErrorRange number mismatch. Actual: {1}, expected: {2}",tb,Kc,ad)}yzj(tb,Kc){za.a.J(508692551,
375,15,"{0}: Active slide is null or slide critiques are not ready. Active slide null: {1}",tb,!!Kc)}qVl(){this.pa.Rw();this.pa.Rj();this.Zbn&&this.Ma.gh(kb.a.kh,!0)}}Object(c.a)(Bd,"ConsistencyCheckActor",null,[1419]);var Wd=a(96),ce=a(22),db=a(1186),gc=a(1351),Dc=a(263),Ua=a(1352),Nb=a(1353);class hc extends gc.a{constructor(tb,Kc){super();this.onh=[db.a.wIe,db.a.GVd,db.a.hle,db.a.Wvd];this.va=tb;this.Fcn=Kc;this.aGj=[new Ua.a("InconsistentCritiquesHighlight",null),new Ua.a("InconsistentCritiquesLeftSidebar",
null),new Ua.a("InconsistentCritiquesRightSidebar",null)]}get W8c(){return this.Fcn}get z8i(){return this.aGj}dPf(tb,Kc){tb=Object(Lg.a)(Array,tb)?Array.isArray(tb)?tb:null:null;if(!tb||0<tb.length&&!Object(w.a)(od,tb[0]))return Kc;const ad=new Dc.GraphTransaction(3);try{ad.hd(this.va.presentation);for(const id of tb)Nb.b(id.paragraph),Kc.add(id.paragraph)}finally{ad&&ad.dispose()}return Kc}fQc(tb,Kc){if(this.W8c&&this.qEa&&this.qEa.Ahb&&this.qEa.Ahb.F$a&&2===this.qEa.Ahb.type){var ad=[],id=[];this.bUl(this.qEa.Ahb.F$a,
ad,id);var ud=[];this.bUl(this.qEa.Ahb.JSc,null,ud);Kc=Kc.querySelectorAll("*");for(let ke=0;ke<Kc.length;ke++){let of="",Yf="";const If=Kc[ke];for(let Jf=0;Jf<this.onh.length;Jf++)Wd.a.we(If,this.onh[Jf])&&(Yf=this.onh[Jf],of=Wd.a.we(If,this.onh[Jf]));of.length&&2===this.qEa.Ahb.type&&(0===this.qEa.Ahb.action?Array.contains(id,tb)&&Array.contains(ad,of)?this.SYm(If,Yf):this.euh(If):1===this.qEa.Ahb.action&&Array.contains(ud,tb)&&this.euh(If))}}}SYm(tb,Kc){ce.a.e3(tb,"InconsistentCritiquesHighlight");
switch(Kc){case db.a.GVd:ce.a.e3(tb,"InconsistentCritiquesLeftSidebar");break;case db.a.hle:ce.a.e3(tb,"InconsistentCritiquesRightSidebar");break;case db.a.Wvd:ce.a.e3(tb,"InconsistentCritiquesLeftSidebar"),ce.a.e3(tb,"InconsistentCritiquesRightSidebar")}}bUl(tb,Kc,ad){if(tb)for(const id of tb)Array.add(ad,id.paragraph),Kc&&Array.add(Kc,id.critiqueId)}}Object(c.a)(hc,"CritiquesHighlightActor",gc.a,[]);class Qc{}Object(c.a)(Qc,"Critique",null,[]);class $c{}Object(c.a)($c,"Suggestion",null,[]);class Hd{Fll(tb,
Kc){if(!tb)return[];const ad=Array(tb.length);for(let id=0;id<tb.length;id++)ad[id]=Kc(tb[id]);return ad}Hzm(tb){return Object.assign(new Qc,{critiqueId:tb.TraceId,typeId:tb.TypeId,tag:tb.Tag,bucketId:tb.BucketId,paragraphId:tb.TileId,start:tb.Start,length:tb.Length,categoryTitle:tb.CategoryTitle,explanationTitle:tb.ExplanationTitle,explanationLabel:tb.ExplanationLabel,explanation:tb.Explanation,suggestions:this.Fll(tb.Suggestions,Object(ba.a)(this,this.Izm,"convertBox4Suggestion"))})}Izm(tb){return Object.assign(new $c,
{text:tb.Text,description:tb.Description,bucketId:tb.BucketId,numberOfInstances:tb.NumberOfInstances})}}Object(c.a)(Hd,"DataContractMapper",null,[1422]);class $d extends Sys.EventArgs{constructor(tb){super();this.Kp=tb}}Object(c.a)($d,"PaneClosedEventArgs",Sys.EventArgs,[]);var ue=a(389);class Fe{constructor(tb,Kc,ad,id,ud,ke,of,Yf){this.ia=tb;this.Hd=Kc;this.Ad=ad;this.QDj=id;this.oHe=ud;this.HGe=ke;this.rGj=of;this.afn=Yf;this.Mj=0;this.Hd.execute(If=>{If.maf(Object(ba.a)(this,this.k1b,"onPaneClosed"))})}get state(){return this.Mj}Ewh(tb){this.Mj!==
tb&&(this.Mj=tb,this.Ad.WH(new ue.a(1)))}vSl(tb){0===this.state&&(za.a.J(507843105,375,50,"[EditorPane] Begin opening Editor pane, reason: {0} Time: {1}",tb,(new Date).getTime()),this.Ewh(1),tb={},tb.JB=ResourceStrings.L_EditorPaneTitle,tb.assetId=this.oHe.getAssetId(),tb.LU=Object(ba.a)(this,this.eQc,"onPaneRendered"),tb.nonPersistedSettings={},tb.nonPersistedSettings.IdeasEnabled=this.rGj.toString(),tb.V4g=this.afn,32!==this.ia.Qa(be.a.mFa,2,tb)&&(za.a.J(507843104,375,15,"[EditorPane] Failed to open Editor pane"),
this.Ewh(0)))}lca(tb){if(2===this.state){var Kc=this.oHe.nAb();Kc&&(za.a.J(507843103,375,50,"[EditorPane] Begin closing Editor pane, reason: {0}",tb),32!==this.ia.Qa(be.a.JLb,2,Kc)&&za.a.J(507843102,375,15,"[EditorPane] Failed to close Editor pane"))}}k1b(tb,Kc){2===this.state&&Kc&&(tb=Kc.Kp)&&tb.length&&(Kc=this.oHe.nAb(),Kc!==tb&&Kc||(za.a.J(507843101,375,50,"[EditorPane] Pane closed"),this.QDj.oCn(new $d(tb)),this.Ewh(0),this.HGe.sessionEnd()))}eQc(){const tb=this.oHe.nAb();1!==this.state?za.a.J(507843100,
375,15,"[EditorPaneActor] Received pane rendered event even though we weren't in opening state. Instance id={0}",tb):(za.a.J(507843099,375,50,"[EditorPane] Pane rendered. Instance id={0}",tb),this.Ewh(2),this.HGe.MKn())}}Object(c.a)(Fe,"EditorPane",null,[1424]);class cf{constructor(tb,Kc){this.type=0;this.id=null;this.type=tb;this.id=Kc}static Wse(tb){return tb.id&&tb.id.toString().length&&Object(Lg.a)(Number,tb.type)?new cf(tb.type,tb.id.toString()):null}}Object(c.a)(cf,"Message",null,[]);var Ee=
a(46);class xe{constructor(tb,Kc,ad,id,ud,ke,of,Yf,If,Jf,Th,yh,yi,Xi,Fh,Gi){this.FAi=new Bf.a;this.ia=tb;this.Goa=Kc;this.vGe=ad;this.THl=id;this.i2a=ud;this.PKl=ke;this.dta=of;this.QDj=Yf;this.va=If;this.$Yb=Jf;this.m7d=Th;this.zi=yh;this.Ebn=yi;this.Ad=Xi;this.bcn=Fh;this.oc=Gi;this.xfh=new Bf.a(0);this.xfh.add(0,2001);this.xfh.add(1,2002);this.xfh.add(2,2003)}Hb(){this.ia.sa(be.a.DJe,Od.a.application,Object(ba.a)(this,this.opl,"editorPaneButtonClicked"),4);this.ia.sa(be.a.ZKe,Od.a.application,
Object(ba.a)(this,this.nWl,"queryEditorPaneButton"),96);this.ia.sa(be.a.oUl,Od.a.application,Object(ba.a)(this,this.opl,"editorPaneButtonClicked"),4);this.ia.sa(be.a.$Ke,Od.a.application,Object(ba.a)(this,this.nWl,"queryEditorPaneButton"),96);this.ia.sa(be.a.Nsh,Od.a.application,Object(ba.a)(this,this.ppl,"editorPaneExtenal"),4);this.ia.sa(be.a.A8j,Od.a.application,Object(ba.a)(this,this.ppl,"editorPaneExtenal"),4);this.THl.E0h(Object(ba.a)(this,this.Bpn,"onEditorPaneMessageReceived"));this.$Yb.f$b(Object(ba.a)(this,
this.vta,"onSlidePresenceChanged"));this.m7d.Am(Object(ba.a)(this,this.Ypa,"onSlidePropertyChanged"));this.zi.aS(Object(ba.a)(this,this.yR,"onActiveSlideChanged"));this.QDj.Aqm(Object(ba.a)(this,this.k1b,"onPaneClosed"))}ve(){}ppl(tb,Kc,ad){if(1===ad)return 32;switch(tb){case be.a.Nsh:this.Goa.vSl(2);break;case be.a.A8j:this.Goa.lca(2);break;default:return za.a.J(507843589,375,10,"[EditorPaneActor] Unsupported actionId: {0}",tb),16}return 32}opl(tb,Kc,ad){if(1===ad)return this.oc.hl()?32:16;switch(this.Goa.state){case 0:return this.Goa.vSl(1),
32;case 2:return this.Goa.lca(1),32;case 1:return za.a.J(507843588,375,50,"[EditorPaneActor] User double clicked to open pane before it was rendered"),this.Ad.WH(new ue.a(1)),32;default:return za.a.J(507843587,375,10,"[EditorPaneActor] Unsupported EditorPaneState"),16}}nWl(tb,Kc,ad,id,ud){if(!ud||!Object(Lg.a)(Ba.a,ud))return 8;ud.xg(2===this.Goa.state||1===this.Goa.state);return 32}Bpn(tb,Kc){this.Cpn(Kc)}Cpn(tb){const Kc=this.i2a.JDm(tb.message);if(Kc){var ad;({value:ad}=this.PKl.Uh(Kc.type)).returnValue||
(ad=this.PKl.ha(0));var id=ad.process(tb,Kc);id.continueWith(()=>{const ud=id.result,ke=this.i2a.Qpl(ud);this.sendMessage(tb.Kp,ke);this.i$m(tb,Kc,ud)})}else za.a.J(507843586,375,15,"[EditorPaneActor] OnEditorPaneMessageReceived, can't deserialize message."),Ee.Task.rF(!1)}Nfk(tb){this.FAi.Ob(tb)||this.FAi.K(tb,this.bcn.BAe(200,()=>{const Kc=this.vGe.OTm(tb);if(Kc.length){var ad=new cf(this.xfh.ha(tb),Rc.a.create().toString());ad=this.i2a.Qpl(ad);this.iKn(Kc,ad)}this.Ebn.Kfk(tb)}));this.FAi.ha(tb).perform()}iKn(tb,
Kc){for(const ad of tb)this.sendMessage(ad,Kc)}sendMessage(tb,Kc){this.THl.sendMessage(tb,Kc)}i$m(tb,Kc,ad){const id=new Date,ud=+id-+tb.hXl;2E3<=ud&&za.a.J(507843585,375,1E4<=ud?10:15,"[EditorPaneActor] Host was slow to respond to the message receivedInstanceId={0} receivedIsFromEditorPane={1} receivedTimestamp={2} currentTime={3} passedMilliseconds={4} receivedId={5} receivedType={6} responseId={7} responseType={8}",tb.Kp,tb.vjj,tb.hXl.toUTCString(),id.getTime(),ud.toString(),Kc.id,Kc.type,ad.id,
ad.type)}Ypa(tb,Kc){Kc.property===ig.a.isSlideCritiqueReady&&this.Nfk(1)}yR(){this.Nfk(0)}vta(tb,Kc){(tb=this.va.Ga)&&Kc.slideId.equals(tb.Xb)&&this.Nfk(2)}k1b(tb,Kc){this.vGe.SWn(Kc.Kp);this.dta.visualizeCritiques([])}}Object(c.a)(xe,"EditorPaneActor",null,[]);class cg{constructor(){this.ua=new Oc.a}Aqm(tb){this.ua.addHandler("PaneClosed",tb)}oCn(tb){this.ua.raiseEvent("PaneClosed",tb)}}Object(c.a)(cg,"EditorPaneEventSource",null,[1425,1463,1464]);var Gg=a(60);class Of{}Object(c.a)(Of,"Paragraph",
null,[]);var ch=a(178);class vg{constructor(tb,Kc,ad,id,ud,ke,of,Yf,If){this.va=tb;this.UJ=Kc;this.L$c=ad;this.ia=id;this.Ia=ud;this.Gdn=ke;this.aDj=of;this.Cj=Yf;this.Gcn=If}checkProofingDirty(tb){const Kc=tb.includedTags;if(2===tb.critiqueSelection&&1===Kc)return tb=(tb=this.va.Ga)&&tb.isConnected?!tb.isSlideCritiqueReady:!0,this.Lbc(0,!0),tb;this.UFl("CheckProofingDirty");return!0}getCritiques(tb){var Kc=tb.includedTags;if(2===tb.critiqueSelection&&1===Kc){tb=this.va.Ga;if(!tb||!tb.isConnected||
!tb.isSlideCritiqueReady)return null;Kc=tb.o7a;tb=[];for(const ad of Kc)if((Kc=ad)&&Kc.isConnected){Kc=this.UJ.oG(Kc,id=>{id=Object(w.a)(593,id.Ji);return!!id&&5===id.proofingType&&!id.nTa});for(const id of Kc)(Kc=Object(w.a)(593,id.Ji))&&tb.push(Kc.w0)}this.Lbc(1,!0);return this.aDj.Fll(tb,Object(ba.a)(this.aDj,this.aDj.Hzm,"convertBox4Critique"))}this.UFl("GetCritiques");return null}Rvl(tb){var Kc=this.va.Ga;if(!Kc||!Kc.isConnected)return null;const ad=[];tb=vg.Cmn(tb);Kc=Kc.kca;for(const id of tb)(tb=
Object(w.a)(Pg.a,Kc.we(Rc.a.Xf(id))))&&tb.isConnected&&ad.push(Object.assign(new Of,{paragraphId:id,text:this.Cj.LLe(tb,"\n")}));return ad}getSupportedLanguages(tb){return this.Gdn.iul(tb.includedTags).CWR(Kc=>{const ad=[];if(Kc=Object(w.a)(Gg.a,Kc)){Kc=Kc.result;for(const id of Kc)(Kc=kf.a.Ne(id))&&Array.add(ad,Kc.name)}this.Lbc(6,!0);return ad})}getLanguagesOnCurrentSlide(){const tb=[],Kc=[],ad=this.va.Ga;let id=[];ad&&(id=ad.xj());for(const ud of id)this.Ia.VH(ud,ke=>{if(ke&&Object(Lg.a)(Yg.AParagraphNode,
ke)){ke=Object(w.a)(Yg.AParagraphNode,ke);var of=ke.characterData;if(of&&of.length){var Yf=-1,If;for(of=0;of<ke.Za.length;of++)if(If=ke.Za.ha(of).formatting)If=df.a.language(If),Yf===If||Array.contains(tb,If)||(Array.add(tb,If),(Yf=kf.a.Ne(If))&&Array.add(Kc,Yf.name)),Yf=If}}});this.Lbc(7,!0);return Kc}visualizeCritiques(tb){if(!tb)return this.Lbc(2,!1),1;const Kc=Array(tb.length);if(!tb.length)return this.L$c.kjh(Kc),this.Lbc(2,!0),0;for(let ad=0;ad<tb.length;ad++)Kc[ad]=tb[ad].critiqueId;this.L$c.kjh(Kc);
this.Lbc(2,!0);return 0}resolveCritiques(tb){if(!tb||!tb.length)return 1;const Kc=new Bf.a(0);for(const ad of tb)Kc.add(ad.critiqueId,ad.suggestionIndex);tb=this.L$c.Z6l(Kc);this.Lbc(3,tb);return tb?0:1}ignoreCritiques(tb){if(!tb||!tb.length)return 1;const Kc=[];for(const ad of tb)Array.add(Kc,ad.critiqueId);tb=this.L$c.ignoreCritiques(Kc,4);this.Lbc(4,tb);return tb?0:1}openProofingSettingsDialog(){if(this.Gcn){const tb=this.ia.Cb(vd.a.NQc,2);this.Lbc(5,32===tb)}}Lbc(tb,Kc){za.a.J(508692640,375,50,
"{0}: {1}",tb,Kc?0:1)}UFl(tb){za.a.J(508692639,375,15,"{0}: Unsupported CritiqueFilter",tb)}static Cmn(tb){const Kc=new ch.a;for(var ad of tb)Kc.contains(ad.paragraphId)||Kc.add(ad.paragraphId);tb=Array(Kc.count);ad=0;for(const id of Kc)tb[ad++]=id;return tb}}Object(c.a)(vg,"EditorPaneHost",null,[1421]);class jg{}Object(c.a)(jg,"EditorRuntimeNotificationData",null,[]);class sh extends Sys.EventArgs{constructor(){super();this.dtf=this.IRb=null}}Object(c.a)(sh,"EditorRuntimeNotificationEventArgs",Sys.EventArgs,
[]);class Zh{constructor(){this.notificationConfidence=0;this.shouldRaiseNotification=!1;this.confidence=0;this.resultStatus=null}}Object(c.a)(Zh,"InfraredResultBase",null,[]);var ae=a(824),Wi=a(879);class ci{constructor(tb,Kc){this.includedTags=this.critiqueSelection=0;this.critiqueSelection=tb;this.includedTags=Kc}static Mka(tb){return Object(Lg.a)(Number,tb.critiqueSelection)&&Object(Lg.a)(Number,tb.includedTags)?new ci(tb.critiqueSelection,tb.includedTags):null}}Object(c.a)(ci,"CritiqueFilter",
null,[]);class Fi{constructor(tb,Kc,ad,id){this.ia=tb;this.dta=Kc;this.va=ad;this.UHl=id}Kfk(tb){if(this.UHl){var Kc=new ci(2,1),ad=this.dta.checkProofingDirty(Kc),id=ad?[]:this.dta.getCritiques(Kc),ud=ad?[]:this.dta.Rvl(id);Kc=this.TXj();tb=Object.assign(new jg,{isProofingDirty:ad,critiques:id,paragraphs:ud,numberOfCoAuthors:Kc,contextChanged:0===tb});ud=(id=!!id&&0<id.length)?1:0;let ke=ae.a.success;0<Kc?ke=ae.a.wOc:ad?ke=ae.a.pending:id||(ke=ae.a.wOc);ad=Object.assign(new sh,{IRb:Object.assign(new Zh,
{notificationConfidence:ud,shouldRaiseNotification:!1,confidence:1,resultStatus:ke}),dtf:tb});this.UHl.Kfk(ad)}}TXj(){var tb=this.va.Ga;if(!tb||!tb.isConnected)return 0;tb=Object.assign(new Wi.a,{slideId:tb.Xb});this.ia.Qa(be.a.a4b,2,tb);return tb.upe}}Object(c.a)(Fi,"EditorRuntimeEventRaiser",null,[1420]);var hh=a(1224),wf=a(1361);class qg{constructor(tb){this.ncn=tb}MKn(){this.ned(0,0)}sessionEnd(){this.ned(1,0)}dTn(){this.ned(2,4)}eTn(){this.ned(2,3)}ned(tb,Kc){this.ncn.execute(ad=>{const id=Object.assign(new wf.a,
{cardId:hh.a.npl,actionType:tb,actionEngagement:Kc});ad.xrh(id)})}}Object(c.a)(qg,"InfraredTelemetryLogger",null,[1423]);class Lh extends cf{constructor(tb,Kc,ad){super(tb,Kc);this.payload=null;this.payload=ad}}Object(c.a)(Lh,"MessageWithPayload",cf,[]);class dh extends Lh{constructor(tb,Kc,ad){super(tb,Kc,ad)}}Object(c.a)(dh,"CheckProofingDirtyAndGetCritiquesResponse",Lh,[]);class wg extends Lh{constructor(tb,Kc,ad){super(tb,Kc,ad)}}Object(c.a)(wg,"ResponseMessage",Lh,[]);class bg{constructor(tb){this.statusCode=
0;this.logErrorMessage=null;this.statusCode=tb;this.logErrorMessage="";0!==tb&&(this.logErrorMessage=tb.toString())}}Object(c.a)(bg,"Response",null,[]);class vh extends bg{constructor(tb,Kc,ad,id){super(0);this.isProofingDirty=!1;this.languagesOnTheCurrentSlide=this.paragraphs=this.critiques=null;this.isProofingDirty=tb;this.critiques=Kc;this.paragraphs=ad;this.languagesOnTheCurrentSlide=id}}Object(c.a)(vh,"ProofingDirtyAndCritiques",bg,[]);class fi{constructor(tb,Kc,ad){this.va=tb;this.dta=Kc;this.i2a=
ad}process(tb,Kc){var ad=this.i2a.dDm(tb.message);if(!ad)return za.a.J(508692509,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Can't decode message."),tb=new bg(1),Ee.Task.rF(new wg(1003,Kc.id,tb));tb=this.va.Ga;if(!tb||!tb.isConnected)return za.a.J(508692508,375,50,"[CheckProofingDirtyAndGetCritiquesProcessor] Active slide doesn't exist or is not connected"),tb=new vh(!1,[],[],[]),Kc=new dh(1003,Kc.id,tb),Ee.Task.rF(Kc);ad=(tb=this.dta.checkProofingDirty(ad.payload))?[]:this.dta.getCritiques(ad.payload);
if(!ad)return za.a.J(508692507,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] No box4 critiques were returned by host"),tb=new bg(2),Ee.Task.rF(new wg(1003,Kc.id,tb));const id=tb?[]:this.dta.Rvl(ad),ud=tb?[]:this.dta.getLanguagesOnCurrentSlide();if(!ud)return za.a.J(508692506,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Failed to query languages on current slide"),tb=new bg(7),Ee.Task.rF(new wg(1003,Kc.id,tb));tb=new vh(tb,ad,id,ud);Kc=new dh(1003,Kc.id,tb);return Ee.Task.rF(Kc)}}Object(c.a)(fi,
"CheckProofingDirtyAndGetCritiquesProcessor",null,[1461]);class Jg{constructor(tb,Kc,ad){this.dta=tb;this.i2a=Kc;this.HGe=ad}process(tb,Kc){var ad=this.i2a.fDm(tb.message);if(!ad)return za.a.J(37087328,375,15,"[IgnoreProcessor] Can't decode message."),tb=new bg(1),Ee.Task.rF(new wg(1006,Kc.id,tb));ad=this.dta.ignoreCritiques(ad.payload);0===ad&&tb.vjj&&this.HGe.eTn();tb=0===ad?new bg(0):new bg(6);return Ee.Task.rF(new wg(1006,Kc.id,tb))}}Object(c.a)(Jg,"IgnoreProcessor",null,[1461]);class Dg extends Lh{constructor(tb,
Kc,ad){super(tb,Kc,ad)}}Object(c.a)(Dg,"NumberOfCoAuthorsResponse",Lh,[]);class fj extends bg{constructor(tb){super(0);this.numberOfCoAuthors=0;this.numberOfCoAuthors=tb}}Object(c.a)(fj,"NumberOfCoAuthorsModel",bg,[]);class kj{constructor(tb,Kc){this.ia=tb;this.va=Kc}process(tb,Kc){tb=this.TXj();tb=new fj(tb);return Ee.Task.rF(new Dg(1009,Kc.id,tb))}TXj(){var tb=this.va.Ga;if(!tb||!tb.isConnected)return 0;tb=Object.assign(new Wi.a,{slideId:tb.Xb});this.ia.Qa(be.a.a4b,2,tb);return tb.upe}}Object(c.a)(kj,
"NumberOfCoAuthorsProcessor",null,[1461]);class ng{constructor(tb,Kc,ad){this.ia=tb;this.Goa=Kc;this.rGj=ad}process(tb,Kc){if(!this.rGj)return za.a.J(38412446,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Ideas disabled, but we were asked to open Ideas pane"),tb=new bg(10),Ee.Task.rF(new wg(1011,Kc.id,tb));this.Goa.lca(3);tb=this.ia.Cb(be.a.QUg,2);32!==tb&&za.a.J(38412448,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Failed to open Ideas pane");tb=new bg(32!==tb?9:0);return Ee.Task.rF(new wg(1011,
Kc.id,tb))}}Object(c.a)(ng,"OpenIdeasPaneAndCloseEditorPaneProcessor",null,[1461]);class Oh{constructor(tb){this.dta=tb}process(tb,Kc){this.dta.openProofingSettingsDialog();tb=new bg(0);return Ee.Task.rF(new wg(1007,Kc.id,tb))}}Object(c.a)(Oh,"OpenProofingSettingsProcessor",null,[1461]);class Tf{constructor(tb,Kc,ad){this.dta=tb;this.i2a=Kc;this.HGe=ad}process(tb,Kc){var ad=this.i2a.gDm(tb.message);if(!ad)return za.a.J(37087330,375,15,"[ResolveProcessor] Can't decode message."),tb=new bg(1),Ee.Task.rF(new wg(1005,
Kc.id,tb));ad=this.dta.resolveCritiques(ad.payload);0===ad&&tb.vjj&&this.HGe.dTn();tb=0===ad?new bg(0):new bg(5);return Ee.Task.rF(new wg(1005,Kc.id,tb))}}Object(c.a)(Tf,"ResolveProcessor",null,[1461]);class Kh extends Lh{constructor(tb,Kc,ad){super(tb,Kc,ad)}}Object(c.a)(Kh,"SubscriptionResponse",Lh,[]);class wi extends bg{constructor(tb){super(0);this.telemetryCorrelationId=null;this.telemetryCorrelationId=tb}}Object(c.a)(wi,"SubscriptionModel",bg,[]);class Uf{constructor(tb,Kc){this.vGe=tb;this.i2a=
Kc}process(tb,Kc){const ad=this.i2a.hDm(tb.message);if(!ad)return za.a.J(39331169,375,15,"[SubscribeProcessor] Can't decode message."),tb=new bg(1),Ee.Task.rF(new wg(1001,Kc.id,tb));za.a.J(39331171,375,50,"Editor pane telemetry correlation id={0}",ad.payload.telemetryCorrelationId);this.vGe.subscribe(tb.Kp,0);this.vGe.subscribe(tb.Kp,1);this.vGe.subscribe(tb.Kp,2);tb=new wi("not available");return Ee.Task.rF(new Kh(1001,Kc.id,tb))}}Object(c.a)(Uf,"SubscribeProcessor",null,[1461]);class Ci extends Lh{constructor(tb,
Kc,ad){super(tb,Kc,ad)}}Object(c.a)(Ci,"SupportedLanguagesResponse",Lh,[]);class Ai extends bg{constructor(tb){super(0);this.supportedLanguages=null;this.supportedLanguages=tb}}Object(c.a)(Ai,"SupportedLanguagesModel",bg,[]);class Ii{constructor(tb,Kc){this.dta=tb;this.i2a=Kc}process(tb,Kc){tb=this.i2a.iDm(tb.message);if(!tb)return za.a.J(38094432,375,15,"[SupportedLanguagesProcessor] Can't decode message."),tb=new bg(1),Ee.Task.rF(new wg(1010,Kc.id,tb));const ad=this.dta.getSupportedLanguages(tb.payload);
return ad.CWR(()=>{var id=ad.result;if(!id)return za.a.J(38094434,375,15,"[SupportedLanguagesProcessor] Failed to query supported languages"),id=new bg(8),new wg(1010,Kc.id,id);id=new Ai(id);return new Ci(1010,Kc.id,id)})}}Object(c.a)(Ii,"SupportedLanguagesProcessor",null,[1461]);class gj{process(tb,Kc){za.a.J(37025999,375,15,"[UnsupportedMessageProcessor] Unsupported message type: {0}",Kc.type);tb=new bg(3);return Ee.Task.rF(new wg(Kc.type,Kc.id,tb))}}Object(c.a)(gj,"UnsupportedMessageProcessor",
null,[1461]);class Ag{constructor(tb,Kc){this.dta=tb;this.i2a=Kc}process(tb,Kc){tb=this.i2a.jDm(tb.message);if(!tb)return za.a.J(37026001,375,15,"[VisualizeProcessor] Can't decode message."),tb=new bg(1),Ee.Task.rF(new wg(1004,Kc.id,tb));tb=0===this.dta.visualizeCritiques(tb.payload)?new bg(0):new bg(4);return Ee.Task.rF(new wg(1004,Kc.id,tb))}}Object(c.a)(Ag,"VisualizeProcessor",null,[1461]);class Og extends Lh{constructor(tb,Kc,ad){super(tb,Kc,ad)}static Mka(tb){const Kc=cf.Wse(tb);return Kc&&tb.payload?
(tb=ci.Mka(tb.payload))?new Og(Kc.type,Kc.id,tb):null:null}}Object(c.a)(Og,"CheckProofingDirtyAndGetCritiquesMessage",Lh,[]);class aj{constructor(tb){this.uVe=tb}get critiqueId(){return this.uVe}static Mka(tb){return tb.critiqueId&&Object(w.a)(String,tb.critiqueId)?new aj(tb.critiqueId.toString()):null}}Object(c.a)(aj,"CritiqueIgnore",null,[]);class Qj extends Lh{constructor(tb,Kc,ad){super(tb,Kc,ad)}static Mka(tb){const Kc=cf.Wse(tb);if(!Kc||!tb.payload||!Object(Lg.a)(Array,tb.payload))return null;
tb=tb.payload;const ad=Array(tb.length);for(let id=0;id<tb.length;id++){const ud=aj.Mka(tb[id]);if(!ad)return null;ad[id]=ud}return new Qj(Kc.type,Kc.id,ad)}}Object(c.a)(Qj,"IgnoreCritiquesMessage",Lh,[]);class sj{constructor(tb,Kc){this.uVe=tb;this.smm=Kc}get critiqueId(){return this.uVe}get suggestionIndex(){return this.smm}static Mka(tb){return tb.critiqueId&&Object(w.a)(String,tb.critiqueId)&&Object(Lg.a)(Number,tb.suggestionIndex)?new sj(tb.critiqueId.toString(),tb.suggestionIndex):null}}Object(c.a)(sj,
"CritiqueResolution",null,[]);class mi extends Lh{constructor(tb,Kc,ad){super(tb,Kc,ad)}static Mka(tb){const Kc=cf.Wse(tb);if(!Kc||!tb.payload||!Object(Lg.a)(Array,tb.payload))return null;tb=tb.payload;const ad=Array(tb.length);for(let id=0;id<tb.length;id++){const ud=sj.Mka(tb[id]);if(!ad)return null;ad[id]=ud}return new mi(Kc.type,Kc.id,ad)}}Object(c.a)(mi,"ResolveCritiquesMessage",Lh,[]);class Wj{constructor(tb){this.telemetryCorrelationId=null;this.telemetryCorrelationId=tb}static Mka(tb){let Kc=
"unavailable";tb.telemetryCorrelationId&&Object(w.a)(String,tb.telemetryCorrelationId)&&tb.telemetryCorrelationId.toString().length&&50>=tb.telemetryCorrelationId.toString().length&&(Kc=tb.telemetryCorrelationId.toString());return new Wj(Kc)}}Object(c.a)(Wj,"Subscription",null,[]);class Ff extends Lh{constructor(tb,Kc,ad){super(tb,Kc,ad)}static Mka(tb){const Kc=cf.Wse(tb);if(!Kc)return null;tb.payload||(tb.payload={});return(tb=Wj.Mka(tb.payload))?new Ff(Kc.type,Kc.id,tb):null}}Object(c.a)(Ff,"SubscribeMessage",
Lh,[]);class oi extends Lh{constructor(tb,Kc,ad){super(tb,Kc,ad)}static Mka(tb){const Kc=cf.Wse(tb);return Kc&&tb.payload?(tb=ci.Mka(tb.payload))?new oi(Kc.type,Kc.id,tb):null:null}}Object(c.a)(oi,"SupportedLanguagesMessage",Lh,[]);class Fj{constructor(tb){this.uVe=tb}get critiqueId(){return this.uVe}static Mka(tb){return tb.critiqueId&&Object(w.a)(String,tb.critiqueId)&&tb.critiqueId.toString().length?new Fj(tb.critiqueId.toString()):null}}Object(c.a)(Fj,"CritiqueToVisualize",null,[]);class bj extends Lh{constructor(tb,
Kc,ad){super(tb,Kc,ad)}static Mka(tb){const Kc=cf.Wse(tb);if(!Kc||!tb.payload||!Object(Lg.a)(Array,tb.payload))return null;tb=tb.payload;const ad=Array(tb.length);for(let id=0;id<tb.length;id++){const ud=Fj.Mka(tb[id]);if(!ad)return null;ad[id]=ud}return new bj(Kc.type,Kc.id,ad)}}Object(c.a)(bj,"VisualizeCritiquesMessage",Lh,[]);class Hg{JDm(tb){return this.Vse(tb,cf.Wse)}hDm(tb){return this.Vse(tb,Ff.Mka)}dDm(tb){return this.Vse(tb,Og.Mka)}jDm(tb){return this.Vse(tb,bj.Mka)}gDm(tb){return this.Vse(tb,
mi.Mka)}fDm(tb){return this.Vse(tb,Qj.Mka)}iDm(tb){return this.Vse(tb,oi.Mka)}Vse(tb,Kc){try{let ad;return({BD:ad}=n.d(tb)).returnValue?Kc(ad):null}catch(ad){return null}}Qpl(tb){return n.c(tb)}}Object(c.a)(Hg,"MessageEncoder",null,[1429]);var rg=a(33);class Jj extends Sys.EventArgs{constructor(tb,Kc,ad){super();this.Kp=tb;this.message=Kc;this.vjj=ad;this.hXl=new Date}}Object(c.a)(Jj,"MessageReceivedEventArgs",Sys.EventArgs,[]);class uk{constructor(tb,Kc,ad){this.ua=new Oc.a;this.oHe=tb;this.wGl=
Kc;this.hcn=new RegExp(ad,"i")}initialize(){try{if(window.addEventListener)return window.addEventListener("message",Object(ba.a)(this,this.ntg,"messageReceivedHandler"),!1),!0;if(-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent)return window.attachEvent("onmessage",Object(ba.a)(this,this.ntg,"messageReceivedHandler")),!0;za.a.J(507843608,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window")}catch(tb){za.a.J(507843607,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",
tb.message,tb.stack)}return!1}E0h(tb){this.ua.addHandler("MessageReceived",tb)}HYl(tb){this.ua.removeHandler("MessageReceived",tb)}sendMessage(tb,Kc){if(tb&&Kc){var ad={};ad.message=Kc;ad.editorPaneWildCard=".";this.eKn(tb,ad)}}eKn(tb,Kc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(tb,"onCustomMessage",Kc,ad=>{ad&&za.a.J(507843606,375,15,"Couldn't deliver the message to Editor pane, status: {0}.",ad)})}ntg(tb){const Kc=tb.origin;if(this.wTd(Kc)){var ad;({BD:ad}=n.d(tb.data)).returnValue&&
ad&&"."===ad.editorPaneWildCard&&ad.message&&this.ua.raiseEvent("MessageReceived",new Jj(this.oHe.nAb(),ad.message,Kc===this.wGl))}}wTd(tb){const Kc=rg.a.getOrigin(window.location.href);return!!tb&&0<tb.length&&"null"!==tb&&(tb===this.wGl||tb===Kc||this.hcn.test(tb))}}Object(c.a)(uk,"Messenger",null,[1428]);class ai{constructor(tb,Kc){this.Hd=tb;this.assetId=Kc.D$j}nAb(){if(!this.Hd.instance)return za.a.J(37025987,375,15,"[EditorPaneManager] App for office manager not present"),null;const tb=this.Hd.instance.xT(this.assetId);
return tb?tb.Kp?tb.Kp:(za.a.J(37025991,375,15,"[EditorPaneManager] App for office doesn't have instance id"),null):(za.a.J(37025989,375,200,"[EditorPaneManager] App for office not found"),null)}getAssetId(){return this.assetId}}Object(c.a)(ai,"PaneIdsProvider",null,[1426]);class mh{constructor(){this.iu=new Bf.a}subscribe(tb,Kc){tb&&(this.iu.Ob(Kc)||this.iu.add(Kc,[]),Array.contains(this.iu.ha(Kc),tb)||this.iu.ha(Kc).push(tb))}unsubscribe(tb,Kc){tb&&this.iu.Ob(Kc)&&(tb=Array.indexOf(this.iu.ha(Kc),
tb),-1!==tb&&Array.removeAt(this.iu.ha(Kc),tb))}SWn(tb){tb&&(this.unsubscribe(tb,0),this.unsubscribe(tb,1),this.unsubscribe(tb,2))}OTm(tb){return this.iu.Ob(tb)?this.iu.ha(tb):[]}}Object(c.a)(mh,"EditorPaneSubscriptionsManager",null,[1427]);var tg=a(383);class Kj{constructor(){this.$=null}get name(){return"PowerPointWebEditor.EditorPane"}lc(tb){tb&&(this.$=tb,this.$.register(hc,"PowerPointWebEditor.Proofing.CritiquesHighlightActor").ma().na(()=>new hc(this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.$.resolve("PowerPointWebEditor.IApplicationSettings").C8)),this.$.register(1419,"PowerPointWebEditor.Proofing.IConsistencyCheckActor").ma().na(()=>new Bd(this.$.resolve("Box4.Highlight.IHighlightManager"),this.$.resolve("PowerPointWebEditor.Proofing.CritiquesHighlightActor"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("Box4.Proofing.IErrorRangeEditor"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("Box4.ICharacterPropertiesEditor"),
this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").kKe)),this.$.register(xe,"PowerPointWebEditor.EditorPane.EditorPaneActor").ma().na(()=>new xe(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.$.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),
this.$.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger"),this.$.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.pBm(),this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerpointPresence.IPresenceEventHandlers"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(8),this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.$.resolve("PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),this.$.resolve("PowerPointWebEditor.IPresentationReader"))),Kj.k4m&&this.$.register(ic,"PowerPointWebEditor.EditorPane.DexLitePaneActor").ma().na(()=>new ic(this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.$.resolve("Common.IActionManagerExtended"),
this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("PowerPointWebEditor.View.IDexLitePane"),this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
this.$.resolve("PowerPointWebEditor.IPPTWorkspace"),tg.a(this.$),this.$.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.$.register(1420,"PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser").ma().na(()=>new Fi(this.$.resolve("Common.IActionManager"),this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"))),
this.$.register(zc,"PowerPointWebEditor.Editor.Common.Model.EditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventNotifier").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventHandler").ma().na(()=>new zc),this.$.register(1421,"PowerPointWebEditor.EditorPane.IEditorPaneHost").ma().na(()=>new vg(this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("Box4.Proofing.IErrorRangeEditor"),
this.$.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckActor"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.$.resolve("PowerPointWebEditor.EditorPane.IDataContractMapper"),this.$.resolve("Box4.IParagraphReader"),this.$.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Qf.a.ztb))),this.$.register(1422,"PowerPointWebEditor.EditorPane.IDataContractMapper").ma().na(()=>
new Hd),this.$.register(1423,"PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger").ma().na(()=>new qg(this.$.Na("PowerPointWebEditor.IInfraredTelemetryListener"))),this.$.register(1424,"PowerPointWebEditor.EditorPane.IEditorPane").ma().na(()=>new Fe(this.$.resolve("Common.IActionManagerExtended"),this.$.Na("PowerPointWebEditor.IAppForOfficeManager"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.$.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),
this.$.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").fPa,!0)),this.$.register(1425,"PowerPointWebEditor.EditorPane.IEditorPaneEventSource").ma().na(()=>new cg),this.$.register(1426,"PowerPointWebEditor.EditorPane.IPaneIdsProvider").ma().na(()=>new ai(this.$.Na("PowerPointWebEditor.IAppForOfficeManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"))),this.$.register(1427,"PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager").ma().na(()=>
new mh),this.$.register(1428,"PowerPointWebEditor.EditorPane.Messaging.IMessenger").ma().na(()=>new uk(this.$.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").PUl,this.$.resolve("PowerPointWebEditor.IApplicationSettings").Wee)),this.$.register(1429,"PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder").ma().na(()=>new Hg),this.$.register(gj,"PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor").ma().na(()=>
new gj),this.$.register(Uf,"PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor").ma().na(()=>new Uf(this.$.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.$.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.$.register(Tf,"PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor").ma().na(()=>new Tf(this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.$.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.$.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.$.register(Jg,"PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor").ma().na(()=>new Jg(this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.$.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.$.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.$.register(Oh,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor").ma().na(()=>
new Oh(this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"))),this.$.register(fi,"PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor").ma().na(()=>new fi(this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.$.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.$.register(Ag,"PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor").ma().na(()=>
new Ag(this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.$.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.$.register(kj,"PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor").ma().na(()=>new kj(this.$.resolve("Common.IActionManager"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.$.register(Ii,"PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor").ma().na(()=>new Ii(this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.$.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.$.register(ng,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor").ma().na(()=>new ng(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").fPa)))}init(){this.$&&this.$.resolve("Common.IAppSettingsManager").fg(()=>{var tb=this.$.resolve("PowerPointWebEditor.IApplicationSettings");
Kj.tOn(tb)&&this.$.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger").initialize()&&(tb=this.$.resolve("PowerPointWebEditor.EditorPane.EditorPaneActor"),tb.Hb(),tb.ve(),tb=this.$.resolve("PowerPointWebEditor.EditorPane.DexLitePaneActor"),tb.Hb(),tb.ve())})}dispose(){}pBm(){const tb=new Bf.a;tb.K(0,this.$.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor"));tb.K(1,this.$.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor"));
tb.K(3,this.$.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor"));tb.K(4,this.$.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor"));tb.K(5,this.$.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor"));tb.K(6,this.$.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor"));tb.K(7,this.$.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor"));tb.K(9,
this.$.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor"));tb.K(10,this.$.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor"));tb.K(11,this.$.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor"));return tb}static main(){h.a.instance.Fc(new Kj)}static tOn(tb){return tb.C8&&Kj.F3m(tb.D$j)}static k4m(tb){return tb.yeh}static F3m(tb){return!!tb&&0<tb.length}}Object(c.a)(Kj,"PptWebEditorEditorPanePackage",
null,[3,4]);class ek{constructor(tb){this.mc=!1;this.J$h=320;this.initialize();this.ia=tb}initialize(){}dispose(){}Hb(){this.ia.sa(be.a.HYc,Od.a.application,this.HYc,4)}ve(){}HYc(tb,Kc,ad){return 1===ad?32:2===ad?Xa.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.mc.toString(),tb,()=>{this.mc?this.Rn():this.Tw();return 32}):8}Rn(tb=!1){const Kc=this.ML();this.mc=!0;const ad=Object.assign(new Wf.a,{title:ResourceStrings.L_DexLitePaneTitle,hideHeader:!1,width:this.J$h,location:2,contentProps:Kc,
onOpen:()=>{},onClose:()=>{this.mc=!1},isModernPane:!0});Xf.a.Py().then(id=>{tb?id.updateTaskPane(kb.a.rca,ad):id.showTaskPane(kb.a.rca,ad);return null}).catch(id=>{za.a.J(508883089,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+id.toString())})}Tw(){this.mc=!1;Xf.a.Py().then(tb=>{tb.hideTaskPane(kb.a.rca,2);return null}).catch(tb=>{za.a.J(508883088,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+tb.toString())})}ML(){return new Ab(0,0,0,0,
0,0,0,0)}}Object(c.a)(ek,"EditorPaneActor",null,[24,743]);var gi=a(1225),Di=a(336);class ak{constructor(tb,Kc,ad,id,ud,ke,of,Yf,If){this.xil=/[\t\n\s `~!@#$%^&*-+=|:;'"<>?/]+/;this.Mvm=4;this.Dil="RewriteInnerContainer";this.Nvm="RewriteIndicatorView";if(!tb)throw Error.argumentNull("shapeReader");if(!Kc)throw Error.argumentNull("selectionManager");if(!ad)throw Error.argumentNull("graphTopologyManager");if(!id)throw Error.argumentNull("pageView");if(!ud)throw Error.argumentNull("activeSlideViewManager");
if(!ke)throw Error.argumentNull("appSettings");if(!of)throw Error.argumentNull("shapeTargetBounds");if(!Yf)throw Error.argumentNull("rewriteActivityLogger");if(!If)throw Error.argumentNull("slideReader");this.Ia=tb;this.pa=Kc;this.va=ad;this.xb=id;this.Lc=ud;this.Jvm=ke.GNl;this.Ivm=ke.Jc("minWordLimitForValidBulletedConciseContent",10);this.Hvm=ke.Jc("minBulletLimitForValidBulletedConciseContent",7);this.Kvm=ke.Jc("minWordLimitForTitleSuggestions",10);this.QLl=of;this.nng=Yf;this.nc=If}dispose(){}get Dof(){const tb=
this.pa.ud();return 1!=(null===tb||void 0===tb?void 0:tb.length)?new Sys.UI.Bounds(0,0,0,0):tb[0].tc(this.xb.Oa).getBounds()}get gnl(){const tb=this.Lc.Yc;return tb?tb.rr.getBoundingClientRect():new Sys.UI.Bounds(0,0,0,0)}Ohh(){return this.QLl.hxm(this.Dof,this.gnl)}iFe(tb){var Kc,ad;return null===(ad=null===(Kc=this.pa.ud()[0])||void 0===Kc?void 0:Kc.id)||void 0===ad?void 0:ad.equals(tb)}pih(){return this.QLl.XOm(this.Ohh(),this.gnl,this.Dof)}wri(){switch(this.Kzb){case gi.RewriteType.Title:return this.GSm();
case gi.RewriteType.Content:return this.XUm()}}get Kzb(){var tb=this.pa.ud();if(1==(null===tb||void 0===tb?void 0:tb.length)&&this.BDl(tb[0]))if(tb=tb[0],tb.pl)switch(tb.placeholderType){case 0:case 2:return gi.RewriteType.Title;case 1:case 8:return gi.RewriteType.Content}else return this.iVn(tb)?gi.RewriteType.Title:gi.RewriteType.Content}iVn(tb){var Kc,ad;const id=this.nc.kih(this.va.Ga);if(this.D6m(id))for(const ud of id)if(ud.Uq)return null!==(ad=null===(Kc=tb.id)||void 0===Kc?void 0:Kc.equals(ud.id))&&
void 0!==ad?ad:!1;return!1}BDl(tb){return tb.pl||mb.a("EnableRewriteForTextbox")&&tb.Uq}D6m(tb){var Kc;return null!==(Kc=null===tb||void 0===tb?void 0:tb.every(ad=>!ad.Lca))&&void 0!==Kc?Kc:!1}get jlb(){const tb=this.pa.ud();return 1==(null===tb||void 0===tb?void 0:tb.length)&&this.BDl(tb[0])&&void 0!=this.wri()}get Apj(){const tb=this.va.Ga;return tb&&tb.xj()?tb.xj().every(Kc=>Kc.pl&&this.D5m(Kc.placeholderType)||this.t5m(Kc)):!1}p6m(tb){const Kc=this.pa.ud();if(1!=(null===Kc||void 0===Kc?void 0:
Kc.length))return!1;const ad=this.Ia.hSi(Kc[0]);tb=null===tb||void 0===tb?void 0:tb.mb;const id=this.Lll(null===tb||void 0===tb?void 0:tb.toArray());this.Rrl(id,ad);if(!id||1>id.size)return!1;let ud=!0;id.forEach((ke,of)=>{if(ke)if(ad.size!=id.size&&ad.get(of))ud=!1;else{var Yf=ke.Va;ke=ke.Ib;ad.size==id.size&&0<=Yf&&0<=ke&&Math.abs(ke-Yf)<ad.get(of)&&(ud=!1)}else ud=!1});return ud}u4m(tb){const Kc=this.pa.ud();if(1!=(null===Kc||void 0===Kc?void 0:Kc.length))return!1;const ad=this.Ia.hSi(Kc[0]);tb=
null===tb||void 0===tb?void 0:tb.mb;tb=this.Lll(null===tb||void 0===tb?void 0:tb.toArray());this.Rrl(tb,ad);if(!tb||ad.size!=tb.size)return!1;let id=!0;tb.forEach((ud,ke)=>{if(ud){var of=ud.Va;ud=ud.Ib;0<=of&&0<=ud&&Math.abs(ud-of)!=ad.get(ke)&&(id=!1)}else id=!1});return id}Rrl(tb,Kc){Kc.forEach((ad,id)=>{0==ad&&(tb.delete(id),Kc.delete(id))})}Lll(tb){const Kc=new Map;tb.forEach(ad=>{const id=ad.node;if(Kc.has(id.id)){const ud=ad.Ib;-1!=ad.Va&&-1!=ud&&Kc.set(id.id,ad)}else Kc.set(id.id,ad)});return Kc}YUm(){var tb=
this.va.Ga;if(tb){var Kc=[];tb.xj().filter(ad=>ad&&this.n6m(ad)).forEach(ad=>Kc.push(this.Ia.bEf(ad)));tb=Kc.filter(ad=>ad&&0<ad.length).join("\n");return this.$Bl(tb,!0)?tb:void 0}za.a.J(508692224,816,10,"Active slide node is null");this.nng.rewriteLogActivity("RewriteActiveSlideNode",!1,0,{errorMsg:"Active slide node is null"})}wUm(){var tb;const Kc=this.pa.ud();if(1==(null===Kc||void 0===Kc?void 0:Kc.length)&&(null===(tb=Kc[0])||void 0===tb||!tb.Cz))return(tb=(tb=this.Ia.bEf(Kc[0]))?tb.trim():
void 0)&&0<tb.length?tb:void 0}GSm(){var tb=this.YUm();const Kc=this.wUm();tb=null!==tb&&void 0!==tb?tb:Kc;if(!I.a.rb(tb))return{Fof:tb,inputType:gi.RewriteType.Title,ayi:[gi.RewriteSuggestionType.Concise],DHk:!1,H7l:Kc}}XUm(){const tb=this.pa.ud();if(1==(null===tb||void 0===tb?void 0:tb.length)){var Kc=this.Ia.bEf(tb[0]),ad=this.ZBl(tb[0]);if(this.$Bl(Kc,!1)){const id=[gi.RewriteSuggestionType.Bullet,gi.RewriteSuggestionType.Paraphrase];this.$3m(tb[0])&&id.push(gi.RewriteSuggestionType.Concise);
return{Fof:Kc,inputType:this.Kzb,DHk:ad,ayi:id}}}}fvm(){var tb,Kc;const ad=new Di.a;ad.ta.id=this.Nvm;this.G6d=new Di.a;this.G6d.ta.id=this.Dil;this.G6d.gk(1);this.G6d.ta.style.position="absolute";null===(Kc=null===(tb=this.Lc.Yc)||void 0===tb?void 0:tb.U_l)||void 0===Kc?void 0:Kc.appendChild(null===ad||void 0===ad?void 0:ad.ta);ad.appendChild(this.G6d)}vLm(){var tb;const Kc=this.pa.ud();if(f.AFrameworkApplication.ga.getBooleanAppSetting("RewriteViewElementImprovement")){var ad=null===(tb=Kc[0])||
void 0===tb?void 0:tb.tc(this.xb.Oa);this.fvm();tb=null===ad||void 0===ad?void 0:ad.Zt();ad=document.getElementById(this.Dil);if(!tb||!ad)return this.G6d.ta;this.G6d.setPosition(tb.Ic-ad.getBoundingClientRect().width-this.Mvm,tb.Xc);return this.G6d.ta}tb=null===(ad=Kc[0])||void 0===ad?void 0:ad.tc(this.xb.Oa);ad=new Di.a;ad.ta.id="RewriteIndicatorId";tb.htmlElement.appendChild(ad.ta);return ad.ta}$Bl(tb,Kc){if(!tb||0>=tb.length)return!1;const ad=tb.trim().split(this.xil);Kc=Kc&&mb.a("minWordLimitForTitle")?
this.Kvm:this.Jvm;return ad.length>=Kc||mb.a("CJKContentEligibility")&&(this.xAe(tb.trim(),"ja")>=Kc||this.xAe(tb.trim(),"zh")>=Kc)}xAe(tb,Kc){var ad,id;if(!tb||!Kc)return 0;let ud="\\b";"ja"===Kc?ud="[\\p{Script=Hiragana}\\p{Script=Katakana}\\p{Script=Han}\u30fc]":"zh"===Kc&&(ud="[\\p{Script=Han}]");return null!==(id=null===(ad=tb.match(new RegExp(ud,"gu")))||void 0===ad?void 0:ad.length)&&void 0!==id?id:0}ZBl(tb){return tb&&18!==tb.P7a&&0!==tb.P7a}$3m(tb){if(!this.ZBl(tb))return!0;tb=this.Ia.bEf(tb);
if(!tb)return!1;tb=tb.split("\n");if(tb.length>=this.Hvm)return!0;for(const Kc of tb){if(null===Kc||void 0===Kc||!Kc.length)break;if(Kc.trim().split(this.xil).length>=this.Ivm)return!0}return!1}D5m(tb){switch(tb){case 0:case 3:case 2:case 1:case 8:case 6:case 5:return!0;default:return!1}}n6m(tb){if(tb.pl)switch(tb.placeholderType){case 1:case 8:return!0}else if(mb.a("EnableRewriteForTextbox"))return tb.Uq;return!1}t5m(tb){return mb.a("EnableRewriteForShapesAndTextbox")?!(tb.Zc||tb.om||tb.rg):tb.isGif||
tb.Kg||2==tb.mediaType||1==tb.mediaType}}Object(c.a)(ak,"RewriteSelectionManager",null,[1482]);var Rj=a(516),Lf=a(566),Sh=a(1119);class Nh{constructor(tb,Kc){this.NJk=new Map;this.isInitialized=!1;if(!tb)throw Error.argumentNull("pptAugLoopRuntimeManager");if(!Kc)throw Error.argumentNull("currentShapeSelectionStore");this.B1=tb;this.p8=Kc}initialize(){this.isInitialized||(this.B1.execute(tb=>{tb.e0(gi.RewriteAnswer.getTypeName());tb.GBa(gi.RewriteAnswer.getTypeName(),this.gXm.bind(this))}),this.isInitialized=
!0)}Hgh(tb){return Object(ha.b)(this,void 0,void 0,function*(){this.initialize();return yield this.aLm(tb.Fof,tb.inputType,tb.ayi,this.qSm(tb))})}qSm(tb){return Object(mb.a)("SendPrevSuggestionsToAL")&&(null===tb||void 0===tb?void 0:tb.inputType)==gi.RewriteType.Title?{title:this.xUm(tb)}:{concise:this.$Mm(tb),bullet:{},paraphrase:this.pRm(tb)}}$Mm(tb){return{makeBullet:tb.DHk}}pRm(tb){return{makeBullet:tb.DHk,prevSuggestions:Object(mb.a)("SendPrevSuggestionsToAL")?this.p8.cwl(gi.RewriteSuggestionType.Paraphrase):
void 0}}xUm(tb){const Kc=this.p8.cwl(gi.RewriteSuggestionType.Title);(null===tb||void 0===tb?0:tb.H7l)&&Kc.push(tb.H7l);return{prevTitles:Kc}}aLm(tb,Kc,ad,id){return Object(ha.b)(this,void 0,void 0,function*(){const ud=Rc.a.create().toString(),ke=this.fAm(ud,tb,Kc,ad,id,this.p8.zNm(ad));this.B1.execute(Yf=>{Yf.submitOperation(ke.operation)});const of=new Sh.a;this.NJk.set(ud,of);return of.completion})}fAm(tb,Kc,ad,id,ud,ke){Kc=new gi.RewriteSignal({input:Kc,modelType:ad,requestedSuggestionTypes:id,
modelParams:ud,regenSequence:ke});tb=new Lf.a({parentPath:[Rj.a.getTypeName(),uc.a.getTypeNameFor(Kc)],items:[{id:tb,body:Kc}]});return Object.assign(new Y.a,{operation:tb})}zfn(tb){return{rewriteSuggestions:tb.suggestions.map(Kc=>({text:Kc.content,type:Kc.type})),statusCode:tb.status}}gXm(tb){if(tb){var Kc=this.oTm(tb.parentPath),ad=this.NJk.get(Kc);ad&&(this.NJk.delete(Kc),ad.resolve(this.zfn(tb)))}}oTm(tb){return tb[2]}}Object(c.a)(Nh,"RewriteSuggestionGenerator",null,[1481]);var Fk=a(28),bk=a(62),
Uh=a(349),Ge=a(72),Hf=a(13),Bg=a(3),qk=a(490),Oj=a(642),Hk=a.n(Oj);class Hi{constructor(tb){this.MVb=tb}pwb(tb,Kc,ad){const id=this.IRi(Kc,tb);this.showDialog(id,tb,Kc,ad)}showDialog(tb,Kc,ad,id){function ud(of){za.a.J(508847713,811,20,"Feedback dialog dismissed. IsFeedbackSent={0}; FeatureArea={1}; IsLikeDialog={2}",of,ad,Kc);id&&id(of,ad)}const ke=this.pq;Xf.a.eJd().then(of=>{of.initializeFeedbackModal(tb,ud,ke)})}pq(tb){za.a.J(508847712,811,10,"Error in submitting feedback: "+tb)}IRi(tb,Kc=!1){var ad=
{};f.AFrameworkApplication.ga.Amc(ad);ad=this.MVb.getContext(ad)||{};ad.uiType="Modal";ad.screenshot=!0;ad.showEmailAddress=!0;Kc?ad.initialFeedbackType="Smile":(ad.scenarioConfig={isScenarioEnabled:!0,scenarioType:"ResponsibleAI"},ad.initialFeedbackType="Frown");Kc=ad.telemetryGroup||{};Kc.processSessionId=ad.sessionId;Kc.officeBuild=ad.build;Kc.featureArea=tb;ad.telemetryGroup=Kc;return ad}}Object(c.a)(Hi,"RewriteFeedback",null,[]);var nh=a(61);class Pf{constructor(tb,Kc,ad,id,ud,ke,of,Yf,If,Jf,
Th,yh,yi,Xi){this.Gvm="<li>";this.Fvm="</li>";this.dNa=this.KXb=!0;this.qIn=()=>{if(this.KXb)return 8;this.T_l(void 0);return 32};this.V_l=Fh=>Object(ha.b)(this,void 0,void 0,function*(){if(Fh.keyCode===Fk.a.hv){Fh.stopPropagation();Fh.preventDefault();const Gi=document.activeElement;Gi&&(bk.FocusManager.UA(Gi),Gi.click())}else Fh.keyCode===Fk.a.gyb&&(Fh.stopPropagation(),Fh.preventDefault(),yield this.ZAe())});this.onShapeSelected=()=>Object(ha.b)(this,void 0,void 0,function*(){this.KXb&&this.dNa||
this.jFl();this.p8.reset();this.KXb||(yield this.C6c());this.dNa||(yield this.ZAe());(!mb.a("EnableSlideContentValidation")||this.zU.Apj)&&this.zU.jlb&&(yield this.V4l())});this.tta=()=>Object(ha.b)(this,void 0,void 0,function*(){this.KXb&&this.dNa||this.jFl();this.p8.reset();this.KXb||(yield this.C6c());this.dNa||(yield this.ZAe())});this.QH=(Fh,Gi)=>Object(ha.b)(this,void 0,void 0,function*(){if(Gi&&Gi.gD){var Bj=mb.a("EnableSlideContentValidation")?this.zU.Apj:!0,ck=mb.a("RewriteShapeSelectionIssueFixes")?
this.zU.p6m(Gi.Ok):this.zU.u4m(Gi.Ok);Bj&&this.zU.jlb&&ck?this.dNa&&(yield this.onShapeSelected(Fh,Gi)):yield this.tta(Fh,Gi)}});this.W_l=(Fh,Gi)=>Object(ha.b)(this,void 0,void 0,function*(){const Bj=mb.a("EnableSlideContentValidation")?this.zU.Apj:!0;Gi.ipe&&Bj&&this.zU.jlb?yield this.V4l():Gi.ipe||(this.dNa||(yield this.ZAe()),yield this.C6c())});this.xo=()=>Object(ha.b)(this,void 0,void 0,function*(){this.KXb||(yield this.C6c())});this.d_=Fh=>Object(ha.b)(this,void 0,void 0,function*(){if(this.uza=
Fh)this.KXb||(yield this.C6c()),this.dNa||(yield this.ZAe())});this.T_l=Fh=>Object(ha.b)(this,void 0,void 0,function*(){var Gi;const Bj=performance.now();null===Fh||void 0===Fh?void 0:Fh.stopPropagation();yield this.C6c();const ck=this.zU.Kzb;this.p8.Twk=ck;this.p8.jed=null===(Gi=this.ob.ud()[0])||void 0===Gi?void 0:Gi.id;yield this.GIk();var Ph=yield this.ltl();yield this.ADe();if(this.zU.iFe(this.p8.jed)){Gi=null===Ph||void 0===Ph?void 0:Ph.statusCode;Ph=this.Wql(Ph);var qj=gi.RewriteCompletionStatus.Success===
Gi&&0<(null===Ph||void 0===Ph?void 0:Ph.length);qj?(yield this.qJk(Ph,void 0),this.y9l(Ph),nh.c(be.a.fNg,!0,void 0,0,30,performance.now()-Bj,{currentSelectionType:ck,showSuggestionCard:qj,generatedSuggestionType:this.Tql(Ph)})):(za.a.J(508866837,816,10,"No suggestions returned for selected shape with status code: ${statusCode}"),nh.c(be.a.fNg,!1,void 0,0,30,performance.now()-Bj,{errorMsg:"No suggestions returned for selected shape with status code: ${statusCode}"}),yield this.DUg(Gi))}});this.onLayerMounted=
()=>Object(ha.b)(this,void 0,void 0,function*(){const Fh=document.getElementById("RewriteSuggestionsBodyId");Fh&&(bk.FocusManager.UA(Fh),this.yom())});this.onLikeSuggestionClicked=Fh=>{if(this.vLl)try{this.vLl.pwb(Fh,"Copilot Rewrite",null),nh.c(be.a.dvh,!0,void 0,0,30,0,{isFeedbackTypeLiked:Fh})}catch(Gi){za.a.J(508851866,811,10,"Copilot Rewrite: Feedback dialog failed to open with error={0}; isLikeDialog={1}",Gi.toString(),Fh),nh.c(be.a.dvh,!1,void 0,0,30,0,{errorMsg:"Copilot Rewrite: Feedback dialog failed to open with error=${e.toString()}; isLikeDialog=${isLikeClicked}"})}else za.a.J(508851867,
811,10,"Copilot Chat: ActionAIFeedback is received as null"),nh.c(be.a.dvh,!1,void 0,0,30,0,{errorMsg:"Copilot Chat: ActionAIFeedback is received as null"})};this.n5h=Fh=>Object(ha.b)(this,void 0,void 0,function*(){var Gi=performance.now();const Bj=this.zU.Kzb,ck=this.p8.anh;this.dNa||(yield this.ZAe());var Ph=Fh.suggestionText;Ph.startsWith('"')&&(Ph=Ph.replace(/(^")|("$)/g,""));Ph=Hk.a.sanitize(Ph);if(mb.a("EnableReplaceTextJsonCmd")){var qj=this.ob.ud();if(1!=(null===qj||void 0===qj?void 0:qj.length)){za.a.J(508846176,
816,10,"Selected Shape Not Found");this.nng.rewriteLogActivity("ShapeSelectionError",!1,0,{errorMsg:"Selected Shape Not Found"});return}Ph={id:qj[0].get_sid(),type:1,cId:qj[0].get_cid(),shapeId:qj[0].get_shapeId(),text:Ph,textFormat:1,removeBullet:mb.a("FixBulletToParaTextInRewrite")&&!this.O6m(Ph)};mb.a("RewriteUseUpdatedApplyJOfcCommands")?JSON.parse(yield this.oab.applyJOfcCommands(JSON.stringify([{data:Ph,name:"ReplaceTextCmd"}]),"","","","RewriteActor")).FSuccess||(za.a.J(508834818,816,10,"Rewrite:: JOFC command execution failed"),
nh.c(be.a.cvh,!1,void 0,0,30,performance.now()-Gi,{errorMsg:"Rewrite:: JOFC command execution failed"}),yield this.DUg(gi.RewriteCompletionStatus.Unknown)):(yield this.oab.Afh(JSON.stringify(Ph),"ReplaceTextCmd"))||(za.a.J(508846175,816,10,"Rewrite:: JOFC command execution failed"),nh.c(be.a.cvh,!1,void 0,0,30,performance.now()-Gi,{errorMsg:"Rewrite:: JOFC command execution failed"}),yield this.DUg(gi.RewriteCompletionStatus.Unknown))}else qj=new qk.a,qj.Vqa=!0,qj.oN=Ph,this.ia.Qa(be.a.pka,2,qj);
nh.c(be.a.cvh,!0,void 0,0,30,performance.now()-Gi,{currentSelectionType:Bj,appliedSuggestionType:Fh.suggestionType,visitedSuggestions:ck});mb.a("DeselectShapesOnReplace")&&(Gi=this.ob.ud())&&this.ob.usa(Gi)});this.aEn=Fh=>Object(ha.b)(this,void 0,void 0,function*(){const Gi=performance.now();yield this.C6c();yield this.GIk();var Bj=yield this.$Dn(Fh);yield this.ADe();if(this.zU.iFe(this.p8.jed)){Bj=null===Bj||void 0===Bj?void 0:Bj.statusCode;var ck=this.p8.DNm(),Ph=gi.RewriteCompletionStatus.Success===
Bj&&0<(null===ck||void 0===ck?void 0:ck.length);Ph?yield this.qJk(ck,Fh):(za.a.J(508866836,816,10,"No suggestions returned for selected type: ${currentSuggestionType} with status code: ${statusCode}"),nh.c(be.a.gNg,!1,void 0,0,30,performance.now()-Gi,{errorMsg:"No suggestions returned for selected type: ${currentSuggestionType} with status code: ${statusCode}"}),yield this.DUg(Bj));nh.c(be.a.gNg,!0,void 0,0,30,performance.now()-Gi,{currentSelectionType:this.zU.Kzb,showSuggestionCard:Ph,generatedSuggestionTypes:Fh.toString()})}});
this.nIn=Fh=>Object(ha.b)(this,void 0,void 0,function*(){null===Fh||void 0===Fh?void 0:Fh.stopPropagation();const Gi=performance.now();yield this.C6c();yield this.GIk();var Bj=yield this.ltl();yield this.ADe();if(this.zU.iFe(this.p8.jed)){var ck=null===Bj||void 0===Bj?void 0:Bj.statusCode;Bj=this.Wql(Bj);var Ph=gi.RewriteCompletionStatus.Success===ck&&0<(null===Bj||void 0===Bj?void 0:Bj.length);Ph?(yield this.qJk(Bj,void 0),this.y9l(Bj)):(za.a.J(508827721,816,10,"No suggestions returned for selected shape with status code: ${statusCode} on retry"),
nh.c(be.a.gNg,!1,void 0,0,30,performance.now()-Gi,{errorMsg:"No suggestions returned for selected shape with status code: ${statusCode} on retry"}),yield this.DUg(ck));nh.c(be.a.gNg,!0,void 0,0,30,performance.now()-Gi,{currentSelectionType:this.zU.Kzb,showSuggestionCard:Ph,generatedSuggestionTypes:this.Tql(Bj)})}});this.Tmn=Fh=>{this.p8.S$e(Fh)};if(!tb)throw Error.argumentNull("actionManager");if(!Kc)throw Error.argumentNull("graphOperationEventSource");if(!ad)throw Error.argumentNull("viewElementEventSource");
if(!id)throw Error.argumentNull("rewriteSelectionManager");if(!ud)throw Error.argumentNull("rewriteSuggestionGenerator");if(!ke)throw Error.argumentNull("pptSelectionManager");if(!of)throw Error.argumentNull("viewEventNotifier");if(!Yf)throw Error.argumentNull("customerFeedbackUiWrapper");if(!If)throw Error.argumentNull("copilotProxy");if(!Jf)throw Error.argumentNull("appFrame");if(!Th)throw Error.argumentNull("coreEventHandler");if(!yh)throw Error.argumentNull("currentShapeSelectionStore");if(!yi)throw Error.argumentNull("rewriteActivityLogger");
if(!Xi)throw Error.argumentNull("focusManager");this.Io=Kc;this.cE=ad;this.zU=id;this.wLl=ud;this.ia=tb;this.ob=ke;this.Ge=of;this.vLl=new Hi(Yf);this.z0f=this.o2m();this.oab=If;this.Db=Jf;this.od=Th;this.p8=yh;this.nng=yi;this.Ma=Xi}Hb(){this.Io.d$b(this.onShapeSelected);this.Io.I4c(this.tta);this.cE.e$b(this.tta);this.ob.QM(this.QH);this.Ge.Ffl(this.W_l);f.AFrameworkApplication.Ea.YW(this.xo);this.Db.pSa(this.d_);this.od.$td(this.tta);this.od.sE(this.tta);mb.a("RewriteIndicatorShortcutRegister")&&
this.ia.sa(be.a.fNg,Od.a.application,this.qIn,4)}dispose(){this.Io.BLe(this.onShapeSelected);this.Io.yuh(this.tta);this.cE.QUc(this.tta);this.ob.Bbb(this.QH);this.Ge.EZl(this.W_l);this.Db.UCb(this.d_);this.od.QKg(this.tta);this.od.F8(this.tta)}ve(){if(mb.a("RewriteIndicatorShortcutRegister")){const tb=this.Ma.gd(Uh.AFrame.vl);null===tb||void 0===tb?void 0:tb.bindAction(Ge.a.eb(Fk.a.g2c,1|Ge.a.Ke),be.a.fNg)}}yom(){this.tYl();Hf.a.addHandler(document.getElementById("RewriteSuggestionsBodyId"),Bg.a.Lj,
this.V_l)}tYl(){Hf.a.removeHandler(document.getElementById("RewriteSuggestionsBodyId"),Bg.a.Lj,this.V_l)}o2m(){const tb=document.createElement("div");tb.id="RewriteCardId";document.body.appendChild(tb);return tb}V4l(){return Object(ha.b)(this,void 0,void 0,function*(){if(this.KXb&&!this.uza&&1!==this.Db.mode){this.KXb=!1;var tb={onRewriteIndicatorClick:this.T_l,getTargetRect:f.AFrameworkApplication.ga.getBooleanAppSetting("RewriteViewElementImprovement")?void 0:this.zU.Dof,isIndicatorHidden:!1,targetPlaceholderType:this.zU.Kzb};
yield(yield Xf.a.XGd()).renderContextualCard("RewriteIndicator",this.mcn=this.zU.vLm(),tb);this.nng.rewriteLogActivity("RewriteIndicatorCardShown",!0)}})}C6c(){var tb,Kc;return Object(ha.b)(this,void 0,void 0,function*(){this.KXb=!0;(yield Xf.a.XGd()).dispose(this.mcn);f.AFrameworkApplication.ga.getBooleanAppSetting("RewriteViewElementImprovement")?null===(tb=document.getElementById("RewriteIndicatorView"))||void 0===tb?void 0:tb.remove():null===(Kc=document.getElementById("RewriteIndicatorId"))||
void 0===Kc?void 0:Kc.remove()})}qJk(tb,Kc){return Object(ha.b)(this,void 0,void 0,function*(){this.dNa||(yield this.ADe());if(this.zU.iFe(this.p8.jed)){var ad={getTargetRect:this.zU.pih(),placeholderOverflow:this.zU.Ohh(),rewriteCardState:1,isCardHidden:!1,rewriteSuggestions:tb,suggestionCount:tb.length,targetPlaceholderType:this.zU.Kzb,currentRegeneratedSuggestionType:Kc,onReplaceSuggestionClicked:this.n5h,onRegenerateSuggestionsClicked:this.aEn,onLikeSuggestionClicked:this.onLikeSuggestionClicked,
onNextSuggestionClicked:this.Tmn,onLayerMounted:this.onLayerMounted};yield(yield Xf.a.XGd()).renderContextualCard("RewriteContextualCard",this.z0f,ad);this.dNa=!1}})}DUg(tb){return Object(ha.b)(this,void 0,void 0,function*(){this.dNa||(yield this.ADe());if(this.zU.iFe(this.p8.jed)){var Kc={placeholderOverflow:this.zU.Ohh(),targetPlaceholderType:this.zU.Kzb,getTargetRect:this.zU.pih(),rewriteCardState:2,isCardHidden:!1,rewriteErrorState:this.Pzm(tb),onRetryButtonClicked:this.nIn,onLayerMounted:this.onLayerMounted};
yield(yield Xf.a.XGd()).renderContextualCard("RewriteContextualCard",this.z0f,Kc);this.dNa=!1;nh.a("ErrorContextualCardShown",!0)}})}GIk(){return Object(ha.b)(this,void 0,void 0,function*(){this.dNa||(yield this.ADe());if(this.zU.iFe(this.p8.jed)){var tb={placeholderOverflow:this.zU.Ohh(),getTargetRect:this.zU.pih(),targetPlaceholderType:this.zU.Kzb,rewriteCardState:0,isCardHidden:!1,onLayerMounted:this.onLayerMounted};yield(yield Xf.a.XGd()).renderContextualCard("RewriteContextualCard",this.z0f,
tb);this.dNa=!1;nh.a("LoadingContextualCardShown",!0)}})}ADe(){return Object(ha.b)(this,void 0,void 0,function*(){const tb={getTargetRect:this.zU.pih(),isCardHidden:!0};yield(yield Xf.a.XGd()).renderContextualCard("RewriteContextualCard",this.z0f,tb);this.dNa=!0})}ZAe(){return Object(ha.b)(this,void 0,void 0,function*(){this.tYl();(yield Xf.a.XGd()).dispose(this.z0f);this.dNa=!0})}ltl(){return Object(ha.b)(this,void 0,void 0,function*(){var tb=this.zU.wri();if(null!==tb&&void 0!==tb&&tb.Fof)return tb=
yield this.wLl.Hgh(tb),this.p8.x9l(tb),tb;za.a.J(508870787,816,50,"Ineligible shape selection for ALRewrite");this.nng.rewriteLogActivity("ShapeSelectionError",!1,0,{errorMsg:"Ineligible shape selection for ALRewrite"})})}$Dn(tb){return Object(ha.b)(this,void 0,void 0,function*(){var Kc=this.zU.wri();if(null!==Kc&&void 0!==Kc&&Kc.Fof){var ad=this.nLm(tb);if(!(0>=ad.length))return this.p8.Q0m(ad[0]),Kc.ayi=ad,Kc=yield this.wLl.Hgh(Kc),this.p8.x9l(Kc),Kc}else za.a.J(508823500,816,50,"Ineligible shape selection for ALRewrite")})}nLm(tb){switch(tb){case 0:return[gi.RewriteSuggestionType.Bullet];
case 1:return[gi.RewriteSuggestionType.Concise];case 2:return[gi.RewriteSuggestionType.Paraphrase];case 3:return[gi.RewriteSuggestionType.Title];default:return[]}}Wql(tb){var Kc;const ad=[];null===(Kc=null===tb||void 0===tb?void 0:tb.rewriteSuggestions)||void 0===Kc?void 0:Kc.filter(id=>!!id.text).forEach(id=>{ad.push({suggestionText:id.text,suggestionType:id.type})});return ad}Pzm(tb){switch(tb){case gi.RewriteCompletionStatus.OffensiveContentInput:case gi.RewriteCompletionStatus.OffensiveContentOutput:return 0;
case gi.RewriteCompletionStatus.UnsupportedLanguage:return 2;default:return 1}}Tql(tb){const Kc=[];tb.forEach(ad=>{Kc.push(ad.suggestionType)});return Kc.join(",")}jFl(){nh.c(be.a.S_l,!0,void 0,0,30,void 0,{currentSelectionType:this.p8.Twk,visitedSuggestions:this.p8.anh,isRewriteIndicatorDisposed:!this.KXb,isRewriteContextualCardDisposed:!this.dNa})}y9l(tb){tb=new Set(tb.map(Kc=>Kc.suggestionType));tb.has(3)?this.p8.S$e(3):tb.has(0)?this.p8.S$e(0):tb.has(1)?this.p8.S$e(1):this.p8.S$e(2)}O6m(tb){return tb.includes(this.Gvm)&&
tb.includes(this.Fvm)}}Object(c.a)(Pf,"RewriteActor",null,[743]);class Q{constructor(){this.Goh=24}hxm(tb,Kc){const ad={isPlaceholderOverflowing:!1,overflowDirection:void 0};tb&&Kc&&(tb.y+tb.height>=Kc.height+Kc.y&&(ad.isPlaceholderOverflowing=!0,ad.overflowDirection=0),tb.x<Kc.x&&(ad.isPlaceholderOverflowing=!0,ad.overflowDirection=1),tb.y+tb.height>=Kc.height+Kc.y&&tb.x<Kc.x&&(ad.overflowDirection=2));return ad}XOm(tb,Kc,ad){const id=new Sys.UI.Bounds(0,0,0,0);if(tb.isPlaceholderOverflowing){switch(tb.overflowDirection){case 0:id.x=
ad.x;id.width=ad.width;id.y=Kc.y;id.height=Kc.height;break;case 1:id.x=Kc.x+this.Goh;id.width=Kc.width-this.Goh;id.y=ad.y;id.height=ad.height;break;case 2:id.x=Kc.x+this.Goh,id.width=Kc.width-this.Goh,id.y=Kc.y,id.height=Kc.height}return id}return ad}}Object(c.a)(Q,"ShapeTargetBounds",null,[1480]);class xa{constructor(tb){this.Urg=[];this.Bil=0;this.ken=tb}get window(){return this.Urg}Dom(tb){this.Urg[this.Bil%this.ken]=tb;this.Bil++}}Object(c.a)(xa,"SuggestionWindow",null,[]);class ob{constructor(tb){this.WCj=
new Map;this.anh=new Set;this.Wlg=new Map;this.rNj=this.ACj=this.OBj=0;this.xen=tb}DNm(){const tb=[];this.WCj.forEach((Kc,ad)=>{(null===Kc||void 0===Kc?0:Kc.text)&&tb.push({suggestionText:Kc.text,suggestionType:ad})});return tb}x9l(tb){var Kc;0<(null===(Kc=null===tb||void 0===tb?void 0:tb.rewriteSuggestions)||void 0===Kc?void 0:Kc.length)&&tb.rewriteSuggestions.forEach(ad=>{this.WCj.set(ad.type,ad);Object(mb.a)("SendPrevSuggestionsToAL")&&this.Dpm(ad)})}S$e(tb){this.anh.add(tb)}get jed(){return this.zHl}set jed(tb){this.zHl=
tb}get Twk(){return this.AHl}set Twk(tb){this.AHl=tb}cwl(tb){return(tb=this.Wlg.get(tb))?Array.from(tb.window):[]}Dpm(tb){this.Wlg.has(tb.type)||this.Wlg.set(tb.type,new xa(this.xen));this.Wlg.get(tb.type).Dom(tb.text)}zNm(tb){if(1!=tb.length)return 0;switch(tb[0]){case gi.RewriteSuggestionType.Bullet:return this.OBj;case gi.RewriteSuggestionType.Concise:return this.ACj;case gi.RewriteSuggestionType.Paraphrase:return this.rNj;default:return 0}}Q0m(tb){switch(tb){case gi.RewriteSuggestionType.Bullet:this.OBj++;
break;case gi.RewriteSuggestionType.Concise:this.ACj++;break;case gi.RewriteSuggestionType.Paraphrase:this.rNj++}}reset(){this.WCj.clear();this.anh.clear();this.Wlg.clear();this.rNj=this.ACj=this.OBj=0;this.AHl=this.zHl=null}}Object(c.a)(ob,"CurrentShapeSelectionStore",null,[]);var Qb=a(18);class mc{rewriteLogActivity(tb,Kc,ad=0,id=null){const ud=[];if(id)for(const [ke,of]of Object.entries(id))this.HHa(ke,of,ud);nh.a(tb,Kc,ad,ud)}HHa(tb,Kc,ad){ad.push(Object.assign(new Qb.a,{name:tb,string:Kc}))}}
Object(c.a)(mc,"RewriteActivityLogger",null,[1460]);class yc{constructor(){this.$=null}get name(){return"PowerPointWebEditor.CopilotRewrite"}lc(tb){if(tb){this.$=tb;var Kc=this.$.resolve("PowerPointWebEditor.IApplicationSettings");Kc.Txi&&this.$.register(ek,"PowerPointWebEditor.CopilotRewrite.EditorPaneActor").ma().na(()=>new ek(this.$.resolve("Common.IActionManagerExtended")));this.mhj(this.$)&&(this.$.register(ob,"PowerPointWebEditor.CopilotRewrite.CurrentShapeSelectionStore").ma().na(()=>new ob(Kc.Jc("RewritePrevSuggestionWindowSize",
3))),this.$.register(mc,"PowerPointWebEditor.CopilotRewrite.RewriteActivityLogger").ma().na(()=>new mc),this.$.register(ak,"PowerPointWebEditor.CopilotRewrite.RewriteSelectionManager").as("PowerPointWebEditor.CopilotRewrite.IRewriteSelectionManager").ma().na(()=>new ak(this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),
this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Kc,this.$.resolve("PowerPointWebEditor.CopilotRewrite.IShapeTargetBounds"),this.$.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActivityLogger"),this.$.resolve("PowerPointWebEditor.ISlideReader"))),this.$.register(Q,"PowerPointWebEditor.CopilotRewrite.ShapeTargetBounds").as("PowerPointWebEditor.CopilotRewrite.IShapeTargetBounds").ma().na(()=>new Q),this.$.register(Nh,"PowerPointWebEditor.CopilotRewrite.RewriteSuggestionGenerator").as("PowerPointWebEditor.CopilotRewrite.IRewriteSuggestionGenerator").ma().na(()=>
new Nh(this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.$.resolve("PowerPointWebEditor.CopilotRewrite.CurrentShapeSelectionStore"))),this.$.register(Pf,"PowerPointWebEditor.CopilotRewrite.RewriteActor").ma().na(()=>new Pf(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.$.resolve("PowerPointWebEditor.CopilotRewrite.IRewriteSelectionManager"),
this.$.resolve("PowerPointWebEditor.CopilotRewrite.IRewriteSuggestionGenerator"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.$.resolve("PowerPointWebEditor.ICopilotProxy"),this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("PowerPointWebEditor.CopilotRewrite.CurrentShapeSelectionStore"),
this.$.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActivityLogger"),this.$.resolve("PowerPointWebEditor.IFocusManager"))))}else za.a.J(508883090,822,10,"PptWebEditorRewritePackage::Container object not available")}init(){this.$&&this.$.resolve("Common.IAppSettingsManager").fg(()=>{if(this.$.resolve("PowerPointWebEditor.IApplicationSettings").Txi){var tb=this.$.resolve("PowerPointWebEditor.CopilotRewrite.EditorPaneActor");tb.Hb();tb.ve()}this.mhj(this.$)&&(tb=this.$.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActor"),
tb.Hb(),tb.ve())})}dispose(){this.$.resolve("Common.IAppSettingsManager").fg(()=>{this.mhj(this.$)&&this.$.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActor").dispose()})}mhj(tb){tb=tb.resolve("PowerPointWebEditor.IApplicationSettings");return!(f.AFrameworkApplication.fD||f.AFrameworkApplication.RA)&&(tb.aMe||tb.getBooleanAppSetting("RewriteFeatureLicenseCheckEnabled")&&f.AFrameworkApplication.wAe)}static main(){h.a.instance.Fc(new yc)}}Object(c.a)(yc,"PptWebEditorRewritePackage",null,[3,4]);
var Sc=a(45);class wd{constructor(tb,Kc){if(!tb)throw Error.argumentNull("selectionManager");if(!Kc)throw Error.argumentNull("pageView");this.pa=tb;this.xb=Kc}dispose(){}get Dof(){const tb=this.pa.ud();return 1===(null===tb||void 0===tb?void 0:tb.length)?tb[0].tc(this.xb.Oa).getBounds():new Sys.UI.Bounds(0,0,0,0)}get jlb(){const tb=this.pa.ud();return 1===(null===tb||void 0===tb?void 0:tb.length)&&tb[0].Kg&&!!tb[0].HEe}get BNm(){const tb=this.pa.ud();if(1===(null===tb||void 0===tb?void 0:tb.length)&&
tb[0].Kg)return tb[0].$5c}get vAl(){return"ImageReportHostId"}bMn(){var tb;const Kc=null===(tb=this.pa.ud()[0])||void 0===tb?void 0:tb.tc(this.xb.Oa);tb=new Di.a;tb.ta.id=this.vAl;Kc.htmlElement.appendChild(tb.ta);return tb.ta}}Object(c.a)(wd,"ImageReportSelectionManager",null,[1442]);class zd{constructor(tb,Kc){this.MVb=tb;this.Fb=Kc}pwb(tb,Kc,ad){Kc=this.IRi(tb,Kc);this.showDialog(Kc,tb,ad)}showDialog(tb,Kc,ad){const id=ke=>{za.a.J(507876305,811,10,`ImageReportFeedback::showDialog - error in submitting feedback ${ke}`)},
ud=ke=>{za.a.J(507876306,811,20,`ImageReportFeedback::showDialog - feedback dialog dismissed with IsFeedbackSent=${ke} FeatureArea=${Kc}`);ad&&ad(ke,Kc)};Xf.a.eJd().then(ke=>{ke.initializeFeedbackModal(tb,ud,id);return ke})}IRi(tb,Kc){var ad={};this.Fb.Amc(ad);ad=this.MVb.getContext(ad)||{};ad.uiType="Modal";ad.showEmailAddress=!0;ad.isScreenshotEnabled=!0;ad.isScreenRecordingEnabled=!1;ad.isFileUploadEnabled=!1;ad.isShareContextDataEnabled=!0;ad.getContextData=()=>{const ud=new File([Kc],"FeedbackAsset.json",
{type:"text/json"});return new Promise(ke=>{ke([ud])})};ad.scenarioConfig={isScenarioEnabled:!0,scenarioType:"ResponsibleAI"};ad.initialFeedbackType="Frown";const id=ad.telemetryGroup||{};id.processSessionId=ad.sessionId;id.officeBuild=ad.build;id.featureArea=tb;ad.telemetryGroup=id;return ad}}Object(c.a)(zd,"ImageReportFeedback",null,[]);class Pd{constructor(tb,Kc,ad,id,ud,ke,of){this.mIj=this.xad=!1;this.onShapeSelected=()=>Object(ha.b)(this,void 0,void 0,function*(){this.xad&&(yield this.urf());
this.H1d.jlb&&(yield this.U4l())});this.tta=()=>Object(ha.b)(this,void 0,void 0,function*(){this.xad&&(yield this.urf())});this.QH=(Yf,If)=>Object(ha.b)(this,void 0,void 0,function*(){If&&If.gD&&(this.H1d.jlb?this.xad||(yield this.onShapeSelected(Yf,If)):yield this.tta(Yf,If))});this.wAl=(Yf,If)=>Object(ha.b)(this,void 0,void 0,function*(){If.ipe?this.H1d.jlb&&(yield this.U4l()):yield this.urf()});this.xo=()=>Object(ha.b)(this,void 0,void 0,function*(){this.xad&&(yield this.urf())});this.d_=Yf=>Object(ha.b)(this,
void 0,void 0,function*(){(this.uza=Yf)&&this.xad&&(yield this.urf())});this.nqn=()=>Object(ha.b)(this,void 0,void 0,function*(){if(this.oJl)try{this.oJl.pwb("Image Report",this.H1d.BNm,null)}catch(Yf){za.a.J(507876304,817,10,`PPTWebEditorImageReportPackage:onImageReportClickHandler Exception occurred trying to show feedback dialog. ${JSON.stringify(Yf)}`)}});this.hzg=()=>Object(ha.b)(this,void 0,void 0,function*(){this.mIj=!0});if(!tb)throw Error.argumentNull("graphOperationEventSource");if(!Kc)throw Error.argumentNull("imageReportSelectionManager");
if(!ad)throw Error.argumentNull("pptSelectionManager");if(!id)throw Error.argumentNull("customerFeedbackUiWrapper");if(!ud)throw Error.argumentNull("appFrame");if(!ke)throw Error.argumentNull("viewEventNotifier");if(!of)throw Error.argumentNull("coreEventHandler");this.Io=tb;this.H1d=Kc;this.ob=ad;this.oJl=new zd(id,f.AFrameworkApplication.ga);this.Db=ud;this.Ge=ke;this.od=of}Hb(){this.Io.d$b(this.onShapeSelected);this.Io.I4c(this.tta);this.ob.QM(this.QH);f.AFrameworkApplication.Ea.YW(this.xo);this.Db.pSa(this.d_);
this.Ge.pfl(this.wAl);this.od.$td(this.tta);this.od.sE(this.tta)}ve(){}dispose(){this.Io.BLe(this.onShapeSelected);this.Io.yuh(this.tta);this.ob.Bbb(this.QH);f.AFrameworkApplication.Ea.vka(this.xo);this.Db.UCb(this.d_);this.Ge.sZl(this.wAl);this.od.QKg(this.tta);this.od.F8(this.tta)}U4l(){return Object(ha.b)(this,void 0,void 0,function*(){if(!this.xad&&!this.uza&&this.mIj){this.xad=!0;var tb={onImageReport:this.nqn,getTargetRect:this.H1d.Dof,buttonExpanded:!1};imageReport.renderReportImageUI(this.Uen=
this.H1d.bMn(),tb)}})}urf(){var tb;return Object(ha.b)(this,void 0,void 0,function*(){this.xad=!1;this.mIj&&imageReport.disposeReportImageUI(this.Uen);null===(tb=document.getElementById(this.H1d.vAl))||void 0===tb?void 0:tb.remove()})}}Object(c.a)(Pd,"ImageReportActor",null,[743]);class Je{constructor(){this.$=null}get name(){return"PowerPointWebEditor.ImageReport"}lc(tb){tb?this.R4m(tb)&&(this.$=tb,this.$.register(wd,"PowerPointWebEditor.ImageReport.ImageReportSelectionManager").as("PowerPointWebEditor.ImageReport.IImageReportSelectionManager").ma().na(()=>
new wd(this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"))),this.$.register(Pd,"PowerPointWebEditor.ImageReport.ImageReportActor").ma().na(()=>new Pd(this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.$.resolve("PowerPointWebEditor.ImageReport.IImageReportSelectionManager"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),
this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"))),this.l9m()):za.a.J(507876303,822,10,"PptWebEditorImageReport::Container object not available")}init(){this.$&&this.$.resolve("Common.IAppSettingsManager").fg(()=>{const tb=this.$.resolve("PowerPointWebEditor.ImageReport.ImageReportActor");tb.Hb();tb.ve()})}dispose(){this.$&&this.$.resolve("Common.IAppSettingsManager").fg(()=>{this.$.resolve("PowerPointWebEditor.ImageReport.ImageReportActor").dispose()})}l9m(){Object(ha.b)(this,
void 0,void 0,function*(){Sc.a.get_instance().$i(7,()=>Object(ha.b)(this,void 0,void 0,function*(){const tb=tg.a(this.$);yield tb("imageReport");tb("imageReport").then(()=>{this.$.resolve("PowerPointWebEditor.ImageReport.ImageReportActor").hzg()}).catch(Kc=>{za.a.J(507876302,817,10,`PPTWebEditorImageReportPackage:loadScript Exception while loading imageReport ${JSON.stringify(Kc)}`)})}))})}R4m(tb){return tb.resolve("PowerPointWebEditor.IApplicationSettings").getBooleanAppSetting("ImageReportEnabled")&&
f.AFrameworkApplication.wAe}static main(){h.a.instance.Fc(new Je)}}Object(c.a)(Je,"PptWebEditorImageReportPackage",null,[3,4]);var ge=a(154);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.ContentUpdateDetection");Type.registerNamespace("PowerPointWebEditor.EditorPane");Type.registerNamespace("PowerPointWebEditor.EditorPane.MessageProcessing");Type.registerNamespace("PowerPointWebEditor.EditorPane.Messaging");
Type.registerNamespace("PowerPointWebEditor.EditorPane.Model");Type.registerNamespace("PowerPointWebEditor.EditorPane.Subscription");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.EditorPaneV2");Type.registerNamespace("PowerPointWebEditor.TextPrediction");Object(ge.c)("AugLoop");Ld.main();Le.main();sg.main();Kj.main();yc.main();Je.main();Object(ge.b)("AugLoop")},346:function(x,G,a){a.r(G);a.d(G,"AnnotationState",function(){return c});a.d(G,"OperationErrorCode",
function(){return h});a.d(G,"ItemOperation",function(){return f});a.d(G,"ItemChanges",function(){return e});a.d(G,"EntryPoint",function(){return b});a.d(G,"ecsMetadataBlockHeight",function(){return 512});a.d(G,"ecsMetadataBlockWidth",function(){return 32});a.d(G,"BlobRefType",function(){return u});a.d(G,"OpenType",function(){return m});a.d(G,"GridConstants",function(){return n});a.d(G,"Annotation",function(){return r});a.d(G,"BinaryClassificationAnnotation",function(){return w});a.d(G,"Event",function(){return y});
a.d(G,"UserCommand",function(){return z});a.d(G,"ItemDelta",function(){return A.f});a.d(G,"ItemChangesDelta",function(){return A.e});a.d(G,"Operation",function(){return A.i});a.d(G,"OperationWithSiblingContext",function(){return A.j});a.d(G,"AddOperation",function(){return A.a});a.d(G,"MoveOperation",function(){return A.h});a.d(G,"UpdateAnnotationMetaDataOperation",function(){return A.n});a.d(G,"UpdateOperation",function(){return A.o});a.d(G,"DeleteOperation",function(){return A.b});a.d(G,"PurgeOperation",
function(){return A.k});a.d(G,"PurgeSubtreeOperation",function(){return A.l});a.d(G,"FocusOperation",function(){return A.d});a.d(G,"VisibilityOperation",function(){return A.p});a.d(G,"DeltaUpdateOperation",function(){return A.c});a.d(G,"MicroSyncOperation",function(){return A.g});a.d(G,"SignalOperation",function(){return A.m});a.d(G,"SchemaObject",function(){return l.a});a.d(G,"Signal",function(){return B});a.d(G,"DirtyAreaSignal",function(){return H});a.d(G,"Blob",function(){return v});a.d(G,"Binary",
function(){return C});a.d(G,"TileGroup",function(){return F});a.d(G,"Session",function(){return D});a.d(G,"Document",function(){return N});a.d(G,"SubDocument",function(){return U});a.d(G,"GridCell",function(){return W});a.d(G,"GridNeighborhoodContext",function(){return L});a.d(G,"ItemFilter",function(){return O});a.d(G,"DynamicContext",function(){return M});a.d(G,"ContextHolder",function(){return K});a.d(G,"UserContextHolder",function(){return P});a.d(G,"TenantContextHolder",function(){return V});
a.d(G,"EventsHolder",function(){return Y});a.d(G,"UserCommandsHolder",function(){return ta});var c;(function(fa){fa[fa.Undefined=0]="Undefined";fa[fa.Created=10]="Created";fa[fa.Sent=20]="Sent";fa[fa.Duplicated=30]="Duplicated";fa[fa.Seen=40]="Seen";fa[fa.Tried=50]="Tried";fa[fa.Kept=60]="Kept";fa[fa.Rejected=70]="Rejected"})(c||(c={}));var b;(function(fa){fa.Canvas="Canvas";fa.CopilotChat="CopilotChat";fa.Test="Test"})(b||(b={}));var f;(function(fa){fa[fa.None=0]="None";fa[fa.Added=1]="Added";fa[fa.Updated=
2]="Updated";fa[fa.Deleted=3]="Deleted"})(f||(f={}));var e;(function(fa){fa[fa.ContentChanged=0]="ContentChanged";fa[fa.ContentWasEmpty=1]="ContentWasEmpty";fa[fa.FormattingChanged=2]="FormattingChanged";fa[fa.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"})(e||(e={}));var h;(function(fa){fa[fa.AddOfZeroElements=0]="AddOfZeroElements";fa[fa.AddOfItemsWithExtraOrMissingIds=1]="AddOfItemsWithExtraOrMissingIds";fa[fa.AddOfItemWithUndefinedId=2]="AddOfItemWithUndefinedId";fa[fa.AddOfUndefinedItem=
3]="AddOfUndefinedItem";fa[fa.AddOfItemsWithDuplicateIds=4]="AddOfItemsWithDuplicateIds";fa[fa.SetHeadToNonExistingItem=5]="SetHeadToNonExistingItem";fa[fa.DeleteOfNonExistingItem=6]="DeleteOfNonExistingItem";fa[fa.UpdateOfNonExistentItem=7]="UpdateOfNonExistentItem";fa[fa.UpdateOfStubbedItem=8]="UpdateOfStubbedItem";fa[fa.MoveOfNonExistentItem=9]="MoveOfNonExistentItem";fa[fa.UpdateMetaDataOfNonAnnotationType=10]="UpdateMetaDataOfNonAnnotationType";fa[fa.SequentialyInvertedUpdate=11]="SequentialyInvertedUpdate";
fa[fa.DeltaOfNonExistingItem=100]="DeltaOfNonExistingItem"})(h||(h={}));var u;(function(fa){fa[fa.None=0]="None";fa[fa.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl";fa[fa.AlCodedLocation=2]="AlCodedLocation";fa[fa.Token=3]="Token"})(u||(u={}));var m;(function(fa){fa[fa.NewDocument=0]="NewDocument";fa[fa.EditDocument=1]="EditDocument";fa[fa.ViewOnlyDocument=2]="ViewOnlyDocument"})(m||(m={}));class n{}n.lowerIndexBound=1;n.maxNumberOfRows=1048576;n.maxNumberOfColumns=16384;n.firstColumnName="A";n.lastColumnName=
"XFD";var l=a(364);class r{get metadata(){return this.M_}set metadata(fa){this.M_=fa}constructor(fa){l.a.assign(r,this,fa)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class w{get metadata(){return this.M_}set metadata(fa){this.M_=fa}constructor(fa){l.a.assign(w,this,fa)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,
[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class y{constructor(fa){l.a.assign(y,this,fa)}static getTypeName(){return"AugLoop_Core_Event"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class z{constructor(fa){l.a.assign(z,this,fa)}static getTypeName(){return"AugLoop_Core_UserCommand"}static getBaseTypes(){return["AugLoop_Core_Event"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,
[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};var A=a(566);class B{constructor(fa){l.a.assign(B,this,fa)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class H{constructor(fa){l.a.assign(H,this,fa)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,
[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class v{constructor(fa){l.a.assign(v,this,fa)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class C{constructor(fa){l.a.assign(C,this,fa)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[C.getTypeName()])}}
C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class F{constructor(fa){l.a.assign(F,this,fa)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class D{constructor(fa){l.a.assign(D,this,fa)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[D.getTypeName()])}}
D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class N{constructor(fa){l.a.assign(N,this,fa)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class U{constructor(fa){l.a.assign(U,this,fa)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[U.getTypeName()])}}
U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class W{constructor(fa){l.a.assign(W,this,fa)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class L{constructor(fa){l.a.assign(L,this,fa)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[L.getTypeName()])}}
L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class O{constructor(fa){l.a.assign(O,this,fa)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class M{constructor(fa){l.a.assign(M,this,fa)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[M.getTypeName()])}}M.H_=
{T_:M.getTypeName(),B_:M.getBaseTypes()};class K{constructor(fa){l.a.assign(K,this,fa)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class P{constructor(fa){l.a.assign(P,this,fa)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,
[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class V{constructor(fa){l.a.assign(V,this,fa)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class Y{constructor(fa){l.a.assign(Y,this,fa)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(fa){return l.a.matchesTypesFor(fa,
[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class ta{constructor(fa){l.a.assign(ta,this,fa)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(fa){return l.a.matchesTypesFor(fa,[ta.getTypeName()])}}ta.H_={T_:ta.getTypeName(),B_:ta.getBaseTypes()}},490:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.tda=this.IX=this.oN=null;this.S0a=this.Vqa=!1;this.tsb=0;this.hc=
null;this.oya=this.vSb=this.nya=!1;this.eya=!0;this.reset()}reset(){this.IX=[];this.oN=null;this.tda=[];this.S0a=this.Vqa=!1;this.tsb=0;this.hc=null;this.oya=this.vSb=this.nya=!1;this.eya=!0}}Object(x.a)(c,"HtmlPasteContext",null,[])},566:function(x,G,a){a.d(G,"f",function(){return b});a.d(G,"e",function(){return f});a.d(G,"i",function(){return e});a.d(G,"j",function(){return h});a.d(G,"a",function(){return u});a.d(G,"h",function(){return m});a.d(G,"n",function(){return n});a.d(G,"o",function(){return l});
a.d(G,"b",function(){return r});a.d(G,"k",function(){return w});a.d(G,"l",function(){return y});a.d(G,"d",function(){return z});a.d(G,"p",function(){return A});a.d(G,"c",function(){return B});a.d(G,"g",function(){return H});a.d(G,"m",function(){return v});var c=a(364);class b{constructor(C){c.a.assign(b,this,C)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(C){return c.a.matchesTypesFor(C,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};
class f{constructor(C){c.a.assign(f,this,C)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(C){return c.a.matchesTypesFor(C,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class e{constructor(C){c.a.assign(e,this,C)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(C){return c.a.matchesTypesFor(C,[e.getTypeName()])}}e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};
class h{constructor(C){c.a.assign(h,this,C)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class u{constructor(C){c.a.assign(u,this,C)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,
[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class m{constructor(C){c.a.assign(m,this,C)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class n{constructor(C){c.a.assign(n,this,C)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,
[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class l{constructor(C){c.a.assign(l,this,C)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class r{constructor(C){c.a.assign(r,this,C)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,
[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class w{constructor(C){c.a.assign(w,this,C)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class y{constructor(C){c.a.assign(y,this,C)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,
[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class z{constructor(C){c.a.assign(z,this,C)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class A{constructor(C){c.a.assign(A,this,C)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,
[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class B{constructor(C){c.a.assign(B,this,C)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class H{constructor(C){c.a.assign(H,this,C)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,
[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class v{constructor(C){c.a.assign(v,this,C)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return c.a.matchesTypesFor(C,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.augloop.js.map