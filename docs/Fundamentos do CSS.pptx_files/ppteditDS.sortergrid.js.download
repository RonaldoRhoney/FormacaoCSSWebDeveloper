'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1690:function(x,G,a){a.r(G);x=a(0);var c=a(17),b=a(73),f=a(4),e=a(118),h=a(13),u=a(3),m=a(139),n=a(62),l=a(28),r=a(7),w=a(40),y=a(250),z=a(257),A=a(309),B=a(278),H=a(467),v=a(248),C=a(1191),F=a(283),D=a(336),N=a(284),U=a(251);class W{constructor(O,M,K,P,V,Y){this.snh=this.Xnh=this.Ynh=this.gad=this.taa=this.wab=this.YJ=null;this.Rm=this.dIc=!1;this.Hf=null;this.pab=-1;this.PGe=this.TGe=!1;this.lbg=this.Boh=
0;this.Nph=this.enh=this.Nmh=-1;this.Aab=this.Poa=0;this.xab=!0;this.pFc=0;this.jGe=null;this.Gf=O;this.u8=M;this.ia=K;this.vd=P;this.Tm=V;this.uad=!1;this.Qca=null;this.dN=Y;this.ebn=f.AFrameworkApplication.ga.Jc("PPTCloseGridViewTimeoutMs",500);this.OHl=f.AFrameworkApplication.ga.Jc("PPTGridViewDisplayNoneTimeoutMs",800);this.fcn=f.AFrameworkApplication.ga.Jc("PPTGridViewTransitionTimeoutMs",500);this.b1d=[];this.fMl=f.AFrameworkApplication.ga.appSettings[N.a.nBa]}Hb(){this.ia.za(U.a.Voe,z.a.application,
Object(w.a)(this,this.Voe,"showGridView"));this.ia.za(U.a.j_g,z.a.application,Object(w.a)(this,this.j_g,"toggleGridView"));this.vd.OJb(Object(w.a)(this,this.dCb,"onSlideshowExitHandler"))}Voe(O,M,K){return 2===K?this.nIk():32}nIk(){try{const O=(new Date).getTime();v.a.J(512308959,822,15,"ShowGridView: Open grid view.");this.GOe(this.Nmh);this.Nmh=-1;this.GOe(this.enh);this.enh=-1;this.GOe(this.Nph);this.Nph=-1;this.uad=!0;this.dIc=this.TGe=this.PGe=!1;const M=this.Tm.DJ();if(!M)return v.a.J(512308958,
822,10,"ShowGridView: slideOrder is null."),this.Vvi(),8;v.a.J(512308957,822,15,"ShowGridView: slideOrder length: {0}.",M.length);this.Tm.duh();this.vd.naf(Object(w.a)(this,this.Ncc,"onGetCurrentPositionHandler"));this.xab=!0;const K=this.Tm.aDe();!this.jGe||K.width===this.jGe.width&&K.height===this.jGe.height||(v.a.J(512308956,822,50,"ShowGridView: thumbnailSize updated, new width: {0}, new height: {1}, old width: {2}, old height: {3}",K.width,K.height,this.jGe.width,this.jGe.height),this.Vvi());
if(this.YJ&&this.YJ.ta){this.YJ.J4b("pptonline-slideshow-grid-view-transition-class");this.YJ.ta.style.display=F.a.Wm;this.YJ.ta.style.opacity="1";this.Poa=Date.now();this.Hf.events.onSlideSelectionChanged.subscribe(Object(w.a)(this,this.vpe,"slideSelectionChangeHandler"));this.Hf.events.onVisibleSlideRangeChanged.subscribe(Object(w.a)(this,this.lve,"visibleSlideRangeChangedHandler"));const V=this.u8.rKb(M,this.Tm.v$a());this.AXh(V);this.Hf.slideDataList=V;this.Hf.sectionDataList=this.u8.Lnc(V)}else{this.bBm();
h.a.addHandler(this.YJ.ta,u.a.Lj,Object(w.a)(this,this.bL,"keyDownHandler"));this.dN.OZa&&!this.Qca&&(this.Qca=Object(w.a)(this,this.xKm,"fullScreenChangeHandler"),$addHandler(this.Gf,this.dN.OZa,this.Qca));const V=this.u8.rKb(M,this.Tm.v$a()),Y=this.u8.Lnc(V);this.jGe=K;const ta=this.qrm(K);if(!this.Hf){const fa=new C.a;fa.throttleTimeoutInMs=1E3;fa.debounceWaitTimeInMs=200;fa.allowMultipleSelect=!1;fa.allowSectionsInKeyboardFocusOrdering=!0;fa.slideWidth=ta.width;fa.slideHeight=ta.height;fa.enableSelectionBetweenSlides=
!1;fa.isRTL=f.AFrameworkApplication.isRtl;fa.disabledChangeGates=f.AFrameworkApplication.ga.La("PPTDisabledChangeGates");y.a("LogSlideGridSubscribedEventCount")&&(fa.logger=new m.a);this.Hf=SlideGrid.SlideGridFactory.CreateSlideGrid(fa,this.Ynh)}this.Poa=Date.now();this.Hf.events.onSlideSelectionChanged.subscribe(Object(w.a)(this,this.vpe,"slideSelectionChangeHandler"));this.Hf.events.onVisibleSlideRangeChanged.subscribe(Object(w.a)(this,this.lve,"visibleSlideRangeChangedHandler"));this.Hf.show([0],
0,V,Y);h.a.addHandler(this.YJ.ta,u.a.focus,Object(w.a)(this,this.gqn,"onGridViewContainerDivFocus"))}this.vd.pul();if(this.fMl)this.ia.Qa(U.a.e8i,2,null);else{const V=document.getElementById("slideshow-toolbar");V&&(V.style.display=F.a.Sf)}const P=document.getElementById("LiveURLBarLayerHost");P&&(P.style.display=F.a.Sf);this.YJ.J4b("pptonline-slideshow-grid-view-transition-class");this.YJ.ta.style.display=F.a.Wm;this.YJ.ta.style.opacity="1";this.qLb(null);n.FocusManager.UA(this.YJ.ta);this.s1g(!1);
this.Tm.Rah(Object(w.a)(this,this.Sbd,"onDataStoreUpdated"));this.vd.OUc(Object(w.a)(this,this.wNe,"slideChangedHandler"));v.a.J(512308955,822,50,"GridViewActor: time taken for ShowGridViewImpl: {0}.",(new Date).getTime()-O);return 32}catch(O){return v.a.J(512308954,822,10,"GridViewActor: Exception in ShowGridView: {0}.",O),this.QPn(),8}}j_g(O,M,K){try{if(2===K)if(v.a.J(512308953,822,15,"ToggleGridView called."),this.uad)this.s1g(!0),this.Gpc(!1);else return this.nIk();return 32}catch(P){return v.a.J(512308952,
822,10,"GridViewActor: Exception in ToggleGridView: {0}.",P),8}}qrm(O){const M=new A.a(0,0);O.height&&O.width?(O=O.width/O.height,1<=O?(M.width=247,M.height=247/O):(M.height=247,M.width=247*O)):(M.width=247,M.height=247/1.76);return M}Ncc(O,M){try{this.vd.Sje(Object(w.a)(this,this.Ncc,"onGetCurrentPositionHandler")),this.pab=M.slideIndex,this.vd.Oxl(this.pab,M.tfd)}catch(K){v.a.J(512308951,822,10,"Exception in GoToSlideWithTimeLines: {0}.",K)}try{this.YJ&&(this.YJ.ta.style.display=F.a.Wm);this.YJ&&
n.FocusManager.UA(this.YJ.ta);this.pFc=0;const K=this.Tm.DJ();if(K){const P=this.u8.rKb(K,this.Tm.v$a());this.AXh(P);const V=this.u8.Lnc(P);this.Hf.show([this.pab],this.pab,P,V)}}catch(K){v.a.J(512308950,822,10,"Exception in OnGetCurrentPositionHandler: {0}.",K)}}wNe(O,M){try{if(this.TGe&&M){const K=M.slideIndex;this.pab!==K||0>this.pab?v.a.J(512308949,822,15,"GridViewActor-SlideChangedHandler: currentSelectedSlideIndex not equal to slideIndex in args. currentSelectedSlideIndex: {0}, slideIndex: {1}.",
this.pab,K):(this.vd.OUc(Object(w.a)(this,this.wNe,"slideChangedHandler")),this.vd.C8c(K),this.lbg=Date.now(),this.PFl(),this.Gpc(!0),this.TGe=!1)}}catch(K){v.a.J(512308948,822,10,"Exception in SlideChangedHandler: {0}.",K)}}gqn(){this.Hf&&this.Hf.restoreFocusToGrid()}bL(O){try{if(O.keyCode===l.a.tgd)this.fAe(null);else if(O.keyCode===l.a.hv){const M=this.b1d?this.b1d[this.pFc]:null;!M||M.className!==this.Xnh.className&&M.className!==this.snh.className||this.fAe(null)}else if(O.keyCode===l.a.gyb&&
!this.dN.A0a)this.uad&&(this.vd.exit(),this.Gpc(!1));else if(O.keyCode===l.a.vu)O.preventDefault(),O.stopPropagation();else if(O.keyCode===l.a.FK)this.Hf.activeFocusSlideIndex=0;else if(O.keyCode===l.a.wz){const M=this.Tm.DJ();M&&0<M.length&&(this.Hf.activeFocusSlideIndex=M.length-1)}O.ctrlKey&&O.keyCode===l.a.zda&&((this.pFc=O.shiftKey?Math.abs((this.pFc-1)%this.b1d.length):(this.pFc+1)%this.b1d.length)?0<this.pFc?n.FocusManager.UA(this.b1d[this.pFc]):v.a.J(512308947,822,15,"GridViewActor: wrong focus index value: {0}.",
this.pFc):this.Hf.restoreFocusToGrid())}catch(M){v.a.J(512308946,822,10,"GridViewActor: Exception in KeyDownHandler : {0}.",M)}}Sbd(O,M){try{const P=this.Tm.DJ();if(P){var K=this.u8.rKb(P,this.Tm.v$a());this.AXh(K);this.Hf.slideDataList=K;this.Hf.sectionDataList=this.u8.Lnc(K);if(M.SlideIndex){const V=M.SlideIndex;-1!==V&&(0<=V&&V<P.length?this.qLb(P[V]):v.a.J(512308944,822,10,"OnDataStoreUpdated: slideIndex is invalid: {0}.",V))}else v.a.J(512308943,822,10,"OnDataStoreUpdated: SlideIndex is null from eventData.")}else v.a.J(512308945,
822,10,"OnDataStoreUpdated: slideOrder is null.")}catch(P){v.a.J(512308942,822,10,"Exception in OnDataStoreUpdated: {0}.",P)}}qLb(O){try{const M=this.Hf.visibleSlideRange;let K=!1;if(O)for(const P of M){if(P.slideSid===O.sid){K=!0;break}}else K=!0;if(K){O=!0;for(const P of M)for(const V of this.Hf.slideDataList)if(V.slideID.slideSid===P.slideSid&&V.slideID.slideCid===P.slideCid&&!V.thumbnailImage){O=!1;break}O&&0<this.Poa&&(this.Aab=Date.now(),v.a.J(512308941,822,15,"VisibleSlideRangePLT - firstVisibleRangePLTCalc: {0}, visibleSlideLength: {1}, startTime: {2}, endTime: {3}, elapse: {4}.",
this.xab,M.length,this.Poa,this.Aab,this.Aab-this.Poa),this.xab&&(this.xab=!1),this.Aab=this.Poa=0)}}catch(M){v.a.J(512308940,822,10,"Exception in CheckAndLogVisibleSlideRangePLT: {0}.",M)}}vpe(O,M){try{this.Boh=Date.now();const V=M.slideIndex;v.a.J(512308939,822,15,"GridViewActor: SlideSelectionChangeHandler - targetSlideIndex: {0}.",V);if(0>this.pab)v.a.J(512308938,822,10,"GridViewActor-SlideSelectionChangeHandler: wrong currentSelectedSlideIndex: {0}.",this.pab);else{var K=this.Tm.DJ();if(!K||
0>=K.length)v.a.J(512308937,822,10,"GridViewActor-SlideSelectionChangeHandler: wrong slideOrder.");else{var P=this.pab===K.length-1;this.pab!==V||P?(this.vd.$9b(Object(w.a)(this,this.wNe,"slideChangedHandler")),this.pab=V,this.TGe=!0,this.s1g(!0),0<=V&&this.vd.C8c(V),this.GOe(this.Nmh),this.Nmh=window.setTimeout(()=>{try{this.uad&&this.TGe&&this.Gpc(!0)}catch(Y){v.a.J(512308935,822,10,"GridViewActor: Exception in closeGridViewTimeoutHandler: {0}.",Y)}},this.ebn)):(v.a.J(512308936,822,15,"GridViewActor: SlideSelectionChangeHandler - targetSlideIndex is the same to currentSelectedSlideIndex: {0}",
this.pab),this.TGe||(this.s1g(!0),this.lbg=Date.now(),this.PFl(),this.Gpc(!0)))}}}catch(V){v.a.J(512308934,822,10,"GridViewActor: Exception in SlideSelectionChangeHandler: {0}.",V)}}s1g(O){this.vd?(this.vd.xfd(O),O&&!this.dIc&&(r.a.ul||document.activeElement.blur(),this.vd.jda())):v.a.J(512308933,822,10,"GridViewActor: m_frame is null in TryToggleSlideShowFrame.")}lve(){try{this.Poa=Date.now();this.qLb(null);const O=this.Hf.visibleSlideRange,M=[];for(const K of O)M.push(new B.a(Object.assign(new H.a,
{Cid:K.slideCid,Sid:K.slideSid})));this.Tm.VLe(M)}catch(O){v.a.J(512308932,822,10,"GridViewActor: Exception in VisibleSlideRangeChangedHandler: {0}.",O)}}AXh(O){if(O)for(const M of O)M.slideAriaLabel=M.slideTitle,M.isHiddenSlide&&(M.slideAriaLabel+=", "+ResourceStrings.l_SlideIsHidden),M.slideAriaLabel+=" "+ResourceStrings.l_GridView_GridThumbnailTitle}bBm(){this.YJ=new D.a;this.b1d.push(this.YJ.ta);this.Ynh=document.createElement("div");this.YJ.ta.appendChild(this.Ynh);this.YJ.ta.setAttribute("tabindex",
"0");this.YJ.ta.setAttribute("aria-label",ResourceStrings.L_GridView_GridContainerTitle);this.Xnh||(this.Xnh=this.wml());this.YJ.ta.appendChild(this.Xnh);this.YJ.ta.id="pptonline-slideshow-grid-view-id";this.YJ.ta.className="pptonline-slideshow-grid-view-class";this.Ynh.className="pptonline-slideshow-grid-view-inner-container-class";this.Gf.appendChild(this.YJ.ta);this.YJ.ta.style.width="100%";this.YJ.ta.style.height="100%";this.YJ.J4b("pptonline-slideshow-grid-view-transition-class");this.YJ.ta.style.display=
F.a.Wm;this.YJ.ta.style.opacity="1"}wml(){const O=document.createElement("div");this.b1d.push(O);var M=f.AFrameworkApplication.isRtl;O.setAttribute("role","button");O.className=M?"pptonline-slideshow-grid-view-close-button-class rtl-ui":"pptonline-slideshow-grid-view-close-button-class";O.setAttribute("tabindex","0");M=document.createElement("i");M.className="ms-Icon ms-Icon--Back";O.appendChild(M);O.title=ResourceStrings.L_GridView_CloseButtonNewText;O.setAttribute("aria-label",ResourceStrings.L_GridView_CloseButtonNewText);
h.a.addHandler(O,u.a.click,Object(w.a)(this,this.fAe,"closeButtonClickHandler"));return O}Gpc(O){try{if(v.a.J(512308931,822,50,"GridViewActor: CloseGridView called."),this.PGe)v.a.J(512308930,822,15,"GridViewActor: GridView is in closing status.");else if(this.YJ){this.PGe=!0;this.Tm.qzh();this.Tm.MYl(Object(w.a)(this,this.Sbd,"onDataStoreUpdated"));this.YJ.Zv("pptonline-slideshow-grid-view-transition-class");this.wab&&(this.wab.ta.style.display=F.a.Sf);O?(this.GOe(this.Nph),this.GOe(this.enh),this.Nph=
window.setTimeout(()=>{try{this.YJ.ta.style.opacity="0",this.uad=!1}catch(K){v.a.J(512308929,822,10,"Exception in setZeroOpacityHandler: {0}.",K)}},this.OHl-this.fcn),this.enh=window.setTimeout(()=>{try{this.PGe=!1,this.YJ.ta.style.display=F.a.Sf}catch(K){v.a.J(512308928,822,10,"Exception in displayNoneTimeoutHandler: {0}.",K)}},this.OHl)):(this.YJ.ta.style.opacity="0",this.PGe=this.uad=!1,this.YJ.ta.style.display=F.a.Sf);this.Hf&&(this.Hf.events.onSlideSelectionChanged.unsubscribe(Object(w.a)(this,
this.vpe,"slideSelectionChangeHandler")),this.Hf.events.onVisibleSlideRangeChanged.unsubscribe(Object(w.a)(this,this.lve,"visibleSlideRangeChangedHandler")));this.fMl&&this.ia.Qa(U.a.kIk,2,null);var M=document.getElementById("LiveURLBarLayerHost");M&&(M.style.display=F.a.Wm)}}catch(K){v.a.J(512308899,822,10,"GridViewActor: Exception in CloseGridView: {0}.",K),this.PGe=!1}}QPn(){try{if(!this.wab){this.wab=new D.a;this.taa=new D.a;this.snh||(this.snh=this.wml());this.wab.ta.appendChild(this.snh);this.wab.ta.appendChild(this.taa.ta);
this.taa.Zv("pptonline-slideshow-grid-view-error-ui-inner");const O=document.createElement("div"),M=document.createElement("span");M.innerText=ResourceStrings.L_GridView_TryAgainError;O.setAttribute("tabindex","0");O.className="pptonline-slideshow-grid-view-error-ui-message";O.appendChild(M);this.taa.ta.appendChild(O);const K=document.createElement("div"),P=document.createElement("span");P.innerText=ResourceStrings.L_GridView_TryAgainButton;K.setAttribute("tabindex","0");K.className="pptonline-slideshow-grid-view-try-again-button";
K.appendChild(P);this.taa.ta.appendChild(K);h.a.addHandler(K,u.a.click,Object(w.a)(this,this.k0g,"tryAgainButtonClickHandler"));if(this.Gf)this.Gf.appendChild(this.wab.ta);else{this.wab=null;return}this.wab.ta.setAttribute("tabindex","0");this.wab.Zv("pptonline-slideshow-grid-view-error-ui-class");this.wab.Zv("pptonline-slideshow-grid-view-class")}this.taa.ta.style.display=F.a.Wm;this.wab.ta.style.display="flex";h.a.addHandler(this.YJ.ta,u.a.Lj,Object(w.a)(this,this.bL,"keyDownHandler"));n.FocusManager.UA(this.YJ.ta)}catch(O){v.a.J(512308898,
822,10,"Exception in ShowGridViewErrorUI: {0}.",O)}}showLoadingSpinner(){if(!this.gad){this.gad=new D.a;this.gad.Zv("grid-view-spinner-class");const O=document.createElement("div");O.className="grid-view-spinner-inner-class";this.gad.ta.appendChild(O);if(this.Gf)this.Gf.appendChild(this.gad.ta);else{this.gad=null;return}}this.gad.ta.style.display="flex"}k0g(){try{this.showLoadingSpinner(),this.taa.ta.style.display=F.a.Sf,window.setTimeout(()=>{this.wab&&(this.wab.ta.style.display=F.a.Sf);this.gad.ta.style.display=
F.a.Sf;this.nIk()},1E3)}catch(O){v.a.J(512308897,822,10,"Exception in TryAgainButtonClickHandler: {0}.",O)}}GOe(O){0<=O&&window.clearTimeout(O)}dCb(){try{this.dIc=!0,this.vd.TCb(Object(w.a)(this,this.dCb,"onSlideshowExitHandler")),this.uad&&this.Gpc(!1)}catch(O){v.a.J(512308896,822,10,"GridViewActor: Exception in OnSlideshowExitHandler: {0}.",O)}}xKm(){try{this.uad&&this.Gpc(!1)}catch(O){v.a.J(512308895,822,10,"GridViewActor: Exception in FullScreenChangeHandler: {0}.",O)}}fAe(){try{this.s1g(!0),
this.Gpc(!1)}catch(O){v.a.J(512308894,822,10,"GridViewActor: Exception in CloseButtonClickHandler: {0}.",O)}}PFl(){v.a.J(512308893,822,15,"GridViewActor: selectedSlideIndex: {0}, selectedTime: {1}, showTime: {2}, elapse: {3}",this.pab,this.Boh,this.lbg,this.lbg-this.Boh);this.lbg=this.Boh=0}dispose(){try{this.Rm||(this.Rm=!0,this.Gpc(!1),this.vd.TCb(Object(w.a)(this,this.dCb,"onSlideshowExitHandler")),this.dN.OZa&&this.Qca&&$removeHandler(this.Gf,this.dN.OZa,this.Qca),this.Vvi())}catch(O){v.a.J(512308892,
822,10,"GridViewActor: Exception in Dispose: {0}.",O)}}Vvi(){v.a.J(512308891,822,50,"GridViewActor: DisposeSlideGridComponentIfExist.");this.YJ&&(h.a.removeHandler(this.YJ.ta,u.a.Lj,Object(w.a)(this,this.bL,"keyDownHandler")),this.Gf.removeChild(this.YJ.ta),this.YJ=null);this.Hf&&(this.Hf=null)}}Object(x.a)(W,"GridViewActor",null,[1307,24]);class L{constructor(){this.$=null}get name(){return"PowerPointWebEditor.SorterGrid"}lc(O){this.$=O}init(){b.a.instance&&b.a.instance.kc("SlideGridPackageLoaded",
Date.now());this.i2m()}i2m(){try{c.ULS.sendTraceTag(512254412,202,50,"SorterGrid:Init - Grid component package");const O=b.a.instance;O&&O.kc("SorterGridFullAppSettingsReady",Date.now());this.zzd()}catch(O){c.ULS.sendTraceTag(512254411,811,10,"PPTWebEditorSorterGridPackage: exception in OnFullAppSettingsReady: {0}",O)}}zzd(){const O=(new Date).getTime(),M=this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame").sP();this.$.register(W,"PowerPointWebEditor.GridViewActor").na(()=>new W(M,this.$.resolve("PowerPointWebEditor.ISlideGridHelper"),
f.AFrameworkApplication.vb,this.$.resolve("PowerPointWebEditor.ISlideshowFrame"),this.$.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),this.$.resolve("PowerPointWebEditor.IFullscreenHelper"))).ma();this.$.resolve("PowerPointWebEditor.GridViewActor").Hb();c.ULS.sendTraceTag(512254409,811,50,"PPTWebEditorSorterGridPackage: Time Taken to create and Register SorterGrid Objects: {0}",(new Date).getTime()-O)}dispose(){try{const O=this.$.yb("PowerPointWebEditor.IThumbnailDataStoreManager"),M=
this.$.yb("PowerPointWebEditor.GridViewActor");O&&O.dispose();M&&M.dispose()}catch(O){c.ULS.sendTraceTag(512254408,811,10,"PPTWebEditorSorterGridPackage: exception in Dispose: {0}",O)}}static main(){e.a.instance.Fc(new L)}}Object(x.a)(L,"PPTWebEditorSorterGridPackage",null,[3,4]);a=a(154);Type.registerNamespace("PPTGridComponent");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.SorterGrid");Object(a.c)("Sortergrid");L.main();Object(a.b)("Sortergrid")}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.sortergrid.js.map