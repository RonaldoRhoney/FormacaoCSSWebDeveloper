'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1070:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}Object(x.a)(c,"PersonaInfo",null,[])},1071:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}Object(x.a)(c,"PersonaIdentifiers",null,[])},1072:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b){this.yl=b}dGd(b){const f=[];if(b)for(const u in b){var e=u,h=b[u];const m=this.yl.d8c(e);if(m)for(const n of m)f.push(appChrome.actions.updateControlHiddenState(n,
h));else if(e=this.yl.vhh(e))for(const n of e)if(n.externalUxCommandIds)for(const l of n.externalUxCommandIds)f.push(appChrome.actions.updateControlHiddenState(l,h));else f.push(appChrome.actions.updateGroupHiddenState(n.externalUxGroupId,h))}return f}Igh(b){const f=[];if(b)for(const e in b){if(!b[e])continue;const h=e;h&&f.push(appChrome.actions.deactivateRibbonTab(h))}return f}}Object(x.a)(c,"ReactRibbonTrimmingHelper",null,[])},1129:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{static i0g(b){if(!b)return"{NULL}";
const f=b.length;return 600>=f?b:b.substring(0,400)+"[...]"+b.substring(f-195,f)}}Object(x.a)(c,"LogUtils",null,[])},1130:function(x,G,a){function c(){var f,e;return(null!==(e=null===(f=b.AFrameworkApplication.ga)||void 0===f?void 0:f.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseSessionExpirationManagerWithRefreshV2",!1))&&void 0!==e?e:!1)&&b.AFrameworkApplication.DE&&2==b.AFrameworkApplication.i1k}a.d(G,"a",function(){return c});var b=a(4)},1170:function(x,G,a){a.d(G,"a",function(){return e});
x=a(0);var c=a(1612),b;(function(h){h[h.none=0]="none";h[h.ignoreCase=1]="ignoreCase"})(b||(b={}));Object(x.b)("StringComparison",b);class f{static compare(h,u,m){return!h&&u?-1:h&&!u?1:h||u?m===b.ignoreCase?h.toLowerCase().localeCompare(u.toLowerCase()):h.localeCompare(u):0}static equals(h,u,m){return!f.compare(h,u,m)}static rb(h){return h?!1:!0}}Object(x.a)(f,"StringHelper",null,[]);a=a(68);class e{static cxc(h,u){for(let m=0;m<h.length;m++)if(f.equals(h[m].DisplayColor,u,1))return h[m].Color}static E4g(h,
u){const m=e.$_.indexOf(h);m&&(-1!==m&&e.$_.removeAt(m),e.$_.insert(0,h),e.$_.count===e.wbd+1&&e.$_.removeAt(e.wbd),e.e3c||(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(u,!1)),e.e3c=!0))}static RFf(){const h=[];for(let u=0;u<e.$_.count;u++)h.push(Object.assign(new c.a,{Color:e.$_.ha(u),Alt:e.$_.ha(u),DisplayColor:e.$_.ha(u)}));return h}}e.$_=new a.a;e.wbd=10;e.e3c=!1;Object(x.a)(e,"ColorPickerFormatUtils",null,[])},1220:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b){this.qza=
!0;this.MEc=this.WKc=this.vMc=this.RIc=null;this.Ega=b}copy(){return new c(this.Ega.copy())}move(b,f){this.qza=!0;this.Ega.move(b,f)}setOffsets(b){this.qza=!0;this.Ega.setOffsets(b)}ej(){return this.Ega.ej()}get Ic(){this.L0c();return this.RIc}get Xc(){this.L0c();return this.vMc}get Bd(){this.L0c();return this.WKc}get xd(){this.L0c();return this.MEc}L0c(){if(this.qza){var b=this.Ega.points;this.RIc=this.WKc=b[0].x;this.vMc=this.MEc=b[0].y;for(const f of b)this.RIc=Math.min(this.RIc,f.x),this.vMc=
Math.min(this.vMc,f.y),this.WKc=Math.max(this.WKc,f.x),this.MEc=Math.max(this.MEc,f.y);this.qza=!1}}}Object(x.a)(c,"Boundary",null,[])},1230:function(x,G,a){a.d(G,"a",function(){return w});x=a(0);class c{constructor(){this.k_g=this.oOf=null;this.pTj=this.score=this.Fsg=0}f5j(y,z,A){this.score=y.ha(z);++z;this.oOf=y.ha(z)?A.kjb(y.ha(z)):null;++z;this.k_g=y.ha(z)?A.kjb(y.ha(z)):null;++z;this.Fsg=y.ha(z);++z;this.pTj=y.ha(z);++z;return z}}Object(x.a)(c,"TokenStringGeneratorInit",null,[]);class b{constructor(y,
z,A,B,H){this.q7c=y;this.count=z;this.kgh=A;this.Ija=B;this.depth=H}}Object(x.a)(b,"ErrorTolerantTrieMatch",null,[]);var f=a(1439),e=a(1519);class h{constructor(y=null,z=0,A=0,B=0){this.Rmm=y||new e.a;this.bAb=z;this.Ija=A;this.depth=B}get mRa(){return this.Rmm}getKey(){return this.mRa.PQ.toString()+":"+this.bAb.toString()}}Object(x.a)(h,"TrieBookmark",null,[]);class u{constructor(y,z){this.wcc=y;this.CJj=z}san(y){if(null==y)throw Error.argumentNull("prefix");let z={};var A=z[""]=new h;this.ujh(A,
z);for(A=0;A<y.length;++A){const B=y.charCodeAt(A),H={};for(let v in z)this.rrm(B,z[v],H);z=H}return this.cVn(z)}ujh(y,z){if(!(y.Ija>=this.CJj)&&(y=new h(f.a.wgi(y.mRa),y.bAb,y.Ija+1,y.depth),y.mRa.W3&f.a.f2c&&(y.bAb+=1),this.wcc.Lse(y.mRa))){y.depth+=1;let A=!0;for(;A;)u.Fzh(y,z),this.ujh(y,z),y.bAb+=this.wcc.vCe(y.mRa,!0)+(y.mRa.W3&f.a.f2c?1:0),A=this.wcc.N_g(y.mRa)}}rrm(y,z,A){z.Ija+1<=this.CJj&&(z.Ija+=1,u.Fzh(z,A),--z.Ija);z.mRa.W3&f.a.f2c&&(z.bAb+=1);if(this.wcc.Lse(z.mRa)){z.depth+=1;let B=
!0;for(;B;)z.mRa.wve===y?(u.Fzh(z,A),this.ujh(z,A)):z.Ija+1<=this.CJj&&(z.Ija+=1,u.Fzh(z,A),this.ujh(z,A),--z.Ija),z.bAb+=this.wcc.vCe(z.mRa,!0)+(z.mRa.W3&f.a.f2c?1:0),B=this.wcc.N_g(z.mRa)}}cVn(y){const z=[];for(var A in y){const B=y[A];if(!B.mRa.PQ)continue;const H=!!(B.mRa.W3&f.a.f2c),v=this.wcc.vCe(B.mRa,!1)+(H?1:0);Array.add(z,new b(B.bAb,v,H,B.Ija,B.depth))}z.sort((B,H)=>{let v=B.q7c-H.q7c;return v||(v=-(B.count-H.count))?v:v=B.depth-H.depth});if(2>z.length)return z;y=[];for(A=0;A<z.length;)A+=
u.U7l(A,z,y);return y}static Fzh(y,z){const A=y.getKey();A in z?(z=z[A],z.Ija=Math.min(z.Ija,y.Ija)):z[A]=new h(f.a.wgi(y.mRa),y.bAb,y.Ija,y.depth)}static U7l(y,z,A){const B=z[y];let H=B.q7c;const v=H+B.count;let C=1,F=B.kgh;for(;y+C<z.length&&z[y+C].q7c<v;){const D=z[y+C];D.q7c>H&&(Array.add(A,new b(H,D.q7c-H,F,B.Ija,B.depth)),F=!1);C+=u.U7l(y+C,z,A);H=D.q7c+D.count}H<v&&Array.add(A,new b(H,v-H,F,B.Ija,B.depth));return C}}Object(x.a)(u,"ErrorTolerantTrieLookupEngine",null,[1813]);class m extends c{constructor(y,
z,A){super();this.CAl=this.oSl=!1;this.rql=null;if(y){var B=0;try{B=this.f5j(y,B,z);this.oSl=1===y.ha(B);++B;this.CAl=1===y.ha(B);++B;const H=y.ha(B);this.rql=this.hun(A,H)}catch(H){throw Error.argument("initData");}}}hun(y,z){return new u(y,z)}}Object(x.a)(m,"FuzzyMatchTokenStringGeneratorInit",c,[]);class n extends c{constructor(y,z){super();this.query=this.name=null;if(y){this.annotations=z.annotations;var A=0;try{A=this.f5j(y,A,z),this.name=z.i3(y.ha(A)),++A,this.query=z.vca(y.ha(A))}catch(B){throw Error.argument("initData");
}}}}Object(x.a)(n,"QueryTokenStringGeneratorInit",c,[]);class l extends c{constructor(y,z){super();if(y)try{this.f5j(y,0,z)}catch(A){throw Error.argument("initData");}}}Object(x.a)(l,"SurfaceStringTokenStringGeneratorInit",c,[]);var r=a(665);class w{constructor(y){this.IBj=y}get oOf(){return this.IBj.oOf}get k_g(){return this.IBj.k_g}get Fsg(){return this.IBj.Fsg}static create(y,z,A){const {SurfaceStringTokenStringGenerator:B}=a(1624),{QueryTokenStringGenerator:H}=a(1625),{FuzzyMatchTokenStringGenerator:v}=
a(1626);let C=0;try{if(y.ha(C)!==w.uwd)throw Error.argument("initData","Input does not represent a token string generator");++C;const F=y.ha(C);++C;const D=new r.a;D.E7c(y,C,y.count-C);switch(F){case B.Dff:return new B(new l(D,z));case H.Dff:return new H(new n(D,z));case v.Dff:return new v(new m(D,z,A));default:throw Error.argument("initData");}}catch(F){throw Error.argument("initData");}}static eel(y,z,A,B,H,v){y=y.NUn.getId(z,null);if(0>y)return++v,v;w.fel(y,A,B,H);return v}static fel(y,z,A,B){Array.add(B.NMk,
y);Array.add(B.I6l,z);++B.uOe[A]}}w.uwd=1099767983;Object(x.a)(w,"TokenStringGenerator",null,[1789])},1357:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b){this.Wb=b}get HOc(){return this.Wb.HOc}get jTn(){return 4!==this.Wb.style}get kTn(){return!0}get trie(){return this.Wb.trie}getId(b,f){if(!this.jTn)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Wb.style){case 0:return this.zPm(b,f);default:throw Error.notImplemented();}}i3(b){if(!this.kTn)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>b||b>=this.HOc)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Wb.style){case 0:return this.JTm(b);case 4:return this.ITm(b);default:throw Error.notImplemented();}}zPm(b,f){b=this.Wb.trie.bGl(b,0,b.length,f);if(!b.succeeded)return-1;if(0>b.zOe||b.zOe>=this.Wb.HOc)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Wb.O_g?this.Wb.cIg.xS(this.Wb.O_g+4*b.zOe,4):b.zOe}JTm(b){if(this.Wb.O_g){let f=0;for(;f<this.Wb.HOc&&this.Wb.cIg.xS(this.Wb.O_g+
4*f,4)!==b;++f);if(f>=this.Wb.HOc)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Wb.trie.Nwl(f)}return this.Wb.trie.Nwl(b)}ITm(b){const f=this.Wb.cIg.xS(this.Wb.G6l+4*b,4);b=this.Wb.cIg.xS(this.Wb.H6l+4*b,4);if(0>b||0>f)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const e=Array(f);for(let h=0;h<f;++h)e[h]=({x0m:b}=this.cDn(b)).returnValue;return String.fromCharCode.apply(null,e)}cDn(b){let f=0;for(let e=0;3>e;++e){const h=
this.Wb.cIg.ha(this.Wb.vjl+b)^182;++b;f|=(h&127)<<7*e;if(!(h&128))break}return{returnValue:f,x0m:b}}}Object(x.a)(c,"StringTable",null,[1781])},1358:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(1439);class b{constructor(f){this.trie=null;this.vjl=this.G6l=this.H6l=this.O_g=0;if(f){this.cIg=f;var e=0;if(f.xS(e,4)!==b.uwd)throw Error.argument("bytes","Input does not represent a string table");e+=4;this.HOc=f.xS(e,4);e+=4;this.style=f.xS(e,4);e+=4;switch(this.style){case 0:const h=1===
f.xS(e,4);e+=4;h||(this.O_g=e,e+=4*this.HOc);f.xS(e,4);this.trie=this.Bun(f,e+4);break;case 4:this.H6l=e;this.G6l=e+=4*this.HOc;e+=4*this.HOc;f.xS(e,4);this.vjl=e+4;break;default:throw Error.argument("bytes");}}}Bun(f,e){return new c.a(f,e)}}b.uwd=1025118440;Object(x.a)(b,"StringTableInit",null,[])},1439:function(x,G,a){a.d(G,"a",function(){return u});x=a(0);class c{constructor(m){this.lOl=m;this.succeeded=!1;this.zOe=m?m.zOe:0;this.Y6m=!1;this.length=this.BTn=0}}Object(x.a)(c,"TrieResult",null,[]);
class b{constructor(m,n,l){this.nA=new c(null);this.Ucn=m;this.B6f=n;this.WHl=n+l-1}get result(){return this.nA}Bvl(){let m;return this.B6f<=this.WHl?(m=this.Ucn.charAt(this.B6f),++this.B6f,{returnValue:!0,ch:m}):{returnValue:!1,ch:"\x00"}}kmk(m,n,l){m&&(this.nA.Y6m=!0,this.nA.BTn=n);this.nA.length=this.B6f;this.nA.succeeded=!0;this.nA.zOe=l;this.B6f!==this.WHl+1&&(this.nA=new c(this.nA))}}Object(x.a)(b,"LookUpStringVisitor",null,[1790]);var f=a(1519);class e{constructor(){this.ojl=this.pil=this.ril=
this.oil=this.qil=this.p$h=this.o$h=this.r$h=this.n$h=0}}Object(x.a)(e,"TRIESTATS",null,[]);class h{constructor(){this.symbol=this.pvg=0}}Object(x.a)(h,"TrieSymbol",null,[]);class u{constructor(m,n){this.bOa=null;this.koh=this.gJl=this.eJl=this.iJl=this.aJl=this.hJl=this.fJl=this.jJl=this.bJl=0;this.gaa=m;if(m.xS(n,4)!==u.uwd)throw Error.argument("Input does not represent a trie");n+=4;this.hIl=1===m.xS(n,4);n+=4;this.Nbn=1===m.xS(n,4);n+=4;this.Fbn=m.xS(n,4);n+=4;if(m.xS(n,4)){m=n+4;this.bOa=this.fDn(m);
this.bJl=n=m+u.zvm;this.jJl=n+=u.wch*(this.bOa.n$h+(this.bOa.n$h%2?1:0));this.fJl=n+=u.wch*(this.bOa.r$h+(this.bOa.r$h%2?1:0));this.hJl=n+=u.wch*(this.bOa.o$h+(this.bOa.o$h%2?1:0));this.aJl=n+=u.wch*(this.bOa.p$h+(this.bOa.p$h%2?1:0));this.iJl=n+=u.E$h*this.bOa.oil;this.eJl=n+=u.F$h*this.bOa.ril;this.gJl=n+=u.F$h*this.bOa.pil;n+=u.F$h*this.bOa.qil;if(n!==m+this.bOa.ojl)throw Error.argument("Corrupted trie binary");this.koh=n}else this.bOa=null}bGl(m,n,l,r){m=new b(m,n,l);this.I$l(m,r);return m.result}Nwl(m){if(this.hIl)if(m)--m;
else return"";if(!this.bOa)throw Error.argument("Invalid trieID");const n=new f.a;n.W3=0;this.Lse(n);const l=[];for(;;){if(n.W3&u.f2c)if(m)--m;else return Array.add(l,n.wve),String.fromCharCode.apply(null,l);const r=!!(n.W3&u.OCh),w=this.vCe(n,!0);if(r||m<w){if(Array.add(l,n.wve),!this.Lse(n))throw Error.argument("Invalid trieID");}else if(m-=w,!this.N_g(n))throw Error.argument("Invalid trieID");}}I$l(m,n){let l=0;this.hIl&&(m.kmk(this.Nbn,this.Fbn,0),++l);if(this.bOa){var r=new f.a;r.W3=0;if(this.Lse(r))for(;;){var w=
void 0;if(!({ch:w}=m.Bvl()).returnValue)break;n&&(w=n(w));w=w.toString().charCodeAt(0);let y=!1;for(;!y;){const z=!!(r.W3&u.f2c);if(r.wve===w){if(y=!0,z&&m.kmk(!!(r.W3&u.G3k),r.vyh,l),!this.Lse(r))return}else if(l+=this.vCe(r,!0),!this.N_g(r))return;z&&++l}}}}Lse(m){if(!m.W3)return this.MSk(m),!0;if(!(m.W3&u.NCh))return!1;m.Zac=0;m.PQ=m.$8c;this.MSk(m);return!0}N_g(m){if(m.W3&u.OCh)return!1;this.MSk(m);return!0}vCe(m,n){return m.W3&u.F3k?m.rch:m.W3&u.NCh?!n&&m.W3&u.OCh?this.sNm(m):1:0}sNm(m){m=u.wgi(m);
if(!this.Lse(m))return 0;let n=0;do m.W3&u.f2c&&++n,n+=this.vCe(m,!1);while(this.N_g(m));return n}MSk(m){m.W3||(m.Zac=0,m.PQ=this.koh);var n=this.jeh(this.bJl,m.PQ),l=n.symbol;m.PQ+=n.pvg;n=this.gaa.xS(this.aJl+u.E$h*l,u.E$h);m.wve=n&65535;m.W3=n>>16;m.W3&u.F3k&&(m.rch=this.eDm(m));m.W3&u.G3k&&(n=this.jeh(this.jJl,m.PQ),l=n.symbol,m.PQ+=n.pvg,m.vyh=this.gaa.xS(this.iJl+4*l,4));m.W3&u.Tdm?(m.$8c=this.koh+((this.gaa.ha(m.PQ)<<8|this.gaa.ha(m.PQ+1))<<8|this.gaa.ha(m.PQ+2)),m.PQ+=3):m.W3&u.Udm?(m.$8c=
m.PQ,m.Zac=m.$8c):m.W3&u.Vdm?(n=this.jeh(this.fJl,m.PQ),l=n.symbol,m.PQ+=n.pvg,m.$8c=this.koh+this.gaa.xS(this.eJl+4*l,4)):m.W3&u.NCh&&(n=this.jeh(this.hJl,m.PQ),l=n.symbol,m.PQ+=n.pvg,m.Zac||(m.Zac=m.PQ),m.Zac+=this.gaa.xS(this.gJl+4*l,4),m.$8c=m.Zac)}jeh(m,n){const l=new h;let r=0;for(;;){r+=this.gaa.ha(n);++n;++l.pvg;const w=this.gaa.xS(m,2);if(r<w)break;l.symbol+=w;r-=w;m+=2;r<<=8}l.symbol+=r;return l}eDm(m){let n=this.gaa.ha(m.PQ);192<=n?(n=(n&63)<<15|(this.gaa.ha(m.PQ+1)&127)<<8,n|=this.gaa.ha(m.PQ+
2),m.PQ+=3):128<=n?(n=(n&127)<<8|this.gaa.ha(m.PQ+1),m.PQ+=2):m.PQ+=1;return n}fDn(m){const n=new e;n.n$h=this.gaa.xS(m+12,2);n.r$h=this.gaa.xS(m+14,2);n.o$h=this.gaa.xS(m+16,2);n.p$h=this.gaa.xS(m+18,2);n.qil=this.gaa.xS(m+24,4);n.oil=this.gaa.xS(m+28,4);n.ril=this.gaa.xS(m+32,4);n.pil=this.gaa.xS(m+36,4);n.ojl=this.gaa.xS(m+40,4);return n}static wgi(m){const n=new f.a;n.wve=m.wve;n.W3=m.W3;n.rch=m.rch;n.PQ=m.PQ;n.$8c=m.$8c;n.Zac=m.Zac;n.vyh=m.vyh;return n}}u.uwd=1654263084;u.zvm=48;u.wch=2;u.F$h=
4;u.E$h=4;u.f2c=1;u.OCh=2;u.F3k=4;u.G3k=8;u.NCh=16;u.Udm=64;u.Vdm=128;u.Tdm=256;Object(x.a)(u,"Trie",null,[1791])},1518:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c extends Sys.EventArgs{constructor(b){super();this.Ldc=b}}Object(x.a)(c,"SessionRehydratedEventArgs",Sys.EventArgs,[])},1519:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.vyh=this.Zac=this.$8c=this.PQ=this.rch=this.W3=this.wve=0}}Object(x.a)(c,"TRIESCAN",null,[])},1624:function(x,G,
a){a.r(G);a.d(G,"SurfaceStringTokenStringGenerator",function(){return b});x=a(0);var c=a(1230);class b extends c.a{constructor(f){super(f);this.Wb=f}apply(f,e,h,u,m,n,l){null==n&&(n=f.nxl(m,e));l=c.a.eel(f,n,this.Wb.score,h,u,l);return{l_g:n,Cff:l}}}b.Dff=0;Object(x.a)(b,"SurfaceStringTokenStringGenerator",c.a,[])},1625:function(x,G,a){a.r(G);a.d(G,"QueryTokenStringGenerator",function(){return f});x=a(0);var c=a(1230),b=a(322);class f extends c.a{constructor(e){super(e);this.Wb=e}apply(e,h,u,m,n,
l,r){h=this.Wb.query.load(h,null);n=0;let w=null;this.Wb.query.QPa===b.Annotations.JDb?h&&(w=this.Wb.name):((w=this.Wb.name)&&(w+="_"),w+=this.Wb.annotations.z8a(this.Wb.query.QPa,h));null!=w&&(n=c.a.eel(e,w,this.Wb.score,u,m,n));return{l_g:l,Cff:r+n}}}f.Dff=1;Object(x.a)(f,"QueryTokenStringGenerator",c.a,[])},1626:function(x,G,a){a.r(G);a.d(G,"FuzzyMatchTokenStringGenerator",function(){return b});x=a(0);var c=a(1230);class b extends c.a{constructor(f){super(f);this.Wb=f}apply(f,e,h,u,m,n,l){null==
n&&(n=f.nxl(m,e));f=this.Wb.rql.san(n);if(this.Wb.oSl)for(var r of f)if(!r.Ija&&r.kgh)return{l_g:n,Cff:l};r=0;for(const w of f)if(w.Ija&&!({q$h:r}=this.Qgl(w,!0,h,u,r)).returnValue)return{l_g:n,Cff:l};if(this.Wb.CAl)for(const w of f)if(!({q$h:r}=this.Qgl(w,!1,h,u,r)).returnValue)break;return{l_g:n,Cff:l}}Qgl(f,e,h,u,m){let n;e?(e=0,n=f.kgh?1:0):(e=f.kgh?1:0,n=f.count-e);for(let l=0;l<n;++l)if(c.a.fel(f.q7c+e+l,this.Wb.score,h,u),++m,0<this.Wb.pTj&&m>=this.Wb.pTj)return{returnValue:!1,q$h:m};return{returnValue:!0,
q$h:m}}}b.Dff=2;Object(x.a)(b,"FuzzyMatchTokenStringGenerator",c.a,[])},1675:function(x,G,a){function c(na){return na.includes("aadInteractionRequired")||na.includes("sessionRevocation")||na.includes("blockAccessForTenantRestrictions")||na.includes("revoked")||na.includes("Due to organizational policies, you can't access these resources from this network location")?!0:!1}function b(){return n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getBooleanAppSetting("WopiTokenRevokedTokenExperiment")&&
n.AFrameworkApplication.ga.getBooleanAppSetting("ShowTokenRevocationErrorMessage"):!1}function f(){return n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldKickoutWhenMaxRetries",!1):!1}function e(){return n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.WordOnline.MaxConsecutiveTokenRefreshFailures",3):3}function h(na,$a){var Fb;null===(Fb=u(na,$a).Ki)||void 0===Fb?void 0:Fb.handleShapeNodeGC2ModelSync()}
function u(na,$a){return na?na.Qg($a):null}a.r(G);var m=a(0),n=a(4),l=a(118),r=a(17),w=a(1067),y=a(62),z=a(19),A=a(151),B=a(40),H=a(1671),v=a(3),C=a(28),F=a(13),D=a(876),N=a(119);class U{static get Bl(){return N.a.xX(U.Ny,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}U.Ny="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(m.a)(U,"InsertSymbolsDialogHtml",null,[]);var W=a(254),L=a(403);class O extends H.a{constructor(na,$a,Fb){super();this.U8k=this.M9b=this.Y3c=null;this.EKh=0;this.R6l=Xb=>{if(Xb.target!==this.U8k){const nc=this.Je.Hw();nc&&nc.nt&&(nc.nt.tZ(Xb.target),this.U8k=Xb.target)}this.Trn(Xb.target.id)};this.rTn=Xb=>{const nc=Xb.Dc;if("a"!==nc.tagName.toLowerCase())return!1;Xb.eventName===v.a.doubleClick&&this.M_j(nc.id);this.Je.yia(this.Kja,!0);this.Je.Hw().nt.tZ(nc);nc.focus();return!0};this.tTn=Xb=>
{var nc=Xb.Dc;if("a"!==nc.tagName.toLowerCase())return!1;const Nc=parseInt(nc.id.substr(nc.id.lastIndexOf("_")+1));if(Xb.Sb.ctrlKey||Xb.Sb.altKey||Xb.Sb.keyCode>=C.a.qgd&&Xb.Sb.keyCode<=C.a.o9b)return!1;if(Xb.eventName===v.a.Lj){Xb=Xb.Sb.keyCode;let yd=-1;Xb===Sys.UI.Key.enter?(this.M_j(nc.id),this.Je.yia(this.Kja,!0),this.Je.Hw().nt.tZ(nc),nc.focus()):Xb===Sys.UI.Key.up?yd=Nc-15:Xb===Sys.UI.Key.down?yd=Nc+15:Xb===Sys.UI.Key.left?yd=n.AFrameworkApplication.isRtl?Nc+1:Nc-1:Xb===Sys.UI.Key.right&&(yd=
n.AFrameworkApplication.isRtl?Nc-1:Nc+1);0<=yd&&(nc=this.mXi("symbol_d_"+yd))&&nc.focus()}return!0};this.ya=na;this.Je=$a;this.olc=Fb;this.Fg(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Fg(0,CommonUIStrings.l_DialogClose);this.nGa=!1;this.Bl=U.Bl;this.uk="InsertSymbolsDialog"}dispose(){0<O.rVh&&r.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.EKh,O.rVh);O.J5k++;r.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",
O.J5k);this.ya=this.olc=null;super.dispose()}nwb(){this.Dq(Box4Intl.Box4Strings.L_SymbolSingle,Object(B.a)(this,this.R2m,"insertSymbolsDialogHandler"),null);this.EKh=0;O.O5k++;r.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",O.O5k);const na=this.mXi("symbol_d_"+O.l1e);na&&na.focus()}hide(){var na=document.getElementById("symbolsContainer");if(na&&(na=na.getElementsByTagName("a")))for(let $a=0;$a<na.length;$a++)F.a.removeHandler(na[$a],v.a.focus,this.R6l);super.hide()}R2m(na){1===
na?(this.M_j("symbol_d_"+O.l1e),this.Je.yia(this.Kja,!0),this.Je.Hw().nt.tZ(this.F7),this.F7.focus()):this.hide()}get BFe(){return O.e9k}set BFe(na){O.e9k=na}get zFe(){return O.Z8k}set zFe(na){O.Z8k=na}Zab(){super.Zab();var na=document.getElementById("symbolsContainer");if(na&&(D.a.qec(na,this.olc.Cum(),"InsertSymbolsDialog"),na=na.getElementsByTagName("a")))for(let $a=0;$a<na.length;$a++)F.a.addHandler(na[$a],v.a.focus,this.R6l)}Yfb(){const na=document.getElementById("symbolsContainer");na&&(this.Y3c||
(this.Y3c=this.rTn,this.rE.Zb(v.a.click,na,this.Y3c),this.rE.Zb(v.a.doubleClick,na,this.Y3c)),this.M9b||(this.M9b=this.tTn,this.yr.Zb(v.a.Lj,na,this.M9b),this.yr.Zb(v.a.gO,na,this.M9b),this.yr.Zb(v.a.Iq,na,this.M9b)));super.Yfb()}Szb(){const na=document.getElementById("symbolsContainer");na&&(this.Y3c&&(this.rE.jc(v.a.click,na,this.Y3c),this.rE.jc(v.a.doubleClick,na,this.Y3c),this.Y3c=null),this.M9b&&(this.yr.jc(v.a.Lj,na,this.M9b),this.yr.jc(v.a.gO,na,this.M9b),this.yr.jc(v.a.Iq,na,this.M9b),this.M9b=
null));super.Szb()}Trn(na){this.f3l("symbol_d_"+O.l1e,!1);O.l1e=parseInt(na.substr(na.lastIndexOf("_")+1));this.f3l(na,!0);if(na=document.getElementById("SymbolNameValueLabel")){const $a=this.YCe(O.l1e);na.innerText=$a.altText}}YCe(na){const $a=this.olc.uyh.HNk.value,Fb=L.a($a);return $a[Fb[na]]}M_j(na){this.EKh++;O.rVh++;na=parseInt(na.substr(na.lastIndexOf("_")+1));const $a=this.YCe(na),Fb={};Fb.SourceControlId="symbol_"+na+"_"+$a.tyh;this.ya.Qa(W.a.M$a,2,Fb);r.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",
na)}mXi(na){const $a=document.getElementById("symbolsContainer");return $a?$a.querySelector("#"+na):null}f3l(na,$a){(na=this.mXi(na))&&($a?na.setAttribute("selected","true"):na.removeAttribute("selected"))}}O.l1e=0;O.e9k=null;O.Z8k=null;O.O5k=0;O.J5k=0;O.rVh=0;Object(m.a)(O,"InsertSymbolsDialog",H.a,[]);var M=a(261),K=a(265),P=a(257),V=a(355),Y=a(23);class ta{constructor(na,$a,Fb,Xb,nc,Nc,yd,Ud){this.YTm=()=>this.olc.avm();this.nXi=()=>this.olc.build();this.wWl=(ie,Be,oe,rf,Vf)=>{if(1===oe)return 32;
ie=this.olc.iTl(Vf);ie=String.format(this.olc.sTn,ie.character);Vf[w.a.InnerHTML]=ie;Vf[w.a.On]=!1;return 32};this.ya=na;this.qL=$a;this.tmm=new A.a(this.YTm);this.umm=new A.a(this.nXi);this.zl=Fb;this.olc=Xb;this.Kx=nc;this.Jx=Nc;this.Nc=yd;this.Rk=Ud}Hb(){this.ya.sa(W.a.WKe,P.a.application,Object(B.a)(this,this.WKe,"queryInsertSymbols"),96);this.ya.za(W.a.WRc,P.a.view,Object(B.a)(this,this.WRc,"populateSymbolsDropDown"));this.ya.za(W.a.WNe,P.a.view,Object(B.a)(this,this.S6l,"symbolsDropDownOpenHandler"));
this.ya.za(W.a.yth,P.a.view,this.wWl);this.ya.za(W.a.M$a,P.a.view,Object(B.a)(this,this.cAc,"insertSymbolViewHandler"));this.ya.za(W.a.WRc,P.a.ng,Object(B.a)(this,this.WRc,"populateSymbolsDropDown"));this.ya.za(W.a.WNe,P.a.ng,Object(B.a)(this,this.S6l,"symbolsDropDownOpenHandler"));this.ya.za(W.a.yth,P.a.ng,this.wWl);this.ya.za(W.a.M$a,P.a.ng,Object(B.a)(this,this.Q2m,"insertSymbolHandler"));this.ya.ue(W.a.WRc,1124);this.ya.ue(W.a.WNe,1036);this.ya.ue(W.a.yth,1124);this.ya.ue(W.a.M$a,1036);n.AFrameworkApplication.ga&&
n.AFrameworkApplication.ga.getBooleanAppSetting("InsertMoreSymbolsIsEnabled")&&(this.ya.za(W.a.h9c,P.a.view,Object(B.a)(this,this.W4l,"showInsertMoreSymbolsDialogHandler")),this.ya.za(W.a.h9c,P.a.ng,Object(B.a)(this,this.W4l,"showInsertMoreSymbolsDialogHandler")),this.ya.ue(W.a.h9c,1124))}cAc(na,$a,Fb,Xb,nc){if(({Tf:na,selected:Fb,cAc:Ud}=this.qnl($a,Fb)).returnValue)return Ud;var Nc=M.SelectionEditor.Wg(Fb);let yd=!0;Fb=8;var Ud=this.zl.qe(15);Ud.hd(na.Zg);Nc||(Fb=this.ya.Sh($a,W.a.bJa,2,!0,Xb,null),
$a=32===Fb,r.ULS.shipAssertTag(6407387,348,$a,"DeleteForReplace did not succeed. Response is {0}",Fb),yd=$a);yd&&($a=na.Jb.Wj,Nc=M.SelectionEditor.Wg($a),r.ULS.shipAssertTag(6407388,348,Nc,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",$a.contextId),Fb=8,Nc&&(Fb=this.ya.Sh($a,W.a.M$a,2,!1,Xb,nc),r.ULS.shipAssertTag(6407389,348,32===Fb,"Insertion at IP context did not succeed. Response is {0}",Fb),32===Fb&&y.FocusManager.instance().gh(na.yE)));Ud.dispose();return Fb}qnl(na,
$a){let Fb,Xb;Fb=null;na.view.Qh&&(Fb=na.view);Xb=null;return Fb&&Fb.Jb?(Xb=Fb.Jb.Wj)?this.Jx.ha(14)&&this.Kx.M9a(Xb)?{returnValue:!0,Tf:Fb,selected:Xb,cAc:8}:Fb.Jb.Ua.BE||this.Rk&&this.Rk.instance&&this.Rk.instance.VV(Xb)||M.SelectionEditor.KRd(na.RF)?{returnValue:!0,Tf:Fb,selected:Xb,cAc:2}:1===$a?{returnValue:!0,Tf:Fb,selected:Xb,cAc:32}:{returnValue:!1,Tf:Fb,selected:Xb,cAc:32}:{returnValue:!0,Tf:Fb,selected:Xb,cAc:2}:(Y.c(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",
na.toString()),{returnValue:!0,Tf:Fb,selected:Xb,cAc:8})}Q2m(na,$a,Fb,Xb,nc){if(1===Fb)return 32;if(M.SelectionEditor.KRd($a))return 2;na=this.olc.iTl(nc);Xb.KK=na.index;Xb=this.qL.Hc($a.node);Fb=Xb.pc(11);r.ULS.shipAssertTag(6379466,324,Fb,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",V.a[$a.node.type]);Fb=this.zl.qe(15);Fb.Hx(Xb);ta.characterPropertiesEditor.replaceTextRange($a,na.character,!0,!1);$a=K.SelectionFactory.Ig(Xb.currentNode,$a.Va+1);this.Nc.setSelection($a);
Fb.dispose();return 32}WRc(na,$a,Fb,Xb,nc){if(1===Fb)return 32;n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.Cx?nc.MenuItems=this.tmm.value:nc.PopulationXML=this.umm.value;return 32}S6l(na,$a,Fb){return this.qnl($a,Fb).cAc}W4l(na,$a,Fb){2===Fb&&(new O(this.ya,y.FocusManager.instance(),z.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).nwb();return 32}WKe(){return 32}static get characterPropertiesEditor(){return ta.Jh||(ta.Jh=z.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(na){ta.Jh=
na}}ta.Jh=null;Object(m.a)(ta,"SymbolsActor",null,[1265]);class fa{constructor(na,$a){this.tyh=na;this.altText=$a}}Object(m.a)(fa,"Symbol",null,[]);class Ta{constructor(){this.uUh=null;this.tcl=new A.a(Ta.Nnf)}get HNk(){return this.tcl}RPm(na){this.uUh||(this.uUh=L.a(this.tcl.value));return Array.indexOf(this.uUh,na)}static Nnf(){const na={};na["\u2022"]=new fa("\u2022",Box4Intl.Box4Strings.L_Bullet);na["\u20ac"]=new fa("\u20ac",Box4Intl.Box4Strings.L_EuroSign);na["\u00a3"]=new fa("\u00a3",Box4Intl.Box4Strings.L_PoundSign);
na["\u00a5"]=new fa("\u00a5",Box4Intl.Box4Strings.L_YenSign);na["\u00a9"]=new fa("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);na["\u00ae"]=new fa("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);na["\u2122"]=new fa("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);na["\u00b1"]=new fa("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);na["\u2260"]=new fa("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);na["\u2264"]=new fa("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);na["\u2265"]=new fa("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);
na["\u00f7"]=new fa("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);na["\u00d7"]=new fa("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);na["\u221e"]=new fa("\u221e",Box4Intl.Box4Strings.L_Infinity);na["\u00b5"]=new fa("\u00b5",Box4Intl.Box4Strings.L_MicroSign);na["\u03b1"]=new fa("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);na["\u03b2"]=new fa("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);na["\u03c0"]=new fa("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);na["\u03a9"]=new fa("\u03a9",
Box4Intl.Box4Strings.L_OhmSign);na["\u03a3"]=new fa("\u03a3",Box4Intl.Box4Strings.L_NArySummation);na["\u00b0"]=new fa("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);na["\u0394"]=new fa("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);na["\u263a"]=new fa("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);na["\u2665"]=new fa("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);na["\u20b9"]=new fa("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);na["\u00bf"]=new fa("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);
na["\u00a1"]=new fa("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);na["\u2014"]=new fa("\u2014",Box4Intl.Box4Strings.L_EmDash);na["\u2026"]=new fa("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);na["\u00c0"]=new fa("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);na["\u00c1"]=new fa("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);na["\u00c2"]=new fa("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);na["\u00c3"]=new fa("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);
na["\u00c4"]=new fa("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);na["\u00c5"]=new fa("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);na["\u00c6"]=new fa("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);na["\u00c7"]=new fa("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);na["\u00c8"]=new fa("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);na["\u00c9"]=new fa("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);na["\u00ca"]=
new fa("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);na["\u00cb"]=new fa("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);na["\u00cc"]=new fa("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);na["\u00cd"]=new fa("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);na["\u00ce"]=new fa("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);na["\u00cf"]=new fa("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);na["\u00d1"]=
new fa("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);na["\u00d2"]=new fa("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);na["\u00d3"]=new fa("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);na["\u00d4"]=new fa("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);na["\u00d5"]=new fa("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);na["\u00d6"]=new fa("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);na["\u00d9"]=
new fa("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);na["\u00da"]=new fa("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);na["\u00db"]=new fa("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);na["\u00dc"]=new fa("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);na["\u00df"]=new fa("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);na["\u00e0"]=new fa("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);na["\u00e1"]=new fa("\u00e1",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);na["\u00e2"]=new fa("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);na["\u00e3"]=new fa("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);na["\u00e4"]=new fa("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);na["\u00e5"]=new fa("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);na["\u00e6"]=new fa("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);na["\u00e7"]=new fa("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);
na["\u00e8"]=new fa("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);na["\u00e9"]=new fa("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);na["\u00ea"]=new fa("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);na["\u00eb"]=new fa("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);na["\u00ec"]=new fa("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);na["\u00ed"]=new fa("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);na["\u00ee"]=
new fa("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);na["\u00ef"]=new fa("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);na["\u00f1"]=new fa("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);na["\u00f2"]=new fa("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);na["\u00f3"]=new fa("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);na["\u00f4"]=new fa("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);na["\u00f5"]=new fa("\u00f5",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);na["\u00f6"]=new fa("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);na["\u00f9"]=new fa("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);na["\u00fa"]=new fa("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);na["\u00fb"]=new fa("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);na["\u00fc"]=new fa("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);na["\u00ff"]=new fa("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);
na["\u011e"]=new fa("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);na["\u011f"]=new fa("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);na["\u0130"]=new fa("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);na["\u0131"]=new fa("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);na["\u0152"]=new fa("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);na["\u0153"]=new fa("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);na["\u015e"]=new fa("\u015e",
Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);na["\u015f"]=new fa("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);na["\u0178"]=new fa("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return na}}Object(m.a)(Ta,"SymbolsLoader",null,[1256]);var ha=a(5),qa=a(481),ra=a(435),I=a(387),ba=a(680),Ga=a(1613),Oa=a(329),Ja=a(135);class Qa{constructor(na){this.vmm=na}get uyh(){return this.vmm}get sTn(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}iTl(na){na=
na.SourceControlId.split("_");const $a={};2===na.length?($a.character=na[1],$a.index=this.uyh.RPm($a.character)):($a.character=na[2],$a.index=parseInt(na[1]));return $a}avm(){return this.Uwl()}build(){return this.nXi()}Cum(){const na=new Sys.StringBuilder;na.append('<table class="moreSymbolsTable">');const $a=this.uyh.HNk.value,Fb=L.a($a);let Xb=0;for(;Xb<Fb.length;){Xb%15||na.append('<tr role="presentation">');const nc=$a[Fb[Xb]];na.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Xb,ha.a.Zyc(nc.tyh),ha.a.Zyc(nc.altText)));Xb++;Xb%15&&Xb!==Fb.length||na.append("</tr>")}na.append("</table>");return na.toString()}nXi(){const na=this.Uwl();return Oa.l(na)}Uwl(){const na=Object.assign(new qa.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(na.MenuSectionList,this.wpm());n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("InsertMoreSymbolsIsEnabled")&&Array.add(na.MenuSectionList,this.Mom());return na}Mom(){const na=Object.assign(new ra.a,
{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),$a=Object.assign(new I.a,{Id:"btnMoreSymbols",Command:"3574218963",LabelText:ha.a.Re(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:ha.a.Re(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:n.AFrameworkApplication.jp,Image16by16Class:Ja.d("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(na.ControlList,$a);return na}wpm(){const na=Object.assign(new ra.a,{Id:"msSymbolsPosition",
ShowMenuSectionSeparator:!1,ControlList:[]}),$a=Object.assign(new ba.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Fb=this.uyh.HNk.value,Xb=L.a(Fb),nc=Math.min(25,Xb.length);for(let yd=0;yd<nc;yd++){var Nc=Fb[Xb[yd]];Nc=Object.assign(new Ga.a,{Id:String.format("{0}{1}_{2}","symbol_",yd,Nc.tyh),Character:Nc.tyh,Command:"3966968829",QueryCommand:"816646517",Alt:ha.a.Re(Nc.altText)});$a.GalleryItems.push(Nc)}Array.add(na.ControlList,
$a);return na}}Object(m.a)(Qa,"SymbolsUiBuilder",null,[1255]);var Pa=a(276),ja=a(314),va=a(255),Ha=a(689),gb=a(480);class Gb{constructor(){this.Ha=null}get name(){return"Box4.Symbols"}init(){n.AFrameworkApplication.ga.getBooleanAppSetting("InsertSymbolIsEnabled")&&this.Ha.resolve("Box4.Symbols.ISymbolsActor").Hb()}dispose(){}lc(na){this.Ha=na;this.Ha.register(Ta,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ma();this.Ha.register(Qa,"Box4.Symbols.SymbolsUiBuilder").as("Box4.Symbols.ISymbolsUIBuilder").ma().na(()=>
new Qa(this.Ha.resolve("Box4.Symbols.ISymbolsLoader")));this.Ha.register(ta,"Box4.Symbols.SymbolsActor").as("Box4.Symbols.ISymbolsActor").ma().na(()=>new ta(n.AFrameworkApplication.vb,new Ha.a,new gb.a,this.Ha.resolve("Box4.Symbols.ISymbolsUIBuilder"),ja.a.instance,va.a.instance,Pa.a.instance,this.Ha.Na("Box4.IExternalSelectionManager")))}static main(){l.a.instance.Fc(new Gb)}}Object(m.a)(Gb,"Box4SymbolsPackage",null,[3,4]);var Mb=a(219),hb=a(20),Da=a(33),Bb=a(1129);class Za{constructor(na,$a){this.RSh=
this.QSh=null;this.Sxe=new Mb.a;this.X1j=Fb=>{let Xb=null;Xb&&Xb.length||!Fb||!Fb.data||(Xb=Fb.data.responseData);if(Xb&&Xb.length)try{const nc=hb.a(Xb);this.QSh=nc.NavBarDataJson;r.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.QSh?({BD:this.RSh}=hb.d(nc.NavBarDataJson)).returnValue?(this.u$m(this.RSh),this.Sxe.vj(this.RSh)):(r.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Bb.a.i0g(this.QSh)}),this.Sxe.K6a()):(r.ULS.sendTraceTag(9000737,
215,15,"ShellData is null"),this.Sxe.K6a())}catch(nc){r.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.Sxe.K6a()}else r.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};this.oxg=()=>{this.Sxe.K6a();r.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.$m=na;this.d9a=$a.appSettings[Za.V_n]||""}get i4l(){return this.Sxe.task}get rI(){return this.$m.value}wHn(){const na={};na[Za.ZXm]=n.AFrameworkApplication.ui;
na["Content-Type"]="application/json; charset=utf-8";r.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const $a=Da.a.em(this.d9a+Za.cOn,Za.Ann,n.AFrameworkApplication.Ea.Kb.Im.toString());this.rI.rk($a,1,"",na,!0,2,this.X1j,this.oxg,null,void 0,void 0,void 0,void 0,"20")}u$m(na){try{const $a={};$a.FlightName=na.FlightName;$a.SessionID=na.SessionID;r.ULS.sendTraceTag(594883776,215,50,hb.c($a))}catch($a){r.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}static get instance(){return Za.Wa||
(Za.Wa=Za.Yuc())}static Yuc(){return new Za(new A.a(()=>n.AFrameworkApplication.ye),n.AFrameworkApplication.ga,n.AFrameworkApplication.Ea.Kb.Im)}}Za.ZXm="X-qs";Za.Ann="at";Za.cOn="O365ShellServiceProxy.ashx";Za.Wa=null;Za.V_n="ShellWebServiceBase";Object(m.a)(Za,"O365ShellActor",null,[1291]);class mb{constructor(){this.Ha=null;this.su=()=>{n.AFrameworkApplication.jPe&&n.AFrameworkApplication.Ea.Kb.eO&&this.Ha.resolve("Common.App.O365Shell.O365ShellActor").wHn()}}get name(){return"Common.App.O365Shell"}lc(na){this.Ha=
na;this.Ha.register(Za,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ma().na(()=>new Za(new A.a(()=>n.AFrameworkApplication.ye),n.AFrameworkApplication.ga,n.AFrameworkApplication.Ea.Kb.Im))}init(){n.AFrameworkApplication.ga.fg(this.su)}dispose(){}static main(){l.a.instance.Fc(new mb)}}Object(m.a)(mb,"PackageManager",null,[3,4]);var vb=a(30),sb=a(179);class bc{constructor(na){this.kb=new vb.a;this.xr=na}saf(na){this.kb.addHandler(bc.uxb,na)}uuh(na){this.kb.removeHandler(bc.uxb,
na)}zUg(){this.kb.raiseEvent(bc.iec)}yUg(){this.kb.raiseEvent(bc.BMe)}HNe(){throw Error("Method not implemented.");}KNe(){throw Error("Method not implemented.");}Yah(){throw Error("Method not implemented.");}}bc.iec="SE";bc.BMe="SEP";bc.uxb="SER";bc.URk="TRP";Object(m.a)(bc,"NullSessionExpirationManager",null,[1261,1263]);var yb=a(12);class uc{constructor(){this.h6e=this.Q3c=!1;this.PIe=()=>{sb.a.instance.rZl(this.PIe);r.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.A5i()};this.lzg=
()=>{sb.a.instance.uGn(this.lzg);this.h6e||this.Q3c||(r.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.h6e=!0,this.cJk())};const na=n.AFrameworkApplication.mq;0>=na||(this.mq=na,r.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.mq,["NowGetTime"]:(new Date).getTime(),["BootTime"]:n.AFrameworkApplication.S7}),sb.a.instance.dbh(this.PIe),sb.a.instance.bbh(this.lzg))}A5i(){this.Q3c||(n.AFrameworkApplication.Xs(yb.a.sessionAccessTokenExpired),
this.Q3c=!0,this.sxh())}HNe(){throw Error("Method not implemented.");}KNe(){throw Error("Method not implemented.");}Yah(){throw Error("Method not implemented.");}}Object(m.a)(uc,"ASessionExpirationManager",null,[]);var vc=a(63),wc=a(452),ub=a(10),aa=a(6);class Na{constructor(na,$a,Fb,Xb){this.v7l="";this.e7g=na;this.Jbl=Fb;this.Hbl=Xb;this.$7k=$a;na=(new Date(this.e7g)).format(n.AFrameworkApplication.OEk);this.v7l=this.$7k?String.format(Object(aa.a)("SessionExpiredMessage")):String.format(Object(aa.a)("SessionExpiringMessage"),
na)}vyk(na){1===na?this.Jbl&&this.Jbl(this.$7k):0===na&&n.AFrameworkApplication.vb.Qa(ub.a.close,2,wc.g)}dispose(){this.Hbl&&this.Hbl()}}Na.id="SessionExpirationDialog";Object(m.a)(Na,"SessionExpirationDialogSharedProperties",null,[]);class ia extends vc.a{constructor(na,$a,Fb,Xb){super($a);this.x$g=new Na(na,$a,Fb,Xb);this.uk=Na.id;n.AFrameworkApplication.vwm?(this.gf=1,this.Fg(0,Object(aa.a)("DialogClose"))):(this.gf=0,this.zz=!1);$a||1===n.AFrameworkApplication.Ea.mode?this.Fg(1,Object(aa.a)("SessionExpirationRefreshButton")):
this.Fg(1,Object(aa.a)("SessionExpiringSaveAndRefreshButton"));this.xG(Object(aa.a)("DefaultDialogTitle"),this.x$g.v7l,0,Object(B.a)(this,this.vyk,"sessionExpirationDialogHandler"))}vyk(na){this.x$g.vyk(na)}skh(){return this.Z0}cjh(){this.hide()}dispose(){super.dispose();this.x$g&&this.x$g.dispose()}}Object(m.a)(ia,"SessionExpirationDialog",vc.a,[1561]);var wa=a(85);class pa extends uc{constructor(na){super();this.Uxe=this.Vxe=!0;this.tDa=null;this.kb=new vb.a;this.YAe=()=>{this.tDa=null};this.AMe=
()=>{this.xr.refreshDocument(null)};this.xr=na}saf(na){this.kb.addHandler(pa.uxb,na)}uuh(na){this.kb.removeHandler(pa.uxb,na)}zUg(na){this.Vxe=na}yUg(na){this.Uxe=na}cJk(){this.tDa||wa.a.lF||(this.Uxe&&(this.tDa=new ia(this.mq,!1,this.AMe,this.YAe)),this.kb.raiseEvent(pa.BMe))}sxh(){this.tDa&&(this.tDa.skh()&&this.tDa.cjh(),this.tDa=null);this.Vxe&&(this.tDa=new ia(this.mq,!0,this.AMe,this.YAe));this.kb.raiseEvent(pa.iec)}}pa.iec="SE";pa.BMe="SEP";pa.uxb="SER";pa.URk="TRP";Object(m.a)(pa,"SessionExpirationManager",
uc,[1261,1263]);class Ea{}Ea.tnm="Aborting";Ea.sah="ActivityDuration";Ea.error="Error";Ea.errorsCount="Errors";Ea.failed="Failed";Ea.igh="FirstActivity";Ea.b0a="Initialized";Ea.V7m="KickedOut";Ea.c8m="LastActivity";Ea.O_l="RetryOverride";Ea.Uuh="RequestGroups";Ea.requests="Requests";Ea.responses="Responses";Ea.Mvh="SessionDuration";Ea.status="Status";Ea.success="Success";Ea.aTn="Successful";Ea.tokens="Tokens";Ea.t7j="PollingDuration";Object(m.a)(Ea,"SessionExpirationStrings",null,[]);var La=a(39);
class Aa{constructor(na){this.HW={};this.Bcb={};this.E3c={};this.BFl=15;this.z8k=!1;this.Flm=new Date;this.g9g=new Date;this.qam=()=>{r.ULS.sendTraceTag(41964821,217,50,r.ULS.Dlh({["Aggregate"]:this.Bcb,["Current"]:this.HW}))};this.ze=na;this.xja=new La.a(2,2,6E4*this.BFl,this.qam,135,"SL",!1);this.ze.Qb(this.xja);this.f2m()}f2m(){this.Bcb[Ea.Uuh]=0;this.Bcb[Ea.requests]=0;this.Bcb[Ea.responses]=0;this.Bcb[Ea.status]=Ea.b0a;this.Bcb[Ea.igh]=new Date;this.Bcb[Ea.Mvh]=0;this.Bcb[Ea.sah]=0;this.Bcb[Ea.Mvh]=
0;this.HW[Ea.Mvh]=0;this.Bcb[Ea.sah]=0;this.HW[Ea.sah]=0}get hwn(){this.E3c[Ea.t7j]=+new Date-+this.E3c[Ea.igh];return this.E3c}Q$i(na,$a){var Fb=na[$a];Fb=Fb?Fb:0;Fb++;na[$a]=Fb;this.LAk(na)}LAk(na){const $a=new Date;na[Ea.sah]=+$a-+this.g9g;this.g9g=$a;na[Ea.Mvh]=+this.g9g-+this.Flm;na[Ea.c8m]=this.g9g}xUa(na,$a){this.HW[na]=$a;this.LAk(this.HW)}zzk(na,$a){this.HW[na]=$a;this.LAk(this.HW)}bEe(na){this.Q$i(this.HW,na);this.Q$i(this.Bcb,na);this.Q$i(this.E3c,na)}flush(){this.z8k||(this.Bcb[Ea.status]=
this.HW[Ea.status],this.qam(this.xja),this.ze.Eta(this.xja,6E4*this.BFl))}DHn(){const na=this.HW[Ea.status];na&&(this.Bcb[Ea.status]=na);this.HW={}}GHn(){this.E3c={};this.E3c[Ea.t7j]=0;this.E3c[Ea.igh]=new Date}stop(){r.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.z8k=!0;this.ze.li(this.xja)}}Object(m.a)(Aa,"SessionLogger",null,[1257]);class nb{constructor(na,$a){this.X$g=na;this.vFb=$a}get tokens(){return this.X$g}get errors(){return this.vFb}}Object(m.a)(nb,
"TokenRefreshArgs",null,[1290]);var Wa=a(42),ea=a(401),Kb=a(25);class kc extends Sys.EventArgs{constructor(na,$a,Fb,Xb,nc,Nc,yd){super();this.E3c=na;this.Uuh=Xb;this.failed=nc;this.requests=Nc;this.responses=yd}}Object(m.a)(kc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var ac=a(1048);class eb{constructor(na,$a,Fb=null,Xb=null){this.h6e=this.Q3c=!1;this.Uxe=this.Vxe=!0;this.kb=new vb.a;this.Xyb=this.X0e=this.i$g=!1;this.nQh=null;this.jal=10;this.Ykd=this.Y8g=!1;this.wVe=0;this.JDn=()=>{this.bLf(!1);
return!sb.a.instance.b1a(n.AFrameworkApplication.mq)};this.qnm=(nc,Nc)=>{sb.a.instance.hUd?this.PIe(nc,Nc):this.oMh?(this.X0e=!1,this.bLf(!1)):(this.Q3c||r.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.PIe(nc,Nc))};this.rnm=(nc,Nc)=>{sb.a.instance.jFe?this.lzg(nc,Nc):(r.ULS.sendTraceTag(512247769,217,50,"Refreshing tokens since the user has network and session is expiring."),this.X0e=!1,this.bLf(!0))};this.YWh=(nc,Nc)=>{sb.a.instance.jFe?this.lzg(nc,
Nc):this.bLf(!0)};this.PIe=()=>{this.oMh||sb.a.instance.rZl(this.PIe);r.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.A5i(sb.a.instance.hUd)};this.KUn=()=>{const nc=this.Dw.hwn;r.ULS.sendTraceTag(555255521,217,50,"{0}",hb.c(nc));this.kb.raiseEvent(eb.URk,new kc(nc,nc[Ea.t7j],nc[Ea.igh],nc[Ea.Uuh],nc[Ea.failed],nc[Ea.requests],nc[Ea.responses]))};this.fAn=()=>{3E5<+new Date-+this.Y8k?(r.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.bLf(!1)):r.ULS.sendTraceTag(528867868,
217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")};this.ton=()=>{this.Ykd&&(r.ULS.sendTraceTag(507647818,217,20,"Navigating away with after skipping abort token refresh. VisibilityState: {0}, isBrowserHidden: {1}",ac.a[this.Q9b.hca],window.document.hidden),this.Ykd=!1)};this.J7e=na;this.oMh=n.AFrameworkApplication.E7m;this.ze=Kb.TaskManager.instance;r.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:n.AFrameworkApplication.mq,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:n.AFrameworkApplication.S7});this.Dw=Fb||new Aa(Kb.TaskManager.instance);this.hva=Xb;sb.a.instance.dbh(this.qnm);sb.a.instance.bbh(this.YWh);ea.SessionStatusManager.instance.Tah(this.YWh);ea.SessionStatusManager.instance.kfl(this.fAn);this.Y8k=new Date;n.AFrameworkApplication.D7m&&(sb.a.instance.yci=this.JDn);na=!1;n.AFrameworkApplication.ga&&(this.jal=n.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",
10),na=n.AFrameworkApplication.ga.getBooleanAppSetting("WopiTokenRefreshWhenNetworkResumed"));na?ea.SessionStatusManager.instance.Tah(this.rnm):ea.SessionStatusManager.instance.Tah(this.YWh);$a.execute(nc=>{this.Q9b=nc});this.QEk&&n.AFrameworkApplication.Mba&&n.AFrameworkApplication.Mba(this.ton)}saf(na){this.kb.addHandler(eb.uxb,na)}uuh(na){this.kb.removeHandler(eb.uxb,na)}bLf(na){if(!this.i$g&&!this.X0e)if(this.hva&&this.hva.P$a)this.Xyb=!0,this.Dw.xUa(Ea.status,Ea.V7m),this.Dw.flush(),this.Dw.stop();
else if(r.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",na,this.Xyb),this.Xyb)this.sxh();else{this.Dw.flush();this.Dw.DHn();this.Dw.bEe(Ea.Uuh);this.i$g=!0;this.Y8g||(this.Dw.GHn(),this.Y8g=!0,this.gAm());const $a=this.J7e.ZDn(na);$a.continueWith(()=>{if(this.J7e.oBn($a))this.Dw.bEe(Ea.aTn),this.Dw.xUa(Ea.status,Ea.success),this.Uxe=!1,this.oMh&&(this.Vxe=!1),this.X0e=!1,this.Y8k=new Date,this.CSn(),this.QEk&&(this.Ykd&&r.ULS.sendTraceTag(507647820,217,20,
"Successfully refresh token after permanent errors. VisibilityState: {0}, isBrowserHidden: {1}",ac.a[this.Q9b.hca],window.document.hidden),this.Ykd=!1),this.toe&&(this.wVe=0),this.kb.raiseEvent(eb.uxb,new nb($a.result.tokens,null));else{const Fb=$a.result.errors;this.Dw.bEe(Ea.failed);this.Dw.xUa(Ea.status,Ea.failed);if(this.QEk){if(!na){const Xb=this.J7e.B9c(Fb);this.Q9b.isActive?(!this.toe||2!==this.hva.networkState&&0!==this.hva.networkState||(this.wVe++,this.wVe>=this.uNl&&(this.Xyb=!0,ea.SessionStatusManager.instance.A7i=
!0)),this.toe?this.Xyb||(this.Xyb=Xb):this.Xyb=Xb,Xb&&(this.Ykd&&r.ULS.sendTraceTag(507647819,217,20,"Abort token refresh after skipping abort because of visibility state. VisibilityState: {0}, isBrowserHidden: {1}",ac.a[this.Q9b.hca],window.document.hidden),this.Ykd=!1)):(r.ULS.sendTraceTag(507654146,217,15,"Visibility is not active, not aborting token refresh. VisibilityState: {0}, IsPermanentErrors: {1}, isBrowserHidden: {2}",ac.a[this.Q9b.hca],Xb,window.document.hidden),Xb&&(this.Ykd=!0))}}else na||
(!this.toe||2!==this.hva.networkState&&0!==this.hva.networkState||(this.wVe++,this.wVe>=this.uNl&&(this.Xyb=!0,ea.SessionStatusManager.instance.A7i=!0)),this.toe?this.Xyb||(this.Xyb=this.J7e.B9c(Fb)):this.Xyb=this.J7e.B9c(Fb));this.Xyb&&(this.Dw.xUa(Ea.tnm,JSON.stringify(Fb)),r.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.X0e=!0;this.kb.raiseEvent(eb.uxb,new nb(null,Fb))}this.Dw.flush();this.i$g=!1})}}lzg(){this.h6e||this.Q3c||(r.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),
this.h6e=!0,this.cJk(sb.a.instance.jFe))}A5i(na){if(!this.Q3c){var $a=na?yb.a.FKn:yb.a.sessionAccessTokenExpired;const Fb={extendedProperties:new Map};Fb.extendedProperties.set("ErrorCode",String.format("{0}",$a));n.AFrameworkApplication.Xs($a,void 0,["SessionExpired"],Fb);na||(na=new Date,$a=new Date(n.AFrameworkApplication.S7),r.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",$a,na,+na-+$a),864E5>+na-+$a&&Wa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",
["SessionExpired"],!0,!0,!1,!0,Fb),2592E5>+na-+$a&&Wa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,Fb));this.Q3c=!0;this.sxh()}}CSn(){this.Y8g&&(this.ze.li(this.nQh),this.Y8g=!1)}gAm(){this.nQh=new La.a(2,2,1E3*this.jal,this.KUn,135);this.ze.Qb(this.nQh)}HNe(){throw Error("Method not implemented.");}KNe(){throw Error("Method not implemented.");}Yah(){throw Error("Method not implemented.");}get QEk(){return null!=this.V3k?this.V3k:this.V3k=
n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.AbortOnlyWhenActiveVisibility",!1):!1}get toe(){return null!=this.X3k?this.X3k:this.X3k=n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldKickoutWhenMaxRetries",!1):!1}get uNl(){return null!=this.U3k?this.U3k:this.U3k=n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.WordOnline.MaxConsecutiveTokenRefreshFailures",
3):3}}eb.iec="SE";eb.BMe="SEP";eb.uxb="SER";eb.URk="TRP";Object(m.a)(eb,"ASessionExpirationManagerWithRefresh",null,[]);class Hb extends eb{constructor(na,$a,Fb,Xb=null,nc=null){super($a,Fb,Xb,nc);this.tDa=null;this.YAe=()=>{this.tDa=null};this.AMe=()=>{this.xr.refreshDocument(null)};this.xr=na}zUg(na){this.Vxe=na}yUg(na){this.Uxe=na}cJk(na){if(!this.tDa&&!wa.a.lF){if(na)this.tDa=new ia(n.AFrameworkApplication.eec,!1,this.AMe,this.YAe);else if(this.Uxe){if(this.i$g)return;this.tDa=new ia(n.AFrameworkApplication.mq,
!1,this.AMe,this.YAe)}r.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",eb.BMe,na);this.kb.raiseEvent(eb.BMe)}}sxh(){this.tDa&&(this.tDa.skh()&&this.tDa.cjh(),this.tDa=null);if(this.Vxe){this.Dw.stop();if(this.hva&&this.hva.P$a)return;this.tDa=new ia(n.AFrameworkApplication.mq,!0,this.AMe,this.YAe)}r.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",eb.iec);this.kb.raiseEvent(eb.iec)}}Object(m.a)(Hb,"SessionExpirationManagerWithRefresh",eb,[1261,1263]);class ua{constructor(na,
$a){this.M7l=na;this.Js=$a}HNe(){this.M7l.HNe()}KNe(){this.M7l.KNe()}Yah(na){this.Js.addHandler(ua.uxb,na)}zUg(){throw Error("Method not implemented.");}yUg(){throw Error("Method not implemented.");}saf(){throw Error("Method not implemented.");}uuh(){throw Error("Method not implemented.");}}ua.uxb="TR";ua.iec="SE";Object(m.a)(ua,"SessionExpirationManagerWithRefreshV2",null,[1261]);class Va{constructor(na,$a,Fb,Xb){this.refreshPolicy=$a;this.Tia=Fb;this.JUn=Xb;this.KQl=()=>{this.uvh()};this.mSl=()=>
{this.uvh()};na.execute(nc=>{this.PDb=nc})}HNe(){r.ULS.sendTraceTag(507803545,217,50,"TokenRefreshScheduler.startScheduler: Starting token refresh scheduler.");this.uvh();this.PDb&&this.PDb.G4c(this.mSl);this.Tia.Jye(this.KQl)}KNe(){r.ULS.sendTraceTag(507803544,217,50,"TokenRefreshScheduler.stopScheduler: Stopping token refresh scheduler.");this.taskId||(window.clearTimeout(this.taskId),this.taskId=void 0);this.PDb&&this.PDb.vuh(this.mSl);this.Tia.JYl(this.KQl)}uvh(){if(this.Tia.GBc||this.Tia.P$a||
n.AFrameworkApplication.mi)this.KNe();else{var na=this.Ykl();this.taskId&&window.clearTimeout(this.taskId);r.ULS.sendTraceTag(507803543,217,50,"TokenRefreshScheduler.scheduleNextRefresh: Scheduling next refresh with timeout: {0}.",na);this.taskId=window.setTimeout(()=>{0<this.Ykl()||(this.LEl=(new Date).getTime(),this.JUn.refreshToken());this.uvh()},na)}}Ykl(){const na=(new Date).getTime(),$a=n.AFrameworkApplication.mq-na-1E3*n.AFrameworkApplication.bsa;return 0>$a?this.LEl?Math.max(this.LEl+this.refreshPolicy.Sdd-
na,0):0:$a}}Object(m.a)(Va,"TokenRefreshScheduler",null,[]);var Yb=a(153),Cb=a(70),ca=a(83);class Ra{}Object(m.a)(Ra,"NamedResult",null,[]);class bb extends Ra{}Object(m.a)(bb,"ErrorInfo",Ra,[]);class wb{}Object(m.a)(wb,"Error",null,[]);var Fa=a(68),rb=a(183);let $b=0,ec=0;var pc=a(91);class dd{constructor(na,$a,Fb){this.LCi=na;this.Tia=Fb;this.kpiName="TokenRefresh";$a.execute(Xb=>{this.PDb=Xb})}ean(){this.LCi.logKpiUsage({kpiName:this.kpiName,kpiType:pc.b.SuccessBased})}dan(){const na=new Map;na.set("IsExpiring",
this.Tia.rlb.toString());na.set("IsOnline",window.navigator.onLine.toString());na.set("IsHidden",window.document.hidden.toString());na.set("VisibilityState",this.PDb?ac.a[this.PDb.hca]:"undefined");this.LCi.logKpiSuccess({kpiName:this.kpiName,optionalProperties:{additionalValues:{extendedProperties:na}}})}RFe(na,$a){const Fb=new Map;Fb.set("IsExpiring",this.Tia.rlb.toString());Fb.set("IsOnline",window.navigator.onLine.toString());Fb.set("IsHidden",window.document.hidden.toString());Fb.set("VisibilityState",
this.PDb?ac.a[this.PDb.hca]:"undefined");$a&&Fb.set("ErrorMessage",$a);this.LCi.logKpiFailure({kpiName:this.kpiName,errorName:na,optionalProperties:{additionalValues:{extendedProperties:Fb}}})}}Object(m.a)(dd,"TokenRefreshKPILogger",null,[]);var Ad=a(185);class Jb{constructor(na,$a,Fb,Xb,nc){this.Tia=$a;this.refreshPolicy=Fb;this.Js=Xb;this.jN=()=>{var Nc=this.Tia,yd=this.refreshPolicy,Ud=this.Js,ie=this.msj,Be=this.PDb;Nc.rlb&&Be&&Be.isActive?(r.ULS.sendTraceTag(507593738,217,15,"TokenRefresh time out."),
ec++,ie.RFe("TokenRefreshFailed_Timeout"),(2===Nc.networkState||0===Nc.networkState)&&f&&ec==e()*yd.Vqh&&Ud.raiseEvent(ua.iec,yb.a.$$l)):(ec=0,ie.RFe("TokenRefreshFailed_Timeout_SkipProcessingError"))};na.execute(Nc=>{this.Qzl=Nc;Nc.jE(Cb.a.LDe,this.G_j.bind(this))});nc.execute(Nc=>{this.PDb=Nc});this.msj=new dd(Ad.a.getInstance({crewAlias:"wwrelfc",featureName:"TokenRefreshManagerV2",areaName:"Infrastructure"}),nc,this.Tia)}refreshToken(){if(this.Qzl){var na={};na[Yb.a.Pvh]=this.refreshPolicy.tokens;
var $a=ca.a.create().toString();r.ULS.sendTraceTag(507803554,217,50,"TokenRefreshManagerV2.refreshToken: Refreshing token.");this.toe&&(this.nRk=window.setTimeout(this.jN,this.refreshPolicy.Sdd));this.Qzl.sendMessage(Cb.a.Lbf,na,$a);this.msj.ean()}else r.ULS.sendTraceTag(507803555,217,10,"TokenRefreshManagerV2.refreshToken: HostPostMessenger is not initialized.")}G_j(na){if(na.MessageId===Cb.a.LDe)if(this.nRk&&(window.clearTimeout(this.nRk),this.nRk=void 0),this.Tia.GBc||this.Tia.P$a||n.AFrameworkApplication.mi)r.ULS.sendTraceTag(507794142,
217,50,"TokenRefreshManagerV2.onHostResponseReceived: Skipping host response processing because session has ended.");else{r.ULS.sendTraceTag(507803553,217,50,"TokenRefreshManagerV2.onHostResponseReceived: Received response.");var $a=this.PDb,Fb=this.refreshPolicy,Xb=this.Js,nc=this.Tia,Nc=this.msj,yd=na.Values[Yb.a.Pvh];if(!yd||0>=yd.length)r.ULS.sendTraceTag(507778646,217,15,"Found no entries in the dictionary"),yd=na.Values;if(0==yd.length)r.ULS.sendTraceTag(507778645,217,15,"No tokens/errors in TokenRefresh response."),
Nc.RFe("TokenRefreshFailed_NoTokens");else{na=[];var Ud=[];for(const qh of yd)if((yd=qh)&&yd.Value?na.push(yd):(yd=qh)?Ud.push(yd):r.ULS.sendTraceTag(507778644,217,15,"Unexpected Token/ErrorInfo in TokenRefresh response."),0<na.length){yd=Xb;var ie=na,Be=Nc;$b=0;f()&&(ec=0);for(const k of ie)k.Name===Yb.a.accessToken&&(ie=(new Date).getTime(),k.Expiry>n.AFrameworkApplication.mq?(r.ULS.sendTraceTag(507778643,217,20,"Updating AccessToken: {0}",{["AccessTokenTtl"]:k.Expiry,["NowGetTime"]:ie,["BootTime"]:n.AFrameworkApplication.S7},
"PreviousAccessTokenTtl",n.AFrameworkApplication.mq),Be.dan(),n.AFrameworkApplication.accessToken=k.Value,n.AFrameworkApplication.mq=Math.floor(k.Expiry),n.AFrameworkApplication.dgd=ie,n.AFrameworkApplication.G4=Math.floor(k.Expiry),yd.raiseEvent(ua.uxb)):(r.ULS.sendTraceTag(507778642,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:k.Expiry,["NowGetTime"]:ie,["BootTime"]:n.AFrameworkApplication.S7},"PreviousAccessTokenTtl",n.AFrameworkApplication.mq),
Be.RFe("TokenRefreshFailed_AccessTokenExpiresTooSoon")))}else if(0<Ud.length){yd=Fb;Be=Xb;ie=Ud;var oe=Nc;if(nc.rlb&&$a&&$a.isActive){f()&&ec++;yd.B9c(new Fa.a(ie))&&$b++;var rf=[];for(const k of ie){var Vf=k,xg=Object.assign(new bb,{Name:Vf.Name,Errors:[],SPCorrelationId:Vf.SPCorrelationId});for(const E of Vf.Errors)Vf=new wb,Vf.Id=E.Id,Vf.Details=rb.a.pQb(E.Details,500),xg.Errors.push(Vf);r.ULS.sendTraceTag(507778641,217,15,"Received error for token {0}. Errors: {1}. SPCorrelationId: {2}",xg.Name,
JSON.stringify(xg.Errors),xg.SPCorrelationId);rf.push(xg)}oe.RFe("TokenRefreshFailed_ErrorReceived",JSON.stringify(rf));if($b==(n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.WordOnline.MaxConsecutivePermanentErrors",3):3)){oe=Be.raiseEvent;rf=ua.iec;xg=yb.a.sessionAccessTokenExpired;for(const k of ie)for(const E of k.Errors)if(ie=parseInt(E.Id),Vf=E.Details.toString(),isNaN(ie))xg=yb.a.cam;else{switch(ie){case 401:xg=yb.a.gam;b&&c(Vf)&&(xg=yb.a.mAh);break;
case 403:xg=yb.a.aam;b&&c(Vf)&&(xg=yb.a.mAh);break;case 500:xg=yb.a.bam;break;case 503:xg=yb.a.eam}xg===yb.a.sessionAccessTokenExpired&&(xg=500<ie?yb.a.dam:yb.a.Z$l)}ie=xg;oe.call(Be,rf,ie)}f&&ec==e()*yd.Vqh&&Be.raiseEvent(ua.iec,yb.a.$$l)}else $b=0,f()&&(ec=0),oe.RFe("TokenRefreshFailed_SkipProcessingError")}}}}get toe(){return null!=this.W3k?this.W3k:this.W3k=n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldKickoutWhenMaxRetries",!1):
!1}}Object(m.a)(Jb,"TokenRefreshManagerV2",null,[]);var Bc=a(1130);class Mc{constructor(na,$a,Fb,Xb=null,nc=null,Nc,yd){this.Ucl=!1;this.Wa=null;this.U2c=na;this.vWa=$a;this.BWh=Fb;this.Dw=Xb||new Aa(Kb.TaskManager.instance);this.hva=nc;this.Ccl=Nc;this.eld=yd}create(){this.Ucl=n.AFrameworkApplication.DE;if(!this.Ucl)return new pa(this.U2c);r.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.Wa)switch(n.AFrameworkApplication.i1k){case 1:r.ULS.sendTraceTag(39408090,
217,50,"Creating new NullSessionExpirationManager");this.Wa=new bc(this.U2c);break;case 2:if(Object(Bc.a)()){r.ULS.sendTraceTag(507803552,217,50,"Creating new SessionExpirationManagerWithRefreshV2");const na=new vb.a;this.Wa=new ua(new Va(this.BWh,this.Ccl,this.hva,new Jb(this.eld,this.hva,this.Ccl,na,this.BWh)),na)}else r.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh"),this.Wa=new Hb(this.U2c,this.vWa,this.BWh,this.Dw,this.hva);break;default:r.ULS.sendTraceTag(39408092,
217,50,"Creating new legacy SessionExpirationManager"),this.Wa=new pa(this.U2c)}r.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.Wa).getName());return this.Wa}}Object(m.a)(Mc,"SessionExpirationManagerFactory",null,[1260]);var ed=a(231),Yc=a(134),ab=a(1145),jb=a(80);class cc{constructor(na,$a,Fb,Xb=null,nc=!1,Nc=null,yd=!1,Ud=!1,ie=!1,Be=!1,oe=!1){this.a9a=0;this.$yb=this.$u=null;this.X$g=new Fa.a;this.vFb=new Fa.a;this.fT=null;this.Rmd=
!1;this.K7e=this.L7e=null;this.xHn=()=>{this.j_l()};Object(Bc.a)()||(this.ze=na,this.kal=$a,this.kal.execute(rf=>{rf.jE(Cb.a.LDe,Object(B.a)(this,this.G_j,"onHostResponseReceived"))}),this.hHa=Fb,this.Dcl=new ab.a("WebServiceCall","TokenRefresh"),this.Dw=Xb||new Aa(na),this.Elm=nc,this.uDa=Nc?Nc:ea.SessionStatusManager.instance,this.u6k=yd,this.h8g=Ud,this.Olm=ie,this.Plm=Be,this.Obl=oe)}G_j(na){if(na.MessageId!==Cb.a.LDe)r.ULS.sendTraceTag(39408099,217,15,"Unexpected message.");else{var $a=new Fa.a,
Fb=new Fa.a;this.Dw.bEe(Ea.responses);var Xb=na.Values[Yb.a.Pvh];if(!Xb||0>=Xb.length)r.ULS.sendTraceTag(40122317,217,15,"Found no tokens in the dictionary"),Xb=na.Values;this.Dw.xUa("Correlation",na.CorrelationId);var nc="";for(let Ud=0;Ud<Xb.length;Ud++){this.Dw.zzk(Ea.tokens,Xb.length);var Nc=Xb[Ud],yd=Nc;if(!yd||!yd.Name)continue;this.Dw.bEe(yd.Name);const ie=Nc;if(ie&&ie.Value)$a.add(ie),this.X$g.add(ie),this.h8g||this.Dw.xUa(Ea.status,Ea.success),this.u6k&&this.uDa&&this.uDa.u_l();else if(Nc=
this.DSm(Nc),r.ULS.sendTraceTag(39408129,217,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",yd.Name,JSON.stringify(Nc),this.$yb),Fb.add(Nc),this.h8g||(this.vFb.add(Nc),nc=JSON.stringify(Nc),this.Dw.xUa(Ea.error,JSON.stringify(Nc)),this.Dw.xUa(Ea.status,Ea.failed)),this.u6k)for(const Be of Nc.Errors)yd=this.IOm(Be),this.uDa&&this.uDa.gel(yd)}this.h8g?(0<Fb.count?this.K7e?this.K7e(new nb($a,Fb)):r.ULS.sendTraceTag(512267295,217,15,"Received errors but the promise has completed.TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}, Error: {3}",
this.$yb,this.uDa.rlb,this.Rmd.toString(),nc):this.L7e?this.L7e(new nb($a,Fb)):r.ULS.sendTraceTag(512267294,217,15,"Received valid tokens but the promise has completed. TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}",this.$yb,this.uDa.rlb,this.Rmd.toString()),r.ULS.sendTraceTag(512344162,217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",$a.count,Fb.count,na.CorrelationId,this.$yb)):(0<Fb.count&&""!==nc?(Xb=Object.assign({},{extendedProperties:new Map}),
Xb.extendedProperties.set("Errors",nc),Xb.extendedProperties.set("RetryCount",this.a9a.toString()),Xb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),Xb.extendedProperties.set("IsTokenExpiring",this.Rmd.toString()),this.woj()&&Xb.extendedProperties.set("IsAppShuttingDown",n.AFrameworkApplication.mi.toString()),Wa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Xb)):Wa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),r.ULS.sendTraceTag(39408130,
217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",$a.count,Fb.count,na.CorrelationId,this.$yb),0<Fb.count&&!this.B9c(Fb)?(na=this.hHa.pwl(Fb),na!==this.hHa.Sdd&&(this.Dw.zzk(Ea.O_l,na),this.ze.Eta(this.$u,na))):(this.Dw.flush(),this.$u&&this.ze.li(this.$u),this.fT&&!this.fT.task.isCompleted?this.fT.vj(new nb($a,Fb)):r.ULS.sendTraceTag(512267293,217,15,"Received results but the task has completed")))}}DSm(na){if(!na)return null;const $a=Object.assign(new bb,
{Name:na.Name,Errors:[],SPCorrelationId:na.SPCorrelationId});for(const Fb of na.Errors)na=new wb,na.Id=Fb.Id,na.Details=rb.a.pQb(Fb.Details,500),$a.Errors.push(na);return $a}j_l(){jb.a.BI("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.a9a>=this.hHa.Vqh?(r.ULS.sendTraceTag(39408132,217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.$yb),this.NAm(this.fT)):(Wa.Health.instance.recordKpiUsage("WACTokenRefresh",pc.b.SuccessBased,"wwrelfc",null),this.B1l())}B1l(){const na=
{};na[Yb.a.Pvh]=this.hHa.tokens;this.Olm&&(na[Yb.a.HKn]=this.Plm);const $a=ca.a.create().toString();r.ULS.sendTraceTag(39408133,217,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.hHa.tokens),this.a9a+1,$a,this.$yb);this.kal.execute(Fb=>{Fb.sendMessage(Cb.a.Lbf,na,$a)});this.a9a++;this.Dw.bEe(Ea.requests)}NAm(na){const $a=new Fa.a;for(let Fb=0;Fb<this.hHa.tokens.length;Fb++){const Xb=Object.assign(new bb,{Name:this.hHa.tokens[Fb],Errors:[Object.assign(new wb,
{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});$a.add(Xb);this.vFb.add(Xb)}this.ze.li(this.$u);this.Dw.xUa(Ea.errorsCount,JSON.stringify(this.vFb));this.Dw.xUa(Ea.status,Ea.failed);na&&!na.task.isCompleted&&na.vj(new nb(new Fa.a,this.vFb))}woj(){return n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.isChangeGateEnabled("SkipSessionExpiredVetoForShutdown")}ZDn(na){jb.a.BI("ej4if276;fheca743");jb.a.BI("5d4fi128;abe10395");
jb.a.BI("7db39907;cegi0367;ijicc640");this.Dcl.start();this.woj()&&this.ze.O_a&&(r.ULS.sendTraceTag(508351137,217,15,"Restarting taskmanager, is shutting down {0}",n.AFrameworkApplication.mi),this.ze.Gbb());this.Rmd=na;this.$yb=ca.a.create().toString();r.ULS.sendTraceTag(41755338,217,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.$yb,this.Rmd);this.a9a=0;this.vFb.clear();this.X$g.clear();this.fT=new Mb.a;this.h8g?this.k_l(this.hHa.Vqh).then($a=>{this.fT&&!this.fT.task.isCompleted&&
this.fT.vj($a);this.K7e=this.L7e=null;this.Dw.xUa(Ea.errorsCount,JSON.stringify(this.vFb));this.Dw.xUa(Ea.status,Ea.success);this.Dw.flush()}).catch($a=>{this.fT&&!this.fT.task.isCompleted&&this.fT.vj(Object(ed.a)(1290,$a));this.K7e=this.L7e=null;this.Dw.xUa(Ea.errorsCount,JSON.stringify(this.vFb));this.Dw.xUa(Ea.status,Ea.failed);this.Dw.flush()}):(this.$u=new La.a(this.hHa.priority,2,this.hHa.Sdd,this.xHn,98,Cb.a.Lbf,!0),this.Elm&&this.j_l(),this.ze.Qb(this.$u));return this.fT.task}k_l(na){const $a=
this,Fb=new Promise((Ud,ie)=>{$a.L7e=Ud;$a.K7e=ie;Wa.Health.instance.recordKpiUsage("WACTokenRefresh",pc.b.SuccessBased,"wwrelfc",null);$a.B1l()}),Xb=this,nc=new Promise((Ud,ie)=>{window.setTimeout(()=>{ie(Xb.vml("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},Xb.hHa.Sdd)});let Nc=na;const yd=this;return new Promise((Ud,ie)=>{Nc--;Promise.race([Fb,nc]).then(Be=>{Wa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ud(Be)}).catch(Be=>{var oe=yd.hHa.Sdd;
if(Object(Yc.a)(1290,Be)&&(Be=Object(ed.a)(1290,Be),0<Be.errors.count)){yd.c$m(Be.errors);yd.Tdl(Be.errors);if(yd.B9c(Be.errors)){ie(Be);return}const rf=yd.hHa.pwl(Be.errors);rf!==yd.hHa.Sdd?(yd.Dw.zzk(Ea.O_l,rf),oe=rf):yd.e7m(Be.errors)&&(oe=0)}Nc?window.setTimeout(()=>{yd.k_l(Nc).then(Ud).catch(ie)},oe):(oe=yd.vml("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),yd.Tdl(oe.errors),ie(oe),r.ULS.sendTraceTag(512267292,217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
yd.$yb))})})}Tdl(na){for(const $a of na)this.vFb.add($a)}e7m(na){if(!na.count)return!1;na=na.ha(na.count-1);return na.Errors.length?"TIMEOUT"==na.Errors[0].Id:!1}vml(na,$a){const Fb=new Fa.a;for(let Xb=0;Xb<this.hHa.tokens.length;Xb++){const nc=this.OAm(this.hHa.tokens[Xb],na,$a);Fb.add(nc)}return new nb(new Fa.a,Fb)}OAm(na,$a,Fb){return Object.assign(new bb,{Name:na,Errors:[Object.assign(new wb,{Id:$a,Details:Fb})]})}c$m(na){if(na.count){na=na.ha(na.count-1);na=JSON.stringify(na);var $a=Object.assign({},
{extendedProperties:new Map});$a.extendedProperties.set("Errors",na);$a.extendedProperties.set("RetryCount",this.a9a.toString());$a.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());$a.extendedProperties.set("IsTokenExpiring",this.Rmd.toString());this.woj()&&$a.extendedProperties.set("IsAppShuttingDown",n.AFrameworkApplication.mi.toString());Wa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,$a);this.Dw.xUa(Ea.error,na);this.Dw.xUa(Ea.status,
Ea.failed)}}oBn(na){this.Dcl.stop();const $a=this.gYm(na.result.errors);r.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!$a,this.$yb,this.Rmd,this.a9a,this.vFb.count,0<na.result.errors.count?na.result.errors.ha(0).Name:"",0<na.result.errors.count&&0<na.result.errors.ha(0).Errors.length?na.result.errors.ha(0).Errors[0].Id:"",0<na.result.errors.count&&
0<na.result.errors.ha(0).Errors.length?na.result.errors.ha(0).Errors[0].Details:"");return $a?!1:this.nBn(na.result.tokens)}B9c(na){return this.hHa.B9c(na)}nBn(na){for(let $a=0;$a<na.count;$a++){const Fb=na.ha($a);if(Fb.Name===Yb.a.accessToken){const Xb=(new Date).getTime();Fb.Expiry>n.AFrameworkApplication.mq?(r.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Fb.Expiry,["NowGetTime"]:Xb,["BootTime"]:n.AFrameworkApplication.S7},"PreviousAccessTokenTtl",n.AFrameworkApplication.mq),
n.AFrameworkApplication.accessToken=Fb.Value,n.AFrameworkApplication.mq=Math.floor(Fb.Expiry),n.AFrameworkApplication.dgd=Xb,n.AFrameworkApplication.G4=Math.floor(Fb.Expiry)):r.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:Fb.Expiry,["NowGetTime"]:Xb,["BootTime"]:n.AFrameworkApplication.S7},"PreviousAccessTokenTtl",n.AFrameworkApplication.mq)}}return!0}gYm(na){let $a=!1;for(let Fb=0;Fb<na.count;Fb++){$a=!0;const Xb=
na.ha(Fb);r.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2}, SPCorrelationId: {3}",Xb.Name,JSON.stringify(Xb.Errors),this.$yb,Xb.SPCorrelationId)}return $a}bEl(na){return na.includes("aadInteractionRequired")||na.includes("sessionRevocation")||na.includes("blockAccessForTenantRestrictions")||na.includes("revoked")||na.includes("Due to organizational policies, you can't access these resources from this network location")?!0:!1}IOm(na){let $a=yb.a.sessionAccessTokenExpired;
const Fb=parseInt(na.Id);na=na.Details.toString();if(isNaN(Fb))$a=yb.a.cam;else{switch(Fb){case 401:$a=yb.a.gam;this.Obl&&this.bEl(na)&&($a=yb.a.mAh);break;case 403:$a=yb.a.aam;this.Obl&&this.bEl(na)&&($a=yb.a.mAh);break;case 500:$a=yb.a.bam;break;case 503:$a=yb.a.eam}$a===yb.a.sessionAccessTokenExpired&&($a=500<Fb?yb.a.dam:yb.a.Z$l)}return $a}}Object(m.a)(cc,"TokenRefreshManager",null,[1259]);class Hc{constructor(){this.Sdd=n.AFrameworkApplication.f0n;this.Vqh=n.AFrameworkApplication.d0n;this.tokens=
n.AFrameworkApplication.tVm();this.priority=n.AFrameworkApplication.g0n;this.abl=this.JMn();this.rye=n.AFrameworkApplication.sVm()}B9c(na){if(this.cPn){var $a=[];for(const Xb of na)if(Xb.Errors)for(const nc of Xb.Errors)$a.push(nc.Id);na=JSON.stringify($a);if(this.rye&&0<this.rye.length)for(var Fb of this.rye)if(0<Fb.length&&0<=na.indexOf(Fb))return!0}else if(Fb=JSON.stringify(na),this.rye&&0<this.rye.length)for($a of this.rye)if(0<$a.length&&0<=Fb.indexOf($a))return!0;return!1}pwl(na){try{if(na)for(const $a of na)if($a.Errors)for(const Fb of $a.Errors)if(Fb.Id in
this.abl)return Number.parseInvariant(this.abl[Fb.Id].toString())}catch($a){r.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",$a.toString())}return this.Sdd}JMn(){const na={};try{if(!n.AFrameworkApplication.Aih()||0>=n.AFrameworkApplication.Aih().length||""===n.AFrameworkApplication.Aih()[0])return na;for(const $a of n.AFrameworkApplication.Aih())0<$a.length&&(na[$a]=n.AFrameworkApplication.e0n)}catch($a){r.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
$a.toString())}return na}get cPn(){return null!=this.Y3k?this.Y3k:this.Y3k=n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseErrorsForParsingPermanentErrors",!1):!1}}Object(m.a)(Hc,"TokenRefreshPolicy",null,[1258]);class Vc{constructor(){this.Ha=null}get name(){return"Common.App.SessionExpiration"}init(){n.AFrameworkApplication.ga.fg(()=>{this.LRb()})}LRb(){this.Ha.resolve("Common.ISessionExpirationManagerFactory");this.Ha.resolve("Common.ISessionExpirationManager");
this.Ha.resolve("Common.ISessionExpirationManagerWithDialog");Object(Bc.a)()&&this.Ha.resolve("Common.ISessionExpirationManagerV2").HNe()}dispose(){}lc(na){this.Ha=na;na.register(1257,"Common.App.SessionExpiration.ISessionLogger").ma().na(()=>new Aa(Kb.TaskManager.instance));na.register(1258,"Common.App.SessionExpiration.ITokenRefreshPolicy").ma().na(()=>new Hc);na.register(1259,"Common.App.SessionExpiration.ITokenRefreshManager").ma().na(()=>new cc(Kb.TaskManager.instance,n.AFrameworkApplication.k3(),
na.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),na.resolve("Common.App.SessionExpiration.ISessionLogger"),n.AFrameworkApplication.ga.getBooleanAppSetting("WopiTokenRefreshSendTokenRequestWithoutTasks"),na.yb("Common.ISessionStatus"),n.AFrameworkApplication.ga.getBooleanAppSetting("WopiAllowTokenRefreshErrorTracking"),n.AFrameworkApplication.ga.getBooleanAppSetting("WopiTokenRefreshSyncMessageWithTimeout"),n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAddAllowAADPopupInPostMessage",
!1),n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAllowAADPopupForTokenRefresh",!1),n.AFrameworkApplication.ga.getBooleanAppSetting("WopiTokenRevokedTokenExperiment")&&n.AFrameworkApplication.ga.getBooleanAppSetting("ShowTokenRevocationErrorMessage")));na.register(1260,"Common.ISessionExpirationManagerFactory").ma().na(()=>new Mc(n.AFrameworkApplication.Ea,na.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),na.Na("Common.App.VisibilityManagement.IVisibilityManager"),
na.resolve("Common.App.SessionExpiration.ISessionLogger"),na.yb("Common.ISessionStatus"),na.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),na.Na("Postmessage.IHostPostmessenger")));na.register(1261,"Common.ISessionExpirationManagerWithDialog").ma().na(()=>na.resolve("Common.ISessionExpirationManagerFactory").create());na.register(1262,"Common.ISessionExpirationManagerV2").ma().na(()=>na.resolve("Common.ISessionExpirationManagerWithDialog"));na.register(1263,"Common.ISessionExpirationManager").ma().na(()=>
na.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){l.a.instance.Fc(new Vc)}}Object(m.a)(Vc,"SessionExpirationPackage",null,[3,4]);var Tc=a(7),cd=a(652),Lb=a(256),Rc=a(341),md=a(349),Zc=a(366),ld=a(279),fe=a(248),Ac=a(250),R=a(251);class za extends wa.a{constructor(na,$a){super();this.UEa=null;this.Yan=!1;this.qbn="";this.EKl=this.FKl=this.UGl=this.VGl=null;this.gf=3;this.Fg(1,ResourceStrings.L_SetSlideOrientationMaximize);this.Fg(2,ResourceStrings.L_SetSlideOrientationEnsure);
this.ia=na;this.RKl=$a.Yp(ld.a.xTl)}dispose(){this.UEa=null;super.dispose()}showDialog(na){this.Dq(na);this.VGl=document.getElementById("btnMaximize");this.FKl=Object(B.a)(this,this.Srn,"onScaleUpButton");F.a.addHandler(this.VGl,"click",this.FKl);this.UGl=document.getElementById("btnEnsure");this.EKl=Object(B.a)(this,this.Rrn,"onScaleDownButton");F.a.addHandler(this.UGl,"click",this.EKl)}Dq(na){this.Pyb=Object(B.a)(this,this.XMn,"setSlideOrientationRatio");this.oec(na);this.LB.style.width="420px";
this.show()}hide(){this.Ed&&(n.AFrameworkApplication.Ea.yy.Cr(md.AFrame.EAa),super.hide())}Srn(na){this.ia.Cb(R.a.qne,2);na.preventDefault();this.nGa&&this.hide()}Rrn(na){this.ia.Cb(R.a.pne,2);na.preventDefault();this.nGa&&this.hide()}XMn(na){1===na?this.ia.Cb(R.a.qne,2):2===na?this.ia.Cb(R.a.pne,2):fe.a.J(25277209,822,50,"Cancle the slide orientation change.");this.nGa&&this.hide()}oec(){this.hL();this.n7()}hL(){super.hL();Sys.UI.DomElement.addCssClass(this.Ed,this.qbn);var na=$get("WACDialogTitleText");
na.innerText=ResourceStrings.l_SetSlideScaleTitle;na.setAttribute("title",ResourceStrings.l_SetSlideScaleTitle);na=document.createElement("div");na.id=this.ap("WACDialogHtmlPanel");na.className="WACDialogHtmlPanel";this.LB.appendChild(na);this.UEa=document.createElement("div");this.UEa.id=this.ap("WACDialogText");na.appendChild(this.UEa);na=document.createElement("div");na.id=this.ap("Scalediv");na.className="WACDialogRow";this.UEa.appendChild(na);var $a=document.createElement("label");$a.id=this.ap("Scalelabel");
$a.innerText=ResourceStrings.L_SetSlideOrientationInformation;na.appendChild($a);na=document.createElement("div");na.id=this.ap("ScaleMode");na.setAttribute("style","margin-left: 20px;");na.className="WACDialogRow";this.UEa.appendChild(na);$a=za.zml(ld.a.f6j+"_MaximizeFit_170x130x32",this.RKl,ResourceStrings.L_SetSlideOrientationMaximize);$a.id=this.ap("btnMaximize");var Fb=document.createElement("td");Fb.className=String.format("clip{0}x{1}","170","130");Fb.setAttribute("style","border: #ccc 1px solid");
Fb.appendChild($a);$a=za.zml(ld.a.f6j+"_Ensurefit_170x130x32",this.RKl,ResourceStrings.L_SetSlideOrientationEnsure);$a.id=this.ap("btnEnsure");var Xb=document.createElement("td");Xb.className=String.format("clip{0}x{1}","170","130");Xb.setAttribute("style","border: #ccc 1px solid");Xb.appendChild($a);var nc=document.createElement("td");nc.setAttribute("style","width: 30px;");$a=document.createElement("tr");$a.appendChild(Fb);$a.appendChild(nc);$a.appendChild(Xb);Fb=document.createElement("td");Fb.setAttribute("align",
"center");Xb=document.createElement("label");Xb.id=this.ap("Maxlabel");Xb.className="UIFontBold";Xb.innerText=ResourceStrings.L_SetSlideOrientationMaximize;Fb.appendChild(Xb);Xb=document.createElement("td");Xb.setAttribute("align","center");nc=document.createElement("label");nc.id=this.ap("Ensurelabel");nc.className="UIFontBold";nc.innerText=ResourceStrings.L_SetSlideOrientationEnsure;Xb.appendChild(nc);const Nc=document.createElement("td");Nc.setAttribute("style","width: 30px;");nc=document.createElement("tr");
nc.appendChild(Fb);nc.appendChild(Nc);nc.appendChild(Xb);Fb=document.createElement("table");Fb.appendChild($a);Fb.appendChild(nc);na.appendChild(Fb)}n7(){this.Axh(wa.a.zDg+(wa.a.$ca-za.Avm)/2-12,wa.a.yDg+(wa.a.ada-za.Dvm)/2-12)}Axh(na,$a){this.Ed.style.top=(0>na?0:na)+"px";Ac.a("DeprecateIE.SetSlideOrientation")?this.Ed.style.left=(0>$a?0:$a)+"px":Tc.a.WSb&&n.AFrameworkApplication.isRtl?this.Ed.style.right=(0>$a?0:$a)+"px":this.Ed.style.left=(0>$a?0:$a)+"px";this.Yan||(this.Ed.style.width=String.format("{0}em",
this.width));this.Ed.style.display="Block"}static zml(na,$a,Fb){const Xb=document.createElement("img");Xb.className=na;Xb.setAttribute("Unselectable","on");Xb.setAttribute(Zc.a.pi,Zc.a.KZ);Xb.src=$a;Fb&&(Xb.alt=Fb,Xb.title=Fb);return Xb}}za.Dvm=350;za.Avm=200;Object(m.a)(za,"SetSlideOrientationDialog",wa.a,[]);var X=a(269),lb=a(317),oc=a(421),Oc=a(51);class sd extends N.a{constructor(na,$a){super(!1,!1,!0);this.Ell=this.QSa=null;if(!na)throw Error.argumentNull("actionManager");if(!$a)throw Error.argumentNull("presentationReader");
this.ia=na;this.oc=$a}KAb(){this.QSa=Object(B.a)(this,this.YMn,"setSlideSizeAndLayoutDialogResultHandler");this.Ell=this.LKm(this.xCe());this.Dq(ResourceStrings.L_SetSlideSize,this.QSa,this.Ell)}YMn(na,$a){1===na&&this.ia.Qa(R.a.ywh,2,$a);this.dispose()}xCe(){const na=this.oc.lB(),$a={};$a.height=na.height;$a.width=na.width;$a.slideType=this.oc.Hwl();return $a}LKm(na){return{["id"]:"SlideSizeAndLayoutDialog",["bodyControls"]:na,["numberFormatInfo"]:Oc.e().numberFormatInfo}}}Object(m.a)(sd,"SlideSizeAndLayoutDialog",
N.a,[]);class Ld{constructor(na,$a,Fb,Xb,nc,Nc,yd,Ud,ie,Be){this.LLc=this.$Zb=this.XNa=0;this.slideSizeType="O_screen4x3 O_letterPaper O_A4paper O_35mm O_overhead O_banner O_custom O_ledgerPaper O_A3Paper O_B4ISOPaper O_B5ISOPaper O_B4JISPaper O_B5JISPaper O_HagakiCard O_screen16x9 O_screen16x10 O_Widescreen".split(" ");this.C5l=[4320,4320,4320,4320,4320,576,4896,5754,6048,5115,3387,5184,3456,1872,3240,3600,4320];this.I5l=[5760,5760,6240,6480,5760,4608,6336,7672,8064,6820,4516,6912,4608,2880,5760,
5760,7680];this.ia=na;this.Ma=$a;this.hf=Fb;this.Mb=Xb;this.$b=nc;this.va=Nc;this.pa=Ud;this.oc=yd;this.rf=ie;this.ic=Be}Hb(){this.ia.sa(R.a.Yhe,X.a.application,Object(B.a)(this,this.Mek,"querySlideSize"),96);this.ia.sa(R.a.Xhe,X.a.application,Object(B.a)(this,this.Mek,"querySlideSize"),96);this.ia.sa(R.a.eLe,X.a.application,Object(B.a)(this,this.Mek,"querySlideSize"),96);this.ia.za(R.a.a3l,X.a.application,cd.a.m5);this.ia.sa(R.a.sWl,X.a.application,cd.a.Bta,96);this.ia.sa(R.a.wec,X.a.application,
Object(B.a)(this,this.mXm,"handleSetSlideSize"),4);this.ia.sa(R.a.xed,X.a.application,Object(B.a)(this,this.oXm,"handleSetSlideSize4x3"),4);this.ia.sa(R.a.wed,X.a.application,Object(B.a)(this,this.nXm,"handleSetSlideSize16x9"),4);this.ia.sa(R.a.WIe,X.a.application,Object(B.a)(this,this.L8m,"launchSlideSizeAndLayoutDialogHandler"),4);this.ia.sa(R.a.wSl,X.a.application,Object(B.a)(this,this.UEl,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.sa(R.a.xSl,X.a.application,Object(B.a)(this,
this.UEl,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.sa(R.a.qne,X.a.application,Object(B.a)(this,this.$2l,"setSlideOrientationHandler"),4);this.ia.sa(R.a.pne,X.a.application,Object(B.a)(this,this.$2l,"setSlideOrientationHandler"),4);this.ia.sa(R.a.ywh,X.a.application,Object(B.a)(this,this.ZMn,"setSlideSizeAndLayoutHandler"),4);this.ia.za(R.a.b3l,X.a.application,cd.a.m5);this.ia.za(R.a.setSlideHeight,X.a.application,cd.a.m5);this.ia.sa(R.a.uWl,X.a.application,cd.a.Bta,96);this.ia.sa(R.a.tWl,
X.a.application,cd.a.Bta,96);this.ia.za(R.a.a6l,X.a.application,cd.a.m5);this.ia.za(R.a.$5l,X.a.application,cd.a.m5)}ve(){}Mek(na,$a,Fb,Xb,nc){fe.a.J(507843974,822,50,"Click slide size drop down.");if($a.contextId!==X.a.application)return 2;if($a=Object(ed.a)(lb.a,nc))na=Ld.i4m(this.oc.lB(),na),$a.xg(na);return 32}L8m(na,$a,Fb){$a=this.va.Ga;return!$a||this.hf.Cd($a)||!Ac.a("DeprecateIE.CustomizeSlideSizeActor")&&Tc.a.eA?8:1===Fb?32:Rc.a("CustomizeSlideSizeActor::LaunchSetSlideSizeAndLayoutDialogHandler ",
na,()=>{(new sd(this.ia,this.oc)).KAb();fe.a.J(507843973,822,50,"Open set slide size and layout dialog.");return 32})}UEl(na,$a,Fb,Xb,nc){na=this.va.Ga;if(!na||this.hf.Cd(na))return 16;if(1===Fb)return 32;if("slideType"in nc&&"slideWidth"in nc&&"slideHeight"in nc)if(this.LLc=6,"o_custom"===nc.slideType.toString().toLowerCase())this.XNa=6*Math.round(nc.slideWidth),this.$Zb=6*Math.round(nc.slideHeight);else{Fb=0;for(const Nc of this.slideSizeType){if(nc.slideType.toString().toLowerCase()===Nc.toLowerCase()){this.LLc=
Fb;break}Fb++}"landscape"===nc.orientation.toString()?(this.$Zb=this.C5l[Fb],this.XNa=this.I5l[Fb]):(this.XNa=this.C5l[Fb],this.$Zb=this.I5l[Fb])}(new za(this.ia,this.rf)).showDialog(ResourceStrings.l_SetSlideScaleTitle);fe.a.J(507843972,822,50,"Open set slide scale type dialog.");return 32}mXm(na,$a,Fb){na=this.va.Ga;return!na||this.hf.Cd(na)?8:this.ia.Cb(R.a.Q9a,Fb)}oXm(na,$a,Fb){fe.a.J(507843971,822,50,"click set slide size 4:3.");$a=this.va.Ga;if(!$a||this.hf.Cd($a))return 16;if(1===Fb||960===
this.oc.lB().width)return 32;this.XNa=5760;this.$Zb=4320;this.LLc=0;return this.TMe(this.XNa,this.$Zb,na,this.LLc,"EnsureFit")}nXm(na,$a,Fb){fe.a.J(507843970,822,50,"click set slide size 16:9.");$a=this.va.Ga;if(!$a||this.hf.Cd($a))return 16;if(1===Fb)return 32;Fb=this.oc.lB();if(1280===Fb.width)return 32;this.XNa=7680;this.$Zb=4320;this.LLc=16;return 960===Fb.width&&720===Fb.height?this.TMe(this.XNa,this.$Zb,na,this.LLc,""):this.TMe(this.XNa,this.$Zb,na,this.LLc,"EnsureFit")}ZMn(na,$a,Fb,Xb,nc){var Nc;
$a=this.va.Ga;if(!$a||this.hf.Cd($a))return 8;if(1===Fb)return 32;Ac.a("LogZoomStateForCustomSize")&&fe.a.J(507626334,822,50,`Setting custom size, IsFitToWindow: ${null===(Nc=this.ic)||void 0===Nc?void 0:Nc.mS}`);return this.TMe(nc.width,nc.height,na,nc.slideType,nc.slideScaleType)}$2l(na,$a,Fb){$a=this.va.Ga;return!$a||this.hf.Cd($a)?16:1===Fb?32:this.$Zb&&this.XNa?na===R.a.qne?this.TMe(this.XNa,this.$Zb,na,this.LLc,"Maximize"):na===R.a.pne?this.TMe(this.XNa,this.$Zb,na,this.LLc,"EnsureFit"):32:
(fe.a.J(507843969,822,10,"CustomizeSlideSizeActor::SetSlideOrientationHandler fail to get slide width/height."),8)}TMe(na,$a,Fb,Xb,nc){const Nc=this.va.Ga;let yd=!1;if(Nc){var Ud=Nc.xj();if(Ud&&0<Ud.length)for(const ie of Ud)if(ie.Qsa){yd=!0;break}}Ud=this.Mb.Fd(15,void 0,()=>{this.Ma.Wd();this.pa.Ti()});try{Ud.hd(Nc),Ud.sc=Fb,Ud.XC[oc.a.N8c]=yd,Nc.setValue(Lb.a.slideWidth,na),Nc.setValue(Lb.a.slideHeight,$a),Nc.setValue(Lb.a.slideScaleType,nc),Nc.setValue(Lb.a.slideSizeType,Xb)}finally{Ud&&Ud.dispose()}fe.a.J(507843968,
822,50,"Set slide width: {0}, height: {1}, scale type: {2}.",na,$a,nc);this.hf.boc(this.$b.Qf,Nc,Fb);return 32}static i4m(na,$a){na=na.width/na.height;switch($a){case R.a.Yhe:return.01>Math.abs(na-1.33);case R.a.Xhe:return.01>Math.abs(na-1.77);default:return!1}}}Object(m.a)(Ld,"CustomizeSlideSizeActor",null,[743]);var Qd=a(69);class Id{}Id.Ork=0;Id.FHn=22711;Object(m.a)(Id,"ImageConstants",null,[]);var he=a(404),xb=a(488),Sb=a(596),Cc=a(260),qb=a(302),Ob=a(420),Pb=a(312);class qc extends Pb.a{constructor(){super();
this.ImageToken=null;this.ErrorCode=0}Gn(){return 78}}Object(m.a)(qc,"NotifyImageUploadFailureRequest",Pb.a,[]);class Uc{constructor(na,$a,Fb,Xb,nc,Nc,yd,Ud,ie,Be,oe,rf,Vf,xg,qh,k,E,S,la,sa,pb,Ib,Wb){this.Mab=this.E$c=this.pS=null;this.z8d=!1;this.jrn=(Gc,kd)=>{(Gc=z.a.instance.Na("Common.ISystemInitiatedFeedback"))&&kd&&kd.XCl&&Gc.execute(Gd=>{Gd.logActivity("InsertPicture",null)})};this.ia=na;this.ob=Fb;this.uc=$a;this.va=nc;this.Mb=Nc;this.Ma=Xb;this.nR=yd;this.PEa=Ud;this.Qk=ie;this.YIj=Be;this.yv=
oe;this.ee=rf;this.xb=Vf;this.$Jc=xg;this.U8f=qh;this.UWb=k;this.qm=E;this.kj=S;this.Aa=la;this.Hm=sa;this.Ad=pb;this.z3=la.Z2b;this.Ia=Ib;this.Bcn=null===Wb||void 0===Wb?void 0:Wb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.InsertPictureFloodgateSurveyEnabled",!1);this.KHl=null===Wb||void 0===Wb?void 0:Wb.Xwa("DevicePictureSlideWidthAdjustmentFactor",0);this.JHl=null===Wb||void 0===Wb?void 0:Wb.Xwa("DevicePictureSlideHeightAdjustmentFactor",0);this.gdn=null===Wb||void 0===Wb?
void 0:Wb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.MultipleImageInsertionOffsetEnabled",!1);this.Gz=la.xJ;this.Jz()}Jz(){this.Bcn&&this.Ad.Pel(this.jrn)}Hb(){this.ia.sa(R.a.insertPicture,P.a.application,Object(B.a)(this,this.qyl,"handleInsertPicture"),4);this.ia.sa(R.a.huc,P.a.view,Object(B.a)(this,this.PXm,"handleUploadPictureAll"),4);this.ia.sa(R.a.E5c,P.a.application,Object(B.a)(this,this.ZVm,"handleChangePicture"),4);this.ia.sa(R.a.$Cb,P.a.application,Object(B.a)(this,this.dXm,
"handleResetPicture"),4);this.ia.sa(R.a.Vuh,P.a.application,Object(B.a)(this,this.eXm,"handleResetPictureAndSize"),4);this.ia.sa(R.a.Wuh,P.a.application,Object(B.a)(this,this.fXm,"handleResetPictureSplitButton"),4);this.ia.sa(R.a.IDa,P.a.application,Object(B.a)(this,this.$Vm,"handleChangePictureStyle"),4);this.ia.sa(R.a.gsf,P.a.application,Object(B.a)(this,this.qyl,"handleInsertPicture"),4);this.ia.sa(R.a.gBe,P.a.application,Object(B.a)(this,this.fWm,"handleDragAndInsertImage"),4)}ve(){}qyl(na,$a,
Fb){this.Aa.Xhj&&!Ac.a("DummyChangeGateForTest")&&fe.a.J(512500500,830,100,"HandleInsertPicture::DummyChangeGateForTest is disabled");$a=this.va.Ga;$a=this.Aa.HTd&&!!$a&&!this.uc.Cd($a);$a=(this.U8f=this.$Jc.PBl()&&this.U8f)?$a&&!!this.nR&&this.nR.Vfd:this.PEa.qCl&&$a;if(!$a)return 16;if(1===Fb)return 32;this.z8d=!0;this.Mab=this.va.Ga;this.vxh(na!==R.a.gsf,!0);return 32}PXm(na,$a,Fb,Xb,nc){var Nc;$a=this.va?this.va.Ga:null;if(!$a||!$a.isConnected)return 16;if(!this.kj.zC($a,1))return this.kj.dI($a),
16;if(Ac.a("ImageFileExtLogsForSaveImageToDisk")&&this.z8d)var yd=(yd=this.nR.Gfh(null!==(Nc=null===nc||void 0===nc?void 0:nc.fileName)&&void 0!==Nc?Nc:""))?`: image file ext - ${yd}`:"";fe.a.J(512500497,822,50,"PictureActor::handleUploadPictureAll Start picture upload{0}",null!==yd&&void 0!==yd?yd:"");Nc=Uc.X6m(nc);(yd=Cc.a.Ab)&&yd.Ya(qb.a.cBl,Nc?"1":"0");this.Ad.YWl(Sys.EventArgs.Empty);Xb=!1;if(this.z8d&&this.U8f&&!this.nR.jwb&&this.d5m(Nc)){if($a=$a.b8(this.ob.ud())){if(15!==$a.placeholderType){const Ud=
$a.bV;Ud.BottomLeft.X!==Ud.TopLeft.X&&(Xb=!0)}yd&&yd.Ya(qb.a.i0l,Xb?"1":"0")}$a&&(15===$a.placeholderType||Xb)?(yd&&yd.Ya(qb.a.lEd,Xb?"PlaceHolder Rotated":"Picture Type PlaceHolder"),na=this.Nyl(na,Fb,nc)):na=this.RXm(na,Fb,nc)}else this.nR.jwb=!1,na=this.Nyl(na,Fb,nc);Nc&&32===na&&fe.a.J(512500496,822,50,"Upload a svg file successfully.");return na}d5m(na){return na?this.Aa.LJe:!0}KWm(na,$a){Object(Qd.b)(this,void 0,void 0,function*(){if(!$a||0===$a.length)return fe.a.J(508122975,822,15,"MultipleDragOfImages: No src urls captured for dragged images"),
32;const Fb=performance.now(),Xb=[];let nc=!1;Promise.all($a.flatMap((Nc,yd)=>{try{const Ud=new URL(Nc);return fetch(new URL(Ud)).then(ie=>ie).catch(ie=>{fe.a.J(508070036,822,10,"Error in fetching response for url : {0}",ie.message);return[]})}catch(Ud){return console.log(Ud.message),fe.a.J(508125897,822,15,"Error while downloading Multiple Dragged images on File no. {0} where error: {1}",yd,Ud.message),[]}})).then(Nc=>Promise.all(Nc.flatMap(yd=>yd&&yd.ok?[yd.blob()]:[]))).catch(Nc=>{console.log(Nc.message);
fe.a.J(508126305,822,15,"Error while downloading Multiple Dragged images");return[]}).then(Nc=>{Nc&&Nc.length?(Nc.map((yd,Ud)=>{const ie=yd.type.search("/");Ud="temp"+String(Ud)+"."+yd.type.substring(ie+1,yd.type.length);0===this.nR.F1c(Ud)?Xb.length<this.Aa.kdc&&Xb.push(new File([yd],Ud)):nc=!0}),nc&&(fe.a.J(508101728,822,15,"MultipleDragOfImages: Unsupported Image Format from browser for Multi Drop "),this.Hm.mG(1<Xb.length?29:18)),0<Xb.length&&(Nc=performance.now(),fe.a.J(508074067,813,50,"PictureActor : handleMultipleDraggedImageUrl : total time taken {0} ms to download {1} files.",
Nc-Fb,Xb.length),Nc=[],Nc=Xb.slice(),this.nR.Vwi(Nc,na,!1))):fe.a.J(508126304,822,15,"Error while downloading Multiple Dragged images")});return 32})}fWm(na,$a,Fb,Xb,nc){if(!this.nR.NTl)return fe.a.J(512500495,822,15,"PictureActor::HandleDragAndInsertImage - PictureUploadLargeImageEnabled is false"),16;if(!nc)return 16;$a=null;Fb=!1;if(this.Aa.$Ac)if(nc.droppedFiles)na=nc.droppedFiles,$a=nc.droppedPoint,Fb=nc.fromBrowser;else return $a=nc.droppedPoint,nc.ImgSrcList.length>this.Aa.kdc&&(this.Hm.mG(28),
fe.a.J(508101727,822,15,"PictureActor::HandleDragAndInsertImage - Dragging more Images than limit from browser, Number of files: {0}",nc.ImgSrcList.length)),fe.a.J(508086469,822,50,"PictureActor::HandleDragAndInsertImage - Number of files dropped from browser: {0}",nc.ImgSrcList.length),this.KWm($a,nc.ImgSrcList.slice(0,this.Aa.kdc)),32;else na=nc;nc=[];Xb=0;let Nc=!1;for(const yd of na){Xb++;if("string"!==typeof yd.type)continue;const Ud=ha.a.mj(yd.type);fe.a.J(512500494,822,50,"PictureActor::HandleDragAndInsertImage - No.{0} file  Size In Bytes:{1}; Tpye:{2} ",
Xb,yd.size,Ud);if(0<=Ud.indexOf("image")&&0===this.nR.F1c(yd.name))if(nc.length<this.Aa.Ccd)Array.add(nc,yd);else{this.Hm.mG(19);fe.a.J(508086468,822,15,"PictureActor::HandleDragAndInsertImage - Dragging more Images than limit from local system, Number of files: {0}",na.length);break}else Nc||(Ac.a("ErrorMessageUpdatedFixForUnsupportedFileFormatForMultiDrop")?this.Hm.mG(1<na.length?29:18):this.Hm.mG(18),Nc=!0)}Nc&&(Fb?fe.a.J(508065562,822,15,"PictureActor::HandleDragAndInsertImage - Unsupported image format from browser for single drop"):
1<=nc.length&&fe.a.J(508061897,822,15,"PictureActor::HandleDragAndInsertImage - Multiple Images dropped from local that has an Unsupported Image format"));if(!Fb&&1>nc.length)return fe.a.J(512500493,822,15,"PictureActor::HandleDragAndInsertImage - unlegal image format"),16;this.nR.Vwi(nc,$a,1==nc.length);return 32}Nyl(na,$a,Fb){if(!(this.va&&this.va.Ga&&this.nR))return 16;if(1===$a)return 32;this.PEa.xde=new Date;this.z8d&&this.ob.Rj();this.Ma.Wd();this.uc.blockContent(this.va.presentation,na,!1,
void 0,void 0);const Xb=Cc.a.Ab;this.nR.Wxh(Fb,nc=>{Cc.a.yJ(Xb,()=>{fe.a.J(512500492,822,50,"Picture upload successful");this.TWm(Fb,nc,na);this.Asl()})},nc=>{fe.a.J(512500491,822,10,"Upload picture failed");this.hLf(nc.error);this.Asl()});return 32}RXm(na,$a,Fb){if(!(this.va&&this.va.Ga&&this.nR))return 16;if(1===$a)return 32;const Xb=String.format("{0}{1}","client",ca.a.create().toString());fe.a.J(512500490,822,50,"Client generated imageToken:{0}, imageSize:{1}",Xb,Fb.QQ);this.PEa.Qtm(Xb);const nc=
Cc.a.Ab;nc&&($a="InsertPicture",this.z8d||($a="ChangePicture"),nc.actionName=$a,nc.Xi=!0);const Nc=new Date;Cc.a.Xj("PictureUploadStart",Cc.a.Lf(Nc));Cc.a.Xj("ImageSize",Fb.QQ.toString());Cc.a.Xj("ImageToken",Xb);const yd=this.va.Ga.sid;this.ia.Qa(R.a.Rjh,2,yd);this.nR.Wxh(Fb,Ud=>{Cc.a.yJ(nc,()=>{fe.a.J(512500489,822,50,"Upload picture completed, ImageToken:{0}",Xb);Cc.a.Xj("PictureUploadDurationMS",(+new Date-+Nc).toString());this.nvn(Xb,Ud);this.ia.Qa(R.a.AOf,2,yd)})},Ud=>{this.PEa.Ypl(Xb);var ie=
Object.assign(new qc,{ImageToken:Xb,ErrorCode:Ud.error.Code});nc&&nc.Ya("UploadPictureErrorCode",he.a[ie.ErrorCode]);ie=new Ob.a(ie,null,()=>Uc.Rqn());this.qm.Qb(ie);fe.a.J(512500488,822,10,"Upload picture failed, ImageToken:{0}, ErrorCode:{1}, Error Message:{2}",Xb,he.a[Ud.error.Code],Ud.error.Message);this.ia.Qa(R.a.AOf,2,yd)},Xb);this.insertPicture(Xb,na,Fb);return 32}ZVm(na,$a,Fb){na=this.z3?this.BHd():this.CCe();if(!(this.z3?this.XTf(na):this.YCl(na)&&this.Aa.HTd&&this.PEa.qCl&&!this.uc.Cd(na)))return 16;
if(1===Fb)return 32;this.z8d=!1;this.vxh(!0,!1);return 32}dXm(na,$a,Fb){return this.IDa($a,Fb,Id.Ork,na)}eXm(na,$a,Fb){return this.IDa($a,Fb,Id.FHn,na)}fXm(na,$a,Fb,Xb,nc){return this.IDa($a,1,nc,na)}$Vm(na,$a,Fb,Xb,nc){return this.IDa($a,Fb,nc,na)}IDa(na,$a,Fb,Xb){const nc=this.ob.ud();if(!(nc&&0<nc.length))return 8;na=[];if(Ac.a("FixForPictureAndGraphicsStyleForGrpShapes"))this.FSm(nc,na);else for(const yd of nc){if(this.MCl(yd)||this.uc.Cd(yd))return 8;(this.z3?this.XTf(yd):this.YCl(yd))&&na.push(yd)}if(0>=
na.length)return 8;if(1===$a)return 32;fe.a.J(512500487,822,15,"PictureStyle change started. PictureStyleId: '{0}'",Fb);$a=Cc.a.Ab?Cc.a.Ab.actionName:null;for(var Nc of na)this.uX(Nc);Nc=this.Mb.Fd(15,void 0,()=>{this.ob.Rj();this.Ma.Wd()});try{Nc.rc(na[0]);Nc.sc=Xb;for(const yd of na)yd.j5a=Fb}finally{Nc&&Nc.dispose()}if(Xb=Cc.a.Ab)$a&&(Xb.actionName=$a),Xb.Ya("PictureStyleId",Fb.toString()),Cc.a.$Y(Xb);return 32}FSm(na,$a){let Fb=!1;for(const Xb of na){if(!Xb||this.MCl(Xb)||this.uc.Cd(Xb))return;
Xb.wg&&(Fb=!0)}if(Fb)for(const Xb of na)Xb.wg&&this.XTf(Xb)&&$a.push(Xb);else for(const Xb of na)if(this.XTf(Xb))$a.push(Xb);else if(Xb.Ce){na=this.Ia.$t(Xb);for(const nc of na)this.XTf(nc)&&$a.push(nc)}}TWm(na,$a,Fb){this.PEa.qcd=new Date;const Xb=$a.result;if(na){if(this.z8d?($a="InsertPicture",this.L2m(Xb,na,Fb)):($a="ChangePicture",Ac.a("ChangePictureOnMultiSelectFixEnabled")?this.Nwm(Xb,na,Fb):this.Owm(Xb,na,Fb)),na=Cc.a.Ab)na.actionName=$a,na.Ya("PictureUploadStart",Cc.a.Lf(this.PEa.xde)),na.Ya("PictureUploadDurationMS",
(+this.PEa.qcd-+this.PEa.xde).toString())}else na=Object.assign(new xb.a,{Code:94}),this.hLf(na)}nvn(na,$a){this.PEa.Ypl(na);$a.result||fe.a.J(512500486,822,50,"Upload picture completed with null response")}L2m(na,$a,Fb){const Xb=this.va.Ga;if(Xb&&Xb.isConnected){this.E$c=Xb.b8(this.ob.ud());var nc=this.Mb.Fd(15,void 0,void 0,()=>{this.ob.selectShape(this.pS,!0);this.Ma.Wd()});try{nc.rc(Xb);nc.sc=Fb;nc.XC[oc.a.S9a]=oc.a.cHi;this.pS=this.Qk.qml(0,Xb.Xb);this.E$c&&(this.pS.msa=this.E$c.id);let Nc=Fb=
0;this.Aa.getBooleanAppSetting("InsertPictureSizeIncreaseEnabled")&&(Fb=Xb.io*this.KHl,Nc=Xb.ek*this.JHl);this.pS.aRg(na.ItemId,null,$a.fileName,Fb,Nc);Xb.pI(this.pS)}finally{nc&&nc.dispose()}this.uc.ggb(this.va.Ga,this.pS,this.xb.Oa,"InsertPictureAfterUpload");this.yv.zI=this.pS}}Nwm(na,$a,Fb){var Xb=this.ob.ud();if(Xb){var nc=[];for(const Nc of Xb)Nc.Ce||nc.push(Nc);for(const Nc of nc)this.uX(Nc);Xb=this.Mb.Fd(15);try{Xb.sc=Fb;Xb.rc(nc[0]);for(const Nc of nc)Nc.msa=Nc.id,Nc.aRg(na.ItemId,null,$a.fileName),
Nc.set_alt("")}finally{Xb&&Xb.dispose()}for(const Nc of nc)this.uc.ggb(this.va.Ga,Nc,this.xb.Oa,"ChangePictureAfterUpload")}}Owm(na,$a,Fb){const Xb=this.z3?this.BHd():this.CCe();if(Xb){this.uX(Xb);var nc=this.Mb.Fd(15);try{nc.sc=Fb,nc.rc(Xb),Xb.msa=Xb.id,Xb.aRg(na.ItemId,null,$a.fileName),Xb.set_alt("")}finally{nc&&nc.dispose()}this.uc.ggb(this.va.Ga,Xb,this.xb.Oa,"changePictureAfterUploadSingleImage")}}hLf(na){this.PEa.qcd=new Date;fe.a.J(512500484,822,50,"Upload picture failed");this.ee.SK(na.Code,
$a=>{$a.zD=1;$a.Z9a=na.ExtraErrorParam;return!1})}Asl(){this.uc.mD(this.va.presentation)}vxh(na,$a){this.YIj?Sb.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.nR&&(this.nR.e$c=this.U8f,this.nR.byb=0,na&&this.nR.Cdk($a))}CCe(){const na=this.ob.ud();for(const $a of na)if($a&&this.hTf($a))return $a;return null}BHd(){const na=this.ob.ud();return na&&na.length?this.J5h(na)?na[0]:this.CCe():null}J5h(na){return null===na||void 0===na?void 0:na.filter($a=>!!$a).every($a=>
this.hTf($a)||1===$a.mediaType)}hTf(na){return na.Kg&&!(this.Gz&&na.HA)}Ak(na){return na?Object(ed.a)(284,na.tc(this.xb.Oa)):null}uX(na){na&&na.Ww&&(na=this.Ak(na))&&na.pW(!1)}YCl(na){return!this.va||!this.va.Ga||!na||this.Gz&&na.HA||!na.Kg?!1:!0}XTf(na){return!this.va||!this.va.Ga||!na||this.Gz&&na.HA||!na.Kg&&1!==na.mediaType?!1:!0}MCl(na){return this.va&&this.va.Ga&&na&&na.Zl?!0:!1}insertPicture(na,$a,Fb){var Xb=this.va.Ga;const nc=Object(ed.a)(278,Xb.tc(this.xb.Oa)),Nc=this.Mab.Xb;if(Xb&&Xb.isConnected&&
nc&&this.Mab&&this.Mab.isConnected){Xb=this.Mab.Ju();this.E$c=this.Mab.b8(this.ob.ud());var yd=0,Ud=0;this.Aa.getBooleanAppSetting("InsertPictureSizeIncreaseEnabled")&&(yd=this.KHl,Ud=this.JHl);var {Cwf:ie,MR:Be}=this.UWb.Dkf(this.Aa.$Ac&&!Fb.Hdd?void 0:this.E$c,Fb.imageWidth,Fb.imageHeight,nc.WK,Fb.FAb,Fb.GAb,Fb.Hdd,yd,Ud);!this.gdn||void 0!=Fb.FAb&&void 0!=Fb.GAb||(Fb.FAb=Be.x,Fb.GAb=Be.y,Fb.Hdd=!1,fe.a.J(507786768,822,50,"PictureActor:insertPicture Setting position of first image"));yd=this.Mb.Fd(15,
void 0,()=>{this.ob.Rw();this.ob.Ti();this.Ma.Wd()},()=>{this.yv.zI=this.pS;this.ob.selectShape(this.pS,!0)});try{yd.rc(this.Mab);yd.sc=$a;this.pS=this.Qk.MSa(!0,Nc.cid,Nc.sid,0,Be.x,Be.y,ie.width,ie.height,Xb+1,!1);const oe=this.UWb.qef(this.xb.yd,ie,Be,nc.WK);this.pS.bV=oe;this.E$c&&(this.pS.msa=this.E$c.id,this.Mab.i_([this.E$c]));this.pS.aRg(na,null,Fb.fileName);this.pS.isResizable=!0;this.pS.LBc=!0;this.pS.OJ=!0;this.pS.Yha=!0;this.pS.Kg=!0;this.pS.Uzb=!!Fb.K0b;this.pS.cka=Fb.K0b||Fb.lzc;this.Mab.pI(this.pS)}finally{yd&&
yd.dispose()}Cc.a.KOe()}}static X6m(na){return!!na&&!!na.fileName&&na.fileName.toLowerCase().indexOf(".svg")===na.fileName.length-4}static Rqn(){fe.a.J(512500483,822,50,"NotifyImageUploadFailureRequest failed");return!0}}Object(m.a)(Uc,"PictureActor",null,[743]);var pd=a(313),Od=a(372),be=a(899),te=a(1182),Le=a(296);class kf extends Sys.EventArgs{constructor(na,$a){super();this.$Cl=na;this.FVf=$a}}Object(m.a)(kf,"TokenRefreshEventArgs",Sys.EventArgs,[]);class fg{constructor(na,$a,Fb,Xb,nc,Nc,yd){this.ZHe=
0;this.od=na;this.dOj=$a;this.fN=Fb;this.ia=Xb;this.es=nc;this.Tb=Nc;this.Aa=yd;this.dOj&&this.dOj.saf(Object(B.a)(this,this.aSl,"onTokenRefreshed"))}zdi(na){!this.Aa.scd&&this.Tb.O_a&&this.Tb.Gbb();const $a=sb.a.instance.b1a(n.AFrameworkApplication.mq),Fb=sb.a.instance.vbc(n.AFrameworkApplication.mq,n.AFrameworkApplication.bsa);fe.a.J(508694619,801,$a||Fb?15:50,"SessionRehydrationController::CheckAccessTokenExpiry - IsExpired:{0}, IsExpiring:{1}, Trigger:{2}, Improvement:{3}, RetryCount:{4}",$a,
Fb,na,this.Aa.scd,this.ZHe);sb.a.instance.D9a();this.Aa.scd&&this.Tb.O_a&&this.Tb.Gbb()}aSl(na,$a){fe.a.J(508694618,809,50,"PPTTokenRefreshManager::OnTokenRefreshed, isShuttingdown {0}, task manager hasStopped {1}",n.AFrameworkApplication.mi,this.Tb.O_a);try{const Fb=Object(ed.a)(nb,$a)||new nb(null,null),Xb=Fb.tokens,nc=Fb.errors;na="";if(void 0===nc||null===nc||0>=nc.count)for($a=0;$a<Xb.count;$a++)if(Xb.ha($a).Name===Yb.a.IKn){const yd=Xb.ha($a)?Xb.ha($a):null;na=yd&&yd.Value&&0<yd.Value.length?
yd.Value:"";break}const Nc=sb.a.instance.b1a(n.AFrameworkApplication.mq);fe.a.J(508694617,809,50,"PPTTokenRefreshManager::OnTokenRefreshed fTokenExpired:{0} m_applicationSettings.PPTOTokenRefreshRetryEnabled:{1} m_tokenRefreshRetryCount:{2} m_applicationSettings.PPTOTokenRefreshRetryLimit:{3}",Nc,this.Aa.Ush,this.ZHe,this.Aa.abk);if(0<na.length&&Nc&&this.Aa.Ush&&this.ZHe<this.Aa.abk)fe.a.J(508694616,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refreshed successfully but is expired. NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}, RetryEnabled:{4}, CurrentRetryCount:{5}",
(new Date).getTime(),new Date,n.AFrameworkApplication.mq,new Date(n.AFrameworkApplication.mq),this.Aa.Ush,this.ZHe),this.ZHe++,this.zdi(2);else if(0<na.length&&!Nc){fe.a.J(508694615,809,Nc?15:50,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed successfully, NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}",(new Date).getTime(),new Date,n.AFrameworkApplication.mq,new Date(n.AFrameworkApplication.mq));Od.App.ACe=n.AFrameworkApplication.X$b=ha.a.Sj(na);const yd=this.fN.GSc.Nh.MNe+
"&access_token="+encodeURIComponent(n.AFrameworkApplication.accessToken)+"&access_token_ttl="+encodeURIComponent(n.AFrameworkApplication.mq.toString());this.fN.GSc=new te.a(new be.a(yd));this.od.Shk(new kf(this.es?this.es.CJa:!1,!0))}else{if(Ac.a("CleanPIIFromC49mm")&&nc)for(const yd of nc)if(yd.Errors)for(const Ud of yd.Errors)"403"===Ud.Id&&Ud.Details&&Ud.Details.startsWith("<")&&(Ud.Details=null);fe.a.J(508694614,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed, errors: {0}, RetryCount:{1}",
nc?pd.c(nc):"There is no error in Refreshed Token, but GetFileUrl is empty",this.ZHe);if(nc&&0<=pd.c(nc).indexOf("The caller is not authenticated"))n.AFrameworkApplication.Xs(Le.a.wi(383)),Wa.Health.instance.recordQosError("WopiTokenRefreshFailedOnHostUnauth",["SessionExpired"],!1,!0,!1,!0,null);else{if(Ac.a("SkipSessionExpiredVetoForShutdown")&&n.AFrameworkApplication.mi){fe.a.J(508351136,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refresh failed, skipping error and restart on shutting down, task manager hasStopped {}",
this.Tb.O_a);return}n.AFrameworkApplication.Xs(Le.a.wi(380));Wa.Health.instance.recordQosError("WopiTokenRefreshFailed",["SessionExpired"],!1,!0,!0,!0,null)}n.AFrameworkApplication.TA&&n.AFrameworkApplication.TA.ina();this.od.Shk(new kf(this.es?this.es.CJa:!1,!1));this.ia.Qa(R.a.refresh,2,{refreshtrigger:"PPTTokenRefreshManager::OnTokenRefreshed"})}}catch(Fb){fe.a.J(508694613,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed and throw exception, exception: {0}",pd.c(Fb))}}dispose(){this.dOj.uuh(Object(B.a)(this,
this.aSl,"onTokenRefreshed"))}}Object(m.a)(fg,"PPTTokenRefreshManager",null,[1238]);var pe=a(295),me=a(861);class Ke{constructor(na,$a,Fb,Xb,nc,Nc){this.Wha=this.Q_n=this.Hqk=null;this.Yvf=this.nDi=!1;this.nqh=0;this.ZDb=Cc.a.Fk("SeamlessFailover");1!==$a&&2!==$a||Cc.a.ULa();this.Mm=new Date;Cc.a.dBb=this.startTime;this.wkm=Fb;this.h6c=0;this.hlm=$a;this.Bhm=Xb;this.Hkm=nc;this.tVn=Nc;this.fSucceeded=!1;this.resultCode=0;this.F6k=!0;if(na=n.AFrameworkApplication.Rf)this.Kd.Ya("Host",Object(ed.a)(String,
na.Host)),this.Kd.Ya("Ring",Object(ed.a)(String,na.Ring))}i3l(na,$a){this.nqh=window.setTimeout(na,$a)}FSn(){this.F6k=!1}dispose(){Cc.a.Cbc=new Date;0<=this.nqh&&(window.clearTimeout(this.nqh),this.nqh=-1)}get rIm(){return this.F6k}get Kd(){return this.ZDb}get startTime(){return this.Mm}get Btn(){return this.wkm}get Ldc(){return this.hlm}get fIm(){return this.Bhm}get tcd(){return this.Hkm}}Object(m.a)(Ke,"SeamlessFailoverState",null,[24]);var Ie=a(284);const Ef=na=>{na=String.format("{0}/PodHandler.ashx?action=TriggerFontsInstallation&PodsID={1}",
n.AFrameworkApplication.ga.La(Ie.a.$l),na);n.AFrameworkApplication.ye.HZ(na,1,null,null,null,!1,0,()=>{fe.a.J(512263E3,801,50,"CustomFontHelper::TriggerFontsInstallation - Succeeded")},()=>{fe.a.J(512262999,801,15,"CustomFontHelper::TriggerFontsInstallation - Failed to set document settings")},null)};var We;(function(na){na[na.unknown=0]="unknown";na[na.mouse=1]="mouse";na[na.keyboard=2]="keyboard";na[na.podsPopsUnavailable=4]="podsPopsUnavailable"})(We||(We={}));Object(m.b)("RehydrationTrigger",
We);var Ae=a(877),se=a(1518);class pf{constructor(na,$a,Fb,Xb,nc,Nc,yd,Ud,ie,Be,oe,rf,Vf,xg,qh,k,E,S,la,sa,pb,Ib,Wb){this.Mj=this.uCj=null;this.HRj=this.Dqh=-1;this.ELl=0;this.EBb=na;this.la=$a;this.$b=Fb;this.ia=Xb;this.Tb=nc;this.VD=Nc;this.Fe=yd;this.Jg=ie;this.oR=Be;this.ee=oe;this.hq=rf;this.Dh=Vf;this.fc=xg;this.qS=qh;this.$p=S;this.gOj=new Date;this.ez=k;this.dL=E;this.va=la;this.Fb=sa;this.Had=pb;Wb.execute(Gc=>{this.uCj=Gc});this.Fnh=[];this.$dn=this.Fb.Jc("SeamlessFailoverMaxRetryAttempts",
0);this.Zdn=this.Fb.getBooleanAppSetting("SeamlessFailoverIncludePopsInfoInFinalLog");this.aen=this.Fb.getBooleanAppSetting("SeamlessRehydrationAbortOnAbortedOnExitAppQosEnabled");fe.a.J(512497885,809,50,"PodSeamlessFailoverManager::PodSeamlessFailoverManager()")}get CJa(){return!!this.Mj&&this.Mj.rIm}get Mfh(){return this.ELl}sye(na){if(this.CJa){n.AFrameworkApplication.DE&&(this.Dh.GLe(Object(B.a)(this,this.fbb,"onWopiTokenRefreshed")),this.Tif());var $a=0;if(this.la.UAb)this.Mj.Kd.Iv("Result",
"abortedOnIrmProtectedFile"),$a=365;else if(this.Mj.Kd.Iv("Result",na),"abortedOnExitApp"!==na||this.aen)$a=4===this.Mj.Ldc?356:357;this.Mle(!1,$a,!this.Mj.Yvf&&"abortedOnRefreshDoc"!==na)}}V_g(na,$a,Fb){if(this.CJa)fe.a.J(512497884,801,15,"PodSeamlessFailoverManager::TriggerFailover skipped");else{n.AFrameworkApplication.TA||(n.AFrameworkApplication.TA=fe.a.K$b());this.ee.disabled=!1;this.ee.Sja=!1;this.Mj=new Ke(na,$a,this.Fe.podSessionId,this.la.oJe,this.la.tcd,Fb);this.la.Cve||this.Mj.i3l(Object(B.a)(this,
this.TPl,"onFailoverTimeout"),this.la.oee);this.Mj.Kd.Ya("PopsAvailable",this.Jg.LE.toString());this.Mj.Kd.Ya("OrderlyShutdown",na.toString());this.Mj.Kd.Ya("Trigger",We[$a]);this.Mj.Kd.Ya("TriggerErrorCode",he.a[Fb]);this.Mj.Kd.Ya("OldPodsId",this.Mj.Btn);this.Mj.Kd.Ya("OldPopsId",this.Fe.pk);fe.a.J(512497883,809,50,"PodSeamlessFailoverManager::TriggerFailover:ActionID:{0}; ActionDetails:{1}",this.Mj.Kd.actionId,this.Mj.Kd.Tta());if(1===$a||2===$a)n.AFrameworkApplication.mi=!1,this.va.presentation&&
this.va.presentation.YLe();this.Dh.Sye(Object(B.a)(this,this.fbb,"onWopiTokenRefreshed"));n.AFrameworkApplication.DE&&sb.a.instance.D9a()?(fe.a.J(512497882,809,15,"FileUrlExpired on TriggerFailover, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,n.AFrameworkApplication.mq,new Date(n.AFrameworkApplication.mq)),this.Tif(),this.Dqh=window.setTimeout(Object(B.a)(this,this.Tsn,"onWopiTokenRefreshTimeout"),this.la.FPe),this.la.U6j&&this.Had.HGi(!1,
"PodSeamlessFailoverManager")):(this.Dh.GLe(Object(B.a)(this,this.fbb,"onWopiTokenRefreshed")),this.b8l($a))}}nrl(na){if(Array.contains(this.la.mJe,Le.a.wi(na).toString())){if(!this.Fnh.length)return!0;const $a=new Date;let Fb=0;for(let Xb=this.Fnh.length-1;0<=Xb;Xb--){const nc=this.Fnh[Xb];if(+$a-+nc.startTime>this.la.Nde)break;nc.tVn===na&&Fb++}if(Fb<this.la.nJe)return!0;fe.a.J(512497881,809,10,"PodSeamlessFailoverManager::FTriggerFailoverForServerError - Failover for Error[{0}] has been triggered for {1} times within {2}ms. Skip.",
na,Fb,this.la.Nde)}return!1}b8l(na){n.AFrameworkApplication.DE&&(this.Dh.GLe(Object(B.a)(this,this.fbb,"onWopiTokenRefreshed")),this.Tif());if(++this.ELl>this.$dn)this.b2i("SeamlessFailoverMaxRetryCountReached",392);else if(this.la.Cve&&this.Mj.i3l(Object(B.a)(this,this.TPl,"onFailoverTimeout"),this.la.oee),+new Date-+this.gOj>=36E5*this.la.NJe)this.b2i("RecoveryStreamExpired",358);else{if(this.Mj.nDi&&(this.Mj.Kd.Iv("Trigger",We[na]+"_GetFileUrlExpired"),this.G3m())){this.b2i("GetFileUrlExpired_NoAzureBackup",
364);return}this.Mj.fIm&&this.sxm();this.Dh.jdd(new Ae.a(4===na?5:2));this.Dh.VWl(new Sys.EventArgs);this.la.pJe&&4===na&&(fe.a.J(512497880,801,15,"PodSeamlessFailoverManager::TriggerFailover - Close PopSesion: {0}",this.Fe.pk),this.qS.yzb(()=>{},()=>{}));this.hq.isPaused||this.hq.pause();this.Mj.Kd.km("CreatePodsWithRetryST",new Date);this.Mj.Kd.km("SessionStartTime",this.gOj);this.iYl()}}b2i(na,$a){this.Tb.O_a&&this.Tb.Gbb();this.Mj.Kd.Iv("Result",na);this.Mle(!1,$a)}Tsn(){this.Dh.GLe(Object(B.a)(this,
this.fbb,"onWopiTokenRefreshed"));this.Tif();fe.a.J(512497879,809,50,"WopiTokenRefreshed timeout during TriggerFailover");this.Mj.Kd.Ya("WopiTokenRefreshed","TO");n.AFrameworkApplication.Xs(Le.a.wi(382));Wa.Health.instance.recordQosError("WopiTokenRefreshTimeoutOnRehydration",["SessionExpired"],!1,!0,!0,!0,null);n.AFrameworkApplication.TA&&n.AFrameworkApplication.TA.ina();this.Mj.Yvf=!0;this.ia.Qa(R.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::OnWopiTokenRefreshTimeout"})}fbb(na,$a){na=
$a.FVf;this.Dh.GLe(Object(B.a)(this,this.fbb,"onWopiTokenRefreshed"));this.Tif();this.la.U6j&&this.Had.HGi(!0,"PodSeamlessFailoverManager");$a=0<n.AFrameworkApplication.mq&&(new Date).getTime()>=n.AFrameworkApplication.mq-this.la.Bve;fe.a.J(512497878,809,50,"WopiTokenRefreshed during TriggerFailover, IsTokenRefreshedSuccessfully: {0}, NowTicket: {1}, NowDateTime:{2}, AccessTtl:{3}, AccessTtlDateTime: {4}",na,(new Date).getTime(),new Date,n.AFrameworkApplication.mq,new Date(n.AFrameworkApplication.mq));
this.Mj.Kd.Ya("WopiTokenRefreshed","True");this.Mj.Kd.Ya("WopiTokenRefreshedSuccessfully",na.toString());this.Mj.nDi=$a;na?this.b8l(this.Mj.Ldc):this.Mj.Yvf=!0}Tif(){-1!==this.HRj&&(window.clearTimeout(this.HRj),this.HRj=-1);-1!==this.Dqh&&(window.clearTimeout(this.Dqh),this.Dqh=-1)}G3m(){const na=ha.a.mj(this.Fb.La(Ie.a.aTa)||""),$a=!n.AFrameworkApplication.Oh.IsRealEdit&&1!==this.Mj.Ldc&&2!==this.Mj.Ldc;return".pptx"!==na&&".ppsx"!==na||$a}sxm(){try{let na=0,$a=0;const Fb={},Xb={};this.$p.vdl(nc=>
{if(-1<nc.request.get_url().search(new RegExp(this.Mj.tcd,"i")))return this.Q7l(Fb,this.nwl(nc.request.get_url())),na++,!0;this.Q7l(Xb,this.nwl(nc.request.get_url()));$a++;return!1});fe.a.J(512497877,801,15,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests - abort {0} requests: {1}, remain {2} request: {3}",na,Fb,$a,Xb)}catch(na){fe.a.J(512497876,801,10,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests failed. {0}",na)}}nwl(na){let $a=na;const Fb=na.indexOf("?");0<Fb&&($a=na.substr(0,
Fb));na=$a.lastIndexOf("/");0<na&&($a=$a.substr(na+1));return $a}Q7l(na,$a){na[$a]=$a in na?na[$a]+1:1}TPl(){this.CJa&&(this.Mj.Kd.Iv("Result","Timeout"),this.Mj.Kd.Ya("TimeoutDuration",(+new Date-+this.Mj.startTime).toString()),this.Mle(!1,4===this.Mj.Ldc?354:355))}Mle(na,$a=0,Fb=!0){if(this.CJa){this.oR.PUc(Object(B.a)(this,this.$ab,"onPodSessionRefreshed"));this.$b.gj.yq.Rdc(Object(B.a)(this,this.UOl,"onAfterReplication"));var Xb=+new Date-+this.gOj>=6E4*this.la.fKe;n.AFrameworkApplication.DE&&
(Xb=0<n.AFrameworkApplication.mq&&(new Date).getTime()>=n.AFrameworkApplication.mq-this.la.Bve)&&fe.a.J(512497875,809,15,"FileUrlExpired on SeamlessFailoverEnd, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,n.AFrameworkApplication.mq,new Date(n.AFrameworkApplication.mq));na&&Xb&&this.Mj.Kd.Ya("SkipPopsReason","FileUrlExpired");this.fc.Dzj();var nc=this.Mj.Ldc;this.Mj.Kd.Ya("IsInEditingMode",this.fc.Mp.toString());this.Mj.Kd.Ya("IsPreviousModeEditing",
this.fc.F9c.toString());this.Mj.Kd.Ya("IsLastKnownModeEditing",this.fc.SEe.toString());this.Mj.Kd.Ya("PopSessionEverInitialized",this.Jg.RRc.toString());this.Mj.Kd.Ya("ResultErrorCode",he.a[$a]);this.Mj.Kd.Ya("RefreshPage",Fb.toString());this.Mj.Kd.Ya("FRehydrationInitiatedPageRefresh",this.Mj.Yvf.toString());this.Mj.fSucceeded=na;this.Mj.resultCode=$a;this.Mj.FSn();this.Fnh.push(this.Mj);this.Zdn||this.ngh();na?(this.Dh.bhk(new se.a(nc)),this.h8l(Xb,nc)):(this.ngh(),0!==$a&&(na=Le.a.wi($a),n.AFrameworkApplication.Xs(na),
Wa.Health.instance.recordQosError(Le.a.Fja(na),["UnexpectedAppRefresh"],399===$a,!1,!0,Fb,null)),Fb?(n.AFrameworkApplication.TA&&n.AFrameworkApplication.TA.ina(),this.ia.Qa(R.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::SeamlessFailoverEnd"})):(this.Dh.bhk(new se.a(nc)),this.h8l(Xb,nc)))}}gwf(){return this.Mj&&this.Mj.Kd?!0:!1}ngh(){this.gwf()&&(fe.a.J(512497874,801,15,"Action Telemetry: {0}",this.Mj.Kd.Tta()),this.Mj.Kd.finish(!0),this.Mj.dispose(),this.Mj=null)}h8l(na,$a){!this.fc.dO||
na||2!==$a&&1!==$a&&4!==$a?(this.gwf()&&this.Mj.Kd.Ya("PopsRehydrationAttempted","false"),fe.a.J(512497873,809,15,"TriggerRehydrateHostSession is skipped isFileUrlExpired:{0}, rehydrationTriger:{1}",na,$a),this.Nml(null)):(this.gwf()&&this.Mj.Kd.Ya("PopsRehydrationAttempted","true"),this.qS.gda(4===$a?6:7,Object(B.a)(this,this.GBm,"createPopSessionSucceededCallback"),Object(B.a)(this,this.Nml,"createPopSessionFailedCallback")))}GBm(){this.gwf()&&(this.psl(),this.Mj.Kd.Ya("POPSessionCreated","true"),
this.ngh())}Nml(){if(!this.gwf())return!1;this.psl();this.Mj.Kd.Ya("POPSessionCreated","false");this.ngh();return!1}psl(){this.Mj.Kd.Iv("IsInEditingMode",this.fc.Mp.toString());this.Mj.Kd.Iv("IsPreviousModeEditing",this.fc.F9c.toString());this.Mj.Kd.Iv("PopSessionEverInitialized",this.Jg.RRc.toString())}uVn(na){fe.a.J(512497872,801,50,"PodSeamlessfailoverManager TriggerFontsInstallationCallback started with UserHasValidLicenseForEnterpriseFonts:{0}, PPTOEnterpriseFontsEnabled:{1}",this.Fb.getBooleanAppSetting("UserHasValidLicenseForEnterpriseFonts"),
this.Fb.getBooleanAppSetting("PPTOEnterpriseFontsEnabled"));this.Fb.getBooleanAppSetting("UserHasValidLicenseForEnterpriseFonts")&&this.Fb.getBooleanAppSetting("PPTOEnterpriseFontsEnabled")&&Ef(na)}iYl(){this.Mj.Wha=me.a();this.Tb.O_a||this.Tb.stop();let na=this.la.Tke&&this.va.$v?this.va.$v.toString():"";na=ha.a.replaceAll(na,"#","%23");this.EBb.createPodSession(this.Mj.Wha,"SeamlessFailover_"+this.Mj.Ldc,this.Mj.h6c,+new Date-+this.Mj.startTime,Object(B.a)(this,this.FBm,"createPodSessionSucceededCallback"),
Object(B.a)(this,this.EBm,"createPodSessionFailedCallback"),this.VD,this.Fe.podSessionId,na);this.EBb.R9l(this.Mj.Wha,Object(B.a)(this,this.uVn,"triggerFontsInstallationCallback"));this.Tb.Gbb()}FBm(na){if(this.CJa){Cc.a.sfd=[];this.Mj.Kd.Ya("NewPodsId",this.Mj.Wha);this.Fe.podSessionId=this.Mj.Wha;this.Mj.Kd.Ya("CreatePodsWithRetryResult","true");this.Mj.Kd.Ya("CreatePodsRetryCount",this.Mj.h6c.toString());this.Mj.Kd.Ya("CreatePodsDuration",(+new Date-+this.Mj.startTime).toString());this.hq.isPaused&&
this.hq.Mxb();try{this.hq.Nch()}catch($a){fe.a.J(512497871,801,15,"PodSeamlessfailoverManager CancelBlockedOperation failed. {0}",$a)}if(this.la.Tke&&na&&pe.a.bJe in na&&!ha.a.rb(na[pe.a.bJe])){const $a=Boolean.parse(na[pe.a.bJe]);this.Mj.Kd.Ya("RCRestoredWhenCreatePodSession",na[pe.a.bJe]);$a?(this.Mj.Kd.Iv("Result","Success"),this.Mle(!0)):(this.uCj&&this.uCj.vxm(),this.Mj.Kd.Ya("DocRefreshTriggered","true"),na={failedMachineId:null,isPlanedShutdown:!1,fromSeamlessFailoverManager:!0},na.podSessionId=
this.Fe.podSessionId,this.Mj.Yvf=!0,this.ia.Qa(R.a.KCb,2,na))}else this.c8l()}}c8l(){this.$b.gj.yq.D4c(Object(B.a)(this,this.UOl,"onAfterReplication"));this.zVn()}zVn(){const na=()=>{this.Mj.Hqk=new Date;this.Mj.Kd.km("InboundStartTime",this.Mj.Hqk);this.$b.gj.yq.YM(null,null,null)};fe.a.J(512497870,801,50,"PodSeamlessFailoverManager::TriggerInbound - ForceInboundSlide:{0}; ActiveSlide.Sid:{1}; PodSessionID:{2};",!0,this.va.Ga?this.va.Ga.sid:0,this.Mj.Wha);4===this.Mj.Ldc&&this.la.tJe&&this.va.Ga?
(this.dL.b9c&&this.dL.b9c.$jh(this.va.Ga.Xb),this.Mj.Kd.km("ForceInboundSlideStartTime",new Date),this.ez.bCe(this.va.Ga,($a,Fb)=>{fe.a.J(512497869,801,50,"PodSeamlessFailoverManager::TriggerInbound after ForceInboundSlide - SlideId:{0}; SlideStale:{1};",$a,Fb);this.CJa&&(this.Mj.Kd.km("ForceInboundSlideEndTime",new Date),na())},!0,!1)):na()}EBm(na){if(!this.CJa)return!0;const $a=+new Date-+this.Mj.startTime;if(399===na)return fe.a.J(512497868,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, unsupported client - PodSessionID:{0}; Time:{1};",
this.Fe.podSessionId,$a),this.ee.SK(na,null),this.Mle(!1,na,!1),!0;if(this.Mj.nDi&&230===na)return fe.a.J(512497867,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, file url expired - PodSessionID:{0}; Time:{1};",this.Fe.podSessionId,$a),this.Wpl("CreatePodSessionFailed_GetFileUrlFailed",na),!0;if(this.Mj.h6c<this.la.qJe&&$a<this.la.rJe){let Fb;(Fb=this.Mj).h6c=Fb.h6c+1;fe.a.J(512497866,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, continue retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",
this.Fe.podSessionId,this.Mj.h6c,$a,na);this.iYl();return!0}fe.a.J(512497865,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, stopped retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",this.Fe.podSessionId,this.Mj.h6c,$a,na);this.Wpl("CreatePodSessionFailed",na);return!0}Wpl(na,$a){this.Mj.Kd.Ya("CreatePodsWithRetryResult","false");this.Mj.Kd.Ya("CreatePodsRetryCount",this.Mj.h6c.toString());this.Mj.Kd.km("CreatePodsWithRetryET",new Date);
this.Mj.Kd.Iv("Result",na);this.Mj.Kd.Ya("CreatePodsDuration",(+new Date-+this.Mj.startTime).toString());this.Mle(!1,$a)}UOl(na,$a){this.CJa&&($a.Rkh?fe.a.J(512497864,801,50,"PodSeamlessFailoverManager::OnAfterReplication() - Current replication is outbound, replication result: {0}",$a.gbb):(this.Mj.Kd.Iv("InboundDuration",(+new Date-+this.Mj.Hqk).toString()),this.Mj.Kd.Iv("Result","Success"),this.Mle(!0)))}$ab(na,$a){this.CJa&&(this.Mj.Kd.Ya("WaitPodsRefreshedDuration",(+new Date-+this.Mj.Q_n).toString()),
this.Mj.Kd.Ya("NewPodsId",$a.Wha),this.oR.PUc(Object(B.a)(this,this.$ab,"onPodSessionRefreshed")),this.hq.isPaused&&this.hq.Mxb(),this.c8l())}}Object(m.a)(pf,"PodSeamlessFailoverManager",null,[1237]);class eg{constructor(na,$a,Fb){this.HEa=na;this.nb=Fb}GZ(){}T9b(){}f9a(na){na&&(Array.add(na,pe.a.uBg),Array.add(na,pe.a.A8),Array.add(na,pe.a.V1b),Array.add(na,pe.a.RSl),Array.add(na,pe.a.bJe))}Bca(na,$a){$a?(($a=na[pe.a.V1b])&&$a.toLowerCase()!==(this.nb.sia?this.nb.sia.toLowerCase():"")&&(fe.a.J(512497857,
821,15,"HandleResponseHeaders: PodInstance was updated. Id:{0};",$a),this.nb.sia=$a),this.HEa?(na=na[pe.a.uBg])?(this.HEa.A9a=na,fe.a.J(512497827,826,50,"HandleResponseHeaders: CCPInfo was updated, length: {0}",na.length)):fe.a.J(512497826,826,15,"HandleResponseHeaders: CCPInfo couldn't be found in response headers."):fe.a.J(512497856,826,15,"HandleResponseHeaders: ccpInfoOwner is null so skip the response headers.")):fe.a.J(512497858,826,15,"HandleResponseHeaders: abort since argument 'responseHeaders' is null.")}}
Object(m.a)(eg,"RehydrationHeaderHandler",null,[562]);class pg{constructor(na,$a,Fb,Xb,nc,Nc,yd,Ud,ie,Be){this.Kza=null;this.Cnh=!1;this.pyl=oe=>{if(oe.keyCode===C.a.rPe||oe.keyCode===C.a.ocb||oe.keyCode===C.a.b9b||oe.keyCode>=C.a.qgd&&oe.keyCode<=C.a.o9b)return!1;this.qmk(2);return!0};this.Gf=na;this.od=$a;this.HE=Fb;this.jA=Xb;this.ef=nc;this.Qi=Nc;this.KLl=ie;this.Aa=yd;this.es=Ud;this.pqh=Be}init(){this.od&&(this.od.$td(Object(B.a)(this,this.Ovh,"sessionExpired")),this.od.j9a(Object(B.a)(this,
this.Crn,"onRehydrateSession")))}Ovh(){this.R4l(!0);r.ULS.sendTraceTag(594616334,821,50,"Pausing health heartbeat");Wa.Health.instance.stopAllHealthTimers()}qmk(na){this.R4l(!1);const $a=n.AFrameworkApplication.DE||!Ac.a("Rehyrdation.StopRefreshIfWopiRefreshDisable");r.ULS.sendTraceTag(544789148,821,100,"Should refresh token: {0}",$a);$a&&this.pqh&&this.pqh.zdi(0);this.Aa.mqa&&this.es.V_g(!1,na,223)}Crn(){r.ULS.sendTraceTag(594616333,821,50,"Resuming health heartbeat");Wa.Health.instance.resumeAllHealthTimers()}R4l(na){this.Cnh!==
na&&this.Gf&&(na?(this.Kza||(this.Kza=this.Qi.hg(),this.Kza.id="sessiontimeoutoverlay",this.Kza.className="SessionTimeoutOverlay",this.Kza.tabIndex=-1,this.Vsm(this.Kza),this.Gf.appendChild(this.Kza)),this.Cnh=!0,this.KLl(this.Kza)):(this.Wnl(this.Kza),this.Kza&&this.Kza.parentNode&&this.Kza.parentNode.removeChild(this.Kza),this.Kza=null,this.Cnh=!1))}Vsm(na){na&&(this.ef.Zb(v.a.click,na,Object(B.a)(this,this.Sac,"handleClickEvent")),this.ef.Zb(v.a.doubleClick,na,Object(B.a)(this,this.Sac,"handleClickEvent")),
Ac.a("FixRehydrationOnKeyPress")?this.jA.addHandler(na,v.a.Lj,this.pyl):this.HE.Zb(v.a.Lj,na,Object(B.a)(this,this.ryl,"handleKeyEvent")),$addHandler(window,"visibilitychange",Object(B.a)(this,this.SOa,"onVisibilityChange")))}Wnl(na){na&&(this.ef.jc(v.a.click,na,Object(B.a)(this,this.Sac,"handleClickEvent")),this.ef.jc(v.a.doubleClick,na,Object(B.a)(this,this.Sac,"handleClickEvent")),Ac.a("FixRehydrationOnKeyPress")?this.jA.removeHandler(na,v.a.Lj,this.pyl):this.HE.jc(v.a.Lj,na,Object(B.a)(this,this.ryl,
"handleKeyEvent")),$removeHandler(window,"visibilitychange",Object(B.a)(this,this.SOa,"onVisibilityChange")))}Sac(){this.qmk(1);return!0}ryl(na){if(na.Sb.ctrlKey||na.Sb.altKey||na.Sb.shiftKey||na.Sb.keyCode>=C.a.qgd&&na.Sb.keyCode<=C.a.o9b)return!1;this.qmk(2);return!0}SOa(){n.AFrameworkApplication.DE&&!window.document.hidden&&this.pqh&&this.pqh.zdi(1)}dispose(){this.od.QKg(Object(B.a)(this,this.Ovh,"sessionExpired"));this.Kza&&(this.Wnl(this.Kza),this.Kza.parentNode&&this.Kza.parentNode.removeChild(this.Kza));
this.jA=this.HE=this.ef=null;this.Cnh=!1;this.KLl=null}}Object(m.a)(pg,"SessionRehydrationController",null,[]);class ne{constructor(){this.Ha=null}lc(na){this.Ha=na||z.a.instance}dispose(){}}Object(m.a)(ne,"TellMePackage",null,[3,4]);class sf{}sf.fI="TellMe";sf.contextMenu="ContextMenu";sf.unknown="Unknown";Object(m.a)(sf,"TellMeScenario",null,[]);class Ye{}Ye.appName="AppName";Ye.uIa="CloseAllMenus";Ye.commandId="CommandId";Ye.context="Context";Ye.culture="Culture";Ye.message="Message";Ye.errorMessage=
"ErrorMessage";Ye.event="Event";Ye.interactionId="CorrelationID";Ye.bun="ParentUiElement";Ye.query="Input";Ye.queryId="QueryID";Ye.pWl="QueryLength";Ye.VKe="QueryIndex";Ye.iIn="ResultsList";Ye.suggestions="Suggestions";Ye.scenario="Scenario";Ye.sessionId="SessionID";Ye.source="Source";Ye.timeStamp="Time";Ye.K8l="UiElement";Ye.Lth="ReactUx";Ye.value="Val";Ye.statusCode="StatusCode";Ye.BKn="Service";Ye.isSuccess="IsSuccess";Ye.HUn="TokenAcquired";Ye.s8m="LatencyType";Ye.groupName="GroupName";Ye.YQb=
"GroupIndex";Ye.groupType="GroupType";Ye.eIn="ResultInfoList";Ye.resultType="ResultType";Ye.ZMk="SubResultType";Ye.V4m="IsInputBlur";Ye.W4m="IsInputFocus";Ye.s6m="IsShortCutUsed";Ye.actionType="ActionType";Ye.count="Count";Ye.SFm="DwellTime";Ye.qEl="IsZeroTerm";Ye.i0n="WordsCount";Ye.M9c="IsSearchUxEnabled";Ye.$6m="IsTellMeInHeaderEnabled";Ye.module="Module";Ye.resultIndex="ResultIndex";Ye.Avi="DisplayIndex";Ye.zGm="EnableList";Ye.provider="Provider";Ye.contentType="ContentType";Ye.i6m="IsSelectionBased";
Ye.Otm="BeginPerformanceMarker";Ye.MGm="EndPerformanceMarker";Ye.avn="PerformanceMeasure";Object(m.a)(Ye,"Columns",null,[]);class Yd{}Yd.click="Click";Yd.yEe="InteractionBegin";Yd.fBl="InteractionEnd";Yd.yll="ControlActivated";Yd.query="Query";Yd.oWl="QueryIndexRecorded";Yd.Ckl="Clicks";Yd.Edl="ActionEvents";Yd.Srl="FilteredActionEvents";Yd.R1l="SessionContext";Yd.latency="Latency";Yd.performance="Performance";Yd.RZl="RenderedResults";Yd.events="Events";Yd.RBm="CreateResultsMenu";Yd.nD="UpdateRibbonControls";
Yd.hIn="ResultsAggregation";Yd.l8="IssueQuery";Yd.yym="CommandSuggestions";Yd.error="Error";Yd.Euj="LoadModelData";Yd.EDm="DepsResolveTime";Yd.Agn="ModelDataWaitTime";Yd.timedOut="TimedOut";Yd.crm="AddinQueryCommandReady";Yd.CLm="GetAddinEntitlements";Yd.iWl="ProviderMRUEvents";Yd.xGm="EnableAddinSearchCommands";Object(m.a)(Yd,"EventNames",null,[]);class Lg{constructor(na,$a,Fb=null,Xb=null,nc=4,Nc=-99999,yd=0){this.additionalInfo="";this.qbh=-1;this.value=na;this.type=$a;this.subType=nc;this.label=
this.fqa=Fb;this.groupType=30;this.description=Xb;this.score=Nc;this.count=yd}}Object(m.a)(Lg,"ResultBinding",null,[]);class Yg{constructor(na=30,$a=""){this.tlm=[];this.groupType=na;this.displayName=$a}get results(){return this.tlm}oP(na){na.groupType=this.groupType;Array.add(this.results,na)}Nnk(na=1){if(this.results.length>=na)for(let $a=0;$a<na;$a++)Array.removeAt(this.results,this.results.length-1)}}Object(m.a)(Yg,"SimpleResultGroup",null,[1517]);class Ng{constructor(na){this.attributes=null;
this.query=na;this.uz=[]}AL(na){this.uz.push(na)}xYl(na){const $a=[];for(const Fb of this.uz)Fb.groupType!==na&&$a.push(Fb);this.uz.length!==$a.length&&(this.uz=$a)}get dFe(){return!1}}Object(m.a)(Ng,"SimpleResultsUpdatedEventArgs",null,[1514]);var df=a(126);class Pg{constructor(){this.userId=this.email=this.displayName=null}}Object(m.a)(Pg,"InsertMentionParameters",null,[]);class ig{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(m.a)(ig,"InsightsParameters",null,
[]);class ji{constructor(na,$a,Fb,Xb,nc){this.vSh=na;this.uSh=$a;this.Hmm=Fb;this.kim=Xb;this.F7k=nc}get Uke(){return 4}qsa(na,$a=null){$a=$a.sessionId+"|"+$a.interactionId+"|"+na.fqa;if(this.F7k||this.kim){let Fb=this.F7k||ha.a.OI(Object(aa.a)("HelpTooltip"))===ha.a.OI(na.fqa.trim());if(this.Hmm&&2<na.fqa.length){const Xb=na.fqa;";"===Xb.charAt(0)&&";"===Xb.charAt(Xb.length-1)&&Xb.substring(1,Xb.length-1)===ji.R7i&&(Fb=!0)}na=Fb?Object(aa.a)("HelpButtonTextNoPlaceholder"):String.format(Object(aa.a)("TextWithQuotation"),
na.fqa);return this.itl($a,ha.a.Re(na),Fb)}return this.itl($a,ha.a.Re(String.format(Object(aa.a)("TextWithQuotation"),na.fqa)),!1)}itl(na,$a,Fb){return Oa.a(ji.R7i,Fb?this.uSh:this.vSh,$a,"OfficeAssistant_16x16x32","A0",ha.a.Re(na),$a,null,null)}}ji.R7i="bSearchHelp";Object(m.a)(ji,"AssistanceMenuItemFactory",null,[1551]);class Ca{get Uke(){return 13}qsa(){return Ca.Bum()}static Bum(){return Oa.b(Ca.lsl,"798637440",ha.a.Re(Object(aa.a)("LookupFirstRunExperienceTitle")),n.AFrameworkApplication.jp,
Ja.d("Info_32x32x32"),null,null,ha.a.Re(Object(aa.a)("LookupFirstRunExperienceTitle")),"Menu32",null,null,ha.a.Re(Object(aa.a)("LookupFirstRunExperienceDescription")),null,null)}}Ca.lsl="bTellMeFirstRun";Object(m.a)(Ca,"FirstRunMenuItemFactory",null,[1551]);class cb{constructor(na=null,$a=null){this.p$k=na;this.ckm=$a||Object(aa.a)("LookupNoResultsDescription")}get Uke(){return 14}qsa(na){na=String.format(this.ckm,na.fqa);return this.Wum(na)}Wum(na){return Oa.b(cb.oOl,"798637440",ha.a.Re(Object(aa.a)("LookupNoResultsTitle")),
this.p$k?n.AFrameworkApplication.jp:null,this.p$k,null,null,ha.a.Re(Object(aa.a)("LookupNoResultsTitle")),"Menu32",null,null,ha.a.Re(na),null,null)}}cb.oOl="lookupNoResults";Object(m.a)(cb,"NoCommandsFoundMenuItemFactory",null,[1551]);class Eb{constructor(na,$a){this.FontWeight=0;this.Text=null;this.FontWeight=na;this.Text=$a}}Object(m.a)(Eb,"LabelFormatted",null,[]);var fc=a(598),Ec=a(821),Ya=a(332);class Ub{}Ub.dBl="bInsights";Object(m.a)(Ub,"InsightsMenuItemFactoryStatic",null,[]);class rc{static get W2m(){return"Insights_16x16x32"}static get cJm(){return"Find_16x16x32"}static get aTl(){return"-Parameterized"}static get SJk(){return"Parameterized"}static get mzh(){return"bTryQuery"}static get MUk(){return"TellMeSuggestion_"}static get B8l(){return"bTryQueryAlternate"}static get zPk(){return"MenuTellMe"}static get Tun(){const na=
{},$a=[];Array.add($a,{Term:{PeopleType:"Person"}});na.And=$a;return na}static NCm(na){return na+rc.aTl}static getParameter(na){let $a="",Fb="";if(na)for(let Xb=0;Xb<na.Hrl;++Xb)"Type"===na.getFieldName(Xb)?$a=na.gb(Xb):"Value"===na.getFieldName(Xb)&&(Fb=na.gb(Xb));return new df.a($a,Fb)}static Wpi(na){na=Object.assign(new ig,{neighborhood:na,mentionStart:0,mentionLength:na.length});return hb.c(na)}static Xml(na,$a,Fb){na=Object.assign(new Pg,{displayName:na,email:$a,userId:Fb});return hb.c(na)}static hrc(na,
$a,Fb=null){return hb.c(rc.Jwl(na,$a,Fb,null))}static Jwl(na,$a,Fb=null,Xb=null){na=Object.assign(new Ec.a,{neighborhood:na,mentionStart:0,mentionLength:na?na.length:0});return Object.assign(new fc.a,{selection:na,userIntent:Xb,entryPoint:$a,launchData:Fb})}static gIn(na,$a){return rc.hrc(na,rc.H_l($a))}static H_l(na){switch(na){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;
default:return 0}}static J4m(){return!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("IsGoLocalEnvironment")}static mFe(){const na=n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.La("SovereignEnvironmentName"):null;return!!na&&0<na.length}static isEnterpriseUser(){const na=n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.La("HostAuthType"):null;return!!na&&"aad"===na.toLowerCase()||"external"===na&&rc.Khj()}static uFk(na){return na.LTn&&!rc.mFe()}static e6m(){const na=
n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.La("UiHostIntegrationType"):"";return!!n.AFrameworkApplication.ga&&"UnifiedUiHostTeams"===na&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static tFk(na){return na.Jec&&na.HIm&&(na.gZg||na.fZg||na.R9c)&&!rc.e6m()&&rc.isEnterpriseUser()&&!rc.mFe()}static fmb(){return n.AFrameworkApplication.ga?n.AFrameworkApplication.j7b||n.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupEnableNativePane"):
n.AFrameworkApplication.j7b}static L$(na){return!na||rc.QDl(na.Fl)}static QDl(na){return!na||!na.trim().length}static czh(na){if(!na)return 0;const $a=Math.pow(10,5);return Math.round(na*$a)/$a}static yUn(){var na=new Date;return na?new Date(na.getUTCFullYear(),na.getUTCMonth(),na.getUTCDate(),na.getUTCHours(),na.getUTCMinutes(),na.getUTCSeconds(),na.getUTCMilliseconds()):null}static tYi(na){return(rc.yUn().getTime()-(new Date(na)).getTime())/1E3}static VDl(na){switch(na){case ji.R7i:case Ca.lsl:case Ub.dBl:case cb.oOl:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return na.startsWith(rc.mzh)||
na.startsWith(rc.MUk)||na.startsWith(rc.B8l)||na.startsWith("PeopleSuggestion")||na.startsWith("FileSuggestion")||na.startsWith("FindInDocumentSuggestion")||na.startsWith("NotesSuggestion")||na.startsWith("OnenoteNotesSuggestion")||na.startsWith("SmartLookupFromTellMe")||na.startsWith("GetHelpFromTellMe")||na.startsWith("GetHelpWithDescriptionFromTellMe")||na.startsWith("AddinSuggestion")||na.startsWith("OfficeScripts")?!0:!1}static YNi(na,$a){const Fb=[];Array.add(Fb,new Eb(400,na));Array.add(Fb,
new Eb(200,$a));na={};na.parts=Fb;return JSON.stringify(na)}static N7c(na){const $a=na.indexOf("<b0>"),Fb=na.lastIndexOf("</b0>"),Xb=[];Array.add(Xb,new Eb(400,na.substring(0,$a)));Array.add(Xb,new Eb(600,na.substring($a+4,Fb)));Array.add(Xb,new Eb(400,na.substring(Fb+5,na.length)));na={};na.parts=Xb;return JSON.stringify(na)}static hxl(na){const $a=rc.tYi(na);60>$a?na=Object(aa.a)("TimeSince_SecsAgo"):3600>$a?(na=Math.floor($a/60),na=String.format(Object(aa.a)("TimeSince_MinsAgo"),na.toString())):
86400>$a?(na=Math.floor($a/3600),na=String.format(Object(aa.a)("TimeSince_HoursAgo"),na.toString())):172800>$a?na=Object(aa.a)("TimeSince_Yesterday"):(na=new Date(na),na=String.format(Object(aa.a)("TimeSince_Date"),na.localeFormat("MMMM dd, yyyy")));return na}static QMm(na){const $a=Array(na.length);for(let Fb=0;Fb<na.length;Fb++)$a[Fb]=na[Fb].commandId;return $a}static Khj(){if("Dev Box"===n.AFrameworkApplication.ga.La("StatusBarEnvironmentNameToUse"))return!0;let na=n.AFrameworkApplication.ga.La("UserPrincipalName");
na=Ya.b(na)?"":ha.a.mj(na);const $a=n.AFrameworkApplication.ga.Tz("TellMeIntEnabledForFeatureCrew")?n.AFrameworkApplication.ga.tF("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf($a,na)&&"inner"===n.AFrameworkApplication.ga.La("Microsoft365Ring")}static yPm(na){switch(rc.phh(na)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static wTm(na){na=
rc.phh(na);switch(na){case "PowerPoint":return"pptx";case "Word":return"docx";case "Excel":return"xlsx";default:return na}}static phh(na){switch(na.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";
case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static eA(){return Tc.a.WT&&!Tc.a.hm}static mNm(na){if("word"===na.application.toLowerCase())return"ChatPane";if("powerpoint"===na.application.toLowerCase())return"ChatPPTPane";if("excel"===na.application.toLowerCase())return"Copilot"}static PMm(na){if("excel"===
na.application.toLowerCase())return"ShareMenu"}}rc.Lyh=9E5;Object(m.a)(rc,"TellMeUtils",null,[]);var fd=a(599),Cd=a(1584),Jd=a(233);class Rd{constructor(){this.dah=null;this.xyb=[];this.qxe=!0;this.C9g=null;this.Ycl=!1;this.Z3=null;this.mOh=[];this.bGh=[];this.aGh=[];this.qWh=[];this.F$g=this.jHb=null;this.nOh=[];this.HKh=this.SUh=this.Zd=null;this.$4e=-1;this.B7g=this.IJh=null}static get instance(){return Rd.Wa||(Rd.Wa=new Rd)}jKi(){return this.mOh}Zgh(){return this.bGh}QKi(){return this.aGh}aZi(){return this.qWh}xQi(){return this.jHb}get jVg(){return this.F$g}set jVg(na){this.F$g=
na}kKi(){return this.nOh}Q2g(na,$a="",Fb=null){na?this.B7g=new Cd.a(Jd.a.Wn()):$a&&Fb&&this.B7g.add($a,Fb)}ZCe(){return Rd.instance.Rv?Rd.instance.Rv.sUa.interactionId:null}get Qoc(){return this.B7g}set Qoc(na){this.B7g=na}get Jka(){return Rd.instance.SUh}set Jka(na){Rd.instance.SUh=na}NXi(){return this.SUh}get actions(){return Rd.instance.xyb}set actions(na){Rd.instance.xyb=na}wca(){return this.Zd}Jp(){return this.HKh}feh(){return this.$4e}tOi(){return this.IJh}get ux(){return Rd.instance.Zd}set ux(na){Rd.instance.Zd=
na}set TCh(na){Rd.instance.dah=na}get lDe(){return Rd.instance.IJh}set lDe(na){Rd.instance.IJh=na}get Rv(){return Rd.instance.HKh}set Rv(na){Rd.instance.HKh=na}get Hub(){return Rd.instance.$4e}set Hub(na){Rd.instance.$4e=na}static get Unknown(){return Rd.unknown}get Eof(){return this.Z3?this.Z3.contentType:Rd.unknown}nD(na){const $a=window.performance.now();this.dah&&!Ya.b(na)&&(this.dah(na),Rd.instance.Rv.Zca(Yd.nD,window.performance.now()-$a))}get Ftg(){return this.qxe}set Ftg(na){this.qxe=na}get d6g(){return this.C9g}set d6g(na){this.C9g=
na}get u1c(){return this.Ycl}set u1c(na){this.Ycl=na}get oIe(){return this.mOh}set oIe(na){this.mOh=na}get kAe(){return this.bGh}set kAe(na){this.bGh=na}get jAe(){return this.aGh}set jAe(na){this.aGh=na}get mPe(){return this.qWh}set mPe(na){this.qWh=na}get Uab(){return this.jHb}set Uab(na){this.jHb=na}get kpe(){return this.F$g}set kpe(na){this.F$g=na}get pIe(){return this.nOh}set pIe(na){this.nOh=na}}Rd.Wa=null;Rd.unknown="Unknown";Object(m.a)(Rd,"TellMeActorConstants",null,[]);class Me{constructor(na){this.Zd=
na}zca(){return"ActionAI"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:2}l8(na,$a,Fb=!1,Xb,nc=null){Xb=new Ng(na);if(!nc||Array.contains(nc,24))if(this.JOn()||!rc.L$(na)){nc=new Yg(24);var Nc=rc.L$(na);Fb&&(Fb=null,rc.fmb()&&(Fb=rc.hrc(Nc?"":na.Fl,1,Object.assign(new fd.a,{landingTab:"ActionAI"}))),this.Zd.vAb?Fb&&Rd.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Fb)):(na=[],Fb&&na.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Fb)),appChrome.api.dispatch(na)));
nc.oP(new Lg("ActionAIFromTellMe",25,null,null,1));Xb.AL(nc)}$a.kE(Xb)}JOn(){return rc.fmb()&&this.Zd.bkh}}Object(m.a)(Me,"ActionAIResultsProvider",null,[1292]);class lf{}lf.pNl=0;lf.DFg=10;Object(m.a)(lf,"AppsForOfficeStoreType",null,[]);class yf{constructor(){this.WTh=0}mek(na,$a){this.WTh=window.performance.now();this.g9b(()=>{const Fb=window.performance.now(),Xb={},nc=n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);$a.Mfl&&
(Xb.callback=Nc=>{na(Nc,lf.pNl,Fb)},nc&&(Xb.storeType=lf.pNl),n.AFrameworkApplication.vb.Qa(ub.a.L5a,2,Xb));$a.Nfl&&(Xb.callback=Nc=>{na(Nc,lf.DFg,Fb)},nc?Xb.storeType=lf.DFg:n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?Xb.storeType=10:Xb.storeType=lf.DFg,n.AFrameworkApplication.vb.Qa(ub.a.L5a,2,Xb))},0,()=>{if(Rd.instance.Jp())Rd.instance.Jp().onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+
(window.performance.now()-this.WTh)+" ms")})}g9b(na,$a=0,Fb=null){2!==n.AFrameworkApplication.vb.Cb(ub.a.L5a,1)?(Rd.instance.Jp()&&Rd.instance.Jp().Zca(Yd.crm,window.performance.now()-this.WTh),na()):$a<yf.hgn?n.AFrameworkApplication.je.Qb(new La.a(2,1,yf.P_n,()=>{this.g9b(na,$a+1,Fb)})):Fb&&Fb()}static get instance(){yf.Wa||(yf.Wa=new yf);return yf.Wa}}yf.Wa=null;yf.hgn=20;yf.P_n=500;Object(m.a)(yf,"AddinEntitlementsQuery",null,[]);class ff{constructor(){this.description=this.id=this.displayName=
null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.jsj=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(m.a)(ff,"AddinInfo",null,[]);class jf{constructor(na){this.oRh=[];this.Zd=na;this.Wpn=($a,Fb,Xb)=>{if($a){const nc=$a.errorCode;if(Rd.instance.Jp()){const Nc={};Nc.StoreType=Fb;Nc.ErrorCode=nc;Nc.AddinCount=$a.value?$a.value.length:0;Rd.instance.Jp().Zca(Yd.CLm,window.performance.now()-Xb,Nc)}if(0===nc&&$a.value){jf.cud=
jf.cud||{};$a=$a.value;for(const Nc of $a)$a=new ff,$a.displayName=Nc[0],$a.id=Nc[1],$a.description=Nc[2],$a.targetType=Nc[3],$a.appVersion=4<Nc.length?Nc[4]:"",$a.assetId=5<Nc.length?Nc[5]:"",$a.assetStoreId=6<Nc.length?Nc[6]:"",$a.width=7<Nc.length?Nc[7]:0,$a.height=8<Nc.length?Nc[8]:0,$a.iconUrl=9<Nc.length?Nc[9]:"",$a.providerName=10<Nc.length?Nc[10]:"",$a.storeId=11<Nc.length?Nc[11]:"",$a.storeType=12<Nc.length?Nc[12]:"",$a.jsj=this.SPm($a),jf.cud[$a.id]=$a,0<$a.iconUrl.length&&(Fb="AddinIcon_"+
$a.id,n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.TXl(Fb,$a.iconUrl):appChrome.addInApi.registerAddinIcon(Fb,$a.iconUrl))}}};yf.instance.mek(this.Wpn,this.Zd)}zca(){return"Add-ins"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:2}l8(na,$a,Fb,Xb,nc=null){Fb=new Ng(na);nc&&!Array.contains(nc,27)||rc.L$(na)||(nc=new Yg(27),nc.displayName=Object(aa.a)("TellMeAddinProviderTitle"),this.KPm(na.Fl,nc),Fb.AL(nc));$a.kE(Fb)}KPm(na,
$a){if((na=this.wJn(na))&&0<na.length){let Fb=0;na.forEach(Xb=>{if(!(3<++Fb)){var nc="AddinSuggestion"+Fb,Nc={};if(n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var yd="AddinIcon_"+Xb.id;0>Array.indexOf(this.oRh,yd)&&0<Xb.iconUrl.length&&this.TXl(yd,Xb.iconUrl);Nc["default"]=0<=Array.indexOf(this.oRh,yd)?yd:"AppForOfficeLogo_20"}else Nc["default"]=0<Xb.iconUrl.length?"AddinIcon_"+Xb.id:"AppForOfficeLogo_20";yd=[];yd.push(appChrome.actions.setControlLabel(nc,
Xb.displayName));yd.push(appChrome.actions.setControlIconSet(nc,Nc));yd.push(appChrome.actions.setCompoundButtonCommandValueId(nc,Xb.id));yd.push(appChrome.actions.updateCompoundButtonDescription(nc,Xb.description));n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(Nc=window.performance.now(),yd.push(appChrome.actions.updateControlEnabledDisabledState(nc,!1)),Rd.instance.Jp()&&Rd.instance.Jp().Zca(Yd.xGm,window.performance.now()-
Nc));appChrome.api.dispatch(yd);nc=new Lg(nc,27,void 0,void 0,1);nc.additionalInfo=Telemetry.PrivacyRules.GetPrivacyCompliantId(Xb.id,Xb.storeType,Xb.assetId,null,null,Xb.storeId);$a.oP(nc)}})}}TXl(na,$a){Oc.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(na,$a),Array.add(this.oRh,na))}wJn(na){if(!jf.cud)return null;const $a=[],Fb=jf.cud;for(const nc in Fb){var Xb=Fb[nc];Xb&&jf.Mfn(na,Xb)&&Array.add($a,Xb)}return $a}SPm(na){return jf.ORn(na.displayName)}static Mfn(na,
$a){if(!$a.jsj)return!1;for(const Fb of na.split(" ")){na=!1;for(const Xb of $a.jsj)if(Xb.toLowerCase().startsWith(Fb.toLowerCase())){na=!0;break}if(!na)return!1}return!0}static ORn(na){const $a=[];for(const Fb of na.split(" ")){na=0;for(let Xb=0;Xb<Fb.length;Xb++){const nc=Fb.charAt(Xb);nc.toString().toUpperCase()===nc.toString()&&Xb>na&&(Array.add($a,Fb.substring(na,Xb)),na=Xb)}Array.add($a,Fb.substring(na,Fb.length));na&&Array.add($a,Fb.substring(0,Fb.length))}return $a}}jf.cud=null;Object(m.a)(jf,
"AddinResultsProvider",null,[1292]);class Nf{constructor(na,$a){this.gEh=na;this.xn=$a}kE(na){this.gEh.IMn(this.xn,na)}}Object(m.a)(Nf,"AggregatorResultsProviderCallback",null,[1548]);class og{constructor(na){this.yyb=null;this.Zd=na;this.Zd.avd&&(this.yyb=null)}zca(){return"AppsForOffice"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:2}l8(na,$a,Fb,Xb,nc=null){Fb=new Ng(na);if(!nc||Array.contains(nc,1))nc=new Yg(1),this.yyb.S1n(nc,na.Fl),Fb.AL(nc);$a.kE(Fb)}}Object(m.a)(og,"AppsForOfficeRecommendationResultsProvider",
null,[1292]);class Tg{constructor(na){this.Zd=na}zca(){return"Assistance"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:this.Zd.pAg?3:2}l8(na,$a,Fb=!1,Xb,nc=null){Xb=new Ng(na);if((!nc||Array.contains(nc,8))&&!rc.L$(na)){nc=new Yg(8);if(Fb){Fb=ha.a.OI(Object(aa.a)("HelpTooltip"))===ha.a.OI(na.Fl.trim())?Object(aa.a)("HelpButtonTextNoPlaceholder"):String.format(Object(aa.a)("TextWithQuotation"),na.Fl);const Nc=[];this.Zd.Q9c&&(this.Zd.rHk||Nc.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",
{"default":"search_20"})),Fb=this.Fvl(na.Fl));const yd="||"+na.Fl;Nc.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",Fb));Nc.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",yd));appChrome.api.dispatch(Nc);na=new Lg("GetHelpFromTellMe",4,na.Fl,null,1)}else na=new Lg("bSearchHelp",4,na.Fl,null,1);nc.oP(na);nc.displayName=Object(aa.a)("HelpButtonTitle");Xb.AL(nc)}$a.kE(Xb)}K8c(na,$a=null){const Fb=new Yg(8),Xb=ha.a.OI(Object(aa.a)("HelpTooltip"))===ha.a.OI(na.Fl.trim())?
Object(aa.a)("HelpButtonTextNoPlaceholder"):String.format(Object(aa.a)("TextWithQuotation"),na.Fl);for(let Nc=0;Nc<$a.length&&2>Nc;Nc++){var nc=[];let yd="GetHelpWithDescriptionFromTellMe"+(Nc+1).toString(),Ud=4;if(this.Zd.wTg)nc.push(appChrome.actions.setControlLabel(yd,Xb)),nc.push(appChrome.actions.setCompoundButtonCommandValueId(yd,na.Fl)),nc.push(appChrome.actions.updateCompoundButtonDescription(yd,this.GUm($a.length)));else if(this.Zd.xTg){let ie=this.pxl($a[Nc]);yd="GetHelpFromTellMe"+(Nc+
1).toString();this.Zd.Q9c&&(ie=this.Fvl(ie));Ud=9;nc.push(appChrome.actions.setControlLabel(yd,ie));nc.push(appChrome.actions.setButtonCommandValueId(yd,this.EUm($a[Nc])))}appChrome.api.dispatch(nc);nc=new Lg(yd,Ud,null,null,0);nc.label=this.pxl($a[Nc]);nc.description=this.DUm($a[Nc]);Fb.oP(nc);if(this.Zd.xTg)break}Fb.displayName=Object(aa.a)("HelpButtonTitle");return Fb}GUm(na){return 1===na?String.format(Object(aa.a)("SearchResultText"),na):String.format(Object(aa.a)("SearchResultsText"),na)}Fvl(na){return this.Zd.Ppj?
rc.YNi(na,Object(aa.a)("HelpScopedButtonText")):na+Object(aa.a)("HelpScopedButtonText")}pxl(na){return na.name?na.name:""}DUm(na){return na.description?na.description:""}EUm(na){return na.id?"AssetID="+na.id:""}}Object(m.a)(Tg,"AssistanceResultsProvider",null,[1292]);var Ce=a(322),vf=a(523);class Eg{constructor(na,$a){this.Wb=na;this.Kbn=$a}isMatch(na,$a){if(!Object(Yc.a)(1733,na))throw Error.argument("objToTest","Expected feature bundle");let Fb;return({value:Fb}=na.lD(this.Wb.rzb)).returnValue?
this.Wb.h0k.isMatch(Fb,$a):this.Kbn}}Object(m.a)(Eg,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1785]);class hf{constructor(na,$a){this.Wb=na;this.rEj=$a}isMatch(na){if(!Object(Yc.a)(1733,na))throw Error.argument("objToTest","Expected feature bundle");return!!(this.rEj^na.lD(this.Wb.rzb).returnValue)}}Object(m.a)(hf,"AnnotatedWithAnnotationFilter",null,[1785]);class Qh{constructor(na){this.Wb=na}isMatch(na,$a){if(!Object(Yc.a)(1736,na))throw Error.argument("objToTest","Expected struct value");
return this.Wb.h0k.isMatch(na.e8c(this.Wb.vac),$a)}}Object(m.a)(Qh,"FieldValueMatchesStructFilter",null,[1785]);class hi{constructor(na,$a){na&&(this.vac=na.ha(0),this.h0k=$a.kjb(na.ha(1)))}}Object(m.a)(hi,"FieldValueMatchesStructFilterInit",null,[]);class Vg{constructor(na){this.rEj=na}isMatch(na){if(!Object(Yc.a)(1733,na))throw Error.argument("objToTest","Expected feature bundle");return!!(this.rEj^na.r6i)}}Object(m.a)(Vg,"HasAnnotationsAnnotationFilter",null,[1785]);class uh{constructor(na,$a){this.Wb=
na;this.As=$a}isMatch(na,$a){if(!Object(Yc.a)(1735,na))throw Error.argument("objToTest","Expected list value");switch(this.As){case 0:for(const Fb of na.items)if(this.Wb.filter.isMatch(Fb,$a))return!0;return!1;case 1:for(const Fb of na.items)if(!this.Wb.filter.isMatch(Fb,$a))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(uh,"ItemTestListFilter",null,[1785]);class Eh{constructor(na){this.Wb=na}isMatch(na,$a){if(!Object(Yc.a)(1735,na))throw Error.argument("objToTest","Expected list value");
return this.Wb.filter.isMatch(na.items.length,$a)}}Object(m.a)(Eh,"LengthMatchesListFilter",null,[1785]);class Bh{constructor(na,$a){this.Wb=na;this.As=$a}isMatch(na,$a,Fb=null){let Xb=0===this.As;for(const nc of this.Wb.Ijl)if((Xb=nc.isMatch(na,$a,Fb))?1===this.As:0===this.As)return Xb;2===this.As&&(Xb=!Xb);return Xb}}Object(m.a)(Bh,"NonterminalFilter",null,[1785]);class ag{constructor(na,$a){if(na){var Fb=na.ha(0);this.Ijl=Array(Fb);for(let Xb=0;Xb<Fb;++Xb)this.Ijl[Xb]=$a.kjb(na.ha(1+Xb))}}}Object(m.a)(ag,
"NonterminalFilterInit",null,[]);class zf{constructor(na,$a){this.Wb=na;this.As=$a}isMatch(na,$a){if("number"!==typeof na)throw Error.argument("objToTest","Expected number value");let Fb=this.Wb.number;if(this.Wb.query){$a=this.Wb.query.AI(null,$a);if("number"!==typeof $a)throw Error.invalidOperation("Query did not return number");Fb+=$a}switch(this.As){case 0:return na===Fb;case 1:return na<Fb;case 2:return na<=Fb;case 3:return na>Fb;case 4:return na>=Fb;default:throw Error.notImplemented();}}}Object(m.a)(zf,
"NumberFilter",null,[1785]);class Df{constructor(na,$a){na&&(this.number=na.ha(0),this.query=na.ha(1)?$a.vca(na.ha(1)):null)}}Object(m.a)(Df,"NumberFilterInit",null,[]);class $f{constructor(na,$a,Fb){this.mhh=this.ROm;this.wNa=na;this.BIl=$a;this.AIl=Fb}idi(na){this.BIl=na}ROm(na){if(!na)throw Error.argument("name","Invalid named feature bundle reference");const $a=na.substr(1);return 1===na.charCodeAt(0)&&$a===this.wNa?this.BIl:this.AIl?this.AIl.mhh(na):null}}Object(m.a)($f,"SimpleNamedFeatureBundleResolver",
null,[1806]);class Kg{constructor(na){this.Wb=na}isMatch(na,$a){if(!Object(Yc.a)(1733,na))throw Error.argument("objToTest","Expected feature bundle");na=this.Wb.query.AI(null,new $f(this.Wb.Zzh,na,$a));if("boolean"!==typeof na)throw Error.invalidOperation("Query did not return bool");return na}}Object(m.a)(Kg,"PredicateAnnotationFilter",null,[1785]);class ug{constructor(na,$a){na&&(this.Zzh=$a.i3(na.ha(0)),this.query=$a.vca(na.ha(1)))}}Object(m.a)(ug,"PredicateAnnotationFilterInit",null,[]);class rh{constructor(na){this.Wb=
na}isMatch(na,$a){if("boolean"!==typeof na)throw Error.argument("objToTest","Expected bool value");$a=this.Wb.query.AI(null,$a);if("boolean"!==typeof $a)throw Error.invalidOperation("Query did not return bool");return na===$a}}Object(m.a)(rh,"QueryBooleanFilter",null,[1785]);class gh{constructor(na,$a){this.Wb=na;this.As=$a}isMatch(na,$a){if("number"!==typeof na)throw Error.argument("objToTest","Expected integer");$a=this.Wb.query.AI(null,$a);if("number"!==typeof $a)throw Error.invalidOperation("Query did not return an enum value");
switch(this.As){case 0:return na===$a;case 1:return 0!==(na&$a);case 2:return na===(na&$a);case 3:return $a===(na&$a);default:throw Error.notImplemented();}}}Object(m.a)(gh,"QueryEnumFilter",null,[1785]);class Mh{constructor(na,$a){na&&(this.Okh=1===na.ha(0),this.query=$a.vca(na.ha(1)))}}Object(m.a)(Mh,"QueryEnumFilterInit",null,[]);class Rh{constructor(na,$a){this.Wb=na;this.As=$a}isMatch(na,$a){if(!Object(Yc.a)(1735,na))throw Error.argument("objToTest","Expected list value");$a=this.Wb.query.AI(null,
$a);if(!Object(Yc.a)(1735,$a))throw Error.invalidOperation("Query did not return list value");if(na.vOa!==$a.vOa)return!1;switch(this.As){case 0:return Ce.Annotations.$fd(Ce.Annotations.hQm(na.vOa),na,$a);case 1:for(const Fb of na.items)for(const Xb of $a.items)if(Ce.Annotations.$fd(na.vOa,Fb,Xb))return!0;return!1;case 2:for(const Fb of na.items)for(const Xb of $a.items)if(!Ce.Annotations.$fd(na.vOa,Fb,Xb))return!1;return!0;case 3:for(const Fb of $a.items)for(const Xb of na.items)if(!Ce.Annotations.$fd(na.vOa,
Fb,Xb))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(Rh,"QueryListFilter",null,[1785]);class Ch{constructor(na,$a){this.Wb=na;this.As=$a}isMatch(na,$a){if("string"!==typeof na)throw Error.argument("objToTest","Expected string");$a=this.Wb.query.AI(null,$a);if("string"!==typeof $a)throw Error.invalidOperation("Query did not return string");this.Wb.pgj&&(na=na.toUpperCase(),$a=$a.toUpperCase());switch(this.As){case 0:return na===$a;case 1:return 0<=na.indexOf($a);case 2:return na.startsWith($a);
case 3:return na.endsWith($a);case 4:return 0<=$a.indexOf(na);case 5:return $a.startsWith(na);case 6:return $a.endsWith(na);default:throw Error.notImplemented();}}}Object(m.a)(Ch,"QueryStringFilter",null,[1785]);class ih{constructor(na,$a){na&&(this.query=$a.vca(na.ha(0)),this.pgj=1===na.ha(1))}}Object(m.a)(ih,"QueryStringFilterInit",null,[]);class Mi{constructor(na){this.Wb=na}isMatch(na,$a){if(!Object(Yc.a)(1736,na))throw Error.argument("objToTest","Expected struct value");$a=this.Wb.query.AI(null,
$a);if(!Object(Yc.a)(1736,$a))throw Error.invalidOperation("Query did not return struct value");return na.isEqual(na)}}Object(m.a)(Mi,"QueryStructFilter",null,[1785]);class Oi{constructor(na){this.Wb=na}isMatch(na,$a){na=this.Wb.query.AI(null,$a);if("boolean"!==typeof na)throw Error.invalidOperation("Query did not return bool");return na}}Object(m.a)(Oi,"QueryWhereConstraintFilter",null,[1785]);class Ti{constructor(na){this.Wb=na}isMatch(na){if("string"!==typeof na)throw Error.argument("objToTest",
"Expected string");return this.Wb.regex.test(na)}}Object(m.a)(Ti,"RegexStringFilter",null,[1785]);class xi{constructor(na,$a){na&&(this.regex=$a.iwl(na.ha(0)))}}Object(m.a)(xi,"RegexStringFilterInit",null,[]);class uj{constructor(na,$a){na&&(this.filter=$a.kjb(na.ha(0)))}}Object(m.a)(uj,"SingleFilterFilterInit",null,[]);class Ma{constructor(na,$a){na&&(this.query=$a.vca(na.ha(0)))}}Object(m.a)(Ma,"SingleQueryFilterInit",null,[]);class jc{constructor(na){this.Wb=na}isMatch(na){if("boolean"!==typeof na)throw Error.argument("objToTest",
"Expected bool value");return na===this.Wb.value}}Object(m.a)(jc,"StoredValueBooleanFilter",null,[1785]);class Lc{constructor(na){na&&(this.value=1===na.ha(0))}}Object(m.a)(Lc,"StoredValueBooleanFilterInit",null,[]);class gd{constructor(na,$a){this.Wb=na;this.As=$a}isMatch(na){if("number"!==typeof na)throw Error.argument("objToTest","Expected integer");switch(this.As){case 0:return this.Wb.Okh?this.Wb.value?!!(na&this.Wb.value):!na:na===this.Wb.value;case 1:return this.Wb.Okh?(na&this.Wb.value)===
this.Wb.value:32>na&&(1<<na&this.Wb.value)===this.Wb.value;case 2:return this.Wb.Okh?!!(na&this.Wb.value):32>na&&!!(1<<na&this.Wb.value);default:throw Error.notImplemented();}}}Object(m.a)(gd,"StoredValueEnumFilter",null,[1785]);class Md{constructor(na){na&&(this.Okh=1===na.ha(0),this.value=na.ha(1))}}Object(m.a)(Md,"StoredValueEnumFilterInit",null,[]);class Kd{constructor(){this.aun=null;this.s$h=this.TMd=0}}Object(m.a)(Kd,"WHEREConstraintData",null,[]);class ye{constructor(na){this.Wb=na}isMatch(na,
$a){if(!Object(Yc.a)(Kd,na))throw Error.argument("objToTest","Expected WHERE constraint data");let Fb=-1,Xb=-1;const nc=na.aun;switch(this.Wb.Hci){case 4:Fb=nc.Mxf;Xb=nc.jLk;break;case 5:Fb=na.TMd;Xb=nc.Mxf-na.TMd;break;case 6:Fb=nc.Mxf+nc.jLk;Xb=na.TMd+na.s$h-Fb;break;case 1:case 2:case 3:let Nc=!1;for(let yd=nc.o2n;yd;yd=yd.next)if(this.Wb.wZn===yd.name){Nc=!0;1===this.Wb.Hci?(Fb=yd.Mxf,Xb=yd.jLk):2===this.Wb.Hci?(Fb=na.TMd,Xb=yd.Mxf-na.TMd):(Fb=yd.Mxf+yd.jLk,Xb=na.TMd+na.s$h-Fb);break}if(!Nc)return!1;
break;case 7:Fb=na.TMd;Xb=na.s$h;break;default:throw Error.notImplemented();}return null!==this.Wb.PRn.G3n(nc.o6n,Fb,Xb,Fb,!0,2,$a)}}Object(m.a)(ye,"SubSreWhereConstraintFilter",null,[1785]);class Se{constructor(na,$a){if(na){var Fb=$a.i3(na.ha(0));this.Hci=Fb.charCodeAt(0);this.wZn=Fb.substr(1);this.PRn=$a.wSm(na.ha(1))}}}Object(m.a)(Se,"SubSreWhereConstraintFilterInit",null,[]);class Pe{constructor(na){this.Wb=na}isMatch(na,$a,Fb=null){if(!Object(Yc.a)(1733,na))throw Error.argument("objToTest",
"Expected feature bundle");if(null==Fb)throw Error.argumentNull("parentTextForSpan");if(this.Wb.qgl&&!this.Wb.qgl.isMatch(na,$a))return!1;if(this.Wb.WPk){let Xb;if(({value:Xb}=na.lD(this.Wb.JRn)).returnValue){if(!this.Wb.WPk.isMatch(Xb,$a))return!1}else{let nc,Nc;if(!({value:nc}=na.lD(this.Wb.Y5l)).returnValue||!({value:Nc}=na.lD(this.Wb.X5l)).returnValue||0>nc||0>Nc||nc+Nc>Fb.length||!this.Wb.WPk.isMatch(Fb.substr(nc,Nc),$a))return!1}}if(this.Wb.q6l){let Xb;if(!({value:Xb}=na.lD(this.Wb.Y5l)).returnValue||
!this.Wb.q6l.isMatch(Xb,$a))return!1}if(this.Wb.YEl){let Xb;if(!({value:Xb}=na.lD(this.Wb.X5l)).returnValue||!this.Wb.YEl.isMatch(Xb,$a))return!1}return!0}}Object(m.a)(Pe,"TextSpanFilter",null,[1785]);class Qf{constructor(na,$a){na&&(this.annotations=$a.annotations,this.Y5l=na.ha(0),this.X5l=na.ha(1),this.JRn=na.ha(2),this.WPk=na.ha(3)?$a.kjb(na.ha(3)):null,this.qgl=na.ha(4)?$a.kjb(na.ha(4)):null,this.q6l=na.ha(5)?$a.kjb(na.ha(5)):null,this.YEl=na.ha(6)?$a.kjb(na.ha(6)):null)}}Object(m.a)(Qf,"TextSpanFilterInit",
null,[]);class sg{constructor(na,$a){na&&(this.annotations=$a.annotations,this.rzb=na.ha(0),this.h0k=na.ha(1)?$a.kjb(na.ha(1)):null)}}Object(m.a)(sg,"ValueFilterAnnotationFilterInit",null,[]);var Bf=a(665);class Wf{kjb(na,$a){const Fb=na.ha(0),Xb=new Bf.a;Xb.E7c(na,1,na.count-1);switch(Fb){case 1:return new Bh(new ag(Xb,$a),0);case 2:return new Bh(new ag(Xb,$a),1);case 3:return new Bh(new ag(Xb,$a),2);case 101:return new Ti(new xi(Xb,$a));case 103:return new Ch(new ih(Xb,$a),0);case 104:return new Ch(new ih(Xb,
$a),1);case 105:return new Ch(new ih(Xb,$a),2);case 106:return new Ch(new ih(Xb,$a),3);case 107:return new Ch(new ih(Xb,$a),4);case 108:return new Ch(new ih(Xb,$a),5);case 109:return new Ch(new ih(Xb,$a),6);case 201:return new jc(new Lc(Xb));case 202:return new rh(new Ma(Xb,$a));case 301:return new zf(new Df(Xb,$a),0);case 302:return new zf(new Df(Xb,$a),1);case 303:return new zf(new Df(Xb,$a),2);case 304:return new zf(new Df(Xb,$a),3);case 305:return new zf(new Df(Xb,$a),4);case 401:return new gd(new Md(Xb),
0);case 402:return new gd(new Md(Xb),1);case 403:return new gd(new Md(Xb),2);case 404:return new gh(new Mh(Xb,$a),0);case 405:return new gh(new Mh(Xb,$a),1);case 406:return new gh(new Mh(Xb,$a),2);case 407:return new gh(new Mh(Xb,$a),3);case 501:return new Qh(new hi(Xb,$a));case 502:return new Mi(new Ma(Xb,$a));case 601:return new uh(new uj(Xb,$a),0);case 602:return new uh(new uj(Xb,$a),1);case 603:return new Eh(new uj(Xb,$a));case 604:return new Rh(new Ma(Xb,$a),0);case 605:return new Rh(new Ma(Xb,
$a),1);case 606:return new Rh(new Ma(Xb,$a),2);case 607:return new Rh(new Ma(Xb,$a),3);case 701:return new Vg(!1);case 702:return new Vg(!0);case 703:return new hf(new sg(Xb,$a),!1);case 704:return new hf(new sg(Xb,$a),!0);case 705:return new Eg(new sg(Xb,$a),!1);case 706:return new Eg(new sg(Xb,$a),!0);case 707:return new Kg(new ug(Xb,$a));case 901:return new Pe(new Qf(Xb,$a));case 1002:return new Oi(new Ma(Xb,$a));case 1001:return new ye(new Se(Xb,$a));default:throw Error.argument("initData");}}}
Object(m.a)(Wf,"FilterFactory",null,[1732]);var Xf=a(390);class Xa{constructor(na){this.Wb=na}get N0(){return this.Wb.N0}get QPa(){return this.Wb.QPa}get nyh(){return this.Wb.nyh}get okh(){return this.Wb.okh}load(na,$a){return this.AI(na,na?new $f("root",na,$a):$a)}store(na,$a,Fb){this.LNe(na,$a,na?new $f("root",na,Fb):Fb,null)}AI(na,$a){if(!this.okh&&!this.Wb.annotations.TEe(this.N0,na))throw Error.argument("input","Input value not of expected type");let Fb=this.Wb.osl;for(;Fb;)na=Fb.load(na,$a),
Fb=Fb.next;return na}LNe(na,$a,Fb,Xb){if(!this.nyh)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.okh&&!this.Wb.annotations.TEe(this.N0,na))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Wb.annotations.TEe(this.QPa,$a))throw Error.argument("rvalue","Rvalue not of expected type");return this.Wb.osl.store(na,$a,Fb,Xb)}static ukl(na,$a,Fb,Xb){if(Fb===Xb)return $a;if(Ce.Annotations.M8(Fb)&&Ce.Annotations.M8(Xb)){Fb=Ce.Annotations.twc(Fb);
Xb=Ce.Annotations.twc(Xb);const nc=new Xf.a(na,Xb);for(const Nc of $a.items)Array.add(nc.items,Xa.ukl(na,Nc,Fb,Xb));return nc}if(Fb===Ce.Annotations.G8b){if(Xb===Ce.Annotations.Lxb)return $a;if(Xb===Ce.Annotations.OUa)return $a.toString()}else if(Fb===Ce.Annotations.Lxb){if(Xb===Ce.Annotations.G8b)return Math.floor($a);if(Xb===Ce.Annotations.OUa)return $a.toString()}else if(Fb===Ce.Annotations.OUa){if(Xb===Ce.Annotations.G8b)return parseInt($a);if(Xb===Ce.Annotations.Lxb)return parseFloat($a)}throw Error.invalidOperation("Type conversion failure in query step");
}}Object(m.a)(Xa,"AnnotationQuery",null,[1796]);class T{constructor(){this.QPa=this.N0=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}ywc(na){if(this.next)return{returnValue:this.next,t7b:na};if(na){const $a=na.wll;na=na.FVl;return{returnValue:$a,t7b:na}}return{returnValue:null,t7b:na}}}Object(m.a)(T,"AnnotationQueryStep",null,[1814]);class Ba extends T{constructor(na){super();this.Wb=na}load(na,$a){$a=this.Wb.query.AI(na,$a);if(Ce.Annotations.M8(this.N0)){var Fb=Ce.Annotations.twc(this.N0);
let nc=new Xf.a(this.Wb.annotations,Fb);if(Ce.Annotations.M8(this.Wb.query.QPa)){if(na.items.length!==$a.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let Nc=0,yd=na.items.length;Nc<yd;++Nc)Array.add(nc.items,this.Jch(na.items[Nc],$a.items[Nc],Fb===Ce.Annotations.Lxb))}else for(var Xb of na.items)Array.add(nc.items,this.Jch(Xb,$a,Fb===Ce.Annotations.Lxb));return nc}if(Ce.Annotations.M8(this.Wb.query.QPa)){Xb=new Xf.a(this.Wb.annotations,this.N0);
for(Fb of $a.items)Array.add(Xb.items,this.Jch(na,Fb,this.N0===Ce.Annotations.Lxb));return Xb}return this.Jch(na,$a,this.N0===Ce.Annotations.Lxb)}Jch(na,$a,Fb){na=this.Sze(na,$a);return Fb?na:Math.floor(na)}}Object(m.a)(Ba,"NumericAnnotationQueryStep",T,[]);class kb extends Ba{constructor(na){super(na)}Sze(na,$a){return na+$a}}Object(m.a)(kb,"AddAnnotationQueryStep",Ba,[]);class Ab extends T{constructor(na){super();this.Wb=na}load(na,$a){if(this.N0===Ce.Annotations.JDb&&this.Wb.query.QPa===Ce.Annotations.JDb){let nc;
if(({result:nc}=this.gjl(na)).returnValue)return nc}if(Ce.Annotations.M8(this.N0)){var Fb=new Xf.a(this.Wb.annotations,Ce.Annotations.JDb);$a=this.Wb.query.AI(na,$a);if(Ce.Annotations.M8(this.Wb.query.QPa)){if(na.items.length!==$a.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let nc=0,Nc=na.items.length;nc<Nc;++nc)Array.add(Fb.items,this.Fkf($a.items[nc],na.items[nc]))}else for(var Xb of na.items)Array.add(Fb.items,this.Fkf($a,Xb));return Fb}Xb=
this.Wb.query.AI(na,$a);if(Ce.Annotations.M8(this.Wb.query.QPa)){$a=new Xf.a(this.Wb.annotations,Ce.Annotations.JDb);for(Fb of Xb.items)Array.add($a.items,this.Fkf(Fb,na));return $a}return this.Fkf(Xb,na)}}Object(m.a)(Ab,"BinaryBooleanAnnotationQueryStep",T,[]);class ic extends Ab{constructor(na){super(na)}gjl(na){return{returnValue:!na,result:!1}}Fkf(na,$a){return na&&$a}}Object(m.a)(ic,"AndAnnotationQueryStep",Ab,[]);class zc{constructor(na){na&&(this.annotations=na)}}Object(m.a)(zc,"AnnotationsOnlyQueryStepInit",
null,[]);class Fc extends T{constructor(na){super();this.Wb=na}load(na,$a){$a=this.Wb.query.AI(na,$a);na=na.clone();Ce.Annotations.M8(this.Wb.query.QPa)?Array.addRange(na.items,$a.items):Array.add(na.items,$a);return na}}Object(m.a)(Fc,"AppendAnnotationQueryStep",T,[]);class lc extends T{constructor(na){super();this.Wb=na}load(na,$a){if(this.N0===Ce.Annotations.Xta)return this.ovf(na,$a);const Fb=new Xf.a(this.Wb.annotations,Ce.Annotations.Xta);for(const Xb of na.items)Array.add(Fb.items,this.ovf(Xb,
$a));return Fb}ovf(na,$a){const Fb=new vf.a(this.Wb.annotations);Fb.wqc(na);na=new vf.a(this.Wb.annotations);this.Wb.script.Gwa(null,new $f("Input",Fb,new $f("Output",na,$a)));return na}}Object(m.a)(lc,"ApplyAnnotationQueryStep",T,[]);class nd extends T{constructor(na){super();this.Wb=na}load(na,$a){if(this.N0===Ce.Annotations.Xta)return $a=this.ovf(na,$a),$a.lD(this.Wb.pgl).returnValue||new Xf.a(this.Wb.annotations,Ce.Annotations.Xta),$a;const Fb=new Xf.a(this.Wb.annotations,Ce.Annotations.Xta);
for(const Xb of na.items)if(na=this.ovf(Xb,$a),({value:na}=na.lD(this.Wb.pgl)).returnValue)for(const nc of na.items)Array.add(Fb.items,nc);return Fb}ovf(na,$a){const Fb=new vf.a(this.Wb.annotations);Fb.wqc(na);na=new vf.a(this.Wb.annotations);this.Wb.script.Gwa(null,new $f("Input",Fb,new $f("Output",na,$a)));return na}}Object(m.a)(nd,"ApplyExpandAnnotationQueryStep",T,[]);class vd{constructor(na,$a){na&&(this.annotations=$a.annotations,this.script=$a.kGd(na.ha(0)),this.pgl=na.ha(1))}}Object(m.a)(vd,
"ApplyExpandQueryStepInit",null,[]);class od{constructor(na,$a){na&&(this.annotations=$a.annotations,this.script=$a.kGd(na.ha(0)))}}Object(m.a)(od,"ApplyQueryStepInit",null,[]);class Bd extends T{constructor(na){super();this.Wb=na}load(na){if(this.N0===Ce.Annotations.Xta)return this.Slh(na);const $a=new Xf.a(this.Wb.annotations,this.Wb.annotations.getAttributeType(this.Wb.rzb));for(const Fb of na.items)Array.add($a.items,this.Slh(Fb));return $a}store(na,$a,Fb,Xb){if(this.N0===Ce.Annotations.Xta){var nc=
$a,Nc=({t7b:Xb}=this.ywc(Xb)).returnValue;Nc&&(nc=Nc.store(Ce.Annotations.nsa(this.Slh(na)),$a,Fb,Xb));na.BS(this.Wb.rzb,nc)}else{var yd=$a;if(nc=({t7b:Xb}=this.ywc(Xb)).returnValue){yd=new Xf.a(this.Wb.annotations,this.Wb.annotations.getAttributeType(this.Wb.rzb));for(Nc of na.items)Array.add(yd.items,this.Slh(Nc));yd=nc.store(yd,$a,Fb,Xb)}$a=yd;if($a.items.length!==na.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let Ud=0,ie=na.items.length;Ud<
ie;++Ud)Fb=na.items[Ud],Fb.isReadOnly&&(Fb=Fb.clone(),na.items[Ud]=Fb),Fb.BS(this.Wb.rzb,$a.items[Ud])}return na}Slh(na){({value:na}=na.lD(this.Wb.rzb)).returnValue||(na=this.Wb.annotations.hMm(this.Wb.rzb));return na}}Object(m.a)(Bd,"AttrAnnotationQueryStep",T,[]);class Wd{constructor(na,$a){na&&(this.annotations=$a,this.rzb=na.ha(0))}}Object(m.a)(Wd,"AttrQueryStepInit",null,[]);class ce extends T{constructor(na){super();this.Wb=na}load(na){const $a=new vf.a(this.Wb.annotations);$a.wqc(na);return this.Wb.module.execute($a)}}
Object(m.a)(ce,"CallModuleAnnotationQueryStep",T,[]);class db{constructor(na,$a){na&&(this.annotations=$a.annotations,this.module=$a.YQi(na.ha(0)))}}Object(m.a)(db,"CallModuleQueryStepInit",null,[]);class gc extends T{constructor(na){super();this.Wb=na}load(na,$a){if(Ce.Annotations.M8(this.N0)){var Fb=this.Wb.query.AI(na,$a);$a=new Xf.a(this.Wb.annotations,Ce.Annotations.OUa);let Nc="string"===typeof Fb;for(var Xb of na.items)if(Nc)Array.add($a.items,Xb+Fb);else for(var nc of Fb.items)Array.add($a.items,
Xb+nc);return $a}Xb=this.Wb.query.AI(na,$a);if("string"===typeof Xb)return na+Xb;nc=new Xf.a(this.Wb.annotations,Ce.Annotations.OUa);for(Fb of Xb.items)Array.add(nc.items,na+Fb);return nc}}Object(m.a)(gc,"ConcatAnnotationQueryStep",T,[]);class Dc extends T{constructor(na){super();this.Wb=na}load(na){return Xa.ukl(this.Wb.annotations,na,this.N0,this.QPa)}}Object(m.a)(Dc,"ConvertAnnotationQueryStep",T,[]);class Ua extends T{constructor(){super()}load(na){return na.items.length}}Object(m.a)(Ua,"CountAnnotationQueryStep",
T,[]);class Nb extends Ba{constructor(na){super(na)}Sze(na,$a){return na/$a}}Object(m.a)(Nb,"DivideAnnotationQueryStep",Ba,[]);class hc extends T{constructor(na){super();this.Wb=na}load(na,$a){$a=new $f(this.Wb.Zzh,null,$a);for(const Fb of na.items)if($a.idi(Fb),this.Wb.query.AI(Fb,$a))return!0;return!1}}Object(m.a)(hc,"ExistsAnnotationQueryStep",T,[]);class Qc extends Ba{constructor(na){super(na)}Sze(na,$a){return Math.pow(na,$a)}}Object(m.a)(Qc,"ExpAnnotationQueryStep",Ba,[]);class $c{constructor(na,
$a){na&&(this.tac=$a.i3(na.ha(0)))}}Object(m.a)($c,"FeatureBundleNameQueryStepInit",null,[]);class Hd extends T{constructor(na){super();this.Wb=na}load(na){if(Ce.Annotations.M8(this.N0)){const $a=new Xf.a(this.Wb.annotations,this.Wb.annotations.wKd(Ce.Annotations.twc(this.N0),this.Wb.vac));for(const Fb of na.items)Array.add($a.items,Fb.e8c(this.Wb.vac));return $a}return na.e8c(this.Wb.vac)}store(na,$a,Fb,Xb){if(Ce.Annotations.M8(this.N0)){var nc=$a,Nc=({t7b:Xb}=this.ywc(Xb)).returnValue;if(Nc){nc=
new Xf.a(this.Wb.annotations,this.Wb.annotations.wKd(Ce.Annotations.twc(this.N0),this.Wb.vac));for(var yd of na.items)Array.add(nc.items,yd.e8c(this.Wb.vac));nc=Nc.store(nc,$a,Fb,Xb)}$a=nc;if($a.items.length!==na.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let Ud=0,ie=na.items.length;Ud<ie;++Ud)Fb=na.items[Ud],Fb.isReadOnly&&(Fb=Fb.clone(),na.items[Ud]=Fb),Fb.Uzk(this.Wb.vac,$a.items[Ud])}else Nc=$a,(yd=({t7b:Xb}=this.ywc(Xb)).returnValue)&&
(Nc=yd.store(Ce.Annotations.nsa(na.e8c(this.Wb.vac)),$a,Fb,Xb)),na.Uzk(this.Wb.vac,Nc);return na}}Object(m.a)(Hd,"FieldAnnotationQueryStep",T,[]);class $d{constructor(na,$a){na&&(this.annotations=$a,this.vac=na.ha(0))}}Object(m.a)($d,"FieldQueryStepInit",null,[]);class ue extends T{constructor(na){super();this.Wb=na}load(na,$a){for(const Fb of na.items)if(this.Wb.filter.isMatch(Fb,$a))return Fb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(na,$a,Fb,Xb){let nc=
$a,Nc=-1;for(let Ud=0,ie=na.items.length;Ud<ie;Ud++)if(this.Wb.filter.isMatch(na.items[Ud],Fb)){Nc=Ud;break}if(0>Nc)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const yd=({t7b:Xb}=this.ywc(Xb)).returnValue;yd&&(nc=yd.store(Ce.Annotations.nsa(na.items[Nc]),$a,Fb,Xb));na.items[Nc]=nc;return na}}Object(m.a)(ue,"FirstItemMatchingAnnotationQueryStep",T,[]);class Fe extends T{constructor(na){super();this.Wb=na}load(na,$a){$a=new $f(this.Wb.Zzh,null,$a);for(const Fb of na.items)if($a.idi(Fb),
!this.Wb.query.AI(Fb,$a))return!1;return!0}}Object(m.a)(Fe,"ForAllAnnotationQueryStep",T,[]);class cf extends T{constructor(na){super();this.Wb=na}load(na,$a){na=$a?$a.mhh(this.Wb.tac):null;if(!na)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Wb.tac+'"');return na}store(na,$a,Fb,Xb){na=Fb?Fb.mhh(this.Wb.tac):null;if(!na)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Wb.tac+'"');let nc=$a;const Nc=({t7b:Xb}=this.ywc(Xb)).returnValue;Nc&&(nc=Nc.store(na,
$a,Fb,Xb));na!==nc&&na.wqc(nc);return na}}Object(m.a)(cf,"GetAnnotationQueryStep",T,[]);class Ee{constructor(na,$a){this.Dgm=na;this.Tkm=$a}get wll(){return this.Dgm}get FVl(){return this.Tkm}}Object(m.a)(Ee,"AnnotationQueryStoreContinuation",null,[1816]);class xe extends T{constructor(na){super();this.Wb=na}load(na,$a){return this.Wb.yyh.AI(na,$a)?this.Wb.n8l.AI(na,$a):this.Wb.Nfh?this.Wb.Nfh.AI(na,$a):na}store(na,$a,Fb,Xb){var nc=this.Wb.yyh.AI(na,Fb);this.next&&(Xb=new Ee(this.next,Xb));if(nc)return this.Wb.n8l.LNe(na,
$a,Fb,Xb);if(this.Wb.Nfh)return this.Wb.Nfh.LNe(na,$a,Fb,Xb);nc=$a;let Nc=null;Xb&&(Nc=Xb.wll,Xb=Xb.FVl);Nc&&(nc=Nc.store(Ce.Annotations.nsa(na),$a,Fb,Xb));return nc}}Object(m.a)(xe,"IfAnnotationQueryStep",T,[]);class cg{constructor(na,$a){na&&(this.yyh=$a.vca(na.ha(0)),this.n8l=$a.vca(na.ha(1)),this.Nfh=na.ha(2)?$a.vca(na.ha(2)):null)}}Object(m.a)(cg,"IfQueryStepInit",null,[]);class Gg{constructor(na,$a){na&&(this.U0m=$a.vca(na.ha(0)),this.sEl=$a.vca(na.ha(1)))}}Object(m.a)(Gg,"IndexAndItemQueryStepInit",
null,[]);class Of extends T{constructor(na){super();this.Wb=na}load(na,$a){const Fb=this.Wb.U0m.AI(na,$a);$a=this.Wb.sEl.AI(na,$a);na=na.clone();if(0>Fb||Fb>na.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(Ce.Annotations.M8(this.Wb.sEl.QPa))for(let Xb=0;Xb<$a.items.length;++Xb)Array.insert(na.items,Fb+Xb,$a.items[Xb]);else Array.insert(na.items,Fb,$a);return na}}Object(m.a)(Of,"InsertAtAnnotationQueryStep",T,[]);class ch extends T{constructor(na){super();
this.Wb=na}load(na,$a){return!(!$a||!$a.mhh(this.Wb.tac))}}Object(m.a)(ch,"IsDefinedAnnotationQueryStep",T,[]);class vg extends T{constructor(na){super();this.Wb=na}load(na,$a){$a=this.dId(na,$a);return na.items[$a]}store(na,$a,Fb,Xb){const nc=this.dId(na,Fb);let Nc=$a;const yd=({t7b:Xb}=this.ywc(Xb)).returnValue;yd&&(Nc=yd.store(Ce.Annotations.nsa(na.items[nc]),$a,Fb,Xb));na.items[nc]=Nc;return na}dId(na,$a){$a=this.Wb.query.AI(na,$a);if(0>$a||$a>=na.items.length)throw Error.invalidOperation("Index out of range in Item store step");
return $a}}Object(m.a)(vg,"ItemAnnotationQueryStep",T,[]);class jg extends T{constructor(na){super();this.Wb=na}load(na,$a){const Fb=new Xf.a(this.Wb.annotations,Ce.Annotations.twc(this.N0));for(const Xb of na.items)this.Wb.filter.isMatch(Xb,$a)&&Array.add(Fb.items,Xb);return Fb}}Object(m.a)(jg,"ItemsMatchingAnnotationQueryStep",T,[]);class sh extends T{constructor(na){super();this.Wb=na}load(na,$a){$a=this.dId(na,$a);return na.items[na.items.length-$a-1]}store(na,$a,Fb,Xb){const nc=this.dId(na,Fb);
let Nc=$a;const yd=({t7b:Xb}=this.ywc(Xb)).returnValue;yd&&(Nc=yd.store(Ce.Annotations.nsa(na.items[na.items.length-nc-1]),$a,Fb,Xb));na.items[na.items.length-nc-1]=Nc;return na}dId(na,$a){$a=this.Wb.query?this.Wb.query.AI(na,$a):0;if(0>$a||$a>=na.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return $a}}Object(m.a)(sh,"LastItemAnnotationQueryStep",T,[]);class Zh extends T{constructor(na){super();this.Wb=na}load(na){if(Ce.Annotations.M8(this.N0)){const $a=new Xf.a(this.Wb.annotations,
Ce.Annotations.G8b);for(const Fb of na.items)Array.add($a.items,Fb.length);return $a}return na.length}}Object(m.a)(Zh,"LengthAnnotationQueryStep",T,[]);class ae extends T{constructor(na){super();this.Wb=na}load(na,$a){if(Ce.Annotations.M8(this.N0)){const Fb=new Xf.a(this.Wb.annotations,Ce.Annotations.JDb);for(const Xb of na.items)Array.add(Fb.items,this.Wb.filter.isMatch(Xb,$a));return Fb}return this.Wb.filter.isMatch(na,$a)}}Object(m.a)(ae,"MatchesAnnotationQueryStep",T,[]);class Wi extends T{constructor(na){super();
this.Wb=na}load(na,$a){return this.Wb.filter.isMatch(na,$a)}}Object(m.a)(Wi,"MatchesAsListAnnotationQueryStep",T,[]);class ci extends Ba{constructor(na){super(na)}Sze(na,$a){return na%$a}}Object(m.a)(ci,"ModuloAnnotationQueryStep",Ba,[]);class Fi extends Ba{constructor(na){super(na)}Sze(na,$a){return na*$a}}Object(m.a)(Fi,"MultiplyAnnotationQueryStep",Ba,[]);class hh extends T{constructor(na){super();this.Wb=na}load(na){if(Ce.Annotations.M8(this.N0)){const $a=new Xf.a(this.Wb.annotations,Ce.Annotations.JDb);
for(const Fb of na.items)Array.add($a.items,!Fb);return $a}return!na}}Object(m.a)(hh,"NotAnnotationQueryStep",T,[]);class wf extends Ab{constructor(na){super(na)}gjl(na){return{returnValue:na,result:!0}}Fkf(na,$a){return na||$a}}Object(m.a)(wf,"OrAnnotationQueryStep",Ab,[]);class qg extends T{constructor(na){super();this.Wb=na}load(na,$a){const Fb=this.Wb.iMk.AI(na,$a);na=this.Wb.$lf.AI(na,$a);$a=new Xf.a(this.Wb.annotations,Ce.Annotations.G8b);for(let Xb=0;Xb<na;++Xb)Array.add($a.items,Fb+Xb);return $a}}
Object(m.a)(qg,"RangeAnnotationQueryStep",T,[]);class Lh{constructor(na,$a){na&&(this.annotations=$a.annotations,this.filter=$a.kjb(na.ha(0)))}}Object(m.a)(Lh,"SingleFilterQueryStepInit",null,[]);class dh{constructor(na,$a){na&&(this.annotations=$a.annotations,this.query=na.ha(0)?$a.vca(na.ha(0)):null)}}Object(m.a)(dh,"SingleOptionalQueryQueryStepInit",null,[]);class wg{constructor(na,$a){na&&(this.annotations=$a.annotations,this.query=$a.vca(na.ha(0)))}}Object(m.a)(wg,"SingleQueryQueryStepInit",
null,[]);class bg{constructor(na,$a){na&&(this.annotations=$a.annotations,this.iMk=$a.vca(na.ha(0)),this.$lf=na.ha(1)?$a.vca(na.ha(1)):null)}}Object(m.a)(bg,"StartAndCountOrLengthQueryStepInit",null,[]);class vh extends T{constructor(na){super();this.Wb=na}load(na,$a){let Fb;({Gec:$a,length:Fb}=this.mih(na,$a));const Xb=new Xf.a(this.Wb.annotations,na.vOa);for(let nc=0;nc<Fb;++nc)Array.add(Xb.items,na.items[$a+nc]);return Xb}store(na,$a,Fb,Xb){let nc,Nc;({Gec:nc,length:Nc}=this.mih(na,Fb));var yd=
$a;const Ud=({t7b:Xb}=this.ywc(Xb)).returnValue;if(Ud){yd=new Xf.a(this.Wb.annotations,na.vOa);for(let ie=0;ie<Nc;++ie)Array.add(yd.items,na.items[nc+ie]);yd=Ud.store(yd,$a,Fb,Xb)}$a=yd;for(Fb=0;Fb<Nc;++Fb)Array.removeAt(na.items,nc);for(let ie=0,Be=$a.items.length;ie<Be;++ie)Array.insert(na.items,nc+ie,$a.items[ie]);return na}mih(na,$a){let Fb;Fb=this.Wb.iMk.AI(na,$a);if(0>Fb)throw Error.invalidOperation("Invalid start index in Sublist() query step");$a=this.Wb.$lf?this.Wb.$lf.AI(na,$a):na.items.length-
Fb;if(0>$a||Fb+$a>na.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{Gec:Fb,length:$a}}}Object(m.a)(vh,"SublistAnnotationQueryStep",T,[]);class fi extends T{constructor(na){super();this.Wb=na}load(na,$a){if(Ce.Annotations.M8(this.N0)){const Fb=new Xf.a(this.Wb.annotations,Ce.Annotations.OUa);for(let Xb=0,nc=na.items.length;Xb<nc;++Xb)Array.add(Fb.items,this.getSubstring(na.items[Xb],$a));return Fb}return this.getSubstring(na,$a)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");
}getSubstring(na,$a){let Fb;({Gec:$a,length:Fb}=this.mih(na,$a));return na.substr($a,Fb)}mih(na,$a){let Fb;Fb=this.Wb.iMk.AI(na,$a);if(0>Fb)throw Error.invalidOperation("Invalid start index in Substring() query step");$a=this.Wb.$lf?this.Wb.$lf.AI(na,$a):na.length-Fb;if(0>$a||Fb+$a>na.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{Gec:Fb,length:$a}}}Object(m.a)(fi,"SubstringAnnotationQueryStep",T,[]);class Jg extends Ba{constructor(na){super(na)}Sze(na,
$a){return na-$a}}Object(m.a)(Jg,"SubtractAnnotationQueryStep",Ba,[]);class Dg extends T{constructor(na){super();this.Wb=na}load(na){const $a=new Xf.a(this.Wb.annotations,Ce.Annotations.OUa);for(let Fb=0;Fb<na.length;++Fb)Array.add($a.items,na.charAt(Fb).toString());return $a}}Object(m.a)(Dg,"ToCharListAnnotationQueryStep",T,[]);class fj extends T{constructor(na){super();this.Wb=na}load(na){const $a=new Xf.a(this.Wb.annotations,this.N0);Array.add($a.items,na);return $a}}Object(m.a)(fj,"ToListAnnotationQueryStep",
T,[]);class kj extends T{constructor(na){super();this.Wb=na}load(){return this.Wb.value}}Object(m.a)(kj,"ValueAnnotationQueryStep",T,[]);class ng{constructor(na,$a){if(na){var Fb=na.ha(0),Xb=1;this.value=({H$a:Xb}=$a.Phb(Fb,na,Xb,null,null,null)).returnValue;Ce.Annotations.fWd(this.value)}}}Object(m.a)(ng,"ValueQueryStepInit",null,[]);class Oh{constructor(na,$a){na&&(this.Zzh=$a.i3(na.ha(0)),this.query=$a.vca(na.ha(1)))}}Object(m.a)(Oh,"VarNameAndQueryQueryStepInit",null,[]);class Tf{constructor(na,
$a){this.T6k=null;if(na){this.annotations=$a.annotations;var Fb=0;this.N0=na.ha(Fb);++Fb;this.QPa=na.ha(Fb);++Fb;this.nyh=1===na.ha(Fb);++Fb;this.okh=1===na.ha(Fb);++Fb;var Xb=na.ha(Fb);++Fb;if(Xb){var nc=Fb,Nc=Fb+Xb,yd=Fb+2*Xb;Fb+=3*Xb;var Ud=na.count-Fb,ie=null;for(let oe=0;oe<Xb;++oe){var Be=Fb+na.ha(yd+oe);const rf=(oe===Xb-1?Ud:na.ha(yd+oe+1))-na.ha(yd+oe),Vf=new Bf.a;Vf.E7c(na,Be,rf);Be=Tf.PQm(na.ha(Nc+oe),Vf,$a);Be.N0=na.ha(nc+oe);Be.QPa=oe===Xb-1?this.QPa:na.ha(nc+oe+1);ie?ie.next=Be:this.T6k=
Be;ie=Be}}}}get osl(){return this.T6k}static PQm(na,$a,Fb){switch(na){case 1:return new cf(new $c($a,Fb));case 2:return new ch(new $c($a,Fb));case 3:return new Bd(new Wd($a,Fb.annotations));case 4:return new Hd(new $d($a,Fb.annotations));case 5:return new xe(new cg($a,Fb));case 6:return new ae(new Lh($a,Fb));case 43:return new Wi(new Lh($a,Fb));case 45:return new lc(new od($a,Fb));case 49:return new nd(new vd($a,Fb));case 46:return new kj(new ng($a,Fb.annotations));case 51:return new ce(new db($a,
Fb));case 52:return new qg(new bg($a,Fb));case 53:return new Dc(new zc(Fb.annotations));case 13:return new vg(new wg($a,Fb));case 14:return new sh(new dh($a,Fb));case 15:return new Ua;case 18:return new ue(new Lh($a,Fb));case 16:return new Fe(new Oh($a,Fb));case 17:return new hc(new Oh($a,Fb));case 22:return new Of(new Gg($a,Fb));case 24:return new Fc(new wg($a,Fb));case 26:return new vh(new bg($a,Fb));case 27:return new jg(new Lh($a,Fb));case 30:return new fj(new zc(Fb.annotations));case 31:return new fi(new bg($a,
Fb));case 32:return new gc(new wg($a,Fb));case 47:return new Zh(new zc(Fb.annotations));case 48:return new Dg(new zc(Fb.annotations));case 34:return new kb(new wg($a,Fb));case 35:return new Jg(new wg($a,Fb));case 36:return new Fi(new wg($a,Fb));case 37:return new Nb(new wg($a,Fb));case 38:return new ci(new wg($a,Fb));case 39:return new Qc(new wg($a,Fb));case 40:return new ic(new wg($a,Fb));case 41:return new wf(new wg($a,Fb));case 42:return new hh(new zc(Fb.annotations));default:throw Error.argument("currStepInitData");
}}}Object(m.a)(Tf,"AnnotationQueryInit",null,[]);class Kh{constructor(na){this.Wb=na}execute(na,$a){this.Gwa(na,na?new $f("root",na,$a):$a)}Gwa(na,$a){for(const Fb of this.Wb.commands)$a=Fb.execute(na,$a)}}Object(m.a)(Kh,"AnnotationScript",null,[1795]);class wi{constructor(na){this.Wb=na}execute(na,$a){const Fb=this.Wb.B2m.AI(na,$a),Xb=this.Wb.Ptn.AI(na,$a);this.Wb.script.Gwa(na,new $f("Input",Fb,new $f("Output",Xb,$a)));return $a}}Object(m.a)(wi,"ApplyAnnotationScriptCommand",null,[1810]);class Uf{constructor(na,
$a){na&&(this.B2m=$a.vca(na.ha(0)),this.Ptn=$a.vca(na.ha(1)),this.script=$a.kGd(na.ha(2)))}}Object(m.a)(Uf,"ApplyScriptCommandInit",null,[]);class Ci{constructor(na){this.Wb=na}execute(na,$a){const Fb=this.Wb.kuk.AI(na,$a);this.Wb.hmh.LNe(na,Fb,$a,null);return $a}}Object(m.a)(Ci,"AssignAnnotationScriptCommand",null,[1810]);class Ai{constructor(na){this.Wb=na}execute(na,$a){const Fb=this.Wb.hmh.AI(na,$a);na=this.Wb.kuk.AI(na,$a);Fb!==na&&Fb.wqc(na);return $a}}Object(m.a)(Ai,"CopyAnnotationScriptCommand",
null,[1810]);class Ii{constructor(na){this.Wb=na}execute(na,$a){let Fb=this.Wb.Xtj.AI(na,$a);if(this.Wb.Xtj.nyh){Fb=Ce.Annotations.nsa(Fb);var Xb=new $f(this.Wb.tac,null,$a);for(let Nc=0,yd=Fb.items.length;Nc<yd;++Nc){var nc=this.Cql(na,Fb.items[Nc],Xb);if(0>this.Wb.Zuh)Fb.items[Nc]=nc;else if(({value:nc}=nc.lD(this.Wb.Zuh)).returnValue)Fb.items[Nc]=nc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Wb.Xtj.LNe(na,Fb,$a,null)}else{Xb=new $f(this.Wb.tac,
null,$a);for(let Nc=0,yd=Fb.items.length;Nc<yd;++Nc)this.Cql(na,Fb.items[Nc],Xb)}return $a}Cql(na,$a,Fb){let Xb;0>this.Wb.Zuh?Xb=Ce.Annotations.nsa($a):(Xb=new vf.a(this.Wb.annotations),Xb.BS(this.Wb.Zuh,$a));Fb.idi(Xb);this.Wb.Utm.Gwa(na,Fb);return Xb}}Object(m.a)(Ii,"EnumerateAnnotationScriptCommand",null,[1810]);class gj{constructor(na,$a){na&&(this.annotations=$a.annotations,this.tac=$a.i3(na.ha(0)),this.Xtj=$a.vca(na.ha(1)),this.Utm=$a.kGd(na.ha(2)),this.Zuh=na.ha(3))}}Object(m.a)(gj,"EnumerateScriptCommandInit",
null,[]);class Ag{constructor(na){this.Wb=na}execute(na,$a){this.Wb.yyh.AI(na,$a)?this.Wb.JVn.Gwa(na,$a):this.Wb.trl&&this.Wb.trl.Gwa(na,$a);return $a}}Object(m.a)(Ag,"IfAnnotationScriptCommand",null,[1810]);class Og{constructor(na,$a){na&&(this.yyh=$a.vca(na.ha(0)),this.JVn=$a.kGd(na.ha(1)),this.trl=na.ha(2)?$a.kGd(na.ha(2)):null)}}Object(m.a)(Og,"IfScriptCommandInit",null,[]);class aj{constructor(na,$a){na&&(this.annotations=$a.annotations,this.hmh=$a.vca(na.ha(0)),this.kuk=$a.vca(na.ha(1)))}}Object(m.a)(aj,
"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Qj{constructor(na){this.Wb=na}execute(na,$a){const Fb=this.Wb.kuk.AI(this.Wb.hmh.AI(na,$a),$a);this.Wb.hmh.LNe(na,Fb,$a,null);return $a}}Object(m.a)(Qj,"ModifyAnnotationScriptCommand",null,[1810]);class sj{constructor(na){this.Wb=na}execute(na,$a){const Fb=new vf.a(this.Wb.annotations);this.Wb.query&&Fb.wqc(this.Wb.query.AI(na,$a));return $a=new $f(this.Wb.tac,Fb,$a)}}Object(m.a)(sj,"NewAnnotationScriptCommand",null,[1810]);class mi{constructor(na,
$a){na&&(this.annotations=$a.annotations,this.tac=$a.i3(na.ha(0)),this.query=na.ha(1)?$a.vca(na.ha(1)):null)}}Object(m.a)(mi,"NewScriptCommandInit",null,[]);class Wj{constructor(na){this.Wb=na}execute(na,$a){na=this.Wb.query.AI(na,$a);if(this.Wb.query.QPa===Ce.Annotations.Xta)na.fuh(this.Wb.rzb);else for(const Fb of na.items)Fb.fuh(this.Wb.rzb);return $a}}Object(m.a)(Wj,"RemoveAnnotationScriptCommand",null,[1810]);class Ff{constructor(na,$a){na&&(this.annotations=$a.annotations,this.query=$a.vca(na.ha(0)),
this.rzb=na.ha(1))}}Object(m.a)(Ff,"RemoveScriptCommandInit",null,[]);class oi{constructor(na,$a){if(na){var Fb=0,Xb=na.ha(Fb);++Fb;if(Xb){var nc=Fb,Nc=Fb+Xb;Fb+=2*Xb;var yd=na.count-Fb;this.commands=Array(Xb);for(let Ud=0;Ud<Xb;++Ud){const ie=Fb+na.ha(Nc+Ud),Be=(Ud===Xb-1?yd:na.ha(Nc+Ud+1))-na.ha(Nc+Ud),oe=new Bf.a;oe.E7c(na,ie,Be);this.commands[Ud]=oi.MQm(na.ha(nc+Ud),oe,$a)}}}}static MQm(na,$a,Fb){switch(na){case 1:return new Ci(new aj($a,Fb));case 2:return new Qj(new aj($a,Fb));case 3:return new Wj(new Ff($a,
Fb));case 6:return new sj(new mi($a,Fb));case 7:return new Ii(new gj($a,Fb));case 8:return new Ag(new Og($a,Fb));case 9:return new Ai(new aj($a,Fb));case 10:return new wi(new Uf($a,Fb));default:throw Error.argument("initData");}}}Object(m.a)(oi,"AnnotationScriptInit",null,[]);var Fj=a(1439);class bj{constructor(na){this.V8=na;this.jP=0}rUa(){const na=this.V8.xS(this.jP,4);this.jP+=4;return na}get Xcf(){return this.V8}get offset(){return this.jP}set offset(na){this.jP=na}}Object(m.a)(bj,"ByteArrayReader",
null,[]);class Hg{constructor(){this.gaa=null;this.cJl=this.C3=0}ha(na){if(0>na||na>=this.C3)throw Error.argumentOutOfRange("index");return this.gaa.xS(this.cJl+4*na,4)}get count(){return this.C3}static ZAm(na,$a,Fb){const Xb=new Hg;Xb.gaa=na;Xb.cJl=$a;Xb.C3=Fb;return Xb}}Object(m.a)(Hg,"ReadOnlyListOverByteArray",null,[1779]);class rg{constructor(na,$a){this.vIl=this.mIl=!1;this.nO=this.wcc=this.bBj=this.CIl=null;try{this.nO=$a.annotations;const Fb=$a.P7c(na.ha(0)),Xb=new bj(Fb);if(-914743053!==
Xb.rUa())throw Error.argument("Input does not represent a flat lexicon");this.mIl=1===Xb.rUa();this.vIl=1===Xb.rUa();const nc=Xb.rUa();Xb.offset+=nc;const Nc=Xb.rUa();this.bBj=rg.dun(Xb,Nc,this.nO);const yd=Xb.rUa();this.CIl=rg.iun(Xb,yd);const Ud=Xb.rUa();this.wcc=new Fj.a(Xb.Xcf,Xb.offset);Xb.offset+=Ud}catch(Fb){throw Error.argument("initData");}}get trie(){return this.wcc}EMm(na){return"i"===na&&this.vIl?"\u0130":na.toUpperCase()}pgj(){return this.mIl}RLm(na){let $a;$a=new Xf.a(this.nO,Ce.Annotations.Xta);
if(1!==na)if(0===na)na=new vf.a(this.nO),Array.add($a.items,na);else if(na&1073741824){na=this.CIl[na&-1073741825];for(let Xb=0;Xb<na.length;++Xb){var Fb=na[Xb];Fb=0===Fb?new vf.a(this.nO):this.bBj[Fb-2];Array.add($a.items,Fb)}}else Array.add($a.items,this.bBj[na-2]);return{returnValue:!0,X8m:$a}}static dun(na,$a,Fb){if($a%4)throw Error.argument("reader");const Xb=Hg.ZAm(na.Xcf,na.offset,$a/4);na.offset+=$a;na=[];for($a=0;$a<Xb.count;){const nc=({H$a:$a}=Fb.Phb(Ce.Annotations.Xta,Xb,$a,null,null,
null)).returnValue;Array.add(na,nc)}return na}static iun(na,$a){$a=na.offset+$a;const Fb=[];for(;na.offset<$a;){const Xb=na.rUa(),nc=Array(Xb);for(let Nc=0;Nc<Xb;++Nc){const yd=na.rUa();nc[Nc]=yd}Array.add(Fb,nc)}return Fb}}Object(m.a)(rg,"RawFlatLexicon",null,[1794]);var Jj=a(1357),uk=a(1358);class ai{constructor(na){if(null==na)throw Error.argumentNull("base64String");const $a=na.length;if($a%4)throw Error.argument("base64String's length must be a multiple of 4");this.C3=.75*$a;this.HYd=Array(Math.ceil(this.C3/
4));na.endsWith("==")?this.C3-=2:na.endsWith("=")&&--this.C3;let Fb=0;for(let Xb=0;Xb<$a;Xb+=4){const nc=ai.ovh[na.charCodeAt(Xb)-43]<<18|ai.ovh[na.charCodeAt(Xb+1)-43]<<12|ai.ovh[na.charCodeAt(Xb+2)-43]<<6|ai.ovh[na.charCodeAt(Xb+3)-43];let Nc=nc>>16&255;this.HYd[Math.floor(Fb/4)]|=Nc<<Fb%4*8;++Fb;Nc=nc>>8&255;this.HYd[Math.floor(Fb/4)]|=Nc<<Fb%4*8;++Fb;Nc=nc&255;this.HYd[Math.floor(Fb/4)]|=Nc<<Fb%4*8;++Fb}}get length(){return this.C3}ha(na){if(0>na||na>=this.C3)throw Error.argumentOutOfRange("i");
return this.Stl(na)}xS(na,$a){if(0>na||0>$a||na+$a>this.C3)throw Error.argument("Bad range");let Fb=0;for(let Xb=0;Xb<$a;++Xb)Fb|=this.Stl(na+Xb)<<8*Xb;return Fb}hDn(na,$a){let Fb=0,Xb=0,nc=Math.floor(na/8);for(na%=8;Xb<$a;){const Nc=8-na>$a-Xb?$a-Xb:8-na,yd=this.ha(nc);Fb|=(yd>>na&~(255<<Nc))<<Xb;Xb+=Nc;++nc;na=0}return Fb}Stl(na){return this.HYd[Math.floor(na/4)]>>na%4*8&255}}ai.ovh=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,
22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(m.a)(ai,"ByteArray",null,[]);class mh{constructor(na,$a,Fb){this.K1=na;this.Ubn=$a;this.fdn=Fb;this.vJl=Array(na.b?na.b.length:0);this.pPj=new Jj.a(new uk.a(this.P7c(this.K1.s)));this.RTa=Array(na.t.length);this.zfm=new Ce.Annotations(this.M7c(0),this)}get annotations(){return this.zfm}get zFm(){return this.K1.d}CQm(){if(!(""in this.K1.m))throw Error.argument("name","Unrecognized module");
return this.YQi(this.K1.m[""])}P7c(na){if(0>na||!this.K1.b||na>=this.K1.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.vJl[na]||(this.vJl[na]=new ai(this.K1.b[na]))}i3(na){if(1>na||na>=this.K1.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.K1.t[na])throw Error.argument("blobID","Requested blob is not a string");if(null==this.RTa[na]){const $a=this.M7c(na).ha(0);this.RTa[na]=this.pPj.i3($a)}return this.RTa[na]}iwl(na){if(1>na||na>=this.K1.t.length)throw Error.argumentOutOfRange("blobID");
if(2!==this.K1.t[na])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.RTa[na]){var $a=this.M7c(na);const Fb=this.i3($a.ha(0));$a=1===$a.ha(1);this.RTa[na]=new RegExp(Fb,$a?"i":"")}return this.RTa[na]}wSm(na){if(1>na||na>=this.K1.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.K1.t[na])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}YQi(na){if(1>na||na>=this.K1.t.length)throw Error.argumentOutOfRange("blobID");if(4!==
this.K1.t[na])throw Error.argument("blobID","Requested blob is not an NL module");return this.RTa[na]||(this.RTa[na]=this.fdn.KQm(this.M7c(na),this))}vca(na){if(1>na||na>=this.K1.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.K1.t[na])throw Error.argument("blobID","Requested blob is not an annotation query");return this.RTa[na]||(this.RTa[na]=new Xa(new Tf(this.M7c(na),this)))}kGd(na){if(1>na||na>=this.K1.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.K1.t[na])throw Error.argument("blobID",
"Requested blob is not an annotation script");return this.RTa[na]||(this.RTa[na]=new Kh(new oi(this.M7c(na),this)))}kjb(na){if(1>na||na>=this.K1.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.K1.t[na])throw Error.argument("blobID","Requested blob is not a filter");return this.RTa[na]||(this.RTa[na]=this.Ubn.kjb(this.M7c(na),this))}cSm(na){if(1>na||na>=this.K1.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.K1.t[na])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");
return this.RTa[na]||(this.RTa[na]=new rg(this.M7c(na),this))}M7c(na){const $a=this.K1.n[na];na=(na<this.K1.t.length-1?this.K1.n[na+1]:this.K1.n.length)-$a;if(0>$a||0>na||$a+na>this.K1.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+$a+","+na+")");const Fb=new Bf.a;Fb.$yf(this.K1.n,$a,na);return Fb}}Object(m.a)(mh,"ObjectFetcher",null,[1731]);class tg{constructor(na,$a,Fb){if(!na)throw Error.argumentNull("prediction");if(!$a)throw Error.argumentNull("fieldNames");
if(!Fb)throw Error.argumentNull("values");if($a.length!==Fb.length)throw Error.argument("values","fieldNames and values do not have same length");this.Kkm=na;this.U0d=$a;this.JMc=Fb}get prediction(){return this.Kkm}get Hrl(){return this.U0d.length}getFieldName(na){return 0<=na&&na<this.U0d.length?this.U0d[na]:null}gb(na){return 0<=na&&na<this.JMc.length?this.JMc[na]:null}}Object(m.a)(tg,"PredictionData",null,[]);class Kj{constructor(na,$a){if(!na)throw Error.argumentNull("predictions");if(!$a)throw Error.argumentNull("tokenAttributes");
this.zdn=na;this.Nen=$a}RSi(){return this.zdn}ytl(){return this.Nen}}Object(m.a)(Kj,"PredictionDataWithTokenAttributes",null,[]);class ek{constructor(na,$a){this.prediction=null;this.score=0;this.prediction=na;this.score=$a}}Object(m.a)(ek,"PredictionWithScore",null,[]);class gi{constructor(na,$a){if(!na)throw Error.argumentNull("predictions");if(!$a)throw Error.argumentNull("attributes");this.Lkm=na;this.zEh=$a}RSi(){return this.Lkm}ytl(){return this.zEh}}Object(m.a)(gi,"PredictionsWithTokenAttributes",
null,[]);class Di{constructor(na,$a,Fb){if(!na)throw Error.argumentNull("attributeName");if(!$a)throw Error.argumentNull("fieldNames");if(!Fb)throw Error.argumentNull("values");if($a.length!==Fb.length)throw Error.argument("values","fieldNames and values do not have same length");this.Pfm=na;this.U0d=$a;this.JMc=Fb}get attributeName(){return this.Pfm}get Hrl(){return this.U0d.length}getFieldName(na){return 0<=na&&na<this.U0d.length?this.U0d[na]:null}gb(na){return 0<=na&&na<this.JMc.length?this.JMc[na]:
null}}Object(m.a)(Di,"TokenAttributes",null,[]);var ak=a(29);class Rj{constructor(na,$a,Fb,Xb,nc){this.N6g=0;this.g2k=null;this.O6g=this.KPe=0;this.wAh=this.Rve=this.uyb=this.LPe=null;this.h2k=0;this.nHb=this.HW=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Mra=na;this.vam=this.zam=$a;this.uam=this.xam=Fb;this.L6g=this.wam=Xb;this.M6g=this.yam=nc}HPe(){this.O6g=0;return this.e2c}e2c(){if(!(this.O6g<this.L6g))return this.Qve;
this.LPe=this.vam.items[this.O6g+this.uam];this.uyb=new vf.a(this.Mra.Wb.annotations);1!==this.L6g&&this.Mra.Wb.hQf||this.uyb.wqc(this.LPe);if(0<=this.Mra.Wb.jrh){({value:this.Rve}=this.uyb.lD(this.Mra.Wb.jrh)).returnValue?this.Rve=this.Rve.nsa():this.Rve=new Xf.a(this.Mra.Wb.annotations,Ce.Annotations.Xta);this.wAh=this.M6g.items;this.h2k=this.wAh.length;for(this.N6g=0;this.N6g<this.h2k;++this.N6g)this.g2k=this.wAh[this.N6g],Array.add(this.Rve.items,this.g2k);this.uyb.BS(this.Mra.Wb.jrh,this.Rve)}else 0<=
this.Mra.Wb.UJk?this.uyb.BS(this.Mra.Wb.UJk,this.M6g.items[0]):0<=this.Mra.Wb.D8h?this.uyb.BS(this.Mra.Wb.D8h,!0):this.Mra.Wb.SCl?this.M6g.items[0].tgh((na,$a)=>this.uyb.BS(na,$a)):(this.uyb.wqc(this.M6g.items[0]),1!==this.L6g&&this.Mra.Wb.hQf||(({value:this.KPe}=this.LPe.lD(this.Mra.Wb.WHa)).returnValue&&this.uyb.BS(this.Mra.Wb.WHa,this.KPe),({value:this.KPe}=this.LPe.lD(this.Mra.Wb.vSa)).returnValue&&this.uyb.BS(this.Mra.Wb.vSa,this.KPe),this.LPe.lD(this.Mra.Wb.f5c).returnValue&&this.uyb.BS(this.Mra.Wb.f5c,
this.KPe)));this.HW=this.uyb;this._state=2;return this.JPe}Qve(){this._state=3}IPe(){this.O6g++;return this.e2c}JPe(){return 1<this.L6g&&this.Mra.Wb.hQf?this.Qve:this.IPe}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Rj(this.Mra,this.zam,this.xam,this.wam,this.yam)).getEnumerator()}[Symbol.iterator](){return Object(ak.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.nHb=this.HPe());for(;1===this._state;)this.nHb=
this.nHb();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.HW}}Object(m.a)(Rj,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[24,98,103]);class Lf{constructor(na,$a,Fb){this.C6f=this.dJl=0;this.iGe=null;this.TPj=this.PBj=this.cGe=this.Xmh=this.OCj=0;this.unh=!1;this.TJj=na;this.CQj=$a;this.tdn=Fb}Bvl(){null===this.iGe&&({u7l:this.iGe,Vzl:this.OCj,length:this.Xmh,
jIm:na}=this.TJj.oxl(this.CQj.items[this.C6f],this.tdn),this.unh=na||this.unh);if(this.cGe<this.Xmh){var na=this.iGe.charAt(this.OCj+this.cGe);++this.cGe;return{returnValue:!0,ch:na}}if(this.C6f===this.CQj.items.length-1)return{returnValue:!1,ch:"\x00"};++this.C6f;this.cGe=0;this.iGe=null;return{returnValue:!0,ch:" "}}kmk(na,$a){this.cGe===this.Xmh&&this.iGe&&(this.TPj=$a,this.PBj=this.C6f-this.dJl+1)}LHn(na){if(0>na||na>=this.CQj.items.length)throw Error.argumentOutOfRange("iToken");this.C6f=this.dJl=
na;this.iGe=null;this.PBj=this.cGe=this.Xmh=this.OCj=0;this.TPj=-1;this.unh=!1}lQm(){return{tvm:this.PBj,R7m:this.TPj,cIm:this.unh}}}Object(m.a)(Lf,"TriePrefixVisitor",null,[1790]);class Sh{constructor(na){this.Wb=na}execute(na){if(!({value:Fb}=na.lD(this.Wb.s$b)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let $a;({value:$a}=na.lD(this.Wb.Mnc)).returnValue||($a=null);var Fb=this.ELm(Fb,$a);na=Ce.Annotations.nsa(na);na.BS(this.Wb.s$b,Fb);return na}ELm(na,$a){let Fb=
null;const Xb=this.Wb.flatLexicon.trie,nc=new Lf(this,na,$a);let Nc=null;this.Wb.flatLexicon.pgj()&&(Nc=Object(B.a)(this.Wb.flatLexicon,this.Wb.flatLexicon.EMm,"getCaseInsensitiveForm"));let yd=0,Ud;var ie;let Be;for(;yd<na.items.length;){const oe=na.items[yd];nc.LHn(yd);Xb.I$l(nc,Nc);({tvm:Ud,R7m:ie,cIm:Be}=nc.lQm());if(0<Ud){({X8m:ie}=this.Wb.flatLexicon.RLm(ie));for(let rf of this.uBm(na,yd,Ud,ie)){1<Ud&&this.Wb.hQf&&this.BBm(na,$a,yd,oe,Ud,Be,rf);if(!Fb)for(Fb=new Xf.a(this.Wb.annotations,Ce.Annotations.Xta),
ie=0;ie<yd;++ie)Array.add(Fb.items,na.items[ie]);Array.add(Fb.items,rf)}yd+=Ud}else Fb&&Array.add(Fb.items,oe),++yd}return Fb||na}BBm(na,$a,Fb,Xb,nc,Nc,yd){if(Nc)Nc=!0;else if(this.Wb.NCl){Nc=!1;var Ud=-1;for(var ie=0;ie<nc;ie++){var Be=na.items[Fb+ie];let xg;var oe=void 0;if(!({value:xg}=Be.lD(this.Wb.WHa)).returnValue||!({value:oe}=Be.lD(this.Wb.vSa)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<ie){if(xg>
Ud+1){Nc=!0;break}if(0>Ud||null===$a||Ud>=$a.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==$a.charAt(Ud)){Nc=!0;break}}Ud=xg+oe}}else Nc=!1;if(Nc){oe=new Sys.StringBuilder;for(Nc=0;Nc<nc;++Nc)({u7l:Ud,Vzl:ie,length:Be}=this.oxl(na.items[Fb+Nc],$a)),0<Nc&&oe.append(" "),oe.append(Ud.substr(ie,Be));yd.BS(this.Wb.f5c,oe.toString())}na=na.items[Fb+nc-1];let rf,Vf;({value:Xb}=Xb.lD(this.Wb.WHa)).returnValue&&
({value:rf}=na.lD(this.Wb.WHa)).returnValue&&({value:Vf}=na.lD(this.Wb.vSa)).returnValue?(yd.BS(this.Wb.WHa,Xb),yd.BS(this.Wb.vSa,rf+Vf-Xb)):(yd.fuh(this.Wb.WHa),yd.fuh(this.Wb.vSa))}uBm(na,$a,Fb,Xb){return new Rj(this,na,$a,Fb,Xb)}oxl(na,$a){let Fb,Xb;if(({value:Fb}=na.lD(this.Wb.f5c)).returnValue)Xb=!0,$a=0,na=Fb.length;else{Xb=!1;if(null===$a)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Fb=$a;if(!({value:$a}=na.lD(this.Wb.WHa)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:na}=na.lD(this.Wb.vSa)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>$a||0>na||$a+na>Fb.length)throw Error.argument("Token start/length values out of range","token");}return{u7l:Fb,Vzl:$a,length:na,jIm:Xb}}}Object(m.a)(Sh,"FlatLexiconNLModule",null,[1777]);class Nh{constructor(na,$a){this.D8h=this.jrh=this.UJk=this.f5c=this.vSa=this.WHa=this.Mnc=this.s$b=0;this.SCl=this.NCl=this.hQf=!1;this.flatLexicon=null;this.annotations=$a.annotations;
let Fb=0;try{this.s$b=na.ha(Fb),++Fb,this.Mnc=na.ha(Fb),++Fb,this.WHa=na.ha(Fb),++Fb,this.vSa=na.ha(Fb),++Fb,this.f5c=na.ha(Fb),++Fb,this.UJk=na.ha(Fb),++Fb,this.jrh=na.ha(Fb),++Fb,this.D8h=na.ha(Fb),++Fb,this.hQf=1===na.ha(Fb),++Fb,this.NCl=1===na.ha(Fb),++Fb,this.SCl=1===na.ha(Fb),++Fb,this.flatLexicon=$a.cSm(na.ha(Fb))}catch(Xb){throw Error.argument("initData");}}}Object(m.a)(Nh,"FlatLexiconNLModuleInit",null,[]);class Fk{constructor(){this.PMf=0;this.zDi=null;this.POg=0}}Object(m.a)(Fk,"FeatureGenStackRec",
null,[]);class bk{constructor(na){this.TRk=Array(na);this.uOe=Array(na);this.NMk=[];this.I6l=[]}}Object(m.a)(bk,"TokenStringLattice",null,[]);const Uh=(na,$a,Fb)=>{for(let Xb=0;Xb<na.length;Xb++)Fb=$a(Fb,na[Xb]);return Fb},Ge=(na,$a)=>{const Fb=Array(na.length);for(let Xb=0;Xb<na.length;Xb++)Fb[Xb]=$a(na[Xb]);return Fb},Hf=(na,$a)=>{$a=Array(Math.min($a,na.length));for(let Fb=0;Fb<$a.length;Fb++)$a[Fb]=na[Fb];return $a},Bg=(na,$a)=>{const Fb=[];for(const Xb of na)$a(Xb)&&Array.add(Fb,Xb);return Fb};
class qk{constructor(na,$a){this.key=na;this.value=$a}}Object(m.a)(qk,"KeyValuePair",null,[]);const Oj=(na,$a)=>({returnValue:$a in na,value:na[$a]}),Hk=na=>{const $a=[];for(let Fb in na){const Xb=new qk(Fb,na[Fb]);Array.add($a,Xb)}return $a};class Hi{constructor(na){this.nxl=this.AUm;this.Wb=na;this.Hoh=this.DJj=this.EJj=0;for(const $a of this.Wb.Qfh)this.EJj=Math.max(this.EJj,$a.dbk),this.DJj=Math.max(this.DJj,$a.k8j),this.Hoh=Math.max(this.Hoh,$a.DNe.length)}get XIm(){return this.Wb.Myh.trie}execute(na){if(!na)throw Error.argumentNull("input");
let $a,Fb;({tokens:$a,t8m:Fb}=this.BUm(na));let Xb=null,nc=null,Nc={};if(this.Wb.QRf){$a=Ce.Annotations.nsa($a);for(var yd=0;yd<$a.items.length;++yd)$a.items[yd]=Ce.Annotations.nsa($a.items[yd])}else({wrl:nc,returnValue:Xb}=this.Pvl(na,Nc));yd=Array(this.Hoh);const Ud=Array(this.Hoh);for(var ie=0;ie<Ud.length;++ie)Ud[ie]=new Fk;for(ie=-this.EJj;ie<$a.items.length+this.DJj;++ie){let Be=null;this.Wb.QRf&&(Be=$a.items[ie],Nc={},{wrl:nc,returnValue:Xb}=this.Pvl(Be,Nc));for(const oe of this.Wb.Qfh){if(0>
ie&&-ie>oe.dbk||ie>=$a.items.length&&ie-$a.items.length+1>oe.k8j)continue;let rf=!0;for(let Vf=0;Vf<oe.DNe.length;++Vf){const xg=ie+oe.DNe[Vf];yd[Vf]=xg;if(0>xg?0>this.Wb.ebk:xg>=$a.items.length?0>this.Wb.l8j:!Fb.uOe[xg]){rf=!1;break}}rf&&({TCm:Xb,UCm:nc}=this.Y2m(oe,Fb,Xb,nc,Nc,Ud,yd))}this.Wb.QRf&&(Be.BS(this.Wb.oBc?this.Wb.vze:this.Wb.tze,Xb),this.Wb.oBc&&Be.BS(this.Wb.uze,nc))}na=Ce.Annotations.nsa(na);this.Wb.QRf?na.BS(this.Wb.s$b,$a):(na.BS(this.Wb.oBc?this.Wb.vze:this.Wb.tze,Xb),this.Wb.oBc&&
na.BS(this.Wb.uze,nc));return na}BUm(na){let $a,Fb;if(!na||!({value:$a}=na.lD(this.Wb.s$b)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Xb;({value:Xb}=na.lD(this.Wb.Mnc)).returnValue||(Xb="");Fb=new bk($a.items.length);const nc=Bg(this.Wb.WRk,Nc=>!Nc.oOf||Nc.oOf.isMatch(na,null));for(let Nc=0;Nc<$a.items.length;++Nc){const yd=$a.items[Nc];let Ud=null;Fb.TRk[Nc]=Fb.NMk.length;let ie=Fb.uOe[Nc]=0;for(const Be of nc)0<Be.Fsg&&Fb.uOe[Nc]+ie>=Be.Fsg||Be.k_g&&
!Be.k_g.isMatch(yd,null)||({l_g:Ud,Cff:ie}=Be.apply(this,yd,Nc,Fb,Xb,Ud,ie))}return{tokens:$a,t8m:Fb}}Y2m(na,$a,Fb,Xb,nc,Nc,yd){let Ud=0;Nc[0].PMf=-1;for(Nc[0].zDi=na.h0l;;){var ie=yd[Ud],Be=0>ie||ie>=$a.uOe.length?1:$a.uOe[ie];let Vf=!1;for(;Nc[Ud].PMf<Be-1;){++Nc[Ud].PMf;var oe=void 0,rf=void 0;0>ie?(oe=this.Wb.ebk,rf=1):ie>=$a.TRk.length?(oe=this.Wb.l8j,rf=1):(rf=$a.TRk[ie]+Nc[Ud].PMf,oe=$a.NMk[rf],rf=$a.I6l[rf]);Nc[Ud].POg=rf*(Ud?Nc[Ud-1].POg:na.score);if(({value:oe}=Oj(Nc[Ud].zDi,oe.toString())).returnValue){Ud===
na.DNe.length-1?(ie=oe,Nc[Ud].POg&&(({value:Be}=Oj(nc,ie.toString())).returnValue||(Be=-1),0>Be&&(Fb=Ce.Annotations.nsa(Fb),Array.add(Fb.items,ie)),this.Wb.oBc&&(Xb=Ce.Annotations.nsa(Xb),0>Be?Array.add(Xb.items,Nc[Ud].POg):Xb.items[Be]+=Nc[Ud].POg),0>Be&&(this.Wb.gEl||this.Wb.oBc)&&(nc[ie.toString()]=Fb.items.length-1))):(++Ud,Nc[Ud].PMf=-1,Nc[Ud].zDi=oe);Vf=!0;break}}if(!Vf&&(--Ud,0>Ud))break}return{TCm:Fb,UCm:Xb}}Pvl(na,$a){let Fb;if(({value:Fb}=na.lD(this.Wb.oBc?this.Wb.vze:this.Wb.tze)).returnValue)for(let Xb=
0;Xb<Fb.items.length;++Xb)$a[Fb.items[Xb].toString()]=Xb;else Fb=new Xf.a(this.Wb.annotations,Ce.Annotations.G8b);if(this.Wb.oBc){if(({value:$a}=na.lD(this.Wb.uze)).returnValue||($a=new Xf.a(this.Wb.annotations,Ce.Annotations.Lxb)),$a.items.length!==Fb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Wb.annotations.z8a(Ce.Annotations.Xta,na));}else $a=null;return{returnValue:Fb,wrl:$a}}get NUn(){return this.Wb.Myh}AUm(na,
$a){var Fb;if(({value:Fb}=$a.lD(this.Wb.f5c)).returnValue)na=Fb;else{if(!({value:Fb}=$a.lD(this.Wb.WHa)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:$a}=$a.lD(this.Wb.vSa)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>Fb||0>$a||Fb+$a>na.length)throw Error.argument("Token indices are out of range");na=na.substr(Fb,$a)}return na}}Object(m.a)(Hi,"NGramNLModule",null,[1777,1780]);class nh{constructor(na){this.DNe=null;this.score=this.k8j=this.dbk=
0;this.h0l=null;if(na){var $a=0;try{if(na.ha($a)!==nh.uwd)throw Error.argument("initData","Input does not represent a feature template");++$a;const Fb=na.ha($a);++$a;this.DNe=Array(Fb);for(let Xb=0;Xb<Fb;++Xb)this.DNe[Xb]=na.ha($a),++$a;this.dbk=na.ha($a);++$a;this.k8j=na.ha($a);++$a;this.score=na.ha($a);++$a;this.h0l=({Uzl:$a}=nh.eXl(na,$a)).returnValue}catch(Fb){throw Error.argument("initData");}}}static eXl(na,$a){const Fb=na.ha($a);++$a;const Xb={};for(let nc=0;nc<Fb;++nc){const Nc=na.ha($a);
++$a;na.ha($a)?Xb[Nc.toString()]=({Uzl:$a}=nh.eXl(na,$a)).returnValue:(++$a,Xb[Nc.toString()]=na.ha($a),++$a)}return{returnValue:Xb,Uzl:$a}}}nh.uwd=240803228;Object(m.a)(nh,"FeatureTemplate",null,[1788]);var Pf=a(1230);class Q{constructor(na,$a){this.oBc=this.gEl=this.QRf=!1;this.f5c=this.vSa=this.WHa=this.s$b=this.Mnc=this.uze=this.vze=this.tze=0;this.Myh=null;this.l8j=this.ebk=0;this.Qfh=this.WRk=null;if(na){this.annotations=$a.annotations;var Fb=0;try{this.QRf=1===na.ha(Fb);++Fb;this.gEl=1===na.ha(Fb);
++Fb;this.oBc=1===na.ha(Fb);++Fb;this.tze=na.ha(Fb);++Fb;this.vze=na.ha(Fb);++Fb;this.uze=na.ha(Fb);++Fb;this.Mnc=na.ha(Fb);++Fb;this.s$b=na.ha(Fb);++Fb;this.WHa=na.ha(Fb);++Fb;this.vSa=na.ha(Fb);++Fb;this.f5c=na.ha(Fb);++Fb;this.Myh=this.wun($a.P7c(na.ha(Fb)));++Fb;this.ebk=na.ha(Fb);++Fb;this.l8j=na.ha(Fb);++Fb;const Xb=na.ha(Fb);++Fb;this.WRk=Array(Xb);for(let Nc=0;Nc<Xb;++Nc){const yd=na.ha(Fb);++Fb;const Ud=this.Myh.trie,ie=new Bf.a;ie.E7c(na,Fb,yd);this.WRk[Nc]=this.Aun(ie,$a,Ud);Fb+=yd}const nc=
na.ha(Fb);++Fb;this.Qfh=Array(nc);for($a=0;$a<nc;++$a){const Nc=na.ha(Fb);++Fb;const yd=new Bf.a;yd.E7c(na,Fb,Nc);this.Qfh[$a]=this.jun(yd);Fb+=Nc}}catch(Xb){throw Error.argument("initData");}}}wun(na){return new Jj.a(new uk.a(na))}Aun(na,$a,Fb){return Pf.a.create(na,$a,Fb)}jun(na){return new nh(na)}}Object(m.a)(Q,"NGramNLModuleInit",null,[]);class xa{constructor(na){this.Wb=na}execute(na){if(!na)throw Error.argumentNull("input");na=na.clone();this.Wb.script.execute(na,null);return na}}Object(m.a)(xa,
"ScriptNLModule",null,[1777]);class ob{constructor(na,$a){na&&(this.script=$a.kGd(na.ha(0)))}}Object(m.a)(ob,"ScriptNLModuleInit",null,[]);const Qb=na=>{na=Ge(na,$a=>$a*$a);return Math.sqrt(Uh(na,($a,Fb)=>$a+Fb,0))},mc=na=>Uh(na,($a,Fb)=>$a>Fb?$a:Fb,na[0]);class yc{constructor(na){this.Wb=na}execute(na){if(!na)throw Error.argumentNull("input");var $a=[],Fb=[];this.sym(na,$a,Fb);this.mrm($a,Fb);const Xb={};for(let Nc=0;Nc<$a.length;++Nc){var nc=$a[Nc];const yd=this.Wb.hBl.ha(nc);nc=this.Wb.iBl.ha(nc);
for(let Ud=0;Ud<nc;++Ud){const ie=this.Wb.rxm.ha(this.Wb.Jjl.ha(yd+Ud)),Be=this.Wb.Kjl.ha(yd+Ud);let oe;({value:oe}=Oj(Xb,ie)).returnValue||(oe=0);Xb[ie]=oe+Fb[Nc]*Be}}Fb=Hk(Xb);Fb.sort((Nc,yd)=>{var Ud=Nc.value,ie=yd.value;(Ud=-(Ud>ie?1:Ud<ie?-1:0))||(Ud=Nc.key.localeCompare(yd.key));return Ud});$a=new Xf.a(this.Wb.annotations,Ce.Annotations.Xta);for(const Nc of Hf(Fb,this.Wb.Rfn))Fb=new vf.a(this.Wb.annotations),Fb.BS(this.Wb.atm,Nc.key),Fb.BS(this.Wb.ctm,Nc.value),Array.add($a.items,Fb);na.BS(this.Wb.btm,
$a);return na}sym(na,$a,Fb){if(({value:na}=na.lD(this.Wb.$sm)).returnValue){let Xb;if(({value:Xb}=na.lD(this.Wb.vze)).returnValue){let nc;if(!({value:nc}=na.lD(this.Wb.uze)).returnValue||Xb.items.length!==nc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.kdh(Xb,nc,$a,Fb)}if(({value:Xb}=na.lD(this.Wb.etm)).returnValue){let nc;if(!({value:nc}=na.lD(this.Wb.ftm)).returnValue||Xb.items.length!==nc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.kdh(Xb,nc,$a,Fb)}({value:Xb}=na.lD(this.Wb.tze)).returnValue&&this.kdh(Xb,null,$a,Fb);({value:Xb}=na.lD(this.Wb.dtm)).returnValue&&this.kdh(Xb,null,$a,Fb)}}kdh(na,$a,Fb,Xb){for(let Nc=0;Nc<na.items.length;++Nc){var nc=void 0;na.vOa===Ce.Annotations.OUa?({value:nc}=Oj(this.Wb.dpl,na.items[Nc])).returnValue||(nc=-1):(nc=na.items[Nc],nc=nc>=this.Wb.qUj&&nc<=this.Wb.fgn?this.Wb.ZWj?this.Wb.ZWj.ha(nc-this.Wb.qUj)-1:nc-this.Wb.qUj:-1);if(0<=nc){let yd;yd=$a?$a.items[Nc]:1;0<yd&&(Array.add(Fb,nc),Array.add(Xb,
yd))}}}mrm(na,$a){if(na.length){switch(this.Wb.DBn){case 0:break;case 1:for(var Fb=0;Fb<$a.length;++Fb)$a[Fb]=1+Math.log($a[Fb]);break;case 2:Fb=mc($a);for(let Xb=0;Xb<$a.length;++Xb)$a[Xb]=.5+$a[Xb]/Fb*.5;break;case 3:for(Fb=0;Fb<$a.length;++Fb)$a[Fb]=1;break;default:throw Error.notImplemented();}if(this.Wb.Vjh)for(Fb=0;Fb<$a.length;++Fb)$a[Fb]*=this.Wb.Vjh.ha(na[Fb]);na=Qb($a);for(Fb=0;Fb<$a.length;++Fb)$a[Fb]/=na}}}Object(m.a)(yc,"TfIdfRankerNLModule",null,[1777]);class Sc{constructor(na,$a=0){if(!na)throw Error.argumentNull("byteArray");
this.ax=$a;if(604662927!==na.xS(this.ax+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.wq=na.xS(this.ax+4,4);this.SGl=na.xS(this.ax+8,4);this.cbn=na}ha(na){if(0>na||na>=this.count)throw Error.argumentOutOfRange("index");return this.cbn.hDn(8*this.ax+96+na*this.SGl,this.SGl)}get count(){return this.wq}}Object(m.a)(Sc,"CompactIntArray",null,[1779]);const wd=(na,$a)=>{$a=Array($a);for(let Nc=0;Nc<$a.length;Nc++){var Fb=Nc,Xb=na.rUa(),nc=1===(Xb>>31&1)?-1:1;
const yd=Xb&8388607;Xb=Xb>>23&255;256===Xb+1?nc=yd?Number.NaN:1===nc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Xb?(Xb-=127,nc=nc*zd(yd,1)*Math.pow(2,Xb)):nc=nc*zd(yd,0)*Math.pow(2,-126);$a[Fb]=nc}return $a},zd=(na,$a)=>{let Fb=0;for(let Xb=0;23>Xb;Xb++)Fb+=(na>>22-Xb&1)/Math.pow(2,Xb+1);return $a+Fb};class Pd{constructor(na,$a){this.ZWj=null;this.IOl=0;this.iBl=this.hBl=this.Vjh=null;this.HOl=0;this.Kjl=this.Jjl=null;this.annotations=$a.annotations;let Fb=0;this.dtm=na.ha(Fb);++Fb;this.tze=
na.ha(Fb);++Fb;this.etm=na.ha(Fb);++Fb;this.ftm=na.ha(Fb);++Fb;this.vze=na.ha(Fb);++Fb;this.uze=na.ha(Fb);++Fb;this.$sm=na.ha(Fb);++Fb;this.btm=na.ha(Fb);++Fb;this.atm=na.ha(Fb);++Fb;this.ctm=na.ha(Fb);++Fb;var Xb=na.ha(Fb);++Fb;var nc=Array(Xb);for(var Nc=0;Nc<Xb;++Nc)nc[Nc]=$a.i3(na.ha(Fb)),++Fb;this.rxm=Bf.a.zpi(nc);this.Rfn=na.ha(Fb);++Fb;this.DBn=na.ha(Fb);++Fb;Xb=na.ha(Fb);++Fb;this.dpl={};for(nc=0;nc<Xb;++nc){Nc=$a.i3(na.ha(Fb));++Fb;const yd=na.ha(Fb);++Fb;this.dpl[Nc]=yd}this.qUj=na.ha(Fb);
++Fb;this.fgn=na.ha(Fb);++Fb;Xb=na.ha(Fb);++Fb;0<Xb&&(Xb=$a.P7c(na.ha(Fb)),++Fb,this.ZWj=this.vsh(new bj(Xb)));++Fb;na=$a.P7c(na.ha(Fb));this.oun(na)}vsh(na){return new Sc(na.Xcf,na.offset)}oun(na){try{const $a=new bj(na);this.IOl=$a.rUa();1===$a.rUa()?this.Vjh=Bf.a.zpi(wd($a,this.IOl)):this.Vjh=null;const Fb=$a.rUa();this.hBl=this.vsh($a);$a.offset+=Fb;const Xb=$a.rUa();this.iBl=this.vsh($a);$a.offset+=Xb;this.HOl=$a.rUa();const nc=$a.rUa();this.Jjl=this.vsh($a);$a.offset+=nc;this.Kjl=Bf.a.zpi(wd($a,
this.HOl))}catch($a){throw Error.argument("byteReader");}}}Object(m.a)(Pd,"TfIdfRankerNLModuleInit",null,[]);class Je{constructor(na,$a,Fb,Xb){this.V4j=na;this.hsl=Fb;this.tokens=Xb;this.Ehb=$a;this.yMe=-1;this.Kvh=0}}Object(m.a)(Je,"TokenizerData",null,[]);class ge{constructor(na){this.Wb=na}execute(na){if(!na)throw Error.argumentNull("input");if(!({value:Xb}=na.lD(this.Wb.Mnc)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let $a;({value:$a}=
na.lD(this.Wb.WHa)).returnValue||($a=0);let Fb;({value:Fb}=na.lD(this.Wb.vSa)).returnValue||(Fb=Xb.length-$a);if(0>$a||$a>Xb.length)throw Error.argument("input","Start index out of range");if(0>Fb||Fb>Xb.length)throw Error.argument("input","Length out of range");if($a+Fb>Xb.length)throw Error.argument("input","Bad start-length range");var Xb=new Je(Xb,$a,$a+Fb,new Xf.a(this.Wb.annotations,Ce.Annotations.Xta));this.OUn(Xb);na=na.isReadOnly?na.clone():na;na.BS(this.Wb.s$b,Xb.tokens);return na}OUn(na){for(;na.Ehb<
na.hsl;){if(this.Wb.X_i){var $a=this.Wb.X_i.bGl(na.V4j,na.Ehb,na.hsl-na.Ehb,null);!$a.succeeded&&$a.lOl&&($a=$a.lOl);if($a.succeeded){this.LQl(na,$a.length,this.Wb.Xxl);na.Ehb+=$a.length;continue}}$a=na.V4j.substr(na.Ehb);let Fb=-1,Xb=-1,nc=-1;for(let Nc=0;Nc<this.Wb.ivh.length;++Nc){const yd=this.Wb.ivh[Nc].exec($a);yd&&0<yd[1].length&&(0>Fb||yd[0].length>Xb)&&(Fb=Nc,Xb=yd[0].length,nc=yd[1].length)}0<=Fb?(this.LQl(na,nc,this.Wb.$tk[Fb]),na.Ehb+=nc):na.Ehb+=1}}LQl(na,$a,Fb){if(this.Wb.zDl)Fb!==ge.Svm&&
(0>na.yMe&&(na.yMe=na.Ehb),na.Kvh=na.Ehb+$a-na.yMe,Fb===ge.Rvm&&(0<=na.yMe&&0<na.Kvh&&($a=new vf.a(this.Wb.annotations),$a.BS(this.Wb.WHa,na.yMe),$a.BS(this.Wb.vSa,na.Kvh),$a.BS(this.Wb.K6h,ge.Tvm),$a.BS(this.Wb.Mnc,na.V4j),Array.add(na.tokens.items,$a)),na.yMe=-1,na.Kvh=0));else{let Xb=new vf.a(this.Wb.annotations);Xb.BS(this.Wb.WHa,na.Ehb);Xb.BS(this.Wb.vSa,$a);Xb.BS(this.Wb.K6h,Fb);Array.add(na.tokens.items,Xb)}}}ge.Svm="GAP";ge.Rvm="EOS_CHUNK";ge.Tvm="SENTENCE";Object(m.a)(ge,"TokenizerNLModule",
null,[1777]);class tb{constructor(na,$a){this.vSa=this.WHa=this.K6h=this.s$b=this.Mnc=0;this.zDl=!1;this.$tk=this.ivh=this.Xxl=this.X_i=null;if(na){this.annotations=$a.annotations;var Fb=0;try{this.Mnc=na.ha(Fb);++Fb;this.s$b=na.ha(Fb);++Fb;this.K6h=na.ha(Fb);++Fb;this.WHa=na.ha(Fb);++Fb;this.vSa=na.ha(Fb);++Fb;this.zDl=1===na.ha(Fb);++Fb;var Xb=na.ha(Fb);++Fb;0<Xb&&(this.X_i=$a.YQi(Xb).XIm);this.Xxl=na.ha(Fb)?$a.i3(na.ha(Fb)):"";++Fb;const nc=na.ha(Fb);++Fb;this.ivh=Array(nc);this.$tk=Array(nc);
for(Xb=0;Xb<nc;++Xb)this.ivh[Xb]=new RegExp($a.i3(na.ha(Fb))),++Fb,this.$tk[Xb]=$a.i3(na.ha(Fb)),++Fb}catch(nc){throw Error.argument("initData");}}}}Object(m.a)(tb,"TokenizerNLModuleInit",null,[]);class Kc{constructor(na){this.Wb=na}execute(na){if(!na)throw Error.argumentNull("input");let $a;if(!({value:$a}=na.lD(this.Wb.jhl)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const Fb of this.Wb.PLk)$a=Fb.apply($a);na=Ce.Annotations.nsa(na);na.BS(this.Wb.khl,
$a);return na}static x5h(na,$a){const Fb=new Sys.StringBuilder;for(let Xb=0;Xb<na.length;++Xb)Fb.append($a(na.substr(Xb,1)));return Fb.toString()}}Object(m.a)(Kc,"TransliteratorNLModule",null,[1777]);class ad{constructor(na){na&&(this.style=na.ha(0))}apply(na){return Kc.x5h(na,$a=>ad.Kwm($a,this.style))}static Kwm(na,$a){switch($a){case 0:return na.toLowerCase();case 1:return"I"===na?"\u0131":na.toLowerCase();case 2:return na.toUpperCase();case 3:return"i"===na?"\u0130":na.toUpperCase();default:throw Error.invalidOperation();
}}}ad.Awd=0;Object(m.a)(ad,"ChangeCaseTransliterationStage",null,[1787]);class id{apply(na){return Kc.x5h(na,id.XUn)}static XUn(na){const $a=na.charCodeAt(0);return 65281<=$a&&65374>=$a?String.fromCharCode($a-65248):na}}id.Awd=4;Object(m.a)(id,"LatinFullWidthToHalfWidthTransliterationStage",null,[1787]);class ud{constructor(na,$a){na&&(this.regex=$a.iwl(na.ha(0)),this.replacement=$a.i3(na.ha(1)))}apply(na){return na.replace(this.regex,this.replacement)}}ud.Awd=1;Object(m.a)(ud,"RegexReplaceTransliterationStage",
null,[1787]);class ke{constructor(na,$a){if(na){var Fb=na.ha(0),Xb=$a.i3(na.ha(1)),nc=new Sc($a.P7c(na.ha(2)));na=0>na.ha(3)?null:new Sc($a.P7c(na.ha(3)));this.eNk={};for($a=0;$a<Fb;++$a)this.eNk[Xb.charAt($a).toString()]=Xb.substr(nc.ha($a),na?na.ha($a):1)}}apply(na){return Kc.x5h(na,$a=>$a in this.eNk?this.eNk[$a]:$a)}}ke.Awd=2;Object(m.a)(ke,"SingleCharSubstitutionsTransliterationStage",null,[1787]);class of{constructor(na,$a){this.khl=this.jhl=0;this.PLk=null;if(na){this.annotations=$a.annotations;
var Fb=0;try{this.jhl=na.ha(Fb);++Fb;this.khl=na.ha(Fb);++Fb;const Xb=na.ha(Fb);++Fb;this.PLk=Array(Xb);for(let nc=0;nc<Xb;++nc){const Nc=na.ha(Fb);++Fb;const yd=na.ha(Fb);++Fb;const Ud=new Bf.a;Ud.E7c(na,Fb,yd);Fb+=yd;this.PLk[nc]=this.vun(Nc,Ud,$a)}}catch(Xb){throw Error.argument("initData");}}}vun(na,$a,Fb){switch(na){case ad.Awd:return new ad($a);case ud.Awd:return new ud($a,Fb);case ke.Awd:return new ke($a,Fb);case id.Awd:return new id;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");
}}}Object(m.a)(of,"TransliteratorNLModuleInit",null,[]);class Yf{KQm(na,$a){const Fb=na.ha(0),Xb=new Bf.a;Xb.E7c(na,1,na.count-1);switch(Fb){case 0:return new xa(new ob(Xb,$a));case 2:return new ge(new tb(Xb,$a));case 3:return new Hi(new Q(Xb,$a));case 5:return new Sh(new Nh(Xb,$a));case 9:return new Kc(new of(Xb,$a));case 10:return new yc(new Pd(Xb,$a));default:throw Error.notImplemented();}}}Object(m.a)(Yf,"NLModuleFactory",null,[1738]);class If{constructor(na){this.Pvm=";";if(!na)throw Error.argumentNull("resource");
this.Eab=new mh(na,new Wf,new Yf);this.TJj=this.Eab.CQm();this.KGl=this.Eab.annotations.Uzf("Text.Text");this.IGl=this.Eab.annotations.Uzf("Classification.Predictions");this.yBj=this.Eab.annotations.Uzf("Classification.PredictionString");this.JGl=this.Eab.annotations.Uzf("Classification.Probability");this.Wan=this.Eab.annotations.Uzf("NLMod.Tokens");if(0>this.KGl||0>this.IGl||0>this.yBj||0>this.JGl)throw Error.argument("resourceObj","Resource does not represent a ranker");}oMm(){const na=[];this.NAi(void 0,
this.Otl(na),null);return na}qMm(na,$a){const Fb=[],Xb=[];this.NAi(na,this.Otl(Fb),(nc,Nc)=>{const yd=this.Eab.annotations.Jtl(nc),Ud=[],ie=[];$a&&$a.length&&-1===Array.indexOf($a,yd)||(nc=this.Eab.annotations.getAttributeType(nc),this.hUl(nc,Nc,Ud,ie),Nc=new Di(yd,Ud,ie),Array.add(Xb,Nc))});return new gi(Fb,Xb)}pMm(na){const $a=[];this.NAi(na,Fb=>{let Xb;if(({value:Xb}=Fb.lD(this.yBj)).returnValue){let nc;({value:nc}=Fb.lD(this.JGl)).returnValue&&Array.add($a,new ek(Xb,nc))}},null);return $a}NAi(na,
$a,Fb){var Xb=new vf.a(this.Eab.annotations);Xb.BS(this.KGl,na);na=this.TJj.execute(Xb);if(({value:Xb}=na.lD(this.IGl)).returnValue)for(const nc of Xb.items)$a(nc);if(Fb&&({value:$a}=na.lD(this.Wan)).returnValue)for(const nc of $a.items)nc.tgh(Fb)}hUl(na,$a,Fb,Xb){if(Ce.Annotations.M8(na))for(var nc of $a.items)this.hUl($a.vOa,nc,Fb,Xb);else if(Ce.Annotations.H8l(na)){nc=this.Eab.annotations.Hvl(na);for(let Nc=0;Nc<nc;Nc++)Array.add(Fb,this.Eab.annotations.Pwl(na,Nc)),Array.add(Xb,this.Eab.annotations.z8a(this.Eab.annotations.wKd(na,
Nc),$a.e8c(Nc)))}else Array.add(Fb,"VALUE"),Array.add(Xb,this.Eab.annotations.z8a(na,$a))}Otl(na){return $a=>{let Fb;({value:Fb}=$a.lD(this.yBj)).returnValue&&Array.add(na,this.KRm(Fb))}}KRm(na){const $a=na.indexOf(this.Pvm);return 0>$a?na:na.substring(0,$a)}}Object(m.a)(If,"Ranker",null,[]);class Jf{constructor(na,$a){this.commandId=na;this.score=$a}}Object(m.a)(Jf,"CommandSuggestion",null,[]);var Th=a(2);class yh{static LDb(na,$a){if($a&&$a.JD){const Fb={};for(const Xb of na)$a.rFe(Xb)&&(Fb[Xb]=
appChrome.selectors.getModelType(Xb));Rd.instance.nD(Fb)}}static HAc(na){const $a=Rd.instance.wca();return!!$a&&$a.JD&&!appChrome.selectors.isControlDisabled(na)}static gZh(na,$a,Fb){if(!($a&&$a.results&&na&&na.results&&na.results.length))return{returnValue:!1,YYh:na,C_h:$a};const Xb=[];for(var nc of $a.results)Array.add(Xb,nc.value);nc=0;const Nc=0<$a.results.length?$a.results[0].score:0;for(const yd of na.results)if(yd.score>Fb&&!Array.contains(Xb,yd.value)&&yh.HAc(yd.value)&&(0<Nc&&(yd.score=Nc),
Array.insert($a.results,nc,yd),nc++),2===nc)break;return 0<nc?(Fb=$a.results.length-5,0<Fb&&$a.Nnk(Fb),{returnValue:!0,YYh:na,C_h:$a}):{returnValue:!1,YYh:na,C_h:$a}}static MFe(na,$a,Fb,Xb){if(Rd.instance.Jp()&&na){const nc=[];for(const Nc of na)nc.push(String.format('{{"Id":"{0}","Score":{1}}}',Nc.commandId,Nc.score));na={};na[Ye.suggestions]="[{"+nc.join(",")+"}]";na[Ye.qEl]=$a;na[Ye.groupType]=Fb;na[Ye.provider]=Xb;Rd.instance.Jp().Zca(Yd.yym,window.performance.now(),na)}}static QJd(na,$a,Fb,Xb,
nc,Nc,yd,Ud){var ie,Be;Fb.rLi&&($a=yh.oNm(Fb.rLi,$a));var oe=rc.QMm($a);yh.LDb(oe,Fb);const rf=[];var Vf=[];oe=[];const xg=new Yg(yd);yd=16===yd||18===yd||7===yd||4===yd?Th.AFrameworkApplication_AppSettingsManager.ga?Th.AFrameworkApplication_AppSettingsManager.ga.Jc("TellMeMaxRecommendedResultsToReturn",3):3:0===yd||17===yd||25===yd?5:0;const qh=Rd.instance.xQi(),k=rc.mNm(Fb),E=rc.PMm(Fb),S=null===(ie=Th.AFrameworkApplication_AppSettingsManager.ga)||void 0===ie?void 0:ie.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateTellMeSuggestions",
!1);rc.L$(na)&&(Fb.jtn&&Fb.rFe(k)&&yh.HAc(k)&&!qh.Okf(k)&&rf.push(new Lg(k,5,null,null,Ud)),S&&Fb.rFe(E)&&yh.HAc(E)&&!qh.Okf(E)&&rf.push(new Lg(E,5,null,null,Ud)));ie=S&&rc.L$(na);for(const sa of $a)if(!(yh.c4m(sa.commandId)||ie&&yh.M6m(sa.commandId))){$a=yh.ZTn(sa.commandId);if(Fb.rFe(sa.commandId)&&!$a){if(rc.VDl(sa.commandId))continue;$a=null;nc&&Nc&&($a=nc.oRm(sa.commandId,Nc));yh.HAc(sa.commandId)?Array.add(rf,new Lg(sa.commandId,5,$a,null,Ud,sa.score)):Array.add(Vf,new Lg(sa.commandId,5,$a,
null,Ud,sa.score))}else Fb.avd&&$a&&Xb&&Array.add(oe,sa.commandId.substr(21));if(rf.length+oe.length>=yd)break}nc=0;for(Nc=0;Nc<rf.length&&nc<yd;Nc++,nc++)xg.oP(rf[Nc]);var la=(Be=(Fb="excel"===(null===(Be=null===Fb||void 0===Fb?void 0:Fb.application)||void 0===Be?void 0:Be.toLowerCase())?S:!0)?null===(la=null===appChrome||void 0===appChrome?void 0:appChrome.api)||void 0===la?void 0:la.getSharedUxSettings():void 0)?Be.commonSettings:void 0;if(!Fb||!la||!la().shouldHideDisabledButtonsFromTellMe())for(la=
0;la<Vf.length&&nc<yd;la++,nc++)xg.oP(Vf[la]);for(Vf=0;Vf<oe.length&&nc<yd;Vf++,nc++)Xb.P6n(na,oe[Vf],xg);return xg}static oNm(na,$a){const Fb=[],Xb=[];for(const nc of $a){$a=nc.commandId;let Nc=nc;nc.commandId in na&&($a=na[nc.commandId],Nc=new Jf($a,nc.score));Array.contains(Xb,$a)||(Fb.push(Nc),Xb.push($a))}return Fb}static c4m(na){yh.zhl||(Th.AFrameworkApplication_AppSettingsManager.ga&&Th.AFrameworkApplication_AppSettingsManager.ga.Tz("TellMeControlPredictionBlockList")&&Th.AFrameworkApplication_AppSettingsManager.ga.tF("TellMeControlPredictionBlockList").forEach($a=>
{Array.add(yh.yhl,$a.toLowerCase())}),yh.zhl=!0);return Array.contains(yh.yhl,na.toLowerCase())}static M6m(na){!yh.Bhl&&Th.AFrameworkApplication_AppSettingsManager.ga&&Th.AFrameworkApplication_AppSettingsManager.ga.Tz("TellMeZeroCaseSuggestionsBlockList")&&(yh.Ahl=Th.AFrameworkApplication_AppSettingsManager.ga.tF("TellMeZeroCaseSuggestionsBlockList"),yh.Bhl=!0);return yh.Ahl.includes(na.toLowerCase())}static ZTn(na){return na.startsWith("btnTellMeOfficeAddIn")}static mQf(na){return 2<na.length&&";"===
na.charAt(0)&&";"===na.charAt(na.length-1)&&!!Th.AFrameworkApplication_AppSettingsManager.ga&&(Th.AFrameworkApplication_AppSettingsManager.ga.getBooleanAppSetting("TellMeCommandHookIsEnabled")||Th.AFrameworkApplication_AppSettingsManager.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}}yh.zhl=!1;yh.Bhl=!1;yh.yhl=[];yh.Ahl=[];Object(m.a)(yh,"CommandResultsUtilityHelper",null,[]);class yi{static LDb(na,$a){return yh.LDb(na,$a)}static HAc(na){return yh.HAc(na)}static MFe(na,
$a,Fb,Xb){return yh.MFe(na,$a,Fb,Xb)}static QJd(na,$a,Fb,Xb,nc,Nc,yd,Ud){return yh.QJd(na,$a,Fb,Xb,nc,Nc,yd,Ud)}static mQf(na){return yh.mQf(na)}static eul(na){const $a=new Yg(0);var Fb=na.split(";");na=Rd.instance.wca();for(const Xb of Fb)if(0<Xb.length){Fb=Xb.split(":");const nc=2===Fb.length?Fb[0]:Xb;if(!na.rFe(nc))break;if(1===Fb.length)Fb=new Lg(nc,5,null,null,1),$a.oP(Fb);else if(2===Fb.length)Fb=new Lg(nc,5,Fb[1],null,1),$a.oP(Fb);else break}return $a}static gZh(na,$a,Fb){return yh.gZh(na,
$a,Fb)}}Object(m.a)(yi,"CommandResultsUtility",null,[]);class Xi{constructor(na,$a){this.$8k="";this.XQh=null;this.YQh=!1;this.yyb=null;this.Qfm=["TellMe.TellMeParamCollection"];this.Zd=na;this.Njc=$a;this.Zd.avd&&(this.yyb=null)}get sth(){if(!this.XQh&&!this.YQh){let na=null;try{na=window.TellMeModel}catch($a){if(Rd.instance.Jp())Rd.instance.Jp().onError("QueryRanker","TellMeModel not found. Exception: "+$a)}if(na){try{this.XQh=new If(na)}catch($a){if(Rd.instance.Jp())Rd.instance.Jp().onError("QueryRanker",
"Exception thrown while loading classifier. Exception: "+$a)}this.YQh=!0}else if(Rd.instance.Jp())Rd.instance.Jp().onError("QueryRanker","Classifier model not found")}return this.XQh}zca(){return"Command"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:2}l8(na,$a,Fb=!1,Xb=sf.fI,nc=null){const Nc=new Ng(na);if((!nc||Array.contains(nc,0))&&!rc.L$(na)){if(!this.sth&&this.YQh){if(Rd.instance.Jp())Rd.instance.Jp().onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");
}this.Zd.avd&&this.yyb&&this.yyb.initialize();if(yi.mQf(na.Fl)&&(nc=yi.eul(na.Fl),0<nc.results.length)){nc.displayName="Classifier Debug";Nc.AL(nc);$a.kE(Nc);return}nc=na?this.$8k=na.Fl:this.$8k;if(n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeParameterizedQueriesEnabled")){nc=this.MRm(nc);var yd=this.$gh(nc.RSi());nc=nc.ytl()}else nc=this.LRm(nc),yd=this.SMm(nc),nc=[];yi.MFe(yd,!1,"Classifier","TFIDF");yd=yi.QJd(na,yd,this.Zd,this.yyb,this.Njc,nc,0,1);0<yd.results.length&&Xb!==sf.contextMenu&&
(yd.displayName=Object(aa.a)("TellMeCommandProviderTitle"));Fb||yd.results.length||this.Zd.ibc||this.Zd.j7b||(na=new Lg("lookupNoResults",14,na.Fl,null,1),yd.oP(na));0<yd.results.length&&Nc.AL(yd);Nc.attributes=nc}$a.kE(Nc)}RSi(){let na=[];try{na=this.sth.oMm()}catch($a){if(Rd.instance.Jp())Rd.instance.Jp().onError("GetPredictions","Exception: "+$a)}return na}LRm(na){let $a=[];try{$a=this.sth.pMm(na)}catch(Fb){if(Rd.instance.Jp())Rd.instance.Jp().onError("GetPredictionsWithScore","Exception: "+Fb)}return $a}MRm(na){try{return this.sth.qMm(na,
this.Qfm)}catch($a){if(Rd.instance.Jp())Rd.instance.Jp().onError("GetPredictionsWithTokenAttributes","Exception: "+$a)}return new gi([],[])}$gh(na){const $a=[];if(na)for(const Fb of na)$a.push(new Jf(Fb,-99999));return $a}SMm(na){const $a=[];if(na)for(const Fb of na)$a.push(new Jf(Fb.prediction,Fb.score));return $a}}Object(m.a)(Xi,"CommandResultsProvider",null,[1292]);class Fh extends Lg{constructor(na,$a,Fb,Xb,nc=null){super(na,$a,nc,null,Fb);this.id=Xb}}Object(m.a)(Fh,"TryQueryResultBinding",Lg,
[]);class Gi{constructor(na,$a,Fb,Xb){this.jHb=na;this.c4c=$a;this.Icl=Xb;this.Phm=Fb;this.Zd=Rd.instance.wca()}zca(){return"EmptyQuery"}Ksa(){return 1===this.Zd.NL?1:0}l8(na,$a,Fb=!1,Xb,nc=null){Xb=new Ng(na);if((!nc||Array.contains(nc,5)||Array.contains(nc,6)||Array.contains(nc,4))&&rc.L$(na)){this.jHb.yBf().length||!this.Phm||this.Icl||(na=new Yg(6),nc=new Lg(null,13,void 0,void 0,1),na.oP(nc),Xb.AL(na));na=new Yg(4);if(0<this.jHb.yBf().length){na.displayName=Object(aa.a)("TellMeRecentlyUsedTitle");
nc=this.jHb.yBf();var Nc=[];for(var yd of nc)Nc.push(yd.Id);yh.LDb(Nc,this.Zd);for(var Ud of nc)yh.HAc(Ud.Id)&&na.oP(new Lg(Ud.Id,5,null,null,2));Xb.AL(na)}if(this.Icl&&0<this.c4c.length&&this.jHb.yBf().length<Gi.maxResults){yd=new Yg(5);yd.displayName=Object(aa.a)("TellMeTryQueryTitle");Ud=Gi.maxResults-na.results.length;na=[];for(nc=0;nc<this.c4c.length&&nc<Ud;++nc){if(Fb){Nc=rc.MUk+(nc+1);const ie=this.c4c[nc].key,Be=ha.a.replaceAll(ie,'"',"");na.push(appChrome.actions.setControlLabel(Nc,ie));
na.push(appChrome.actions.setButtonCommandValueId(Nc,Be));Nc=new Fh(ie,7,0,Be,Nc)}else Nc=new Fh(this.c4c[nc].key,7,0,this.c4c[nc].value);yd.oP(Nc)}0<na.length&&appChrome.api.dispatch(na);Xb.AL(yd)}}$a.kE(Xb)}}Gi.maxResults=5;Object(m.a)(Gi,"EmptyQueryResultsProvider",null,[1292]);class Bj{constructor(na){this.Zd=na}zca(){return"Feedback"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:2}l8(na,$a,Fb,Xb,nc=null){na=new Ng(na);if(!nc||Array.contains(nc,21))nc=[],nc.push(appChrome.actions.setControlLabel("TellMeFeedback",
Object(aa.a)("TellMeFeedbackText"))),appChrome.api.dispatch(nc),nc=new Yg(22),nc.displayName="",nc.oP(new Lg("TellMeFeedback",23,null,null,1)),na.AL(nc);$a.kE(na)}}Object(m.a)(Bj,"FeedbackResultsProvider",null,[1292]);class ck{constructor(na,$a,Fb,Xb){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=na;this.CommandId=$a;this.CommandValueId=Fb;this.InputText=Xb}}Object(m.a)(ck,"FindInDocumentProp",null,[]);class Ph{constructor(na){this.MNh=2;this.aod=[];this.q3c=[];this.Zd=
na;Ph.mOb=na.Xrl;Ph.Zrl="FindInDocumentSuggestion";Ph.GTl="FindInDocumentSuggestion3";this.tjm=Object.assign(new fd.a,{landingTab:"Indoc",data:null});this.Qlm=this.Zd.poe||!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.poe}zca(){return"FindInDocument"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:3===this.Zd.NL?this.Zd.x5l?2:3:2}l8(na,$a,Fb=!1,Xb,nc=null){const Nc=new Ng(na);if(nc&&!Array.contains(nc,2))$a.kE(Nc);else if(Array.clear(this.aod),rc.L$(na)){if(Fb&&this.v4l()){Fb=new Yg(2);
Fb.displayName=Object(aa.a)("TellMeFindInDocProviderTitle");nc=1;Xb="";if(0<this.q3c.length&&!this.Zd.bNe)for(var yd of this.q3c)if(""!==yd.Label.toLowerCase()){if(nc>=this.MNh)break;this.X9l(Fb,yd.Label,yd.CommandValueId,Ph.Zrl+nc,yd.InputText);nc++}yd="";this.Zd.Gka?(Nc.AL(Fb),Fb=new Yg(3),yd=this.Zd.b5c?rc.N7c(Object(aa.a)("TellMeOpenFindPaneTextV2Bolded")):Object(aa.a)("TellMeOpenFindPaneTextV2")):yd=Object(aa.a)("TellMeOpenFindPaneText");Xb=this.dul("");this.X9l(Fb,yd,Xb,Ph.GTl,"");Nc.AL(Fb)}$a.kE(Nc)}else yd=
"",Fb&&(Fb=this.dul(na.Fl),Xb=[],this.Zd.Q9c?(this.Zd.rHk&&Xb.push(appChrome.actions.setControlIconSet(Ph.mOb,{"default":"FindInDocument_20"})),yd=this.Zd.Ppj?rc.YNi(na.Fl,Object(aa.a)("FindInDocumentScopedButtonText")):na.Fl+Object(aa.a)("FindInDocumentScopedButtonText")):this.Zd.Gka?(yd=this.Zd.b5c?rc.N7c(String.format(Object(aa.a)("FindInDocumentScopedButtonTextV2Bolded"),na.Fl)):String.format(Object(aa.a)("FindInDocumentScopedButtonTextV2"),na.Fl),Xb.push(appChrome.actions.setControlIconSet(Ph.mOb,
{"default":"FindInDocument_20"}))):yd=this.Zd.bNe?Object(aa.a)("TellMeOpenFindPaneText"):String.format(Object(aa.a)("TextWithQuotation"),na.Fl),this.Zd.vAb?(Rd.instance.actions.push(appChrome.actions.setControlLabel(Ph.mOb,yd)),Rd.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ph.mOb,Fb))):(Xb.push(appChrome.actions.setControlLabel(Ph.mOb,yd)),Xb.push(appChrome.actions.setButtonCommandValueId(Ph.mOb,Fb)),appChrome.api.dispatch(Xb)),this.F2l(yd,Ph.mOb,Fb,na.Fl)),this.Zd.x5l?(yd=new Lg(Ph.mOb,
8,na.Fl),Fb=new Yg(2),Fb.displayName=Object(aa.a)("TellMeFindInDocProviderTitle"),Fb.oP(yd),Nc.AL(Fb),$a.kE(Nc)):this.Zd.ZOm().then(Ud=>{const ie=new Lg(Ph.mOb,8,na.Fl,null,1);ie.count=Ud;Ud=new Yg(2);Ud.displayName=Object(aa.a)("TellMeFindInDocProviderTitle");Ud.oP(ie);Nc.AL(Ud);$a.kE(Nc)},Ud=>{Rd.instance.Jp().onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+Ud);Ud=new Lg(Ph.mOb,8,na.Fl,null,1);const ie=new Yg(2);ie.displayName=Object(aa.a)("TellMeFindInDocProviderTitle");
ie.oP(Ud);Nc.AL(ie);$a.kE(Nc)})}v4l(){return!!this.Zd&&this.Zd.bxh}X9l(na,$a,Fb,Xb,nc=null){const Nc=[];$a&&Nc.push(appChrome.actions.setControlLabel(Xb,$a));this.Zd.Gka&&Nc.push(appChrome.actions.setControlIconSet(Xb,{"default":"FindInDocument_20"}));Nc.push(appChrome.actions.setButtonCommandValueId(Xb,Fb));appChrome.api.dispatch(Nc);this.F2l($a,Xb,Fb,"");na.oP(new Lg(Xb,8,nc,null,1,-99999))}dul(na){return this.Qlm?rc.hrc(na,15,this.tjm):ha.a.Re(na)}F2l(na,$a,Fb,Xb){this.v4l()&&this.aod.length<this.MNh&&
(na=new ck(na,$a,Fb,Xb),Array.add(this.aod,na))}oMn(na){for(let $a=0;$a<this.aod.length;$a++)if(this.aod[$a].CommandId===na){const Fb=this.aod[$a].Label;let Xb=!1;if(0<this.q3c.length){let nc=0;for(const Nc of this.q3c){if(Nc.Label===Fb){Array.removeAt(this.q3c,nc);Xb=!0;break}nc++}}!Xb&&this.q3c.length>=this.MNh-1&&Array.removeAt(this.q3c,1);Array.insert(this.q3c,0,this.aod[$a])}}}Ph.mOb=null;Ph.Zrl=null;Ph.GTl=null;Object(m.a)(Ph,"FindInDocumentResultsProvider",null,[1292]);class qj{constructor(na){this.Zd=
na}zca(){return"Image"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:3===this.Zd.NL?3:2}l8(na,$a,Fb,Xb,nc=null){Fb=new Ng(na);(!nc||Array.contains(nc,19))&&rc.L$(na)&&this.Zd.Gka&&this.K8c(na,Fb,1);$a.kE(Fb)}K8c(na,$a,Fb,Xb=null){var nc=[];let Nc;Rd.instance.wca()&&Rd.instance.wca().Q9c?(Nc=this.Zd.Ppj?rc.YNi(na.Fl,Object(aa.a)("TellMeImageSuggestionScopedButtonTextNoHeader")):na.Fl+Object(aa.a)("TellMeImageSuggestionScopedButtonTextNoHeader"),this.Zd.rHk||nc.push(appChrome.actions.setControlIconSet("ImageForSearch",
{"default":"search_20"}))):Nc=this.Zd.Gka?rc.L$(na)?this.Zd.b5c?rc.N7c(Object(aa.a)("TellMeImageSuggestionButtonTextV2Bolded")):Object(aa.a)("TellMeImageSuggestionButtonTextV2"):this.Zd.b5c?rc.N7c(String.format(Object(aa.a)("TellMeScopedImageSuggestionButtonTextBolded"),na.Fl)):String.format(Object(aa.a)("TellMeScopedImageSuggestionButtonText"),na.Fl):this.Zd.bNe?Object(aa.a)("TellMeImageSuggestionButtonText"):na.Fl+Object(aa.a)("TellMeImageSuggestionScopedButtonTextWithHeader");this.Zd.vAb?(Rd.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",
Nc)),nc=rc.hrc(na.Fl,9,Object.assign(new fd.a,{landingTab:"Image"})),Rd.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",nc))):(nc.push(appChrome.actions.setControlLabel("ImageForSearch",Nc)),na=rc.hrc(na.Fl,9,Object.assign(new fd.a,{landingTab:"Image"})),nc.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",na)),appChrome.api.dispatch(nc));Fb=new Lg("ImageForSearch",12,null,null,Fb);Xb&&(Fb.score=Xb.ConfidenceScore);Xb=new Yg(19,this.Zd.bNe?Object(aa.a)("TellMeImageTitleV2"):
Object(aa.a)("TellMeImageTitle"));Xb.oP(Fb);$a.AL(Xb)}}Object(m.a)(qj,"ImageResultsProvider",null,[1292]);class Ik{constructor(na){this.Zd=na}zca(){return"Insights"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:2}l8(na,$a,Fb=!1,Xb,nc=null){Xb=new Ng(na);if(!nc||Array.contains(nc,13))if(this.OOn()||!rc.L$(na)){nc=new Yg(13);var Nc=""===na.Fl.trim(),yd=Nc?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Ud=new Lg(yd,10,na.Fl,null,1);Fb&&(Fb=null,rc.fmb()?Nc?Nc=Object(aa.a)("SeeMoreOpenSearchPaneLabel"):
(Nc=this.Zd.bNe?Object(aa.a)("SeeMoreResultsButtonTextNonParameteriedV2"):String.format(Object(aa.a)("SeeMoreResultsButtonText"),na.Fl),Fb=rc.hrc(na.Fl,1)):(Nc=String.format(Object(aa.a)("InsightsButtonText"),na.Fl),Fb=rc.Wpi(na.Fl)),this.Zd.vAb?(Rd.instance.actions.push(appChrome.actions.setControlLabel(yd,Nc)),Fb&&Rd.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Fb))):(na=[],na.push(appChrome.actions.setControlLabel(yd,Nc)),Fb&&na.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
Fb)),appChrome.api.dispatch(na)),Ud.label=Nc);nc.oP(Ud);Xb.AL(nc)}$a.kE(Xb)}OOn(){return rc.fmb()&&this.Zd.JTn&&!this.Zd.U9a}}Object(m.a)(Ik,"InsightsResultsProvider",null,[1292]);class kk{constructor(na){this.Zd=na}zca(){return"Learning"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:2}l8(na,$a,Fb,Xb,nc=null){Fb=new Ng(na);nc&&!Array.contains(nc,21)||!rc.L$(na)||(nc=[],Xb=this.Zd.Q8m,nc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Xb)),Xb=kk.iPm(Xb),nc.push(appChrome.actions.setControlLabel("LearningForSearch",
Xb)),appChrome.api.dispatch(nc),na=new Lg("LearningForSearch",22,na.Fl,null,1),nc=new Yg(21),nc.oP(na),Fb.AL(nc));$a.kE(Fb)}static iPm(na){const $a=[];Array.add($a,new Eb(600,Object(aa.a)("TellMeLearningButtonTipText")));Array.add($a,new Eb(400,Object(aa.a)("TellMeLearningButtonText")));Array.add($a,new Eb(600,na));Array.add($a,new Eb(400,Object(aa.a)("TellMeLearningButtonPunctuation")));na={};na.parts=$a;return JSON.stringify(na)}}Object(m.a)(kk,"LearningProvider",null,[1292]);var cj=a(167);class Bk{constructor(na,
$a){this.exe=this.nye=this.G3c=this.B9g=null;this.bF=!1;this.pxe=na;this.Ngm=$a;na&&this.Uql(na)}gzh(){this.pxe.gzh()&&this.Uql(this.pxe)}VTm(na){let $a=[];var Fb=[];na=Bk.$mn(na);var Xb="";Array.clear(Fb);for(let nc=0;nc<na.length;nc++){const Nc=na.charAt(nc);-1!==" ".indexOf(Nc)?(Xb.length&&Array.add(Fb,Xb),Xb=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(Nc)?(Xb.length&&Array.add(Fb,Xb),Xb=Nc,Array.add(Fb,Xb),Xb=""):Xb+=Nc}Xb.length&&Array.add(Fb,Xb);for(na=0;na<Fb.length;na++)Xb=this.RMm(Fb[na]),
Xb=this.Nzm(Xb),$a=Bk.kgn($a,Xb);return $a=this.bpm($a)}Klj(){this.bF||this.gzh();return this.bF}ieh(na){return this.B9g[na.toString()]}bpm(na){for(let $a=0;$a<na.length;$a++){const Fb=this.G3c[$a];if(na[$a].commandId!==this.ieh(Fb[0]))throw Error.create("Incorrect Tcid orders with Priors data");let Xb;(Xb=na[$a]).score=Xb.score+Fb[1]}return na}Nzm(na){const $a=[];for(var Fb=0;Fb<this.G3c.length;Fb++)$a.push(new Jf(this.ieh(this.G3c[Fb][0]),-5));Fb=new cj.a;for(var Xb=0;Xb<na.length;Xb++)Fb.add(this.ieh(na[Xb][0]));
for(Xb=0;Xb<$a.length;Xb++){const Nc=$a[Xb];for(let yd=0;yd<na.length;yd++){var nc=na[yd];const Ud=this.ieh(nc[0]);nc=nc[1];if(Ud===Nc.commandId){Nc.score=nc;Fb.remove(Ud);break}}if(!Fb.count)break}return $a}RMm(na){const $a=1>na.length;for(let yd=0;2>=yd;yd++){const Ud=this.exe;for(const ie in Ud){var Fb=Ud[ie],Xb=na,nc=ie;const Be=nc.length+1,oe=Array((Xb.length+1)*Be);for(var Nc=0;Nc<=Xb.length;Nc++)oe[Nc*Be]=Nc;for(Nc=0;Nc<=nc.length;Nc++)oe[Nc]=Nc;for(Nc=0;Nc<nc.length;Nc++)for(let rf=0;rf<Xb.length;rf++)oe[(rf+
1)*Be+(Nc+1)]=Xb.charAt(rf)===nc.charAt(Nc)?oe[rf*Be+Nc]:Math.min(Math.min(oe[rf*Be+(Nc+1)]+1,oe[(rf+1)*Be+Nc]+1),oe[rf*Be+Nc]+1);Xb=oe[Xb.length*Be+nc.length];if((!Xb||!$a)&&Xb<=yd)return Fb}}return this.nye}Uql(na){this.B9g=na.SQi();this.G3c=na.RRm();this.nye=na.LUm();this.exe=na.TPm();if(this.bF=!!this.B9g&&!!this.G3c&&!!this.exe&&!!this.nye)this.bF=0<this.G3c.length&&Bk.yfj(this.G3c);this.bF&&(this.bF=0<this.nye.length&&Bk.yfj(this.nye));this.bF&&(this.exe=Bk.WUm(this.exe));this.bF||(this.exe=
this.nye=this.G3c=this.B9g=null)}FUm(na){na=this.VTm(na);return this.UIm(na,this.Ngm)}UIm(na,$a){let Fb=[];for(let Xb=0;Xb<na.length;Xb++)na[Xb].score>=$a&&Fb.push(na[Xb]);Fb.sort((Xb,nc)=>Xb.score<nc.score?1:Xb.score>nc.score?-1:0);0<Fb.length-10&&(Fb=Fb.slice(0,10));return Fb}static kgn(na,$a){if(!na.length)return $a;if(na.length!==$a.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Fb=0;Fb<na.length;Fb++){if(na[Fb].commandId!==$a[Fb].commandId)throw Error.create("Incorrect CommandId");
let Xb;(Xb=na[Fb]).score=Xb.score+$a[Fb].score}return na}static $mn(na){return ha.a.mj(na)}static yfj(na){for(let $a=0;$a<na.length;$a++)if(2!==na[$a].length)return!1;return!0}static WUm(na){const $a={};for(const nc in na){var Fb=nc,Xb=na[nc];const Nc=Xb;Nc.length&&Bk.yfj(Nc)&&($a[Fb]=Xb)}return $a}}Object(m.a)(Bk,"NaiveBayesClassifierModel",null,[]);class ul{constructor(na,$a){this.yyb=null;this.Zd=na;this.u2e=new Bk($a,na.zvl);this.Zd.avd&&(this.yyb=null)}zca(){return"NBCommand"}Ksa(){return 0===
this.Zd.NL?0:1===this.Zd.NL?1:2}l8(na,$a,Fb=!1,Xb=sf.fI,nc=null){const Nc=new Ng(na);if((!nc||Array.contains(nc,0))&&!rc.L$(na)){if(yi.mQf(na.Fl)&&(nc=yi.eul(na.Fl),0<nc.results.length)){nc.displayName="Classifier Debug";Nc.AL(nc);$a.kE(Nc);return}if(!this.u2e.Klj()){if(Rd.instance.Jp())Rd.instance.Jp().onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.Zd.avd&&this.yyb&&this.yyb.initialize();nc=
this.u2e.FUm(na.Fl);yi.MFe(nc,!1,"Classifier","NaiveBayesian");nc=yi.QJd(na,nc,this.Zd,this.yyb,null,null,0,1);0<nc.results.length&&Xb!==sf.contextMenu&&(nc.displayName=Object(aa.a)("TellMeCommandProviderTitle"));Fb||nc.results.length||this.Zd.ibc||this.Zd.j7b||(na=new Lg("lookupNoResults",14,na.Fl,null,1),nc.oP(na));0<nc.results.length&&Nc.AL(nc)}$a.kE(Nc)}}Object(m.a)(ul,"NaiveBayesCommandProvider",null,[1292]);class Ug{constructor(){this.Und=null;this.bF=!1;this.gzh()}gzh(){this.bF||(this.Und=
window.NBCRM)&&4===this.Und.length&&(this.bF=!0);return this.bF}RRm(){return this.bF?this.Und[1]:null}LUm(){return this.bF?this.Und[2]:null}TPm(){return this.bF?this.Und[3][0]:null}SQi(){return this.bF?this.Und[0][0]:null}}Object(m.a)(Ug,"NaiveBayesModelAdapter",null,[1576]);var cl=a(36);class Vk{constructor(na){this.Zd=na}zca(){return"OfficeScript"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:2}l8(na,$a){const Fb=new Ng(na);if(!rc.L$(na)){na=cl.d(na.Fl);var Xb=new Yg(28);Xb.displayName=Object(aa.a)("TellMeOfficeScriptsTitle");
Xb=this.Zdl(na,Vk.AWn,"OfficeScriptsUnhideAllRowsCols","samples-11",Object(aa.a)("TellMeUnhideAllRowsColsTitle"),Xb);Xb=this.Zdl(na,Vk.bKm,"OfficeScriptsFreezeSelection","samples-12",Object(aa.a)("TellMeFreezeSelectionTitle"),Xb);Fb.AL(Xb)}$a.kE(Fb)}Zdl(na,$a,Fb,Xb,nc,Nc){const yd=[];for(const Ud of $a)if(cl.a(na,Ud)){this.Zd.vAb?(Rd.instance.actions.push(appChrome.actions.setControlLabel(Fb,nc)),Rd.instance.actions.push(appChrome.actions.setButtonCommandValueId(Fb,Xb))):(yd.push(appChrome.actions.setControlLabel(Fb,
nc)),yd.push(appChrome.actions.setButtonCommandValueId(Fb,Xb)),appChrome.api.dispatch(yd));Nc.oP(new Lg(Fb,28,null,null,1));break}return Nc}}Vk.AWn="unhide row rows col cols column columns".split(" ");Vk.bKm=["freeze","selection","pane","panes"];Object(m.a)(Vk,"OfficeScriptsSamplesProvider",null,[1292]);class Ni{}Ni.Yac="HttpRequest";Ni.provider="Provider";Object(m.a)(Ni,"LatencyTypes",null,[]);var Pi;(function(na){na[na.F0n=0]="Classifier";na[na.x0n=1]="AppsForOffice";na[na.hcm=2]="FindInDocument";
na[na.M0n=3]="FindInDocumentScopedSearch";na[na.n1n=4]="RecentlyUsed";na[na.$dm=5]="TryQuery";na[na.Empty=6]="Empty";na[na.I1n=7]="TryCommand";na[na.fbm=8]="Assistance";na[na.ebm=9]="Answer";na[na.Definition=10]="Definition";na[na.Wbm=11]="Entity";na[na.yem=12]="WolframAnswer";na[na.Acm=13]="Insights";na[na.qdm=14]="People";na[na.Document=15]="Document";na[na.o1n=16]="Recommended";na[na.v1n=17]="ServiceClassifier";na[na.w1n=18]="ServiceRecommended";na[na.Image=19]="Image";na[na.Notes=20]="Notes";
na[na.Mcm=21]="Learning";na[na.Feedback=22]="Feedback";na[na.Xdm=23]="Template";na[na.j2k=24]="ActionAI";na[na.Zam=25]="ActionAICommand";na[na.LCh=26]="SummarizeDeck";na[na.abm=27]="Addin";na[na.ddm=28]="OfficeScript";na[na.bbm=29]="AddinStoreEntry";na[na.None=30]="None";na[na.a1n=31]="MergedActions";na[na.b1n=32]="MergedScopedSearches";na[na.c1n=33]="MergedSuggestedSearches"})(Pi||(Pi={}));Object(m.b)("ResultGroupType",Pi);class Gj{}Gj.fI="TellMe";Gj.$Fl="Loki";Gj.L6l="Substrate";Gj.VKe="QueryIndex";
Gj.j7l="TellMeRanker";Gj.k7l="TellMeRankerLogging";Object(m.a)(Gj,"Services",null,[]);class vk{constructor(na){this.Bla=null;this.ZFa=-1;this.rTj=14;this.vTj=12;this.attributes=this.YVh=this.query=null;this.dFe=!1;this.Ixe=[];this.$m=n.AFrameworkApplication.ye;n.AFrameworkApplication.ga&&(this.rTj=n.AFrameworkApplication.ga.Jc("TellMeMaxTermedResults",this.rTj),this.vTj=n.AFrameworkApplication.ga.Jc("TellMeMaxZeroTermResults",this.vTj));this.Koa=na}get uz(){return this.Ixe}get uzh(){return this.YVh}AL(na){let $a=
!1;for(let Fb=0;Fb<this.uz.length;Fb++)if(30!==this.uz[Fb].groupType&&this.uz[Fb].groupType===na.groupType){this.SZh(this.uz[Fb],na);$a=!0;break}$a||this.uz.push(na)}SZh(na,$a){for(let Fb=0;Fb<$a.results.length;Fb++)na.oP($a.results[Fb])}xYl(na){const $a=[];for(const Fb of this.uz)Fb.groupType!==na&&$a.push(Fb);this.uz.length!==$a.length&&(this.Ixe=$a)}EFn(na){let $a=null,Fb=null,Xb=null;for(let nc=0;nc<na.length;nc++){const Nc=na[nc];if(Nc&&Nc.uz&&Nc.uz.length)for(const yd of Nc.uz)if(17===yd.groupType||
18===yd.groupType)$a=yd;else if(0===yd.groupType||16===yd.groupType)Fb=yd,Xb=Nc}$a&&Fb&&0<Fb.results.length&&(17===$a.groupType&&({YYh:Fb,C_h:$a}=yh.gZh(Fb,$a,this.Koa.wca()?this.Koa.wca().HMm:-.6)),Xb.xYl(Fb.groupType))}zRn(){this.Koa&&(new Fa.a,this.UVg(this.Koa.rLl))}YUf(na,$a){return this.query.Fl.length>this.Koa.wca().YRm&&this.I5m(na,$a)||this.query.Fl.length>this.Koa.wca().ZRm&&this.L6m(na,$a)?!0:!1}L6m(na,$a){return na&&na.length&&$a&&$a.length?-1===$a.toLowerCase().indexOf(na.toLowerCase())?
!1:!0:!1}I5m(na,$a){return na&&na.length&&$a&&$a.length?$a.toLowerCase().startsWith(na.toLowerCase()):!1}WIm(na){const $a=[];for(const Fb of this.Koa.wca().Gka?this.uzh:this.uz)na.contains(Fb.groupType)||$a.push(Fb);this.Koa.wca().Gka?this.YVh=$a:this.Ixe=$a}iYn(na,$a){const Fb=[];for(const Xb of this.uz){const nc=Xb;if(13!==nc.groupType||24!==nc.groupType){const Nc=na[Pi[nc.groupType].toLowerCase()];let yd="False";Nc<$a&&(yd="True");nc.displayName=nc.displayName+" ("+yd+": "+Nc+")"}Fb.push(nc)}this.Ixe=
Fb}UVg(na,$a=!1,Fb=null){if(this.Koa.wca().Gka){if(!$a)for(this.YVh=Array(this.uz.length),$a=0;$a<this.uz.length;$a++)this.uzh[$a]=this.uz[$a];this.Koa.bMl.UVg(this.uz,this.uzh,this.query,na,Fb)}else{for(Fb=new Fa.a;this.uz.length;){$a=this.uz.pop();const Xb=Pi[$a.groupType].toLowerCase(),nc=na[Xb];if(Ya.b(nc))throw Error.create("GroupId "+Xb+" missed from group SortingOrder");Fb.add(new df.a(nc,$a))}Fb.Sc((Xb,nc)=>Xb.key<nc.key?-1:1);for(na=0;na<Fb.count;na++)$a=Fb.ha(na).value,this.uz.push($a)}}ARn(){var na=
!1;let $a=!1,Fb=!1;for(let nc=0;nc<this.uz.length;nc++){var Xb=this.uz[nc];const Nc=Xb.groupType;if(8===Nc||15===Nc||14===Nc){Xb=Xb.results;for(let yd=0;yd<Xb.length;yd++){if(8===Nc&&this.YUf(this.query.Fl,Xb[yd].label)){na=!0;break}if(15===Nc&&this.YUf(this.query.Fl,Xb[yd].label)){$a=!0;break}if(14===Nc){if(this.YUf(this.query.Fl,Xb[yd].label)||this.YUf(this.query.Fl,Xb[yd].description)){Fb=!0;break}const Ud=Xb[yd].label.split(" ");for(const ie of Ud)if(this.YUf(this.query.Fl,ie)){Fb=!0;break}}}}}na=
this.Koa.uSm(na,$a,Fb);this.UVg(na)}cce(na,$a,Fb,Xb,nc,Nc){if(nc===this.Bla){var yd=na.data.responseData;nc=null;try{nc=hb.b(yd)}catch(k){Rd.instance.Jp().onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+k);return}if("RankerResults"in nc&&nc.RankerResults){this.BLb();var Ud=nc.RankerResults,ie=new Fa.a,Be=new Fa.a;yd=0;for(var oe of Ud){Ud=oe.ProviderId;var rf=oe.Score;yd+=rf;ie.add(new df.a(Ud,rf))}ie.Sc((E,S)=>E.value>S.value?-1:1);rf=Nc?Nc.YSm:1E-6;
oe={};Ud={};let k=0;for(var Vf=0;Vf<ie.count;Vf++){const E=parseInt(ie.ha(Vf).key),S=ie.ha(Vf).value/yd;1===E&&(Ud.answer=k++,Ud.entity=k++,Ud.definition=k++,Ud.wolframanswer=k++,S<rf&&(Be.add(9),Be.add(11),Be.add(10),Be.add(12)),oe.answer=S,oe.entity=S,oe.definition=S,oe.wolframanswer=S);2===E&&(Ud.assistance=k++,S<rf&&Be.add(8),oe.assistance=S);3===E&&(Ud.classifier=k++,Ud.serviceclassifier=k++,S<rf&&(Be.add(0),Be.add(17)),oe.classifier=S,oe.serviceclassifier=S);4===E&&(Ud.people=k++,S<rf&&Be.add(14),
oe.people=S);5===E&&(Ud.document=k++,S<rf&&Be.add(15),oe.document=S);6===E&&(Ud.findindocument=k++,S<rf&&Be.add(2),oe.findindocument=S);7===E&&(Ud.notes=k++,S<rf&&Be.add(20),oe.notes=S);8===E&&(Ud.image=k++,S<rf&&Be.add(19),oe.image=S)}ie=new Fa.a;ie.add("classifier");ie.add("serviceclassifier");ie.add("appsforoffice");ie.add("addin");ie.add("findindocument");ie.add("assistance");ie.add("document");ie.add("people");ie.add("answer");ie.add("wolframanswer");ie.add("definition");ie.add("entity");ie.add("image");
ie.add("template");ie.add("officescript");for(Vf=0;Vf<ie.count;Vf++)ie.ha(Vf)in Ud||(Ud[ie.ha(Vf)]=k++);Ud.learning=k++;Ud.insights=k++;Ud.actionai=k++;Ud.actionaicommand=k++;Ud.feedback=k++;Nc&&Nc.g5m&&this.iYn(oe,rf);Nc&&Nc.h5m&&this.WIm(Be);Be={};for(var xg in oe)Be[xg]=oe[xg]*yd;this.UVg(Ud,!0,Be)}if(Nc.jlh&&"Intents"in nc&&nc.Intents){xg=nc.Intents;for(var qh of xg)if(this.drj(qh)&&"Serplet"===qh.GroupType&&qh.ConfidenceScore>qh.ConfidenceThreshold){xg=!1;nc=0;if(Nc.epj){yd=new Lg("",32);for(Be=
0;Be<this.uz.length;Be++)if((ie=this.uz[Be].results)&&0<ie.length){nc=Be;yd=ie[0];break}2===yd.groupType&&(xg=!0)}yd=new Yg(13);xg&&Nc.epj&&(yd=new Yg(13,Object(aa.a)("TellMeWebTitle")));Be=new Lg("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Fl,null,0);ie=[];oe=null;oe=rc.fmb()?rc.hrc(this.query.Fl,1):rc.Wpi(this.query.Fl);ie.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",oe));oe=String.format(Object(aa.a)("SeeMoreResultsButtonTextAtTop"),this.query.Fl);
ie.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",oe));appChrome.api.dispatch(ie);yd.oP(Be);Be=[];if(xg&&Nc.epj)for(Be.push(this.uz[nc]),Be.push(yd),xg=nc+1;xg<this.uz.length;xg++)(nc=this.uz[xg].results)&&0<nc.length&&Be.push(this.uz[xg]);else for(Be.push(yd),xg=0;xg<this.uz.length;xg++)(nc=this.uz[xg].results)&&0<nc.length&&Be.push(this.uz[xg]);this.Ixe=Be}}if(Nc.tVf&&!Nc.Gka){qh=xg=-1;for(nc=0;nc<this.uz.length;nc++)switch(this.uz[nc].groupType){case 23:xg=nc;break;
case 0:case 17:case 2:-1===qh&&(qh=nc)}if(-1!==xg){qh=-1===qh?0:xg>qh?qh+1:qh;xg=this.uz[xg];nc=Array(this.uz.length);yd=0;for(Be=0;Be<nc.length;Be++)Be===qh?nc[Be]=xg:(23===this.uz[yd].groupType&&yd++,nc[Be]=this.uz[yd],yd++);this.Ixe=nc}}Xb.kE(this);Xb=Rd.instance.Jp();Xb.abb($a.length,"RankerInference",na.data.Ze.toString(),Math.round(window.performance.now()-Fb),Gj.j7l,!0,Ni.Yac);this.dFe&&Xb&&(na=this.query.cdd,$a=Xb.V7g,Nc.slh&&na>$a&&!Nc.Gka&&(Xb.Wyj(this.query.Fl),Xb.Bzk(na)))}}drj(na){if("GroupType"in
na&&na.GroupType&&"ConfidenceScore"in na&&"ConfidenceThreshold"in na)return!0;Rd.instance.Jp().onError("IsValidIntentGroup","Invalid intents found");return!1}Wae(na,$a,Fb,Xb,nc){Xb===this.Bla&&(this.BLb(),Rd.instance.Jp().abb($a.length,"RankerInference",na.data.Ze.toString(),Math.round(window.performance.now()-Fb),Gj.j7l,!1,Ni.Yac));nc.kE(this)}BLb(){-1!==this.ZFa&&(window.clearTimeout(this.ZFa),this.ZFa=-1)}BRn(na){let $a;$a=this.Koa.wca().Gka?Rd.instance.Jp().eXi(this.uzh,this.query.Fl):Rd.instance.Jp().eXi(this.uz,
this.query.Fl);var Fb=this.Koa.wca().XSm;""!==Fb&&(Fb="_"+Fb);let Xb="";this.Koa.wca().Jlj&&(Xb="RankerInference"+Fb+",");this.Koa.wca().jlh&&(Xb+="SerpletClassifier");","===Xb.charAt(Xb.length-1)&&(Xb=Xb.substring(0,Xb.length-1));Fb=Rd.instance.Jp().$wl(Xb);const nc=this.Bla=ca.a.create().toString();Fb["Client-Request-Id"]=nc;const Nc=window.performance.now(),yd=this.Koa.wca()?this.Koa.wca().ZSm:600;this.BLb();this.ZFa=window.setTimeout(()=>{if(nc===this.Bla){this.Bla="";this.ZFa=-1;na.kE(this);
const Ud={};Ud[Ye.provider]="Ranker";Ud[Ye.queryId]=this.query.cdd;Rd.instance.Jp().Zca(Yd.timedOut,yd,Ud)}},yd);this.$m.rk(Rd.instance.Jp().axl(),2,$a,Fb,!1,0,Ud=>{this.cce(Ud,this.query.Fl,Nc,na,nc,this.Koa.wca())},Ud=>{this.Wae(Ud,this.query.Fl,Nc,nc,na)},null,null,!1,4E3,6E3)}IVn(){var na=0,$a=new Fa.a,Fb=this.Koa.pLl,Xb=this.Koa.qLl;for(var nc=0;nc<this.uz.length;nc++){var Nc=this.uz[nc],yd=Pi[Nc.groupType].toLowerCase(),Ud=Fb[yd];na+=Nc.results.length;Nc.results.length>Ud&&(yd=Xb[yd],Ya.b(yd)||
$a.add(new df.a(yd,Nc)))}Xb=!this.query||""===this.query.Fl.trim();nc=na-(Xb?this.vTj:this.rTj);if(!(0>=nc)){Xb=window.performance.now();na=na.toString()+" total,"+nc.toString()+" to remove.";if(0<$a.count)for($a.Sc((ie,Be)=>ie.key>Be.key?-1:1),Nc=0;Nc<$a.count&&0<nc;Nc++){yd=$a.ha(Nc).value;Ud=Pi[yd.groupType].toLowerCase();let ie=yd.results.length-Fb[Ud];ie>nc&&(ie=nc);0<ie&&(yd.Nnk(ie),na+=Ud+": "+ie.toString()+" results removed.",nc-=ie)}if(0<nc){na+=nc.toString()+" results left after trimming.";
$a=new Fa.a;Fb=this.Koa.uLl;for(Nc=0;Nc<this.uz.length;Nc++)yd=this.uz[Nc],Ud=Fb[Pi[yd.groupType].toLowerCase()],Ya.b(Ud)||$a.add(new df.a(Ud,yd));$a.Sc((ie,Be)=>ie.key<Be.key?-1:1);for(Fb=0;0<nc;)Nc=$a.ha(Fb++).value,nc>=Nc.results.length?(Array.remove(this.uz,Nc),na+=Pi[Nc.groupType]+": "+Nc.results.length.toString()+" results force removed.",nc-=Nc.results.length):(Nc.Nnk(nc),na+=Pi[Nc.groupType]+": "+nc.toString()+" results force removed.",nc=0)}Rd.instance.Jp()&&($a={},$a[Ye.message]=na,Rd.instance.Jp().Zca("ShowOptimal",
window.performance.now()-Xb,$a))}}}Object(m.a)(vk,"CombineResultsUpdatedEventArgs",null,[1514]);class Qi{constructor(na,$a,Fb,Xb=!1,nc=""){this.ZPh=this.NRh=!1;this.BZ=na;this.Xpd=[];this.Bal=$a.length;this.Zd=Rd.instance.wca();this.d9g=Xb;this.d4c=nc;this.dye={};for(na=0;na<$a.length;++na)this.dye[na.toString()]=Fb?0:$a[na].Ksa()}IMn(na,$a){$a&&$a.query&&$a.query.cdd<Rd.instance.feh()||(this.Xpd[na]=$a,this.ZPh?this.NRh=!0:(!this.Zd||3!==this.Zd.NL||3!==this.dye[na.toString()]||this.pol())&&this.AEe())}Kun(){this.ZPh=
!0}DWn(){this.ZPh=!1;this.NRh&&(this.NRh=!1,this.AEe())}pol(){if(this.Xpd.length<this.Bal)return!1;for(let na=0;na<this.Bal;++na)if(!this.Xpd[na])return!1;return!0}AEe(){var na=this.pol();const $a=window.performance.now(),Fb=new vk(Rd.instance.tOi());Fb.EFn(this.Xpd);for(var Xb=0;Xb<this.Xpd.length;++Xb){var nc=this.Xpd[Xb];if(nc&&nc.uz&&nc.uz.length&&(Fb.query=nc.query,nc.attributes&&0<nc.attributes.length&&(Fb.attributes=nc.attributes),nc&&nc.uz&&(na||this.kxm(Xb,this.Xpd))))for(const Nc of nc.uz)Fb.AL(Nc)}Fb.uz&&
Fb.uz.length&&(Fb.dFe=na,this.Zd&&this.Zd.lTk&&Fb.IVn(),this.Zd&&this.Zd.W5m&&Fb.query.Fl&&0<Fb.query.Fl.length?Fb.ARn():Fb.zRn(),this.Zd&&(this.Zd.Jlj||this.Zd.jlh)&&this.d9g&&Fb.query.Fl&&0<Fb.query.Fl.length&&Fb.dFe&&this.d4c!==sf.contextMenu?(3===this.Zd.NL&&na||this.BZ.kE(Fb),Fb.BRn(this.BZ)):this.BZ.kE(Fb),na=Rd.instance.Jp(),Fb.dFe&&na&&(Xb=Fb.query.cdd,nc=na.V7g,Fb.query.Fl&&0<Fb.query.Fl.length&&this.d9g&&this.Zd.slh&&this.d4c!==sf.contextMenu&&Xb>nc&&!this.Zd.Jlj&&!this.Zd.Gka&&(na.Wyj(Fb.query.Fl),
na.Bzk(Xb)),na.Zca(Yd.hIn,window.performance.now()-$a)))}kxm(na,$a){if(!(this.dye&&na.toString()in this.dye)||$a.length<=na||!$a[na])return!1;if(!$a[na].uz.length)return!0;const Fb=this.dye[na.toString()];if(0===Fb)return!0;const Xb=this.dye;for(const Nc in Xb){var nc=Xb[Nc];const yd=Number.parseInvariant(Nc);if(yd!==na&&nc===Fb&&!($a.length>yd&&$a[yd]))return!1}return!0}}Object(m.a)(Qi,"ResultsAggregator",null,[]);var Hj=a(886);class mj{constructor(na,$a,Fb,Xb,nc,Nc){this.lastModified=this.size=
this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=na;this.url=$a;this.spWebUrl=Fb;this.uniqueId=Xb;this.size=nc;this.lastModified=Nc}}Object(m.a)(mj,"FileInfo",null,[]);class Xj{constructor(na,$a){this.DimensionValue=this.DimensionName=null;this.DimensionName=na;this.DimensionValue=$a}}Object(m.a)(Xj,"Dimension",null,[]);class $h{constructor(na,$a,Fb,Xb,nc){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=na;this.Query=$a;this.From=Fb;this.Size=
Xb;nc&&(this.Filter=nc)}}Object(m.a)($h,"EntityRequest",null,[]);class tf{constructor(na){this.QueryString=null;this.QueryString=na}}Object(m.a)(tf,"Query",null,[]);class yj{constructor(na,$a){this.Dimensions=this.Name=null;this.Name=na;this.Dimensions=$a}}Object(m.a)(yj,"Scenario",null,[]);class vj{constructor(na,$a,Fb,Xb){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=na;this.TimeZone=$a;this.Cvid=Fb;this.Scenario=Xb}}Object(m.a)(vj,"SubstrateBody",null,[]);var jl=
a(1071),ri=a(1070);class Wk{constructor(na){this.k3e=this.M3c=this.F9g=this.wXe=this.V3e=0;this.q$k=this.dal=this.Bla=null;this.UMh=0;this.ZFa=-1;this.g7e="";this.nJh=!1;this.$m=n.AFrameworkApplication.ye;this.Zd=na;this.L$g=this.hXi();this.tqd=new Hj.a;this.J9k=this.Zd.lTk?3:2;this.VUh=this.Zd.lTk&&this.Zd.$4l?5:3;this.WWh=this.Zd.bxh?2:3;this.sdl=1;this.t9g=this.Zd.Ivl;this.acl=this.Zd.G6m;this.b5e=na.Iwl;n.AFrameworkApplication.ga&&(this.dal=n.AFrameworkApplication.ga.La("AppCatalogUrl")+n.AFrameworkApplication.ga.La("SearchPersonaPhotoBaseUrl"),
this.nJh=this.Zd.gfh||this.Zd.U9a||this.Zd.kfh);this.Zd.U9a&&(this.WWh=this.VUh=5)}zca(){return"Substrate"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:3}l8(na,$a,Fb,Xb=sf.fI,nc=null){const Nc=new Ng(na);if(!nc||Array.contains(nc,14)||Array.contains(nc,15)||Array.contains(nc,20))if(!this.UMh||window.performance.now()-this.UMh>=rc.Lyh)if(Fb=this.tqd.WCe())this.UMh=window.performance.now(),Fb.then(yd=>{yd&&""!==yd?(this.g7e=yd,""!==this.Bla&&this.Qwl(na,Xb,this.g7e,$a,nc)):(Rd.instance.Jp().onError("SubstrateResultsProvider:IssueQuery",
"Empty or null token returned"),$a.kE(Nc))},yd=>{Rd.instance.Jp().onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+yd);$a.kE(Nc)});else{if(Rd.instance.Jp())Rd.instance.Jp().onError("SubstrateResultsProvider:IssueQuery","undefined token promise");$a.kE(Nc)}else this.g7e&&""!==this.g7e?this.Qwl(na,Xb,this.g7e,$a,nc):($a.kE(Nc),Rd.instance.Jp().onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else $a.kE(Nc)}j_(){this.M3c=this.k3e=this.F9g=this.wXe=
this.V3e=0}Qwl(na,$a,Fb,Xb,nc){this.j_();const Nc=new Ng(na),yd=this.Bla=ca.a.create().toString();this.BLb();this.ZFa=window.setTimeout(()=>{if(yd===this.Bla){this.Bla="";this.ZFa=-1;Xb.kE(Nc);const Be={};Be[Ye.provider]=this.zca();Be[Ye.queryId]=na.cdd;Rd.instance.Jp().Zca(Yd.timedOut,this.b5e,Be)}},this.b5e);const Ud={"Content-Type":"application/json",Accept:"application/json"};Ud.Authorization="Bearer "+Fb;Ud["X-Office-Version"]=n.AFrameworkApplication.buildVersion;Ud["X-Office-Application"]=n.AFrameworkApplication.ga.La("Application");
Ud["X-Office-Platform"]="WAC";Ud["X-TellMe-SessionId"]=Rd.instance.ZCe();Ud["X-TellMe-Culture"]=n.AFrameworkApplication.uiCulture;Ud["X-TellMe-ProcessSessionId"]=n.AFrameworkApplication.userSessionId;Ud["Client-Request-Id"]=yd;const ie=window.performance.now();this.$m.rk(this.PTm(),2,this.QTm(na.Fl,this.Zd.application,Rd.instance.ZCe(),rc.L$(na)),Ud,!1,0,Be=>{this.cce(Be,na,Xb,yd,ie,$a,nc)},Be=>{this.Wae(Be,na,Xb,yd,ie)},null,null,!1,4E3,6E3)}BLb(){-1!==this.ZFa&&(window.clearTimeout(this.ZFa),this.ZFa=
-1)}cce(na,$a,Fb,Xb,nc,Nc,yd){Rd.instance.Jp().abb($a.Fl.length,this.L$g.join(","),na.data.Ze.toString(),Math.round(window.performance.now()-nc),Gj.L6l,!0,Ni.Yac);const Ud=rc.L$($a),ie=new Ng($a);if(Xb===this.Bla){this.BLb();na=hb.b(na.data.responseData);if(na.Groups){na=na.Groups;for(const Be of na)"People"===Be.Type&&this.Zd.gZg&&(yd?Array.contains(yd,14):1)?(na=this.Uvl(Be.Suggestions,Ud,Nc),0<na.results.length&&ie.AL(na)):"File"===Be.Type&&this.Zd.fZg&&(yd?Array.contains(yd,15):1)?(na=this.ENi(Be.Suggestions,
Ud,Nc),0<na.results.length&&(this.Ekh()&&(Xb=new Lg("GenerateSlidesFromTellMe",30,"",null,1),na.oP(Xb)),ie.AL(na))):"Notes"===Be.Type&&this.Zd.R9c&&Nc!==sf.contextMenu&&(yd?Array.contains(yd,20):1)&&(na=this.Gvl(Be.Suggestions,Ud,$a),0<na.results.length&&ie.AL(na))}Fb.kE(ie);Rd.instance.Jp().abb($a.Fl.length,this.L$g.join(","),"",Math.round(window.performance.now()-nc),"",!0,Ni.provider)}else Fb.kE(ie)}Gvl(na,$a,Fb){const Xb=new Yg(20);Xb.displayName=Object(aa.a)("TellMeNotesProviderTitle");for(const nc of na)this.s7m(nc)&&
(na=nc.NotesType,na=ha.a.mj(na),na=this.SQm(na,nc.LastModifiedTime,nc.BodyPreview,nc.Subject,$a,Fb,nc))&&(na.groupType=20,Xb.oP(na));return Xb}Uvl(na,$a,Fb){const Xb=new Yg(14);Xb.displayName=Object(aa.a)("TellMePeopleProviderTitle");for(const Nc of na)if(this.t7m(Nc)){var nc=Nc.Id.split("@")[0];na=Nc.EmailAddresses[0];let yd=Nc.Type;if(void 0===yd||null===yd)yd="User";if(nc=this.zRm(yd,Nc.DisplayName,Nc.JobTitle,na,nc,Fb,$a))nc.description=na,na=Nc.JobTitle,"Department"in Nc&&"CompanyName"in Nc&&
(na+="@"+Nc.Department+"@"+Nc.CompanyName),nc.additionalInfo=na,Xb.oP(nc)}return Xb}ENi(na,$a,Fb){const Xb=new Yg(15);Xb.displayName=Object(aa.a)("TellMeFileProviderTitle");for(const Be of na)if(this.p7m(Be)){var nc=Be.FileName;na=Be.FileExtension;var Nc=nc;nc.length>na.length&&Nc.endsWith(na)&&(Nc=nc.substr(0,nc.length-na.length-1));var yd=void 0,Ud=0;"DateCreated"in Be&&Be.DateCreated?(Ud=rc.tYi(Be.DateCreated),yd=rc.hxl(Be.DateCreated),yd=String.format(Object(aa.a)("CreatedTimeFormatString"),Be.Author,
yd)):yd=Be.Author;var ie=Be.AccessUrl+"?web=1";const oe=ha.a.ODe(ie);nc=String.format('<a href="{0}">{1}</a>',oe,ha.a.Zyc(nc));if(Fb!==sf.contextMenu||ha.a.P$(ie))if(Nc=this.TOm(Nc,Fb===sf.contextMenu?nc:ie,yd,Be.FileExtension,Be.Text,$a))Nc.description=Be.Author,Nc.qbh=Ud,Xb.oP(Nc),this.nJh&&(Ud=Be.AccessUrl,nc=rc.phh(na),yd=Be.DateModified?Be.DateModified:Be.DateCreated,ie=Be.Size?Be.Size:Be.FileSize,this.xOn()&&(Ud=Ud.replace(RegExp("%20","g")," "),nc=rc.wTm(na)),na=new mj(nc,Ud,Be.SPWebUrl,Be.Id,
ie,yd),Rd.instance.Q2g(!1,Nc.value,na))}return Xb}Wae(na,$a,Fb,Xb,nc){Xb===this.Bla&&(this.BLb(),Rd.instance.Jp().abb($a.Fl.length,this.L$g.join(","),na.data.Ze.toString(),Math.round(window.performance.now()-nc),Gj.L6l,!1,Ni.Yac));na=new Ng($a);Fb.kE(na)}zRm(na,$a,Fb,Xb,nc,Nc,yd){yd=yd?this.sdl:this.J9k;if(!window.LPC&&!rc.Khj()||this.V3e===yd)return null;this.V3e+=1;yd="PeopleSuggestion"+this.V3e.toString();var Ud=this.dal+"?size=1&accountName="+Xb;na=Object.assign(new jl.a,{PersonaType:na,Smtp:Xb,
ProfilePictureUrl:Ud,AadObjectId:nc});const ie=Object.assign(new ri.a,{identifiers:na,displayName:$a});na=Nc===sf.contextMenu;this.Zd.vAb?(Rd.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(yd,ie,$a,Fb)),Nc===sf.contextMenu&&(Fb=rc.Xml($a,Xb,nc),Rd.instance.actions.push(appChrome.actions.setButtonCommandValueId(yd,Fb))),Rd.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(yd,na))):(Ud=[],Ud.push(appChrome.actions.setPersonaButtonCoauthor(yd,ie,$a,
Fb)),Nc===sf.contextMenu&&(Fb=rc.Xml($a,Xb,nc),Ud.push(appChrome.actions.setButtonCommandValueId(yd,Fb))),Ud.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(yd,na)),appChrome.api.dispatch(Ud));return new Lg(yd,11,$a,Xb,0)}SQm(na,$a,Fb,Xb,nc,Nc,yd){if(nc&&!this.Zd.ZDl||this.F9g===this.t9g||this.k3e===this.t9g||this.M3c===this.t9g)return null;var Ud=null;this.F9g+=1;nc="";const ie=[],Be={};yd.type="Notes";this.q$k=Object.assign(new fd.a,{landingTab:"Notes",data:yd});Nc=rc.hrc(Nc.Fl,
33,this.q$k);if("onenotepagepreviews"===na){if(!("ClickthroughUrl"in yd&&yd.ClickthroughUrl)||""===yd.ClickthroughUrl)return null;this.k3e+=1;nc="OnenoteNotesSuggestion"+this.k3e.toString();Be["default"]="SaveAsonetoc2_20";Ud=yd.ClickthroughUrl;ie.push(appChrome.actions.setControlIconSet(nc,Be));ie.push(appChrome.actions.setCompoundButtonCommandValueId(nc,Ud));Ud=new Lg(nc,19,null,null,0)}else if("stickynote"===na){if(!this.acl)return null;this.M3c+=1;nc="NotesSuggestion"+this.M3c.toString();Be["default"]=
"ShowAllNotes_20";ie.push(appChrome.actions.setControlIconSet(nc,Be));ie.push(appChrome.actions.setCompoundButtonCommandValueId(nc,Nc));Ud=new Lg(nc,21,null,null,0)}else if("samsung"===na){if(!this.acl)return null;this.M3c+=1;nc="NotesSuggestion"+this.M3c.toString();Be["default"]="CategoryCollapsed_20";ie.push(appChrome.actions.setControlIconSet(nc,Be));ie.push(appChrome.actions.setCompoundButtonCommandValueId(nc,Nc));Ud=new Lg(nc,20,null,null,0)}""!==nc&&(na=rc.hxl($a),na=String.format(Object(aa.a)("LastModifiedString"),
na),Ud.label=Xb,Ud.qbh=rc.tYi($a),ie.push(appChrome.actions.setControlLabel(nc,Xb)),ie.push(appChrome.actions.updateCompoundButtonDescription(nc,na)),ie.push(appChrome.actions.setControlCustomTooltip(nc,Fb)),appChrome.api.dispatch(ie));return Ud}TOm(na,$a,Fb,Xb,nc,Nc){if(this.wXe===(Nc?this.WWh:this.VUh)||this.nJh&&"Word"!==rc.phh(Xb))return null;this.wXe+=1;Nc="FileSuggestion"+this.wXe.toString();const yd=[],Ud={};Ud["default"]=rc.yPm(Xb);this.Zd.vAb?(Rd.instance.actions.push(appChrome.actions.setControlLabel(Nc,
na)),Rd.instance.actions.push(appChrome.actions.setControlIconSet(Nc,Ud)),Rd.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Nc,Fb)),Rd.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Nc,$a)),Rd.instance.actions.push(appChrome.actions.setControlCustomTooltip(Nc,nc))):(yd.push(appChrome.actions.setControlLabel(Nc,na)),yd.push(appChrome.actions.setControlIconSet(Nc,Ud)),yd.push(appChrome.actions.updateCompoundButtonDescription(Nc,Fb)),yd.push(appChrome.actions.setCompoundButtonCommandValueId(Nc,
$a)),yd.push(appChrome.actions.setControlCustomTooltip(Nc,nc)),appChrome.api.dispatch(yd));return new Lg(Nc,6,na,Fb,0)}hXi(){const na=[];this.Zd.gZg&&Array.add(na,"People");this.Zd.fZg&&Array.add(na,"File");this.Zd.R9c&&Array.add(na,"Notes");return na}QTm(na,$a,Fb,Xb){var nc=new tf(na);na=new $h("File",nc,0,Xb?this.WWh:this.VUh,null);Xb=new $h("People",nc,0,Xb?this.sdl:this.J9k,rc.Tun);nc=new $h("Notes",nc,0,this.t9g,null);(this.Zd.gfh||this.Zd.kfh)&&"powerpoint"===$a.toLowerCase()&&($a="word");$a=
new Xj("app",$a.toLowerCase());var Nc=[];Array.add(Nc,$a);$a=new yj("tellmesearch",Nc);Nc=[];this.Zd.fZg&&Array.add(Nc,na);this.Zd.gZg&&Array.add(Nc,Xb);this.Zd.R9c&&Array.add(Nc,nc);Fb=new vj(Nc,"UTC",Fb,$a);return hb.c(Fb)}PTm(){let na=this.Zd.$Sn;this.Zd.R9c&&(na+="?&setflight=NotesFrom3S");""!==this.Zd.Rwl&&(na=na+"&"+this.Zd.Rwl);return na}t7m(na){return"DisplayName"in na&&"Id"in na&&"EmailAddresses"in na&&!!na.Id&&!!na.EmailAddresses}p7m(na){return"FileExtension"in na&&!!na.FileExtension&&"FileName"in
na&&!!na.FileName&&""!==na.FileName&&"AccessUrl"in na&&!!na.AccessUrl&&""!==na.AccessUrl}s7m(na){return"Id"in na&&!!na.Id&&"NotesType"in na&&!!na.NotesType&&"Subject"in na&&!!na.Subject&&""!==na.Subject}Ekh(){return!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}xOn(){return!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",
!0)}}Object(m.a)(Wk,"SubstrateResultsProvider",null,[1292]);class kl{constructor(){this.lOe=this.mOe=this.kOe=this.sYf=this.QFe=this.zEe=0}jom(na,$a){switch(na){case 1:this.zEe=$a;break;case 3:this.QFe=$a;break;case 2:this.sYf=$a;break;case 5:this.kOe=$a;break;case 4:this.mOe=$a;break;case 6:this.lOe=$a}}}Object(m.a)(kl,"CommandFeatures",null,[]);class tj{constructor(na){this.H6k=0;this.iHb=na;this.mgm={}}get modelId(){return this.iHb}get yIm(){return this.H6k}get Ujf(){return this.mgm}Unm(na,$a,
Fb){0===$a?this.H6k=Fb:(this.Ujf[na]||(this.Ujf[na]=new kl),this.Ujf[na].jom($a,Fb))}}Object(m.a)(tj,"CoefficientsModel",null,[]);const Mk=(na,$a)=>Math.pow(10,-$a/(60*Math.LN10/Math.LN2*na));class hj{constructor(na,$a){this.clm=na;this.wq=1;this.akd=new kl;this.features.sYf=1+Math.log(this.count)/Math.LN2;this.features.zEe=na?1/na:0;this.features.QFe=2/Math.pow(2,na);this.features.kOe=Mk(10,$a);this.features.mOe=Mk(2,$a);this.features.lOe=Mk(1,$a)}get rank(){return this.clm}get count(){return this.wq}get features(){return this.akd}S0m(){this.wq=
this.count+1;this.features.sYf=1+Math.log(this.count)/Math.LN2}gYn(na){const $a=2/Math.pow(2,na);this.features.zEe=Math.max(this.features.zEe,na?1/na:0);this.features.QFe=Math.max(this.features.QFe,$a)}CYn(na){const $a=Mk(10,na),Fb=Mk(2,na);na=Mk(1,na);this.features.kOe=Math.max(this.features.kOe,$a);this.features.mOe=Math.max(this.features.mOe,Fb);this.features.lOe=Math.max(this.features.lOe,na)}}Object(m.a)(hj,"CommandModel",null,[]);class ll{constructor(na){this.ZUe=null;if(!na&&Rd.instance.Jp())Rd.instance.Jp().onError("PredictionEngine",
"IModelAdapter can't be null");this.pxe=na;this.A9g=this.Euj()}Euj(){const na=this.pxe.AQm(),$a=this.pxe.SQi();if(void 0===na||null===na||void 0===$a||null===$a)return!1;try{window.performance.now();this.ZUe={};for(let Fb=0;Fb<na.length;Fb++){const Xb=na[Fb],nc=$a[Xb[0].toString()].trim(),Nc=Xb[1],yd=0!==Nc?$a[Xb[2].toString()].trim():"",Ud=Xb[3];nc in this.ZUe||(this.ZUe[nc]=new tj(nc));this.ZUe[nc].Unm(yd,Nc,Ud)}}catch(Fb){if(Rd.instance.Jp())Rd.instance.Jp().onError("LoadModelData","Error Loading Suggestions Model: "+
Fb);return!1}return!0}UKm(){const na=this.pxe.FPm(),$a={};if(!na)return $a;let Fb=1;for(let Xb=0;Xb<na.length;Xb++){const nc=na[Xb];nc.Id in $a?($a[nc.Id].S0m(),$a[nc.Id].gYn(Fb),$a[nc.Id].CYn(nc.TimeElapsedSinceClick)):$a[nc.Id]=new hj(Fb,nc.TimeElapsedSinceClick);Fb++}return $a}Klj(){this.A9g||(this.A9g=this.Euj());return this.A9g}IRm(){let na=[];if(!this.A9g){if(Rd.instance.Jp())Rd.instance.Jp().onError("GetPredictedCommands","IModelAdapter returned no data");return na}const $a=this.UKm(),Fb=this.ZUe;
for(const nc in Fb){const Nc=Fb[nc],yd=Nc.modelId;let Ud=0;for(const ie in $a){var Xb=ie;const Be=$a[ie].features;(Xb=Xb in Nc.Ujf?Nc.Ujf[Xb]:null)&&(Ud+=Be.zEe*Xb.zEe+Be.QFe*Xb.QFe+Be.sYf*Xb.sYf+Be.kOe*Xb.kOe+Be.mOe*Xb.mOe+Be.lOe*Xb.lOe)}Ud+=Nc.yIm;na.push(new Jf(yd,Ud))}na.sort((nc,Nc)=>nc.score<Nc.score?1:nc.score>Nc.score?-1:0);0<na.length-10&&(na=na.slice(0,10));return na}}Object(m.a)(ll,"PredictionEngine",null,[]);class ml{constructor(){this.Cbl={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}$gh(na,$a){return $a&&"word"===$a.application.toLowerCase()&&
na in this.Cbl?this.Cbl[na]:[]}}Object(m.a)(ml,"SuggestionResultsUtility",null,[]);class Cj{constructor(na,$a,Fb){this.Zd=$a;this.u2e=new ll(na);this.jHb=Fb;this.ocl=new ml}zca(){return"Suggestion"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:2}l8(na,$a,Fb,Xb=sf.fI,nc=null){Fb=new Ng(na);Rd.instance.u1c=!1;if((!nc||Array.contains(nc,16))&&rc.L$(na)){if(!this.u2e.Klj()){if(Rd.instance.Jp())Rd.instance.Jp().onError("CRASH","SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");
}Date.now();if(this.Woj()&&0<this.ocl.$gh(Rd.instance.Eof,this.Zd).length){const yd=this.ocl.$gh(Rd.instance.Eof,this.Zd);nc=[];for(var Nc of yd)this.Zd.bxh&&"Find"===Nc||nc.push(new Jf(Nc,0));Rd.instance.u1c=!0}else nc=this.u2e.IRm();yh.MFe(nc,!0,"Recommended","LRE");Nc=[];for(const yd of nc)this.jHb&&this.jHb.Okf(yd.commandId)||Nc.push(yd);na=yh.QJd(na,Nc,this.Zd,null,null,null,16,1);0<na.results.length&&Xb!==sf.contextMenu&&(na.displayName=Object(aa.a)("TellMeTryCommandTitle"));0<na.results.length&&
Fb.AL(na)}$a.kE(Fb)}Woj(){return!!this.Zd&&(this.Zd.Woj||this.Zd.J7m)}}Object(m.a)(Cj,"SuggestionResultsProvider",null,[1292]);class dj{FPm(){return Rd.instance.Zgh()}AQm(){return window.TellMeSuggestionModel}SQi(){return window.CoefficientModelIdMap}}Object(m.a)(dj,"SuggestionsModelAdapter",null,[1575]);class Rg{constructor(na){this.Zd=na;this.L$g=this.hXi()}zca(){return"Add-ins"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:3}l8(na,$a){na=new Ng(na);$a.kE(na)}K8c(na,$a,Fb){let Xb;Xb=this.Zd.Gka?
new Yg(29):new Yg(27);Xb.displayName=Object(aa.a)("TellMeAddinProviderTitle");Fb&&this.FQn(na.Fl,$a,Xb)}FQn(na,$a,Fb){const Xb=[];let nc;nc=this.Zd.r3m?this.Zd.Gka&&this.Zd.b5c?rc.N7c(String.format(Object(aa.a)("TellMeLaunchAddinDialogButtonText_1_Bolded"),na)):String.format(Object(aa.a)("TellMeLaunchAddinDialogButtonText_1"),na):this.Zd.s3m?this.Zd.Gka&&this.Zd.b5c?rc.N7c(String.format(Object(aa.a)("TellMeLaunchAddinDialogButtonText_2_Bolded"),na)):String.format(Object(aa.a)("TellMeLaunchAddinDialogButtonText_2"),
na):this.Zd.Gka&&this.Zd.b5c?rc.N7c(String.format(Object(aa.a)("TellMeLaunchAddinDialogButtonText_0_Bolded"),na)):String.format(Object(aa.a)("TellMeLaunchAddinDialogButtonText_0"),na);this.Zd.vAb?(Rd.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",nc)),Rd.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",na))):(Xb.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",nc)),Xb.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",
na)),appChrome.api.dispatch(Xb));Fb.oP(new Lg("LaunchAddinDialogFromTellMe",29));$a.AL(Fb)}hXi(){const na=[];this.Zd.gkh&&Array.add(na,"Addin");return na}}Object(m.a)(Rg,"AddinStoreResultsProvider",null,[1292]);class Ri{constructor(na){this.Zd=na}zca(){return"Template"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:3}l8(na,$a){na=new Ng(na);$a.kE(na)}K8c(na,$a,Fb){var Xb=[];let nc;nc=this.Zd.Gka?this.Zd.b5c?rc.N7c(String.format(Object(aa.a)("TellMeTemplateButtonTextV2Bolded"),na.Fl)):String.format(Object(aa.a)("TellMeTemplateButtonTextV2"),
na.Fl):String.format(Object(aa.a)("TellMeTemplateButtonText"),na.Fl);Xb.push(appChrome.actions.setControlLabel("TemplateForSearch",nc));Xb.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(n.AFrameworkApplication.ga.La("TellMeTemplateProviderURL"),n.AFrameworkApplication.uiCulture,na.Fl)));appChrome.api.dispatch(Xb);na=new Yg(23);na.displayName=Object(aa.a)("TellMeTemplateProviderTitle");Xb=new Lg("TemplateForSearch",24,null,null,0);Xb.label=Fb[0].Title?Fb[0].Title:
"";Xb.description=Fb[0].Description?Fb[0].Description:"";na.oP(Xb);$a.AL(na)}}Object(m.a)(Ri,"TemplateResultsProvider",null,[1292]);class Yi{constructor(na,$a,Fb){this.U3c=this.x6e=this.y6e=this.B$g=!1;this.Bla=null;this.ZFa=-1;this.Wkc=this.v7e=this.d4c=this.lrd=null;this.b9k=this.c9k=0;this.Zd=na;const Xb=rc.fmb();this.L2c=$a||[];this.$m=n.AFrameworkApplication.ye;this.Qbl=na.S2j;this.z6e=na.R2j;this.z$g=Xb&&this.Ked();this.A$g=Xb&&this.Led();this.Sbl=Xb&&this.Med();this.D$g=this.iNe();this.rTh=
this.fNe();if(($a=na.fNk&&rc.tFk(na))||na.U9a)this.lrd=new Wk(na),this.B$g=na.fZg;$a&&(this.y6e=na.gZg,this.x6e=na.R9c,this.U3c=this.B$g&&this.yP("File")||this.y6e&&this.yP("People")||this.x6e&&this.yP("Notes"));this.y$g=this.LOn();this.B6e=na.pAg;this.C$g=this.TOn();this.qTh=this.KOn();this.Txe=this.axh();this.XRa=this.iUm();this.s4k=new Tg(na);this.vim=new qj(na);this.Fmm=new Ri(na);this.rfm=new Rg(na);this.b5e=Fb;this.tqd=new Hj.a;this.B6e&&(this.s4k=new Tg(na));na.U9a&&(this.qTh=this.C$g=this.B6e=
this.U3c=this.x6e=this.y6e=this.rTh=this.D$g=this.Sbl=this.A$g=this.z$g=this.z6e=!1,n.AFrameworkApplication.ga&&this.yP("File")&&this.w4l()||this.Txe)&&(na=this.tqd.dIf("Search",n.AFrameworkApplication.ga.La("TellMeServiceAuthEndpointForSearch")),this.Bwf(na,"TellMeService",!0),na=this.tqd.dIf("SmartLookup",n.AFrameworkApplication.ga.La("SmartLookupShredderServiceEndpoint")),this.Bwf(na,"Shredder",!1));n.AFrameworkApplication.ga&&this.U3c&&this.yP("File")&&this.w4l()&&(na=this.tqd.dIf("Search",n.AFrameworkApplication.ga.La("TellMeServiceAuthEndpointForSearch")),
this.Bwf(na,"TellMeService",!0))}yP(na){return Array.contains(this.L2c,na)?!0:!1}zca(){return"TellMeService"}Ksa(){return 0===this.Zd.NL?0:1===this.Zd.NL?1:this.yP("Command")||this.yP("Recommended")?2:3}gUm(na){let $a="";if(!na&&this.yP("Command")&&this.Zd.Plj){$a+="CommandSearch_DLIS,";var Fb=this.Zd.o7l;0<Fb.length&&($a+=Fb+",")}na&&this.yP("Recommended")&&this.z6e&&(Fb=this.jVm(),0<Fb.length&&($a+=Fb+","));!na&&this.yP("Help")&&(na=this.Zd.n7l,0<na.length&&($a+=na+","));this.Zd.U9a&&this.Wkc&&
0<this.Wkc.length&&($a+="IsRecallEnabled_true,");(this.Zd.gfh||this.Zd.kfh||this.Zd.U9a)&&this.U3c&&($a+="IsGenerateSlidesEnabled_true,");0<$a.length&&($a=$a.substr(0,$a.length-1));return $a}Bwf(na,$a,Fb){const Xb=Fb?this.c9k:this.b9k;if(!Xb||window.performance.now()-Xb>=rc.Lyh)if(na)Fb?this.c9k=window.performance.now():this.b9k=window.performance.now(),na.then(nc=>{Fb?this.v7e=nc:(this.Wkc=nc,Rd.instance.jVg=nc)},nc=>{Rd.instance.Jp().onError("TellMeServiceProvider:FetchTokenForService_"+$a,"tellMeServiceToken promise rejected: "+
nc)});else if(Rd.instance.Jp())Rd.instance.Jp().onError("TellMeServiceProvider:FetchTokenForService_"+$a,"undefined token promise")}l8(na,$a,Fb,Xb=sf.fI,nc=null){const Nc=new Ng(na);Fb=rc.L$(na);this.yP("File")&&(this.U3c||this.Zd.U9a)&&this.Bwf(this.tqd.OXi(),"TellMeService",!0);(this.yP("File")&&this.Zd.U9a||this.yP("ActionAI")&&this.Txe)&&this.Bwf(this.tqd.QVi(),"Shredder",!1);var yd=this.U3c&&!!this.v7e;const Ud=this.Zd.U9a&&!!this.Wkc;var ie=yd||Ud||Fb&&this.yP("Recommended")&&this.z6e;yd=yd||
Ud||!Fb&&(this.Qbl&&this.yP("Command")||this.z$g&&this.yP("Answer")||this.A$g&&this.yP("Definition")||this.rTh&&this.yP("Image")||this.B6e&&this.yP("Help")||this.D$g&&this.yP("WolframAnswer")||this.C$g&&this.yP("Template")||this.qTh&&this.yP("Addin"));if(ie||yd)if(this.d4c=Xb,Xb={"Content-Type":"application/json",Accept:"application/json"},Xb["X-Office-Version"]=n.AFrameworkApplication.buildVersion,Xb["X-Office-Application"]=n.AFrameworkApplication.ga.La("Application"),Xb["X-Office-Platform"]="WAC",
Xb["X-TellMe-SqmUserId"]=n.AFrameworkApplication.ga.La("LoggableUserId")||"",Xb["X-TellMe-SessionId"]=Rd.instance.ZCe(),this.v7e&&(Xb.Authorization="Bearer "+this.v7e),this.Wkc&&0<this.Wkc.length&&(Xb["X-TellMe-ShredderToken"]="Bearer "+this.Wkc),ie=this.gUm(Fb),0<ie.length&&(Xb["X-TellMe-Flights"]=ie),ie=[],!Fb&&this.yP("Answer")&&this.z$g&&(nc?Array.contains(nc,9):1)&&Array.add(ie,"Answer"),!Fb&&this.yP("Command")&&this.Qbl&&!yh.mQf(na.Fl)&&(nc?Array.contains(nc,17):1)&&Array.add(ie,"Command"),
!Fb&&this.yP("Definition")&&this.A$g&&(nc?Array.contains(nc,10):1)&&Array.add(ie,"Definition"),!Fb&&this.yP("Help")&&this.B6e&&(nc?Array.contains(nc,8):1)&&Array.add(ie,"Help"),!Fb&&this.yP("WolframAnswer")&&this.D$g&&(nc?Array.contains(nc,12):1)&&Array.add(ie,"WolframAnswer"),Fb&&this.yP("Recommended")&&this.z6e&&!Rd.instance.u1c&&(nc?Array.contains(nc,18):1)&&Array.add(ie,"Recommended"),!Fb&&this.yP("Image")&&this.rTh&&(nc?Array.contains(nc,19):1)&&Array.add(ie,"Image"),this.v7e&&this.U3c&&(nc?
Array.contains(nc,14)||Array.contains(nc,15)||Array.contains(nc,20):1)&&(this.lrd.j_(),this.B$g&&this.yP("File")&&Array.add(ie,"File"),this.y6e&&this.yP("People")&&Array.add(ie,"People"),this.x6e&&this.yP("Notes")&&Array.add(ie,"Notes")),this.Wkc&&0<this.Wkc.length&&this.Zd.U9a&&(nc?Array.contains(nc,15):1)&&(this.lrd.j_(),this.yP("File")&&Array.add(ie,"File")),!Fb&&this.yP("Template")&&this.C$g&&(nc?Array.contains(nc,23):1)&&Array.add(ie,"Template"),!Fb&&this.yP("Addin")&&this.qTh&&(nc?Array.contains(nc,
27):1)&&Array.add(ie,"Addin"),!Fb&&this.yP("ActionAI")&&this.Txe&&(nc?Array.contains(nc,25):1)&&Array.add(ie,"ActionAI"),ie.length){Xb["X-TellMe-SuggestionTypes"]=ie.join(",");Xb["X-TellMe-Culture"]=n.AFrameworkApplication.uiCulture;Xb["X-TellMe-ProcessSessionId"]=n.AFrameworkApplication.userSessionId;var Be=this.Bla=ca.a.create().toString();Xb["Client-Request-Id"]=Be;var oe=window.performance.now();this.BLb();this.ZFa=window.setTimeout(()=>{if(Be===this.Bla){this.Bla="";this.ZFa=-1;$a.kE(Nc);const rf=
{};rf[Ye.provider]=this.zca();rf[Ye.queryId]=na.cdd;Rd.instance.Jp().Zca(Yd.timedOut,this.b5e,rf)}},this.b5e);this.$m.rk(this.XRa,2,this.hUm(na.Fl),Xb,!1,0,rf=>{this.cce(rf,na,$a,Be,oe,nc)},rf=>{this.Wae(rf,na,$a,Be,oe)},null,null,!1,4E3,this.Txe?3E4:6E3)}else Rd.instance.Jp().onError("IssueQuery","Empty Online Provider List: No online calls by provider"),$a.kE(Nc);else $a.kE(Nc)}BLb(){-1!==this.ZFa&&(window.clearTimeout(this.ZFa),this.ZFa=-1)}cce(na,$a,Fb,Xb,nc,Nc){const yd=new Ng($a);if(Xb===this.Bla){this.BLb();
Rd.instance.Jp().abb($a.Fl.length,this.L2c.join(","),na.data.Ze.toString(),Math.round(window.performance.now()-nc),Gj.fI,!0,Ni.Yac);Xb=na.data.responseData;na=null;try{na=hb.b(Xb)}catch(Vf){Rd.instance.Jp().onError("OnSuccessCallBack","Exception occured while deserializing response:"+Vf);return}Xb=rc.L$($a);if("Groups"in na&&na.Groups){var Ud=na.Groups;for(var ie of Ud)if("GroupType"in ie&&"Suggestions"in ie&&ie.Suggestions)if("Commands"===ie.GroupType&&(Nc?Array.contains(Nc,17):1)||"Recommended"===
ie.GroupType&&(Nc?Array.contains(Nc,18):1)){var Be=(Ud="Recommended"===ie.GroupType)?"DLIS":"NaiveBayes";"Source"in ie&&ie.Source&&(Be=ie.Source);var oe=ie.Suggestions;new Fa.a;var rf=[];for(const Vf of oe)this.n7m(Vf)&&(oe=Vf.Type,("Command"===oe||Ud&&"Recommended"===oe)&&rf.push(new Jf(Vf.CommandId,Vf.Score)));yh.MFe(rf,!$a.Fl.trim().length,ie.GroupType,Be);Be=Rd.instance.xQi();oe=[];for(const Vf of rf)Ud&&Be&&Be.Okf(Vf.commandId)||oe.push(Vf);rf=yh.QJd($a,oe,this.Zd,null,null,null,Ud?18:17,0);
0<rf.results.length&&(this.d4c!==sf.contextMenu&&(rf.displayName=Ud?Object(aa.a)("TellMeTryCommandTitle"):Object(aa.a)("TellMeCommandProviderTitle")),yd.AL(rf))}else if("Answer"===ie.GroupType){oe=ie.Suggestions;Ud=null;rf=2147483647;Be="";for(const Vf of oe)if(this.m7m(Vf))if(Be=Vf.Type,oe=this.GFf(Be),"Answer"===Be&&this.z$g){Ud=this.Uml(Be,Vf,$a.Fl);break}else oe&&oe<rf&&(rf=oe,Ud=this.Uml(Be,Vf,$a.Fl));rf=rc.gIn($a.Fl,Be);Ud&&(Nc?Array.contains(Nc,Ud.type):1)&&(Be=[],this.y$g?this.Zd.vAb?(Rd.instance.actions.push(appChrome.actions.setControlLabel(Ud.value,
Ud.fqa)),Rd.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ud.value,Ud.description)),Rd.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ud.value,rf))):(Be.push(appChrome.actions.setControlLabel(Ud.value,Ud.fqa)),Be.push(appChrome.actions.updateCompoundButtonDescription(Ud.value,Ud.description)),Be.push(appChrome.actions.setCompoundButtonCommandValueId(Ud.value,rf)),appChrome.api.dispatch(Be)):this.Zd.vAb?(Rd.instance.actions.push(appChrome.actions.setControlLabel(Ud.value,
Ud.fqa+" - "+Ud.description)),Rd.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ud.value,rf))):(Be.push(appChrome.actions.setControlLabel(Ud.value,Ud.fqa+" - "+Ud.description)),Be.push(appChrome.actions.setButtonCommandValueId(Ud.value,rf)),appChrome.api.dispatch(Be)),rf=this.eCm(Ud.type),rf.oP(Ud),yd.AL(rf))}else"Help"===ie.GroupType&&ie.Suggestions.length&&(Nc?Array.contains(Nc,8):1)?this.B6e&&(Ud=this.s4k.K8c($a,ie.Suggestions))&&0<Ud.results.length&&yd.AL(Ud):"Template"===ie.GroupType&&
(Nc?Array.contains(Nc,23):1)?(Ud=ie.Suggestions)&&0<Ud.length&&this.Fmm.K8c($a,yd,Ud):"Addin"===ie.GroupType&&(Nc?Array.contains(Nc,27):1)?(Ud=ie.Suggestions)&&0<Ud.length&&this.rfm.K8c($a,yd,Ud):"ActionAI"===ie.GroupType&&(Nc?Array.contains(Nc,25):1)?(rf=ie.Suggestions,Ud=[],new Yg(25),rf&&1===rf.length&&(Be=rf[0])&&Be.CommandId&&(rf=Be.CommandId,Ud.push(new Jf(rf,"Score"in Be?Be.Score:0)),Ud=yh.QJd($a,Ud,this.Zd,null,null,null,25,0),Ud.displayName=Object(aa.a)("TellMeActionAIProviderTitle"),yd.AL(Ud))):
"Substrate"===ie.GroupType&&this.U3c&&"Type"in ie?"File"===ie.Type&&this.B$g&&(Nc?Array.contains(Nc,15):1)?(Ud=this.lrd.ENi(ie.Suggestions,Xb,this.d4c))&&0<Ud.results.length&&(this.Ekh()&&(rf=new Lg("GenerateSlidesFromTellMe",30,"",null,1),Ud.oP(rf)),yd.AL(Ud)):"People"===ie.Type&&this.y6e&&(Nc?Array.contains(Nc,14):1)?(Ud=this.lrd.Uvl(ie.Suggestions,Xb,this.d4c))&&0<Ud.results.length&&yd.AL(Ud):"Notes"===ie.Type&&this.x6e&&(Nc?Array.contains(Nc,14):1)&&(Ud=this.lrd.Gvl(ie.Suggestions,Xb,$a))&&0<
Ud.results.length&&yd.AL(Ud):"Recall"===ie.GroupType&&this.Zd.U9a&&"Type"in ie&&"IntentService"===ie.Type&&(Nc?Array.contains(Nc,15):1)&&(Ud=this.lrd.ENi(ie.Suggestions,Xb,this.d4c))&&0<Ud.results.length&&(this.Ekh()&&(rf=new Lg("GenerateSlidesFromTellMe",30,"",null,1),Ud.oP(rf)),yd.AL(Ud));else Rd.instance.Jp().onError("OnSuccessCallBack","GroupType"in ie?"Invalid group suggestions found for "+ie.GroupType:"Invalid group found")}if(na.Intents){ie=na.Intents;for(const Vf of ie)this.drj(Vf)&&("Image"===
Vf.GroupType&&Vf.ConfidenceScore>Vf.ConfidenceThreshold&&(Nc?Array.contains(Nc,19):1)?this.vim.K8c($a,yd,0,Vf):"Commands"===Vf.GroupType&&Vf.ConfidenceScore<Vf.ConfidenceThreshold&&(Nc?Array.contains(Nc,17):1)&&(ie=new Yg(17),yd.AL(ie)))}Fb.kE(yd);Rd.instance.Jp().abb($a.Fl.length,this.L2c.join(","),"",Math.round(window.performance.now()-nc),"",!0,Ni.provider)}}Wae(na,$a,Fb,Xb,nc){const Nc=new Ng($a);Xb===this.Bla&&(this.BLb(),Rd.instance.Jp().abb($a.Fl.length,this.L2c.join(","),na.data.Ze.toString(),
Math.round(window.performance.now()-nc),Gj.fI,!1,Ni.Yac));Fb.kE(Nc)}GFf(na){switch(na){case "Entity":return this.Sbl?3:0;case "Definition":return this.A$g?5:0;case "WolframAnswer":return this.D$g?2:0;default:return 0}}Uml(na,$a,Fb){switch(na){case "Answer":return new Lg(this.y$g?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===$a.Title?Fb:$a.Title,$a.Description,0);case "Entity":return new Lg(this.y$g?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===$a.Title?Fb:$a.Title,$a.Description,0);
case "Definition":return new Lg(this.y$g?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===$a.Title?Fb:$a.Title,$a.Description,0);case "WolframAnswer":return new Lg("WolframForSearch",3,""===$a.Title?Fb:$a.Title,$a.Description,0);default:return null}}eCm(na){switch(na){case 0:return new Yg(9,Object(aa.a)("TellMeAnswersTitle"));case 2:return new Yg(11,Object(aa.a)("TellMeEntityTitle"));case 1:return new Yg(10,Object(aa.a)("TellMeDefinitionTitle"));case 3:return new Yg(12,Object(aa.a)("TellMeAnswersTitle"));
case 12:return new Yg(19,this.Zd.bNe?Object(aa.a)("TellMeImageTitleV2"):Object(aa.a)("TellMeImageTitle"));default:return null}}m7m(na){return"Type"in na&&!!na.Type&&""!==na.Type&&"Description"in na&&!!na.Description&&""!==na.Description}n7m(na){return"Type"in na&&!!na.Type&&""!==na.Type&&"CommandId"in na&&!!na.CommandId&&""!==na.CommandId&&"Score"in na&&!!na.Score}drj(na){if("GroupType"in na&&na.GroupType&&"ConfidenceScore"in na&&"ConfidenceThreshold"in na)return!0;Rd.instance.Jp().onError("IsValidIntentGroup",
"Invalid intents found");return!1}hUm(na){const $a=rc.QDl(na),Fb={};Fb.Query=na;$a&&this.z6e&&(this.p5m()?Fb.UserActionEvents=Rd.instance.aZi():(Fb.CommandClickedEvents=Rd.instance.Zgh(),Fb.CommandActionEvents=Rd.instance.QKi()),Fb.TellMeCommandClickMruEvents=Rd.instance.jKi(),Fb.ContentType=Rd.instance.Eof);this.C$g&&(na={},na.Application=this.Zd.application,Fb.TemplateInfo=na);return hb.c(Fb)}Ked(){return!!this.Zd&&this.Zd.Ked||!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.Ked}Led(){return!!this.Zd&&
this.Zd.Led||!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.Led}Med(){return!!this.Zd&&this.Zd.Med||!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.Med}iNe(){return!!this.Zd&&this.Zd.iNe||!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.iNe}fNe(){return!!this.Zd&&(this.Zd.fNe||this.Zd.Gka)}LOn(){return!!this.Zd&&!this.Zd.Q9c}TOn(){return!!this.Zd&&this.Zd.tVf}KOn(){return!!this.Zd&&this.Zd.t3m&&this.Zd.q3m}axh(){return!!this.Zd&&this.Zd.axh}XDl(){return!!n.AFrameworkApplication.ga&&
n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}YDl(){return!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}p5m(){return!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}Ekh(){return!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",
!1)}w4l(){return!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}jVm(){return n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}iUm(){if(!n.AFrameworkApplication.ga)return"";if(this.YDl())return n.AFrameworkApplication.ga.La("TellMeServiceProdEndpointForSearch");if(this.XDl())return n.AFrameworkApplication.ga.La("TellMeServiceEdogEndpointForSearch");
if(rc.Khj())return n.AFrameworkApplication.ga.La("TellMeServiceIntEndpointForSearch");let na=n.AFrameworkApplication.ga.La("TellMeServiceSearchEndpoint");na&&""!==na||(na=n.AFrameworkApplication.m7l);return na}static anl(na,$a){if($a)return new Yi(na,["Command","Recommended"],na.QOm);$a=rc.fmb()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new Yi(na,$a,na.Iwl)}}Object(m.a)(Yi,
"TellMeServiceProvider",null,[1292]);class ma{constructor(na=!1){this.Cxe={};this.Cxe[sf.fI]=[];this.Cxe[sf.contextMenu]=[];this.d9g=na}rEl(na,$a,Fb,Xb,nc=null){let Nc;var yd=!1;switch(Xb){case sf.contextMenu:Nc=this.Cxe[sf.contextMenu];yd=!0;break;default:Nc=this.Cxe[sf.fI]}$a=new Qi($a,Nc,yd,this.d9g,Xb);$a.Kun();for(let Ud=0;Ud<Nc.length;++Ud){const ie=window.performance.now(),Be=new Nf($a,Ud);(yd=Rd.instance.wca())&&yd.Ztm?window.setTimeout(()=>{Nc[Ud].l8(na,Be,Fb,Xb,nc);if(Rd.instance.Jp()){const oe=
{};oe[Ye.provider]=Nc[Ud].zca();oe[Ye.queryId]=na.cdd;Rd.instance.Jp().Zca(Yd.l8,window.performance.now()-ie,oe)}},0):(Nc[Ud].l8(na,Be,Fb,Xb,nc),Rd.instance.Jp()&&(yd={},yd[Ye.provider]=Nc[Ud].zca(),yd[Ye.queryId]=na.cdd,Rd.instance.Jp().Zca(Yd.l8,window.performance.now()-ie,yd)))}$a.DWn()}zca(){return"Aggregator"}Ksa(){return 0}l8(na,$a,Fb=!1,Xb=sf.fI,nc=null){if(Rd.instance.Ftg)this.rEl(na,$a,Fb,Xb,nc);else{const Nc=window.performance.now();Rd.instance.d6g.then(()=>{Rd.instance.Jp()&&Rd.instance.Jp().Zca(Yd.Agn,
window.performance.now()-Nc);this.rEl(na,$a,Fb,Xb,nc);return!0})}}b3(na,$a){this.Cxe[$a].push(na)}Lom(na){switch(na){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const $a=this.Cxe[sf.fI];for(const Fb of $a)if("FindInDocument"===Fb.zca()){Fb.oMn(na);break}}}static createInstance(na,$a,Fb,Xb){const nc=$a.U9a;var Nc=Xb&&rc.uFk($a),yd=Nc&&$a.R2j&&!nc;const Ud=$a.qqj&&!rc.mFe()&&!nc,ie=$a.pmj&&!nc,Be=new ma(Nc);if($a.POn&&!nc){var oe=new kk($a);Be.b3(oe,sf.fI)}oe=
$a.JD?n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeIsSuggestionsForSimplifiedUxEnabled"):n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeSuggestionsIsEnabled");const rf=!oe&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeFirstRunExperienceIsEnabled");Be.b3(new Gi(na,$a.aWn,rf,!1),sf.fI);oe&&!nc&&Be.b3(new Cj(new dj,$a,na),sf.fI);na=n.AFrameworkApplication.Ea.Kb.rqj?new ul($a,new Ug):new Xi($a,Fb);Be.b3(na,sf.contextMenu);(Nc&&$a.S2j||yd)&&Be.b3(Yi.anl($a,!0),sf.fI);Be.b3(na,
sf.fI);!$a.dJm||nc||"Word"===$a.application&&$a.Yrl||Be.b3(new Ph($a),sf.fI);$a.avd&&!nc&&(yd=new og($a),Be.b3(yd,sf.fI),Be.b3(yd,sf.contextMenu));!$a.d5c||$a.xTg||$a.wTg||nc||Be.b3(new Tg($a),sf.fI);Xb&&($a.ibc||rc.fmb())&&(yd=new Ik($a),Be.b3(yd,sf.fI),Be.b3(yd,sf.contextMenu));Nc&&Be.b3(Yi.anl($a,!1),sf.fI);Xb&&!$a.fNk&&rc.tFk($a)&&!nc&&(Be.b3(new Wk($a),sf.fI),$a.ZSn&&Be.b3(new Wk($a),sf.contextMenu));Ud&&Be.b3(new Bj($a),sf.fI);!$a.fNe&&!$a.Gka||nc||Be.b3(new qj($a),sf.fI);$a.tVf&&!nc&&Be.b3(new Ri($a),
sf.fI);$a.bkh&&(Nc=new Me($a),Be.b3(Nc,sf.fI),Be.b3(Nc,sf.contextMenu));Xb&&$a.gkh&&!nc&&Be.b3(new jf($a),sf.fI);ie&&"Excel"===$a.application&&!nc&&Be.b3(new Vk($a),sf.fI);return Be}}Object(m.a)(ma,"AggregatorResultsProvider",null,[1292]);var Sa=a(1141);class Zb{constructor(na="",$a="",Fb="",Xb=-99999,nc=-1,Nc=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=na?na:"";this.Description=$a?$a:"";this.Type=Fb?Fb:"";this.Score=Xb;this.Age=nc;this.Count=Nc}}Object(m.a)(Zb,
"Suggestion",null,[]);class Wc{constructor(na,$a){this.GroupType=this.Suggestions=null;this.Suggestions=na;this.GroupType=$a}}Object(m.a)(Wc,"SuggestionGroup",null,[]);class rd{}rd.Ofa="help";rd.Wrm="answer";rd.commands="commands";rd.CKn="servicecommands";rd.p7l="template";Object(m.a)(rd,"SuggestionGroupType",null,[]);class ee{constructor(na,$a,Fb){this.RHh=0;this.TUh=this.q1e=null;this.Dw=na;this.FTh=this.vGh=this.sKh=!1;this.Fgm=$a;this.$m=n.AFrameworkApplication.ye;this.Zd=Fb;this.V7g=this.NPh=
0}get sUa(){return this.Dw.sUa}swh(na){this.Dw.swh(na)}JFl(){if(this.q1e){var na=0;for(const $a of this.q1e)this.Dw.G$m($a,na++);this.q1e=null}}beginQuery(na,$a,Fb){this.Dw.B$m(na,$a,Fb)}mQl(na,$a){this.Dw.Ntm(na,$a);this.sKh=!0;this.FTh=!1}lQl(){this.sKh=!1;this.vGh||(this.JFl(),this.Dw.Tpl(this.RHh))}C$m(na,$a){this.Dw.D$m(na,$a)}Mon(na,$a,Fb,Xb,nc){for(const Nc of this.Fgm)if(na.startsWith(Nc)){this.FTh=!0;break}this.Dw.N9m(na,$a,Fb,Xb,nc)}Won(na){this.vGh=!1;this.RHh=na;this.sKh||this.FTh||(this.JFl(),
this.Dw.Tpl(this.RHh,!1))}Von(na,$a){this.Dw.Q9m(na,$a);this.vGh=!0}CHi(na,$a){if(!na.count)return"";let Fb="";const Xb=Date.now();for(const nc of na)na=(Xb-nc.timeStamp)/1E3,na=rc.czh(na),0<Fb.length&&(Fb+=";"),Fb+=$a?nc.commandId:nc.controlId,Fb+=":",Fb+=na.toString();return Fb}Nxg(){var na=this.CHi(Sa.a.instance.ogc,!1);0<na.length&&this.Dw.M9m(na);na=this.CHi(Sa.a.instance.OEb,!0);0<na.length&&this.Dw.A9m(na);na=this.CHi(Sa.a.instance.Q2c,!0);0<na.length&&this.Dw.g$m(na);na=Rd.instance.kKi();
0<na.length&&this.Dw.A$m(hb.c(na))}N$m(na){this.Dw.J9m(na)}abb(na,$a,Fb,Xb,nc,Nc,yd,Ud=null){this.Dw.n$m(na,$a,Fb,Xb,nc,Nc,yd,Ud)}Byj(na,$a,Fb,Xb){this.Dw.Byj(na,$a,Fb,Xb)}Zca(na,$a,Fb=null){this.Dw.hBb(na,$a,Fb)}onError(na,$a,Fb=null){this.Dw.GUb(na,$a,Fb)}mMn(na){this.q1e=na}STm(na){const $a=[];if(!na)return $a;for(let Fb=0;Fb<na.length;Fb++){const Xb=Pi[na[Fb].groupType].toLowerCase(),nc=[],Nc=na[Fb].results;if(Nc){for(let yd=0;yd<Nc.length;yd++)"findindocument"===Xb?Array.add(nc,new Zb("","",
Xb,Nc[yd].score,Nc[yd].qbh,Nc[yd].count)):Array.add(nc,new Zb(Nc[yd].label,Nc[yd].description,Xb,Nc[yd].score,Nc[yd].qbh,Nc[yd].count));"answer"===Xb||"definition"===Xb||"wolframanswer"===Xb||"entity"===Xb?Array.add($a,new Wc(nc,rd.Wrm)):"classifier"===Xb||"appsforoffice"===Xb?Array.add($a,new Wc(nc,rd.commands)):"serviceclassifier"===Xb?Array.add($a,new Wc(nc,rd.CKn)):"assistance"===Xb?Array.add($a,new Wc(nc,rd.Ofa)):("document"===Xb||"people"===Xb||"findindocument"===Xb||"notes"===Xb||"image"===
Xb||"template"===Xb)&&Array.add($a,new Wc(nc,Xb))}}return $a}eXi(na,$a){const Fb={};Fb.Query=$a;Fb.SuggestionGroups=hb.c(this.STm(na));return hb.c(Fb)}$wl(na){const $a={"Content-Type":"application/json",Accept:"application/json"};$a["X-Office-Version"]=n.AFrameworkApplication.buildVersion;$a["X-Office-Application"]=n.AFrameworkApplication.ga.La("Application");$a["X-Office-Platform"]="WAC";$a["X-TellMe-SqmUserId"]=n.AFrameworkApplication.ga.La("LoggableUserId")||"";$a["X-TellMe-SessionId"]=this.Dw.sUa.interactionId;
$a["X-TellMe-SuggestionTypes"]="Ranker";$a["X-TellMe-Culture"]=n.AFrameworkApplication.uiCulture;$a["X-TellMe-ProcessSessionId"]=n.AFrameworkApplication.userSessionId;$a["X-TellMe-Flights"]=na;$a["X-TellMe-PartialQueryIndex"]=this.NPh;return $a}cce(na,$a,Fb){this.abb($a.length,"RankerLogging",na.data.Ze.toString(),Math.round(window.performance.now()-Fb),Gj.k7l,!0,Ni.Yac)}Wae(na,$a,Fb){this.abb($a.length,"RankerLogging",na.data.Ze.toString(),Math.round(window.performance.now()-Fb),Gj.k7l,!1,Ni.Yac)}axl(){this.TUh||
(this.TUh=new Yi(this.Zd,null,6E3));return this.TUh.XRa}Wyj(na){const $a=this.eXi(this.q1e,na),Fb=this.$wl("RankerLogging"),Xb=window.performance.now();this.$m.rk(this.axl(),2,$a,Fb,!1,0,nc=>{this.cce(nc,na,Xb)},nc=>{this.Wae(nc,na,Xb)},null,null,!1,4E3,6E3);this.NPh++}EHn(){this.NPh=0}Bzk(na){this.V7g=na}}Object(m.a)(ee,"InteractionLogger",null,[]);class De{constructor(na,$a,Fb,Xb=0){this.Yxl=na;this.groupType=$a;this.d0i=Xb;this.SMg=Fb}}Object(m.a)(De,"SortingGroup",null,[]);class Af{constructor(na,
$a,Fb,Xb){this.order=na;this.YQb=$a;this.LVm=Fb;this.groupType=Xb}}Object(m.a)(Af,"SortingProp",null,[]);class mg{constructor(na,$a){this.tLl={};this.sLl={};this.cLl=this.UMl=1;this.eil(na,$a)}CRn(na,$a,Fb){var Xb=rc.L$(Fb)?this.tLl:this.sLl;Fb=new Fa.a;for(var nc of $a)$a=Object(ed.a)(Af,Xb[Pi[nc.groupType].toLowerCase()]),Ya.b($a)||Fb.add(new df.a($a,nc));Fb.Sc((yd,Ud)=>yd.key.order<Ud.key.order?-1:1);Array.clear(na);nc=Rd.instance.NXi();for($a=0;$a<Fb.count;){Xb=Fb.ha($a).key.YQb;var Nc=Fb.ha($a).value;
const yd=new Yg(Fb.ha($a).key.groupType);Ya.b(nc)||nc.Location===sf.contextMenu||(yd.displayName=Fb.ha($a).key.LVm);for(const Ud of Nc.results)yd.oP(Ud);for(Nc=++$a;Nc<Fb.count&&Fb.ha(Nc).key.YQb===Xb;)this.SZh(yd,Fb.ha(Nc).value),Nc=++$a;na.push(yd)}}yYn(na,$a){this.cLl=this.UMl=1;this.eil(na,$a)}eil(na,$a){this.V5l(na);for(var Fb=0;Fb<na.length;Fb++){const Xb=na[Fb];for(const nc of Xb.SMg)this.rom(nc,Fb,Xb.Yxl,Xb.groupType)}this.V5l($a);for(na=0;na<$a.length;na++){Fb=$a[na];for(const Xb of Fb.SMg)this.qom(Xb,
na,Fb.Yxl,Fb.groupType)}}V5l(na){na.sort(($a,Fb)=>Object(ed.a)(De,$a).d0i>Object(ed.a)(De,Fb).d0i?-1:1)}rom(na,$a,Fb,Xb){this.tLl[Pi[na].toLowerCase()]=new Af(this.UMl++,$a,Fb,Xb)}qom(na,$a,Fb,Xb){this.sLl[Pi[na].toLowerCase()]=new Af(this.cLl++,$a,Fb,Xb)}SZh(na,$a){for(let Fb=0;Fb<$a.results.length;Fb++)na.oP($a.results[Fb])}}Object(m.a)(mg,"BaseGroupingSorter",null,[]);class dg{constructor(){this.Fqh=[new De("",26,[26]),new De("",24,[24]),new De(Object(aa.a)("TellMeRecentlyUsedTitleV2"),4,[4,2]),
new De(Object(aa.a)("TellMeCommandProviderTitle"),7,[18,16,7]),new De(Object(aa.a)("TellMeSuggestionsProviderTitle"),33,[15,14,19,3]),new De("",13,[13]),new De("",22,[22])];this.lph=[new De("",25,[25]),new De(Object(aa.a)("TellMeCommandProviderTitle"),31,[17,0,1,8,28]),new De(Object(aa.a)("TellMeSuggestedSearchesProviderTitle"),32,[2,19,23,29]),new De(Object(aa.a)("TellMePotentialMatchesProviderTitle"),33,[15,14,20,9,12,10,11,27]),new De("",13,[13]),new De("",22,[22])];this.VIl=new mg(this.Fqh,this.lph)}UVg(na,
$a,Fb,Xb=null,nc=null){let Nc=!1;if(Xb){for(const yd of rc.L$(Fb)?this.Fqh:this.lph)this.HCn(yd,Xb);Nc=!0}if(nc){for(const yd of rc.L$(Fb)?this.Fqh:this.lph)this.zYn($a,yd,nc);Nc=!0}Nc&&this.VIl.yYn(this.Fqh,this.lph);this.VIl.CRn(na,$a,Fb)}HCn(na,$a){const Fb=new Fa.a;for(var Xb of na.SMg){const nc=$a[Pi[Xb].toLowerCase()];Fb.add(new df.a(Ya.b(nc)?Number.MAX_VALUE:nc,Xb))}if(Fb.count){Fb.Sc((nc,Nc)=>nc.key<Nc.key?-1:1);$a=Array(Fb.count);for(Xb=0;Xb<Fb.count;Xb++)$a[Xb]=Fb.ha(Xb).value;na.SMg=$a}}zYn(na,
$a,Fb){let Xb=0;for(const nc of $a.SMg)if(Pi[nc].toLowerCase()in Fb&&Fb[Pi[nc].toLowerCase()])for(const Nc of na)if(Nc.groupType===nc){Xb+=Fb[Pi[nc].toLowerCase()];break}$a.d0i=Xb}}Object(m.a)(dg,"SimplifiedGroupingSorter",null,[]);class Zg{constructor(na){this.rLl={};this.pLl={};this.qLl={};this.uLl={};this.QNj={};this.BLl=this.Ren=this.jen=this.yen=1;this.bMl=null;this.CI=na;this.ivm();this.Bwn();this.hvm();this.Dum();na.Gka&&(this.bMl=new dg)}a3(na){this.rLl[Pi[na].toLowerCase()]=this.yen++}Q7(na,
$a){this.pLl[Pi[na].toLowerCase()]=$a}U9b(na){this.qLl[Pi[na].toLowerCase()]=this.jen++}EHa(na){this.uLl[Pi[na].toLowerCase()]=this.Ren++}EZ(na){this.QNj[Pi[na].toLowerCase()]=this.BLl++}ivm(){const na=!!this.CI&&this.CI.Q9c,$a=!!this.CI&&this.CI.pAg,Fb=!!this.CI&&this.CI.R9c,Xb=!!this.CI&&this.CI.qqj&&!rc.mFe(),nc=!!this.CI&&this.CI.tVf,Nc=!!this.CI&&this.CI.gkh,yd=!!this.CI&&this.CI.pmj,Ud=!!this.CI&&this.CI.bkh;this.CI&&(this.CI.gfh||this.CI.U9a||this.CI.kfh)&&this.a3(26);Ud&&this.a3(24);this.a3(4);
this.a3(18);this.a3(16);this.a3(7);this.a3(17);this.a3(0);this.a3(1);yd&&this.a3(28);nc&&this.a3(23);na||this.a3(2);na&&!$a||this.a3(8);this.a3(15);Fb&&this.a3(20);this.a3(14);this.a3(9);this.a3(12);this.a3(10);this.a3(11);na&&this.a3(2);na&&!$a&&this.a3(8);this.a3(19);Nc&&this.a3(27);this.a3(21);this.a3(13);Xb&&this.a3(22);this.a3(30)}Bwn(){this.Q7(21,1);this.Q7(4,3);this.Q7(18,3);this.Q7(16,3);this.Q7(7,3);this.Q7(17,5);this.Q7(0,5);this.Q7(1,1);this.Q7(28,2);this.Q7(2,1);this.Q7(8,2);this.Q7(15,
3);this.Q7(14,2);this.Q7(27,3);this.Q7(9,1);this.Q7(12,1);this.Q7(10,1);this.Q7(11,1);this.Q7(19,1);this.Q7(23,1);this.Q7(13,1);this.Q7(24,1);this.Q7(25,1);this.Q7(20,2);this.Q7(22,1);this.Q7(26,1)}hvm(){this.U9b(4);this.U9b(0);this.U9b(17);this.U9b(7);this.U9b(16);this.U9b(18);this.U9b(15);this.U9b(20);this.U9b(8);this.U9b(14)}Dum(){this.EHa(14);this.EHa(10);this.EHa(12);this.EHa(9);this.EHa(11);this.EHa(20);this.EHa(15);this.EHa(8);this.EHa(2);this.EHa(1);this.EHa(27);this.EHa(7);this.EHa(18);this.EHa(16);
this.EHa(17);this.EHa(0);this.EHa(4)}KHn(){this.QNj={};this.BLl=1}uSm(na,$a,Fb){this.KHn();const Xb=!!this.CI&&this.CI.Q9c,nc=!!this.CI&&this.CI.pAg,Nc=!!this.CI&&this.CI.R9c,yd=!!this.CI&&this.CI.qqj&&!rc.mFe(),Ud=!!this.CI&&this.CI.tVf,ie=!!this.CI&&this.CI.gkh,Be=!!this.CI&&this.CI.pmj,oe=!!this.CI&&this.CI.axh,rf=!!this.CI&&this.CI.bkh;na=na&&nc;oe&&this.EZ(25);this.EZ(4);this.EZ(18);this.EZ(16);this.EZ(7);this.EZ(17);this.EZ(0);this.EZ(1);rf&&this.EZ(24);Be&&this.EZ(28);Ud&&this.EZ(23);Xb&&!nc||
!na||this.EZ(8);$a&&this.EZ(15);Xb||this.EZ(2);ie&&this.EZ(27);Fb&&this.EZ(14);Xb&&!nc||na||this.EZ(8);$a||this.EZ(15);Nc&&this.EZ(20);Fb||this.EZ(14);this.EZ(9);this.EZ(12);this.EZ(10);this.EZ(11);Xb&&this.EZ(2);Xb&&!nc&&this.EZ(8);this.EZ(19);this.EZ(21);this.EZ(13);yd&&this.EZ(22);return this.QNj}wca(){return this.CI}}Object(m.a)(Zg,"GroupsPlacementInfo",null,[]);var Gh=a(447);class wh{constructor(na,$a,Fb,Xb,nc,Nc){this.groupType=na;this.resultType=$a;this.ZMk=Fb;this.YQb=Xb;this.Avi=nc;this.resultIndex=
Nc}}Object(m.a)(wh,"ClickLoggingInfo",null,[]);const Ji=na=>{const $a=[];for(;na;)Array.add($a,"{ContextId:"+na.contextId+", IsGraphNodeContext:"+na.il+"}"),na=na.RF;$a.reverse();return"{"+$a.join(", ")+"}"};class bi{constructor(){this.interactionId=this.sessionId=null}}Object(m.a)(bi,"CorrelationRecord",null,[1553]);class ni{constructor(na,$a){this.provider=na;this.Jfd=$a}}Object(m.a)(ni,"ExternalResultProvider",null,[]);class eh{constructor(na,$a){this.Id=null;this.TimeStamp=0;this.Id=na;this.TimeStamp=
$a}}Object(m.a)(eh,"MRUControl",null,[]);var nj;(function(na){na[na.ebm=0]="Answer";na[na.Definition=1]="Definition";na[na.Wbm=2]="Entity";na[na.yem=3]="WolframAnswer";na[na.fbm=4]="Assistance";na[na.Command=5]="Command";na[na.Document=6]="Document";na[na.$dm=7]="TryQuery";na[na.hcm=8]="FindInDocument";na[na.S0n=9]="HelpAction";na[na.Acm=10]="Insights";na[na.qdm=11]="People";na[na.Image=12]="Image";na[na.O0n=13]="FirstRunResult";na[na.d1n=14]="NoCommandsFoundResult";na[na.Ydm=15]="TestResult";na[na.y0n=
16]="AppsForOffice_Installed";na[na.A0n=17]="AppsForOffice_Recommandation";na[na.z0n=18]="AppsForOffice_Query";na[na.e1n=19]="Notes_Onenote";na[na.f1n=20]="Notes_Samsung";na[na.g1n=21]="Notes_Sticky";na[na.Mcm=22]="Learning";na[na.Feedback=23]="Feedback";na[na.Xdm=24]="Template";na[na.j2k=25]="ActionAI";na[na.Zam=26]="ActionAICommand";na[na.abm=27]="Addin";na[na.ddm=28]="OfficeScript";na[na.bbm=29]="AddinStoreEntry";na[na.P0n=30]="GenerateSlides";na[na.LCh=31]="SummarizeDeck";na[na.Unknown=32]="Unknown"})(nj||
(nj={}));Object(m.b)("ResultType",nj);var Al=a(508);class dl{constructor(na,$a){this.Njm=10;this.dSa=[];this.kHb=[];this.h8k=this.g8k=!1;this.x2e=this.w2e="";this.oxe=$a;this.Zd=na}yBf(){!this.g8k&&this.Zd&&(this.w2e="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.Zd.application,this.dSa=this.Utl(),this.g8k=!0);return this.dSa}VRm(){!this.h8k&&this.Zd&&(this.x2e="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.Zd.application,this.kHb=this.Utl(!0),this.h8k=!0);return this.kHb}c7m(na){return na.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===na||"TryOfficeUpsell"===na}khj(na){return this.B3m(na)||this.c7m(na)||rc.VDl(na)?!1:!0}Znm(na){na=na.ControlId;this.khj(na)&&(na=this.Wnk(na),this.GFn(na),this.ofn(),Array.insert(this.dSa,0,new eh(na,Date.now())),this.w2e.length&&(na=JSON.stringify(this.dSa),Al.a.instance.setItem(this.w2e,na)))}b3(na){this.nfn();Array.insert(this.kHb,0,new eh(nj[na],Date.now()));this.x2e.length&&(na=JSON.stringify(this.kHb),Al.a.instance.setItem(this.x2e,na))}Utl(na=!1){if(!this.dSa.length){var $a=
na?Al.a.instance.getItem(this.x2e):Al.a.instance.getItem(this.w2e);if(!$a||""===$a)return na?this.kHb:this.dSa;let Fb=null;try{Fb=JSON.parse($a)}catch(Xb){this.Cxm(na),Fb=null}if(!Fb||!Fb.length||10<Fb.length)return na?this.kHb:this.dSa;$a=0;for(const Xb of Fb)if(na||this.Zd.rFe(Xb.Id)&&this.khj(Xb.Id))if(na?Array.insert(this.kHb,$a++,Xb):Array.insert(this.dSa,$a++,Xb),$a===this.oxe)break}return na?this.kHb:this.dSa}Okf(na){na=this.Wnk(na);for(const $a of this.dSa)if($a.Id===na)return!0;return!1}Cxm(na=
!1){Al.a.instance.setItem(na?this.x2e:this.w2e,"")}e4m(na){na=this.Wnk(na.ControlId);return this.khj(na)?this.Okf(na):!1}GFn(na){if(0<this.dSa.length){let $a=0;for(const Fb of this.dSa){if(Fb.Id===na){Array.removeAt(this.dSa,$a);break}$a++}}}Wnk(na){return"Excel"===this.Zd.application&&na.startsWith("m_excelWebRenderer_ewaCtl_")?na.substr(26,na.length):na}ofn(){this.dSa.length===this.oxe&&Array.removeAt(this.dSa,this.dSa.length-1)}nfn(){this.kHb.length===this.Njm&&Array.removeAt(this.kHb,this.kHb.length-
1)}B3m(na){na=na.split("|");let $a="";if(6<=na.length)$a=na[0];else if(3<=na.length){if("3"===na[0])return!0;$a=na[1]}return $a.startsWith("WA")}static createInstance(na){let $a=3;n.AFrameworkApplication.ga&&($a=n.AFrameworkApplication.ga.Jc("TellMeMaxRecommendedResultsToReturn",3));return new dl(na,$a)}}Object(m.a)(dl,"MruControlsManager",null,[1552]);class Zi{constructor(na){this.Vod=na}qsa(na,$a){let Fb;return na.fqa&&(Fb=this.Vod[na.value])?Fb.qsa(na,$a):(Fb=this.bul(na.value))?Fb.qsa(Fb.Hgn,
$a):null}oRm(na,$a){if(na=this.Vod[na])for(const Fb of $a)if($a=rc.getParameter(Fb),$a.key===na.$tn)return $a.value;return null}knn(na){(na=this.bul(na))&&na.inn()}bul(na){const $a=na.indexOf(rc.aTl);return 0<$a?this.Vod[na.substring(0,$a)]:null}}Object(m.a)(Zi,"ParameterizedCommandManager",null,[1549]);class Sj{constructor(na,$a){this.Fl=na;this.cdd=$a}}Object(m.a)(Sj,"TellMeQuery",null,[]);class Ei{constructor(na,$a){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=na;this.TimeElapsedSinceClick=
$a}}Object(m.a)(Ei,"CommandClickedEvent",null,[]);class oj{constructor(na,$a){this.mkm=na;this.$4e=$a}kE(na){this.mkm(Ya.b(na.query)?"":na.query.Fl,na.uz,na.attributes,this.$4e,na.dFe)}}Object(m.a)(oj,"ResultsUpdatedCallback",null,[1548]);class fk{constructor(na,$a,Fb,Xb,nc){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=na;this.TimeElapsedSinceClick=Fb;this.CommandSurface=Xb;this.CommandId=$a;this.TerminalParentControlId=
nc}}Object(m.a)(fk,"UserActionEvent",null,[]);class zk{constructor(na,$a){this.menuModel=na;this.G_l=$a}}Object(m.a)(zk,"GeneratedMenuModel",null,[]);class nl{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(m.a)(nl,"MenuModel",null,[]);class Ck{constructor(na,$a,Fb){this.Zd=na;this.Vod=$a;this.dah=Fb}cLm(na,$a,Fb){let Xb=0;const nc=new nl,Nc=[];let yd="";nc.sections=[];let Ud=new Fa.a;const ie=!!this.Zd&&this.Zd.Q9c;var Be=!!this.Zd&&
this.Zd.poe||n.AFrameworkApplication.Ea.Kb.poe;for(const rf of na){na=0;ie||(Ud=new Fa.a);const Vf=new Fa.a;let xg=rf.displayName;for(const qh of rf.results){if(0<=qh.value.indexOf(rc.SJk)){if(qh.fqa){var oe=this.Vod[qh.value];if(oe&&qh.value.endsWith(rc.SJk)){if("FindParameterized"!==qh.value&&!Be){const k=[];k.push(appChrome.actions.setControlLabel(qh.value,oe.VPm(qh)));k.push(appChrome.actions.setButtonCommandValueId(qh.value,oe.TMm(qh)));appChrome.api.dispatch(k)}oe=qh.value.replace(rc.SJk,"");
Ud.remove(oe)?na--:Vf.add(oe);Ud.add(qh.value);na++}}}else switch(qh.type){case 5:Vf.contains(qh.value)||(Ud.add(qh.value),na++);break;case 7:Ud.add(qh.fqa);na++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Ud.add(qh.value),na++}13===rf.groupType&&(xg=rc.fmb()?0<$a.length?String.format(Object(aa.a)("SeeMoreResultsButtonText"),$a):Object(aa.a)("SeeMoreResultsButtonTextNonParameteried"):
String.format(Object(aa.a)("InsightsButtonText"),$a));21===rf.groupType&&(xg=Object(aa.a)("LearningUILiveText"))}Xb+=na;""!==xg&&0<na&&(yd+=" , "+na.toString()+" "+Object(aa.a)("TellMeSectionLiveNotification")+" "+xg+" , ");0<Ud.count&&!ie&&(na=appChrome.api.menuSection(Ud.toArray(),rf.displayName,null,Pi[rf.groupType]),Nc.push(na))}Be=null;0<Xb&&(Be=0<$a.length?1!==Xb?String.format(Object(aa.a)("SearchLiveNotificationForTermedQueryResults"),Xb,$a):String.format(Object(aa.a)("SearchLiveNotificationForTermedQueryResult"),
$a):1!==Xb?String.format(Object(aa.a)("LookupLiveNotificationResultPluralFormText"),Xb):Object(aa.a)("LookupLiveNotificationResultSingularFormText"),ie?($a=appChrome.api.menuSection(Ud.toArray(),"",null,null),Nc.push($a)):Be+=yd);Fb&&(this.Zd.vAb?Rd.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Be)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Be)));nc.sections=Nc;return new zk(nc,Xb,[])}static get dyi(){return Ck.q6k||(Ck.q6k=new zk(Object.assign(new nl,
{sections:[]}),0,[]))}}Ck.q6k=null;Object(m.a)(Ck,"TellMeMenuDefintionGenerator",null,[]);var Ak;(function(na){na[na.A1n=0]="TellMeControlActivated";na[na.C1n=1]="TellMeQueryExecuted";na[na.E1n=2]="TellMeResultsRendered";na[na.B1n=3]="TellMeControlDeactivated"})(Ak||(Ak={}));Object(m.b)("PerformanceMarker",Ak);var Pk;(function(na){na[na.G1n=0]="TellMeTimeToRender";na[na.F1n=1]="TellMeSessionLength";na[na.D1n=2]="TellMeResultTriageTime"})(Pk||(Pk={}));Object(m.b)("PerformanceMeasure",Pk);class vl{mark(na){window.performance.mark(Ak[na])}measure(na,
$a,Fb){try{window.performance.measure(Pk[na],Ak[$a],Ak[Fb])}catch(Xb){Rd.instance.Jp().onError("TellMePerformance:Measure","error measuring "+Pk[na])}}vxj(na,$a,Fb){Rd.instance.Jp().Byj($a,Fb,na,this.sQm(na))}upc(na){for(const $a of na)window.performance.clearMarks(Ak[$a])}clearMeasures(na){for(const $a of na)window.performance.clearMeasures(Pk[$a])}sQm(na){let $a=0;(na=this.HLm(na))&&0<na.length&&($a=na[na.length-1].duration);return $a}HLm(na){return window.performance.getEntriesByName(Pk[na],"measure")}}
Object(m.a)(vl,"TellMePerformance",null,[]);class Bl{constructor(na){this.Emm=na}X1j(na,$a,Fb){Rd.instance.Jp().abb($a,Gj.VKe,na.data.Ze.toString(),Math.round(window.performance.now()-Fb),Gj.VKe,!0,Ni.Yac);na=hb.b(na.data.responseData);$a=-1;na.Index&&($a=na.Index);Rd.instance.Jp().C$m($a,this.Emm)}oxg(na,$a,Fb){Rd.instance.Jp().abb($a,Gj.VKe,na.data.Ze.toString(),Math.round(window.performance.now()-Fb),Gj.VKe,!1,Ni.Yac)}XRm(na){if(na&&""!==na.trim()){const Fb=window.performance.now(),Xb=n.AFrameworkApplication.i7l;
var $a={};$a.Text=na;$a.IsFileHash="false";$a=hb.c($a);n.AFrameworkApplication.ye.rk(Xb,2,$a,{"Content-Type":"application/json",Accept:"application/json"},!1,0,nc=>{this.X1j(nc,na.length,Fb)},nc=>{this.oxg(nc,na.length,Fb)},null,null,!1,4E3,6E3)}}}Object(m.a)(Bl,"TellMeQueryIndexCallback",null,[]);class Zf{constructor(na,$a,Fb){this.xml=na;this.G_l=$a;this.gFm=Fb}}Object(m.a)(Zf,"GeneratedMenuXml",null,[]);class Ki{constructor(na,$a){this.L7g=na||{};this.Njc=$a}get Uke(){return 5}qsa(na,$a=null){return this.Njc.qsa(na,
$a)||this.wum(na.value)}wum(na){return Ki.vum(na,this.L7g[na]||null)}static vum(na,$a=null){na=String.format('<ClonedControl Id="{0}" ',na);for(const nc in $a){var Fb=nc,Xb=$a[nc];Xb=Xb?ha.a.Re(Xb.toString()):"";na+=String.format('{0}="{1}" ',Fb,Xb)}return na+"/>"}}Object(m.a)(Ki,"CommandMenuItemFactory",null,[1551]);class Xg{constructor(){this.Mhm=Object(aa.a)("FindInDocumentText")}get Uke(){return 8}qsa(na){var $a=na.fqa;na=ha.a.Re(na.value);const Fb=ha.a.Re($a);$a=ha.a.Re(String.format(this.Mhm,
$a));return this.QKm(na,Fb,$a)}QKm(na,$a,Fb){return Oa.a(na,"1540292897",Fb,rc.cJm,null,$a,Fb,null,null)}}Object(m.a)(Xg,"FindInDocumentMenuItemFactory",null,[1551]);class el{constructor(na=null){this.Bim=na||Object(aa.a)("InsightsButtonText")}get Uke(){return 10}qsa(na){var $a=na.fqa;na=rc.fmb()?rc.hrc($a,1):rc.Wpi($a);$a=String.format(this.Bim,$a);return this.VKm(na,$a)}VKm(na,$a){return Oa.a(Ub.dBl,rc.fmb()?"1914896509":"3317204163",ha.a.Re($a),rc.W2m,null,ha.a.Re(na),ha.a.Re($a),null,null)}}Object(m.a)(el,
"InsightsMenuItemFactory",null,[1551]);class Dj{get Uke(){return 7}qsa(na){const $a=Object(ed.a)(Fh,na);return this.hLm(ha.a.Re(na.value),$a.id)}hLm(na,$a){return Oa.a($a,"1404166600",na,null,null,na,na,null,null)}}Object(m.a)(Dj,"TryQueryMenuItemFactory",null,[1551]);class Sg{constructor(na){this.nDa=[];this.Zd=na}POm(na){for(const $a of this.nDa)if($a.Uke===na)return $a;return null}NCb(na){this.nDa.push(na)}kEn(na){this.NCb(new Ki(this.Zd.Ezm,na));this.NCb(new cb(this.Zd.Wmn));this.NCb(new ji(this.Zd.yJn,
this.Zd.xJn,this.Zd.YTn,this.Zd.CYm,this.Zd.oOn));this.NCb(new el);this.NCb(new Xg);this.NCb(new Ca);this.NCb(new Dj)}}Object(m.a)(Sg,"MenuItemFactoryRegistry",null,[]);class Jk{constructor(na,$a){this.Zd=na;this.O9k=new Sg(this.Zd);this.O9k.kEn($a)}dLm(na,$a){let Fb=0;const Xb=[],nc=[];for(const yd of na){na=rc.zPk;var Nc=[];for(const Ud of yd.results){const ie=this.O9k.POm(Ud.type).qsa(Ud,$a);na=rc.zPk;Nc.push(ie);if(13===Ud.type||14===Ud.type)na="Menu32";17===Ud.type&&(na="MenuTellMeExtended");
Ud.groupType=yd.groupType;nc.push(Object(ed.a)(Lg,Ud))}Fb=Fb?Fb:Nc.length;Nc=Oa.c("TellMeDropdownControls",Nc);na=Oa.e("TellMeDropdownMenuSection",Nc,na,yd.displayName);Xb.push(na)}$a=Oa.f(Xb,"LookupDropdownMenu");return new Zf($a,Fb,nc)}static get ffh(){return Jk.r6k||(Jk.r6k=new Zf(Oa.f([],"LookupDropdownMenu"),0,[]))}}Jk.r6k=null;Object(m.a)(Jk,"TellMeXmlGenerator",null,[]);class lk{}lk.Mgn="MRU";lk.test="Test";Object(m.a)(lk,"ActionType",null,[]);var Bi;(function(na){na[na.u1n=0]="Service";na[na.Pcm=
1]="Local";na[na.$0n=2]="MRU";na[na.Ydm=3]="TestResult";na[na.Unknown=4]="Unknown"})(Bi||(Bi={}));Object(m.b)("SubResultType",Bi);var wk=a(21);class Cl{constructor(na,$a,Fb,Xb,nc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=na;this.IsEnabled=$a;this.ResultType=nj[Fb];this.SubResultType=Bi[Xb];this.OptionalData=nc?wk.a.toJSON(nc):null}}Object(m.a)(Cl,"ResultInfo",null,[]);var Ul=a(24),Ql=a(43),Vl=a(84);class Il{constructor(na,
$a=null){this.N7k="TellMeWAC.";this.Akm=na;this.Smm=$a}U5b(na,$a,Fb){$a=Ul.a.Gw($a);na=Ul.a.Gqi(na,this.Akm,this.Smm,Fb,$a);Ql.a.U5b(na,this.N7k)}T5b(na,$a,Fb=0){$a=Ul.a.Gw($a);Ql.a.T5b(Object.assign(new Vl.a,{name:na,dataFields:$a,durationMs:Fb}),this.N7k)}}Object(m.a)(Il,"TellMeOtelLogger",null,[1567]);class Qk{constructor(na,$a,Fb,Xb,nc,Nc,yd){this.eSa=this.eva=this.k5k=null;this.LM=na;this.vVe=$a;this.K9b=Fb;this.b3c=Xb;this.Aic=nc;this.hjm=Nc;this.eSa=yd?yd:new Il(this.b3c?Gh.a.vNe:Gh.a.hOe)}get JD(){return this.b3c}get sUa(){return this.K9b}swh(na){this.k5k=
na;switch(na){case sf.contextMenu:this.eva=sf.contextMenu;break;default:this.eva=sf.fI}}Ntm(na,$a){this.K9b.interactionId||(this.K9b.interactionId=ca.a.create().toString(),this.mFl(na,!0,$a))}Tpl(na,$a=!0){this.K9b.interactionId&&this.a$m(na,$a);this.b3c&&appChrome.api.updateTellMeCorrelationId("");this.K9b.interactionId=null}mFl(na,$a,Fb){const Xb=this.KSa(Yd.yEe);Xb[Ye.culture]=this.vVe;Xb[Ye.appName]=this.LM;Xb[Ye.context]=na;Xb[Ye.M9c]=this.Aic;Xb[Ye.$6m]=this.hjm;Xb[Ye.s6m]=Fb;Xb[Ye.W4m]=$a;
Xb[Ye.contentType]=Rd.instance.Eof;this.eSa.U5b(Yd.yEe,Xb,this.k5k);this.b3c&&appChrome.api.updateTellMeCorrelationId(this.K9b.interactionId)}a$m(na,$a){const Fb=this.KSa(Yd.fBl);Fb[Ye.SFm]=na;Fb[Ye.V4m]=$a;this.eSa.T5b(Yd.fBl,Fb)}B$m(na,$a,Fb){let Xb=0;!Fb&&0<na.length&&(Xb=na.trim().split(" ").length);const nc=this.KSa(Yd.query);nc[Ye.query]="!";nc[Ye.queryId]=$a;nc[Ye.pWl]=na.length;nc[Ye.qEl]=Fb;nc[Ye.i0n]=Xb;this.eSa.U5b(Yd.query,nc,this.eva)}n$m(na,$a,Fb,Xb,nc,Nc,yd,Ud=null){const ie=this.KSa(Yd.latency);
ie[Ye.culture]=this.vVe;ie[Ye.pWl]=na;ie[Ye.K8l]=$a;ie[Ye.statusCode]=Fb;ie[Ye.BKn]=nc;ie[Ye.isSuccess]=Nc;ie[Ye.s8m]=yd;Ud&&(ie[Ye.HUn]=Ud);this.eSa.T5b(Yd.latency,ie,Xb)}Byj(na,$a,Fb,Xb){const nc=this.KSa(Yd.performance);nc[Ye.culture]=this.vVe;nc[Ye.Otm]=Ak[na];nc[Ye.MGm]=Ak[$a];nc[Ye.avn]=Pk[Fb];this.eSa.T5b(Yd.performance,nc,Xb)}G$m(na,$a){if(na.results.length){var Fb=this.KSa(Yd.RZl);Fb[Ye.YQb]=$a.toString();Fb[Ye.groupType]=Pi[na.groupType];16===na.groupType&&(Fb[Ye.i6m]=Rd.instance.u1c);$a=
[];var Xb=[],nc=[];for(const Nc of na.results)Fb[Ye.resultType]||(Fb[Ye.resultType]=nj[Nc.type]),na={},27===Nc.type&&(na.AssetId=Nc.additionalInfo),Xb.push(yh.HAc(Nc.value)),$a.push(Nc.value),nc.push(new Cl(Nc.value,yh.HAc(Nc.value),Nc.type,Nc.subType,na));0<$a.length&&(Fb[Ye.iIn]="{"+$a.join(", ")+"}",Fb[Ye.zGm]="{"+Xb.join(", ")+"}",Fb[Ye.eIn]=hb.c(nc));this.eSa.U5b(Yd.RZl,Fb,this.eva)}}uLm(na,$a){if(4===na)return lk.Mgn;switch($a){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";
case 19:case 20:case 21:return"Notes"}return nj[$a]}N9m(na,$a,Fb,Xb,nc){const Nc=this.KSa(Yd.click);Nc[Ye.K8l]=na;Nc[Ye.bun]=$a;Nc[Ye.commandId]=Fb;Nc[Ye.uIa]=Xb;Nc[Ye.actionType]=this.uLm(nc.groupType,nc.resultType);Nc[Ye.resultType]=nj[nc.resultType];Nc[Ye.ZMk]=Bi[nc.ZMk];Nc[Ye.groupType]=Pi[nc.groupType];Nc[Ye.YQb]=nc.YQb.toString();Nc[Ye.Avi]=nc.Avi.toString();Nc[Ye.resultIndex]=nc.resultIndex.toString();this.eSa.U5b(Yd.click,Nc,this.eva)}Q9m(na,$a){this.K9b.interactionId||(this.K9b.interactionId=
ca.a.create().toString(),this.mFl("",!1,$a));$a=this.KSa(Yd.yll);$a[Ye.queryId]=na;this.eSa.T5b(Yd.yll,$a)}uFl(na,$a,Fb){if(na){if(Fb)for(const Xb in Fb)na[Xb]=Fb[Xb];this.eSa.T5b(Yd.events,na,$a)}}hBb(na,$a,Fb=null){const Xb=this.KSa(Yd.events);Xb[Ye.event]=na;this.uFl(Xb,Math.round($a),Fb)}GUb(na,$a,Fb=null){const Xb=this.KSa(Yd.events);Xb[Ye.event]=Yd.error;Xb[Ye.module]=na;Xb[Ye.errorMessage]=$a;Xb[Ye.message]=$a;this.uFl(Xb,Math.round(window.performance.now()),Fb)}M9m(na){const $a=this.KSa(Yd.Ckl);
$a[Ye.value]=na;$a[Ye.Lth]=this.b3c;this.eSa.U5b(Yd.Ckl,$a,this.eva)}A9m(na){const $a=this.KSa(Yd.Edl);$a[Ye.value]=na;$a[Ye.Lth]=this.b3c;this.eSa.U5b(Yd.Edl,$a,this.eva)}g$m(na){const $a=this.KSa(Yd.Srl);$a[Ye.value]=na;$a[Ye.Lth]=this.b3c;this.eSa.U5b(Yd.Srl,$a,this.eva)}A$m(na){const $a=this.KSa(Yd.iWl);$a[Ye.value]=na;$a[Ye.Lth]=this.b3c;this.eSa.U5b(Yd.iWl,$a,this.eva)}J9m(na){const $a=this.KSa(Yd.R1l);$a[Ye.value]=na;this.eSa.U5b(Yd.R1l,$a,this.eva)}D$m(na,$a){const Fb=this.KSa(Yd.oWl);Fb[Ye.VKe]=
na;$a&&(Fb[Ye.interactionId]=$a);this.eSa.T5b(Yd.oWl,Fb)}KSa(na){return{["SessionID"]:this.K9b.sessionId,["CorrelationID"]:this.K9b.interactionId,["Time"]:(new Date).getTime(),["Event"]:na,["Scenario"]:this.eva}}}Object(m.a)(Qk,"UsageLogger",null,[1547]);class oa{}oa.Callback="action";Object(m.a)(oa,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var Ia=a(654),Db=a(974),Vb=a(181),Ic=a(180),Pc=a(41);class bd{constructor(na=null){this.Njc=this.Je=this.Ba=this.Z3=this.Cda=this.ze=this.ya=this.X_=
this.YNh=this.rdl=this.Neb=null;this.v8k=this.dxe=!1;this.qwe=null;this.k0e=this.Aic=!1;this.E2c=this.zwe=this.WEb=this.e$g=this.J8g=this.iOh=null;this.Uwe=!1;this.eOh=0;this.nwe=null;this.P9k=0;this.A0e=!1;this.EA=this.dT=this.L2c=null;this.uvi=($a,Fb,Xb,nc,Nc)=>{if(Fb.contextId===Pc.a.frame)switch($a){case ub.a.fI:return this.fI($a,Fb,Xb,nc,Nc);case ub.a.yPk:return this.Kil($a,Fb,Xb,nc,Nc);case ub.a.CPk:return this.CFl($a,Fb,Xb,nc,Nc);case ub.a.FPk:return this.sFl($a,Fb,Xb,nc,Nc);case ub.a.EPk:return this.AFl($a,
Fb,Xb,nc,Nc);case ub.a.BPk:return this.yEe($a,Fb,Xb,nc,Nc);case ub.a.HPk:return this.jda(Xb);case ub.a.DPk:return this.zFl($a,Fb,Xb,nc,Nc);case ub.a.GPk:return this.rFl($a,Fb,Xb,nc,Nc);case ub.a.Bre:return this.xsl($a,Fb,Xb,nc,Nc);case ub.a.xPk:return this.ell($a,Fb,Xb,nc,Nc);case ub.a.IPk:case ub.a.htj:return this.zdj($a,Fb,Xb,nc,Nc);case ub.a.hDi:case ub.a.iDi:case ub.a.jDi:case ub.a.kDi:case ub.a.lDi:case ub.a.O2j:case ub.a.P2j:case ub.a.Q2j:case ub.a.JPk:return this.Zcc($a,Fb,Xb,nc,Nc);case ub.a.k6j:case ub.a.l6j:case ub.a.m6j:return this.wOf($a,
Fb,Xb,nc,Nc);case ub.a.APk:return this.sSl($a,Fb,Xb,nc,Nc);case ub.a.o2h:case ub.a.p2h:case ub.a.q2h:return this.DFe($a,Fb,Xb,nc,Nc);case ub.a.Wed:return this.Wed($a,Fb,Xb,nc,Nc);case ub.a.Bsj:return this.QEl($a,Fb,Xb,nc,Nc);case ub.a.cfk:return this.yWl($a,Fb,Xb,nc,Nc);case ub.a.$Hi:return this.ktl($a,Fb,Xb,nc,Nc)}return 2};this.yWl=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;if(Ya.b(Nc))return bd.instance.Rv.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Je.$Fi();if($a=
Nc.TerminalParentControlId){$a=this.Qoc.ha($a);if(!$a)return 16;Fb=[];Array.add(Fb,$a);if(!this.VEl(Fb))return 8}return 32};this.ktl=()=>{if(!this.Qoc.count)return 16;const $a=[];for(const Fb of this.Qoc.values)Array.add($a,Fb);return this.VEl($a)?32:8};this.wOf=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;if(Ya.b(Nc))return bd.instance.Rv.onError("TellMeActor:InsertMention","actiondata comes null"),16;$a=Nc.UILocation;let yd;Nc=Nc.CommandValueId;try{yd=hb.a(Nc)}catch(Ud){return bd.instance.Rv.onError("TellMeActor:InsertMention",
"commandValueId is not in proper format"),16}return Ya.b(yd)?(bd.instance.Rv.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Ya.b(this.J8g)?(bd.instance.Rv.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==$a?(bd.instance.Rv.onError("TellMeActor:InsertMention","location "+$a+" is unexpected"),16):this.J8g.wOf(yd.displayName,yd.email,yd.userId)?32:(bd.instance.Rv.onError("TellMeActor:InsertMention","mention is not inserted"),16)};this.Zcc=
($a,Fb,Xb,nc,Nc)=>1===Xb?32:Ya.b(Nc)?(bd.instance.Rv.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Nc.UILocation?this.S2m(Xb,Nc):this.cFa($a,Fb,Xb,nc,Nc);this.sSl=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;if(Ya.b(Nc))return bd.instance.Rv.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.dT&&window.setTimeout(()=>{this.dT.execute(yd=>{yd.wwb("TellMeSurvey",null)})},bd.zIm);return 32};this.QOa=($a,Fb,Xb,nc,Nc)=>{Xb=window.performance.now();this.mwn(Fb);bd.instance.Rv.mMn(Fb);
bd.instance.ux.JD?(this.E2c=this.YNh.cLm(Fb,$a,Nc),bd.instance.ux.vAb?(bd.instance.actions.push(appChrome.actions.updateTellMeSearchResults(this.E2c.menuModel,$a,Nc)),appChrome.api.dispatch(bd.instance.actions)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.E2c.menuModel,$a,Nc)),bd.instance.ux.Szh&&this.Uwe&&(Ya.b(bd.instance.Jka)||bd.instance.Jka.Location!==sf.contextMenu)&&(this.X_.mark(2),this.X_.measure(0,1,2))):this.WEb=this.rdl.dLm(Fb,bd.instance.Rv.sUa);this.nwe&&
this.ze.Qb(this.nwe);Nc={};Nc.GroupsCount=Fb.length;Nc.QueryID=nc;Nc.QueryLength=$a.length;bd.instance.Rv.Zca(Yd.RBm,window.performance.now()-Xb,Nc)};this.QEl=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;if(Ya.b(Nc))return bd.instance.Rv.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){$a={};$a.SourceControlId=Nc.SourceControlId;$a.Query=Nc.CommandValueId;Nc=this.ya.Qa(ub.a.bXf,2,$a);if(32!==
Nc)bd.instance.Rv.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+Nc+".");return Nc}return this.ya.Qa(ub.a.bXf,2,Nc)};this.DFe=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;if(Ya.b(Nc))return bd.instance.Rv.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;$a=Nc.CommandValueId;if(Ya.a($a))return bd.instance.Rv.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!jf.cud[$a])return bd.instance.Rv.onError("TellMeActor:LaunchAddin",
"Add-in with assetId "+$a+" doesn't not exist in entitlements"),16;Fb=jf.cud[$a];Xb={};Xb.solutionId=Fb.id;Xb.version=Fb.appVersion;Xb.storeType=Fb.storeType;Xb.storeId=Fb.storeId;Xb.assetId=Fb.assetId;Xb.assetStoreId=Fb.assetStoreId;Xb.displayName=Fb.displayName;Xb.targetType=Fb.targetType;Xb.height=Fb.height;Xb.width=Fb.width;Fb=this.ya.Qa(ub.a.Pjh,2,Xb);if(32!==Fb)bd.instance.Rv.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+Fb+". AssetId: "+$a);return Fb};
this.Wed=()=>{if(!Ya.b(this.dT))for(const $a of Sa.a.instance.OEb){if("ShowContextMenuWithFloatie"===$a.commandId)return this.dT.execute(Fb=>{Fb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if($a.commandId&&-1===$a.commandId.indexOf("Tab"))break}return 8};this.EA=na?na:new Rd}Zgh(){return this.EA.Zgh()}QKi(){return this.EA.QKi()}aZi(){return this.EA.aZi()}jKi(){return this.EA.jKi()}kKi(){return this.EA.kKi()}get Eof(){return this.Z3?this.Z3.contentType:bd.unknown}Fof(){return this.Z3?
[""]:[]}xQi(){return this.EA.Uab}Jp(){return this.EA.Jp()}get actions(){return this.EA.actions}set actions(na){this.EA.actions=na}ZCe(){return this.EA.ZCe()}wca(){return this.EA.wca()}tOi(){return this.EA.tOi()}get Ftg(){return this.EA.Ftg}set qxe(na){this.EA.Ftg=na}get d6g(){return this.EA.d6g}set C9g(na){this.EA.d6g=na}NXi(){return this.EA.NXi()}performance(){return this.X_}get jVg(){return this.EA.kpe}set jVg(na){this.EA.kpe=na}get u1c(){return this.EA.u1c}set u1c(na){this.EA.u1c=na}nD(na){return this.EA.nD(na)}initialize(na,
$a=null,Fb=null,Xb=null,nc=null,Nc=null,yd=null,Ud=null,ie=null,Be=null,oe=null){bd.instance.ux=na;this.Aic=!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.hmb;bd.instance.Rv=Xb;if(!Xb){Xb=new bi;Xb.sessionId=n.AFrameworkApplication.userSessionId;const rf=Ic.a.Ne(n.AFrameworkApplication.lcid)||Ic.a.oAc;bd.instance.Rv=new ee(new Qk(bd.instance.ux.application,rf.name,Xb,bd.instance.ux.JD,this.Aic,na.Jec,null),bd.instance.ux.Fzm,bd.instance.ux)}this.Njc=new Zi(bd.instance.ux.parameterData);
this.rdl=Fb||new Jk(bd.instance.ux,this.Njc);bd.instance.TCh=yd;this.YNh=this.YNh||new Ck(bd.instance.ux,bd.instance.ux.parameterData,yd);this.Je=y.FocusManager.instance();this.Uab=dl.createInstance(bd.instance.ux);bd.instance.lDe=new Zg(na);this.ya=nc||n.AFrameworkApplication.vb;this.ze=Nc||n.AFrameworkApplication.je;this.Cda=ie;this.Neb=$a;this.dT=oe;this.X_=new vl;this.Qoc=new Cd.a(Jd.a.Wn());this.e$g=[];ie?ie.execute(rf=>{rf.isFeatureEnabled(bd.KTn,!0).then(Vf=>{this.A0e=Vf;this.Neb=this.Neb||
ma.createInstance(this.Uab,bd.instance.ux,this.Njc,this.A0e);for(const xg of this.e$g)this.Neb.b3(xg.provider,xg.Jfd);this.e$g=[];return null})}):(this.A0e=!0,this.Neb=this.Neb||ma.createInstance(this.Uab,bd.instance.ux,this.Njc,this.A0e));this.Ba=Ud;this.WEb=Jk.ffh;this.C9g=new Promise(rf=>{this.iOh=rf});Be&&Be.execute(rf=>{this.Z3=rf})}Hb(){this.ypm()}ypm(){this.ya.sa(ub.a.fI,Pc.a.frame,Object(B.a)(this,this.fI,"tellMe"),96);this.ya.sa(ub.a.yPk,Pc.a.frame,Object(B.a)(this,this.Kil,"cacheAsyncMenuRefreshFunction"),
96);this.ya.sa(ub.a.CPk,Pc.a.frame,Object(B.a)(this,this.CFl,"logItemExecuted"),96);this.ya.sa(ub.a.FPk,Pc.a.frame,Object(B.a)(this,this.sFl,"logControlDeactivation"),96);this.ya.sa(ub.a.EPk,Pc.a.frame,Object(B.a)(this,this.AFl,"logInputFocus"),96);this.ya.sa(ub.a.BPk,Pc.a.frame,Object(B.a)(this,this.yEe,"interactionBegin"),96);this.ya.sa(ub.a.HPk,Pc.a.frame,Object(B.a)(this,this.yEe,"interactionBegin"),96);this.ya.sa(ub.a.DPk,Pc.a.frame,Object(B.a)(this,this.zFl,"logInputBlur"),96);this.ya.sa(ub.a.GPk,
Pc.a.frame,Object(B.a)(this,this.rFl,"logControlActivated"),96);this.ya.sa(ub.a.Bre,Pc.a.frame,Object(B.a)(this,this.xsl,"focusSearchBox"),96);this.ya.sa(ub.a.xPk,Pc.a.frame,Object(B.a)(this,this.ell,"constructLiveNotificationForMenu"),96);this.ya.sa(ub.a.IPk,Pc.a.frame,Object(B.a)(this,this.zdj,"insertTryQuery"),96);this.ya.sa(ub.a.htj,Pc.a.frame,Object(B.a)(this,this.zdj,"insertTryQuery"),96);this.ya.sa(ub.a.hDi,Pc.a.frame,this.Zcc,96);this.ya.sa(ub.a.iDi,Pc.a.frame,this.Zcc,96);this.ya.sa(ub.a.jDi,
Pc.a.frame,this.Zcc,96);this.ya.sa(ub.a.kDi,Pc.a.frame,this.Zcc,96);this.ya.sa(ub.a.lDi,Pc.a.frame,this.Zcc,96);this.ya.sa(ub.a.O2j,Pc.a.frame,this.Zcc,96);this.ya.sa(ub.a.P2j,Pc.a.frame,this.Zcc,96);this.ya.sa(ub.a.Q2j,Pc.a.frame,this.Zcc,96);this.ya.sa(ub.a.k6j,Pc.a.frame,this.wOf,96);this.ya.sa(ub.a.l6j,Pc.a.frame,this.wOf,96);this.ya.sa(ub.a.m6j,Pc.a.frame,this.wOf,96);this.ya.sa(ub.a.APk,Pc.a.frame,this.sSl,96);this.ya.sa(ub.a.JPk,Pc.a.frame,this.Zcc,96);this.ya.sa(ub.a.o2h,Pc.a.frame,this.DFe,
96);this.ya.sa(ub.a.p2h,Pc.a.frame,this.DFe,96);this.ya.sa(ub.a.q2h,Pc.a.frame,this.DFe,96);this.ya.sa(ub.a.Wed,Pc.a.frame,this.Wed,96);this.ya.sa(ub.a.Bsj,Pc.a.frame,this.QEl,96);this.ya.sa(ub.a.cfk,Pc.a.frame,this.yWl,96);this.ya.sa(ub.a.$Hi,Pc.a.frame,this.ktl,96)}bEn(na){this.qxe=!1;const $a=window.performance.now();na.Rmb.isCompleted?(this.qxe=!0,this.iOh(!0)):na.lma(()=>{this.qxe=!0;this.iOh(!0);bd.instance.Rv.Zca(Yd.EDm,window.performance.now()-$a)});this.nEn(na)}nEn(na){Vb.a.Zth(this.uvi);
Vb.a.wBe([new Db.a(ub.a.fI,Pc.a.frame,96),new Db.a(ub.a.yPk,Pc.a.frame,96),new Db.a(ub.a.CPk,Pc.a.frame,96),new Db.a(ub.a.FPk,Pc.a.frame,96),new Db.a(ub.a.EPk,Pc.a.frame,96),new Db.a(ub.a.BPk,Pc.a.frame,96),new Db.a(ub.a.HPk,Pc.a.frame,96),new Db.a(ub.a.DPk,Pc.a.frame,96),new Db.a(ub.a.GPk,Pc.a.frame,96),new Db.a(ub.a.Bre,Pc.a.frame,96),new Db.a(ub.a.xPk,Pc.a.frame,96),new Db.a(ub.a.IPk,Pc.a.frame,96),new Db.a(ub.a.htj,Pc.a.frame,96),new Db.a(ub.a.hDi,Pc.a.frame,96),new Db.a(ub.a.iDi,Pc.a.frame,96),
new Db.a(ub.a.jDi,Pc.a.frame,96),new Db.a(ub.a.kDi,Pc.a.frame,96),new Db.a(ub.a.lDi,Pc.a.frame,96),new Db.a(ub.a.O2j,Pc.a.frame,96),new Db.a(ub.a.P2j,Pc.a.frame,96),new Db.a(ub.a.Q2j,Pc.a.frame,96),new Db.a(ub.a.k6j,Pc.a.frame,96),new Db.a(ub.a.l6j,Pc.a.frame,96),new Db.a(ub.a.m6j,Pc.a.frame,96),new Db.a(ub.a.APk,Pc.a.frame,96),new Db.a(ub.a.JPk,Pc.a.frame,96),new Db.a(ub.a.o2h,Pc.a.frame,96),new Db.a(ub.a.p2h,Pc.a.frame,96),new Db.a(ub.a.q2h,Pc.a.frame,96),new Db.a(ub.a.Wed,Pc.a.frame,96),new Db.a(ub.a.Bsj,
Pc.a.frame,96),new Db.a(ub.a.cfk,Pc.a.frame,96),new Db.a(ub.a.$Hi,Pc.a.frame,96)],na)}xsl(na,$a,Fb){if(1===Fb)return 32;this.e3l();na=!1;(bd.instance.ux.Jec||this.Aic)&&($a=document.getElementById("SearchButton"))&&$a.click();if(!bd.instance.ux.Jec&&this.Aic)for($a=document.getElementsByClassName("ms-suiteux-search-box"),Fb=0;Fb<$a.length;Fb++){const Xb=$a[Fb].querySelector("input[type=search]");Xb&&(na=y.FocusManager.UA(Xb))}else na=y.FocusManager.UA($get(bd.instance.ux.JD?Gh.a.vNe:Gh.a.hOe));this.k0e=
!0;return na?32:8}zdj(na,$a,Fb,Xb,nc){if(1===Fb)return 32;if(Ya.b(nc))return bd.instance.Rv.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.e3l();na=nc.CommandValueId;$a=bd.instance.ux.JD?Gh.a.vNe:Gh.a.hOe;bd.instance.ux.JD&&!Ya.b(nc[Ia.a.J8])&&(nc[Ia.a.J8]=!1);if(na){if(bd.instance.ux.JD)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(na)),this.L2c=[19],32;if(nc=$get($a))nc.value=na}return y.FocusManager.UA($get($a))?32:8}e3l(){this.Je.yia(bd.instance.ux.Jec||
this.Aic?bd.instance.ux.tDe:bd.instance.ux.vUa,!1)}rLm(na,$a){switch(na){case 0:return String.format(Object(aa.a)("TellMeClassifierCommandAccessibleLabelFormat"),$a);case 4:return String.format(Object(aa.a)("TellMeRecentlyUsedAccessibleLabelFormat"),$a);case 5:return String.format(Object(aa.a)("TellMeTryQueryAccessibleLabelFormat"),$a);case 7:case 16:return String.format(Object(aa.a)("TellMeTryCommandAccessibleLabelFormat"),$a)}return $a}ell(na,$a,Fb,Xb,nc){if(1===Fb)return 32;if(Ya.b(nc))return bd.instance.Rv.onError("TellMeActor:ConstructLiveNotificationForMenu",
"actiondata comes null"),16;na=this.WEb?this.WEb.G_l:0;nc.Value=1!==na?String.format(Object(aa.a)("LookupLiveNotificationResultPluralFormText"),na):Object(aa.a)("LookupLiveNotificationResultSingularFormText");if(this.WEb)for(const Nc of this.WEb.gFm)nc=Object(Yc.a)(Fh,Nc)?Nc.id:ha.a.replaceAll(Nc.value,'"',""),(nc=$get(nc+"-"+rc.zPk))&&Zc.a.Uia(nc,Zc.a.yz,ha.a.Re(this.rLm(Nc.groupType,nc.innerText)));return 32}Kil(na,$a,Fb,Xb,nc){if(1===Fb)return 32;if(Ya.b(nc))return bd.instance.Rv.onError("TellMeActor:CacheAsyncMenuRefreshFunction",
"actiondata comes null"),16;this.nwe=new La.a(2,1,0,()=>{nc[oa.Callback]()},97);this.WEb&&this.ze.Qb(this.nwe);return 32}CFl(na,$a,Fb,Xb,nc){if(1===Fb)return 32;if(Ya.b(nc))return bd.instance.Rv.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;nc.CloseAllMenus&&(na=void 0===nc.ParentControlId||null===nc.ParentControlId?"<NA>":nc.ParentControlId,$a=this.qwe?this.qwe[nc.ControlId]:null,!$a&&this.qwe&&"<NA>"!==na&&($a=this.qwe[na]),$a||($a=this.dxe&&this.Uab.e4m(nc),$a=this.fEm($a,nc.ControlId),
$a=new wh($a,32,4,-1,-1,-1),bd.instance.Rv.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+nc.ControlId+" determined group:"+Pi[$a.groupType])),bd.instance.Rv.Mon(nc.ControlId,na,nc.CommandId,nc.CloseAllMenus,$a),this.Njc.knn(nc.ControlId),nc.Location!==sf.contextMenu&&(this.Uab.Znm(nc),this.Uab.b3($a.resultType),bd.instance.ux.bxh&&this.Neb.Lom(nc.CommandId)));return 32}sFl(na,$a,Fb,Xb,nc){if(1===Fb)return 32;(new Bl(this.ZCe())).XRm(this.zwe);na=this.zwe;$a=this.feh();Fb=bd.instance.Rv.V7g;
if(Ya.b(nc))return bd.instance.Rv.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;nc=nc.UILocation;na&&0<na.length&&this.A0e&&rc.uFk(bd.instance.ux)&&bd.instance.ux.slh&&19!==nc&&$a>Fb&&!bd.instance.ux.Gka&&(bd.instance.Rv.Wyj(na),bd.instance.Rv.Bzk($a));bd.instance.Rv.EHn();bd.instance.ux.Szh&&19!==nc&&(this.X_.mark(3),this.X_.measure(1,0,3),this.X_.measure(2,2,3),this.X_.vxj(0,1,2),this.X_.vxj(2,2,3),this.X_.vxj(1,0,3),this.X_.upc([0,1,2,3]),this.X_.clearMeasures([0,2,1]));
bd.instance.Rv.Won(window.performance.now()-this.eOh);bd.instance.ux.JD&&(this.E2c=null,bd.instance.Rv.lQl());this.k0e=this.Uwe=!1;this.zwe="";return 32}AFl(na,$a,Fb){if(1===Fb)return 32;bd.instance.Rv.mQl(Ji($a),this.k0e);return 32}zFl(na,$a,Fb){if(1===Fb)return 32;bd.instance.Rv.lQl();this.Uwe=!1;return 32}rFl(na,$a,Fb,Xb,nc){if(1===Fb)return 32;bd.instance.Jka=null;nc&&(bd.instance.Jka=nc);bd.instance.ux.Szh&&(Ya.b(bd.instance.Jka)||bd.instance.Jka.Location!==sf.contextMenu)&&this.X_.mark(0);bd.instance.Rv.swh(Ya.b(bd.instance.Jka)||
Ya.b(bd.instance.Jka.Location)?sf.unknown:bd.instance.Jka.Location);bd.instance.Rv.Von(this.P9k,this.k0e);this.Uwe||this.Nxg();return 32}sml(na,$a){const Fb=[],Xb=Date.now();for(const nc of na)na=(Xb-nc.timeStamp)/1E3,na=rc.czh(na),Array.add(Fb,new Ei($a?nc.commandId:nc.controlId,na));return Fb}MCm(na){const $a=[],Fb=Date.now();for(const Xb of na)if(Xb.controlId||"keyboardShortcut"===Xb.commandSurface)na=(Fb-Xb.timeStamp)/1E3,na=rc.czh(na),Array.add($a,new fk(Xb.controlId,Xb.commandId,na,Xb.commandSurface,
Xb.terminalParentControlId));return $a}Fml(na=!1){var $a=na?this.Uab.VRm():this.Uab.yBf();na=[];const Fb=Date.now();for(const Xb of $a)$a=(Fb-Xb.TimeStamp)/1E3,$a=rc.czh($a),Array.add(na,new Ei(Xb.Id,$a));return na}Nxg(){if(!this.Uwe){this.dxe=this.Uwe=!0;if(!this.v8k){this.v8k=!0;const na={};na.IsMLREnabled=bd.instance.ux.k5m;na.IsReactRibbonEnabled=bd.instance.ux.JD;na.IsSharedHeaderEnabled=!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.eO;na.IsSearchUxEnabled=this.Aic;na.IsTellMeInHeaderEnabled=
bd.instance.ux.Jec;na.IsGoLocalEnv=rc.J4m();na.IsSovereignEnvironment=rc.mFe();na.IsTellMeServiceResultsEnabled=rc.uFk(bd.instance.ux);na.IsSubstrateProviderEnabled=rc.tFk(bd.instance.ux);na.ShouldFetchTokens=!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.kwb;na.IsSerpletEnabled=rc.fmb();na.FirstOnClickTimeInMS=Math.round(window.performance.now());na.IsHeaderHidden=n.AFrameworkApplication.hideHeader||n.AFrameworkApplication.QV;na.IsSearchInHeaderHidden=n.AFrameworkApplication.gjh;void 0!==
window.performance.timing&&null!==window.performance.timing&&(na.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));na.IsFindWithMatchesEnabled=bd.instance.ux.Yrl;na.HelpShowsTopSearchResult=bd.instance.ux.xTg;na.HelpShowsNumberOfMatches=bd.instance.ux.wTg;n.AFrameworkApplication.ga&&(na.UiHost=n.AFrameworkApplication.ga.La("UiHostIntegrationType"));bd.instance.Rv.N$m(JSON.stringify(na))}this.kAe=this.sml(Sa.a.instance.ogc,!1);this.jAe=this.sml(Sa.a.instance.OEb,!0);
this.mPe=this.MCm(Sa.a.instance.OEb);this.oIe=this.Fml();this.pIe=this.Fml(!0);bd.instance.Rv.Nxg()}}yEe(na,$a,Fb,Xb,nc){if(1===Fb)return 32;if(Ya.b(nc))return bd.instance.Rv.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Tc.a.k8)return 32;this.eOh=window.performance.now();this.Nxg();na=new oj(this.QOa,0);bd.instance.Hub++;bd.instance.Rv.beginQuery("",bd.instance.Hub,this.dxe);this.Q2g(!0,null);this.WEb=Jk.ffh;this.E2c=Ck.dyi;if(this.Neb)bd.instance.actions=[],this.Neb.l8(new Sj("",
bd.instance.Hub),na,bd.instance.ux.JD);else bd.instance.Rv.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.nwe&&this.ze.Qb(this.nwe);return 32}jda(na){if(1===na)return 32;this.Je.qka(bd.instance.ux.Jec||this.Aic?bd.instance.ux.tDe:bd.instance.ux.vUa,!1);return 32}fI(na,$a,Fb,Xb,nc){if(1===Fb)return 32;if(Ya.b(nc))return bd.instance.Rv.onError("TellMeActor:TellMe","actiondata comes null"),16;bd.instance.Jka=nc;bd.instance.Rv.swh(Ya.b(bd.instance.Jka.Location)?
sf.unknown:bd.instance.Jka.Location);na=bd.instance.Jka.Value;bd.instance.ux.JD||na&&""!==na.trim()?(!this.E2c&&bd.instance.ux.JD&&(bd.instance.Rv.mQl(Ji($a),this.k0e),this.Nxg()),this.NHm(na,bd.instance.Jka.Location),bd.instance.Jka.PopulationXML=this.WEb.xml):this.dxe?bd.instance.Jka.PopulationXML=this.WEb.xml:(bd.instance.Jka.PopulationXML=Jk.ffh.xml,this.E2c=Ck.dyi,this.zwe="");return 32}NHm(na,$a){this.eOh=window.performance.now();bd.instance.ux.Szh&&$a!==sf.contextMenu&&this.X_.mark(1);bd.instance.ux.JD&&
appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(na));na&&0<na.trim().length&&(this.dxe=!1);bd.instance.ux.kHm();$a=Ya.b($a)?sf.fI:$a;if(na!==this.zwe||bd.instance.ux.JD){bd.instance.Hub++;bd.instance.Rv.beginQuery(na,bd.instance.Hub,this.dxe);this.Q2g(!0,null);const Fb=new Sj(na,bd.instance.Hub),Xb=new oj(this.QOa,bd.instance.Hub);this.WEb=Jk.ffh;this.E2c=Ck.dyi;if(this.Neb)bd.instance.actions=[],this.Neb.l8(Fb,Xb,bd.instance.ux.JD,$a,this.L2c),this.L2c=null;else bd.instance.Rv.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.P9k=bd.instance.Hub;this.zwe=na}}LXn(na){if(bd.instance.ux.JD){var $a=appChrome.selectors.getActiveControlStates();if($a=Object(ed.a)(Object,$a[na.value])){na.label=$a.label;let Fb=null;"description"in $a&&(Fb=$a.description);Fb&&Object.getType(Fb)===String?na.description=Fb:"secondaryText"in $a?na.description=$a.secondaryText:"fullDescriptionLabel"in $a&&(na.description=$a.fullDescriptionLabel)}}}mwn(na){this.qwe={};let $a=0,Fb=0;for(const Xb of na){na=
0;for(const nc of Xb.results)this.qwe[nc.value]=new wh(nc.groupType,nc.type,nc.subType,$a,na,Fb),na++,Fb++,nc.label||5!==nc.type||this.LXn(nc);0<na&&$a++}}cFa(na,$a,Fb,Xb,nc){if(1===Fb)return 32;if(Ya.b(nc))return bd.instance.Rv.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(na=nc.CommandValueId)&&window.open(na,"_blank");return 32}VEl(na){const $a={};$a.token=this.jVg;$a.files=hb.c(na);$a.type="MultiFilesDeckGeneration";if(n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",
!1))return this.ya.Qa(ub.a.SEl,2,$a),!0;na=rc.Jwl("",rc.H_l("GenerateDeckFromFile"),Object.assign(new fd.a,{landingTab:"All",data:$a}));na=this.ya.Qa(ub.a.pPf,2,na);return 32!==na?(bd.instance.Rv.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+na+"."),!1):!0}S2m(na,$a){if(1===na)return 32;if(Ya.b($a))return bd.instance.Rv.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Ya.b(this.J8g))return bd.instance.Rv.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),
16;na=$a.CommandValueId;return Ya.b(na)?(bd.instance.Rv.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.J8g.insertHtmlText(na)?32:(bd.instance.Rv.onError("TellMeActor:InsertUrl","url is not inserted"),16)}fEm(na,$a){return $a.startsWith(bd.instance.ux.JD?rc.MUk:rc.mzh)?5:na?4:"bSearchHelp"===$a||$a.startsWith("GetHelpFromTellMe")?8:"bInsights"===$a||$a.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===$a?24:$a===bd.instance.ux.Xrl?2:0}feh(){return this.EA.feh()}b3(na,
$a){this.Neb?this.Neb.b3(na,$a):Array.add(this.e$g,new ni(na,$a))}Q2g(na,$a="",Fb=null){return this.EA.Q2g(na,$a,Fb)}static get instance(){return bd.Wa||(bd.Wa=new bd(Rd.instance))}get ux(){return this.EA.ux}set ux(na){this.EA.ux=na}set TCh(na){this.EA.TCh=na}get lDe(){return this.EA.lDe}set lDe(na){this.EA.lDe=na}get Rv(){return this.EA.Rv}set Rv(na){this.EA.Rv=na}get Hub(){return this.EA.Hub}set Hub(na){this.EA.Hub=na}get Qoc(){return this.EA.Qoc}set Qoc(na){this.EA.Qoc=na}get Jka(){return this.EA.Jka}set Jka(na){this.EA.Jka=
na}get oIe(){return this.EA.oIe}set oIe(na){this.EA.oIe=na}get kAe(){return this.EA.kAe}set kAe(na){this.EA.kAe=na}get jAe(){return this.EA.jAe}set jAe(na){this.EA.jAe=na}get mPe(){return this.EA.mPe}set mPe(na){this.EA.mPe=na}get Uab(){return this.EA.Uab}set Uab(na){this.EA.Uab=na}get kpe(){return this.EA.kpe}set kpe(na){this.EA.kpe=na}get pIe(){return this.EA.pIe}set pIe(na){this.EA.pIe=na}}bd.Wa=null;bd.KTn="mso_tellMeService";bd.unknown="Unknown";bd.zIm=500;Object(m.a)(bd,"TellMeActor",null,[]);
var qd=a(249),td=a(1072);class Nd{constructor(na=null,$a=null,Fb=null,Xb,nc=null){this.aEh=null;this.i4k=!1;this.O6k=this.t9b=null;this.Ylm=this.Pbl=this.Cfm=this.P6k=!1;this.L7g=null;this.Mfm=null==$a?n.AFrameworkApplication.d5c:$a;this.Cim=null==Fb?n.AFrameworkApplication.ibc:Fb;this.jmm=null==nc?n.AFrameworkApplication.j7b:nc;this.mim=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeHelpOnHelpIsEnabled");this.Imm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeCommandHookIsEnabled");
this.KNn(!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeIgnoreQueryForHelp"));this.Amm=!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.wbc;this.Bmm=!rc.eA()&&!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMePeopleSuggestionIsEnabled");this.zmm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeFileSuggestionIsEnabled");this.Dhm=!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.kwb;
this.Cmm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.Rlm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("HelpShowsTopSearchResult");this.rkm=this.xTg||this.wTg;this.pkm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("OnlineCommandSuggestionsIsEnabled");this.qkm=this.Plj;this.djm=!!n.AFrameworkApplication.ga&&this.Jec&&n.AFrameworkApplication.ga.getBooleanAppSetting("StyledHeaderInLabelIsEnabled");
this.Whm=n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.$hm=n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.Vhm=n.AFrameworkApplication.ga?parseFloat(n.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.ajm=
!!n.AFrameworkApplication.ga&&(n.AFrameworkApplication.ga.getBooleanAppSetting("SmartLookupNoteSearchIsEnabled")||n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.Vim=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.ljm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",
!1);this.Eim=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.isActionAIEnabledInTellMe",!1)&&(this.F7m||this.z5m);this.Txe=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.rmm=n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):
"https://substrate.office.com/search/api/v1/suggestions";this.aim=n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.Slm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.emm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.Wlm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("ShowFindInDocumentInZeroTermSearchBox")||this.Gka;this.jjm=!!n.AFrameworkApplication.ga&&(n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeTemplateProviderIsEnabled")||n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.Uim=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",
!1);this.$im=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeIsRuleBasedSortingEnabled")&&"en-US"===n.AFrameworkApplication.uiCulture;this.gjm=!!n.AFrameworkApplication.ga&&(n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeFeedbackProviderIsEnabled")||n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.ojm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeZeroTermContextualCommandSuggestionsEnabled");
this.Efm=this.Jec&&!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.gim=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.gmm=!!n.AFrameworkApplication.ga&&(n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==n.AFrameworkApplication.ga.La("Application"));
this.Zfm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.dnm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMePerformanceMarkerEnabled");this.Gim=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.Kim=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.Zhm=n.AFrameworkApplication.ga?n.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.ijm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeNotesSuggestionIsEnabled")||this.WDl;this.Iim=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.Jim=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.Him=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.ohm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.phm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.nhm=!!n.AFrameworkApplication.ga&&
n.AFrameworkApplication.wAe&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.skm=!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.wAe&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1);this.Dmm=this.a7m&&(this.R2j||this.S2j||this.pAg||this.Jec&&rc.fmb()&&!!n.AFrameworkApplication.ga&&(this.fNe||this.Ked||this.Led||this.Med||this.iNe||n.AFrameworkApplication.ga.getBooleanAppSetting("ShowAnswerSearchResults")||
n.AFrameworkApplication.ga.getBooleanAppSetting("ShowDefinitionSearchResults")||n.AFrameworkApplication.ga.getBooleanAppSetting("ShowEntitySearchResults")||n.AFrameworkApplication.ga.getBooleanAppSetting("ShowWolframSearchResults")));this.pfm=!!n.AFrameworkApplication.ga&&!n.AFrameworkApplication.ga.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")&&n.AFrameworkApplication.ga.getBooleanAppSetting("AppsForOfficeAllowExternalMarketplace")&&n.AFrameworkApplication.uSa;this.qfm=!!n.AFrameworkApplication.ga&&
n.AFrameworkApplication.ga.getBooleanAppSetting("AppsForOfficePrivateCatalogIsEnabled");this.U1m(na||{});this.vSh="2918242107";this.uSh="1454393937";this.Vod={};this.c4c=[];this.Fzm=[rc.mzh]}get application(){return this.t9b}get d5c(){return this.Mfm}get yJn(){return this.vSh}get xJn(){return this.uSh}get Xrl(){return this.O6k}get dJm(){return this.P6k}get ibc(){return this.Cim}get j7b(){return this.jmm}get avd(){return this.Cfm}get CYm(){return this.mim}get YTn(){return this.Imm}get a7m(){return!0}get LTn(){return this.Dmm}get oOn(){return this.Pbl}KNn(na){this.Pbl=
na}get Jec(){return this.Amm}get gZg(){return this.Bmm}get fZg(){return this.zmm}get HIm(){return this.Dhm}get JTn(){return this.Cmm}get lTk(){return!1}get pAg(){return this.rkm}get R2j(){return this.pkm}get S2j(){return this.qkm}get Q9c(){return!1}get slh(){return!1}get Ppj(){return this.djm}get rHk(){return this.Ylm}get fNe(){return!1}get POn(){return!1}get Q8m(){return""}get FQi(){return 2}get YRm(){return 4}get ZRm(){return 5}get XSm(){return""}get QOm(){return this.Whm}get Iwl(){return this.$hm}get ZSm(){return 1E3}get YSm(){return 1E-6}get $Sn(){return this.rmm}get fNk(){return!1}get ZSn(){return!1}get W5m(){return this.$im}get jlh(){return!1}get epj(){return!1}get h5m(){return!1}get g5m(){return!1}get WDl(){return!1}get ZDl(){return!1}get Yrl(){return!1}get poe(){return!1}get Ked(){return!1}get Led(){return!1}get Med(){return!1}get iNe(){return!1}get xTg(){return this.Rlm}get bNe(){return this.Slm}get wTg(){return!1}get rLi(){return null}get Woj(){return!1}get bxh(){return this.Wlm}get Ivl(){return 0}get HMm(){return this.Vhm}get Rwl(){return this.aim}get G6m(){return this.ajm}get bkh(){return this.Eim}get axh(){return this.Txe}get zvl(){return-3.9}get Gka(){return this.emm}get tVf(){return this.jjm}get pmj(){return this.Uim}get qqj(){return this.gjm}get b5c(){return this.Efm}get J7m(){return this.ojm}get vAb(){return this.gim}get x5l(){return this.gmm}get Ztm(){return this.Zfm}get Szh(){return this.dnm}get gkh(){return this.Gim}get t3m(){return this.Kim}get NL(){return this.Zhm}get R9c(){return this.ijm}get r3m(){return this.Iim}get s3m(){return this.Jim}get q3m(){return this.Him}get Mfl(){return this.pfm}get Nfl(){return this.qfm}get U9a(){return this.ohm}get kfh(){return this.phm}get gfh(){return this.nhm}get F7m(){return this.ljm}get z5m(){return this.Vim}get jtn(){return this.skm}get Cx(){return!!n.AFrameworkApplication.Ea&&
n.AFrameworkApplication.Ea.Kb.JD}get JD(){return!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.JD}get k5m(){return!!n.AFrameworkApplication.Ea&&n.AFrameworkApplication.Ea.Kb.lFa}get Wmn(){return Ja.d("OfficeAssistant_32x32x32")}ZOm(){return Promise.reject("GetFindMatchCount method is not overridden")}rFe(na){return Array.contains(appChrome.selectors.getVisibleControlIds(),na)}pkh(){return!1}get Jlj(){return!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeModelRankerEnabled")}get n7l(){return n.AFrameworkApplication.ga?
n.AFrameworkApplication.ga.La("TellMeServiceHelpClassifierModelName"):""}get Plj(){return!!n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeMultiLingualCommandModelEnabled")}get tDe(){return"NoOpHeaderUi"}get Ezm(){return this.L7g}get parameterData(){return this.Vod}get aWn(){return this.c4c}kHm(){if(this.aEh&&!this.i4k&&(this.i4k=!0,this.UMe(this.aEh),this.JD)){var na=z.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");na=(new td.a(na)).dGd(this.aEh.Uba);
appChrome.api.dispatch(na)}}UMe(){}hEm(na){const $a=[];for(let Fb=0;Fb<na.length;++Fb)na[Fb].$On?$a.push(new df.a(na[Fb].alternate,rc.B8l+Fb.toString())):$a.push(new df.a(na[Fb].standard,rc.mzh+Fb.toString()));return $a}U1m(na){const $a={};for(const Fb in na){const Xb=Fb,nc=na[Fb];for(const Nc in nc){const yd=Nc,Ud=nc[Nc];($a[yd]||($a[yd]={}))[Xb]=Ud}}this.L7g=$a}get o7l(){return""}get $4l(){return!1}}Object(m.a)(Nd,"TellMeApplicationData",null,[1510]);class Zd{constructor(na,$a=null,Fb=!1){this.standard=
na;this.alternate=$a;this.$On=Fb}}Object(m.a)(Zd,"TryQuerySet",null,[]);class Sd{constructor(){this.Y9k=this.Z9k=null}get Hgn(){return this.Y9k}qsa(na){this.Z9k=na;return this.oBm(na)}inn(){this.Y9k=this.Z9k}VPm(na){return 8===na.type?String.format(Object(aa.a)("FindInDocumentText"),na.fqa):na.fqa}TMm(na){return na.fqa}}Object(m.a)(Sd,"ParameterizedCommand",null,[]);class qe extends Sd{constructor(na){super();this.w6m=na}get commandId(){return this.w6m?"FindParameterized":"EditingFind"}get $tn(){return"Find"}oBm(na){if(!na)return null;
const $a=ha.a.Re(String.format(ResourceStrings.l_ParamFindInDocTitle,na.fqa));return Oa.a(rc.NCm(na.value),"1540292897",$a,"Find_16x16x32",null,ha.a.Re(na.fqa),$a,null,null)}}Object(m.a)(qe,"FindParameterizedCommand",Sd,[]);var Xe=a(323);class Te extends Nd{constructor(){super(window.TellMeControlMetadataOverrides);this.t9b="PowerPoint";if(n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeTryQueriesIsEnabled")){var na=[new Zd(ResourceStrings.l_TellMeTryQuery01,"",!1),new Zd(ResourceStrings.l_TellMeTryQuery02,
"",!1),new Zd(ResourceStrings.l_TellMeTryQuery03,"",!1),new Zd(ResourceStrings.l_TellMeTryQuery04,"",!1),new Zd(ResourceStrings.l_TellMeTryQuery05,"",!1)];this.c4c=this.hEm(na)}n.AFrameworkApplication.ga.getBooleanAppSetting("TellMeFindInDocumentIsEnabled")&&(na=new qe(Te.u6m()),this.parameterData[na.commandId]=na,this.P6k=!0,this.O6k=na.commandId)}get vUa(){return Xe.a.vch}UMe(na){if(na){na=na.Uba;var $a=n.AFrameworkApplication.ga;na["PptTellMe.Animation"]=!$a.getBooleanAppSetting("TellMeAnimationsTransitionsIsEnabled")||
$a.getBooleanAppSetting(Ie.a.bEg);na["PptTellMe.Transition"]=!$a.getBooleanAppSetting("TellMeAnimationsTransitionsIsEnabled");na["PptTellMe.SelectAll"]=!$a.getBooleanAppSetting("TellMeSelectAllResultIsEnabled");na["PptTellMe.AnimationNew"]=!$a.getBooleanAppSetting(Ie.a.bEg)||!$a.getBooleanAppSetting("TellMeAnimationsTransitionsIsEnabled");na["PptTellMe.Designer"]=!$a.getBooleanAppSetting(Ie.a.xfe);$a=$a.getBooleanAppSetting("TellMeDesktopUpSellIsEnabled");var Fb=n.AFrameworkApplication.b7m;na["PptTellMe.WordArtUpSellButton"]=
!$a||Fb;na["PptTellMe.SpellCheckDictUpSellButton"]=!$a||Fb;na["PptTellMe.InsertAudioUpSellButton"]=!$a||Fb;na["PptTellMe.InsertChartUpSellButton"]=!$a||Fb;na["PptTellMe.WordArtUpSellButtonEnterprise"]=!$a||!Fb;na["PptTellMe.SpellCheckDictUpSellButtonEnterprise"]=!$a||!Fb;na["PptTellMe.InsertAudioUpSellButtonEnterprise"]=!$a||!Fb;na["PptTellMe.InsertChartUpSellButtonEnterprise"]=!$a||!Fb}}get WDl(){return n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeNotesSuggestionIsEnabled",
!1)}get ZDl(){return n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get Ivl(){return n.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.PowerPointOnline.NumberOfNotesSuggestionsToShow",2)}get o7l(){return n.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMultiLanguageModelName","")}get fNk(){return n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeServiceAADAuthIsEnabled",
!1)}get n7l(){return n.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeHelpClassifierModelName","")}get fNe(){return n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowImageSearchResults",!1)}get Plj(){return n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMLCModelIsEnabled",!1)}get FQi(){return n.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMenuUpdatePolicy",
0)}get $4l(){return n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowMoreFileResults",!1)}get slh(){return n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeEnableRankerLogging",!1)}get Q6m(){return n.AFrameworkApplication.wAe&&n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSummarizeDeckInTellMe",!1)}get rLi(){const na={};n.AFrameworkApplication.ga.getBooleanAppSetting("PPTOModernFontPickerIsEnabled")?
na.FontName="FontPicker":na.FontPicker="FontName";na.NewSlide="NewSlideSplit";na.ChangeLayout="ChangeLayoutFlyout";return na}get zvl(){var na=n.AFrameworkApplication.ga.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.NBClassifierScoreThreshold","-3.9");na=parseFloat(na);return isNaN(na)?-3.9:na}get jlh(){return n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.IsSerpletClassifierEnabled",!1)}get Mfl(){return n.AFrameworkApplication.ga.getBooleanAppSetting(Ie.a.T4c)}get Nfl(){return n.AFrameworkApplication.ga.getBooleanAppSetting(Ie.a.a5c)}static u6m(){return!!n.AFrameworkApplication.Ea&&
n.AFrameworkApplication.Ea.Kb.Cx}}Object(m.a)(Te,"PowerPointTellMeApplicationData",Nd,[]);var af;(function(na){na[na.none=0]="none";na[na.R0k=1]="waitAll";na[na.F6n=2]="synchronizeFast";na[na.uTn=3]="synchronizeSlow"})(af||(af={}));Object(m.b)("ProviderSynchronizationType",af);var nf;(function(na){na[na.immediate=0]="immediate";na[na.R0k=1]="waitAll";na[na.D6n=2]="synchronizeAndWaitAll";na[na.E6n=3]="synchronizeAndWaitForRanker"})(nf||(nf={}));Object(m.b)("MenuUpdatePolicy",nf);class mf{constructor(na,
$a,Fb){this.CI=na;this.ob=$a;this.va=Fb}zca(){return"SummarizeSlidesProvider"}Ksa(){return this.CI.FQi?this.CI.FQi===nf.R0k?af.R0k:af.uTn:af.none}l8(na,$a,Fb,Xb,nc=null){var Nc,yd,Ud,ie;const Be=new Ng(na);if(this.L$(na))if(null!=nc&&0>nc.indexOf(Pi.j2k))$a.kE(Be);else{this.tPj="SummarizeDeckFromTellMe";if(1<(null===(yd=null===(Nc=this.ob)||void 0===Nc?void 0:Nc.mg())||void 0===yd?void 0:yd.length))this.tPj="SummarizeSlidesFromTellMe";else if(null===(ie=null===(Ud=this.va)||void 0===Ud?void 0:Ud.presentation)||
void 0===ie||!ie.slides||2>this.va.presentation.slideCount){$a.kE(Be);return}appChrome&&appChrome.selectors.isControlDisabled(this.tPj)?$a.kE(Be):(na=new Lg(this.tPj,nj.LCh,"","",Bi.Pcm),Fb=new Yg(Pi.LCh),Fb.oP(na),Be.AL(Fb),window.requestAnimationFrame(()=>{$a.kE(Be)}))}else $a.kE(Be)}L$(na){return!na||!na.Fl||!na.Fl.trim().length}}Object(m.a)(mf,"SummarizeSlidesProvider",null,[1292]);class Mf extends ne{constructor(){super()}get name(){return"PowerPointEditor.TellMe"}load(){this.init()}init(){if(n.AFrameworkApplication.h7l){var na=
qd.App.Vb.Kb.VGf(ub.a.fI);na.mSd?Mf.YTl():na.lma(Object(B.a)(this,this.qJn,"scriptResource_LoadFinished"));var $a=new Te;bd.instance.initialize($a,null,null,null,null,null,Object(B.a)(qd.App.Vb,qd.App.Vb.ugh,"forceUpdateRibbonControls"),n.AFrameworkApplication.ga,this.Ha.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Ha.Na("Common.IActionContextProvider"),this.Ha.Na("Common.ISystemInitiatedFeedback"));bd.instance.bEn(na);na=n.AFrameworkApplication.ga&&n.AFrameworkApplication.ga.getBooleanAppSetting(Ie.a.kUa);
$a.Q6m&&na&&bd.instance.b3(new mf($a,this.Ha.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Ha.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")),sf.fI)}}qJn(){Mf.YTl()}static YTl(){qd.App.Vb.Zf()}}Object(m.a)(Mf,"PowerPointTellMePackage",ne,[]);var Mg=a(492),Sf=a(383);class Kf{constructor(na,$a,Fb,Xb,nc,Nc){if(!na)throw Error.argumentNull("transactionFactory");if(!$a)throw Error.argumentNull("actionManager");if(!nc)throw Error.argumentNull("focusManager");if(!Nc)throw Error.argumentNull("pageView");
if(!Xb)throw Error.argumentNull("selectionManager");if(!Fb)throw Error.argumentNull("graphActionBlockingManager");this.Mb=na;this.Ma=nc;this.ia=$a;this.xb=Nc;this.ob=Xb;this.uc=Fb}Hb(){this.ia.sa(R.a.gYa,P.a.application,this.YVm.bind(this),4)}ve(){}YVm(na,$a,Fb,Xb,nc){return this.gYa($a,Fb,nc,na)}gYa(na,$a,Fb,Xb){var nc;na=this.ob.ud();if(!(0<(null===na||void 0===na?void 0:na.length))||na.some(Nc=>this.uc.Cd(Nc)))return 8;na=na.filter(Nc=>Nc.HA);if(0>=na.length)return 8;if(1===$a)return 32;fe.a.J(508560658,
822,15,"CameoStyle change started. CameoStyleId: '{0}'",Fb);$a=null===(nc=Cc.a.Ab)||void 0===nc?void 0:nc.actionName;for(const Nc of na)this.uX(Nc);nc=this.Mb.Fd(15,void 0,()=>{this.ob.Rj();this.Ma.Wd()});try{nc.rc(na[0]);nc.sc=Xb;for(const Nc of na)Nc.j5a=Fb}finally{nc&&nc.dispose()}Cc.a.Ab&&$a&&(Cc.a.Ab.actionName=$a,Cc.a.Ab.Ya("CameoStyleId",Fb.toString()),Cc.a.$Y(Cc.a.Ab));return 32}uX(na){null!==na&&void 0!==na&&na.Ww&&(na=this.Ak(na))&&na.pW(!1)}Ak(na){if(na)return na.tc(this.xb.Oa)}}Object(m.a)(Kf,
"CameoActor",null,[743]);class fh{constructor(){this.Sm=this.Jab=this.$=null}get name(){return"PowerPointWebEditor.Chronos1"}lc(na){this.$=na;this.Jab=this.$.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.Sm=this.Jab.oAb(4,this.name);this.$.register(eg,"PowerPointWebEditor.RehydrationHeaderHandler").ma().na(()=>new eg(this.$.resolve("PowerPointWebEditor.ICCPInfoOwner"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.ISessionInfoOwner")));
this.$.register(pg,"PowerPointWebEditor.SessionRehydrationController").ma().na(()=>new pg(this.$.resolve("Box4.IAppFrame").sP(),this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("Common.IKeyInputManager"),this.$.resolve("PowerPointWebEditor.IInputHandlerManager"),this.$.resolve("Common.IClickInputManager"),this.$.resolve("PowerPoint.IBrowserHelperManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
$a=>{y.FocusManager.UA($a)},n.AFrameworkApplication.DE?this.$.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"):null));this.$.register(1237,"PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager").ma().na(()=>new pf(this.$.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.IPPTWorkspace"),this.$.resolve("Common.IActionManager"),this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPointWebEditor.RehydrationHeaderHandler"),
this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.$.resolve("PowerPointWebEditor.IPopWebService"),this.$.resolve("PowerPointWebEditor.IPopSessionState"),this.$.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.$.resolve("PowerPointWebEditor.IErrorHandler"),this.$.resolve("Box4.IReplicationScheduler"),this.$.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.$.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.$.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),
this.$.resolve("PowerPointWebEditor.IInboundHelper"),this.$.resolve("PowerPointWebEditor.Image.IImageManager"),n.AFrameworkApplication.ye,this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("Common.IAppSettingsManager"),this.$.resolve("PowerPointWebEditor.IPPTOfflineManager"),this.$.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.$.Na("PowerPointWebEditor.ICommentSessionManager")));n.AFrameworkApplication.DE&&this.$.register(1238,"PowerPointWebEditor.IPPTTokenRefreshManager").ma().na(()=>
new fg(this.$.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.$.resolve("Common.ISessionExpirationManagerWithDialog"),this.$.resolve("PowerPointWebEditor.PresentationContext"),this.$.resolve("Common.IActionManager"),this.$.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){let na=this.Sm.qI("resolvechronos1");const $a=this.$.resolve("Common.AFrameworkApplication"),Fb=
this.$.resolve("PowerPointWebEditor.IApplicationContext").Md;var Xb=this.$.resolve("PowerPointWebEditor.View.IPPTPageView");const nc=this.$.resolve("Common.IActionManagerExtended"),Nc=this.$.resolve("PowerPointWebEditor.IFocusManager"),yd=this.$.resolve("Common.Transaction.ITransactionFactory"),Ud=this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),ie=this.$.resolve("PowerPointWebEditor.IShapeEditor"),Be=this.$.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
oe=this.$.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),rf=this.$.resolve("PowerPointWebEditor.PictureContext"),Vf=this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),xg=this.$.resolve("PowerPointWebEditor.IRibbonChangeManager"),qh=this.$.resolve("PowerPointWebEditor.IPictureUploader");this.Sm.uI(na);na=this.Sm.qI("regactorschronos1");Xb=[new Uc(nc,Be,Ud,Nc,this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),yd,qh,rf,ie,n.AFrameworkApplication.a1,xg,this.$.resolve("PowerPointWebEditor.IErrorHandler"),
Xb,this.$.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),Fb.wCl,this.$.resolve("PowerPointWebEditor.IInsertImageHelper"),Vf,oe,Fb,this.$.resolve("PowerPointWebEditor.IBusinessBarController"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("Common.IAppSettingsManager")),this.$.resolve("PowerPointWebEditor.IApplicationSettings").xJ?new Kf(yd,nc,Be,Ud,Nc,Xb):null].filter(E=>null!==E);for(var k of Xb)k.Hb(),k.ve();this.L1m();
this.Sm.uI(na);na=this.Sm.qI("tellme");k=new Mf;k.lc(this.$);k.load($a);this.Sm.uI(na);Fb.yfe&&Fb.Rh&&(na=this.Sm.qI("initrehydrationcontroller"),this.$.resolve("PowerPointWebEditor.SessionRehydrationController").init(),this.Sm.uI(na));Fb.mqa&&this.$.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager");n.AFrameworkApplication.DE&&(na=this.Sm.qI("posttokenrefresh"),this.$.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"),this.Sm.uI(na));this.e9m()}L1m(){const na=this.$.resolve("Common.IActionManagerExtended"),
$a=this.$.resolve("PowerPointWebEditor.IFocusManager"),Fb=this.$.resolve("Common.AFrameworkApplication").nj.Pd,Xb=this.$.resolve("Common.Transaction.ITransactionFactory"),nc=this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),Nc=this.$.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),yd=this.$.resolve("PowerPoint.IPathManager"),Ud=this.$.resolve("PowerPointWebEditor.IZoomContext"),ie=this.$.resolve("PowerPointWebEditor.IPresentationReader"),Be=Sf.a(this.$);Be("powerpoint-editor-intl").then(()=>
{fe.a.J(512497373,801,50,"Editor script is loaded successfully");Be("powerpoint-ribbon-intl").then(()=>{fe.a.J(512497372,801,50,"Ribbon script is loaded successfully");const oe=[];oe.push(new Ld(na,$a,Nc,Xb,Fb,this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ie,nc,yd,Ud));for(const rf of oe)rf.Hb(),rf.ve()}).catch(()=>{fe.a.J(512497371,801,10,"Failed to load Ribbon script")})}).catch(()=>{fe.a.J(512497370,801,10,"Failed to load Editor script")})}e9m(){fe.a.J(512497369,809,50,"Start to download chronos2 js file");
this.$.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").tca("pptedit.chronos2",null,()=>{const na=this.$.resolve("PowerPointWebEditor.ISessionState");na&&na.E8("Chronos2DownloadFinished")},()=>a.e(15).then(a.bind(null,1674)))}dispose(){const na=this.$.resolve("PowerPointWebEditor.IApplicationSettings");na.yfe&&na.Rh&&this.$.resolve("PowerPointWebEditor.SessionRehydrationController").dispose();n.AFrameworkApplication.DE&&na.Rh&&this.$.resolve("PowerPointWebEditor.IPPTTokenRefreshManager").dispose()}static main(){n.AFrameworkApplication.mi&&
Tc.a.zg?fe.a.J(512497368,809,15,"Firefox attempts to load chronos1 package when App is disposing"):l.a.instance.Fc(Mg.a(new fh,4))}}Object(m.a)(fh,"Chronos1Package",null,[3,4]);var xh=a(1028),Qg=a(55),th=a(719),Hh=a(459),Fg=a(274),Ij=a(267);class ej{constructor(){this.shadowDistance=this.shadowAngle=this.shadowBlur=this.shadowSize=this.shadowTransparency=this.shadowColor=null;this.hasShadow=!0}}Object(m.a)(ej,"Shadow",null,[]);class Yj{constructor(){this.hasReflection=this.reflectionDistance=this.reflectionBlur=
this.reflectionSize=this.reflectionTransparency=null}}Object(m.a)(Yj,"Reflection",null,[]);class Qe{constructor(na,$a,Fb,Xb,nc,Nc,yd,Ud,ie,Be,oe,rf,Vf,xg,qh,k,E,S,la,sa,pb,Ib,Wb,Gc,kd,Gd,Xd,Oe){this.type="FormatPictureTaskPaneProps";this.transparency=this.saturation=this.contrast=this.brightness=this.top=this.left=this.height=this.width=this.numberFormatInfo=null;this.shadowProperties=new ej;this.reflectionProperties=new Yj;this.isPictureReflectionInactive=this.isPictureShadowInactive=this.isPictureTransparencyInactive=
this.isPictureCorrectionsInactive=this.isCropInactive=!1;this.colorMenu=null;this.emptyValueFields=0;this.onSectionToggle=this.pictureCorrectionsSectionProps=this.onEffectToggleChange=this.onChange=this.formatPictureSections=null;this.colorPickerMenuProps=[];const le=Object(ed.a)(Object,Oc.e().numberFormatInfo);if(!le)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=le;this.width=na;this.height=$a;this.top=Xb;this.left=Fb;this.brightness=nc;this.contrast=Nc;this.saturation=yd;this.transparency=
Ud;this.shadowProperties.shadowColor=ie;this.shadowProperties.shadowTransparency=Be;this.shadowProperties.shadowSize=oe;this.shadowProperties.shadowBlur=rf;this.shadowProperties.shadowAngle=Vf;this.shadowProperties.shadowDistance=xg;this.shadowProperties.hasShadow=qh;this.reflectionProperties.reflectionTransparency=k;this.reflectionProperties.reflectionSize=E;this.reflectionProperties.reflectionBlur=S;this.reflectionProperties.reflectionDistance=la;this.reflectionProperties.hasReflection=sa;this.isCropInactive=
pb;this.isPictureCorrectionsInactive=Ib;this.isPictureTransparencyInactive=Wb;this.isPictureShadowInactive=Gc;this.isPictureReflectionInactive=kd;this.emptyValueFields=Gd;this.formatPictureSections=Xd;this.pictureCorrectionsSectionProps=Oe}}Object(m.a)(Qe,"FormatPictureTaskPaneProps",null,[]);var ef=a(1170),Ig=a(291),Wg=a(357),Vh=a(874);const zi=Ac.a("PicturePropertiesRename")?ResourceStrings.L_PictureCorrections:ResourceStrings.l_PictureProperties,di=ResourceStrings.L_PictureTransparency,ph=ResourceStrings.L_PictureShadow,
ki=ResourceStrings.L_PictureReflection,Yh=ResourceStrings.L_CropPicture;class Xh{constructor(na,$a,Fb,Xb,nc,Nc,yd,Ud,ie,Be,oe,rf,Vf){this.I9f=this.J9f=this.K9f=this.XHj=this.pHj=!0;this.GCj=this.MBj=this.EMl=this.jKl=this.v3=this.L3=0;this.VNj=100;this.cUa=this.PQj=0;this.Pph=1;this.bUa=this.$Ta=this.aUa=0;this.foh=!1;this.$pb=this.Zpb=this.aqb=this.bqb=0;this.BZb=this.mc=this.aIl=this.XFj=!1;this.Laa="#000000";this.O1=[0,0,0];this.ipf=this.G3a=null;this.ZLl=!1;this.xWb=new Map([[zi,!1],[di,!1],[Yh,
!1],[ph,!1],[ki,!1]]);this.bph=new Map([["FormatPictureSlider-Brightness",{isActive:!1}],["FormatPictureSlider-Contrast",{isActive:!1}],["FormatPictureSlider-Saturation",{isActive:!1}],[ph,{isActive:!1}],[ki,{isActive:!1}]]);this.bDm=()=>{const xg=Date.now();this.ipf&&500>xg-this.q4n||(this.ipf&&clearTimeout(this.ipf),this.ipf=setTimeout(()=>{this.mc&&this.Rn(!0);this.ipf=null},800))};this.onSectionToggle=(xg,qh)=>{this.xWb.forEach((k,E)=>this.xWb.set(E,E===xg?qh:!1));this.w9l();this.Rn(!0)};this.b1c=
(xg,qh,k,E,S)=>{xg=this.ob.ud().filter(la=>!!la);if(null===xg||void 0===xg||!xg.length)return fe.a.J(508056668,815,10,"FormatPicturePaneActor::updatePictureShadowColor, selected Picture: null"),16;if(1===k)return 32;k=S.Color;this.Laa=k=S.nonMoreColor?k:`#${JSON.parse(k).hex}`;this.G3a=this.qsb(S);ef.a.E4g(k,"FontRecentColors");S=Vh.a.Ygh(k);this.O1=[S.r,S.g,S.b];this.onEffectToggleChange([{property:14,value:this.foh},{property:9,value:this.cUa},{property:10,value:this.Pph},{property:11,value:this.aUa},
{property:12,value:this.$Ta},{property:13,value:this.bUa},{property:8,value:this.O1},{property:20,value:this.G3a}],0,!0);return 32};Vf("powerpoint-editor-intl").then(()=>{this.BZb=!0}).catch(xg=>{fe.a.J(512350083,801,10,"Failed to load powerpoint-editor-intl "+xg.toString())});this.ob=na;this.Db=$a;this.ia=Fb;this.Ma=Xb;this.ih=nc;this.va=Nc;this.xb=yd;this.ij=Ud;this.a2a=ie;this.uc=Be;this.Ad=oe;if(!rf)throw Error.argumentNull("appSettings");this.la=rf;this.ih.KHa(Object(B.a)(this,this.Erh,"onChangeRenderFormatPicturePane"));
this.Db.PM(Object(B.a)(this,this.Av,"onAppFrameModeSwitched"));this.Ad.JXa(Object(B.a)(this,this.Erh,"onChangeRenderFormatPicturePane"))}dispose(){this.ih.c6a(Object(B.a)(this,this.Erh,"onChangeRenderFormatPicturePane"));this.Db.R3(Object(B.a)(this,this.Av,"onAppFrameModeSwitched"));this.Ad.Bub(Object(B.a)(this,this.Erh,"onChangeRenderFormatPicturePane"))}ve(){}Hb(){this.ia.sa(R.a.Bdc,X.a.application,Object(B.a)(this,this.Bdc,"queryShowHideReactPictureCropPane"),96);this.ia.sa(R.a.Sed,X.a.application,
Object(B.a)(this,this.Sed,"showHideReactPictureCropPane"),4);this.ia.sa(R.a.Zec,X.a.application,Object(B.a)(this,this.Zec,"updatePictureCropPane"),4);this.ia.sa(R.a.Jtg,X.a.application,Object(B.a)(this,this.JWm,"handleMorePictureShadowColors"),96);this.ia.sa(R.a.b1c,X.a.application,this.b1c,96)}Z2l(na){this.ZLl=na}Bdc(na,$a,Fb,Xb,nc){(na=Object(ed.a)(lb.a,nc))&&na.xg(this.mc);return 32}Sed(na,$a,Fb,Xb,nc){if(!this.BZb)return 8;if(1===Fb)return 32;$a=this.va.presentation;if(!this.va.Ga||!$a||this.uc.Cd($a))return 16;
this.wMn(nc);return Rc.b("ShowHideReactPictureCropPane:",this.mc.toString(),na,()=>{if(this.mc=!this.mc){if(this.Rn(),!this.la.ync&&Ac.a("CropControlEnableOnDisplayingFormatPicturePane")){const Nc=this.ob.lo();(null===Nc||void 0===Nc?0:Nc.Ww)||this.ia.Cb(R.a.N$b,2)}}else this.Tw();return 32})}wMn(na){null!=na&&"FormatPicture"===na.SourceControlId?(this.xWb.set(zi,!0),this.xWb.set(Yh,!1)):(this.xWb.set(Yh,!0),this.xWb.set(zi,!1));this.xWb.set(di,!1);this.xWb.set(ph,!1);this.xWb.set(ki,!1)}Zec(na,$a,
Fb,Xb,nc){if(!this.mc)return 8;if(2===Fb)if(this.la.ync)this.onSectionToggle(nc.sectionName,nc.sectionNewState);else this.Rn(!0);return 32}Rn(na=!1){var $a=this.cih();$a=this.ML($a);const Fb=Object.assign(new xh.a,{title:ResourceStrings.L_FormatPicture,hideHeader:!1,width:320,location:2,contentProps:$a,onOpen:()=>{},onClose:()=>{this.mc=!1},isModernPane:!0});Qg.a.Py().then(Xb=>{na?Xb.updateTaskPane(Ij.a.ysb,Fb):Xb.showTaskPane(Ij.a.ysb,Fb);return null}).catch(Xb=>{fe.a.J(512350082,822,10,"Failed to show picture crop pane. Exception: "+
Xb.toString())})}Tw(){Qg.a.Py().then(na=>{na.hideTaskPane(Ij.a.ysb,2);return null}).catch(na=>{fe.a.J(512350081,822,10,"Failed to hide picture crop pane. Exception: "+na.toString())})}ML(na){if(na){const $a=na.FLi(),Fb=this.xb.yd;this.v3=th.a.Xv(Fb.vf(this.ij.YF(Fg.a.Pm($a.ha(0),$a.ha(3)),na.zoom),1));this.L3=th.a.Xv(Fb.vf(this.ij.YF(Fg.a.Pm($a.ha(0),$a.ha(1)),na.zoom),0));this.jKl=th.a.Xv(Fb.vf(this.ij.YF($a.ha(0).x,na.zoom),0));this.EMl=th.a.Xv(Fb.vf(this.ij.YF($a.ha(0).y,na.zoom),1));this.pHj=
!1;this.aIl=!0}else this.pHj=!0;na=this.aIl?0:15;this.la.ync&&(this.I9f=this.J9f=this.K9f=this.XHj=!1,this.Vkh()||(na=15,this.I9f=this.J9f=this.K9f=this.XHj=!0),this.HBn(),this.YXn(),this.ZXn(),this.JBn(),this.IBn());na=new Qe(this.L3,this.v3,this.jKl,this.EMl,this.MBj,this.GCj,this.VNj,this.PQj,this.Laa,this.cUa,this.Pph,this.aUa,this.$Ta,this.bUa,this.foh,this.bqb,this.aqb,this.Zpb,this.$pb,this.XFj,this.pHj,this.XHj,this.K9f,this.J9f,this.I9f,na,this.xWb,this.bph);na.colorPickerMenuProps=this.QGd("FillColorPicker");
na.onColorSelect=Object(B.a)(this,this.onColorSelect,"onColorSelect");na.showMoreColorsDialog=Object(B.a)(this,this.showMoreColorsDialog,"showMoreColorsDialog");na.onChange=Object(B.a)(this,this.TAa,"onPropertyChange");na.onEffectToggleChange=Object(B.a)(this,this.onEffectToggleChange,"onEffectToggleChange");na.onSectionToggle=this.onSectionToggle;return na}cih(){const na=this.ob.lo();return na&&na.Ww&&na.isConnected?this.a2a.k5(na):null}YXn(){this.Lyk(!1);Ac.a("FormatPictureSVGsupportEnabled")?this.Vkh()&&
!this.CDl()&&(this.Lyk(!0),this.FDl()&&this.bph.set("FormatPictureSlider-Saturation",{isActive:!1})):!this.Vkh()||this.FDl()||this.CDl()||this.Lyk(!0)}ZXn(){this.I9f=this.J9f=this.K9f=!0;this.Vkh()&&(this.I9f=this.J9f=this.K9f=!1)}Vkh(){const na=this.ob.ud(),$a=this.ob.Qvc(na);return 1===na.length&&(null===$a||void 0===$a?void 0:$a.Kg)}FDl(){const na=this.ob.ud();return this.ob.Qvc(na).get_isSVGBlipFilled()}CDl(){const na=this.ob.ud();return this.ob.Qvc(na).isGif}Lyk(na){this.bph.forEach(($a,Fb)=>
this.bph.set(Fb,{isActive:na}))}HBn(){if(this.la.ync){const na=this.ob.lo();null==na||this.la.Ruc&&!this.ZLl||(this.MBj=na.R6.brightness,this.GCj=na.R6.contrast,this.VNj=na.R6.saturation,this.PQj=na.R6.transparency,this.la.Ruc&&this.Z2l(!1))}}JBn(){if(this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.PictureShadowEffectsEnabled",!1)){const na=this.ob.lo();null!=na&&null!=na.lp&&(this.foh=na.lp.hasShadow,this.O1=na.lp.color,this.cUa=na.lp.transparency,this.Pph=na.lp.size,this.aUa=
na.lp.blur,this.$Ta=na.lp.angle,this.bUa=na.lp.distance,this.Laa=(new Vh.a(this.O1[0],this.O1[1],this.O1[2])).GDb(),this.G3a=Wg.a.parse(this.Laa))}}IBn(){if(this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.PictureReflectionEffectsEnabled",!1)){const na=this.ob.lo();null!=na&&null!=na.Cv&&(this.XFj=na.Cv.hasReflection,this.bqb=na.Cv.transparency,this.aqb=na.Cv.size,this.Zpb=na.Cv.blur,this.$pb=na.Cv.distance)}}onEffectToggleChange(na,$a,Fb){var Xb;const nc={};for(const Nc of na)nc[Nc.property]=
Nc.value;nc.effectType=$a;nc.IsChanged=Fb;0===$a?(na.some(Nc=>20===Nc.property)||(this.Laa=null===(Xb=na.find(Nc=>8===Nc.property))||void 0===Xb?void 0:Xb.value,nc[20]=Wg.a.parse(this.Laa)),this.ia.Qa(R.a.Fwh,2,nc)):1===$a&&this.ia.Qa(R.a.Tth,2,nc);this.Rn(!0)}TAa(na,$a,Fb){const Xb={};Xb.Number=na;Xb.IsChanged=Fb;switch($a){case 0:this.ia.Qa(R.a.$Oe,2,Xb);break;case 1:this.ia.Qa(R.a.XOe,2,Xb);break;case 2:this.ia.Qa(R.a.YOe,2,Xb);break;case 3:this.ia.Qa(R.a.ZOe,2,Xb);break;case 4:this.ia.Qa(R.a.ROe,
2,Xb);this.MBj=na;break;case 5:this.ia.Qa(R.a.TOe,2,Xb);this.GCj=na;break;case 6:this.ia.Qa(R.a.aPe,2,Xb);this.VNj=na;break;case 7:this.ia.Qa(R.a.gPe,2,Xb);this.PQj=na;break;case 9:case 10:case 11:case 12:case 13:case 14:this.oml(0,$a,na,Fb);break;case 15:case 16:case 17:case 18:case 19:this.oml(1,$a,na,Fb)}this.Rn(!0)}oml(na,$a,Fb,Xb){const nc={[0]:[{property:14,value:this.foh},{property:9,value:this.cUa},{property:10,value:this.Pph},{property:11,value:this.aUa},{property:12,value:this.$Ta},{property:13,
value:this.bUa},{property:8,value:this.O1},{property:20,value:Wg.a.parse(this.Laa)}],[1]:[{property:19,value:this.XFj},{property:15,value:this.bqb},{property:16,value:this.aqb},{property:17,value:this.Zpb},{property:18,value:this.$pb}]}[na];if(nc){var Nc=nc.find(yd=>yd.property===$a);Nc&&(Nc.value=Fb);this.onEffectToggleChange(nc,na,Xb)}}Ak(na){return na?na.tc(this.xb.Oa):null}w9l(){var na=this.ob.lo();this.xWb.get(Yh)?Ac.a("CropControlEnableOnDisplayingFormatPicturePane")&&na&&((null===na||void 0===
na?0:na.Ww)||this.ia.Cb(R.a.N$b,2)):(na=this.Ak(na))&&na.pW(!1)}Erh(){this.mc&&(this.la.ync&&this.w9l(),this.la.Ruc&&this.Z2l(!0),this.bDm())}Av(na){1===na.mode&&this.mc&&(this.mc=!1,this.Tw(),this.Ma.lm(Ij.a.ysb,this.mc))}onColorSelect(na){const $a={};$a.Color=na;$a.nonMoreColor=!0;this.ia.Qa(R.a.b1c,2,$a)}qsb(na){return Wg.a.parse(na.Color)}Lwf(na,$a){const Fb={};Fb[na]=$a;this.ia.Qa(R.a.b1c,2,Fb)}NJf(){return na=>{this.Lwf("Color",na)}}ulf(na){const $a=[];for(let Fb=0;Fb<na.length;Fb++)$a.push(appChrome.api.colorPickerCell(na[Fb].Color,
na[Fb].DisplayColor,na[Fb].Alt));return $a}jPb(na,$a,Fb){const Xb=this.Laa,nc={customOnRenderListLength:1};nc.key=na+$a;nc.data={["columnCount"]:10,["id"]:na+$a,["type"]:"AppColorPickerProps",["colorCells"]:this.ulf(Fb),["onExecute"]:this.NJf(),["selectedId"]:ef.a.cxc(Fb,Xb)};return nc}QGd(na){var $a=Hh.f(this.va.Ga.Oe,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors","",1),Fb=Hh.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors",
"",!1);let Xb=$a.ControlList[0].Colors;$a=this.jPb(na,"Theme",Xb);Xb=Fb.ControlList[0].Colors;Fb=this.jPb(na,"Theme",Xb);return[$a,Fb,this.jPb(na,"Recent",ef.a.RFf())]}showMoreColorsDialog(){n.AFrameworkApplication.vb.Qa(R.a.Jtg,2,{["ShouldCanvasTakeFocus"]:!0,["SourceControlId"]:"MoreFillColors"})}JWm(na,$a,Fb,Xb,nc){if(1===Fb)return this.ia.Qa(R.a.renderColorPicker,1,nc);na={};$a=Ig.a.Mac(this.Laa);na.currentColor=new Ig.a($a);na.handleCommand=R.a.b1c;return this.ia.Qa(R.a.renderColorPicker,2,na)}}
Object(m.a)(Xh,"FormatPicturePaneActor",null,[]);var Li=a(49),ij=a(864);const Nk=ResourceStrings.L_CropPicture;class xk{constructor(na,$a,Fb,Xb,nc,Nc,yd,Ud,ie,Be,oe,rf,Vf,xg,qh,k,E,S,la,sa){this.MGe=!1;if(!qh)throw Error.argumentNull("shapeReader");if(k&&!E)throw Error.argumentNull("shapeSVGDependencyLoader");if(!S)throw Error.argumentNull("businessBarController");this.ia=na;this.pa=$a;this.Mb=Fb;this.qm=Xb;this.uc=nc;this.YHj=Nc;this.DJl=yd;this.Np=Ud;this.xb=ie;this.va=Be;this.ij=oe;this.a2a=rf;
this.cL=Vf;this.r1=xg;this.Ia=qh;this.Fpb=k;this.HBb=E;this.Gz=la;this.Y5=sa}Hb(){this.ia.sa(R.a.N$b,P.a.application,Object(B.a)(this,this.BKf,"handlePictureCropEvent"),12);this.DJl?(this.ia.sa(R.a.cof,P.a.application,Object(B.a)(this,this.cyl,"handleCropSplitButton"),4),this.ia.sa(R.a.dof,P.a.application,Object(B.a)(this,this.cyl,"handleCropSplitButton"),4)):(this.ia.sa(R.a.cof,P.a.application,Object(B.a)(this,this.BKf,"handlePictureCropEvent"),4),this.ia.sa(R.a.dof,P.a.application,Object(B.a)(this,
this.BKf,"handlePictureCropEvent"),4));this.ia.sa(R.a.YKe,P.a.application,Object(B.a)(this,this.EBn,"queryIsActive"),101);this.ia.sa(R.a.hec,P.a.application,Object(B.a)(this,this.jXm,"handleSendCropInfo"),4);this.ia.sa(R.a.vde,P.a.application,Object(B.a)(this,this.X3i,"handlePictureCropToShapeEvent"),4);this.ia.sa(R.a.vRc,P.a.application,Object(B.a)(this,this.X3i,"handlePictureCropToShapeEvent"),4);this.ia.sa(R.a.J3b,P.a.application,Object(B.a)(this,this.rth,"queryPictureCropBounding"),100);this.ia.sa(R.a.L3b,
P.a.application,Object(B.a)(this,this.rth,"queryPictureCropBounding"),100);this.ia.sa(R.a.K3b,P.a.application,Object(B.a)(this,this.rth,"queryPictureCropBounding"),100);this.ia.sa(R.a.xdc,P.a.application,Object(B.a)(this,this.rth,"queryPictureCropBounding"),100);this.ia.sa(R.a.XOe,P.a.application,Object(B.a)(this,this.Gzh,"updatePictureCropBounding"),4);this.ia.sa(R.a.$Oe,P.a.application,Object(B.a)(this,this.Gzh,"updatePictureCropBounding"),4);this.ia.sa(R.a.YOe,P.a.application,Object(B.a)(this,
this.Gzh,"updatePictureCropBounding"),4);this.ia.sa(R.a.ZOe,P.a.application,Object(B.a)(this,this.Gzh,"updatePictureCropBounding"),4)}cyl(na,$a,Fb,Xb,nc){return 1===Fb?32===this.X3i(na,$a,Fb,Xb,nc)||32===this.BKf(na,$a,Fb,Xb,nc)?32:8:this.BKf(na,$a,Fb,Xb,nc)}jXm(na,$a,Fb,Xb,nc){if(!nc)return fe.a.J(512500482,824,50,"Send Crop Info called with no cropping info"),8;$a=nc.pictCropperInfo;Xb=nc.shapeNode;nc=nc.ignoreCommitChanges;if(this.Y5){if(!Xb)return fe.a.J(512500481,824,10,"Send Crop Info called with invalid ShapeMoniker"),
8}else if(!Xb||!Xb.pictureCropInfo)return fe.a.J(507839492,824,10,"Send Crop Info called with invalid ShapeMoniker"),8;if(1===Fb)return 32;if(Fb=Cc.a.Ab)Fb.actionName="EndCropPicture",Fb.Xi=!1,Fb.kq=!0;Fb=this.Mb.Fd(15);if(this.Y5&&(null===Xb||void 0===Xb?0:Xb.ZK)){if(Xb.jUa=$a,h(Xb,this.xb.Oa),!nc)try{Fb.rc(Xb),Fb.sc=na}finally{Fb&&Fb.dispose()}}else try{Fb.rc(Xb),Fb.sc=na,Xb.jUa=$a}finally{Fb&&Fb.dispose()}return 32}X3i(na,$a,Fb,Xb,nc){if(!this.DJl||this.uc.Cd(this.pa.ys()))return 8;$a=this.pa.Ae();
if(!$a||!$a.length||Ac.a("PPTO_PICTURES_BUG_8343117_FIX")&&1!==$a.length)return 8;const Nc=[];for(var yd of $a)yd&&Nc.push(yd);if(!Nc.length)return 8;for(const Be of Nc)if(Be.isLocal||this.cL.UV(Be)||!this.C5m(Be))return 8;if(1===Fb)return 32;fe.a.J(512500480,824,15,"HandlePictureCropToShapeEvent:: Crop to Shape operation started");const Ud=nc?nc.SourceControlId:"";yd=0;Fb=Ud.split("_");if(3===Fb.length)yd=Number.parseInvariant(Fb[2]);else return fe.a.J(512500451,824,10,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with unknown shapeName: '{0}'",
Ud),16;Fb=window.performance.now();nc=new ij.a;nc.TargetShapeTypeAsInt=yd;yd=this.Mb.Fd(15,void 0,()=>{for(const Be of Nc)if(Be.Ww){const oe=this.Ak(Be);oe&&oe.pW(!1)}fe.a.J(512500450,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with shapeName: '{0}'",Ud)});try{yd.rc(Nc[0]);yd.sc=na;for(var ie of Nc)ie.edc=nc}finally{yd&&yd.dispose()}na=window.performance.now();if(ie=Cc.a.Ab)ie.actionName="PictureCropToShape",ie.Ya("PictureCropShapeType",nc.TargetShapeTypeAsInt.toString()),
ie.Ya("PictureCropToShapeDuration",(na-Fb).toString()),Cc.a.$Y(ie);fe.a.J(512500449,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation completed for shapeType : '{0}'",nc.TargetShapeTypeAsInt);return 32}BKf(na,$a,Fb,Xb,nc){if(!this.YHj||this.uc.Cd(this.pa.ys()))return 16;if(this.Fpb&&!this.HBb.Okj)return fe.a.J(512500448,824,10,"HandlePictureCropEvent:: Crop operation failed m_shapeSVGDependencyLoader is not loaded"),8;$a=this.pa.ud();const Nc=this.pa.Qvc($a);if(1!==$a.length||!Nc||this.Ia.$t(Nc).length||
!this.nnj(Nc))return 8;if(1===Fb)return 32;if(Nc.isLocal||this.cL.UV(Nc))return 16;if(Nc.Ww){na=this.Ak(Nc);if(!na)return 8;na.pW(!1);Nc.pictureCropInfo=null;qd.App.Vb.Zf();this.Zec(null===Nc||void 0===Nc?void 0:Nc.Ww);return 32}"dblclick"===(null===nc||void 0===nc?void 0:nc.eventName)&&Xb&&(Xb.KK=30);this.pa.Rj();const yd=this.va.Ga;this.uc.blockContent(yd,na,!1,void 0,void 0);const Ud=Cc.a.Ab;Ud&&(Ud.actionName="BeginCropPicture",Ud.Xi=!1,Ud.kq=!0);if(this.Y5&&(null===Nc||void 0===Nc?0:Nc.ZK))return this.yVn(Nc,
nc)?(fe.a.J(507848068,824,50,"PictureCrop: GC2 Crop triggered succesfully"),this.Opn(Nc,yd),null===Li.ActionManager||void 0===Li.ActionManager?void 0:Li.ActionManager.nE(window.event,"beginCrop",void 0),32):16;this.qm.Nhh(Nc.get_sid(),Nc.get_cid(),Nc.get_shapeId(),ie=>{Cc.a.FA(Ud,()=>{this.Ypn(Nc,yd,ie)})},()=>this.Xpn(Nc,yd),!0);return 32}Opn(na,$a){this.uc.mD($a);na.isConnected&&($a=na.Qg(this.xb.Oa))&&(na.Quc=!0,this.a2a.w$(na).k6l(),$a.QC(),this.Zec(null===na||void 0===na?void 0:na.Ww))}yVn(na,
$a){return(na=this.Ak(na))&&na.Ki&&(na=na.Ki)?na.yta("EnterCrop",$a):!1}EBn(na,$a,Fb,Xb,nc){if(!Object(Yc.a)(lb.a,nc))return 8;na=this.pa.lo();nc.xg(na?na.Ww:!1);return 32}cih(){const na=this.pa.lo();return na&&na.Ww&&na.isConnected?this.a2a.k5(na):null}Ak(na){return na?Object(ed.a)(284,na.tc(this.xb.Oa)):null}rth(na,$a,Fb,Xb,nc){if(!this.YHj||!nc)return 16;$a=this.cih();if(!$a)return 16;Fb=$a.FLi();Xb=this.xb.yd;na=na===R.a.J3b?Xb.vf(this.ij.YF(Fg.a.Pm(Fb.ha(0),Fb.ha(3)),$a.zoom),1):na===R.a.L3b?
Xb.vf(this.ij.YF(Fg.a.Pm(Fb.ha(0),Fb.ha(1)),$a.zoom),0):na===R.a.K3b?Xb.vf(this.ij.YF(Fb.ha(0).x,$a.zoom),0):Xb.vf(this.ij.YF(Fb.ha(0).y,$a.zoom),1);nc=nc.queryResult;null!==nc&&(nc.rda=parseFloat(th.a.Xv(na).toFixed(2)).toString());return 32}Gzh(na,$a,Fb,Xb,nc){if(!this.YHj||this.Fpb&&!this.HBb.Okj)return 16;$a=this.cih();if(1===Fb)return $a?32:16;if(!$a||!nc)return 16;if(2===Fb){Fb=!1;Xb=$a.FLi().copy();nc=th.a.TV(nc.Number);const Nc=Fg.a.Pm(Xb.ha(0),Xb.ha(1)),yd=Fg.a.Pm(Xb.ha(0),Xb.ha(3)),Ud=this.xb.yd;
na===R.a.XOe?(nc=this.ij.cP(Ud.ke(nc,1),$a.zoom),na=nc-yd,Xb.ha(2).vS(0,na),Xb.ha(3).vS(0,na)):na===R.a.$Oe?(nc=this.ij.cP(Ud.ke(nc,0),$a.zoom),na=nc-Nc,Xb.ha(1).vS(na,0),Xb.ha(2).vS(na,0)):na===R.a.YOe?(Fb=!0,nc=this.ij.cP(Ud.ke(nc,0),$a.zoom),na=nc-Xb.ha(0).x,Xb.move(na,0)):na===R.a.ZOe&&(Fb=!0,nc=this.ij.cP(Ud.ke(nc,1),$a.zoom),na=nc-Xb.ha(0).y,Xb.move(0,na));$a.xXn(Xb,Fb)}return 32}C5m(na){let $a=[];na.Ce?$a=this.Ia.$t(na):na.wg&&($a=this.Ia.$t(na.Dr()));if($a.length){for(const Fb of $a)if(!this.nnj(Fb))return!1;
return!0}return this.nnj(na)}nnj(na){const $a=this.Np.KXg&&!na.isGif&&(na.Kg||1===na.mediaType)&&(!na.get_isSVGBlipFilled()||this.Gz&&na.HA);return this.r1?$a&&!na.TBb:$a}Xpn(na,$a){this.uc.mD($a);if(!this.isActive||!na.isConnected)return!0;this.isActive=!1;na.pictureCropInfo=null;fe.a.J(512500446,824,10,"Error: Failed to perform command of Get picture crop info.");return!1}Ypn(na,$a,Fb){this.uc.mD($a);if(na.isConnected)if($a=Cc.a.Ab,Cc.a.FA($a,()=>{this.ia.Cb(R.a.L9a,2)}),this.cL.UV(na))fe.a.J(512500445,
822,50,"Crop is cancelled due to shape manipulation");else{var Xb=na.Qg(this.xb.Oa);if(Xb){var nc=new Date;na.pictureCropInfo=JSON.parse(Fb.PictureCropInfoStr);this.a2a.w$(na).k6l();Fb=new Date;$a&&($a.km("ParseCropInfoStart",nc),$a.km("ParseCropInfoEnd",Fb),Cc.a.$Y($a));Xb.QC();this.Zec(null===na||void 0===na?void 0:na.Ww)}}}Zec(na){this.ia.Qa(R.a.Zec,2,{["sectionName"]:Nk,["sectionNewState"]:na})}get isActive(){return this.MGe}set isActive(na){this.MGe=na}}Object(m.a)(xk,"PictureCropActor",null,
[]);var ui=a(1580),pj=a(371),wj=a(363),ok=a(379),Lj=a(318),Tj=a(354),rk=a(563),Kk=a(1184),ol=a(868),pi=a(268),Uj=a(285),sk=a(900),$i=a(305),Dl=a(375),El=a(358),Rl=a(1188),mk=a(527),al=a(338),fl=a(365),nk=a(389),ii=a(458);const gl=ResourceStrings.L_CropPicture;class Xk{constructor(na,$a,Fb,Xb,nc,Nc,yd,Ud,ie,Be,oe,rf,Vf,xg,qh,k){this.mc=!0;this.Rm=!1;this.Zm=[];this.x2a=this.GI=this.IEa=this.hW=this.Daa=this.Eb=null;this.NF=Array(8);this.FGj=this.PTa=this.Dp=this.HI=null;this.YNa=this.Xe=1;this.OOj=
new Fg.a(0,0);this.Ln=new pj.a;this.s8=new wj.a;this.WHe=new Fg.a(0,0);this.cbd=0;this.Lw=new wj.a;this.XNj=!1;this.DKj=new wj.a;this.gpb=new Fg.a(0,0);this.fpb=new Fg.a(0,0);this.uJl=new Fg.a(0,0);this.Jqg=this.uob=this.zGj=!1;this.Yag=new Fg.a(0,0);this.Pqb=this.epb=null;this.hnh=new vb.a;this.ZD=null;if(!Xb)throw Error.argumentNull("clickInputManager");if(!na)throw Error.argumentNull("shapeNode");if(oe&&!Vf)throw Error.argumentNull("transformFactory");if(oe&&!xg)throw Error.argumentNull("presReader");
this.ra=na;this.Ia=$a;this.nc=Fb;this.ef=Xb;this.ia=nc;this.Xaa=Nc;this.Ge=yd;this.h2a=Ud;this.cen=ie;this.Gpb=Be;this.Fpb=oe;this.Vj=Vf;this.Wbn=qh;this.xb=k;this.Y5=rf}xq(na){this.Eb=new fl.a;this.Eb.gk(1);this.Eb.he(!1);this.Eb.eCa(Uj.a.J6l);na.appendChild(this.Eb.viewport);this.Daa=new sk.a(!1,this.Fpb);this.Eb.appendChild(this.Daa);this.hW=new sk.a(!1,this.Fpb);this.Eb.appendChild(this.hW);this.hW.gk(1);this.IEa=new El.a;this.IEa.GB(ld.a.o_);this.IEa.Mw(ld.a.iD);this.IEa.mN($i.a.none);this.IEa.gk(1);
this.Eb.appendChild(this.IEa);this.x2a=new El.a;this.x2a.gk(1);this.x2a.$k(Uj.a.Nta);this.x2a.eCa("ShapeMoveHandle");this.x2a.mN($i.a.none);this.Eb.appendChild(this.x2a);this.GI=new Dl.a;this.grc(this.GI);this.Eb.appendChild(this.GI);this.Eb.viewport.ta.setAttribute("class",Uj.a.wcd);this.Eb.he(!1);this.ef.Zb(v.a.click,this.x2a.ta,Object(B.a)(this,this.urh,"noOpHandler"));this.ef.Zb(v.a.click,this.IEa.ta,Object(B.a)(this,this.urh,"noOpHandler"))}grc(na){for(let Xb=0;8>Xb;++Xb){var $a="cropHandle"+
Xb;const nc=new Dl.a;nc.ta.id=$a;if(Tc.a.HUa){var Fb=new mk.a;Fb.ta.id=$a;Fb.setVisibility(!1);Fb.setPosition(-10,-10);Fb.mh(20,20);nc.appendChild(Fb)}Fb=new Tj.a(Xb);$a=Fb.QAb()?this.AAm(Fb,$a):this.cCm(Fb,$a);nc.appendChild($a);nc.gk(1);this.NF[Xb]=nc;na.appendChild(nc)}}WMf(na){for(let $a=0;8>$a;++$a)if(this.NF[$a].ta.id===na.id)return new Tj.a($a);return null}S5m(na){return na.id.startsWith("cropHandle")}dispose(){this.h2a();this.Rm=!0;this.mc=!1;this.Eb&&this.Eb.fr();this.Eb=null;this.x2a&&this.ef.jc(v.a.click,
this.x2a.ta,Object(B.a)(this,this.urh,"noOpHandler"));this.x2a=null;this.IEa&&this.ef.jc(v.a.click,this.IEa.ta,Object(B.a)(this,this.urh,"noOpHandler"));this.GI=this.IEa=null;this.NF&&Array.clear(this.NF);this.epb=this.Pqb=this.NF=null;this.Yag=new Fg.a(0,0)}Wwh(na,$a,Fb,Xb){const nc=this.IVi(),Nc=na-nc.x+this.fpb.x+Fb,yd=$a-nc.y+this.fpb.y+Xb;return isNaN(Nc)||isNaN(yd)?(fe.a.J(512497029,822,15,"PictureCropShapeView::ShiftPositionRelativeToShape - x:{0}, nodeTopLeft.X:{1}, m_maskViewPositionDiff.X:{2}, distX:{3}, y:{4}, nodeTopLeft.Y:{5}, m_maskViewPositionDiff.Y:{6}, distY:{7}, m_zoom:{8}",
na,nc.x,this.fpb.x,Fb,$a,nc.y,this.fpb.y,Xb,this.Xe),new Fg.a(0,0)):new Fg.a(Nc,yd)}setPosition(na,$a){var Fb;this.uob&&(this.uob&&this.Y5&&this.ra.ZK?($a=new Fg.a(na/this.Xe,$a/this.Xe),na=this.HI,this.gpb=$a,$a=this.NUm(),$a=this.Ize(na,$a),this.ra.jUa=$a,$a=u(this.ra,this.xb.Oa),null===(Fb=null===$a||void 0===$a?void 0:$a.Ki)||void 0===Fb?void 0:Fb.Jzh(Fg.a.Pm(na.ha(1),na.ha(0)),Fg.a.Pm(na.ha(3),na.ha(0)),na.ha(0).x*this.Xe*window.devicePixelRatio,na.ha(0).y*this.Xe*window.devicePixelRatio),h(this.ra,
this.xb.Oa)):this.ra.pictureCropInfo&&(this.gpb=Fb=new Fg.a(na/this.Xe,$a/this.Xe),this.Gpb?(this.epb&&this.Daa&&(na=this.Wwh(this.epb.Position.X,this.epb.Position.Y,Fb.x,Fb.y),this.Daa.setPosition(na.x,na.y)),this.Pqb&&this.hW&&this.hW.image&&(Fb=this.Wwh(this.Pqb.Position.X,this.Pqb.Position.Y,Fb.x,Fb.y),this.hW.image.setPosition(Fb.x,Fb.y))):((na=this.ra.pictureCropInfo.MaskViewElem)&&this.Daa&&(na=this.Wwh(na.Position.X,na.Position.Y,Fb.x,Fb.y),this.Daa.setPosition(na.x,na.y)),(na=this.ra.pictureCropInfo.TextureViewElem)&&
this.hW&&this.hW.image&&(Fb=this.Wwh(na.Position.X,na.Position.Y,Fb.x,Fb.y),this.hW.image.setPosition(Fb.x,Fb.y))),this.Eb.Km()))}wRn(na,$a){const Fb=new Fg.a(this.Ia.hS(this.ra,this.Xaa).x/this.Xe,this.Ia.hS(this.ra,this.Xaa).y/this.Xe),Xb=new Fg.a(this.fpb.x+this.gpb.x,this.fpb.y+this.gpb.y);if(this.Gpb)this.epb&&this.Daa&&this.Daa.setPosition(this.epb.Position.X-Fb.x+Xb.x+na/this.Xe,this.epb.Position.Y-Fb.y+Xb.y+$a/this.Xe),this.Pqb&&this.hW&&this.hW.image.setPosition(this.Pqb.Position.X-Fb.x+
Xb.x+na/this.Xe,this.Pqb.Position.Y-Fb.y+Xb.y+$a/this.Xe);else{var nc=this.ra.pictureCropInfo.MaskViewElem;nc&&this.Daa.setPosition(nc.Position.X-Fb.x+Xb.x+na/this.Xe,nc.Position.Y-Fb.y+Xb.y+$a/this.Xe);(nc=this.ra.pictureCropInfo.TextureViewElem)&&this.hW.image.setPosition(nc.Position.X-Fb.x+Xb.x+na/this.Xe,nc.Position.Y-Fb.y+Xb.y+$a/this.Xe)}this.Eb.Km()}xRn(na,$a){$a.Yi(1/this.YNa);this.m3l(na,pj.a.add(this.gUa,$a))}resize(na,$a){$a.Yi(1/this.YNa);this.m3l(na,$a)}m3l(na,$a){na=this.nff(na,$a);
Ac.a("FixCropTransformChange")&&!this.XNj&&(this.DKj=na,this.XNj=!0);this.Vu(na);this.setOffsets($a)}IVi(){const na=this.Ia.hS(this.ra,this.Xaa);return new Fg.a(na.x/this.Xe,na.y/this.Xe)}b$l(){this.ra.Ww&&(this.YNa=this.nc.Cg(this.ra).io/this.OOj.x)}k6l(){var na;const $a=this.nc.Cg(this.ra);this.OOj.update($a.io,$a.ek);this.Y5&&(null===(na=this.ra)||void 0===na?0:na.ZK)&&(this.zGj=!0,this.uJl=this.ra.MR.copy(),this.FGj=this.ra.TOa.copy())}Yi(na){this.Xe=na;this.Eb.Yi(this.Xe);na=new wj.a;na.jma(1/
this.Xe,1/this.Xe);this.GI.MI(na,al.a.Cja);this.Wbn?this.S6(!1):this.S6(!0)}get zoom(){return this.Xe/this.YNa}FLi(){var na;this.b$l();this.HI||(this.HI=this.ra.wt);var $a=Fg.a.Pm(this.HI.ha(0),this.HI.ha(1));const Fb=Fg.a.Pm(this.HI.ha(0),this.HI.ha(3)),Xb=this.HI.ej(),nc=new Lj.a(new Fg.a(0,0),new Fg.a($a,0),new Fg.a($a,Fb),new Fg.a(0,Fb));nc.move(Xb.x-$a/2,Xb.y-Fb/2);$a=this.IVi();this.Y5&&(null===(na=this.ra)||void 0===na?0:na.ZK)&&($a=this.gPi(this.Xaa),$a=new Fg.a($a.x/this.Xe,$a.y/this.Xe));
nc.move($a.x,$a.y);nc.scale(this.YNa,this.YNa);return nc}xXn(na,$a){var Fb,Xb;na=na.copy();na.scale(1/this.YNa,1/this.YNa);var nc=this.IVi();this.Y5&&(null===(Fb=this.ra)||void 0===Fb?0:Fb.ZK)&&(nc=this.gPi(this.Xaa),nc=new Fg.a(nc.x/this.Xe,nc.y/this.Xe));na.move(-1*nc.x,-1*nc.y);Fb=na.ej();nc=new wj.a;$a?nc.Eea(this.ra.get_shapeRotation(),Fb):nc.Eea(this.ra.get_shapeRotation(),this.HI.ha(0));nc.gl(na);$a||na.move(this.HI.ha(0).x-na.ha(0).x,this.HI.ha(0).y-na.ha(0).y);this.HI=na;this.uob&&this.Y5&&
this.ra.ZK&&($a=this.Ize(na.copy(),this.PTa),this.ra.jUa=$a,$a=Fg.a.Pm(na.ha(1),na.ha(0)),Fb=Fg.a.Pm(na.ha(3),na.ha(0)),nc=u(this.ra,this.xb.Oa),null===(Xb=null===nc||void 0===nc?void 0:nc.Ki)||void 0===Xb?void 0:Xb.Jzh($a,Fb,na.ha(0).x*this.Xe*window.devicePixelRatio,na.ha(0).y*this.Xe*window.devicePixelRatio),h(this.ra,this.xb.Oa));Ac.a("FixCropTransformChange")&&(this.s8=this.DKj,this.IEa.MI(this.s8,al.a.Cja));this.IEa.ox(this.HI.points);Xb=this.hW.clipPath;Ac.a("SVGCreationOnChangesFromFormatPane")&&
this.Fpb&&Xb?(Xb.L5c=this.Zdh(na.copy()),this.Jah(Fg.a.tu(na.points[this.cbd],this.WHe))):Xb&&Xb.F$b&&Xb.F$b.J3g(this.HI.points);this.Jqg=!0;this.S6(!0);this.Eb.Km()}setZIndex(na){this.Eb.AG(na+2*rk.a.Ora)}setOffsets(na){var $a,Fb;fe.a.J(507803861,822,50,"PictureCropShapeView::setOffsets - crop Handles were moved");this.HI||(this.HI=this.ra.wt);this.orm(na);this.Ln=na;na=this.sKi();this.IEa.ox(this.HI.points);const Xb=this.hW.clipPath;this.Fpb&&Xb?(this.Jah(Fg.a.tu(na.points[this.cbd],this.WHe)),
Xb.L5c=this.Zdh(na),this.uob&&this.Y5&&(null===($a=this.ra)||void 0===$a?0:$a.ZK)&&($a=this.Ize(na,this.PTa),this.ra.jUa=$a,$a=u(this.ra,this.xb.Oa),null===(Fb=null===$a||void 0===$a?void 0:$a.Ki)||void 0===Fb?void 0:Fb.Jzh(Fg.a.Pm(na.ha(1),na.ha(0)),Fg.a.Pm(na.ha(3),na.ha(0)),na.ha(0).x*this.Xe*window.devicePixelRatio,na.ha(0).y*this.Xe*window.devicePixelRatio))):Xb&&Xb.F$b&&Xb.F$b.J3g(na.points);this.Eb.Km()}orm(na){var $a=this.HI,Fb=Fg.a.Pm($a.ha(0),$a.ha(1));$a=Fg.a.Pm($a.ha(0),$a.ha(3));na.bottom-
na.top<-1*$a&&($a+=na.bottom-na.top,na.top+=$a,na.bottom-=$a);na.right-na.left<-1*Fb&&(Fb+=na.right-na.left,na.left+=Fb,na.right-=Fb)}Vu(na){this.s8=na;this.IEa.MI(na,al.a.Cja);this.S6(!0)}Kz(na){this.Lw=na;this.Eb.MI(na,al.a.RKb);this.Eb.Km()}hG(){Array.clear(this.Zm)}vP(na){return this.S5m(na)?this.WMf(na):null}iL(na){var $a;const Fb=[];if(this.ra.Ww){if(!(this.Y5&&(null===($a=this.ra)||void 0===$a?0:$a.ZK))){$a=this.ra.pictureCropInfo;const Xb=this.nc.Cg(this.ra);if($a.MaskViewElem){const nc=ii.a.jnf(6,
Xb.io,Xb.ek);Array.add(Fb,nc)}$a.TextureViewElem&&($a=ii.a.jnf(7,Xb.io,Xb.ek),Array.add(Fb,$a))}Array.add(this.Zm,na)}else this.mc=!1,this.Eb.he(!1);return Fb}KR(){}EYn(){this.Yag.x!==this.Daa.x&&this.Yag.y!==this.Daa.y&&(fe.a.J(512497026,822,50,"PictureCropShapeView::UpdateViewElementPositionForRedraw - Updating maskViewElements and PictureViewElements "),this.epb.Position.X=this.Daa.x+this.Ia.hS(this.ra,this.Xaa).x/this.Xe,this.epb.Position.Y=this.Daa.y+this.Ia.hS(this.ra,this.Xaa).y/this.Xe,this.Pqb.Position.X=
this.hW.image.x+this.Ia.hS(this.ra,this.Xaa).x/this.Xe,this.Pqb.Position.Y=this.hW.image.y+this.Ia.hS(this.ra,this.Xaa).y/this.Xe,this.fpb.update(0,0))}m5c(na,$a){const Fb=this.Vj.k6c();this.ra.get_isVerticallyFlipped()&&(Fb.jma(1,-1),Fb.UG(0,2*$a._y));this.ra.get_isHorizontallyFlipped()&&(Fb.jma(-1,1),Fb.UG(2*$a._x,0));Fb.Eea(na,$a);return Fb}Mwl(){return this.ra.get_isVerticallyFlipped()&&this.ra.get_isHorizontallyFlipped()?2:this.ra.get_isVerticallyFlipped()?3:this.ra.get_isHorizontallyFlipped()?
1:0}Jah(na){const $a=new wj.a;$a.UG(na._x,na._y);this.hW.clipPath.MI($a,al.a.Cja)}Zdh(na){fe.a.J(512497025,809,15,"PictureCropShapeView:: createSVG operation started");var $a=this.ra.get_shapeRotation();this.Vj.c3(-$a,na.ej()).gl(na);this.ZD||(this.ZD=svgShape.FactoryGlobal.createShape());this.ZD.setSVGRoot(this.Eb.ta,!1);this.ra.nJ?this.ZD.setShapeType(this.ra.nJ):(this.ZD.setShapeType(4),fe.a.J(539760099,809,50,"ShapeNode ArtShapeType is null"));this.ZD.setOffsets(this.ra.get_xPersisted()+ui.a.XY(na.ha(0).x/
this.YNa,0),this.ra.get_yPersisted()+ui.a.XY(na.ha(0).y/this.YNa,1));this.ZD.setExtents(ui.a.XY(na.ha(1).x-na.ha(0).x,0),ui.a.XY(na.ha(2).y-na.ha(1).y,1));var Fb=svgShape.FactoryGlobal.getConvertor().getPath(this.ZD,!1,this.YNa,this.YNa);if(!Fb||!Fb.length)throw fe.a.J(512497024,822,15,"PictureCropShapeView::CreateSVG -No response received from getPath"),Error.invalidOperation(" Invalid response for svgpath element");na=Array(Fb.length);$a=0;for(const Xb of Fb)Fb=new El.a,Fb.Bka(Xb),Fb.ta.setAttribute($i.a.MUa,
this.Lw.KUa()),na[$a++]=Fb;fe.a.J(512496995,809,15,"PictureCropShapeView:: createSVG operation ended");return na}draw(na,$a){var Fb;if(this.Y5&&(null===(Fb=this.ra)||void 0===Fb?0:Fb.ZK))this.HI&&Fg.a.Pm(this.HI.ha(0),this.HI.ha(2))||(this.HI=this.ra.wt),this.PTa=this.ra.TOa,this.x2a.ox(this.PTa.points),this.IEa.ox(this.HI.points),this.uob=!0,this.S6(!0),this.visible=this.mc,this.Daa.he(!1),this.hW.he(!1),this.Eb.Km(),this.Eb.he(this.mc);else if(Array.contains(this.Zm,na)){Array.remove(this.Zm,na);
if(this.ra.pictureCropInfo&&!this.uob){if(this.ra.pictureCropInfo.MaskViewElem){na=this.ra.pictureCropInfo.MaskViewElem;Fb=na.Clip;var Xb=this.nc.Cg(this.ra);Xb=ii.a.jnf(6,Xb.io,Xb.ek);if(Xb=$a[Xb.toString()])this.Daa.s2l(Xb.Base64Data,na.Id.toString(),Fb.Bounds.Left,Fb.Bounds.Top,Fb.TotalWidth,Fb.TotalHeight,Fb.Bounds.Right-Fb.Bounds.Left,Fb.Bounds.Bottom-Fb.Bounds.Top),this.Daa.he(!0),this.Daa.setPosition(na.Position.X-this.Ia.hS(this.ra,this.Xaa).x/this.Xe,na.Position.Y-this.Ia.hS(this.ra,this.Xaa).y/
this.Xe);this.epb=na;this.Yag=new Fg.a(this.Daa.x,this.Daa.y)}this.ra.pictureCropInfo.TextureViewElem?(na=this.nc.Cg(this.ra),Xb=ii.a.jnf(7,na.io,na.ek),na=this.ra.pictureCropInfo.TextureViewElem,Fb=na.Clip,($a=$a[Xb.toString()])?this.Fpb?(this.cbd=this.Mwl(),this.WHe=this.Dp.points[this.cbd].copy(),this.Jah(Fg.a.tu(this.ra.wt.points[this.cbd],this.WHe)),this.Lw=this.m5c(this.ra.get_shapeRotation(),this.ra.wt.ej()),this.hW.t2l($a.Base64Data,na.Id.toString(),na.Position.X-this.Ia.hS(this.ra,this.Xaa).x/
this.Xe,na.Position.Y-this.Ia.hS(this.ra,this.Xaa).y/this.Xe,Fb.TotalWidth,Fb.TotalHeight,this.Dp.copy().points,this.Zdh(this.Dp.copy()))):this.hW.r2l($a.Base64Data,na.Id.toString(),na.Position.X-this.Ia.hS(this.ra,this.Xaa).x/this.Xe,na.Position.Y-this.Ia.hS(this.ra,this.Xaa).y/this.Xe,Fb.TotalWidth,Fb.TotalHeight,this.ra.wt.points):fe.a.J(512496993,822,50,"PictureCropShapeView::Draw - No Crop Texture Image Downloaded"),this.Pqb=na):fe.a.J(512496992,822,50,"PictureCropShapeView::Draw - Unable to set image and bounds to polygon as TextureViewElem is null");
this.HI&&Fg.a.Pm(this.HI.ha(0),this.HI.ha(2))||(this.HI=this.ra.wt);this.PTa=this.ra.TOa;this.x2a.ox(this.PTa.points);this.IEa.ox(this.HI.points);this.uob=!0;this.S6(!0);this.visible=this.mc}else this.Gpb&&this.epb&&this.Pqb&&(this.EYn(),this.Daa.setPosition(this.epb.Position.X-this.Ia.hS(this.ra,this.Xaa).x/this.Xe,this.epb.Position.Y-this.Ia.hS(this.ra,this.Xaa).y/this.Xe),this.hW.image.setPosition(this.Pqb.Position.X-this.Ia.hS(this.ra,this.Xaa).x/this.Xe,this.Pqb.Position.Y-this.Ia.hS(this.ra,
this.Xaa).y/this.Xe),this.Fpb?(this.cbd=this.Mwl(),this.WHe=this.Dp.points[this.cbd].copy(),this.Jah(Fg.a.tu(this.ra.wt.points[this.cbd],this.WHe)),this.Lw=this.m5c(this.ra.get_shapeRotation(),this.ra.wt.ej()),this.hW.clipPath.L5c=this.Zdh(this.ra.wt)):this.hW.clipPath.F$b=new Rl.a(this.ra.wt.points,0),this.Yag=new Fg.a(this.Daa.x,this.Daa.y),this.HI=this.ra.wt,this.PTa=this.ra.TOa,this.x2a.ox(this.PTa.points),this.IEa.ox(this.HI.points),this.S6(!0),fe.a.J(512496991,822,50,"PictureCropShapeView::Draw - Redrawed crop views "));
this.Y5&&(this.hW&&!this.hW.lS()&&this.hW.he(!0),this.Daa&&!this.Daa.lS()&&this.Daa.he(!0));this.Eb.Km();this.Eb.he(this.mc)}}oXn(){var na;this.HI=this.HI?this.sKi():this.ra.wt;this.Dp=this.HI.copy();this.PTa||(this.PTa=this.ra.TOa);this.PTa.move(this.gpb.x,this.gpb.y);this.x2a.ox(this.PTa.points);this.Y5&&(null===(na=this.ra)||void 0===na?0:na.ZK)&&this.Eb.Km();this.fpb.vS(this.gpb.x,this.gpb.y);this.gpb.update(0,0);this.Ge.WH(new nk.a(1))}JMm(){var na=this.GI.ZEc;const $a=new Fg.a(na[0].x,na[0].y),
Fb=new Fg.a(na[2].x,na[2].y),Xb=new Fg.a(na[4].x,na[4].y);na=new Fg.a(na[6].x,na[6].y);return new Lj.a($a,Fb,Xb,na)}sKi(){var na=this.GI.ZEc;const $a=new Fg.a(na[0].x/this.Xe,na[0].y/this.Xe),Fb=new Fg.a(na[2].x/this.Xe,na[2].y/this.Xe),Xb=new Fg.a(na[4].x/this.Xe,na[4].y/this.Xe);na=new Fg.a(na[6].x/this.Xe,na[6].y/this.Xe);return new Lj.a($a,Fb,Xb,na)}xNm(){var na=this.ra.TOa.copy().points,$a=new Fg.a(na[0].x*this.Xe,na[0].y*this.Xe);const Fb=new Fg.a(na[1].x*this.Xe,na[1].y*this.Xe),Xb=new Fg.a(na[2].x*
this.Xe,na[2].y*this.Xe);na=new Fg.a(na[3].x*this.Xe,na[3].y*this.Xe);$a=new Lj.a($a,Fb,Xb,na);$a.scale(1/this.YNa,1/this.YNa);$a.move((this.fpb.x+this.gpb.x)*this.Xe,(this.fpb.y+this.gpb.y)*this.Xe);return $a}NUm(){var na=this.FGj.copy().points,$a=new Fg.a(na[0].x,na[0].y);const Fb=new Fg.a(na[1].x,na[1].y),Xb=new Fg.a(na[2].x,na[2].y);na=new Fg.a(na[3].x,na[3].y);$a=new Lj.a($a,Fb,Xb,na);$a.move(this.fpb.x+this.gpb.x,this.fpb.y+this.gpb.y);return $a}LP(na){this.uob&&(Ac.a("EnabledKeyboardCrop")||
this.GI.he(!na),na?(this.b$l(),this.Jqg=!0):(this.oXn(),this.ia.Qa(R.a.Zec,2,{["sectionName"]:gl,["sectionNewState"]:this.uob}),this.Gpb&&(na={["pictCropperInfo"]:this.Ize(this.HI,this.PTa),["shapeNode"]:this.ra},this.ia.Qa(R.a.hec,2,na))))}Qt(){return this.Eb.Qt()}S6(na){if(this.uob){var $a=this.HI.copy();na&&this.s8.gl($a);na=new wj.a;na.gzb(this.ra.get_shapeRotation());var Fb=2*Math.ceil((this.ra.get_shapeRotation()-45)/90)%8;for(let Xb=0;8>Xb;++Xb){const nc=this.NF[Xb];nc.$k(pi.a.qX(ok.a.box4Image(Xk.SVc[Fb]),
Uj.a.zA));this.cQa(nc,$a.zj(new Tj.a(Xb)));nc.MI(na,al.a.RKb);Fb=(Fb+1)%8}}}cQa(na,$a){na.x===$a.x*this.Xe&&na.y===$a.y*this.Xe||na.setPosition($a.x*this.Xe,$a.y*this.Xe)}get visible(){return this.mc}set visible(na){var $a;this.mc=na;!na&&this.uob&&(this.OHm(),this.uob=!1,this.Y5&&(null===($a=this.ra)||void 0===$a?0:$a.ZK)&&(na=u(this.ra,this.xb.Oa))&&na.Ki&&(na=na.Ki)&&na.yta("ExitCrop",void 0));this.Eb.he(this.mc)}OHm(){var na,$a;if(this.uob){var Fb=null===(na=this.ra)||void 0===na?void 0:na.Qg(this.xb.Oa);
Ac.a("CropHandleAbovePicStackEnabled")&&null!==Fb&&Fb.QPl();if(this.Jqg&&(na={["pictCropperInfo"]:this.Ize(this.HI,this.PTa),["shapeNode"]:this.ra},null===Li.ActionManager||void 0===Li.ActionManager?void 0:Li.ActionManager.nE(window.event,"exitCrop",void 0),this.ia.Qa(R.a.hec,2,na),this.Y5&&(null===($a=this.ra)||void 0===$a?0:$a.ZK)&&null!==this.HI&&null!==this.Dp))if($a=Fg.a.Pm(this.HI.ha(0),this.HI.ha(1)),na=Fg.a.Pm(this.HI.ha(0),this.HI.ha(3)),Ac.a("CropCTASelectionHandlesFix")){var Xb=new Fg.a(0,
0),nc=new Fg.a($a,0);const Nc=new Fg.a($a,na),yd=new Fg.a(0,na);this.ra.wt=new Lj.a(Xb,nc,Nc,yd);nc=this.Ize(this.sKi(),this.PTa);Xb=Fb.td.yd.ke(nc.X,0);nc=Fb.td.yd.ke(nc.Y,1);Fb.Ulh($a,na);Fb.tec(Xb,nc,!0,!0)}else Xb=this.ra.wt,Fb=Fg.a.Pm(Xb.ha(0),Xb.ha(1)),Xb=Fg.a.Pm(Xb.ha(0),Xb.ha(3)),$a-1<=Fb&&Fb<=$a+1&&na-1<=Xb&&Xb<=na+1||(Fb=new Fg.a(this.Dp.ha(0).x,this.Dp.ha(0).y),$a=new Fg.a(this.Dp.ha(1).x,this.Dp.ha(1).y),na=new Fg.a(this.Dp.ha(2).x,this.Dp.ha(2).y),Xb=new Fg.a(this.Dp.ha(3).x,this.Dp.ha(3).y),
Fb=new Lj.a(Fb,$a,na,Xb),this.ra.wt=Fb);this.Dja()}}Ize(na,$a){const Fb=this.$vm(na),{left:Xb,top:nc,right:Nc,bottom:yd}=this.Oym(na,$a);na=new Kk.a;na.Left=Xb;na.Top=nc;na.Right=Nc;na.Bottom=yd;na.X=Fb.x;na.Y=Fb.y;return na}Oym(na,$a){let Fb,Xb;({left:na,top:$a,right:Fb,bottom:Xb}=this.eEm(na,$a));({left:na,top:$a,right:Fb,bottom:Xb}=this.Mzm(na,$a,Fb,Xb));({left:na,top:$a,right:Fb,bottom:Xb}=Xk.c_n(na,$a,Fb,Xb));return{left:na,top:$a,right:Fb,bottom:Xb}}eEm(na,$a){$a=$a.points;const Fb=na.points;
na=ol.a($a[3],$a[0],Fb[3],Fb[0]);const Xb=ol.a($a[0],$a[1],Fb[0],Fb[1]),nc=ol.a($a[1],$a[2],Fb[1],Fb[2]);$a=ol.a($a[2],$a[3],Fb[2],Fb[3]);return{left:na,top:Xb,right:nc,bottom:$a}}Mzm(na,$a,Fb,Xb){var nc=this.PTa.points;const Nc=Fg.a.Pm(nc[0],nc[1]);nc=Fg.a.Pm(nc[1],nc[2]);na=Math.floor(na/Nc*1E6)/1E6;$a=Math.floor($a/nc*1E6)/1E6;Fb=Math.floor(Fb/Nc*1E6)/1E6;Xb=Math.floor(Xb/nc*1E6)/1E6;return{left:na,top:$a,right:Fb,bottom:Xb}}gPi(na){const $a=this.uJl.copy();$a.x=na.ke($a.x,0);$a.y=na.ke($a.y,1);
return $a}$vm(na){var $a,Fb;na=na.copy();var Xb=new wj.a;const nc=na.ej();Xb.Eea(-1*this.ra.get_shapeRotation(),nc);Xb.gl(na);Xb=this.Ia.hS(this.ra,this.Xaa);this.Y5&&(null===($a=this.ra)||void 0===$a?0:$a.ZK)&&this.zGj&&(Xb=this.gPi(this.Xaa));this.cen?($a=this.Xaa.vf(na.Ic*this.Xe+Xb.x,0),na=this.Xaa.vf(na.Xc*this.Xe+Xb.y,1),$a=new Fg.a($a,na)):$a=new Fg.a(na.Ic+Xb.x/this.Xe,na.Xc+Xb.y/this.Xe);return this.Y5&&(null===(Fb=this.ra)||void 0===Fb?0:Fb.ZK)?$a:Fg.a.scale($a,this.YNa,this.YNa)}urh(){return!0}Dja(){var na;
this.IEa.MI(new wj.a,al.a.Cja);this.x2a.setPosition(0,0);this.Ln=new pj.a;this.ra.pictureCropInfo=null;this.ra.Quc=!1;this.Dp=this.HI=this.s8=null;this.fpb.update(0,0);this.Jqg=!1;this.OOj.update(0,0);this.YNa=1;this.XNj=!1;this.DKj=null;this.Y5&&(null===(na=this.ra)||void 0===na?0:na.ZK)&&(this.zGj=!1,this.FGj=null)}nff(na,$a){const Fb=new wj.a;this.Dp||(this.Dp=na);na=this.Dp.ej();const Xb=Fg.a.Pm(this.Dp.ha(0),this.Dp.ha(1)),nc=Fg.a.Pm(this.Dp.ha(0),this.Dp.ha(3)),Nc=Xb?1+($a.right-$a.left)/Xb:
1,yd=nc?1+($a.bottom-$a.top)/nc:1,Ud=na.copy();Ud.vS(-1*Xb/2,-1*nc/2);Fb.Eea(-1*this.ra.get_shapeRotation(),na);Fb.UG(-1*Ud.x,-1*Ud.y);Fb.jma(Nc,yd);Fb.UG($a.left+Ud.x,$a.top+Ud.y);Fb.Eea(this.ra.get_shapeRotation(),na);return Fb}AAm(na,$a){var Fb=[new Fg.a(0,0),new Fg.a(20,0),new Fg.a(20,5),new Fg.a(5,5),new Fg.a(5,20),new Fg.a(0,20)];Fb=new Rl.a(Fb,0);Fb.ta.id=$a;Fb.mN("black");Fb.GB("white");Fb.Mw(1);na.equals(Tj.a.jW)?Fb.W6a(90):na.equals(Tj.a.WB)?Fb.W6a(0):na.equals(Tj.a.ES)?Fb.W6a(180):na.equals(Tj.a.p_)&&
Fb.W6a(-90);return Fb}cCm(na,$a){const Fb=new mk.a;Fb.ta.id=$a;Fb.mN("black");Fb.GB("white");Fb.Mw(1);Fb.mh(20,5);na.equals(Tj.a.north)?Fb.setPosition(-10,0):na.equals(Tj.a.south)?Fb.setPosition(-10,-5):na.equals(Tj.a.east)?(Fb.setPosition(-5,-10),Fb.mh(5,20)):na.equals(Tj.a.west)&&(Fb.setPosition(0,-10),Fb.mh(5,20));return Fb}get gUa(){return this.Ln}get Yd(){return this.Eb.viewport}OCe(na){return!this.ra.Ww&&8>na.index?this.NF[na.index].ta:null}YZ(){return!1}hD(na){na&&(this.Jqg=!1)}setSelection(){}static c_n(na,
$a,Fb,Xb){.999999<na+Fb&&(fe.a.J(512496987,822,15,"Invalid crop region inset values: left({0}), right({1})",na,Fb),Fb=(999999-1E6*na)/1E6);.999999<$a+Xb&&(fe.a.J(512496986,822,15,"Invalid crop region inset values: top({0}), bottom({1})",$a,Xb),Xb=(999999-1E6*$a)/1E6);return{left:na,top:$a,right:Fb,bottom:Xb}}}Xk.SVc=[Uj.a.dyh,Uj.a.byh,Uj.a.cyh,Uj.a.ayh,Uj.a.fyh,Uj.a.eyh,Uj.a.gyh,Uj.a.hyh];Object(m.a)(Xk,"PictureCropShapeView",null,[1264,760,301,24]);var hl=a(1220);class wl{constructor(na,$a,Fb){this.Ia=
na;this.Xaa=$a;this.a2a=Fb}setPosition(na,$a,Fb){this.a2a.k5(na.shapeNode).wRn($a,Fb)}setOffsets(na,$a){this.a2a.k5(na.shapeNode).xRn(na.OOe.copy(),$a)}Bna(na,$a){const Fb=new wj.a,Xb=this.a2a.k5(na.shapeNode);$a=$a?Xb.JMm().copy():Xb.xNm().copy();na=this.Ia.hS(na.shapeNode,this.Xaa);Fb.UG(na.x,na.y);Fb.gl($a);return new hl.a($a)}NI(na){return na.shapeNode.Ww}}Object(m.a)(wl,"ShapeCropMoveResizeHandler",null,[757]);var Sl=a(593);class $l{constructor(na,$a,Fb,Xb){this.a2a=na;this.Gpb=$a;this.H5d=Fb;
this.Y5=Xb}pW(na,$a,Fb){const Xb=this.a2a.k5(na);let nc=void 0;if(Xb&&Xb.visible!==Fb){for(const Nc of $a)this.H5d&&($a=Object(ed.a)(276,Nc))&&(nc=$a,$a.setSelected(!Fb)),$a=this.Y5&&(null===na||void 0===na?0:na.ZK)&&Nc instanceof Sl.a?!0:!1,Nc===Xb||$a||(Nc.visible=!Fb);Xb.visible=Fb;this.Y5&&(null===na||void 0===na?0:na.ZK)&&!Fb&&nc&&nc.KB()}}Ned(){return!1}Pfd(na,$a,Fb){this.a2a.k5(na).resize(Fb,$a)}Oed(){return!1}Qfd(na,$a,Fb,Xb){Xb&&this.a2a.k5(na).setPosition($a,Fb)}T9c(){return!this.Gpb}h$a(na,
$a){return this.Gpb?$a:this.Y5&&na.ZK?($a=$a.filter(Fb=>null!==Fb&&Fb instanceof Sl.a),Array.add($a,this.a2a.k5(na)),$a):[this.a2a.k5(na)]}NI(na){return na.Ww}}Object(m.a)($l,"ShapeViewCropUpdateStrategyHandler",null,[277,274]);var ka=a(664);class ib{constructor(){this.$=null}get name(){return"PowerPointWebEditor.PictureCrop"}lc(na){this.$=na;this.$.register(738,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>").ma().na(()=>new ka.a(($a,Fb)=>
{let Xb=null;const nc=Object(ed.a)(284,$a.tc(this.$.resolve("Box4.IPageView").Oa));nc&&!nc.isDisposed&&(Xb=new Xk($a,this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("PowerPointWebEditor.ISlideReader"),this.$.resolve("Common.IClickInputManager"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Box4.IPageView").yd,this.$.resolve("PowerPointWebEditor.View.IViewEventNotifier"),Fb,this.$.resolve("PowerPointWebEditor.IApplicationSettings").aKe,this.$.resolve("PowerPointWebEditor.IApplicationSettings").HCg,
this.$.resolve("PowerPointWebEditor.IApplicationSettings").wde,this.$.resolve("PowerPointWebEditor.IApplicationSettings").nbc,this.$.resolve("PowerPointWebEditor.ITransformFactory"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").XBe,this.$.resolve("PowerPointWebEditor.View.IPPTPageView")),Xb.xq(nc.ta),Xb.setZIndex(3),Xb.visible=!1,nc.QP(Xb.Yd.ta,!0),nc.hzb(Xb,3));return Xb}));this.$.register(xk,"PowerPointWebEditor.PictureCropActor").ma().na(()=>
new xk(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.$.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").WCl,this.$.resolve("PowerPointWebEditor.IApplicationSettings").kJe,this.$.resolve("Common.IBrowserUtils"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.$.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.$.resolve("PowerPointWebEditor.IGraphHotColdManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").Pja,this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").wde,this.$.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),
this.$.resolve("PowerPointWebEditor.IBusinessBarController"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").xJ,this.$.resolve("PowerPointWebEditor.IApplicationSettings").nbc));this.$.register(Xh,"PowerPointWebEditor.FormatPicturePaneActor").ma().na(()=>new Xh(this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),this.$.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.$.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.$.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),
Sf.a(this.$)))}init(){this.$.resolve("PowerPointWebEditor.ViewElements.ICompositeShapeViewUpdateStrategy").addHandler(new $l(this.$.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").HCg,this.$.resolve("PowerPointWebEditor.IApplicationSettings").pcd,this.$.resolve("PowerPointWebEditor.IApplicationSettings").nbc));this.$.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new wl(this.$.resolve("PowerPointWebEditor.IShapeReader"),
this.$.resolve("Box4.IPageView").yd,this.$.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>")));this.$.resolve("PowerPointWebEditor.PictureCropActor").Hb();this.$.resolve("PowerPointWebEditor.FormatPicturePaneActor").Hb();this.$.resolve("PowerPointWebEditor.FormatPicturePaneActor").ve()}dispose(){}static main(){l.a.instance.Fc(Mg.a(new ib,0))}}Object(m.a)(ib,"PPTWebEditorPictureCropPackage",null,[3,4]);var Rb=a(258),tc=a(399);class xc{constructor(na,
$a,Fb,Xb,nc){this.gA=[Rb.a.Rg,Rb.a.font,Lb.a.autonumberBulletType];this.Pb=na;this.un=$a;this.Cj=Fb;this.T5d=Xb;this.BH=nc}format(na){if(na&&na.$Ab){na=this.Pb.Hc(na);for(var $a=this.un.oca(na,na.currentNode);$a.moveNext();){var Fb=$a.currentNode;if(Fb&&this.Cj.me(Fb)){var Xb=this.Cj.P1b(Fb);Xb=this.BH.tP(na,Xb);(Fb=this.T5d.CId(Fb))&&tc.d(Xb,Fb,this.gA)}}}}}Object(m.a)(xc,"BeautifyListFormatter",null,[1239]);class hd{constructor(na,$a,Fb,Xb,nc){this.ia=na;this.va=Fb;this.Mb=$a;this.Ia=Xb;this.$an=
nc}initialize(){this.Hb()}Hb(){this.ia.sa(R.a.jze,P.a.application,Object(B.a)(this,this.jze,"applyTextFormatterSuggestion"),4)}jze(na,$a,Fb){if(1===Fb)return 32;$a=this.va.Ga;if(!$a)return 16;Fb=$a.xj();if(!Fb||!Fb.length)return 16;Fb=this.Ia.j3(Fb);if(!Fb.length)return 16;const Xb=this.Mb.Fd(15);Xb.rc($a);Ac.a("FixDesignerCrashViaSetUndoActionId")&&(Xb.sc=na);for(const nc of Fb)this.$an.format(nc);Xb.dispose();return 32}}Object(m.a)(hd,"TextFormatterActor",null,[]);class Fd{constructor(){this.$=
null}get name(){return"PowerPointWebEditor.TextFormatter"}lc(na){this.$=na;na.register(1239,"PowerPointWebEditor.IBeautifyListFormatter").ma().na(()=>new xc(this.$.resolve("Box4.Graph.IGraphIteratorFactory"),this.$.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.$.resolve("Box4.IParagraphReader"),this.$.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.$.resolve("PowerPointWebEditor.IPptListEditor")));na.register(hd,"PowerPointWebEditor.TextFormatter.TextFormatterActor").ma().na(()=>
new hd(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("PowerPointWebEditor.IBeautifyListFormatter")))}init(){const na=this.$.resolve("Common.IAppSettingsManager");na.fg(()=>{na.getBooleanAppSetting(Ie.a.xKe)&&this.$.resolve("PowerPointWebEditor.TextFormatter.TextFormatterActor").initialize()})}dispose(){}static main(){l.a.instance.Fc(Mg.a(new Fd,
0))}}Object(m.a)(Fd,"PPTWebEditorTextFormatterPackage",null,[3,4]);var Td=a(154);Type.registerNamespace("Box4.Symbols");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PictureCrop");Type.registerNamespace("PowerPointWebEditor.TellMe");Type.registerNamespace("PowerPointWebEditor.TextFormatter");Object(Td.c)("Chronos1");Gb.main();Type.registerNamespace("Common.App.O365Shell");mb.main();Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");
Vc.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");fh.main();window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Animation",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Animation.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Animation.MenuSection",
DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Animation.Gallery",ElementDimensions:"Size64by48",Width:"3"},children:[{name:"GalleryButton",attrs:{Id:"Existing",Command:"0x11CFD1C3",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}},
{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFadeIn",Alt:"STR@L_AnimationFadeIn"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.AnimationNew",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"AnimationGallery"},children:[{name:"MenuSection",attrs:{Id:"AnimationGalleryNone"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery1",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"ExistingInMenu",Command:"0x4B65244F",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEntrance",Id:"AnimationGalleryEntrance"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery2",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Appear",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",
Alt:"STR@L_AnimationFlyIn"}},{name:"GalleryButton",attrs:{Id:"Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"GrowAndTurn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowAndTurn",Alt:"STR@L_AnimationGrowAndTurn"}},{name:"GalleryButton",attrs:{Id:"Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},
{name:"GalleryButton",attrs:{Id:"BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Expand",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationExpand",Alt:"STR@L_AnimationExpand"}},{name:"GalleryButton",attrs:{Id:"PeekIn",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekIn",Alt:"STR@L_AnimationPeekIn"}},{name:"GalleryButton",attrs:{Id:"RiseUp",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRiseUp",Alt:"STR@L_AnimationRiseUp"}},{name:"GalleryButton",attrs:{Id:"Stretch",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretch",
Alt:"STR@L_AnimationStretch"}},{name:"GalleryButton",attrs:{Id:"Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEmphasis",Id:"AnimationGalleryEmphasis"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery3",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Emphasis_Spin",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSpin",Alt:"STR@L_AnimationSpin"}},{name:"GalleryButton",attrs:{Id:"Emphasis_GrowShrink",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowShrink",Alt:"STR@L_AnimationGrowShrink"}},{name:"GalleryButton",attrs:{Id:"Emphasis_Transparency",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationTransparency",
Alt:"STR@L_AnimationTransparency"}},{name:"GalleryButton",attrs:{Id:"Emphasis_LineColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationLineColor",Alt:"STR@L_AnimationLineColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FillColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFillColor",Alt:"STR@L_AnimationFillColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FontColor",
Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFontColor",Alt:"STR@L_AnimationFontColor"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationExit",Id:"AnimationGalleryExit"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery4",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Exit_Disappear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationDisappear",
Alt:"STR@L_AnimationDisappear"}},{name:"GalleryButton",attrs:{Id:"Exit_Fade",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"Exit_FlyOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyOut",Alt:"STR@L_AnimationFlyOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Exit_Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"Exit_RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},
{name:"GalleryButton",attrs:{Id:"Exit_Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Exit_Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Exit_Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},
{name:"GalleryButton",attrs:{Id:"Exit_PeekOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekOut",Alt:"STR@L_AnimationPeekOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Stretchy",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretchy",Alt:"STR@L_AnimationStretchy"}},{name:"GalleryButton",attrs:{Id:"Exit_Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Transition",Command:"0x78ACF6A1",LabelText:"STR@L_TransitionTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Transition.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Transition.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Transition.Gallery",ElementDimensions:"Size64by48",Width:"2"},children:[{name:"GalleryButton",
attrs:{Id:"TransitionExisting",Command:"0xDFACB0EC",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingTransitionButtonDescription"}},{name:"GalleryButton",attrs:{Id:"TransitionNone",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionNone",Alt:"STR@L_TransitionNone"}},{name:"GalleryButton",attrs:{Id:"TransitionFade",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_TransitionFade",Alt:"STR@L_TransitionFade"}},{name:"GalleryButton",attrs:{Id:"TransitionPush",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionPush",Alt:"STR@L_TransitionPush"}}]}]}]}]},{name:"Button",attrs:{Id:"PptTellMe.Designer",Command:"0x9531543E",LabelText:"STR@L_ShowHideDesignerPane"}},{name:"Button",attrs:{Id:"PptTellMe.Ideas",Command:"0x76FF601A",Image16by16:"IMGMAP@per@LightningIdeasHandraiseState_16x16x32",
LabelText:"STR@L_IdeasButtonHomeRibbon"}},{name:"Button",attrs:{Id:"PptTellMe.SelectAll",Command:"0x148D0534",Image16by16:"IMGMAP@per@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.GroupShapesUpSellButton",LabelText:"STR@L_GroupShapesUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTGroupShapes",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",
Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButton",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",
Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTWordArt",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButton",
LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",
ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButton",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},
children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertAudio",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButton",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertChart",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButtonEnterprise",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButtonEnterprise",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButtonEnterprise",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButtonEnterprise",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]}]};ib.main();Fd.main();Type.registerNamespace("NLRT");Object(Td.b)("Chronos1")},317:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(1611);class b{constructor(){this.selectedFont=this.dAb=this.Mze=this.Rwa=this.rda=
this.ooc=this.eAb=this.d$a=this.SJa=this.kX=this.Ezb=this.IDb=null}xg(f){this.IDb=new c.a;this.IDb.value=f}Z5b(f){this.Ezb=new c.a;this.Ezb.value=f}Dka(f){this.eAb=new c.a;this.eAb.value=f}}Object(x.a)(b,"QueryResult",null,[])},322:function(x,G,a){a.r(G);a.d(G,"Annotations",function(){return m});x=a(0);var c=a(134),b=a(523),f=a(390),e=a(1357),h=a(1358);class u{constructor(n,l){this.c3c=!1;this.sab=null;if(!n)throw Error.argumentNull("annotations");if(!n.sFe(l))throw Error.argument("structTypeID",
"Invalid struct type ID");this.nO=n;this.dGe=this.nO.Hvl(l);this.qmm=l}get aze(){return this.nO}get isReadOnly(){return this.c3c}get Hec(){return this.qmm}e8c(n){if(0>n||n>=this.dGe)throw Error.argument("iField","Invalid field index");return this.sab&&null!=this.sab[n]?this.sab[n]:this.nO.Owl(this.Hec,n)}Uzk(n,l){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>n||n>=this.dGe)throw Error.argument("iField","Invalid field index");if(!this.nO.TEe(this.nO.wKd(this.Hec,
n),l))throw Error.argument("value","Value is not of the correct type for the specified field");(this.sab||(this.sab=Array(this.dGe)))[n]=l}z8a(){const {Annotations:n}=a(322);let l="[";if(this.sab){let r=!0;for(let w=0;w<this.dGe;++w){if(null==this.sab[w])continue;const y=this.nO.wKd(this.Hec,w);if(n.$fd(y,this.sab[w],this.nO.Owl(this.Hec,w)))continue;r?r=!1:l+=", ";l+=this.nO.Pwl(this.Hec,w);l+="=";const z=this.nO.z8a(y,this.sab[w]);y===n.OUa?(l+='"',l+=b.a.uAi(z),l+='"'):l+=z}}return l+"]"}isEqual(n){const {Annotations:l}=
a(322);if(this===n)return!0;if(!n||this.nO!==n.aze||this.Hec!==n.Hec)return!1;for(let r=0;r<this.dGe;++r)if(!l.$fd(this.nO.wKd(this.Hec,r),this.e8c(r),n.e8c(r)))return!1;return!0}clone(){const n=new u(this.nO,this.Hec);this.sab&&(n.sab=Array.clone(this.sab));return n}nsa(){return this.isReadOnly?this.clone():this}jvj(){const {Annotations:n}=a(322);if(!this.isReadOnly&&(this.c3c=!0,this.sab))for(let l=0;l<this.dGe;++l){const r=this.sab[l];null!=r&&n.fWd(r)}}toString(){return this.z8a()}}Object(x.a)(u,
"StructValue",null,[1736,1734]);class m{constructor(n,l){if(!n)throw Error.argumentNull("initData");if(!l)throw Error.argumentNull("objectFetcher");this.Abn=l.zFm;let r=0;var w=l.P7c(n.ha(r));++r;this.pPj=new e.a(new h.a(w));this.vhm=n.ha(r);++r;this.XHl=Array(this.sfh);this.a4f=Array(this.sfh);this.Y$c=Array(this.sfh);for(w=0;w<this.sfh;++w){this.XHl[w]=l.i3(n.ha(r));++r;this.a4f[w]=n.ha(r);++r;var y=n.ha(r);++r;this.Y$c[w]=Array(y);for(var z=0;z<y;++z)this.Y$c[w][z]=l.i3(n.ha(r)),++r}this.pmm=n.ha(r);
++r;this.oMl=Array(this.cXg);this.dqh=Array(this.cXg);this.eqh=Array(this.cXg);this.cqh=Array(this.cXg);for(w=0;w<this.cXg;++w)for(this.oMl[w]=l.i3(n.ha(r)),++r,y=n.ha(r),++r,this.dqh[w]=Array(y),this.eqh[w]=Array(y),this.cqh[w]=Array(y),z=0;z<y;++z)this.dqh[w][z]=l.i3(n.ha(r)),++r,this.eqh[w][z]=n.ha(r),++r,this.cqh[w][z]=({H$a:r}=this.Phb(this.eqh[w][z],n,r,null,null,null)).returnValue,m.fWd(this.cqh[w][z]);this.Ofm=n.ha(r);++r;this.wBj=Array(this.wze);this.xBj=Array(this.wze);this.vBj=Array(this.wze);
for(w=0;w<this.wze;++w)this.wBj[w]=l.i3(n.ha(r)),++r,this.xBj[w]=n.ha(r),++r,this.vBj[w]=({H$a:r}=this.Phb(this.xBj[w],n,r,null,null,null)).returnValue,m.fWd(this.vBj[w])}Uzf(n){for(let l=0;l<this.wze;++l)if(this.wBj[l]===n)return l;return-1}Jtl(n){if(!this.qFe(n))throw Error.argument("attrID","Invalid attribute ID");return this.wBj[n]}getAttributeType(n){if(!this.qFe(n))throw Error.argument("attrID","Invalid attribute ID");return this.xBj[n]}wKd(n,l){if(!this.sFe(n))throw Error.argument("structTypeID",
"Invalid struct type ID");n=this.eqh[m.dXg(n)];if(0>l||l>=n.length)throw Error.argument("iField","Invalid field index");return n[l]}z8a(n,l){if(!this.lrj(n))throw Error.argument("typeID","Invalid type ID");if(!this.TEe(n,l))throw Error.argument("value","Value is not of the correct type");switch(n){case m.OUa:return l;case m.JDb:return l?"True":"False";case m.G8b:case m.Lxb:return l.toString();case m.Xta:return l.z8a();default:if(!m.M8(n)&&m.z1g(n)){n=m.iAi(n);const y=this.Y$c[n].length;switch(this.a4f[n]){case 0:return this.Y$c[n][l];
case 1:if(l){var r="";for(var w=1;w<y;++w)l&1<<w-1&&(0<r.length&&(r+=" & "),r+=this.Y$c[n][w]);return r}return this.Y$c[n][0];case 2:r="";for(w=0;w<y;++w)l&1<<w&&(0<r.length&&(r+=" & "),r+=this.Y$c[n][w]);return r;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.a4f[n]);}}else return l.z8a()}}lrj(n){switch(n){case m.OUa:case m.JDb:case m.G8b:case m.Lxb:case m.Xta:return!0;default:return m.M8(n)?this.lrj(m.twc(n)):m.z1g(n)?this.o7m(n):this.sFe(n)}}o7m(n){n=m.iAi(n);return 0<=
n&&n<this.XHl.length}sFe(n){n=m.dXg(n);return 0<=n&&n<this.oMl.length}qFe(n){return 0<=n&&n<this.wze}TEe(n,l){if(null==l)return!1;switch(n){case m.OUa:return"string"===typeof l;case m.JDb:return"boolean"===typeof l;case m.G8b:return"number"===typeof l;case m.Lxb:return"number"===typeof l;case m.Xta:return Object(c.a)(1733,l);default:if(m.M8(n))return Object(c.a)(1735,l)&&l.vOa===m.twc(n);if(m.z1g(n)){if("number"!==typeof l)return!1;n=m.iAi(n);const r=this.Y$c[n].length;switch(this.a4f[n]){case 0:return 0<=
l&&l<r;case 1:return!(l&-1<<r-1);case 2:return!!l&&!(l&-1<<r);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.a4f[n]);}}else return Object(c.a)(1736,l)&&l.Hec===n}}get wze(){return this.Ofm}get sfh(){return this.vhm}get cXg(){return this.pmm}hMm(n){if(!this.qFe(n))throw Error.argument("attrID","Invalid attribute ID");return this.vBj[n]}Hvl(n){if(!this.sFe(n))throw Error.argument("structTypeID","Invalid struct type ID");return this.dqh[m.dXg(n)].length}Pwl(n,l){if(!this.sFe(n))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.dqh[m.dXg(n)][l]}Owl(n,l){if(!this.sFe(n))throw Error.argument("structTypeID","Invalid struct type ID");n=this.cqh[m.dXg(n)];if(0>l||l>=n.length)throw Error.argument("iField","Invalid field index");return n[l]}Phb(n,l,r,w,y,z){if(!l)throw Error.argumentNull("initData");if(m.M8(n)){var A=l.ha(r);++r;n=m.twc(n);var B=new f.a(this,n);for(var H=0;H<A;++H)Array.add(B.items,({H$a:r}=this.Phb(n,l,r,w,y,z)).returnValue);return{returnValue:B,H$a:r}}switch(n){case m.OUa:return{returnValue:(w||
this.pPj).i3(l.ha(r++)),H$a:r};case m.JDb:return{returnValue:1===l.ha(r++),H$a:r};case m.G8b:return{returnValue:l.ha(r++),H$a:r};case m.Lxb:return{returnValue:(y||this.Abn)[l.ha(r++)],H$a:r};case m.Xta:n=l.ha(r++);A=new b.a(this);for(B=0;B<n;++B)H=l.ha(r),++r,z&&(H=z[H]),A.BS(H,({H$a:r}=this.Phb(this.getAttributeType(H),l,r,w,y,z)).returnValue);return{returnValue:A,H$a:r};default:if(m.z1g(n))return{returnValue:l.ha(r++),H$a:r};if(m.H8l(n)){A=l.ha(r++);B=new u(this,n);for(H=0;H<A;++H){const v=l.ha(r);
++r;B.Uzk(v,({H$a:r}=this.Phb(this.wKd(n,v),l,r,w,y,z)).returnValue)}return{returnValue:B,H$a:r}}throw Error.argument("typeID","Invalid type ID");}}static z1g(n){return 16<=(n&16383)&&16384!==(n&16384)&&32768!==(n&32768)}static H8l(n){return 16<=(n&16383)&&16384===(n&16384)&&32768!==(n&32768)}static M8(n){return 32768===(n&32768)}static hQm(n){if(m.M8(n))throw Error.argument("nonListTypeID","Non-list type ID required");return n|32768}static twc(n){if(!m.M8(n))throw Error.argument("listTypeID","List type ID required");
return n&-32769}static $fd(n,l,r){switch(n){case m.OUa:case m.JDb:case m.G8b:case m.Lxb:return l===r;case m.Xta:return l.isEqual(r);default:return m.M8(n)?l.isEqual(r):m.z1g(n)?l===r:l.isEqual(r)}}static fWd(n){Object(c.a)(1734,n)&&n.jvj()}static nsa(n){return Object(c.a)(1734,n)?n.nsa():n}static iAi(n){return n-16}static dXg(n){return(n&-16385)-16}}m.OUa=1;m.JDb=2;m.G8b=3;m.Lxb=5;m.Xta=9;Object(x.a)(m,"Annotations",null,[1737])},332:function(x,G,a){a.d(G,"a",function(){return c});a.d(G,"b",function(){return b});
const c=f=>null===f||"undefined"===typeof f||!f.length,b=f=>null===f||"undefined"===typeof f},390:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(523);class b{constructor(f,e){this.c3c=!1;const {Annotations:h}=a(322);if(!f)throw Error.argumentNull("annotations");if(!f.lrj(e))throw Error.argument("memberTypeID","Invalid type ID");if(h.M8(e))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.nO=f;this.Sjm=e;this.iQ=[]}get aze(){return this.nO}get isReadOnly(){return this.c3c}get vOa(){return this.Sjm}get items(){return this.iQ}z8a(){const {Annotations:f}=
a(322);let e="[";for(let h=0,u=this.items.length;h<u;++h){0<h&&(e+=", ");const m=this.nO.z8a(this.vOa,this.items[h]);this.vOa===f.OUa?(e+='"',e+=c.a.uAi(m),e+='"'):e+=m}return e+"]"}isEqual(f){const {Annotations:e}=a(322);if(this===f)return!0;if(!f||f.aze!==this.nO||f.vOa!==this.vOa||f.items.length!==this.items.length)return!1;for(let h=0;h<this.items.length;++h)if(!e.$fd(this.vOa,this.items[h],f.items[h]))return!1;return!0}clone(){const f=new b(this.nO,this.vOa);Array.addRange(f.items,this.items);
return f}nsa(){return this.isReadOnly?this.clone():this}jvj(){const {Annotations:f}=a(322);if(!this.isReadOnly){this.c3c=!0;for(const e of this.items)f.fWd(e)}}toString(){return this.z8a()}}Object(x.a)(b,"ListValue",null,[1735,1734])},523:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);class c{constructor(f,e){this.e5c=f;this.value=e}}Object(x.a)(c,"AttrValuePair",null,[]);class b{constructor(f){this.c3c=!1;if(!f)throw Error.argumentNull("annotations");this.nO=f;this.Kya=[]}get aze(){return this.nO}get isReadOnly(){return this.c3c}get r6i(){return 0<
this.Kya.length}lD(f){if(!this.nO.qFe(f))throw Error.argument("attributeID","Invalid attribute ID");for(const e of this.Kya)if(f===e.e5c)return f=e.value,{returnValue:!0,value:f};return{returnValue:!1,value:null}}BS(f,e){var {Annotations:h}=a(322);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.nO.qFe(f))throw Error.argument("attributeID","Invalid attribute ID");if(!this.nO.TEe(this.nO.getAttributeType(f),e))throw Error.argument("value",
"Value is not of the correct type for the specified attribute");h.fWd(e);for(h=0;h<this.Kya.length;++h){const u=this.Kya[h];if(f===u.e5c){u.value=e;return}}Array.add(this.Kya,new c(f,e))}fuh(f){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.nO.qFe(f))throw Error.argument("attributeID","Invalid attribute ID");for(let e=0;e<this.Kya.length;++e)if(f===this.Kya[e].e5c){Array.removeAt(this.Kya,e);break}}tgh(f){if(!f)throw Error.argumentNull("action");
for(const e of this.Kya)f(e.e5c,e.value)}clone(){const f=new b(this.nO);f.wqc(this);return f}wqc(f){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!f)throw Error.argumentNull("other");if(f.aze!==this.nO)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.Kya);f.tgh((e,h)=>{this.BS(e,h)})}z8a(){const {Annotations:f}=a(322);let e="[",h=!0;for(const u of this.Kya){h?h=!1:e+=", ";e+=this.nO.Jtl(u.e5c);e+="=";const m=
this.nO.getAttributeType(u.e5c),n=this.nO.z8a(m,u.value);m===f.OUa?(e+='"',e+=b.uAi(n),e+='"'):e+=n}return e+"]"}isEqual(f){const {Annotations:e}=a(322);if(!f)throw Error.argumentNull("other");if(this===f)return!0;if(!f||this.nO!==f.aze||this.r6i!==f.r6i)return!1;let h=0,u=null,m=!1;f.tgh((n,l)=>{++h;if(!m){var r=-1;for(let w=0,y=this.Kya.length;w<y;++w)if(this.Kya[w].e5c===n){r=w;break}0>r?m=!0:(u||(u=Array(this.Kya.length)),u[r]=l)}});if(this.Kya.length!==h||m)return!1;for(let n=0,l=this.Kya.length;n<
l;++n)if(!e.$fd(this.nO.getAttributeType(this.Kya[n].e5c),this.Kya[n].value,u[n]))return!1;return!0}nsa(){return this.isReadOnly?this.clone():this}jvj(){const {Annotations:f}=a(322);if(!this.isReadOnly){this.c3c=!0;for(const e of this.Kya)f.fWd(e.value)}}toString(){return this.z8a()}static uAi(f){return f.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(x.a)(b,"FeatureBundle",null,[1733,1734])},598:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(4);
class b{constructor(){this.currentDocumentPath=c.AFrameworkApplication.ga.La("EditDocInClientUrl")}}Object(x.a)(b,"SmartLookupApplicationInterface",null,[])},599:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.data=this.landingTab=null}}Object(x.a)(c,"LaunchData",null,[])},654:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.gw="InputMethod";c.J8="ShouldCanvasTakeFocus";c.Jfd="UILocation";Object(x.a)(c,"ReactRibbonConstants",null,[])},665:function(x,
G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.cNj=null;this.C3=this.kPj=0}$yf(b,f,e){if(!b)throw Error.argumentNull("referenceList");if(0>f||f>b.length)throw Error.argumentOutOfRange("startIndex");if(0>e||e>b.length)throw Error.argumentOutOfRange("length");if(f+e>b.length)throw Error.argument("Invalid start-length range");this.cNj=b;this.kPj=f;this.C3=e}E7c(b,f,e){this.$yf(b.cNj,b.kPj+f,e)}ha(b){if(0>b||b>=this.C3)throw Error.argumentOutOfRange("index");return this.cNj[this.kPj+
b]}get count(){return this.C3}static zpi(b){const f=new c;f.$yf(b,0,b.length);return f}}Object(x.a)(c,"ReadOnlyList",null,[1779])},821:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}Object(x.a)(c,"SmartLookupSelection",null,[])},886:function(x,G,a){a.d(G,"a",function(){return n});x=a(0);var c=a(17),b=a(40),f=a(4),e=a(43),h=a(19),u=a(84),m=a(18);class n{constructor(){this.eG=null}kcb(){try{this.eG||(this.eG=h.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"))}catch(l){c.ULS.sendTraceTag(51689674,
1300,10,"Unable to resolve ISearchOAuthManager: "+l)}}dIf(l,r){return this.eG?this.eG.getToken(l,r):new Promise(w=>{h.a.instance.Na("Common.App.SearchCommon.ISearchOAuthManager").execute(y=>{y?(this.eG=y,this.eG.getToken(l,r).then(z=>w(z))):w(null)})})}rEf(){this.kcb();return this.eG?this.eG.getToken("Search",f.AFrameworkApplication.zZf):null}WCe(){if("Dev Box"===f.AFrameworkApplication.ga.La("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(l=>
{window.setTimeout(()=>{l(window.TellMeSubstrateTokenOverride)},750)});this.kcb();return this.eG?this.eG.getToken("Search",f.AFrameworkApplication.tXg):null}OXi(){this.kcb();return this.eG?this.eG.getToken("Search",this.KHf()):null}KHf(){return f.AFrameworkApplication.ga.La("TellMeServiceAuthEndpointForSearch")}QVi(){if("Dev Box"===f.AFrameworkApplication.ga.La("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(l=>
{window.setTimeout(()=>{l(window.TellMeSubstrateTokenOverride)},750)});this.kcb();return this.eG?this.eG.getToken("SmartLookup",this.SGf()):null}SGf(){return f.AFrameworkApplication.ga.La("SmartLookupShredderServiceEndpoint")}sEf(){return Object(b.a)(this,this.rEf,"getLokiTokenPromise")}xHf(){return Object(b.a)(this,this.WCe,"getSubstrateTokenPromise")}kwb(){return!!f.AFrameworkApplication.Ea&&f.AFrameworkApplication.Ea.Kb.kwb}vih(){const l={};this.kwb()&&(l.Loki=this.sEf(),l.Substrate=this.xHf());
return l}eMa(l){e.a.T5b(Object.assign(new u.a,{name:"Events",dataFields:[Object.assign(new m.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new m.a,{name:"Status",bool:l})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}Tlh(){return f.AFrameworkApplication.ga.getBooleanAppSetting("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.eMa(!1);return!1}).then(()=>{this.eMa(!0);return!0}):new Promise((l,r)=>{const w=h.a.instance.resolve("Common.IDynamicScriptLoaderProvider").LW;
w?w.loadScript("tellme-strings").then(()=>{this.eMa(!0);l(!0)}).catch(()=>{this.eMa(!1);r(!1)}):(this.eMa(!1),r(!1))})}static glh(){return!!f.AFrameworkApplication.Ea&&(f.AFrameworkApplication.Ea.Kb.wbc||f.AFrameworkApplication.Ea.Kb.hmb)}static M9c(){return!!f.AFrameworkApplication.Ea&&f.AFrameworkApplication.Ea.Kb.hmb}}Object(x.a)(n,"ReactSharedHeaderSearchUtils",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.chronos1.js.map