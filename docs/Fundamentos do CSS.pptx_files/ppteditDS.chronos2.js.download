'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[15],{1114:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.Collapse=this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(x.a)(c,"GallerySectionProps",null,[])},1117:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.taskPaneWidth="TaskPaneWidth";c.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";c.JB="TaskPaneTitle";c.nonPersistedSettings=
"NonPersistedSettings";c.onTaskPaneClose="OnTaskPaneClose";c.onExtensionLaunchCallback="OnExtensionLaunchCallback";c.LU="OnRenderedCallback";c.z6c="DialogIsModal";c.A6c="DialogShowTitleBar";c.dialogWidth="DialogWidth";c.dialogHeight="DialogHeight";c.dialogLeft="DialogLeft";c.osc="DialogRight";c.dialogTop="DialogTop";c.ksc="DialogBottom";c.qca="DialogTitle";c.msc="DialogCloseCallback";c.nsc="DialogResizeCallback";c.JBd="DialogParentId";c.showLoadingSpinner="ShowLoadingSpinner";c.actionName="ActionName";
Object(x.a)(c,"PropertyNames",null,[])},1124:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.z$d="Listening";c.Ibd="Warning";c.VBb="Error";Object(x.a)(c,"VoiceNotificationResourceStrings",null,[])},1132:function(x,G,a){function c(Fa,rb){var $b=document.getElementById(Fa);$b?$b.innerHTML=rb:($b=document.createElement("style"),$b.id=Fa,$b.type="text/css",$b.innerHTML=rb,document.head.appendChild($b))}function b(){var Fa=document.querySelectorAll("[data-unique-id^='Ribbon-'][data-unique-id$='SubMenuAnchor']");
if(Fa&&0<Fa.length)for(var rb=0;rb<Fa.length;rb++)Fa[rb].removeAttribute("aria-selected")}function f(Fa){Fa=Fa.map(rb=>`[data-icon-name=${"AddinFlyoutControl"+rb}]::after {
      content: "";
      position: absolute;
      top: 9px;
      right: 18px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: #CC4A31;
    }`).join("");c("RedDotNotification",Fa)}function e(Fa,rb){Fa=Fa.map(($b,ec)=>`        [id="InsertAddInFlyoutMenuIdsection-${ec+rb}-title"]>div>span:after,
      [id="Ribbon-InsertAddInFlyoutDropdownsection-${ec+rb}-title"]>div>span:after {
    content: "${$b}";
    display: block;
    font-size: 12px;
    font-weight: 400;
    line-height: initial;
  }
  [id="InsertAddInFlyoutMenuIdsection-${ec+rb}-title"]>div>span,
  [id="Ribbon-InsertAddInFlyoutDropdownsection-${ec+rb}-title"]>div>span{
    display: flex;
    flex-direction: column;
    padding-top: 5px;
    padding-bottom: 5px;
    line-height: 20px;
  }
  [id="InsertAddInFlyoutMenuIdsection-${ec+rb}-title"],
  [id="Ribbon-InsertAddInFlyoutDropdownsection-${ec+rb}-title"]{
    height: unset;
  }`).join("");c("CategoryDescription",Fa)}function h(Fa){Fa=Fa.map(rb=>{var [$b,ec]=rb;return`[name="${$b}"]>div>span:after {
    content: "${ec}";
    display: block;
    font-size: 12px;
    font-weight: 400;
    line-height: initial;
  }
  [name="${$b}"]>div>span {
    display: flex;
    flex-direction: column;
    padding-top: 5px;
    padding-bottom: 5px;
    line-height: 20px;
  }
  [name="${$b}"]>div {
    height: unset;
  }
  [id="Ribbon-InsertAddInFlyoutDropdown"] button[aria-haspopup="true"][name="${$b}"],
  [id="InsertAddInFlyoutMenuId"] button[aria-haspopup="true"][name="${$b}"]{
    height: unset;
  }
  `}).join("");c("CategoryDescriptionAnchor",Fa)}function u(Fa){return wt(function*(){let rb;for(let Mc=0;10>Mc;++Mc)(rb=document.getElementById("fluent-default-layer-host"))||(yield new Promise(ed=>setTimeout(ed,1E3)));if(!rb)throw Error("Cannot find the flyout container.");let $b=!1,ec=performance.now(),pc;const dd=Mc=>{const ed=performance.now();Mc?($b=!0,Fa(!0,0),ec=ed):$b&&($b=!1,Fa(!1,ed-ec))},Ad=Mc=>{pc&&pc.disconnect();const ed=Mc.querySelector('[id="InsertAddInFlyoutMenuId"]');ed?(pc=new MutationObserver(Yc=>
{for(const ab of Yc)"attributes"===ab.type&&ab.target instanceof HTMLElement&&("InsertAddInFlyoutMenuId"!==ab.target.id?dd(!1):dd(!0))}),pc.observe(ed,{attributes:!0,attributeFilter:["id"]}),dd(!0)):(pc=new MutationObserver(Yc=>{for(const ab of Yc)"attributes"===ab.type&&ab.target instanceof HTMLElement&&("hidden"===ab.target.style.visibility?dd(!1):dd(!0))}),pc.observe(Mc,{attributes:!0,attributeFilter:["style"]}),"hidden"!==Mc.style.visibility&&dd(!0))},Jb=new WeakSet,Bc=new MutationObserver(Mc=>
{for(const Yc of Mc){for(Mc=0;Mc<Yc.addedNodes.length;++Mc){var ed=Yc.addedNodes.item(Mc);ed instanceof HTMLElement&&(ed.querySelector('[id="Ribbon-InsertAddInFlyoutDropdown"]')||ed.querySelector('[id="InsertAddInFlyoutMenuId"]'))&&(Ad(ed.querySelector(".ms-Callout-container")),Jb.add(ed))}for(Mc=0;Mc<Yc.removedNodes.length;++Mc)ed=Yc.removedNodes.item(Mc),Jb.has(ed)&&(Jb.delete(ed),dd(!1))}});Bc.observe(rb,{attributes:!1,childList:!0});return{dispose:()=>{Bc.disconnect();null===pc||void 0===pc?void 0:
pc.disconnect()}}})}function m(Fa){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Fa.solutionId,Fa.storeType,Fa.assetId,null,null,Fa.storeId)}function n(Fa,rb,$b){var ec=document.getElementById(Fa);ec?$b?ec.innerText=$b:ec.remove():(ec=document.getElementById(rb),$b&&ec&&(rb=document.createElement("div"),rb.setAttribute("role","marquee"),rb.setAttribute("aria-live","polite"),rb.setAttribute("aria-atomic","true"),rb.id=Fa,rb.innerText=$b,rb.style.overflow="hidden",rb.style.maxWidth="0px",rb.style.maxHeight=
"0px",rb.style.zIndex="-1",ec.after(rb)))}a.d(G,"a",function(){return wb});x=a(0);var l=a(17),r=a(1117),w=a(24),y=a(43),z=a(4),A=a(93),B=a(6);const H=()=>({["APIC"]:Object(B.a)("AddInCategoryTitleAddingPicturesIconsAndCharts"),["APID"]:Object(B.a)("AddInCategoryTitleAddingPicturesIconsAndDiagrams"),["BBM"]:Object(B.a)("AddInCategoryTitleBuildByMicrosoft"),["CAIP"]:Object(B.a)("AddInCategoryTitleDesigningAnInteractivePresentation"),["DA"]:Object(B.a)("AddInCategoryTitleDataSyncAndAnalysis"),["DWT"]:Object(B.a)("AddInCategoryTitleDesigningWithTemplates"),
["ER"]:Object(B.a)("AddInCategoryTitleEducationalPurpose"),["FA"]:Object(B.a)("AddInCategoryTitleFinancialAnalytics"),["IPWAI"]:Object(B.a)("AddInCategoryTitleImprovingProductivityWithAI"),["TD"]:Object(B.a)("AddInCategoryTitleTrendingAddins"),["WN"]:Object(B.a)("AddInCategoryTitleNewAddins"),["WF"]:Object(B.a)("AddInCategoryTitleWritingFluently"),["PAIYO"]:Object(B.a)("AddInCategoryTitlePopularAddinsInYourOrg"),default:Object(B.a)("PopularAddins")}),v=()=>({["Word"]:{["IPWAI"]:Object(B.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||
"Add-ins with AI",["WF"]:Object(B.a)("AddInCategoryShortTitleWritingFluently")||"Perfect your writing",["ER"]:Object(B.a)("AddInCategoryShortTitleEducationalResources")||"Education",["APID"]:Object(B.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||"Unlock your creativity"},["Excel"]:{["IPWAI"]:Object(B.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||"Add-ins with AI",["APID"]:Object(B.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||"Unlock your creativity",["FA"]:Object(B.a)("AddInCategoryShortTitleFinancialAnalytics")||
"Manage your finances"},["PowerPoint"]:{["IPWAI"]:Object(B.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||"Add-ins with AI",["APID"]:Object(B.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||"Unlock your creativity",["CAIP"]:Object(B.a)("AddInCategoryShortTitleCreatingAnInteractivePresentation")||"Elevate your presentations",["DWT"]:Object(B.a)("AddInCategoryShortTitleDesigningWithTemplates")||"Templates"},shared:{["BBM"]:Object(B.a)("AddInCategoryShortTitleBuildByMicrosoft")||
"Built by Microsoft",["TD"]:Object(B.a)("AddInCategoryShortTitleTrending")||"Trending",["WN"]:Object(B.a)("AddInCategoryShortTitleWhatsNew")||"Just released",["PAIYO"]:Object(B.a)("AddInCategoryShortTitlePopularAddinsInYourOrg")||"Popular"}}),C=()=>({["Word"]:{["APID"]:Object(B.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsWord")||"Add photos, icons, and diagrams to your documents.",["ER"]:Object(B.a)("AddInCategoryDescriptionEducationalResources")||"Resources for educators and students.",
["IPWAI"]:Object(B.a)("AddInCategoryDescriptionImprovingProductivityWithAIWord")||"Draft and summarize with the power of generative AI.",["WF"]:Object(B.a)("AddInCategoryDescriptionWritingFluently")||"Get help with spelling, grammar, and more."},["Excel"]:{["APID"]:Object(B.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsExcel")||"Add photos, icons, and diagrams to spreadsheets.",["DA"]:Object(B.a)("AddInCategoryDescriptionDataAnalytics")||"Get key insights about the data in your speadsheets",
["IPWAI"]:Object(B.a)("AddInCategoryDescriptionImprovingProductivityWithAIExcel")||"Use the power of AI to capture and understand your data.",["FA"]:Object(B.a)("AddInCategoryDescriptionFinancialAnalytics")||"Track expenses, budget, and more."},["PowerPoint"]:{["IPWAI"]:Object(B.a)("AddInCategoryDescriptionImprovingProductivityWithAIPowerPoint")||"Use the power of AI in your presentations.",["APID"]:Object(B.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsPowerPoint")||"Add photos, icons, and diagrams to slides.",
["CAIP"]:Object(B.a)("AddInCategoryDescriptionCreatingAnInteractivePresentation")||"Add polls, timers, and more.",["DWT"]:Object(B.a)("AddInCategoryDescriptionDesigningWithTemplates")||"Create beautiful slides with templates you can customize."},shared:{["BBM"]:Object(B.a)("AddInCategoryDescriptionBuildByMicrosoft")||"Create surveys, visualize data, and more, all from Microsoft.",["TD"]:Object(B.a)("AddInCategoryDescriptionTrending")||"Recently added by others.",["WN"]:Object(B.a)("AddInCategoryDescriptionWhatsNew")||
"Brand new or updated add ins.",["PAIYO"]:Object(B.a)("AddInCategoryDescriptionPopularAddinsInYourOrg")||"Add ins people add and use the most in your organization."}});var F=a(1458);class D{constructor(Fa){this.WG=Fa;this.d$c=new Set;this.OHa=[];this.Eaf=F.a.instance}psg(Fa){this.OHa.includes(Fa)&&(this.d$c.add(Fa),Fa={["solutionIds"]:[m(this.WG.D0(Fa))],["isUpgraded"]:this.WG.getUpgradedAddinsOfOmex().has(Fa)},this.Nbb(Fa,"ClickFlyoutRedDotAddins"))}Qzf(Fa){const rb=this.WG.getUpgradedAddinsOfOmex(),
$b=this.Eaf.Gbd;return Fa.filter(ec=>($b.has(ec)||rb.has(ec))&&!this.d$c.has(ec))}v$e(Fa){this.OHa=this.Qzf(Fa.map(rb=>rb.solutionId));f(this.OHa);0!==this.OHa.length&&(Fa={["solutionIds"]:this.OHa.map(rb=>m(this.WG.D0(rb)))},this.Nbb(Fa,"ShowFlyoutRedDotAddins"))}Nbb(Fa,rb){y.a.sendTelemetryEvent(Object.assign(new A.a,{name:`Office.Extensibility.Host.${rb}`,dataFields:w.a.Gw(Fa)}))}}Object(x.a)(D,"AppsInFlyoutNotificationManager",null,[]);var N=a(68),U=a(10),W=a(387),L=a(798),O=a(80),M=a(524),K=
a(680);class P{constructor(Fa,rb,$b){this.amountToShowWhenCollapsed=Fa;this.expandButton=rb;this.collapseButton=$b}}Object(x.a)(P,"GallerySectionCollapse",null,[]);var V=a(1114),Y=a(1097);class ta{constructor(){this.text=this.href=null}}Object(x.a)(ta,"LinkProps",null,[]);class fa{constructor(){this.icon=this.text=this.href=null}}Object(x.a)(fa,"LinkWithLabelProps",null,[]);var Ta=a(481),ha=a(435),qa=a(799),ra=a(797),I=a(36),ba=a(5),Ga=a(702),Oa=a(597),Ja;(function(Fa){Fa[Fa.y3k=0]="S_OK";Fa[Fa.I2k=
-2147471590]="E_REQUEST_TIME_OUT";Fa[Fa.J2k=-2147208619]="E_USER_NOT_SIGNED_IN";Fa[Fa.A2k=-2147471591]="E_CATALOG_ACCESS_DENIED";Fa[Fa.C2k=-2147471589]="E_CATALOG_REQUEST_FAILED";Fa[Fa.F2k=-2147208640]="E_OEM_NO_NETWORK_CONNECTION";Fa[Fa.H2k=-2147208617]="E_PROVIDER_NOT_REGISTERED";Fa[Fa.E2k=-2147208637]="E_OEM_CACHE_SHUTDOWN";Fa[Fa.G2k=-2147209421]="E_OEM_REMOVED_FAILED";Fa[Fa.B2k=-1]="E_CATALOG_NO_APPS";Fa[Fa.K2k=-2]="E_USER_NO_MAILBOX";Fa[Fa.D2k=-1E3]="E_GENERIC_ERROR";Fa[Fa.x3k=10]="S_HIDE_PROVIDER"})(Ja||
(Ja={}));Object(x.b)("InvokeResultCode",Ja);class Qa{constructor(Fa,rb){this.Ba=rb;this.jC=Fa}get TUg(){return this.Ba?this.Ba.isChangeGateEnabled("OfficeVSO:8511220_showPopularOnFailForGuests"):!1}Ved(Fa){return this.TUg?Fa.failure?-2147208619===Fa.failure.invokeResultCode:!1:!1}i8c(Fa,rb){return`invokeFailure/${3===Fa.errorCode&&Fa.failure?Ja[Fa.failure.invokeResultCode]:""}/${3===rb.errorCode&&rb.failure?Ja[rb.failure.invokeResultCode]:""}`}i$c(Fa,rb,$b,ec){Fa={["Source"]:this.jC,["MRUListNumber"]:Fa.toString(),
["MyAddinsErrorCode"]:Oa.a[rb.errorCode],["MyAddInsResult"]:rb.qp.length.toString(),["MyAddinsInvokeResultCode"]:rb.failure?rb.failure.invokeResultCode:"N/A",["AdminManagedErrorCode"]:Oa.a[$b.errorCode],["AdminManagedResult"]:$b.qp.length.toString(),["AdminManageInvokeResultCode"]:$b.failure?$b.failure.invokeResultCode:"N/A",["PopularAddinsErrorCode"]:ec?Oa.a[ec.errorCode]:"N/A",["PopularAddinsResult"]:ec?ec.qp.length.toString():"N/A",["PopularAddinsInvokeResultCode"]:ec&&ec.failure?ec.failure.invokeResultCode:
"N/A"};this.CTg&&(Fa.MyAddinsQueryStart=this.p$a(rb.failure),Fa.AdminManagedQueryStart=this.p$a($b.failure),Fa.PopularQueryStart=this.p$a(ec.failure));y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Extensibility.Host.AddinEntryPointDisplayMetrics",dataFields:w.a.Gw(Fa)}))}h$c(Fa,rb,$b,ec,pc){$b={["MyAddinsResult"]:this.IKb($b),["AdminManagedResult"]:this.IKb(ec),["PopularResult"]:this.IKb(pc)};Fa={["Source"]:this.jC,["Abnormals"]:rb.join("|"),["NumAddinsInMRU"]:Fa.toString(),["DiagnosticDetails"]:JSON.stringify($b)};
y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Extensibility.Host.AddinEntryPointAceMetrics",dataFields:w.a.Gw(Fa)}))}IKb(Fa){return{["Count"]:Fa.qp.length.toString(),["QueryStart"]:this.p$a(Fa.failure),["ErrorCode"]:Oa.a[Fa.errorCode],["InvokeResultCode"]:Fa.failure?Fa.failure.invokeResultCode:"N/A"}}get nfd(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8393563_FlyoutTelemetryOptimizationEnabled")}get g$c(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8581842_LogAceMetricsEnabled")}p$a(Fa){let rb=
"N/A";Fa&&Fa.queryStart&&window.performance.timeOrigin&&(rb=(new Date(window.performance.timeOrigin+Fa.queryStart)).toISOString());return rb}get CTg(){return this.Ba?this.Ba.isChangeGateEnabled("OfficeVSO:8546535_LogQueryStartEnabled"):!1}}Object(x.a)(Qa,"AddinEntryPointCommon",null,[]);const Pa="wa102927044 wa102957661 wa102957665 wa103147117 wa103296784 wa103304320 wa103651566 wa103863850 wa103982217 wa103982219 wa103982221 wa103985973 wa103996219 wa104003812 wa104006972 wa104017332 wa104032712 wa104036095 wa104038832 wa104041485 wa104051163 wa104092360 wa104096858 wa104099688 wa104100404 wa104104476 wa104114212 wa104150553 wa104151288 wa104152457 wa104152459 wa104152461 wa104152463 wa104152465 wa104152467 wa104152469 wa104152471 wa104152876 wa104152878 wa104152880 wa104152882 wa104152884 wa104157773 wa104160363 wa104181413 wa104184267 wa104187975 wa104190317 wa104191381 wa104192851 wa104195705 wa104198124 wa104199815 wa104212571 wa104225427 wa104311014 wa104356783 wa104363180 wa104363616 wa104367607 wa104368114 wa104371266 wa104374243 wa104374368 wa104376997 wa104379036 wa104379039 wa104379040 wa104379121 wa104379169 wa104379190 wa104379193 wa104379231 wa104379279 wa104379471 wa104379481 wa104379498 wa104379502 wa104379518 wa104379533 wa104379534 wa104379558 wa104379572 wa104379601 wa104379629 wa104379638 wa104379640 wa104379673 wa104379710 wa104379714 wa104379716 wa104379751 wa104379790 wa104379804 wa104379806 wa104379830 wa104379842 wa104379850 wa104379852 wa104379857 wa104379861 wa104379873 wa104379912 wa104379941 wa104379942 wa104379951 wa104379952 wa104379955 wa104379999 wa104380006 wa104380081 wa104380084 wa104380090 wa104380099 wa104380100 wa104380101 wa104380110 wa104380123 wa104380126 wa104380142 wa104380186 wa104380211 wa104380256 wa104380257 wa104380263 wa104380274 wa104380281 wa104380330 wa104380379 wa104380386 wa104380392 wa104380393 wa104380415 wa104380479 wa104380548 wa104380590 wa104380711 wa104380801 wa104380839 wa104380848 wa104380862 wa104380871 wa104380961 wa104380977 wa104380991 wa104380992 wa104381030 wa104381039 wa104381071 wa104381080 wa104381100 wa104381177 wa104381207 wa104381208 wa104381227 wa104381270 wa104381350 wa104381500 wa104381504 wa104381514 wa104381516 wa104381558 wa104381567 wa104381587 wa104381641 wa104381695 wa104381701 wa104381705 wa104381761 wa104381821 wa104381856 wa104381859 wa104381885 wa104381893 wa104381955 wa104382017 wa104382019 wa104382048 wa104382054 wa200000004 wa200000025 wa200000075 wa200000113 wa200000125 wa200000142 wa200000176 wa200000190 wa200000193 wa200000209 wa200000310 wa200000387 wa200000388 wa200000541 wa200000775 wa200000934 wa200001032 wa200001086 wa200001383 wa200001387 wa200001565 wa200001627 wa200001657 wa200001672 wa200001685 wa200001709 wa200001788 wa200001789 wa200001816 wa200001847 wa200001937 wa200001947 wa200001997 wa200002110 wa200002197 wa200002205 wa200002346 wa200002378 wa200002381 wa200002407 wa200002427 wa200002445 wa200002494 wa200002503 wa200002575 wa200002577 wa200002628 wa200002631 wa200002648 wa200002698 wa200002736 wa200002772 wa200002797 wa200002808 wa200002929 wa200002934 wa200003035 wa200003082 wa200003087 wa200003098 wa200003121 wa200003225 wa200003269 wa200003324 wa200003369 wa200003386 wa200003402 wa200003476 wa200003520 wa200003595 wa200003599 wa200003637 wa200003648 wa200003666 wa200003670 wa200003692 wa200003693 wa200003696 wa200003731 wa200003732 wa200003812 wa200003821 wa200003903 wa200003987 wa200003990 wa200004040 wa200004043 wa200004078 wa200004096 wa200004133 wa200004136 wa200004285 wa200004415 wa200004426 wa200004465 wa200004466 wa200004483 wa200004571 wa200004577 wa200004580 wa200004597 wa200004600 wa200004602 wa200004618 wa200004622 wa200004651 wa200004684 wa200004687 wa200004702 wa200004703 wa200004707 wa200004713 wa200004749 wa200004755 wa200004798 wa200004835 wa200004858 wa200004866 wa200004867 wa200004884 wa200004894 wa200004899 wa200004923 wa200004931 wa200004946 wa200004977 wa200004983 wa200004993 wa200005010 wa200005018 wa200005040 wa200005075 wa200005095 wa200005105 wa200005148 wa200005172 wa200005178 wa200005186 wa200005194 wa200005222 wa200005223 wa200005228 wa200005233 wa200005264 wa200005299 wa200005332 wa200005334 wa200005400 wa200005409 wa200005410 wa200005416 wa200005426 wa200005429 wa200005433 wa200005478 wa200005481 wa200005496 wa200005503 wa200005505 wa200005506 wa200005577 wa200005582 wa200005611 wa200005647 wa200005653 wa200005694 wa200005695 wa200005702 wa200005705 wa200005777 wa200005783 wa200005794 wa200005810 wa200005813 wa200005862 wa200005866 wa200005920 wa200005962 wa200006007 wa200006008 wa200006010 wa200006068 wa200006083 wa200006111 wa200006113 wa200006141 wa200006150 wa200006170 wa200006179 wa200006191 wa200006220 wa200006229 wa200006242".split(" "),
ja="wa104281577 wa104295828 wa104323558 wa104356783 wa104363477 wa104363616 wa104379193 wa104379231 wa104379264 wa104379474 wa104379481 wa104379673 wa104379714 wa104379772 wa104379790 wa104379804 wa104379806 wa104379830 wa104379852 wa104379951 wa104379987 wa104379997 wa104380121 wa104380181 wa104380256 wa104380274 wa104380278 wa104380375 wa104380510 wa104380781 wa104380844 wa104380848 wa104380862 wa104380871 wa104380907 wa104381025 wa104381029 wa104381139 wa104381331 wa104381335 wa104381350 wa104381526 wa104381558 wa104381814 wa104382059 wa104382064 wa200000113 wa200000125 wa200000410 wa200000724 wa200000729 wa200000745 wa200001086 wa200001661 wa200001937 wa200001943 wa200002185 wa200002197 wa200002274 wa200002329 wa200002388 wa200002433 wa200003233 wa200003251 wa200003520 wa200003574 wa200003599 wa200003602 wa200003619 wa200003666 wa200003732 wa200003821 wa200003903 wa200003912 wa200003915 wa200004040 wa200004465 wa200004497 wa200004551 wa200004578 wa200004648 wa200004675 wa200004677 wa200004764 wa200004771 wa200004784 wa200004798 wa200004858 wa200004984 wa200005030 wa200005040 wa200005159 wa200005220 wa200005264 wa200005359 wa200005373 wa200005496 wa200005503 wa200005542 wa200005559 wa200005566 wa200005628 wa200005638 wa200005653 wa200005694 wa200005793 wa200005801 wa200005812 wa200005921 wa200005928 wa200006046 wa200006179".split(" "),
va="wa103296784 wa103863850 wa104051163 wa104099688 wa104374368 wa104376108 wa104379279 wa104379345 wa104379572 wa104379601 wa104379640 wa104379673 wa104379714 wa104379752 wa104379764 wa104379772 wa104379790 wa104379806 wa104379821 wa104379852 wa104379860 wa104379861 wa104379874 wa104379931 wa104379944 wa104379951 wa104379984 wa104379987 wa104379988 wa104379997 wa104380006 wa104380094 wa104380099 wa104380121 wa104380140 wa104380256 wa104380274 wa104380278 wa104380284 wa104380302 wa104380375 wa104380500 wa104380677 wa104380778 wa104380788 wa104380802 wa104380829 wa104380844 wa104380848 wa104380862 wa104380914 wa104380941 wa104380973 wa104380974 wa104380976 wa104380992 wa104380997 wa104381005 wa104381029 wa104381062 wa104381232 wa104381269 wa104381302 wa104381321 wa104381328 wa104381335 wa104381350 wa104381408 wa104381439 wa104381471 wa104381519 wa104381603 wa104381612 wa104381648 wa104381658 wa104381684 wa104381739 wa104381769 wa104381774 wa104381821 wa104381860 wa104381904 wa104381905 wa104381923 wa104381926 wa104381963 wa104381967 wa104382059 wa104382081 wa104382089 wa200000011 wa200000030 wa200000031 wa200000040 wa200000048 wa200000086 wa200000113 wa200000125 wa200000137 wa200000149 wa200000156 wa200000171 wa200000194 wa200000204 wa200000310 wa200000398 wa200000410 wa200000540 wa200000680 wa200000729 wa200000741 wa200000776 wa200001000 wa200001042 wa200001066 wa200001086 wa200001169 wa200001177 wa200001298 wa200001361 wa200001482 wa200001491 wa200001524 wa200001547 wa200001629 wa200001806 wa200001937 wa200001943 wa200001998 wa200002029 wa200002125 wa200002172 wa200002197 wa200002237 wa200002291 wa200002296 wa200002420 wa200002424 wa200002442 wa200002476 wa200002477 wa200002492 wa200002500 wa200002573 wa200002609 wa200002643 wa200002654 wa200002694 wa200002730 wa200002864 wa200002866 wa200002910 wa200002912 wa200003026 wa200003128 wa200003143 wa200003144 wa200003275 wa200003334 wa200003416 wa200003418 wa200003500 wa200003520 wa200003523 wa200003543 wa200003553 wa200003554 wa200003574 wa200003578 wa200003590 wa200003599 wa200003623 wa200003626 wa200003634 wa200003648 wa200003654 wa200003666 wa200003702 wa200003732 wa200003773 wa200003812 wa200003817 wa200003821 wa200003829 wa200003846 wa200003871 wa200003901 wa200003902 wa200003903 wa200003912 wa200003915 wa200003947 wa200003951 wa200003962 wa200003975 wa200003988 wa200003994 wa200004002 wa200004010 wa200004011 wa200004014 wa200004040 wa200004044 wa200004046 wa200004097 wa200004098 wa200004104 wa200004111 wa200004131 wa200004178 wa200004195 wa200004216 wa200004316 wa200004382 wa200004420 wa200004424 wa200004427 wa200004448 wa200004466 wa200004471 wa200004475 wa200004510 wa200004535 wa200004537 wa200004547 wa200004567 wa200004591 wa200004606 wa200004623 wa200004635 wa200004685 wa200004696 wa200004702 wa200004713 wa200004753 wa200004786 wa200004819 wa200004845 wa200004858 wa200004865 wa200004872 wa200004923 wa200004942 wa200004996 wa200005040 wa200005041 wa200005063 wa200005082 wa200005097 wa200005114 wa200005154 wa200005177 wa200005191 wa200005208 wa200005248 wa200005260 wa200005264 wa200005279 wa200005283 wa200005298 wa200005302 wa200005321 wa200005323 wa200005327 wa200005328 wa200005332 wa200005339 wa200005347 wa200005351 wa200005357 wa200005373 wa200005377 wa200005414 wa200005444 wa200005451 wa200005458 wa200005496 wa200005503 wa200005567 wa200005644 wa200005653 wa200005694 wa200005736 wa200005779 wa200005804 wa200005826 wa200005849 wa200005869 wa200005874 wa200005896 wa200005903 wa200005957 wa200005973 wa200006057 wa200006060 wa200006081 wa200006093 wa200006108 wa200006135 wa200006164 wa200006167 wa200006179 wa200006209 wa200006213 wa200006240".split(" ");
var Ha=a(126),gb=a(121),Gb=a(174);class Mb{constructor(Fa,rb,$b){this.Mbf="appsource";this.primaryKey="f45d712d6617b7e2b2f1fb0fc9757fa1eb384d7f03f6740a1a474b3ccf95b5d8";this.YOg="99b3e3778ca726c8bd5b4b1b6aa137358f0902d731079ca80e28f79a25d3870a";this.Ba=Fa;this.yW=rb;this.Q0e=void 0===$b?"en":$b;this.w3c=this.jff();this.qE={}}eed(Fa,rb,$b,ec,pc){ec=void 0===ec?15:ec;pc=void 0===pc?!1:pc;var dd=new gb.QueryStringBuilder("search"),Ad={"api-version":"2023-01-01-preview",gallery:"AppSourceApps",productTypes:"Office365",
Market:"ALL",select:"UniqueProductId,DisplayName,LongSummary,SmallIconUri,Popularity"};Ad.applicableProducts=this.yW;Ad.Language=this.Q0e;Ad.searchQuery=Fa;Ad.top=ec.toString();this.Y4c("AppSource",Ad);for(const Bc in Ad)dd.Zi(Bc,Ad[Bc]);dd="https://catalogapi.azure.com/"+dd.toString();Ad={};Ad["X-API-Key"]=pc?this.YOg:this.primaryKey;Ad["X-ms-app"]=this.Mbf;const Jb=window.performance.now();this.executeRequest(dd,1,Ad,Bc=>{let Mc="Query Succeeded",ed=!0,Yc=0;const ab=[],jb=[];Bc=Bc.data.responseData;
try{var cc=JSON.parse(Bc);Yc=cc.totalCount;const Hc=cc.results;for(cc=0;cc<Hc.length;cc++){const Vc=Hc[cc],Tc={};Tc.solutionId=Vc.uniqueProductId.toLowerCase();Tc.displayName=Vc.displayName;Tc.description=Vc.longSummary;Tc.iconUrl=Vc.smallIconUri;Tc.assetId=Tc.solutionId;Tc.storeId="en-US";Tc.storeType="omex";Tc.assetStoreId="omex";ab.push(Tc);this.qE[Tc.solutionId]=Tc;jb.push(Vc.popularity)}}catch(Hc){Mc="Exception thrown from Json parse for responseData: "+Bc+". Exception: "+Hc,ed=!1}this.eab(0<
Fa.length,$b,"AppSource",ed,Mc,window.performance.now()-Jb,Yc,ab,jb);rb(ed,ab)},Bc=>{const Mc=[];this.eab(0<Fa.length,$b,"AppSource",!1,"Query Failed, httpStatus: "+Bc.data.Ze,window.performance.now()-Jb,0,Mc);pc||Bc.data.Ze!==Gb.a.MOe?rb(!1,Mc):this.eed(Fa,rb,$b,ec,!0)})}fed(Fa,rb,$b,ec){ec=void 0===ec?"":ec;var pc=void 0===pc?15:pc;const dd=new gb.QueryStringBuilder("api/addins/search"),Ad={apiversion:"1.0"};0<Fa.length&&(Ad.qu=Fa);0<ec.length&&(Ad.assetids=ec);Ad.client="WAC_"+this.yW;Ad.cv=z.AFrameworkApplication.buildVersion;
Ad.top=pc.toString();this.Y4c("OMEX",Ad);for(const Bc in Ad)dd.Zi(Bc,Ad[Bc]);ec="https://api.addins.omex.office.net/"+dd.toString();const Jb=window.performance.now();this.executeRequest(ec,1,null,Bc=>{let Mc="Query Succeeded",ed=!0,Yc=0;const ab=[];Bc=Bc.data.responseData;try{var jb=JSON.parse(Bc);Yc=jb.TotalCount;const cc=jb.Values;for(jb=0;jb<cc.length;jb++){const Hc=cc[jb],Vc={};Vc.solutionId=Hc.Id.toLowerCase();Vc.displayName=Hc.Title;Vc.description=Hc.ShortDescription;Vc.iconUrl=Hc.IconUrl;Vc.assetId=
Vc.solutionId;Vc.storeId="en-US";Vc.storeType="omex";Vc.assetStoreId="omex";Vc.version=Hc.Version;Vc.targetType=Hc.Shape-1;Vc.height=Hc.Height;Vc.width=Hc.Width;ab.push(Vc);this.qE[Vc.solutionId]=Vc}}catch(cc){Mc="Exception thrown from Json parse for responseData: "+Bc+". Exception: "+cc,ed=!1}this.eab(0<Fa.length,$b,"OMEX",ed,Mc,window.performance.now()-Jb,Yc,ab);rb(ed,ab)},Bc=>{const Mc=[];this.eab(0<Fa.length,$b,"OMEX",!1,"Query Failed, httpStatus: "+Bc.data.Ze,window.performance.now()-Jb,0,Mc);
rb(!1,Mc)})}D0(Fa){return this.qE[Fa.toLowerCase()]?this.qE[Fa.toLowerCase()]:null}executeRequest(Fa,rb,$b,ec,pc){return z.AFrameworkApplication.ye.rk(Fa,rb,null,void 0===$b?null:$b,!1,2,ec,pc,null,null,!1,null,5E3)}eab(Fa,rb,$b,ec,pc,dd,Ad,Jb,Bc){Fa={["hasSearchValue"]:null===Fa||void 0===Fa?void 0:Fa.toString(),["searchStartTime"]:null===rb||void 0===rb?void 0:rb.toString(),["apiSource"]:$b,["responseSuccess"]:null===ec||void 0===ec?void 0:ec.toString(),["responseInfo"]:pc,["timeElapsed"]:null===
dd||void 0===dd?void 0:dd.toString(),["totalCount"]:null===Ad||void 0===Ad?void 0:Ad.toString(),["solutionIds"]:Jb.map(Mc=>this.qlf(Mc)),["popularity"]:Bc?Bc:[]};y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Extensibility.Host.SearchApiMetrics",dataFields:w.a.Gw(Fa)}))}qlf(Fa){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Fa.solutionId,Fa.storeType,Fa.assetId,null,null,Fa.storeId)}jff(){let Fa=this.Ba.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableSearchQueryParameters",
"");if(1>=Fa.length)return{};l.ULS.sendTraceTag(507785891,220,50,"BuildSearchQueryParametersOverrides: overrideString: {0}.",Fa);const rb={};let $b=!0,ec="";Fa=Fa.trim();try{const pc=Fa.split("$");for(let dd=0;dd<pc.length&&$b;dd++){const Ad=pc[dd].split(":");if(2!==Ad.length){ec="Invalid override string format: "+pc[dd];$b=!1;break}const Jb=Ad[0].trim(),Bc=[],Mc=Ad[1].split("|");for(let ed=0;ed<Mc.length&&$b;ed++){const Yc=Mc[ed],ab=Yc.split("\\");if(2<ab.length){ec="Invalid override string format: "+
Yc;$b=!1;break}const jb=ab[0].trim(),cc=2===ab.length?ab[1].trim():null;Array.add(Bc,new Ha.a(jb,cc))}rb[Jb]=Bc}}catch(pc){ec="Failed in parsing the overrideString: "+Fa+". Exception: "+pc.toString(),$b=!1}if($b)return rb;l.ULS.sendTraceTag(507785890,220,10,"Build override failed: {0}.",ec);return{}}Y4c(Fa,rb){if(this.w3c[Fa]){Fa=this.w3c[Fa];for(let $b=0;$b<Fa.length;$b++){const ec=Fa[$b].key,pc=Fa[$b].value;pc?rb[ec]=pc:delete rb[ec]}}}}Object(x.a)(Mb,"AddinSearchApiManager",null,[]);class hb{constructor(Fa){this.Ba=
Fa}get host(){var Fa;const rb=null===(Fa=this.Ba)||void 0===Fa?void 0:Fa.La("Application");return"Word"===rb||"Excel"===rb||"PowerPoint"===rb?rb:""}get i0(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutContentExpEnabled",!1)}get VJb(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutContentExpandExpEnabled",!1)}get Kaf(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutOpenCloseTelemetryEnabled",
!1)}get TJb(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinCategoryDescriptionExpEnabled",!1)}get Q4c(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchApiRuntimeTestEnabled",!1)}get WJb(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchApiEnabled",!1)}get N4c(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinContextMenuShareButtonEnabled",
!1)}get OAg(){return this.Ba?this.Ba.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableCategoryAddinIdsMapping",""):""}get PAg(){return this.Ba?this.Ba.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableCategoryAddinNumbers",""):""}get I5b(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SeeMoreSeeLessEnabled",!1)}get UJb(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutBlogExpEnabled",!1)}get NHa(){return!!this.Ba&&
this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)}}Object(x.a)(hb,"AppsFlyoutGeneratorContext",null,[]);var Da=a(19),Bb=a(71),Za=a(508);class mb{constructor(Fa,rb){this.i7e=Fa;this.j7e=rb}aXf(){null==Za.a.instance.getItem("AddinEntryPointSurveyShowed")&&window.setTimeout(()=>{this.Z3c=Da.a.instance.Na("Common.ISystemInitiatedFeedback");null!=this.Z3c&&this.Z3c.execute(Fa=>{if(null==Za.a.instance.getItem("AddinEntryPointSurveyShowed")){var rb=this.PCf();
this.aAf()||rb&&(!rb||"hidden"!==rb.visibility)||(Fa.wwb(this.i7e,null),Za.a.instance.setItem("AddinEntryPointSurveyShowed","1"))}})},this.j7e)}PCf(){let Fa=null;try{const rb=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");rb&&(Fa=Bb.a.zt(rb.parentNode.parentNode.parentNode))}catch(rb){l.ULS.sendTraceTag(508343957,220,10,"AddinFlyout get parent and parent get exception "+(rb?rb.toString():""))}return Fa}aAf(){let Fa=null;try{Fa=document.getElementById("BackstageGetAddIns")}catch(rb){l.ULS.sendTraceTag(508343956,
220,10,"Backstage get parent and parent get exception "+(rb?rb.toString():""))}return Fa}}Object(x.a)(mb,"FpsHelper",null,[]);class vb{constructor(Fa){this.oHa=Fa}next(Fa){this.oHa=(9301*this.oHa+49297)%233280;return Math.floor(this.oHa/233280*Fa)}}Object(x.a)(vb,"Random",null,[]);var sb=a(460);class bc{constructor(){this.c_=Fa=>{var rb;if(null===Fa||null===Fa.Sb)return!1;Fa=Fa.Sb.target;for(this.wOb=void 0;null!=Fa&&Fa.getAttribute;){void 0===this.wOb&&0<(null===(rb=Fa.id)||void 0===rb?void 0:rb.length)&&
(this.wOb=Fa.id);if(null!=Fa.getAttribute("data-contextmenu-id"))break;Fa=Fa.parentNode}return!1}}get currentTarget(){return this.wOb}LXf(){sb.a.instance.Zb(window.document.body,this.c_,null)}dispose(){sb.a.instance.jc(window.document.body,this.c_)}}Object(x.a)(bc,"AppFlyoutGeneratorContextMenuListener",null,[]);class yb{constructor(Fa,rb,$b,ec,pc,dd,Ad,Jb,Bc,Mc){Jb=void 0===Jb?{}:Jb;Bc=void 0===Bc?null:Bc;this.PFb={};this.S8a={};this.K2c=this.W2c=0;this.T2c=null;this.MXe=3E4;this.TI={};this.QFa=
{};this.RFa=[];this.IFa={};this.Bda=void 0;this.A2c=this.JFa=null;this.cia=(ed,Yc)=>{this.UQ?this.pJg(Yc):(this.nJg(Yc),!this.nRa&&this.n2c&&this.n2c.cia(ed,Yc))};this.z_=rb;this.Y_=null;this.s1e=ec;this.R5e=pc;this.n2c=void 0===Ad?null:Ad;this.Ba=(void 0===dd?null:dd)||z.AFrameworkApplication.ga;this.yk=new hb(this.Ba);this.EZe=Mc;this.yk.i0&&(this.TI=Jb,this.kcf(),this.ecf(),this.RFa=this.ONf());this.yk.UJb&&(this.fEb=Bc||[]);this.z_.ybb(this.cia);(null===appChrome||void 0===appChrome?0:appChrome.addInApi)&&
appChrome.addInApi.loadOfficeAddInIcons();this.yk.UJb&&c("AddinBlogSection",'\n    #AddinBlogListItem0Item {\n      box-shadow: 0 0 1px rgba(0,0,0,.1), 0 2px 3px rgba(0,0,0,.2);\n      border: 1px solid rgba(221,221,221,.1);\n      border-radius: 6px;\n    }\n\n    #AddinBlogListItem0Item div[class^="description"] {\n      white-space: normal;\n    }\n\n    #AddinBlogListItem0Item span {\n      font-size: 14px;\n    }\n\n    #AddinBlogListItem0Item a {\n      font-weight: 600;\n    }\n\n    #AddinBlogListItem0Item [data-icon-name="SparkleWord_20"] {\n      border: none;\n    }\n\n    #AddinBlogListItem0Item [data-icon-name="SparkleWord_20"] path {\n      fill: darkorange;\n    }\n  ');
this.yk.Kaf&&u((ed,Yc)=>{var ab=y.a,jb=ab.sendTelemetryEvent;ed={name:"Office.Extensibility.Host.AddInFlyoutOpenCloseChanged",dataFields:w.a.Sjk({["PerformanceNow"]:performance.now(),["DateNow"]:new Date,["IsOpened"]:ed,["OpenDuration"]:Yc})};ed=Object.assign(new A.a,ed);jb.call(ab,ed)}).catch(ed=>{l.ULS.sendTraceTag(507799683,220,15,"Failed to listen flyout open close event: "+((null===ed||void 0===ed?void 0:ed.toString())||void 0))});if(this.yk.Q4c||this.yk.WJb)this.JFa=new Mb(this.Ba,this.Ba.La("Application"));
this.yk.N4c&&(this.A2c=new bc,this.A2c.LXf());this.yk.NHa&&this.wQg()}get X5c(){return this.S8a}nJg(Fa){if(Fa.qp)for(let rb=0;rb<Fa.qp.length;rb++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+Fa.qp[rb].solutionId,Fa.qp[rb].iconUrl);else 0===Fa.errorCode&&l.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get UQ(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8332954_FlyoutNotifyObserverFailuresEnabled")&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",
!1)}get Mta(){return!!this.Ba&&this.Ba.isChangeGateEnabled("StoreDisabledErrorViewFixEnabled")}get nRa(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}I5c(){if(this.Rvd)return!0;let Fa=this.z_.sC(0);if(1!==Fa.errorCode)return!0;Fa=this.z_.sC(1);return 1!==Fa.errorCode}GCg(Fa,rb){const $b=[];rb=new vb(rb);for(var ec=0;30>ec;ec++)Array.add($b,rb.next(Fa.count));rb=0;for(const pc of Fa){ec=!1;for(const dd of $b)if(rb===dd){ec=!0;break}rb++;
if(ec){let dd;(dd=pc.addinInfo).AUP=20*dd.AUP}else if(1===pc.addinInfo.priority){let dd;(dd=pc.addinInfo).AUP=4*dd.AUP}else if(2===pc.addinInfo.priority){let dd;(dd=pc.addinInfo).AUP=2*dd.AUP}}Fa.Sc((pc,dd)=>pc.addinInfo.AUP<dd.addinInfo.AUP?1:-1);return Fa}NPb(Fa){const rb=this.yk.I5b,$b=rb?"more"===Fa?"AddinFlyoutMoreButton":"AddinFlyoutLessButton":"AddinFlyoutMoreButton",ec=rb?"more"===Fa?Object(B.a)("AddinsFlyoutSeeAllButtonText"):Object(B.a)("AddinsFlyoutSeeLessButtonText"):Object(B.a)("AddinsFlyoutSeeAllButtonText");
Fa=rb?"more"===Fa?Object(B.a)("AddinsPickerGalleryButtonMoreArialText"):Object(B.a)("AddinsPickerGalleryButtonLessArialText"):Object(B.a)("AddinsPickerGalleryButtonMoreArialText");return Object.assign(new Y.a,{Id:$b,ExternalId:$b,Icon:"AllApps_16",Command:this.R5e,LabelText:ec,FullIconStyle:{root:{maxWidth:"16px",maxHeight:"16px",minWidth:"16px",minHeight:"16px",border:"1px solid var(--border-color, #c8c8c8)",borderRadius:"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Role:"menuitem",Alt:Fa})}uEf(Fa,
rb){var $b=void 0===$b?z.AFrameworkApplication.isRtl:$b;$b={["root"]:{["width"]:"32px",["height"]:"32px",["border-radius"]:"6px",["overflow"]:"hidden",["padding"]:"7px",["border"]:"1px solid var(--border-color, #c8c8c8)",["direction"]:$b?"ltr":void 0}};return Object.assign(new Y.a,{Id:rb,ExternalId:rb,Icon:"AddinFlyoutControl"+Fa.solutionId,Command:this.s1e,LabelText:Fa.displayName,Role:"menuitem",FullIconStyle:$b,Alt:Fa.description})}j8c(Fa,rb,$b,ec){ec=void 0===ec?this.yk.I5b:ec;var pc=void 0===
pc?3:pc;const dd=Object.assign(new V.a,{SectionId:Fa+"Section",GalleryButtons:rb.map(Ad=>this.uEf(Ad,this.PFb[Ad.solutionId]))});ec&&3<rb.length?dd.Collapse=new P(2,this.NPb("more"),this.NPb("less")):$b&&dd.GalleryButtons.push(this.NPb("more"));return Object.assign(new K.a,{Id:Fa,ExternalId:Fa,GalleryStyle:this.APb(),Width:pc,Type:4,GallerySections:[dd],GalleryContextMenu:this.yk&&this.yk.N4c?{["primaryMenuId"]:"AddInFlyoutMRUContextMenu"}:null})}AEf(Fa){Fa=void 0===Fa?"":Fa;var rb;const $b=[],ec=
[],pc=this.z_.sC(0);Array.addRange(ec,pc.qp);const dd=this.z_.sC(1);var Ad=!1;this.yk.i0&&this.TI.PAIYO||(Ad=!0);Ad&&Array.addRange(ec,dd.qp);var Jb=this.yk.NHa&&!!Fa;Jb||ec.sort((Lb,Rc)=>{Lb=I.d(Lb.displayName);Rc=I.d(Rc.displayName);return ba.a.localeCompare(Lb,Rc)});this.Laf&&(null===(rb=this.EZe)||void 0===rb?void 0:rb.v$e(ec));var Bc=ec.length,Mc=!1;!this.yk.I5b&&3<Bc&&(Bc=2,Mc=!0);for(rb=0;rb<Bc;rb++)this.MKb(ec[rb]);let ed=[],Yc=rb=null;this.Mta||this.UQ||!this.Y_?(rb=this.z_.sC(2),0!==rb.errorCode&&
5!==rb.errorCode||rb.qp.forEach(Lb=>{-1!==Lb.addinInfo.priority&&(this.MKb(Lb),ed.push(Lb))})):ed=this.Y_;l.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}, popularAddins: {5}|{6}",Bc,Oa.a[pc.errorCode],pc.qp.length,Oa.a[dd.errorCode],dd.qp.length,this.Mta?Oa.a[rb.errorCode]:"undefined",ed.length);z.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:8365528_FlyoutAddinEntryPointDisplayMetrics")&&this.lJ.i$c(Bc,pc,dd,rb);let ab=!0;if(this.yk.i0||
!ed.length||Jb)ab=!1;ab&&(ed=this.UQ?this.fIf(ed,ec,30):this.Z4c(ed,ec));if(this.yk.i0&&!Jb){this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1)&&(this.T2c=new mb("AddinFlyoutFeedbackSurvey",this.Ba.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutSurveyTriggerTime",this.MXe)),this.T2c.aXf());var jb=this.zAf();if(jb&&0<Object.keys(jb).length){Yc={};for(var cc in jb){var Hc=jb[cc];Hc&&0<Hc.length&&(Yc[cc]=ec&&0!==ec.length&&"PAIYO"!==cc?Hc.filter(Rc=>!ec.some(md=>
md.solutionId.toLowerCase()===Rc.solutionId.toLowerCase())):Hc)}const Lb=[];for(var Vc in Yc)if((cc=Yc[Vc])&&0<cc.length){cc=cc.filter(Rc=>!Lb.some(md=>md.toLowerCase()===Rc.solutionId.toLowerCase()));for(jb=0;jb<cc.length&&jb<this.R7c(Vc);jb++)Lb.push(cc[jb].solutionId);Yc[Vc]=cc}}else l.ULS.sendTraceTag(507892616,220,15,"Category addins details dict is empty")}cc=[];jb=[];Jb&&(ed=this.Z4c(ed,ec),Array.addRange(cc,this.j7c(Fa,ec)),Array.addRange(jb,this.j7c(Fa,ed)),cc.forEach(Lb=>this.MKb(Lb)));
this.yk.Q4c&&(Vc=(new Date).getTime(),this.JFa.eed(Fa,()=>{},Vc),this.JFa.fed(Fa,()=>{},Vc));Hc=Object.assign(new ha.a,{Id:"HeaderSection",ControlsId:"HeaderSection.Controls",ControlList:[]});Vc=Object.assign(new ha.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});const Tc=Object.assign(new W.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:Object(B.a)("AddinsPickerFooterButtonMoreArialText")});Array.add(Vc.ControlList,Tc);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",
Object(B.a)("AddinPickerButtonMore")));Vc=Object.assign(new Ta.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuHeaderSection:this.yk.NHa?Hc:void 0,MenuFooterSection:Vc,UpdateDynamically:!0,IsFlexLayout:!0});if((2===pc.errorCode||this.Mta&&2===rb.errorCode)&&!ec.length){$b.push("storeDisabled");l.ULS.sendTraceTag(509687427,220,10,"dataProvider storeDisabled error hit");O.a.BI("50i82554;b1g2j634");var cd=this.e$a({iconName:"StoreDisabled",Nsa:Object(B.a)("AddinPickerDisableError")});Array.add(Vc.MenuSectionList,
cd)}else if(3!==pc.errorCode||this.lJ.Ved(pc)||3!==dd.errorCode)if(4!==pc.errorCode||ec.length)if(this.yk.NHa&&Array.add(Hc.ControlList,this.Hzf(Fa)),Jb)0>=cc.length&&0>=jb.length?(cd=this.e$a({iconName:"NoSearchResults",Nsa:Object(B.a)("AddInSearchNoResultsHint")}),Array.add(Vc.MenuSectionList,cd),n("FlyoutSearchResultsAriaText","SearchAddinInFlyout",String.format(Object(B.a)("AddInSearchNoResultsAriaText"),Fa))):(cd={},cd.MRUAddins=cc.map(Lb=>m(Lb)),cd.PopularAddins=jb.map(Lb=>m(Lb)),y.a.sendTelemetryEvent(Object.assign(new A.a,
{name:"Office.Extensibility.Host.SearchingAddinsFromFlyout",dataFields:w.a.Gw(cd)})),n("FlyoutSearchResultsAriaText","SearchAddinInFlyout",String.format(Object(B.a)("AddInSearchResultsAriaText"),Fa))),0<cc.length&&this.Tmf(Vc,cc),0<jb.length&&this.mnf(Vc,jb);else{this.yk.NHa&&n("FlyoutSearchResultsAriaText","SearchAddinInFlyout");0<Bc&&(Vc.MenuSectionList.push(this.vEf(ec.slice(0,Bc),Mc)),z.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",
!0)&&Ad&&(Fa={["solutionIds"]:dd.qp.map(Lb=>m(Lb))},y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Extensibility.Host.ShowAdminAddinFromFlyout",dataFields:w.a.Gw(Fa)}))));this.yk.UJb&&this.fEb&&0<this.fEb.length&&Array.add(Vc.MenuSectionList,this.zzf(this.fEb));if(this.yk.i0&&Yc&&0<Object.keys(Yc).length){Fa=[];Ad=Vc.MenuSectionList.length;for(cd in Yc)(Jb=Yc[cd])&&0<Jb.length&&(Bc=this.T7c(cd),Mc=this.S7c(cd),Fa.push(Mc),Mc=this.R7c(cd),Array.add(Vc.MenuSectionList,this.Pzf(Jb,Jb.length>
Mc?Mc:Jb.length,Bc,cd)));this.yk.TJb&&(e(Fa,Ad),h(Object.keys(Yc).map(Lb=>[this.T7c(Lb),this.S7c(Lb)])))}ab&&(this.K2c=30<ed.length?30:ed.length,Array.add(Vc.MenuSectionList,this.Fzf(ed,this.K2c,0)))}else $b.push("serviceDisabled"),l.ULS.sendTraceTag(508598107,220,10,"dataProvider serviceDisabled error hit"),cd=this.e$a({iconName:"StoreDisabled",Nsa:Object(B.a)("AddinPickerServiceDisconnectedError")}),Array.add(Vc.MenuSectionList,cd);else $b.push(this.lJ.i8c(pc,dd)),l.ULS.sendTraceTag(509687426,220,
10,"dataProvider invokeFailure error hit"),cd=this.e$a({iconName:"Common",Nsa:Object(B.a)("AddinPickerGeneralError")}),Array.add(Vc.MenuSectionList,cd);this.yk.i0&&Vc.MenuSectionList.every(Lb=>"ErrorSection"!==Lb.Id)&&(cd=Vc.MenuSectionList.some(Lb=>"MRUAddinsSection"===Lb.Id),c("CategoryTitleEnhanced",this.yk.VJb?'[id="InsertAddInFlyoutMenuId"] button[aria-haspopup="true"], [id="Ribbon-InsertAddInFlyoutDropdown"] button[aria-haspopup="true"] {font-size: 12px;\n  font-weight: 700;\n  padding: 0px 12px 0px 18px;\n  height: 28px;\n  line-height: 28px;}':
cd?'[id="Ribbon-InsertAddInFlyoutDropdown"] div[role="group"]>ul>li:nth-child(1)>div:not(#Ribbon-InsertAddInFlyoutDropdownsection-0-title) {font-weight: 700; padding-left: 12px;}\n      [id="InsertAddInFlyoutMenuId"] div[role="group"]>ul>li:nth-child(1)>div:not(#Ribbon-InsertAddInFlyoutDropdownsection-0-title) {font-weight: 700; padding-left: 12px;}':'[id="Ribbon-InsertAddInFlyoutDropdown"] div[role="group"]>ul>li:nth-child(1)>div {font-weight: 700; padding-left: 12px;}\n      [id="InsertAddInFlyoutMenuId"] div[role="group"]>ul>li:nth-child(1)>div {font-weight: 700; padding-left: 12px;}'),
this.yk.VJb&&b());this.Bif();0===Vc.MenuSectionList.length&&(Vc.IsFlexLayout=!1,$b.push("emptyMenuSection"),l.ULS.sendTraceTag(508340124,220,15,"The menu section list length is 0"));this.lJ.nfd&&l.ULS.sendTraceTag(508047442,220,15,`${$b.join("|")}`);this.lJ.g$c&&this.lJ.h$c(ec.length,$b,pc,dd,rb);return Vc}Bif(){window.setTimeout(()=>{var Fa=document.querySelector('#Ribbon-InsertAddInFlyoutDropdown > .ms-FocusZone > div[class^="root"] > div[class^="container"]');Fa&&(Fa=Fa.scrollTop,0<Fa&&(Fa={["scrollTopValue"]:Fa.toString()},
y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Extensibility.Host.ScrollableListView",dataFields:w.a.Gw(Fa)}))))},6E4)}zzf(Fa){const rb=Object.assign(new ha.a,{Id:"AddinBlogListSection",ControlsId:"AddinBlogListSection.Controls",ControlList:[]});for(let $b=0;$b<Fa.length;$b++){const ec=Fa[$b];ec.title&&0<ec.title.length&&rb.ControlList.push(this.yzf("AddinBlogListItem",$b.toString(),Fa[$b]))}return rb}yzf(Fa,rb,$b){const ec={default:$b.iconUrl},pc=[],dd=Object.assign(new ta,{text:Object(B.a)("LearnMore"),
href:$b.blogUrl});Array.add(pc,dd);return Object.assign(new qa.a,{Id:Fa+rb,ExternalId:Fa+rb,CommandId:Fa+rb,CommandIdMapped:U.a.lZh.toString(),CommandValueId:$b.id,iconSet:ec,Label:$b.title,SecondaryLabel:null,Description:$b.description,Links:pc,Details:null,ActionText:null,ActionId:null,ActionIdMapped:null,ActionCommandValueId:null})}Fzf(Fa,rb,$b){const ec=Object.assign(new ha.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:Object(B.a)("PopularAddins")});
for(let pc=$b;pc<$b+rb&&pc<Fa.length;pc++)ec.ControlList.push(this.f$a("PopularAddInsListItem",pc.toString(),Fa[pc]));z.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&(Fa={["solutionIds"]:Fa.slice($b,$b+rb).map(pc=>m(pc))},y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Extensibility.Host.ShowPopularAddinFromFlyout",dataFields:w.a.Gw(Fa)})));return ec}kcf(){const Fa={};var rb=this.yk.OAg;if(!(1>=rb.length)){l.ULS.sendTraceTag(507892615,
220,50,"BuildCategoryAddinDetailOverrides: overrideString: {0}.",rb);var $b=!0,ec="";rb=rb.trim();try{const pc=rb.split("$");for(let dd=0;dd<pc.length&&$b;dd++){const Ad=pc[dd].split(":");if(2<Ad.length){ec="Invalid override string format: "+pc[dd];$b=!1;break}const Jb=Ad[0].trim(),Bc=[];if(2===Ad.length){const Mc=Ad[1].split("|");for(let ed=0;ed<Mc.length&&$b;ed++){const Yc=Mc[ed],ab=Yc.split("\\");if(2>ab.length||5<ab.length){ec="Invalid override string format: "+Yc;$b=!1;break}const jb=ab[0].trim(),
cc={};for(let Hc=1;Hc<ab.length&&$b;Hc++)if(0<ab[Hc].trim().length)switch(Hc){case 1:cc.priority=parseInt(ab[Hc].trim());break;case 2:cc.AUP=parseInt(ab[Hc].trim());break;case 3:cc.diffAUP=parseInt(ab[Hc].trim());break;case 4:const Vc=ab[Hc].trim();if(8!==Vc.length){ec="Invalid override string format: "+Vc;$b=!1;break}cc.releaseDate=(new Date(parseInt(Vc.substring(0,4)),parseInt(Vc.substring(4,6))-1,parseInt(Vc.substring(6)))).getTime();break;default:ec="Invalid override string format: "+Yc,$b=!1}if(!$b)break;
Array.add(Bc,{solutionId:jb,addinInfo:cc})}}this.TI[Jb]&&(Fa[Jb]=Bc)}}catch(pc){ec="Failed in parsing the overrideString: "+rb+". Exception: "+pc.toString(),$b=!1}if($b){for(const pc in Fa){if(!this.TI[pc])continue;const dd=Fa[pc];rb=this.TI[pc].filter(Ad=>!dd.some(Jb=>Jb.solutionId.toLowerCase()===Ad.solutionId.toLowerCase()));Array.addRange(dd,rb)}this.TI=Fa}else l.ULS.sendTraceTag(507892614,220,10,"Override Failed: {0}.",ec)}}ecf(){for(const Fa in this.TI){const rb=this.TI[Fa];for(let $b=0;$b<
rb.length;$b++){const ec=rb[$b];ec.addinInfo||(ec.addinInfo={});if(!ec.addinInfo.priority||isNaN(ec.addinInfo.priority))ec.addinInfo.priority=0;if(!ec.addinInfo.AUP||isNaN(ec.addinInfo.AUP))ec.addinInfo.AUP=0;if(!ec.addinInfo.diffAUP||isNaN(ec.addinInfo.diffAUP))ec.addinInfo.diffAUP=0;if(!ec.addinInfo.releaseDate||isNaN(ec.addinInfo.releaseDate))ec.addinInfo.releaseDate=0}}}zAf(){if(!this.TI||0===Object.keys(this.TI).length)return l.ULS.sendTraceTag(507892613,220,15,"The category add-in ids mapping is empty."),
{};if(Object.keys(this.QFa).length!==Object.keys(this.TI).length){const rb=[],$b={};for(const ec in this.TI){if("PAIYO"===ec){var Fa=this.z_.sC(1);0===Fa.errorCode&&(Fa=Fa.qp)&&0<Fa.length&&($b[ec]=Fa);continue}if(this.QFa[ec]){$b[ec]=this.QFa[ec];continue}Fa=this.TI[ec];if(!Fa||0===Fa.length){l.ULS.sendTraceTag(507892612,220,15,"The addin content list is empty for category: {0}.",ec);continue}const pc=[];for(let dd=0;dd<Fa.length;dd++){const Ad=Fa[dd],Jb=this.z_.D0(Ad.solutionId);if(!Ad.addinInfo||
-1===Ad.addinInfo.priority||!Jb||-1===Jb.addinInfo.priority)continue;if(!Jb){Array.add(rb,Ad.solutionId);continue}const Bc={};Bc.solutionId=Jb.solutionId;Bc.version=Jb.version;Bc.storeType=Jb.storeType;Bc.storeId=Jb.storeId;Bc.assetId=Jb.assetId;Bc.assetStoreId=Jb.assetStoreId;Bc.displayName=Jb.displayName;Bc.provider=Jb.provider;Bc.description=Jb.description;Bc.targetType=Jb.targetType;Bc.height=Jb.height;Bc.width=Jb.width;Bc.iconUrl=Jb.iconUrl;Bc.webApplicationId=Jb.webApplicationId;Bc.highResolutionIconUrl=
Jb.highResolutionIconUrl;Bc.addinInfo=Ad.addinInfo;Array.add(pc,Bc)}0<pc.length&&("WN"===ec?pc.sort((dd,Ad)=>dd.addinInfo.releaseDate<Ad.addinInfo.releaseDate?1:-1):"TD"===ec?pc.sort((dd,Ad)=>dd.addinInfo.diffAUP<Ad.addinInfo.diffAUP?1:-1):pc.sort((dd,Ad)=>dd.addinInfo.AUP<Ad.addinInfo.AUP?1:-1),$b[ec]=pc)}this.QFa=$b;0<rb.length&&l.ULS.sendTraceTag(507892611,220,10,"{0} AddinIds not found in mapping: {1}, collection length: {2}",rb.length,rb.toString())}return this.QFa}ONf(){let Fa=3,rb=3,$b=this.yk.PAg;
if(1<$b.length){l.ULS.sendTraceTag(507655563,220,50,"BuildCategoryAddinDetailOverrides: overrideString: {0}.",$b);let ec=!0,pc="";$b=$b.trim();const dd=$b.split("|");if(2!==dd.length)pc="Invalid override string format: "+$b,ec=!1;else try{if(Fa=parseInt(dd[0]),rb=parseInt(dd[1]),isNaN(Fa)||isNaN(rb))pc="Failed in parsing the overrideString: "+$b,ec=!1}catch(Ad){pc="Failed in parsing the overrideString: "+$b+". Exception: "+Ad.toString(),ec=!1}ec||(l.ULS.sendTraceTag(507655562,220,10,"Override Failed: {0}.",
pc),rb=Fa=3)}return[Fa,rb]}R7c(Fa){return this.RFa&&2===this.RFa.length?"TD"===Fa||"IPWAI"===Fa?this.RFa[0]:this.RFa[1]:3}Pzf(Fa,rb,$b,ec){var pc=this.yk.VJb&&Fa.length>rb;const dd=Object.assign(new ha.a,{Id:`${ec}CategoryAddinListSection`,ControlsId:`${ec}CategoryAddinListSection.Controls`,ControlList:Fa.slice(0,rb).map((Ad,Jb)=>this.f$a(`${ec}_CategoryAddinListItem`,Jb.toString(),Ad)),Title:pc?void 0:$b});pc&&(pc=Object.assign(new ha.a,{Id:`${ec}CategoryAddinListSectionExtra`,ControlsId:`${ec}CategoryAddinListSectionExtra.Controls`,
ControlList:Fa.slice(rb,Fa.length).map((Ad,Jb)=>this.f$a(`Extra_${ec}_CategoryAddinListItem`,(Jb+rb).toString(),Ad))}),$b=Object.assign(new M.a,{Id:`${ec}SubMenuAnchor`,ExternalId:`${ec}SubMenuAnchor`,LabelText:$b,Command:U.a.ZW.toString(),Menu:Object.assign(new Ta.a,{MenuSectionList:[pc],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:"",KeyTip:"",Alt:""}),dd.ControlList.unshift($b));Fa={["category"]:ec,["solutionIds"]:Fa.slice(0,rb).map(Ad=>m(Ad))};
y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Extensibility.Host.ShowCategoryAddinsFromFlyout",dataFields:w.a.Gw(Fa)}));return dd}T7c(Fa){var rb;const $b=this.yk.host;return this.yk.TJb?(null===(rb=v()[$b])||void 0===rb?void 0:rb[Fa])||v().shared[Fa]||H()[Fa]||H().default:H()[Fa]||H().default}S7c(Fa){var rb;const $b=this.yk.host;return(null===(rb=C()[$b])||void 0===rb?void 0:rb[Fa])||C().shared[Fa]||""}f$a(Fa,rb,$b){const ec={default:"AddinFlyoutControl"+$b.solutionId},pc=this.UJa($b),
dd=[],Ad=[],Jb=Object.assign(new ta,{text:Object(B.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+$b.solutionId});if(this.Jaf){const Bc=Object.assign(new fa,{text:Object(B.a)("AddInFreeLabel")}),Mc=$b.solutionId.toLowerCase();switch(this.yk.host){case "Word":va.includes(Mc)&&Array.add(dd,Bc);break;case "PowerPoint":ja.includes(Mc)&&Array.add(dd,Bc);break;case "Excel":Pa.includes(Mc)&&Array.add(dd,Bc)}Array.add(dd,Jb)}else Array.add(Ad,Jb);return Object.assign(new qa.a,
{Id:Fa+rb,ExternalId:Fa+rb,CommandId:Fa+rb,CommandIdMapped:U.a.EFe.toString(),iconSet:ec,SecondaryLabel:null,Details:dd,Label:$b.displayName,ActionText:Fa.includes("PAIYO_CategoryAddinListItem")?Object(B.a)("AddinListOpen"):Object(B.a)("AddinListAdd"),Description:this.yk.i0&&this.yk.TJb?"":$b.description,Links:Ad,ActionId:Fa+"Add"+rb,ActionIdMapped:U.a.uEe.toString(),ActionCommandValueId:pc,CommandValueId:pc})}UJa(Fa){return this.UQ?String.format("{0}#{1}",Fa.solutionId,Fa.storeId):Fa.solutionId}ZOb(Fa){if(!Fa)return null;
var rb=Fa.split("#");if(1!==rb.length&&2!==rb.length)return l.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;Fa=rb[0].trim();rb=2===rb.length?rb[1].trim():z.AFrameworkApplication.uiCulture;return this.z_.D0(Fa,rb)}rGf(Fa){return Fa?this.JFa.D0(Fa):null}J5c(Fa){return Fa&&Fa.hasOwnProperty("solutionId")&&Fa.hasOwnProperty("version")&&Fa.hasOwnProperty("storeType")&&Fa.hasOwnProperty("storeId")&&Fa.hasOwnProperty("assetId")&&Fa.hasOwnProperty("assetStoreId")&&
Fa.hasOwnProperty("targetType")&&Fa.hasOwnProperty("displayName")&&Fa.hasOwnProperty("width")&&Fa.hasOwnProperty("height")?!0:!1}Qxf(Fa){return new Promise((rb,$b)=>{if(this.J5c(Fa))return rb(Fa);this.JFa.fed("",(ec,pc)=>ec?1!==pc.length||pc[0].solutionId.toLowerCase()!==Fa.solutionId.toLowerCase()?$b(Error("The search add-in and result add-in don't match.")):this.J5c(pc[0])?rb(pc[0]):$b(Error("The result add-in details are still not ready for install.")):$b(Error("Failed to query add-in details for install.")),
(new Date).getTime(),Fa.solutionId)})}MKb(Fa){if(!(Fa.solutionId in this.PFb)){const rb="AddinGalleryButton"+this.W2c.toString();this.PFb[Fa.solutionId]=rb;Fa=this.UJa(Fa);this.S8a[rb]=Fa;this.S8a[rb+"Add"]=Fa;this.W2c++}}A8c(Fa){return Fa?this.S8a[Fa]:null}e$a(Fa){var {iconName:rb,Nsa:$b,o5l:ec=!1,r8l:pc=Object(B.a)("AddinPickerTryAgain"),q8l:dd="ReloadAddInPicker",tql:Ad="ReloadAddInPicker"}=Fa;Fa=Object.assign(new ha.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});let Jb=
null;Jb=$b===Object(B.a)("AddinPickerDisableError")&&z.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.addDocumentForStoreDisableErrorView",!1)?Object.assign(new L.a,{Id:"ErrorView",ExternalId:"ReloadAddInPickerStoreDisabled",IconName:rb,Label:$b,RetryButtonTitle:ec?Object(B.a)("AddinPickerTryAgain"):"",OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===rb?$b:Object(B.a)("AddinPickerTryAgainAriaLabel"),LinkText:Object(B.a)("AddinPickerDisableErrorDocumentText"),
LinkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",z.AFrameworkApplication.uiCulture),OnLinkClicked:()=>{l.ULS.sendTraceTag(507875925,220,15,"User has clicked link on add-in picker error view")}}):Object.assign(new L.a,{Id:"ErrorView",ExternalId:Ad,IconName:rb,Label:$b,RetryButtonTitle:ec?pc:"",OnRetryCommandId:dd,AriaDescription:"StoreDisabled"===
rb?$b:Object(B.a)("AddinPickerTryAgainAriaLabel")});Array.add(Fa.ControlList,Jb);return Fa}Z4c(Fa,rb){var $b=new N.a;for(let ec=0;ec<Fa.length;ec++)$b.add(Fa[ec]);if(this.Mta||!this.Y_)30<$b.count&&($b=this.GCg($b,(new Date).getDate())),this.Y_=$b.toArray();for(Fa=0;Fa<this.Y_.length;Fa++)for($b=0;$b<rb.length;$b++)if(this.Y_[Fa].solutionId.toLowerCase()===rb[$b].solutionId.toLowerCase()){Array.remove(this.Y_,this.Y_[Fa--]);break}return this.Y_}AFf(Fa,rb,$b){$b>Fa.length&&($b=Fa.length);var ec=new vb(rb);
for(rb=new Set;rb.size<$b;){const pc=ec.next(Fa.length);rb.add(pc)}for($b=0;$b<Fa.length;$b++)ec=Fa[$b].addinInfo,rb.has($b)?ec.AUP*=20:ec.AUP=1===ec.priority?4*ec.AUP:2===ec.priority?2*ec.AUP:1*ec.AUP;Fa.sort((pc,dd)=>pc.addinInfo.AUP<dd.addinInfo.AUP?1:-1);return Fa}fIf(Fa,rb,$b){Fa=Fa.filter(ec=>!rb.some(pc=>pc.solutionId.toLowerCase()===ec.solutionId.toLowerCase()));return this.AFf(Fa,(new Date).getDate(),$b).slice(0,$b)}pJg(Fa){if(0===Fa.errorCode||2===Fa.IZ&&5===Fa.errorCode)Fa.qp?this.oJg(Fa.qp):
l.ULS.sendTraceTag(509687429,220,10,`fail to register icons for addin collection: ${Ga.a[Fa.IZ]}`)}oJg(Fa){var rb,$b,ec,pc;for(let dd=0;dd<Fa.length;dd++)Fa[dd]&&Fa[dd].solutionId&&Fa[dd].iconUrl?appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+Fa[dd].solutionId,Fa[dd].iconUrl):l.ULS.sendTraceTag(508352214,220,10,"failed to register icon for addin: solutionId: {1}, iconUrl: {2}",null!==($b=null===(rb=Fa[dd])||void 0===rb?void 0:rb.solutionId)&&void 0!==$b?$b:"null",null!==(pc=null===(ec=
Fa[dd])||void 0===ec?void 0:ec.iconUrl)&&void 0!==pc?pc:"null")}APb(){return{["galleryStack"]:{["root"]:{margin:"0px",marginLeft:"12px",width:"100%",maxWidth:"unset"},["inner"]:{margin:"-4px",marginLeft:"18px",maxWidth:"333px",minWidth:"333px"}},["galleryButtonInExpanded"]:{["root"]:{width:100,height:100,backgroundColor:"transparent"},["flexContainer"]:{flexDirection:"column"},["label"]:{marginTop:"4px",maxWidth:"86px",fontSize:"12px",textOverflow:"ellipsis"}}}}vEf(Fa,rb){Fa=this.j8c("MRUAddinsGalleryControl",
Fa,rb);return Object.assign(new ha.a,{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[Fa],Title:Object(B.a)("MyAddinSection")})}Hzf(Fa){return Object.assign(new ra.a,{ExternalId:"SearchAddinInFlyout",Label:Object(B.a)("AddInSearchBoxPlaceholder"),ShowIcon:!0,Underlined:!0,Value:Fa,Styles:{root:{margin:"20px 18px 12px",selectors:{":hover .ms-SearchBox-iconContainer":{color:"var(--colorNeutralForeground1, #242424)"}}},clearButton:{display:"none"},iconContainer:{color:"var(--colorNeutralForeground1, #242424)",
transform:"rotateY(180deg)"}},OnChangeCommandId:"SearchAddinInFlyout"})}Tmf(Fa,rb){const $b=Object.assign(new ha.a,{Id:"MRUAddinsSearchResutlsSection",ControlsId:"MRUAddinsSearchResutlsSection.Controls",ControlList:[]});Array.add(Fa.MenuSectionList,$b);Fa=this.j8c("MRUAddinsSearchResutlsGalleryControl",rb,!1,!1);Array.add($b.ControlList,Fa)}mnf(Fa,rb){const $b=Object.assign(new ha.a,{Id:"PopularAddinsListSearchResutlsSection",ControlsId:"PopularAddinsSearchResutlsSection.Controls",ControlList:[],
Title:Object(B.a)("AddInSearchResultsDivider")});for(let ec=0;ec<rb.length;ec++)$b.ControlList.push(this.f$a("PopularAddinsSearchResutlsItem",ec.toString(),rb[ec]));Array.add(Fa.MenuSectionList,$b)}j7c(Fa,rb){const $b=Fa.toLocaleLowerCase();Fa=rb.filter(ec=>{this.IFa[ec.solutionId]||(this.IFa[ec.solutionId]=ec.displayName.toLocaleLowerCase());return this.IFa[ec.solutionId].includes($b)});Fa.sort((ec,pc)=>this.IFa[ec.solutionId].indexOf($b)-this.IFa[pc.solutionId].indexOf($b));return Fa}wQg(){let Fa;
u(rb=>{const $b=document.getElementById("Ribbon-InsertAddInFlyoutDropdown")||document.getElementById("InsertAddInFlyoutMenuId");$b&&rb&&(Fa=()=>{var ec;null===(ec=document.getElementById("SearchAddinInFlyout"))||void 0===ec?void 0:ec.focus();$b.removeEventListener("focus",Fa);Fa=void 0},$b.addEventListener("focus",Fa))})}t2b(Fa){if(Fa)try{Fa.MenuItems=this.AEf(Fa.SearchBoxValue||"")}catch(rb){l.ULS.sendTraceTag(509687425,220,10,`GetReactGalleryMenu hit exception ${rb.message}; stack: ${rb.stack}`)}else l.ULS.sendTraceTag(509687424,
220,10,"PopulateMenu menuProps is null")}dispose(){}get Rvd(){return"Dev Box"===z.AFrameworkApplication.ga.La("StatusBarEnvironmentNameToUse")}get Jaf(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFreeLabelExpEnabled",!1)}get lJ(){this.Bda||(this.Bda=new Qa("Flyout",this.Ba));return this.Bda}get Laf(){return!!this.Ba&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutRedDotExpEnabled",!1)}}Object(x.a)(yb,"AppsFlyoutGenerator",null,
[24]);var uc=a(232),vc=a(233);class wc{constructor(){this.addInDetails=this.title=null}}Object(x.a)(wc,"AddInCategoryData",null,[]);class ub{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(x.a)(ub,"AddInDetailData",null,[]);class aa{constructor(){this.href=this.text=null}}Object(x.a)(aa,"AddInLinkData",null,[]);var Na=a(332);class ia{constructor(Fa,rb,$b){this.xV=0;this.Z2c=!1;this.sHa=[];this.Bda=void 0;this.Ba=Fa;this.wV=rb;this.QHb=$b;l.ULS.sendTraceTag(508396508,
220,50,"AddInCategoryManager Initialized")}cia(Fa,rb){Fa&&rb&&this.LTg(rb)&&this.zcd()}LTg(Fa){0===Fa.IZ&&(this.xV|=1);1===Fa.IZ&&(this.xV|=2);2===Fa.IZ&&(this.xV|=4);return!!this.xV}zcd(){const Fa=[];let rb=null;const $b={},ec=this.aUf,pc=this.pug,dd=this.wV.sC(0),Ad=this.wV.sC(1),Jb=this.wV.sC(2);(2===dd.errorCode||this.Mta&&2===Jb.errorCode)&&!pc.length?(O.a.BI("50i82554;b1g2j634"),rb=this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.addDocumentForStoreDisableErrorView",!1)?{ariaDescription:Object(B.a)("AddinPickerDisableError"),
iconName:"StoreDisabled",label:Object(B.a)("AddinPickerDisableError"),title:Object(B.a)("AddInBackstageErrorViewTitle"),linkText:Object(B.a)("AddinPickerDisableErrorDocumentText"),linkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",z.AFrameworkApplication.uiCulture),onLinkClicked:()=>{l.ULS.sendTraceTag(507875924,220,15,"User has clicked link on add-in backstage error view")}}:
{ariaDescription:Object(B.a)("AddinPickerDisableError"),iconName:"StoreDisabled",label:Object(B.a)("AddinPickerDisableError"),title:Object(B.a)("AddInBackstageErrorViewTitle")},Fa.push("storeDisabled")):3!==dd.errorCode||this.lJ.Ved(dd)||3!==Ad.errorCode?4!==dd.errorCode||pc.length?!this.D9c&&(!this.UQ||0!==Jb.errorCode&&5!==Jb.errorCode)||Jb.qp.length||(l.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",this.xV,Jb.errorCode),
Fa.push("emptyCategory")):(rb={ariaDescription:Object(B.a)("AddinPickerServiceDisconnectedError"),iconName:"StoreDisabled",label:Object(B.a)("AddinPickerServiceDisconnectedError"),title:Object(B.a)("AddInBackstageErrorViewTitle")},Fa.push("serviceDisabled")):(rb={ariaDescription:Object(B.a)("AddinPickerGeneralError"),iconName:"Common",label:Object(B.a)("AddinPickerGeneralError"),title:Object(B.a)("AddInBackstageErrorViewTitle")},Fa.push(this.lJ.i8c(dd,Ad)));this.nRa&&this.lJ.i$c(pc.length,dd,Ad,Jb);
const Bc=!rb;!Bc||ec||pc.length?(Bc?($b.mruAddIns=pc,ec&&($b.categories=this.pDg)):$b.errorViewProps=rb,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData($b,Bc)),ec&&Bc&&!this.Z2c&&(this.Z2c=!0,l.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",this.xV))):Fa.push("emptyPage");this.nRa&&(this.lJ.nfd&&l.ULS.sendTraceTag(508047441,220,15,`${Fa.join("|")}`),this.lJ.g$c&&this.lJ.h$c(pc.length,Fa,dd,Ad,Jb))}get D9c(){return!!(this.xV&4)}get nRa(){return!!this.Ba&&
this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get aUf(){const Fa=this.wV.sC(2);return(this.D9c||this.UQ||this.nRa)&&(0===Fa.errorCode||5===Fa.errorCode)&&!!Fa.qp.length}get pDg(){var Fa=this.PBf();0<Fa.length&&(this.QHb=Fa);if(Na.b(this.QHb))return[];var rb=JSON.parse(this.QHb);Fa=[];for(var $b of rb)rb=Object.assign(new wc,{title:$b.title,addInDetails:[]}),this.Sef(rb,$b.solutionIds),0<rb.addInDetails.length&&Array.add(Fa,rb);0<this.sHa.length&&($b=
this.wV.sC(2),l.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",this.sHa.length,this.sHa,$b.qp.length),this.sHa=[]);return Fa}get pug(){var Fa=[],rb=this.wV.sC(0);Array.addRange(Fa,rb.qp);rb=this.wV.sC(1);Array.addRange(Fa,rb.qp);Fa.sort(($b,ec)=>{$b=I.d($b.displayName);ec=I.d(ec.displayName);return ba.a.localeCompare($b,ec)});rb=[];for(const $b of Fa)Fa=Object.assign(new ub,{description:$b.description,displayName:$b.displayName,solutionId:$b.solutionId,
uniqueId:this.UJa($b)}),Array.add(rb,Fa);return rb}Sef(Fa,rb){const $b=this.qug;let ec=0;for(const pc of rb){if(4===ec)break;if($b.contains(pc))continue;rb=this.wV.D0(pc);if(!rb){this.sHa.push(pc);continue}const dd=Object.assign(new ub,{description:rb.description,displayName:rb.displayName,solutionId:rb.solutionId,uniqueId:this.UJa(rb)});dd.links=[Object.assign(new aa,{text:Object(B.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+rb.solutionId})];Array.add(Fa.addInDetails,
dd);++ec}}get qug(){const Fa=[];var rb=this.wV.sC(0);Array.addRange(Fa,rb.qp);rb=this.wV.sC(1);Array.addRange(Fa,rb.qp);rb=new uc.a(vc.a.Wn());for(const $b of Fa)rb.add($b.solutionId);return rb}UJa(Fa){return this.UQ?String.format("{0}#{1}",Fa.solutionId,Fa.storeId):Fa.solutionId}get UQ(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8332954_FlyoutNotifyObserverFailuresEnabled")&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}PBf(){return this.Ba?
this.Ba.getStringFeatureGate("Microsoft.Office.SharedOnline.BackstageCustomizablePopularAddins",""):""}get Mta(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8362324_StoreDisabledErrorViewFixEnabled")}get lJ(){this.Bda||(this.Bda=new Qa("Backstage",this.Ba));return this.Bda}}Object(x.a)(ia,"AddInCategoryManager",null,[]);var wa=a(1342),pa=a(413),Ea=a(40),La=a(231),Aa=a(663),nb=a(259),Wa=a(288),ea=a(256);class Kb{constructor(){this.idField=null;this.stateField=0}}Object(x.a)(Kb,"CT_OsfBackgroundAppData",
null,[]);class kc{constructor(){this.currentStoreTypeField=this.bkgdDataField=this.assetStoreIdField=this.assetIdField=this.appVersionField=null;this.heightField=0;this.heightFieldSpecified=!1;this.idField=null;this.isAddinCommandsField=!1;this.storeIdField=null;this.widthField=this.targetTypeField=0;this.widthFieldSpecified=!1}}Object(x.a)(kc,"CT_OsfInsertionInfo",null,[]);var ac=a(269),eb=a(889),Hb=a(890),ua=a(568),Va=a(250),Yb=a(251),Cb=a(51);const ca={["TD"]:[],["WN"]:[]},Ra={["PAIYO"]:[],["BBM"]:[{solutionId:"wa200003233",
addinInfo:{AUP:143978}},{solutionId:"wa104381526",addinInfo:{AUP:50753}},{solutionId:"wa104295828",addinInfo:{AUP:8127}},{solutionId:"wa104380862",addinInfo:{AUP:459}}]},bb={["IPWAI"]:[{solutionId:"wa200003964",addinInfo:{AUP:2308}},{solutionId:"wa200005107",addinInfo:{AUP:786}},{solutionId:"wa200005669",addinInfo:{AUP:247}},{solutionId:"wa200006067",addinInfo:{AUP:148}},{solutionId:"wa200006000",addinInfo:{AUP:861}}],["APIC"]:[{solutionId:"wa104381155",addinInfo:{AUP:4724}},{solutionId:"wa104221182",
addinInfo:{AUP:3054}},{solutionId:"wa104178141",addinInfo:{AUP:2656}},{solutionId:"wa104381909",addinInfo:{AUP:2153}},{solutionId:"wa104380907",addinInfo:{AUP:1945}},{solutionId:"wa200000113",addinInfo:{AUP:1715}},{solutionId:"wa104380121",addinInfo:{AUP:1275}},{solutionId:"wa200000729",addinInfo:{AUP:1132}},{solutionId:"wa104379370",addinInfo:{AUP:688}},{solutionId:"wa104381411",addinInfo:{AUP:562}},{solutionId:"wa104381063",addinInfo:{AUP:515}},{solutionId:"wa104379997",addinInfo:{AUP:307}},{solutionId:"wa200003220",
addinInfo:{AUP:306}},{solutionId:"wa200003891",addinInfo:{AUP:293}},{solutionId:"wa200001766",addinInfo:{AUP:68}},{solutionId:"wa104380902",addinInfo:{AUP:280}},{solutionId:"wa104381637",addinInfo:{AUP:137}},,{solutionId:"wa104380848",addinInfo:{AUP:150}}],["CAIP"]:[{solutionId:"wa104379261",addinInfo:{AUP:13796}},{solutionId:"wa200000094",addinInfo:{AUP:6789}},{solutionId:"wa200001661",addinInfo:{AUP:6596}},{solutionId:"wa200002908",addinInfo:{AUP:2861}},{solutionId:"wa104381682",addinInfo:{AUP:2742}},
{solutionId:"wa104382064",addinInfo:{AUP:2671}},{solutionId:"wa104218073",addinInfo:{AUP:2577}},{solutionId:"wa200004709",addinInfo:{AUP:601}},{solutionId:"wa200004643",addinInfo:{AUP:517}},{solutionId:"wa200003676",addinInfo:{AUP:361}},{solutionId:"wa200001313",addinInfo:{AUP:219}},{solutionId:"wa104381448",addinInfo:{AUP:127}},{solutionId:"wa200003706",addinInfo:{AUP:122}},{solutionId:"wa104380667",addinInfo:{AUP:24}}],["DWT"]:[{solutionId:"wa200001625",addinInfo:{AUP:3193}},{solutionId:"wa104380526",
addinInfo:{AUP:1790}},{solutionId:"wa104380602",addinInfo:{AUP:1500}},{solutionId:"wa104380050",addinInfo:{AUP:1102}},{solutionId:"wa200002334",addinInfo:{AUP:869}},{solutionId:"wa200001409",addinInfo:{AUP:566}},{solutionId:"wa104380955",addinInfo:{AUP:341}},{solutionId:"wa104380278",addinInfo:{AUP:228}},{solutionId:"wa200003157",addinInfo:{AUP:222}},{solutionId:"wa200001396",addinInfo:{AUP:168}},{solutionId:"wa200006046",addinInfo:{AUP:71}},{solutionId:"wa200003052",addinInfo:{AUP:132}}]};class wb{constructor(Fa,
rb,$b,ec,pc,dd,Ad,Jb,Bc,Mc,ed,Yc,ab){this.Zsa=0;this.Ead=this.C$c=this.JXb=this.wad=this.had=!1;this.d_f="g_InstallOrigin";this.bbd=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAddIns","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"],["InsertMoreAddInsFromBackstageFooter","InsertMoreAddInsFromBackstageFooter"],["LaunchMyAddInsFromBackstage","BackstageSeeAll"]]);this.pgf=`[{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa104178141","wa104381909","wa104380907","wa200003233","wa104221182","wa104381411","wa104380121","wa104379997","wa104379370","wa104381063","wa104295828","wa200000113","wa200000729"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDesigningAnInteractivePresentation}","solutionIds":["wa104379261","wa200001661","wa200002908","wa104381526","wa200004709","wa200004643","wa104380667","wa104218073","wa104382064","wa104381682"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDesigningWithTemplates}","solutionIds":["wa104380050","wa200001396","wa200003964","wa200001625","wa200003157","wa200001409","wa200002334"]}]`;
this.J8c=()=>Va.a("DelayQueryAddinFlyoutRegister")&&this.xTa?this.UHa&&!this.Fb.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")&&this.Kv?32:8:this.UHa&&!this.Fb.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")&&this.Kv&&this.Kv.I5c()?32:8;this.CKf=(jb,cc,Hc,Vc,Tc)=>{if(2!==Hc)return this.Kv&&this.Kv.I5c()?32:8;if(!this.Kv)return 8;Va.a("ShowUserSegmentInformationEnabled")&&(jb={["UserSegment"]:this.pff()},cc=new A.a,cc.name="Office.Extensibility.Host.UserSegmentInformation",cc.dataFields=
w.a.Gw(jb),y.a.sendTelemetryEvent(cc));this.Kv.t2b(Tc);return 32};this.EPg=(jb,cc,Hc)=>{jb={["solutionId"]:wb.Jsa(cc.solutionId,cc.storeType,cc.assetId,cc.storeId),["href"]:jb,["UILocation"]:Hc};y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:w.a.Gw(jb)}))};this.jKf=(jb,cc,Hc,Vc,Tc)=>2!==Hc?32:Tc&&"LinkClickedPayload"===Tc.Type?((jb=this.I7c(Tc.CommandValueId))&&this.EPg(Tc.Href,jb,Tc.UILocation),32):this.G8c(jb,cc,Hc,Vc,Tc);
this.hKf=(jb,cc,Hc,Vc,Tc)=>{var cd;if(2!==Hc)return 32;if(this.WJb&&(null===(cd=Tc.SourceControlId)||void 0===cd?0:cd.startsWith("PopularAddinsSearchResutlsItemAdd")))return this.iKf(jb,Hc,Tc);if(cc=this.I7c(Tc.CommandValueId))this.F8c(jb,Tc,cc);else return l.ULS.sendTraceTag(509109065,344,10,"No add-in details."),8;return 32};this.F8c=(jb,cc,Hc)=>{const Vc={};Vc.solutionId=Hc.solutionId;Vc.version=Hc.version;Vc.storeType=Hc.storeType;Vc.storeId=Hc.storeId;Vc.assetId=Hc.assetId;Vc.assetStoreId=Hc.assetStoreId;
Vc.targetType=Hc.targetType;Vc.displayName=Hc.displayName;Vc.width=Hc.width;Vc.height=Hc.height;this.Tc.Occ("handleInsertAppForOffice",Vc);this.aRb(jb,Vc);jb={["solutionId"]:wb.Jsa(Hc.solutionId,Hc.storeType,Hc.assetId,Hc.storeId)};jb.UILocation=cc.UILocation;jb.ControlId=cc.SourceControlId;y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:w.a.Gw(jb)}))};this.kKf=(jb,cc,Hc,Vc,Tc)=>{var cd;if(!this.DP||!Tc)return 8;if(1===
Hc)return this.Tc?32:8;if(!this.Tc)return this.Zsa||(this.Zsa=window.performance.now()),this.Xy.eX(),this.Xy.dca(jb,Tc),8;jb=Tc[Aa.a.Hwa];cc=Tc[Aa.a.$pa];Hc=cc.optionalProperties;Tc={};Tc.JB=Hc.TaskPaneTitle;Tc.assetId=jb.getId();Tc.LU=Hc.OnRenderedCallback;Tc.nonPersistedSettings=cc.TDa;Tc.z6c=Hc.DialogIsModal;Tc.A6c=Hc.DialogShowTitleBar;Tc.dialogWidth=Hc.DialogWidth;Tc.dialogHeight=Hc.DialogHeight;Tc.dialogLeft=Hc.DialogLeft;Tc.osc=Hc.DialogRight;Tc.dialogTop=Hc.DialogTop;Tc.ksc=Hc.DialogBottom;
Tc.qca=null!==(cd=Hc.DialogTitle)&&void 0!==cd?cd:"";Tc.sourceLocationOverrideResourceId=Hc.SourceLocationOverrideResourceId;Tc.JBd=Hc.DialogParentId;Tc.msc=Hc.DialogCloseCallback;Tc.nsc=Hc.DialogResizeCallback;cd=this.Tc.VJa(Tc);if(cd=this.Tc.xT(cd))Tc.Kp=cd.Kp;this.Tc.aqk(Tc);return 32};this.SKf=(jb,cc,Hc,Vc,Tc)=>{if(2!==Hc)return 32;if(!this.Tc)return 8;cc=Tc[Aa.a.Hwa];Hc=Tc[Aa.a.$pa].optionalProperties;jb={};jb.JB=Hc.TaskPaneTitle;jb.assetId=cc.getId();jb.sourceLocationOverrideResourceId=Hc.SourceLocationOverrideResourceId;
jb.LU=Hc.l3k;jb.nonPersistedSettings=Hc.TDa;cc=this.Tc.VJa(jb);cc=this.Tc.xT(cc);Tc=Tc[Aa.a.ZLb];return cc&&"taskpane"==Tc.toLowerCase()?(this.Tc.Wzk(cc.Kp,jb),32):8};this.lKf=(jb,cc,Hc,Vc,Tc)=>{var cd;if(2!==Hc)return 32;if(!this.Kv)return 8;cc=Vc=void 0;Hc=Tc.SourceControlId;if(this.Kv.UQ){const Lb=this.Kv.ZOb(this.Kv.A8c(Hc));null!=Lb&&(Vc=Lb.solutionId,cc=Lb.storeId)}else Vc=(Vc=Tc.CommandValueId)?Vc:this.jab.X5c[Hc];if(!Vc)return l.ULS.sendTraceTag(509383066,220,10,"SourceControlId (solutionId) is empty in handleLaunchUserInstalledAddIn"),
8;this.Tc?(jb=Tc.SqmControlId,this.Tc.Csj(Vc,cc,Tc.UILocation,null!==jb&&void 0!==jb?jb:Hc),z.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutRedDotExpEnabled",!1)&&(null===(cd=this.kad)||void 0===cd?void 0:cd.psg(Vc))):(this.Xy.eX(),this.Xy.dca(jb,Tc));return 32};this.G8c=(jb,cc,Hc,Vc,Tc)=>{if(2!==Hc)return 32;if(!this.Kv)return 8;cc=this.jHf(Tc);if(!cc)return l.ULS.sendTraceTag(509383065,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),
8;this.Tc?this.Tc.Dbc(cc,Tc.UILocation,Tc.SourceControlId):(this.Xy.eX(),this.Xy.dca(jb,Tc));return 32};this.H8c=(jb,cc,Hc,Vc,Tc)=>{cc=this.va.Ga;Vc=this.$b.Qf;if(!(this.DP&&cc&&Vc)||this.hf.Cd(cc))return 8;if(!this.UHa)return l.ULS.sendTraceTag(512288602,802,50,"Web add-in insert blocked by doc IRM"),8;if(1===Hc)return 32;Hc=Tc?Tc.SourceControlId:void 0;window[this.d_f]=this.bbd.get(Hc)?this.bbd.get(Hc):"Unknown";this.Tc?(Va.a("UpdateLaunchInsertDialog")?(jb=Tc?Tc.SourceControlId:void 0,Tc=Tc?Tc.CommandValueId:
null,"InsertMoreAddInsFromFooter"===jb||"InsertMoreAddInsFromBackstageFooter"===jb?this.Tc.FFe("{98143890-AC66-440E-A448-ED8771A02D52}"):"AddinFlyoutMoreButton"===jb||"LaunchMyAddInsFromBackstage"===jb?this.Tc.FFe("0"):"LaunchAddinDialogFromTellMe"==jb&&Tc?this.Tc.Lsj(Tc):this.Tc.launchInsertDialog()):this.Tc.launchInsertDialog(),Va.a("LogTelemetryForStoreDialog")&&(Tc={["controlId"]:Hc},jb=new A.a,jb.name="Office.Extensibility.Host.ShowStoreDialog",jb.dataFields=w.a.Gw(Tc),y.a.sendTelemetryEvent(jb))):
(this.Xy.eX(),this.Xy.dca(jb,Tc));return 32};this.E8c=(jb,cc,Hc,Vc,Tc)=>{if(!Tc)return 8;null!=this.Tc&&this.Fb.isChangeGateEnabled("OnInsertAgaveStartedEnabled")&&this.Tc.Occ("handleInsertAppForOffice",Tc);return this.aRb(jb,Tc)};this.fKf=(jb,cc,Hc,Vc,Tc)=>Tc?this.aRb(jb,Tc):8;this.aRb=(jb,cc)=>{if(!this.UHa)return l.ULS.sendTraceTag(512288601,802,50,"Web add-in insert blocked by doc IRM"),16;if(0===cc.targetType)return this.zOf(cc,jb);if(1===cc.targetType){if(this.hf.Cd(this.$b.Qf))return 16;this.w7f?
cc.isAddinCommands?Va.a("AddinCommandsActionTypeUndefinedCheck")?void 0===cc.addinCommandsActionType||null===cc.addinCommandsActionType||0===cc.addinCommandsActionType?this.icb(cc):1===cc.addinCommandsActionType?this.L$a(cc):l.ULS.sendTraceTag(512288600,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+cc.addinCommandsActionType.toString()):0===cc.addinCommandsActionType?this.icb(cc):1===cc.addinCommandsActionType&&this.L$a(cc):(jb={},jb.solutionId=cc.solutionId,jb.version=
cc.version,jb.storeType=cc.storeType,jb.storeId=cc.storeId,jb.targetData=cc,this.Tc.nq.isAddinCommandsAsync(jb,(Hc,Vc,Tc)=>{Vc?this.icb(Tc.targetData):this.L$a(Tc.targetData);Hc||(Hc=Tc.targetData,l.ULS.sendTraceTag(512288599,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Hc.solutionId,Hc.storeType,Hc.assetId,null,null,Hc.storeId),Hc.storeType))})):this.L$a(cc);eb.a.add(cc.solutionId,cc.targetType,cc.storeId,cc.storeType,cc.version);return 32}return 8};
this.YJf=(jb,cc,Hc)=>{if(2!==Hc)return this.Tc&&this.Tc.WG?32:8;if(!this.Tc)return l.ULS.sendTraceTag(507818185,220,10,"appForOfficeManager is null"),8;this.C$c||(this.Tc.WG?(this.Tc.WG.ybb(this.VKg),this.C$c=!0):l.ULS.sendTraceTag(507818184,220,10,"appForOfficeManager.addinDetailsProvider is null"));return 32};this.VKg=()=>{this.gab?this.gab.zcd():l.ULS.sendTraceTag(507896194,220,10,"_addInCategoryManager is null")};this.la=Fa;this.Fb=rb;this.DP=this.la.vCb;this.w7f=this.la.m0a;this.Xn=$b;this.ia=
ec;this.$b=pc;this.va=dd;this.Bad=Jb;this.Mb=Ad;this.Xy=Bc;this.Hd=Mc;this.Pb=ed;this.hf=Yc;this.kj=ab}get UHa(){return this.DP&&z.AFrameworkApplication.uSa}get xTa(){return this.Fb.isChangeGateEnabled("OfficeVSO:8332954_FlyoutNotifyObserverFailuresEnabled")}Hb(){this.ia.sa(Yb.a.rEa,ac.a.application,this.H8c,516);this.ia.sa(Yb.a.c9c,ac.a.application,this.fKf,4);this.ia.za(Yb.a.T8c,ac.a.application,Object(Ea.a)(this,this.eKf,"handleHideAppForOfficeTaskPane"));this.ia.sa(Yb.a.uUa,ac.a.application,Object(Ea.a)(this,
this.JKf,"handleRenderAppForOfficeTaskPane"),4);this.ia.sa(Yb.a.L5a,ac.a.application,Object(Ea.a)(this,this.L5a,"queryEntitledAppsForOffice"),96);this.ia.za(Yb.a.mFa,ac.a.application,Object(Ea.a)(this,this.M8c,"handleShowFirstPartyTaskPane"));this.ia.za(Yb.a.JLb,ac.a.application,Object(Ea.a)(this,this.KJf,"handleCloseAppsForOfficeTaskPane"));this.ia.za(U.a.EUg,ac.a.application,Object(Ea.a)(this,this.VKf,"handleShowExtensionTaskPane"));this.ia.za(U.a.Jjf,ac.a.application,Object(Ea.a)(this,this.LJf,
"handleCloseExtensionTaskPane"));this.ia.za(U.a.KMg,ac.a.application,Object(Ea.a)(this,this.KKf,"handleRestartExtensionTaskPane"));this.ia.za(Yb.a.POe,ac.a.application,Object(Ea.a)(this,this.fLf,"handleUpdateBackgroundAppData"));this.ia.za(U.a.hXf,ac.a.application,this.kKf);Va.a("EnabledTellMeAddinOnPPTO")&&(this.ia.sa(U.a.Pjh,ac.a.application,this.E8c,4),this.ia.sa(U.a.bXf,ac.a.application,this.H8c,4));this.BDa&&(this.ia.za(U.a.Dbc,ac.a.application,this.G8c),this.ia.za(U.a.xOf,ac.a.application,this.E8c),
this.ia.za(U.a.c$c,ac.a.application,this.lKf),Va.a("DelayQueryAddinFlyoutRegister")&&this.UHa&&!this.Fb.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")&&this.xTa&&this.BDa?(this.Xy.eX(),this.Hd.execute(()=>{this.EJf()})):(this.ia.sa(U.a.OKe,ac.a.application,this.J8c,4),this.JXb=!0),this.xTa||this.rdd());if(this.D0b||this.BDa)this.ia.za(U.a.EFe,ac.a.application,this.jKf),this.ia.za(U.a.uEe,ac.a.application,this.hKf);this.D0b&&this.Q_g&&this.ia.za(U.a.Fuf,ac.a.application,this.YJf);Va.a("EnableSetTitleExtensionTaskPane")&&
this.ia.za(U.a.hSg,ac.a.application,this.SKf)}EJf(){!this.jab&&this.Tc&&this.c6c()}rdd(){this.wad||(this.ia.za(U.a.y7j,ac.a.application,this.CKf),this.wad=!0,l.ULS.sendTraceTag(508560274,220,50,"Register succeed"))}uJg(){this.JXb||(this.ia.sa(U.a.OKe,ac.a.application,this.J8c,4),this.JXb=!0)}cia(){Va.a("DelayQueryAddinFlyoutRegister")&&this.uJg();this.rdd()}c6c(){if(this.Tc.WG){this.kad=new D(this.Tc.WG);if(!Va.a("DelayQueryAddinFlyoutRegister")||Cb.c()&&appChrome.addInApi)this.jab=new yb(this.ia,
this.Tc.WG,U.a.Dbc.toString(),U.a.c$c.toString(),this.HUf?U.a.oe.toString():Yb.a.rEa.toString(),this.Fb,this.e$e,this.i0?this.AAf():{},[],this.kad);this.xTa&&!this.Ead&&(this.Tc.WG.ybb(Object(Ea.a)(this,this.cia,"onAddinDetailsRefreshed")),this.Ead=!0)}else l.ULS.sendTraceTag(509379480,220,10,"this.appForOfficeManager.addinDetailsProvider is null")}get Kv(){if(!this.BDa)return null;if(!this.Tc)return this.Xy.eX(),null;this.jab||this.c6c();return this.jab}get e$e(){this.D0b&&!this.gab&&(this.gab=new ia(this.Fb,
this.Tc.WG,this.pgf));return this.gab}get D0b(){var Fa;return!(null===(Fa=this.Fb)||void 0===Fa||!Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",!1))}get BDa(){return this.Fb.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&this.Fb.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}get i0(){return this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutContentExpEnabled",!1)}get Frf(){return this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DistinguishUserSegmentForContentExpEnabled",
!1)}get WJb(){return this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchApiEnabled",!1)}get HUf(){var Fa;return null===(Fa=this.Fb)||void 0===Fa?void 0:Fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SeeMoreSeeLessEnabled",!1)}jHf(Fa){if(Fa)if(this.Kv.UQ){if(Fa=this.Kv.ZOb(this.pIf(Fa)))return Fa.solutionId}else{const rb=Fa.CommandValueId;return null!=rb?rb:this.Kv.X5c[Fa.SourceControlId]}}pIf(Fa){var rb;return null!==(rb=Fa.CommandValueId)&&void 0!==rb?rb:this.Kv.A8c(Fa.SourceControlId)}pff(){try{const Fa=
JSON.parse(this.Fb.La("SessionStartInfoJson"));return`IsBusinessUser: ${Fa.IsBusinessUser}, IsEduUser: ${Fa.IsEduUser}, IsAnonymousUser: ${"true"===Fa.IsAnonymousUser}`}catch(Fa){return l.ULS.sendTraceTag(507881032,220,10,"Exception thrown from JSON parse for sessionStartInfoJson:{0}. Exception:{1}",this.Fb.La("SessionStartInfoJson"),Fa),""}}get isBusinessUser(){try{const Fa=JSON.parse(this.Fb.La("SessionStartInfoJson"));return Fa.IsBusinessUser?Fa.IsBusinessUser:!1}catch(Fa){return l.ULS.sendTraceTag(507811937,
220,10,"Exception thrown from JSON parse for sessionStartInfoJson:{0}. Exception:{1}",this.Fb.La("SessionStartInfoJson"),Fa),!1}}AAf(){const Fa=this.Frf&&this.isBusinessUser?Ra:ca;for(const rb in bb)Fa[rb]=bb[rb];return Fa}ve(){}get Tc(){return this.Hd.instance}I7c(Fa){return this.Kv.UQ?this.Kv.ZOb(Fa):this.Tc.WG.D0(Fa)}static Jsa(Fa,rb,$b,ec){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Fa,rb,$b,null,null,ec)}iKf(Fa,rb,$b){if(2!==rb)return 32;rb=this.Kv.rGf($b.CommandValueId);if(!rb)return l.ULS.sendTraceTag(507631072,
220,10,"No search add-in details."),8;this.Kv.Qxf(rb).then(ec=>{this.F8c(Fa,$b,ec)}).catch(ec=>{l.ULS.sendTraceTag(507631071,220,10,ec.message)});return 32}VKf(Fa,rb,$b,ec,pc){if(2!==$b)return 32;const dd=pc[Aa.a.Hwa];pc=pc[Aa.a.$pa];const Ad={};Ad.JB=pc.optionalProperties[r.a.JB];Ad.assetId=dd.getId();Ad.LU=pc.optionalProperties[r.a.LU];Ad.showLoadingSpinner=pc.optionalProperties[r.a.showLoadingSpinner];Ad.nonPersistedSettings=pc.TDa;return this.M8c(Fa,rb,$b,ec,Ad)}LJf(Fa,rb,$b,ec,pc){if(2!==$b)return 32;
Fa=pc[Aa.a.Hwa];pc=pc[Aa.a.$pa];rb={};rb.JB=pc.optionalProperties[r.a.JB];rb.assetId=Fa.getId();rb.sourceLocationOverrideResourceId=pc.optionalProperties[r.a.sourceLocationOverrideResourceId];rb.LU=pc.optionalProperties[r.a.LU];rb.nonPersistedSettings=pc.TDa;pc=this.Tc.VJa(rb);return(pc=this.Tc.xT(pc))&&this.Tc.$xd(pc.Kp)?32:8}KKf(Fa,rb,$b,ec,pc){if(2!==$b)return 32;Fa=pc[Aa.a.Hwa];rb=pc[Aa.a.$pa];pc={};pc.JB=rb.optionalProperties[r.a.JB];pc.assetId=Fa.getId();pc.sourceLocationOverrideResourceId=
rb.optionalProperties[r.a.sourceLocationOverrideResourceId];pc.LU=rb.optionalProperties[r.a.LU];pc.nonPersistedSettings=rb.TDa;Fa=this.Tc.VJa(pc);return(Fa=this.Tc.xT(Fa))?(this.Tc.kLe(Fa.Kp,pc),32):8}eKf(Fa,rb,$b,ec,pc){if(!this.DP)return 16;if(!pc)return 8;if(1===$b)return 32;Fa=Object(La.a)(String,pc);if(!Fa||!Fa.length)return 8;if((rb=this.Tc.VBe(Fa))&&rb.taskpane){if(this.Tc.SAb(Fa))return this.Tc.TWc(Fa,!1),32;if(rb.Mx&&OSF.OsfControl.isFirstPartyStoreString(rb.Mx.storeType))return this.Tc.B6c(Fa),
this.Tc.Ufk(Fa),32;rb=rb.taskpane.ownerAddinSolutionId;if(this.Tc.$ej(Fa)||rb)this.Tc.B6c(Fa);else if(rb=this.Tc.L7c(),$b=this.Pb.Hc(rb),Fa=this.Tc.hgh(Fa)){$b.Bk(Object(La.a)(Wa.a,Fa));Fa=this.Mb.Fd(4,void 0,void 0,void 0,!0);try{Fa.rc(rb),$b.Bi()}finally{Fa&&Fa.dispose()}}}return 32}JKf(Fa,rb,$b,ec,pc){if(!this.DP)return 16;if(!pc)return 8;if(1===$b)return 32;rb=Object(La.a)(String,pc);if(!rb||!rb.length)return 8;this.Tc?this.Tc.uUa(rb):this.Xy.dca(Fa,pc);return 32}M8c(Fa,rb,$b,ec,pc){if(!this.DP)return 16;
if(!pc)return 8;if(1===$b)return 32;if(this.Tc){if(!pc||!pc.assetId||!z.AFrameworkApplication.bUd(pc.assetId))return 8;pc.nonPersistedSettings||(pc.nonPersistedSettings={});pc.nonPersistedSettings.ShowFeedback=z.AFrameworkApplication.$F;!this.had&&this.Zsa&&(this.had=!0,Fa=window.performance.now()-this.Zsa,l.ULS.sendTraceTag(512288597,220,50,"Apps for office load time {0}",Fa));Fa=this.Tc.VJa(pc);if(Fa=this.Tc.xT(Fa))return this.Tc.kLe(Fa.Kp,pc),32;this.Tc.Opk(pc)}else this.Zsa||(this.Zsa=window.performance.now()),
this.Xy.eX(),this.Xy.dca(Fa,pc);return 32}get Q_g(){return this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}fLf(Fa,rb,$b,ec,pc){if(1===$b)return this.DP?32:8;if(!this.DP)return 16;if(!(pc&&pc.oJ&&-1!==pc.oJ.state&&pc.oJ.Jbb&&this.Tc))return 8;Fa=this.Tc.Cib(pc.Mx.id);if(!Fa)return 8;rb=this.Mb.Fd(4,void 0,void 0,void 0,!0);try{rb.rc(Fa),Fa.setValue(ea.a.xSa,pc.oJ.state),Fa.setValue(ea.a.ZHa,pc.oJ.Jbb),Fa.setValue(nb.a.lzb,pc.Mx.storeType)}finally{rb&&
rb.dispose()}return 32}KJf(Fa,rb,$b,ec,pc){return this.DP?pc?1===$b?32:this.Tc&&pc&&pc.length?this.Tc.$xd(pc)?32:8:8:8:16}L5a(Fa,rb,$b,ec,pc){var dd;if(2===$b){rb=pc.callback;if(!rb)return 16;Va.a("AllowQueryAddinsForStoreTypes")?this.Tc?this.GGg(rb,null!==(dd=pc.storeType)&&void 0!==dd?dd:OSF.StoreTypeEnum.MarketPlace):(pc=Object.assign({},pc),this.Xy.dca(Fa,pc)):this.FGg(rb)}return 32}GGg(Fa,rb){const $b=new wa.a;$b.callbackFunc=Fa;$b.storeType=rb;$b.fromInsertDialog=!1;$b.refresh="true"===Za.a.instance.getItem(pa.a.O4c);
this.Tc.nq.queryEntitlementDetails($b)}FGg(Fa){const rb=new wa.a;rb.callbackFunc=Fa;rb.storeType=OSF.StoreTypeEnum.MarketPlace;rb.fromInsertDialog=!1;rb.refresh="true"===Za.a.instance.getItem(pa.a.O4c);this.Tc.nq.queryEntitlementDetails(rb)}icb(Fa){const rb=new N.a;rb.add(Fa);Fa={};Fa[pa.a.aud]=rb;Fa[pa.a.k9a]=3;this.ia.Qa(U.a.CFe,2,Fa)}zOf(Fa,rb){const $b=this.va.Ga;if(!$b||this.hf.Cd($b))return 16;if(!this.kj.zC($b,1))return this.kj.dI($b),16;try{return this.qOd(Fa,$b,$b.Xb,rb)}catch(ec){return 8}}qOd(Fa,
rb,$b,ec){$b=rb.Xdh(0,Fa.width,Fa.height,rb.Ju()+1);Hb.a.z4c($b,Fa,this.Tc);this.Xn.WM([Object(La.a)(426,$b)],rb,ec);eb.a.add(Fa.solutionId,Fa.targetType,Fa.storeId,Fa.storeType,Fa.version);return 32}L$a(Fa){if(!this.Tc.xT(Fa.solutionId)){var rb=this.Tc.Cib(Fa.solutionId),$b=this.Tc.L7c();if(rb){$b=new ua.a(rb);if(!$b.visibility){const ec=this.Mb.Fd(4,void 0,void 0,void 0,!0);try{ec.rc(rb),rb.setValue(nb.a.n$b,!0),rb.setValue(nb.a.lzb,Fa.storeType)}finally{ec&&ec.dispose()}}this.Tc.uUa($b.id)}else{rb=
Hb.a.kmf(this.Bad.value,Fa,this.Tc);Fa=this.Mb.Fd(4,void 0,void 0,void 0,!0);try{Fa.rc($b),Hb.a.xva($b,rb,19)}finally{Fa&&Fa.dispose()}}}}}Object(x.a)(wb,"AppForOfficeActor",null,[743])},1150:function(x,G,a){a.d(G,"a",function(){return n});x=a(0);var c=a(182);G=a(651);class b extends G.a{constructor(l,r,w){r=void 0===r?null:r;w=void 0===w?null:w;super("DeferredContentType");this.title=this.isDeferred=this.messageText=null;this.title=r;this.messageText=l;this.isDeferred=w}}Object(x.a)(b,"DeferredContentProps",
G.a,[]);var f=a(248),e=a(882),h=a(883);const u=(l,r)=>Object.assign(new e.a,{target:".EditingRibbonPanel",content:l,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new h.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,preventDismissOnScroll:!0,onDismiss:r,preventDismissOnResize:!0})});var m=a(267);class n{constructor(){this.iY=new b(ResourceStrings.l_DeferredContentDownloadACopyWaitToastMessage,ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle,!0)}Jeh(l,r,w,y){y=Object.assign(new c.a,
{onShow:()=>{w.XW(m.a.bwb)}});r=l.callout(r);return y=l.addNotification(r,y)}huh(l,r){l.removeNotification(r);f.a.J(523871964,843,10,"DownloadACopy Toast can not be removed!");return r}Ydh(l){return u(this.iY,()=>{l.Cr(m.a.bwb)})}}Object(x.a)(n,"DownloadACopyDeferred",null,[1130])},1167:function(x,G,a){a.d(G,"a",function(){return l});x=a(0);var c=a(68),b=a(4),f=a(1594),e=a(181),h=a(256);class u{constructor(r,w){this.actionId=r;this.$c=w}}Object(x.a)(u,"CommandActionData",null,[]);var m=a(251),n=a(250);
class l{constructor(r,w,y,z,A){this.lbd=[];this.z9c=!1;this.jMa=null;this.mab=new c.a;this.ia=r;this.YYb=w;this.r9e=!1;this.Pb=y;this.le=z;this.ONa=A;this.y$c=this.kta=null;Object(n.a)("EnhancementOfSDXPaneBootTime")&&this.ENf()}ENf(){this.kta||(this.kta=b.AFrameworkApplication.xh("officeExtensionMerge.js",5));this.y$c||(this.y$c=b.AFrameworkApplication.xh("appforoffice.hermes"+this.le.uFe,1));if(!this.jMa){const r=[this.ONa.FMb(this.L0b)];this.jMa=f.a.create("pptedit.appforoffice",r,()=>a.e(20).then(a.bind(null,
1678)))}}get lcb(){return this.lbd}get L0b(){this.kta||(this.kta=b.AFrameworkApplication.xh("officeExtensionMerge.js",5));return this.kta}set L0b(r){this.kta=r}get Dbf(){if(!this.jMa){const r=[this.ONa.FMb(this.L0b)];this.jMa=f.a.create("pptedit.appforoffice",r,()=>a.e(20).then(a.bind(null,1678)))}return this.jMa}Gah(r){this.lcb.push(r)}eX(){this.z9c||(e.a.HL(this.Dbf),this.z9c=!0)}cTk(){for(const r of this.lcb)r.owb();this.lbd=[]}dTk(){var r=this.Pb.Hc(this.YYb.Qf).Bb(18);r=this.Pb.Hc(r);let w=r.Bb(19);
if(w){do w=r.Wp,this.ia.Qa(m.a.uUa,2,w.gb(h.a.I4));while(r.xf(19))}}dca(r,w){this.mab.add(new u(r,w))}p1i(){if(0<this.mab.count){for(const r of this.mab)this.ia.Qa(r.actionId,2,r.$c);this.mab.clear()}}pLf(){const r=!!this.lcb&&0<this.lcb.length;let w=!1;if(this.YYb.Qf&&!r){const y=this.Pb.Hc(this.YYb.Qf).Bb(18);y&&0<this.Pb.Hc(y).h3(19)&&(w=!0)}return r||w}}Object(x.a)(l,"AppForOfficeManagerFactory",null,[851])},1216:function(x,G,a){a.d(G,"a",function(){return c});x=a(251);a=a(254);const c=[a.a.Zfb,
a.a.Cvd,a.a.Evd,a.a.acf,a.a.snc,a.a.Rfb,x.a.Gva,x.a.oma,a.a.Jud,a.a.W4h,a.a.isa,a.a.vnc,a.a.wnc,x.a.Bja,x.a.PXa,x.a.Pud,x.a.JZ,x.a.FDa,x.a.GDa,x.a.jsa,x.a.tSa,x.a.jze,a.a.nT,a.a.LN,a.a.wvd,a.a.Zfb,a.a.yvd,a.a.zvd,a.a.Avd,a.a.backspace,a.a.Mva,a.a.Tnc,a.a.m7h,x.a.$Ha,a.a.bold,x.a.bold,x.a.bringForward,x.a.bringToFront,x.a.c$h,a.a.centerJustify,a.a.P4,a.a.Q4,a.a.yQ,a.a.clearFormatting,a.a.spc,a.a.qIa,a.a.Mxd,x.a.gYa,x.a.bpc,x.a.IDa,x.a.B9a,x.a.C9a,x.a.iG,x.a.clearFormatting,x.a.rIa,x.a.N$b,x.a.r6c,
a.a.aJa,a.a.mF,x.a.dJa,x.a.editSlideTitle,a.a.enter,a.a.ytc,x.a.huc,a.a.font,x.a.l$,x.a.Cac,x.a.Juc,a.a.fullJustify,a.a.vfa,a.a.xC,x.a.Dca,a.a.insertHyperlink,x.a.f9c,a.a.Okb,a.a.kdj,a.a.h9c,x.a.i9c,x.a.j9c,a.a.insertOnlinePicture,x.a.insertOnlinePicture,a.a.insertPicture,x.a.insertPicture,a.a.Yfa,a.a.s5,x.a.MAb,x.a.Ozc,x.a.ZRb,x.a.Rzc,x.a.Vzc,x.a.Wzc,x.a.Xzc,x.a.Yzc,x.a.Zzc,x.a.$zc,x.a.$Rb,x.a.aSb,x.a.Xja,x.a.hbc,x.a.NAb,a.a.M$a,a.a.insertTable,a.a.cDc,a.a.smb,a.a.tmb,a.a.umb,a.a.dDc,a.a.fDc,a.a.gDc,
a.a.vmb,a.a.wmb,a.a.xmb,a.a.hDc,a.a.ymb,a.a.zmb,a.a.Amb,a.a.leftJustify,a.a.K5,x.a.mergeTableCells,x.a.O9d,x.a.Ipa,a.a.QA,a.a.Z1b,x.a.pka,x.a.bdc,x.a.cdc,x.a.ncd,a.a.VU,x.a.b2b,x.a.vRc,x.a.vRc,x.a.qCb,x.a.nW,x.a.mdc,x.a.A2b,x.a.Zee,x.a.ska,x.a.jPa,x.a.WU,x.a.XU,x.a.ndc,a.a.UF,x.a.RCb,x.a.SCb,x.a.$Cb,a.a.$Cb,a.a.bsk,x.a.wMg,x.a.TBa,x.a.Ibb,x.a.Zdd,x.a.sendBackward,x.a.hec,x.a.sendToBack,x.a.FB,x.a.kp,x.a.f6b,a.a.Mo,a.a.setItalic,x.a.Kta,x.a.hk,x.a.oDb,x.a.Vbb,x.a.Ged,a.a.cwb,x.a.ape,x.a.c7b,a.a.subscript,
a.a.superscript,x.a.$qe,x.a.t7,x.a.$bb,a.a.sxb,a.a.bG,a.a.hI,a.a.Mz,a.a.underline]},1217:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(19);class b{createAuthProviderAsync(f){c.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").eX();return new Promise(e=>{c.a.instance.Na("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(h=>{h=h.fml(f);e(h)})})}}Object(x.a)(b,"SlideShowAppForOfficeAuthFactory",null,[])},1218:function(x,G,a){a.d(G,"a",function(){return c});x=
a(0);class c extends Sys.EventArgs{constructor(b){super();this.slideId=b.SlideId;this.slideIndex=b.SlideIndex;this.tfd=b.TimeLineMappings}}Object(x.a)(c,"OnPositionChangedEventArgs",Sys.EventArgs,[])},1219:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.CoachButton="coachButton";c.MicButton="micButton";c.PrevButton="prevButton";c.NextButton="nextButton";c.GridButton="gridButton";c.InkButton="inkButton";c.SubtitlesButton="subButton";c.LiveButton="liveButton";c.MoreButton="moreButton";
c.ExitButton="exitButton";c.CameraButton="cameraButton";c.OptionsButton="optionsButton";c.SlideIndex="slideIndex";Object(x.a)(c,"SlideshowToolbarButtonIDs",null,[])},1221:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b[b.notSupported=0]="notSupported";b[b.A8m=1]="launchByLocalCacheInitializer";b[b.w8m=2]="launchByAnonymousApiInitializer";b[b.y8m=3]="launchByInsertion";b[b.B8m=4]="launchByRefresh";b[b.z8m=5]="launchByLastUpdateInitializer";b[b.x8m=6]="launchByDynamicCall"})(c||
(c={}));Object(x.b)("AddinCommandsLaunchOperationType",c)},1222:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}Object(x.a)(c,"OnlineMediaSearchResult",null,[])},1223:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b,f){this.qdn=b;this.Tdn=f}get Skh(){return this.qdn}get HHn(){return this.Tdn}}Object(x.a)(c,"ReportSuggestionSessionActionData",null,[])},1224:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.spl="Provider.UCI.Editor";c.npl=
"EntityGroup.UCI.Editor";c.G5l="Provider.Designer.Slide";c.F5l="EntityGroup.Designer.Slide.Suggestion";c.N5l="Provider.Designer.TextToSmartArt";c.M5l="EntityGroup.Designer.TextToSmartArt.Suggestion";Object(x.a)(c,"InfraredConstant",null,[])},1341:function(x,G,a){a.d(G,"a",function(){return f});x=a(0);var c=a(95),b=a(62);class f{constructor(e){this.Ip=e;this.jP=Array.indexOf(this.Ip,this.LJa)}dispose(){this.Ip=null}get Lma(){return this.Ip[this.jP]}tZ(e){this.a6b(e,!1);return!0}Huc(e){this.a6b(e,!0)}a6b(e,
h){e&&(this.Lma!==e||h)&&(e.tabIndex=0,b.FocusManager.UA(e));Array.contains(this.Ip,e)&&(this.jP=Array.indexOf(this.Ip,e))}get bth(){let e=this.jP;do if(e)if(0<e&&e<this.Ip.length)e--;else break;else e=this.Ip.length-1;while(!c.DOMFocusListing.Zma(this.Ip[e])&&e!==this.jP);return this.Ip[e]}get srh(){let e=this.jP;do if(e===this.Ip.length-1)e=0;else if(0<=e&&e<this.Ip.length-1)e++;else break;while(!c.DOMFocusListing.Zma(this.Ip[e])&&e!==this.jP);return this.Ip[e]}get LJa(){let e=0;for(;!c.DOMFocusListing.Zma(this.Ip[e])&&
e<this.Ip.length;)e++;return c.DOMFocusListing.Zma(this.Ip[e])?this.Ip[e]:null}get X9c(){let e=this.Ip.length-1;for(;!c.DOMFocusListing.Zma(this.Ip[e])&&0<e;)e--;return c.DOMFocusListing.Zma(this.Ip[e])?this.Ip[e]:null}}Object(x.a)(f,"DialogFocusListing",null,[126])},1342:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}Object(x.a)(c,"AppsForOfficeEntitlementQueryInfo",null,[])},1348:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(285);class b{constructor(f){this.bob=
this.CWb=null;this.Qi=f}dispose(){this.clear();this.CWb.parentNode.removeChild(this.CWb)}LKb(f){this.CWb=this.rmf(f,"prContainerHr");this.bob=this.rmf(this.CWb,"prGlyph")}clear(){this.N4b()}setImage(f,e){f&&(this.N4b(),this.bob.appendChild(f),this.bob.style.backgroundColor=e,this.CWb.style.visibility=c.a.visible)}rmf(f,e){const h=this.Qi.hg();this.Qi.addCssClass(h,e);f.appendChild(h);return h}N4b(){this.bob.firstChild&&this.bob.removeChild(this.bob.firstChild)}}Object(x.a)(b,"ShapePawnGlyph",null,
[])},1350:function(x,G,a){a.d(G,"a",function(){return n});x=a(0);var c=a(17),b=a(1233),f=a(231),e=a(40),h=a(68),u=a(258),m=a(250);class n{constructor(l,r,w,y,z,A,B,H,v){this.AM=new b.a;this.tQ=C=>C.isDecorative?ResourceStrings.L_AccMessageDecorative:C.get_altTitle();this.Jlg=l;this.Ub=r;this.t3=z;this.Ia=w;this.Hd=A;this.AEc=B;this.gq=y;this.Cj=H;this.la=v;this.Faj()}get Tc(){return this.Hd.instance}get k0(){return this.AEc.value}Faj(){var l;this.AM.K(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);
this.AM.K(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.AM.K(2,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.AM.K(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.AM.K(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);this.AM.K(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.AM.K(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.AM.K(11,[ResourceStrings.l_PhTypeClipArt,
ResourceStrings.l_InsertContent]);this.AM.K(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);this.AM.K(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);this.AM.K(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.AM.K(6,[ResourceStrings.l_PhTypeFooter,ResourceStrings.l_ClickToAddFooter]);this.AM.K(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber]);(null===(l=this.la)||void 0===l?0:l.tTa)&&this.AM.K(16,
[ResourceStrings.l_PhTypeCameo,ResourceStrings.l_ClickToAddCameo])}pVi(l,r){l&&(this.Kfa(l,r),l.Vsa?r.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.vJd(l,null,r));return null}ywl(l){if(!this.Jlg.instance||!l)return null;l=this.Jlg.instance.BVi(l);if(!l||!l.length)return null;const r=l.length;return 1===r?String.format(ResourceStrings.l_ShapePresenceForOneUser,l[0].userName):2===r?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,l[0].userName,l[1].userName):3===r?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,
l[0].userName,l[1].userName,l[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,r)}tih(l){let r="";l&&l.TT&&l.image.title&&0<l.image.title.length&&(r=l.image.title);l&&(r=String.format(ResourceStrings.l_ThumbnailInfoNew,l.slideIndex+1,this.Ub.hl(),r),l=this.mYi(l),0<l.length&&(r+=l));return r}mYi(l){const r=new Sys.StringBuilder;l.isSelected&&r.append(ResourceStrings.L_SlideIsSelected);l.ol&&r.append(ResourceStrings.l_SlideIsHidden);const w=Object(f.a)(32,l.zd);if(w){var y=
w.pKa();y&&!this.gq.mTf(y)&&r.append(ResourceStrings.l_SlideHasNotes);(y=w.JV())&&this.t3.instance&&this.t3.instance.Wih(y)&&(y=this.t3.instance.uCe(y),r.append(1===y?ResourceStrings.l_SlideHasOneComment:String.format(ResourceStrings.l_SlideHasCommentsWithCount,y)))}l.GX&&r.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(l.yCb&&(l=l.yCb.kTa())&&0<l.length)if(1===l.length)r.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,l[0].userName));else{y="";for(const z of l)y+=z.userName+
",";r.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,y))}w&&w.isUnread&&r.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);return r.toString()}n8c(l,r){return String.format(ResourceStrings.l_MultipleSlidesSelected,l,r)}tul(l,r){return String.format(ResourceStrings.l_DesignerSuggestionSelected,l+1,r)}Fwl(){return ResourceStrings.l_SlidePanel}yvl(){return ResourceStrings.l_MultipleShapes}VXl(l){l&&(this.la.jIa&&l.Q3(Object(e.a)(this,this.LJi,"getCameoAccMessage")),
l.Q3(Object(e.a)(this,this.rXi,"getTableAccMessage")),l.Q3(Object(e.a)(this,this.OOi,"getImageAccMessage")),l.Q3(Object(e.a)(this,this.BQi,"getMediaAccMessage")),l.Q3(Object(e.a)(this,this.ZJi,"getChartAccMessage")),this.rYc?(l.Q3(Object(e.a)(this,this.eHf,"getSmartArtAccMessage")),l.Q3(Object(e.a)(this,this.vJd,"getPlaceHolderAccMessage"))):(l.Q3(Object(e.a)(this,this.vJd,"getPlaceHolderAccMessage")),l.Q3(Object(e.a)(this,this.eHf,"getSmartArtAccMessage"))),l.Q3(Object(e.a)(this,this.eYi,"getTextboxAccMessage")),
l.Q3(Object(e.a)(this,this.sVi,"getShapeGroupAccMessage")),l.Q3(Object(e.a)(this,this.oVi,"getShapeAccMessage")),l.Q3(Object(e.a)(this,this.uIi,"getAddinAccMessage")),l.Q3(Object(e.a)(this,this.iIi,"get3DAccMessage")))}vJd(l,r,w,y){y=void 0===y?null:y;if(l&&w&&l.pl&&(this.Bxc(l,w),this.AM.Ob(l.placeholderType))){y&&y(String.format("{0} {1}",this.AM.ha(l.placeholderType)[0],ResourceStrings.l_Placeholder));if(l.nS||!w.count){w=this.AM.ha(l.placeholderType)[0];r="";if(!this.rYc||l.nS)r=this.AM.ha(l.placeholderType)[1];
return String.format(l.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,w,this.tQ(l),r,l.get_alt())}l=String.format(l.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,this.AM.ha(l.placeholderType)[0],this.tQ(l),l.get_alt());w.insert(0,document.createTextNode(l))}return null}eYi(l,r,w,y){y=void 0===y?null:y;if(l&&w&&l.Uq)if(this.Bxc(l,w),y&&y(ResourceStrings.L_TextBox),0<w.count)l=String.format(l.get_alt()?
ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,this.tQ(l),l.get_alt()),w.insert(0,document.createTextNode(l));else return String.format(l.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,this.tQ(l),l.get_alt());return null}eHf(l,r,w,y){y=void 0===y?null:y;if(l&&w&&l.rg)if(this.Bxc(l,w),y&&y(ResourceStrings.L_SmartArt),0<w.count)l=String.format(l.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,
this.gHf(l)||"",this.tQ(l),l.get_alt()),w.insert(0,document.createTextNode(l));else return String.format(l.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.gHf(l)||"",this.tQ(l),l.get_alt());return null}Kfa(l,r){l&&r&&this.Ia.VH(l,w=>{w.Ra(u.a.tq)&&this.UDf(w,r)})}Bxc(l,r){if(l&&r){const w=this.rYc?new h.a:r;let y=!1;this.Ia.VH(l,z=>{const A=this.Cj.WV(z),B=this.Cj.P1b(z);A&&w.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,
B)));y=this.UDf(z,w)||y});this.rYc&&y&&r.addRange(w);r.count||(l=l.Dre)&&r.add(document.createTextNode(l))}}get rYc(){return m.a("AriaMessageHelper.FixAccMessageForEmptyList")}UDf(l,r){let w;const y=l.oa(u.a.W7b,null),z=l.oa(u.a.tq,"");if(z&&r){if(y){let A=0,B=null,H;for(let v=0;v<y.length+1;v++)H=this.Ia.kwc(l,v),B&&B!==H&&(w=document.createElement("span"),w.setAttribute("lang",B),w.innerText=z.substring(A,y[v-1]),A=y[v-1],r.add(w)),B=H;w=document.createElement("span");B&&w.setAttribute("lang",B);
w.innerText=z.substring(A,z.length)}else w=document.createElement("span"),(l=this.Ia.kwc(l,0))&&w.setAttribute("lang",l),w.innerText=z;r.add(w)}return!!z&&0<z.length}rXi(l,r,w,y){y=void 0===y?null:y;return l&&l.Zc?(y&&y(ResourceStrings.L_Table),String.format(l.get_alt()?ResourceStrings.l_AccMessageTableAlt:ResourceStrings.l_AccMessageTable,this.tQ(l),l.get_alt())):null}OOi(l,r,w,y){y=void 0===y?null:y;return l&&l.Kg?(y&&y(ResourceStrings.l_Image),String.format(l.get_alt()?ResourceStrings.l_AccMessageImageAlt:
ResourceStrings.l_AccMessageImage,this.tQ(l),l.get_alt())):null}LJi(l,r,w,y){y=void 0===y?null:y;if(!l||!l.HA)return null;y&&y(ResourceStrings.l_Cameo);return l.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,this.tQ(l),l.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):String.format(ResourceStrings.l_AccMessageCameo,this.tQ(l),ResourceStrings.l_CameoLearnMoreMessage)}BQi(l,r,w,y){y=void 0===y?null:y;if(l){if(0===l.mediaType)return null;if(1===l.mediaType)return y&&y(ResourceStrings.l_Audio),
this.la.NN?String.format(ResourceStrings.l_AccMessageCanvasAudio,l.shapeName):String.format(l.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,this.tQ(l),l.get_alt());if(2===l.mediaType)return y&&y(ResourceStrings.l_Video),String.format(l.get_alt()?ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,this.tQ(l),l.get_alt())}return null}ZJi(l,r,w,y){y=void 0===y?null:y;return l&&l.om?(y&&y(ResourceStrings.l_Chart),String.format(l.get_alt()?ResourceStrings.l_AccMessageChartAlt:
ResourceStrings.l_AccMessageChart,this.$Ji(l)||"",this.tQ(l),l.get_alt())):null}sVi(l,r,w,y){y=void 0===y?null:y;return l&&l.Ce?(y&&y(ResourceStrings.L_GroupObjects),m.a("GroupShapeAltTitleFixEnabled")?String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,l.$t().length,l.get_alt()):String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,this.tQ(l),l.get_alt())):null}oVi(l,r,w,y){y=void 0===y?null:
y;if(l&&w&&l.Vsa&&!l.Uq)if(this.Bxc(l,w),r=this.Ia.OGf(l),l.Qsa&&(r=ResourceStrings.l_DecorativeLabel),y&&y(r||ResourceStrings.l_TextShape),0<w.count)l=String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,r||ResourceStrings.l_TextShape,this.tQ(l),l.get_alt()),w.insert(0,document.createTextNode(l));else return String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,r||ResourceStrings.l_TextShape,
this.tQ(l),l.get_alt());return null}uIi(l,r,w,y){y=void 0===y?null:y;return l&&l.ht&&this.Tc&&this.k0?(l=this.k0.FIa(l),l=this.Tc.mGd(l.id),y&&y(l?l.o9a:null),l?l.o9a:null):null}iIi(l,r,w,y){y=void 0===y?null:y;return l&&l.n3?(y&&y(ResourceStrings.l_3DModel),String.format(l.get_alt()?ResourceStrings.l_AccMessage3DAlt:ResourceStrings.l_AccMessage3D,this.tQ(l),l.get_alt())):null}gHf(l){return l.smartArtInfo?n.fKd(l.smartArtInfo.SmartArtLayout,1,177,"L_SAType"):(c.ULS.sendTraceTag(509092052,815,10,"SmartArt {0}#{1} has no SmartArtInfo",
l.slideId?l.slideId.toString():"",l.get_shapeId()),null)}$Ji(l){return n.fKd(l.chartType,0,102,"L_ChartType")}zwl(l,r){return(l=this.Ia.s8c(l))&&r?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,r,l):null}static exl(l){return n.fKd(l,1,177,"L_SAType")}static fKd(l,r,w,y){return l>=r&&l<=w&&(l=ResourceStrings[y+l])?l:null}}Object(x.a)(n,"AriaMessageHelper",null,[745])},1361:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}Object(x.a)(c,"ProviderActionInfo",null,
[])},1362:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.Label=this.CorrelationId=null;this.ShapeId=this.ReplaceObjectType=0;this.SmartArtSubNodeId=null;this.SuggestionSid=0}}Object(x.a)(c,"ReplaceObjectSuggestionApplyInfo",null,[])},1389:function(x,G,a){a.d(G,"a",function(){return Mb});var c=a(69);x=a(0);var b=a(139),f=a(30),e=a(43),h=a(4),u=a(13),m=a(3),n=a(460),l=a(5),r=a(7),w=a(19),y=a(83),z=a(42),A=a(8),B=a(20),H=a(248),
v=a(250),C=a(296),F=a(894);class D extends Sys.EventArgs{constructor(hb){super();this.clientX=hb.ClientX;this.clientY=hb.ClientY}}Object(x.a)(D,"OnBrowserEventArgs",Sys.EventArgs,[]);class N extends Sys.EventArgs{constructor(hb){super();this.slideId=hb.SlideId;this.slideIndex=hb.SlideIndex;this.NBl=hb.IsBeforeReady;this.sCl=hb.IsFromEndOfSlideshow;this.summary=hb.Summary}}Object(x.a)(N,"OnExitSlideshowEventArgs",Sys.EventArgs,[]);class U extends Sys.EventArgs{constructor(hb){super();this.slideId=
hb.SlideId;this.slideIndex=hb.SlideIndex;this.tfd=hb.TimeLineMappings}}Object(x.a)(U,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[]);class W extends Sys.EventArgs{constructor(hb){super();this.slideHeight=hb.SlideHeight;this.slideWidth=hb.SlideWidth;this.yKk=hb.SlideLeftBound;this.oKk=hb.SlideBottomBound}}Object(x.a)(W,"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[]);class L extends Sys.EventArgs{constructor(hb){super();this.code=hb.Code;this.reason=hb.Reason;this.podSessionId=hb.PodSessionId}}
Object(x.a)(L,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[]);var O=a(1218);class M extends Sys.EventArgs{constructor(hb){super();this.clientX=hb.ClientX;this.clientY=hb.ClientY}}Object(x.a)(M,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[]);class K extends Sys.EventArgs{constructor(hb){super();this.key=hb.Key;this.shiftKey=hb.ShiftKey;this.altKey=hb.AltKey}}Object(x.a)(K,"OnSpecialKeyEventArgs",Sys.EventArgs,[]);var P=a(231);class V extends Sys.EventArgs{constructor(hb){super();this.Uyh=null;
this.Uyh="string"===typeof hb?Object(P.a)(String,hb):hb.TranscriberSessionId}}Object(x.a)(V,"OnTranscriberStartedEventArgs",Sys.EventArgs,[]);class Y extends Sys.EventArgs{constructor(hb){super();this.isVisible=hb.IsVisible}}Object(x.a)(Y,"OnVisibilityChangeEventArgs",Sys.EventArgs,[]);var ta=a(1217),fa=a(40);class Ta{}Ta.speechMode="Subtitles";Ta.Mof=[Ta.speechMode];Ta.sourceLanguage=null;Ta.targetLanguages=null;Ta.speechFDBase=null;Ta.podSessionId=null;Ta.a6g=null;Ta.docId=null;Ta.webServiceBase=
null;Ta.userSessionId=h.AFrameworkApplication.userSessionId;Object(x.a)(Ta,"PPTSpeechClientConfig",null,[]);class ha{constructor(){this.ua=new f.a}onFinalRecognitionText(hb){this.ua.raiseEvent("OnFinalRecognitionText",hb)}onPartialRecognitionText(hb){this.ua.raiseEvent("OnPartialRecognitionText",hb)}onError(hb){this.ua.raiseEvent("OnError",hb)}onSpeechRecognitionStarted(hb){this.ua.raiseEvent("OnSpeechRecognitionStarted",hb)}onEventUpdate(hb){this.ua.raiseEvent("OnEventUpdate",hb)}o0h(hb){this.ua.addHandler("OnFinalRecognitionText",
hb)}nok(hb){this.ua.removeHandler("OnFinalRecognitionText",hb)}z1h(hb){this.ua.addHandler("OnPartialRecognitionText",hb)}dpk(hb){this.ua.removeHandler("OnPartialRecognitionText",hb)}k0h(hb){this.ua.addHandler("OnError",hb)}jok(hb){this.ua.removeHandler("OnError",hb)}Z1h(hb){this.ua.addHandler("OnSpeechRecognitionStarted",hb)}ypk(hb){this.ua.removeHandler("OnSpeechRecognitionStarted",hb)}l0h(hb){this.ua.addHandler("OnEventUpdate",hb)}lok(hb){this.ua.removeHandler("OnEventUpdate",hb)}}Object(x.a)(ha,
"PPTSpeechClientObserverController",null,[]);var qa=a(17);class ra{constructor(){this.accessToken=null}}Object(x.a)(ra,"IAuthenticationProvider",null,[]);class I{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(x.a)(I,"IDocumentDownloadConfig",null,[]);class ba{constructor(){this.documentDownloadConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=
null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(x.a)(ba,"ISpeechConfig",null,[]);class Ga{constructor(hb){this.T1=hb}onFinalText(){}onFragmentText(){}onFinalRecognitionText(hb,Da){this.T1.onFinalRecognitionText(hb,Da)}onPartialRecognitionText(hb,Da){this.T1.onPartialRecognitionText(hb,Da)}onError(hb){if("ErrorNone"!==hb)switch(hb){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.T1.onError("AccessDenied");
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.T1.onError("FailedToConnect");break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.T1.onError("Timeout");break;case "ErrorInitialSilenceTimeout":this.T1.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.T1.onError("UnknownError");
break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.T1.onError("MicrophoneError");break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.T1.onError("NotAllowedError");break;case "ErrorAudioNotFoundError":this.T1.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.T1.onError("NotReadableError");break;default:this.T1.onError("CustomError-"+hb)}}onSpeechRecognitionStarted(hb){qa.ULS.sendTraceTag(507843283,
830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",hb);this.T1.onSpeechRecognitionStarted(hb)}onEventUpdate(hb){this.T1.onEventUpdate(hb)}}Object(x.a)(Ga,"PPTSpeechClientObserver",null,[792]);class Oa{constructor(hb){this.u6=null;this.kAa=0;this.microphoneDeviceId="";this.iPj=new Ga(hb)}Npj(){return 2===this.kAa}icj(){const hb=this.vmf(),Da=Object.assign(new ra,{accessToken:""});this.u6&&0!==this.kAa&&(this.u6.stopSpeechRecognition(),this.kAa=0);this.u6=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(hb,
this.iPj,Da,null,new b.a);return this.u6?!0:(qa.ULS.sendTraceTag(507843219,830,10,"Speech client was not successfully created"),!1)}DWg(){this.u6&&(0===this.kAa?(this.u6.startSpeechRecognition(),this.kAa=2):1===this.kAa&&(this.u6.resumeSpeechRecognition(),this.kAa=2))}HMk(){this.u6&&(this.u6.stopSpeechRecognition(),this.kAa=0)}c6j(){this.u6&&(this.u6.pauseSpeechRecognition(),this.kAa=1)}setCustomSetting(hb,Da){this.u6&&this.u6.setCustomSetting(hb,Da)}vmf(){return Object.assign(new ba,{speechMode:Ta.speechMode,
sourceLanguage:Ta.sourceLanguage,targetLanguages:Ta.targetLanguages,speechFDBase:Ta.speechFDBase,captureAudioPauseResumeRecordingState:!0,clientApp:0,documentDownloadConfig:Object.assign(new I,{docId:Ta.docId,podsSessionId:Ta.podSessionId,userDataCenterClusterId:Ta.a6g,webServiceBase:Ta.webServiceBase}),userSessionId:Ta.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(x.a)(Oa,"PPTSpeechClientProxy",null,[]);var Ja;(function(hb){hb[hb.none=0]="none";hb[hb.singleLineRibbon=1]="singleLineRibbon";
hb[hb.multipleLineRibbon=2]="multipleLineRibbon";hb[hb.slideShowToolbar=3]="slideShowToolbar";hb[hb.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";hb[hb.liveBroadcast=5]="liveBroadcast"})(Ja||(Ja={}));Object(x.b)("TranscriptionEntryPoint",Ja);var Qa=a(1124),Pa=a(283),ja=a(284);class va{constructor(){this.Gf=this.v6=this.vB=this.R3a=this.Mq=this.vd=this.la=this.Ud=this.qf=null;this.Dob=!1;this.Su=null;this.Z3a=this.kbd=0;this.g9f=!1;this.nAa=this.mAa="";this.hGc=!1;this.N7d="";this.FYd=0;
this.PGc=this.ota=this.HMc="";this.e1=null;this.xpa={};this.xha=new ha;this.o6=new Oa(this.xha);va.lcj()}init(hb,Da,Bb,Za,mb,vb,sb){H.a.J(512495707,830,50,"SlideshowSubtitles.Init");this.Gf=Da;this.la=hb;this.qf=Bb;this.vd=Za;this.Su=mb;this.Ud=vb;this.e1=sb;this.Mq=document.createElement("div");this.Mq.id="SubtitleContainer";this.Mq.className="SubtitleContainer";this.Mq.style.display=Pa.a.Sf;this.Mq.style.visibility=Pa.a.ms;this.R3a=document.createElement("div");this.R3a.id="SubtitleResultDiv";this.R3a.className=
"SubtitleResultDiv";this.qf.crl&&(this.R3a.style.direction="rtl");this.vB=document.createElement("span");this.vB.id="SubtitleResultSpan";this.vB.className="SubtitleResultSpan";this.vB.setAttribute("aria-hidden","true");this.v6=document.createElement("span");this.v6.id="SubtitleAccessibilitySpan";this.v6.className="SubtitleAccessibilitySpan";this.v6.innerText="";this.v6.setAttribute("lang",this.qf.g8a);this.v6.setAttribute("aria-live","assertive");this.v6.setAttribute("aria-label",ResourceStrings.L_SubtitleAccessibilityWindow);
this.v6.setAttribute("aria-atomic","true");this.R3a.appendChild(this.vB);this.R3a.appendChild(this.v6);this.Mq.appendChild(this.R3a);this.Gf.appendChild(this.Mq);n.a.instance.Zb(this.vB,()=>!1);h.AFrameworkApplication.ga.p3?this.su():h.AFrameworkApplication.ga.fg(Object(fa.a)(this,this.su,"onFullAppSettingsReady"))}su(){this.HMc=this.getUserId();this.ota=h.AFrameworkApplication.ga.La("TenantId");this.PGc=this.la.hostAuthType||h.AFrameworkApplication.ga.La("HostAuthType")||"Unknown"}getUserId(){let hb=
h.AFrameworkApplication.ga.La("PptEditingUserId");l.a.rb(hb)&&(hb=h.AFrameworkApplication.ga.La("LoggableUserId"),H.a.J(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",l.a.rb(hb)));return hb}Unk(){this.Mq.style.display=Pa.a.Sf;this.Mq.style.visibility=Pa.a.ms}iRa(hb,Da,Bb,Za,mb,vb){this.kmb()&&(this.Su.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,Qa.a.z$d),this.kbd=window.setTimeout(Object(fa.a)(this,this.vMf,"hideSoundReminderNotification"),
3E3));this.uYk(Da,Bb,Za,this.qf);this.o6&&(this.o6.microphoneDeviceId=this.e1.microphoneDeviceId);this.qf.Ks&&this.o6.icj()?(this.xpa.StartTime=vb,this.xpa.LastError="ErrorNone",this.xpa.EntryPoint=Ja[mb],this.xha.o0h(Object(fa.a)(this,this.xxg,"onFinalRecognitionTextHandler")),this.xha.z1h(Object(fa.a)(this,this.Byg,"onPartialRecognitionTextHandler")),this.xha.k0h(Object(fa.a)(this,this.Izg,"onSpeechProxyErrorHandler")),this.xha.l0h(Object(fa.a)(this,this.Jzg,"onSpeechProxyEventUpdateHandler")),
this.xha.Z1h(Object(fa.a)(this,this.Kzg,"onSpeechRecognitionStartedHandler")),this.o6.DWg(),this.o6.setCustomSetting("clientMetadata",JSON.stringify(this.RBf())),this.vB.innerText="["+ResourceStrings.L_SubtitleInitMessage+"]",this.vB.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==mb),this.iud(),this.vd.oaf(Object(fa.a)(this,this.$0b,"onGetCurrentSlideDimensionsHandler")),this.vd.$9b(Object(fa.a)(this,this.Ybe,"onSlideChangedHandler"))):this.WWg()}RBf(hb){hb=void 0===hb?"":hb;const Da=
B.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString()),Bb={};Bb.userID=this.HMc;Bb.tenantId=this.ota;Bb.identityProvider=this.PGc;Bb.audienceChannel="";Bb.audienceGroup=Da.Ring||"Unknown";Bb.buildVersion=h.AFrameworkApplication.buildVersion||"Unknown";Bb.locale=this.la.Bsb||"Unknown";Bb.wacHost=Da.Host||"Unknown";Bb.wacDatacenter=Da.WACDatacenter||"Unknown";Bb.livePragueSessionInfo=hb;return Bb}WWg(){this.Mq?(this.Mq.style.display=Pa.a.Sf,this.Mq.style.visibility=Pa.a.ms,this.o6.HMk(),
this.xha.nok(Object(fa.a)(this,this.xxg,"onFinalRecognitionTextHandler")),this.xha.dpk(Object(fa.a)(this,this.Byg,"onPartialRecognitionTextHandler")),this.xha.jok(Object(fa.a)(this,this.Izg,"onSpeechProxyErrorHandler")),this.xha.lok(Object(fa.a)(this,this.Jzg,"onSpeechProxyEventUpdateHandler")),this.xha.ypk(Object(fa.a)(this,this.Kzg,"onSpeechRecognitionStartedHandler")),this.vd.FKg(Object(fa.a)(this,this.$0b,"onGetCurrentSlideDimensionsHandler")),this.vd.OUc(Object(fa.a)(this,this.Ybe,"onSlideChangedHandler")),
this.kmb()&&this.Su.instance.hide(),this.xpa.EndTime=Date.now(),H.a.J(512495705,817,15,JSON.stringify(this.xpa,va.AVk)),this.xpa={},this.qf.PBe=!1):H.a.J(508063889,817,50,"SlideshowSubtitles::stopTranscribe SubtitleContainer is null")}iud(){let hb=3;this.xpa.LastPosition=this.qf.z2;"AboveSlide"===this.qf.z2&&this.Mq.style.visibility===Pa.a.Cw?(this.Mq.style.display=Pa.a.r_,this.Mq.style.backgroundColor="black",this.Mq.style.bottom="auto"):"BelowSlide"===this.qf.z2&&this.Mq.style.visibility===Pa.a.Cw?
(this.Mq.style.display=Pa.a.r_,this.Mq.style.backgroundColor="black",this.Mq.style.bottom="3%",hb=-1):"TopOverlay"===this.qf.z2?(this.Mq.style.display=Pa.a.r_,this.Mq.style.backgroundColor="transparent",this.Mq.style.bottom="auto",hb=5):"BottomOverlay"===this.qf.z2&&(this.Mq.style.display=Pa.a.r_,this.Mq.style.backgroundColor="transparent",this.Mq.style.bottom="5%",hb=-1);this.Dob&&document.getElementById("LiveURLBarLayerHost")?this.Mq.style.top=-1<hb?String.format("calc({0}% + {1})",hb.toString(),
"26px"):"auto":(this.Mq.style.top=-1<hb?hb.toString()+"%":"auto",this.bbf())}isVisible(){return this.Mq.style.visibility===Pa.a.Cw}LRk(hb,Da){Da=void 0===Da?"":Da;Ta.Mof=hb?["Live","Subtitles"]:["Subtitles"];this.Dob=hb;this.setVisibility(this.Mq.style.visibility===Pa.a.Cw);this.iud();this.o6.setCustomSetting("clientMetadata",JSON.stringify(this.RBf(Da)));this.o6.setCustomSetting("slideIndex",this.FYd);this.o6.setCustomSetting("currentSpeechModes",JSON.stringify(Ta.Mof))}qwb(hb){this.Mq.style.cursor=
hb?"default":"none"}bbf(){this.vB.style.fontSize=Math.floor(this.Mq.clientHeight/2/1.5).toString()+"px";this.N7d=Math.floor(this.Mq.clientHeight/12-2)+"px";this.vB.style.display="inline"}setVisibility(hb){this.Mq?(null===hb&&(hb=this.Mq.style.visibility===Pa.a.ms),this.Mq.style.visibility=hb?Pa.a.Cw:Pa.a.ms):H.a.J(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}$0b(){this.bbf()}Ybe(hb,Da){this.FYd=Da.slideIndex;this.o6.Npj()&&this.Dob&&(this.o6.setCustomSetting("currentSlideIndex",
this.FYd),H.a.J(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}OMe(hb){hb?(this.o6.c6j(),this.k5b(),this.hGc=!0,this.Ud&&this.Ud.instance&&this.Ud.instance.C2l()):(this.o6.DWg(),this.Ud&&this.Ud.instance&&this.Ud.instance.D2l())}vMf(){this.kmb()&&(window.clearTimeout(this.kbd),this.Su.instance.hide())}uYk(hb,Da,Bb,Za){Ta.sourceLanguage=Za.Ybb;Ta.targetLanguages=Za.Sec;Ta.podSessionId=hb;Ta.a6g=Da;Ta.docId=Bb;Ta.webServiceBase=this.la.$l;Ta.speechFDBase=
h.AFrameworkApplication.ga.La(ja.a.wCb);hb=!!this.Ud&&!!this.Ud.instance&&(this.Ud.instance.Rtc||this.Ud.instance.PK);Ta.speechMode=this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&this.Ud.instance.oac||hb?"Live":"Subtitles"}qrf(hb,Da){this.g9f||(this.vB.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.Z3a),this.vB.innerText=this.EYi(hb,Da),this.vB.scrollTop=this.vB.scrollHeight,this.Z3a=window.setTimeout(Object(fa.a)(this,this.k5b,"resetSubtitlesToEmpty"),1E4),Da&&(this.v6.innerText=
hb,this.v6.focus()),this.vB.style.padding=l.a.rb(hb)?"0px":this.N7d)}PB(hb){this.g9f||(this.vB.style.color="rgba( 255, 255, 0, 1 )",l.a.rb(hb)&&(hb=ResourceStrings.L_SubtitleGenericErrorMessage),window.clearTimeout(this.Z3a),this.vB.innerText="["+hb+"]",this.vB.scrollTop=this.vB.scrollHeight,this.Z3a=window.setTimeout(Object(fa.a)(this,this.k5b,"resetSubtitlesToEmpty"),1E4),this.vB.style.padding=this.N7d,this.v6.innerText="",this.v6.focus())}K5i(hb){if(null!==hb)switch(hb){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.PB(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);
this.xpa.LastError="MicrophoneError";break;case "FailedToConnect":this.PB(ResourceStrings.L_SubtitleRetryErrorMessage);this.xpa.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.PB(ResourceStrings.L_SubtitleGenericErrorMessage);this.xpa.LastError="FailedToCreateSpeechSession";break;default:H.a.J(512495703,830,15,"HandleSpeechProxyError {0}",hb)}}xxg(hb,Da){this.Mq.style.visibility!==Pa.a.ms&&this.qrf(Da[this.qf.Sec],!0)}Byg(hb,Da){this.Mq.style.visibility!==
Pa.a.ms&&this.qrf(Da[this.qf.Sec],!1)}Izg(hb,Da){H.a.J(512495702,830,10,"OnSpeechProxyErrorHandler {0}",Da);(hb=Da.toString())&&(-1<hb.indexOf("NotAllowedError")||-1<hb.indexOf("NotFoundError")||-1<hb.indexOf("NotReadableError")||-1<hb.indexOf("MicrophoneError"))&&this.kmb()&&this.Su.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,Qa.a.VBb);this.K5i(hb)}Kzg(hb,Da){H.a.J(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",Da.toString());this.vd.n2j(Da.toString());this.k5b();this.kmb()&&
this.Su.instance.hide()}Jzg(hb,Da){if(this.kmb())switch(hb=Da.eventName,hb){case "MediaEvent":"AudioDeviceConnected"===Da.mediaStatus&&this.Su.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,Qa.a.z$d);break;case "ConnectionRetry":this.Su.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,Qa.a.VBb);this.PB(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const Bb=Da.shortCode;hb=Da.longCode;const Za=Da.shortString,mb=Da.longString;switch(Da.severity){case 0:this.Su.instance.hide();
break;case 1:(Da=0<Bb?va.uba[Bb]:Za)&&this.Su.instance.show(Da,Qa.a.Ibd);break;case 2:(Da=0<Bb?va.uba[Bb]:Za)&&this.Su.instance.show(Da,Qa.a.VBb),Da=null===hb?mb:va.uba[hb],l.a.rb(Da)||(window.clearTimeout(this.Z3a),this.PB(Da),this.Z3a=window.setTimeout(Object(fa.a)(this,this.k5b,"resetSubtitlesToEmpty"),3E4))}break;default:H.a.J(512495700,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",hb)}}kmb(){return this.la.nBa&&!!this.Su&&!!this.Su.instance}k5b(){this.vB.style.color="rgba( 255, 255, 255, 1 )";
this.vB.innerText="";this.vB.scrollTop=this.vB.scrollHeight;this.nAa=this.mAa="";this.hGc=!1;this.Z3a=0;this.vB.style.padding="0px"}EYi(hb,Da){this.hGc?this.U3h(hb):this.vqk(hb);this.hGc=Da;return l.a.rb(this.mAa)||l.a.rb(this.nAa)?l.a.rb(this.mAa)?this.nAa:this.mAa:this.mAa+"\n"+this.nAa}U3h(hb){this.mAa=l.a.rb(this.nAa)?this.mAa:this.nAa;this.nAa=hb}vqk(hb){l.a.rb(this.mAa)||l.a.rb(this.nAa)?this.mAa=hb:this.nAa=hb}static get instance(){return va.St}static lcj(){va.uba[1]=ResourceStrings.L_SubtitleDetection_Listening;
va.uba[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;va.uba[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;va.uba[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;va.uba[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static AVk(hb,Da){return"undefined"===typeof Da?null:Da}}va.uba=Array(20);va.St=new va;Object(x.a)(va,"SlideshowSubtitles",null,[778]);var Ha=a(1216),gb=a(254),Gb=a(278);class Mb{constructor(hb,Da,Bb,Za,mb,vb,sb,bc,yb,uc,vc,wc,ub,aa,Na,
ia,wa,pa,Ea,La,Aa){this.Gg=this.lM=this.Ipb=null;this.tG=new b.a;this.ua=new f.a;this.ycc="";this.so=null;this.LBb="";this.Oab=this.c7f=this.e_b=this.iA=this.t6=this.s6=this.IWb=this.$=null;this.f_b=!0;this.rY=Date.now();this.uU=Date.now();this.Xga=this.V6d=this.spg=0;this.JWd=this.Dob=!1;this.Naa=new Set;this.g3d=this.d6=!1;this.sJc=0;this.Nab=null;this.b4a=void 0;this.v7d=0;this.n7d={};this.N4d=0;this.iAa=this.tVb=this.rVb=!1;this.kog={};this.lka=!1;this.cyg=(nb,Wa)=>{this.f0j(Wa)};this.IZj=()=>
{H.a.J(512309270,830,50,`SlideShowCoreFrame::OnEditHappened,, Edit time elapsed between two edits:${Date.now()-this.uU} `);this.uU=Date.now();this.sJc++};this.X_j=(nb,Wa)=>{var ea;H.a.J(512309269,830,50,"SlideShowCoreFrame::OnLastMergeEditUTCChangedHandler");this.uU=Date.now();this.rVb=!0;this.iAa&&this.Qaa.JOe();this.la.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&(this.la.getBooleanAppSetting("CoauthEditSlideInfoEnabled")?(null===Wa||void 0===Wa?0:Wa.isPresentationChange)?this.g3d=
!0:0<(null===(ea=null===Wa||void 0===Wa?void 0:Wa.LK)||void 0===ea?void 0:ea.length)&&Wa.LK.forEach(Kb=>{Kb=JSON.stringify({Sid:Kb.Sid,Cid:Kb.Cid});this.Naa.has(Kb)||this.Naa.add(Kb)}):this.d6=!0)};this.a1j=(nb,Wa)=>{var ea;H.a.J(512309268,830,50,"SlideShowCoreFrame::OnRealTimeEditHandler");this.uU=Date.now();this.tVb=!0;this.iAa&&this.Qaa.JOe();this.la.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&(this.la.getBooleanAppSetting("CoauthEditSlideInfoEnabled")?0<(null===(ea=null===
Wa||void 0===Wa?void 0:Wa.LK)||void 0===ea?void 0:ea.length)&&Wa.LK.forEach(Kb=>{Kb=JSON.stringify({Sid:Kb.Sid,Cid:Kb.Cid});this.Naa.has(Kb)||this.Naa.add(Kb)}):this.d6=!0)};this.Q1j=(nb,Wa)=>{var ea;this.V6d=Date.now();H.a.J(507799770,830,50,"SlideShowCoreFrame::onSlideEditHandler");this.iAa&&this.Qaa.nzh(Wa.LK.map(Kb=>new Gb.a(Kb)),this.eL);this.d6||((null===Wa||void 0===Wa?0:Wa.isPresentationChange)?(H.a.J(507799769,830,15,"SlideShowCoreFrame::onSlideEditHandler SlideShow cache flushed by this edit"),
this.d6=!0):0<(null===(ea=null===Wa||void 0===Wa?void 0:Wa.LK)||void 0===ea?void 0:ea.length)&&Wa.LK.forEach(Kb=>{Kb=JSON.stringify({Sid:Kb.Sid,Cid:Kb.Cid});this.Naa.has(Kb)||this.Naa.add(Kb)}))};this.fhf=(nb,Wa)=>{var ea,Kb;"Error"==Wa&&this.ua.raiseEvent("OnCameraErrorEventId");this.M3a&&(window.clearTimeout(this.M3a),this.M3a=void 0);nb=this.mui(nb);null===(Kb=null===(ea=this.d_b)||void 0===ea?void 0:ea.instance)||void 0===Kb?void 0:Kb.show(nb,Wa);this.M3a=window.setTimeout(()=>{var kc,ac;null===
(ac=null===(kc=this.d_b)||void 0===kc?void 0:kc.instance)||void 0===ac?void 0:ac.hide();this.M3a=void 0},3E3)};this.Ckk=nb=>{Object(c.b)(this,void 0,void 0,function*(){if(this.B$c){var Wa=(new Date).getTime();try{const ea=yield this.B$c.qN("Hubble",nb);ea.IsSuccess?this.Gg.setAadToken(ea.Token):this.Gg.setAadToken("");H.a.J(508949124,830,50,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: ${ea.IsSuccess} time: ${(new Date).getTime()-Wa}`)}catch(ea){H.a.J(508949123,
830,10,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: false time: ${(new Date).getTime()-Wa} error: ${ea}`),this.Gg.setAadToken("")}}else H.a.J(508949125,830,10,"SlideShowCoreFrame::Refresh token requested without IOAuthManager. Setting AAD token as empty for SlideShow."),this.Gg.setAadToken("")})};this.Gf=hb;this.la=Da;this.qf=Bb;this.sGe=Za;this.Su=mb;this.d_b=pa;this.Ud=vb;this.e1=bc;this.dN=sb;this.pta=yb;this.rf=uc;this.mU=vc;this.Dh=wc;this.eL=ub;this.$p=
aa;this.xcc=Na;this.Ub=ia;this.Qaa=Aa;if(this.la.getBooleanAppSetting("SlideShowGetPresInfoFromClient")){if(!wa)throw"PresInfo client not present";this.Dlg=wa}this.lpg=La;this.iAa=this.la.getBooleanAppSetting("SnapUrlUpdateAfterEditEnabled");Ea&&(this.Nab=Ea);this.$Pj=e.a.getInstance();this.mU&&this.mU.execute(nb=>{nb.Dva(this.IZj)});if(!this.Ub)throw Error.argumentNull("presReader");this.xcc.Pah(this.cyg);this.Dh&&(this.Dh.Z9b(this.X_j),this.Dh.b$b(this.a1j),this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",
!1)&&this.Dh.V1h(this.Q1j));if(this.la.isAnimationPreviewEnabled)this.Ex=this.Nab.getSettings(),this.pta=this.Nab.pta;else try{const nb=this.Ex=JSON.parse(this.la.La("Settings"))||{};nb.slideshowcore||(nb.slideshowcore={});nb.slideshowcore&&nb.slideshowcore.forceSvg&&"true"===nb.slideshowcore.forceSvg.toString().toLowerCase()?this.pta=!0:this.pta&&(nb.slideshowcore.forceSvg="True");nb.slideshowcore.enableCameoInPPTOSlideShow=this.la.tX.toString()}catch(nb){H.a.J(512495906,830,10,"SlideShowCoreFrame::Exception in parsing settings:{0}",
nb),this.Ex={}}this.kog=B.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString())}tpj(hb){return null==hb||v.a("CacheRetentionExperimentReversedCommands")&&-1<(this.la.La("CacheRetentionExperimentReversedCommands")||"").indexOf(hb+";")?!1:Ha.a.includes(hb)?!0:v.a("CacheRetentionExpCommandsFromBRS")?-1<(this.la.La("CacheRetentionExperimentCommands")||"").indexOf(hb.toString()+";"):!1}f0j(hb){var Da;Object(c.b)(this,void 0,void 0,function*(){if(!this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",
!1)&&hb.actionId!==gb.a.Wja&&(this.iAa&&this.Qaa.nzh(null===hb||void 0===hb?void 0:hb.LK,this.eL),this.la.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled"))){var Bb=this.Ub.XZ(null===(Da=null===hb||void 0===hb?void 0:hb.LK[0])||void 0===Da?void 0:Da.sid);Bb=null===Bb||void 0===Bb?void 0:Bb.slideIndex;H.a.J(508297357,830,50,`SlideShow:: Edit Command triggered  ::${hb.actionId}, SlideIndex Edited:: ${Bb},Edit time elaplsed between two edits:${Date.now()-this.uU}`);hb&&hb.LK&&1==hb.LK.length&&
this.tpj(null===hb||void 0===hb?void 0:hb.actionId)&&!this.d6?(Bb=JSON.stringify({Sid:hb.LK[0].sid,Cid:hb.LK[0].cid}),this.Naa.has(Bb)||(this.Naa.add(Bb),this.n7d[this.$Gf(hb.LK[0].sid,hb.LK[0].cid)]=hb.actionId)):!this.d6&&v.a("TelemetryForSSCacheFlushCommand")&&(H.a.J(508063836,830,15,`SlideShowCoreFrame::onMarkedUndoWithSlidesAsync SlideShow cache flushed by this edit. Command triggered::${hb.actionId}, SlideIndex Edited:: ${Bb}`),this.d6=!0,this.N4d=hb.actionId)}})}preloadShaders(){this.YXc();
this.w6b();SlideShowCore.SlideShowCore.preloadShaders()}init(hb,Da,Bb,Za){return Object(c.b)(this,void 0,void 0,function*(){this.ycc=Bb;this.eL=Za;this.LBb=Da;if(this.so)H.a.J(509636752,830,50,"SlideShowCoreFrame::init - initPromise {0}",this.LMa),yield this.LMa;else{this.IWb=document.getElementById("HiddenFocusTrapAnchor");this.so=document.createElement("div");this.so.id="SlideShowBackground";this.so.className="SlideShowBackground";this.so.style.visibility=Pa.a.ms;this.so.tabIndex=-1;this.$=document.createElement("div");
this.$.id="SlideShowContainer";this.$.className="SlideShowContainer";this.$.tabIndex=-1;this.$.style.width=window.screen.width+"px";this.$.style.height=window.screen.height+"px";u.a.addHandler(this.so,m.a.XEa,sb=>{this.q0j(sb)});n.a.instance.Zb(this.so,sb=>this.hPc(sb));this.so.appendChild(this.$);this.IWb?this.Gf.insertBefore(this.so,this.IWb):this.Gf.appendChild(this.so);var mb=this.la.La("pptSlideShowCoreCssUrl"),vb=document.createElement("link");vb.setAttribute("rel","stylesheet");vb.setAttribute("type",
"text/css");vb.setAttribute("href",mb);this.$.appendChild(vb);va.instance.init(this.la,this.so,this.qf,this,this.Su,this.Ud,this.e1);this.s6=document.getElementById("slideshowBeginningFocusTrap");this.t6=document.getElementById("slideshowEndFocusTrap");this.s6||this.t6||(this.s6=document.createElement("div"),this.s6.id="slideshowBeginningFocusTrap",this.s6.className="FocusTrap",this.s6.tabIndex=0,u.a.addHandler(this.s6,m.a.focus,()=>{this.Bzg()}),this.t6=document.createElement("div"),this.t6.id="slideshowEndFocusTrap",
this.t6.className="FocusTrap",this.t6.tabIndex=0,u.a.addHandler(this.t6,m.a.focus,()=>{this.Bzg()}),this.IWb?(this.Gf.insertBefore(this.s6,this.Gf.firstChild),this.Gf.insertBefore(this.t6,this.IWb.nextSibling)):(mb=document.getElementById("slideshow-toolbar"),this.Gf.insertBefore(this.s6,this.so),this.Gf.insertBefore(this.t6,mb)));this.la.getBooleanAppSetting("IsSnapUrlFetchedEarlyOnBootEnabled")&&this.lpg?(mb=yield this.lpg.sWi())&&!l.a.rb(mb.fsf)?(this.iA=mb.fsf,this.lka=mb.uMe,this.rY=Date.now(),
yield this.GNd()):(this.LMa=this.sKd(1),yield this.LMa):(this.LMa=this.sKd(1),yield this.LMa)}})}Ogj(){return this.rVb||this.tVb}sKd(hb){return Object(c.b)(this,void 0,void 0,function*(){let Da=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.$l,this.eL);if(v.a("AddCallerQueryParam")){const mb=this.la.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");Da+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${mb}`}const Bb={"Content-Type":"application/json; charset=utf-8",
WaitForSessionTimeoutMs:"0"};Bb["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;const Za=new Date;return new Promise((mb,vb)=>{this.$p.rk(Da,1,"",Bb,!1,0,sb=>Object(c.b)(this,void 0,void 0,function*(){yield this.b1b(sb,Za);H.a.J(509636751,830,15,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlSucceeded");mb()}),sb=>Object(c.b)(this,void 0,void 0,function*(){yield this.a1b(sb,hb);H.a.J(509636750,830,10,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlFailed");vb()}),null,null)})})}b1b(hb,
Da){return Object(c.b)(this,void 0,void 0,function*(){H.a.J(512309283,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+Da);const Bb=JSON.parse(hb.data.responseData);this.iA=Bb.downloadUrl;void 0!==Bb.sendGetItemsRequestToPFD&&(this.lka=Bb.sendGetItemsRequestToPFD);l.a.rb(this.iA)?H.a.J(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",Bb):(this.rY=Date.now(),yield this.GNd())})}zJd(){const hb={};hb.settings=
this.Ex;hb.retryCount=this.la.Jc("GetItemsRetryCount",3);hb.retryOnCategories=this.la.La("GetItemsRetryCategories").split(";");const Da={};Da.Slide=ResourceStrings.l_Slide;Da.AnimNum=ResourceStrings.l_AccSsAnimNum;Da.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;Da.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;Da.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;Da.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;hb.localizedStrings=Da;return hb}GNd(){return Object(c.b)(this,
void 0,void 0,function*(){this.YXc();this.w6b();v.a("UseNewPodsProxyConstructor")?this.XNf():this.Ipb=new PodsProxy.PodsProxy(this.la.Gsa?this.la.n$a:this.la.$l,{DownloadUrl:this.iA,DocID:h.AFrameworkApplication.ui,CustomFontCatalogUrl:this.la.La("CustomFontCatalogURL")},this.la.e_?l.a.vI(this.la.e_).toLowerCase():"",this.tG,this.Fjb(),this.Gjb());this.lM=new SlideShowCore.DefaultResourceProviders(this.Ipb,this.tG,this.zJd());const hb={};hb.initTime=Mb.gS();hb.uiHost="Unified App";hb.serverUrl=l.a.Sj(this.la.$l);
hb.userSessionId=this.ycc;hb.jsScriptsBasePath=this.la.La("StaticContentHost")+"pptscripts/ssapp/";hb.fileHost=this.la.La("FileHost");hb.isRtl=h.AFrameworkApplication.isRtl;hb.applicationLcid=h.AFrameworkApplication.lcid;hb.applicationLocaleName=h.AFrameworkApplication.uiCulture;hb.areThirdPartyAddInsAllowed=h.AFrameworkApplication.uSa;hb.theWsaClient=h.AFrameworkApplication.Hl;hb.appForOfficeContextActivationParameters=F.a.UCe(this.rf);hb.hubbleVideoEndpoint=this.la.LAb;hb.acceptLanguage=h.AFrameworkApplication.uiCulture;
hb.appForOfficeAuthFactory=new ta.a;const Da={};Da.settings=this.Ex;Da.transitionResourceCDNPath=this.la.geh;Da.transitionDisabledList=this.la.kRa;Da.clickTargetEnabled=!0;Da.mediaEnabled=!0;Da.gifEnabled=!0;Da.convertGifToVideo=!0;Da.crossSlideAudioEnabled=!0;Da.editAudioEnabled=this.la.getBooleanAppSetting("PPTOAudioPlaybackOptionsEnabled");Da.flipgridVideoEnabled=this.la.getBooleanAppSetting("PptModernSlideShowFlipgridVideoEnabled");Da.useNewYoutubePlayer=!0;Da.useNewVimeoPlayer=!0;Da.useOnlineVideoPlayer=
!0;Da.tedVideoEnabled=this.la.getBooleanAppSetting("PptModernSlideShowTEDVideoEnabled");Da.isStream2Enabled=!0;Da.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;Da.enableSVGAsWebGLTexture=!r.a.zg&&this.la.getBooleanAppSetting("SlideShowShapeBuilderSVGEnabled");Da.maxSvgTextureSize=this.la.Jc("ShapeBuilderMaxSvgTextureSize",2048);Da.enableSlideSizeAdjust=this.la.getBooleanAppSetting("EnableSlideSizeAdjust");Da.slideSizeMax={["x"]:this.la.Jc("SlideShowMaxWidth",1504),["y"]:this.la.Jc("SlideShowMaxHeight",
849)};Da.slideSizeMin={["x"]:this.la.Jc("SlideShowMinWidth",348),["y"]:this.la.Jc("SlideShowMinHeight",261)};Da.slideSizeDefault={["x"]:this.la.Jc("SlideShowDefaultWidth",1504),["y"]:this.la.Jc("SlideShowDefaultHeight",849)};Da.streamVideoUseThinEmbed=this.la.getBooleanAppSetting("StreamVideoUseThinEmbed");Da.slideMetadataEnabled=this.la.getBooleanAppSetting("PptModernSlideShowSlideMetadataEnabled");Da.disabledChangeGates=this.la.La("PPTDisabledChangeGates");Da.isMultiSlideshowcoreEnabled=this.la.getBooleanAppSetting("MultiSlideshowcoreEnabled");
Da.combineBootRequest=!0;Da.localVideoTelemetryEnabled=this.la.getBooleanAppSetting("IsGFXVideoLocalTelemetryEnabled");Da.imageSettings={["imageAppendOption"]:"all"};Da.SlideShowCacheRetentionExperimentEnabled=this.la.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled");Da.usePresInfoFromClient=this.la.getBooleanAppSetting("SlideShowGetPresInfoFromClient");const Bb={};v.a("addFlightToSSC")&&(Bb.verifyGlyphAsynchronously=h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.verifyGlyphAsynchronously",
!1));const Za={["slideShowCoreSettings"]:Da,["appSettings"]:hb};v.a("addFlightToSSC")&&(Za.flights=Bb);v.a("AddInstanceSourceIdentifier")?this.Gg=new SlideShowCore.SlideShowCore(this.$,this.lM,this.tG,Za,1):this.Gg=new SlideShowCore.SlideShowCore(this.$,this.lM,this.tG,Za);new SlideShowCore.PrefetchAddon(this.Gg,this.tG,{["forwardPrefechCount"]:this.la.Jc("PptModernSlideShowForwardPrefetchCount",10),["backwardPrefechCount"]:this.la.Jc("PptModernSlideShowBackwardPrefetchCount",5),["forwardPrerenderCount"]:this.la.Jc("PptModernSlideShowForwardPrerenderCount",
2),["backwardPrerenderCount"]:this.la.Jc("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.Gg,this.tG);this.spg=Date.now();this.Oab=this.Gg.init();this.Gg.events.on("slideLocationChanged",()=>{this.Xbd()});this.Gg.events.on("animationStateChanged",()=>{this.Xbd()});this.Gg.events.on("slideDimensionsChanged",()=>{this.xCe()});this.Gg.events.on("exitFromEndOfShow",()=>{this.kxg(!0)});this.Gg.events.on("blankSlideStateChanged",mb=>{this.SYj(mb)});this.Gg.events.on("slideshowError",
mb=>{this.HIe(mb)});this.la.getBooleanAppSetting("IsStream2VideoEnabled")&&(this.B$c=w.a.instance.resolve("Common.App.OAuth.IOAuthManager"),this.Gg.events.on("aadTokenRequest",mb=>{this.Ckk(mb)}));return new Promise(mb=>Object(c.b)(this,void 0,void 0,function*(){yield this.Oab;this.f_b=!1;this.c7f=new SlideShowCore.InputsAddon(this.Gg,this.$,h.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.Gg,Za,this.tG);new SlideShowCore.TransitionLoggerAddon(this.Gg,Za,this.tG);new SlideShowCore.PerfCheckerAddon(this.Gg,
Za,this.tG);this.e_b=new SlideShowCore.SlideShowInkAddon(this.Gg,this.tG,this.$,()=>this.sGe.loadScript("slideshowink"),{["telemetryLogger"]:this.$Pj});this.la.tX&&(this.c_b=new SlideShowCore.CameoWebcamAddon(this.Gg,{notificationCallback:this.fhf}));this.c7f.events.on("keydown",vb=>{this.f1b(vb)});H.a.J(509636749,830,15,"SlideShowCoreFrame - initSlideShowCore Finshed Initializing");mb()}))})}Gjb(){const hb={};hb.timeout=this.la.Jc("PptModernSlideShowGetItemsTimeoutMs",3E4);hb.throwHttpErrors=!1;
hb.enableServerSpecificErrorCode=v.a("SSCore.EnableServerSpecificErrorCode");hb.pptoPresentFrontDoorEnabled=this.PSd();return hb}w6b(){try{const hb=this.Ex;if(hb.slideshowcore){const Da={};Da.settings=hb;Da.logger=this.tG;Da.disabledChangeGates=this.la.La("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(Da)}}catch(hb){H.a.J(509703488,830,10,"SlideShowCoreFrame::Exception in passing settings to slideshowcore:{0}",hb)}}YXc(){try{const hb=this.Ex;if(hb.podsproxy){const Da={};
Da.settings=hb;window.PodsProxy.setupGlobals_PodsProxy(Da)}}catch(hb){H.a.J(512309267,830,10,"SlideShowCoreFrame::Exception in passing settings to podsproxy:{0}",hb)}}Aue(hb,Da,Bb){return Object(c.b)(this,void 0,void 0,function*(){this.YXc();this.w6b();if(this.Gg){v.a("UseNewPodsProxyConstructor")?this.XNf():this.Ipb=new PodsProxy.PodsProxy(this.la.Gsa?this.la.n$a:this.la.$l,{DownloadUrl:this.iA,DocID:h.AFrameworkApplication.ui,CustomFontCatalogUrl:this.la.La("CustomFontCatalogURL")},this.la.e_?l.a.vI(this.la.e_).toLowerCase():
"",this.tG,this.Fjb(),this.Gjb());var Za=this.lM;this.lM=new SlideShowCore.DefaultResourceProviders(this.Ipb,this.tG,this.zJd());var mb=this.x7d;v.a("RockyV2NavigationFix")&&Bb&&mb<this.Ub.hl()-1&&mb++;if(v.a("UpdateSlideShowCoreRefractoringEnabled")){let vb=!1;if(this.la.getBooleanAppSetting("SlideShowGetPresInfoFromClient")&&Za&&(!v.a("DisabledPresInfoClientInCoauth")||!this.Ogj())){const sb=Za.presInfo.getLoadResultInCache("");(null===sb||void 0===sb?0:sb.resource)&&this.Dlg&&(sb.resource=this.Dlg.$vl(sb.resource),
null===sb||void 0===sb?0:sb.resource)&&(this.lM.presInfo.add(sb),vb=!0)}mb={shouldRerenderSlide:!0,startSlideIndex:this.E5()?mb:this.x7d,isCacheRetentionEnabled:this.E5(),updateSlideShowCoreAfterLaunch:this.E5()&&Bb,isPresInfoFromClient:vb};yield this.Gg.updateResourceProviders(this.lM,mb)}else this.E5()?yield this.Gg.updateResourceProviders(this.lM,{shouldRerenderSlide:!0,updateSlideShowCoreAfterLaunch:Bb,startSlideIndex:mb,isCacheRetentionEnabled:this.E5()}):yield this.Gg.updateResourceProviders(this.lM,
{shouldRerenderSlide:!0,startSlideIndex:this.x7d,isCacheRetentionEnabled:this.E5()});Za&&Za.dispose();H.a.J(508162582,830,50,`SlideShowCoreFrame::Number of edits happened::${this.sJc}`);v.a("RockyV2Telemetry")?this.Jrk():(this.Naa.clear(),this.d6=!1,this.sJc=0);H.a.J(593827098,830,15,"SlideShowCoreFrame::Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",hb,Da,Date.now(),this.W$a())}else H.a.J(508908737,830,10,"SlideShowCoreFrame - updateSlideShowCore: m_slideshowCore is null")})}XNf(){try{this.Ipb=
new PodsProxy.PodsProxy(this.la.Gsa?this.la.n$a:this.la.$l,{DownloadUrl:this.iA,DocID:h.AFrameworkApplication.ui,CustomFontCatalogUrl:this.la.La("CustomFontCatalogURL")},this.la.e_?l.a.vI(this.la.e_).toLowerCase():"",this.tG,this.Fjb(),this.Gjb())}catch(hb){if(hb instanceof TypeError)this.Ipb=new PodsProxy.PodsProxy(this.la.Gsa?this.la.n$a:this.la.$l,{DownloadUrl:this.iA,DocID:h.AFrameworkApplication.ui,CustomFontCatalogUrl:this.la.La("CustomFontCatalogURL")},this.la.e_?l.a.vI(this.la.e_).toLowerCase():
"",this.tG,this.PSd()?this.la.La("PresentUrlEndpoint"):void 0,this.Fjb(),this.Gjb());else throw H.a.J(507811592,830,10,"SlideShowCoreFrame::Error in PodsProxy initialization:{0}",hb),hb;}}Jrk(){this.Naa.clear();this.d6=!1;this.sJc=this.N4d=0;this.tVb=this.rVb=!1;this.n7d={};this.g3d=!1}a1b(hb,Da){return Object(c.b)(this,void 0,void 0,function*(){const Bb=hb.data?hb.data.Ze:-1;0<Da--?(H.a.J(512309281,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
Bb),yield this.sKd(Da)):H.a.J(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : HttpStatus: {0}",Bb)})}E5(){return this.la.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&v.a("SlideCacheExperimentV2")}Txh(hb,Da,Bb,Za,mb,vb,sb,bc,yb){Object(c.b)(this,void 0,void 0,function*(){var uc=0;this.x7d=0>=Da?0:Da-1;var vc={};v.a("SSLaunchRefactoredLaunchLogs")&&(vc.id=y.a.create().toString(),vc.additionalMetrics={});const wc={};v.a("CoauthEditSlideInfoEnabledTelemetryEnabled")&&
(wc.CoauthEditSlideInfoEnabled=this.la.getBooleanAppSetting("CoauthEditSlideInfoEnabled"));if(v.a("SSNetworkInfo")&&"connection"in navigator){var ub=navigator.connection,aa={};"effectiveType"in ub&&(aa.type=ub.effectiveType);"downlink"in ub&&(aa.downlink=ub.downlink);"rtt"in ub&&(aa.rtt=ub.rtt);wc.network=aa}this.LMa&&(H.a.J(509617947,830,15,"SlideShowCoreFrame::StartFrom - initPromise {0}",this.LMa),ub=Mb.gS(),yield this.LMa,uc=Mb.gS()-ub,this.W$a()||this.show());if(l.a.rb(this.iA))H.a.J(508924042,
830,10,"SlideShowCoreFrame::StartFrom DownloadUrl is null or empty - {0}",this.iA),this.W$a()&&(vc=C.a.wi(410),h.AFrameworkApplication.Xs(vc),z.Health.instance.recordQosError(C.a.Fja(vc),["SlideShowACE"],!1,!0,!0,!0,null),this.Gg&&this.Gg.recordSessionStats({["errorName"]:"ErrorSlideShowGetItemsFailedDownloadFile"}),this.exit());else if(this.Gg){ub={sr:"ss"};v.a("SSLaunchUnifiedTelemetry")&&(wc.initPromiseTimeMs=uc);this.uU>this.rY||this.f_b?(this.Ex.slideshowcore.vetoBootDurationMs=this.la.Jc("PptModernSlideShowEditVetoBootDurationMs",
8E3),ub.BootScenario=this.uU>this.rY?"AfterEdit":"Init",H.a.J(509703459,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.Jc("PptModernSlideShowEditVetoBootDurationMs",8E3),this.uU,this.rY,this.f_b)):(this.Ex.slideshowcore.vetoBootDurationMs=this.la.Jc("PptModernSlideShowCachedVetoBootDurationMs",2E3),ub.BootScenario="Relaunch",H.a.J(509703458,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",
this.la.Jc("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.uU,this.rY,this.f_b));this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",!1)&&this.xvj();this.w6b();aa=0;uc=this.E5()&&!this.RUf(hb)&&this.uU>this.rY;const Na=this.E5()?this.RUf(hb)&&this.uU>this.rY:this.uU>this.rY;v.a("RockyV2Telemetry")&&this.E5()&&(wc.updateSlideShowCoreBeforeLaunch=Na,wc.updateSlideShowCoreAfterLaunch=uc,Na&&(wc.slideEditSource=this.aWi(hb),wc.slideFirstEditCommand=this.bWi(hb)),
v.a("PPTOPresentFrontDoorTelemetry")&&(wc.pptoPresentFrontDoorEnabled=this.la.getBooleanAppSetting("PPTOPresentFrontDoorEnabled"),wc.isGetItemsRequestRoutedtoPFD=this.PSd()));Na&&(aa=Mb.gS(),this.Gg.showLoadingSpinner(),this.iAa&&this.Qaa.zlh(this.uU)?yield this.n4g(uc,vc):yield this.Bue(1,uc),aa=Mb.gS()-aa,v.a("SSLaunchRefactoredLaunchLogs")&&(vc.additionalMetrics.isUpdateResourceProviderCalled=!0));v.a("SSLaunchUnifiedTelemetry")&&(ub.SSCoreUpdateAfterEditMs=aa);ub.startFromTime=yb-window.performance.timing.navigationStart;
ub.SSCoreFrameStartTime=Mb.gS();v.a("SSLaunchRefactoredLaunchLogs")&&(wc.CacheRetentionExpEnabled=this.E5());v.a("SSSnapUrlUpdateAfterEditEnabled")&&(wc.SnapUrlUpdateAfterEditEnabled=this.iAa);v.a("SSRockySlideEditEnhancementEnabled")&&(wc.RockySlideEditEnhancement=this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",!1));v.a("IsGetPresInfoClientEnabled")&&(wc.IsGetPresInfoClientEnabled=this.la.getBooleanAppSetting("SlideShowGetPresInfoFromClient"));v.a("IsSnapUrlonBootEnabled")&&
(wc.IsSnapUrlonBootEnabled=this.la.getBooleanAppSetting("IsSnapUrlFetchedEarlyOnBootEnabled"));v.a("SSEUPLBugTelemetry")&&(wc.SlideShowClickTime=yb);va.instance.Unk();this.$.style.top="0";this.s6&&this.t6&&(this.s6.tabIndex=0,this.t6.tabIndex=0);aa={["slideId"]:{["sid"]:hb,["cid"]:0}};aa.slideIndex=Da-1;this.v7d+=1;v.a("SSLaunchNumberInSession")&&(wc.SlideShowLaunchNumber=this.v7d);v.a("SSLaunchSlideIndexTelemetry")&&(wc.SlideShowIndex=Da-1);v.a("SSLaunchRefactoredLaunchLogs")&&(wc.id=vc.id,H.a.J(508072012,
830,15,JSON.stringify(wc)));h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SSRemoveCheckFullScreenChecker",!1)||!this.dN.NEe||this.dN.A0a?this.Dxf(aa,ub,uc,vc):this.Xdi(aa,ub,uc,vc);this.iAa&&this.Qaa.t_l()}else H.a.J(512495901,830,10,"SlideShowCoreFrame::SlideshowCore is undefined")})}n4g(hb,Da){return Object(c.b)(this,void 0,void 0,function*(){this.rY=this.Qaa.Vsh;this.iA=this.Qaa.vVl;this.lka=this.Qaa.uMe;yield this.Aue(new Date(this.Qaa.wVl),new Date(this.Qaa.Vsh),
hb);H.a.J(507884896,830,15,"SlideShowCoreFrame::updateSlideShowCoreWithPrefetchedSnapUrl served prefethed snap url with updateSlideShowCoreAfterLaunch:{0}, actionId:{1}",hb,Da.id)})}PSd(){return v.a("SimplifyChecksAndReturnValueInSnapResponse")?this.lka:this.la.getBooleanAppSetting("PPTOPresentFrontDoorEnabled")&&v.a("AddCallerQueryParam")&&this.kog.FileSizeBytes<=this.la.Jc("PresentFrontdoorMaxAllowedFileSizeInBytes",1E8)&&!h.AFrameworkApplication.RA}RUf(hb){hb=-1==hb?this.Ub.fw(0):this.Ub.XZ(hb);
hb=JSON.stringify({Sid:hb.sid,Cid:hb.cid});return this.d6||this.Naa.has(hb)||this.la.getBooleanAppSetting("CoauthEditSlideInfoEnabled")&&this.g3d}xvj(){this.V6d<this.uU&&(H.a.J(507793607,830,15,"SlideShowCoreFrame: User launched before server response. ServerResponseTime:{0}, LastEditTime:{1}",this.V6d,this.uU),v.a("ToggleMultiSlideEditOnServerResponseTime")||(this.d6=!0))}aWi(hb){if(this.rVb)return 2;if(this.tVb)return 3;if(this.d6)return 1;hb=-1==hb?this.Ub.fw(0):this.Ub.XZ(hb);hb=JSON.stringify({Sid:hb.sid,
Cid:hb.cid});return this.Naa.has(hb)?0:4}$Gf(hb,Da){return hb+"_"+Da}bWi(hb){if(this.tVb||this.rVb)return-2;if(this.d6)return this.N4d;hb=-1==hb?this.Ub.fw(0):this.Ub.XZ(hb);return this.n7d[this.$Gf(hb.sid,hb.cid)]}prev(){return Object(c.b)(this,void 0,void 0,function*(){this.Gg&&(this.E5()&&this.b4a&&(this.Gg.showLoadingSpinner(),yield this.b4a,this.Gg.hideLoadingSpinner()),yield this.Gg.prevStep("0_anim"))})}next(){return Object(c.b)(this,void 0,void 0,function*(){this.Gg&&(this.E5()&&this.b4a&&
(this.Gg.showLoadingSpinner(),yield this.b4a,this.Gg.hideLoadingSpinner()),yield this.Gg.nextStep("0_anim",3))})}show(){this.xfd(!0)}W$a(){return this.so&&this.so.style.visibility===Pa.a.Cw?!0:!1}xfd(hb){va.instance.setVisibility(hb&&this.qf.Ks);this.so&&(hb?(this.so.style.visibility=Pa.a.Cw,$addHandler(window,"visibilitychange",Da=>{this.KQc(Da)})):(this.so.style.visibility=Pa.a.ms,$removeHandler(window,"visibilitychange",Da=>{this.KQc(Da)})))}exit(){this.kxg(!1)}iRa(hb,Da,Bb,Za,mb,vb,sb){const bc=
!!this.Ud&&!!this.Ud.instance&&(this.Ud.instance.Rtc||this.Ud.instance.PK);(this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&this.Ud.instance.oac||bc)&&!this.Ud.instance.MBe()?H.a.J(512495900,830,10,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):(va.instance.iRa(hb,Da,Bb,Za,mb,vb,sb),this.qf.Ks&&this.Gg.recordSessionStats({["metadata"]:"subtitles"}),this.qCd())}Dxf(hb,Da,Bb,Za){Object(c.b)(this,void 0,void 0,function*(){this.la.isAnimationPreviewEnabled&&(yield this.Gg.refreshViewControllerSSC());
this.la.getBooleanAppSetting("EnsureNavigationStateConsistency")||this.Gg.clearNavigationState();Za.navigationType="init";Za.startFromTime=Da.startFromTime;Da.waitedForInit=this.f_b;Da.startInitTime=this.spg;Da.beforeInitPromise=Mb.gS();yield this.Oab;Da.afterInitPromise=Mb.gS();Za.bootMetrics=Da;if(0>hb.slideIndex){var mb=this.la.getBooleanAppSetting("EnsureNavigationStateConsistency")?yield this.Gg.gotoFirstSlideOptions(!0,{Kd:Za,gIm:!0}):yield this.Gg.gotoFirstSlide(!0,Za);v.a("AddLogsForGotoFirstSlideFailure")&&
mb&&!mb.fSucceeded&&H.a.J(507799685,830,10,"SlideShowCoreFrame::finishStartFrom: slide show core gotoSlide failed with error {0}",null===mb||void 0===mb?void 0:mb.error);this.$.style.height="100%";this.$.style.width="100%";H.a.J(508924041,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {0}",JSON.stringify(hb))}else mb={},mb.actionContext=Za,mb.fSkipTransition=!0,this.la.getBooleanAppSetting("EnsureNavigationStateConsistency")&&(mb.fClearNavigationState=!0),
v.a("FixForGotoSlideTelemetryMinify"),mb=yield this.Gg.gotoSlide(hb,mb),!v.a("AddLogsForGotoSlideFailure")||(null===mb||void 0===mb?0:mb.fSucceeded)||H.a.J(507863835,830,10,"SlideShowCoreFrame::finishStartFrom: slide show core gotoSlide failed with error {0}",null===mb||void 0===mb?void 0:mb.error),this.$.style.height="100%",this.$.style.width="100%",H.a.J(508924040,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {0}",JSON.stringify(hb));this.E5()&&Bb&&(this.b4a=
this.iAa&&this.Qaa.zlh(this.uU)?this.n4g(Bb,Za):this.Bue(1,Bb),yield this.b4a,this.b4a=void 0);this.ua.raiseEvent("OnSlideshowReady",new Sys.EventArgs)})}Xdi(hb,Da,Bb,Za){const mb=this.la.Jc("PptModernSlideShowCheckFullscreenCounter",10),vb=Mb.gS();let sb=mb,bc=4;v.a("fixEUPLBugEnabled")&&0!=this.Xga&&(H.a.J(508411976,830,15,"Clearing check full screen interval if it is already running:{0}.",this.Xga),this.la.getBooleanAppSetting("FixSlideShowEUPLBugEnabled")&&(window.clearInterval(this.Xga),this.Xga=
0));this.Xga=window.setInterval(()=>{if(this.la.getBooleanAppSetting("FixSlideShowEUPLBugEnabled")&&this.JWd)H.a.J(508404055,830,15,"SlideShowCoreFrame::checkFullscreenBeforeFinishStartFrom - Already CheckingFullScreen, exiting this iteration. checkFullscreenCounter: {0}.",sb);else{this.JWd=!0;sb--;H.a.J(512495899,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",sb);var yb=Mb.gS();if(this.dN.A0a||0>=sb){const vc=Mb.gS();window.clearInterval(this.Xga);this.Xga=0;if(v.a("fixEUPLBugEnabled")&&
0==sb%5&&0<=bc){bc--;var uc=A.a.Ot();H.a.J(508409102,830,15,"CallStack before checkFullscreenBeforeFinishStartFrom : {0}",uc)}uc=20*(mb-sb);v.a("SSLaunchUnifiedTelemetry")||(Da.checkFullscreenMs=uc);H.a.J(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms. Time taken in FullScreen API: {1}ms",uc,(vc-yb).toString());v.a("SSLaunchUnifiedTelemetry")&&!Da.checkFullscreenMs&&(Da.checkFullscreenMs=Mb.gS()-vb);this.Dxf(hb,Da,Bb,Za)}this.JWd=!1}},20)}qCd(){let hb=0,Da=100;
this.qf.Ks&&va.instance.isVisible()&&("AboveSlide"===this.qf.z2?(hb=15,Da=85):"BelowSlide"===this.qf.z2&&(Da=85));const Bb=document.getElementById("LiveURLBarLayerHost");this.Dob&&Bb?(this.$.style.top=String.format("calc({0}% + {1})",hb.toString(),"26px"),this.$.style.height=String.format("calc({0}% - {1})",Da.toString(),"26px")):(this.$.style.top=hb.toString()+"%",this.$.style.height=Da.toString()+"%")}OMe(hb){va.instance.OMe(hb)}Til(){this.fhf("NotAllowedError","Error")}mui(hb){return hb&&"string"===
typeof hb&&-1===hb.indexOf("unknown")?-1!==hb.indexOf("CameraStarted")?ResourceStrings.l_CameraReady:-1!==hb.indexOf("NotAllowedError")||-1!==hb.indexOf("SecurityError")||-1!==hb.indexOf("TypeError")?ResourceStrings.l_CameraPermissionError:-1!==hb.indexOf("NotFoundError")||-1!==hb.indexOf("OverconstrainedError")||-1!==hb.indexOf("ErrorStreamStartFailure")||-1!==hb.indexOf("ErrorNoVideoTracks")?ResourceStrings.l_CameraDetectionError:-1!==hb.indexOf("NotReadableError")?ResourceStrings.l_CameraInUseByAnotherAppError:
ResourceStrings.l_CameraError:ResourceStrings.l_CameraUnknownError}setCameraState(hb){var Da;null===(Da=this.c_b)||void 0===Da?void 0:Da.setCameraState(hb)}q9l(hb){this.c_b&&hb&&this.c_b.updateWebcamDevice(hb)}getDefaultCameraLabel(){var hb,Da;return null!==(Da=null===(hb=this.c_b)||void 0===hb?void 0:hb.getDefaultCameraLabel())&&void 0!==Da?Da:""}sOe(hb,Da){this.Dob=hb;va.instance.LRk(hb,void 0===Da?"":Da);this.qCd()}Kyh(hb){va.instance.setVisibility(hb);va.instance.iud();this.qCd()}KRk(){this.ua.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}jda(){this.so&&this.so.style.visibility!==Pa.a.ms&&!this.kij()&&this.$.focus()}getCurrentPosition(){if(this.Gg){const hb=this.Gg.getSlideLocation();hb?this.ua.raiseEvent("OnGetCurrentPosition",new U({["SlideId"]:hb.slideId.sid,["SlideIndex"]:hb.slideIndex})):H.a.J(512495897,830,10,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}pul(){if(this.Gg){const hb=this.Gg.getSlideLocation();if(hb){const Da=this.Gg.getAnimationState(!0),Bb=Da.timelineStates,Za=[];for(let mb=
0;mb<Bb.length;mb+=1)Za.push({["TimeLineId"]:Bb[mb].timelineId,["Step"]:Bb[mb].step,["LastClickTime"]:Bb[mb].lastClickTime,["StartTimeOffset"]:Da.startTimeOffset});this.ua.raiseEvent("OnGetCurrentPosition",new U({["SlideId"]:hb.slideId.sid,["SlideIndex"]:hb.slideIndex,["TimeLineMappings"]:Za}))}else H.a.J(512495896,830,10,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}xCe(){if(this.Gg&&this.so&&this.so.style.visibility!==Pa.a.ms){const hb=document.getElementById(this.pta?
"svg-canvas":"webgl-canvas");hb&&this.ua.raiseEvent("OnGetCurrentSlideDimensions",new W({["SlideHeight"]:hb.offsetHeight,["SlideWidth"]:hb.offsetWidth,["SlideLeftBound"]:hb.offsetLeft,["SlideBottomBound"]:hb.offsetTop+hb.offsetHeight}))}}C8c(hb){Object(c.b)(this,void 0,void 0,function*(){if(this.Gg){let Da;v.a("FixForGotoSlideTelemetryMinify");Da=yield this.Gg.gotoSlide({["slideIndex"]:hb},{actionContext:{navigationType:"goto"},fSkipTransition:!1});!v.a("AddLogsForGotoSlideFailure")||(null===Da||
void 0===Da?0:Da.fSucceeded)||H.a.J(507863834,830,10,"SlideShowCoreFrame::goToSlide: slide show core gotoSlide failed with error {0}",null===Da||void 0===Da?void 0:Da.error)}})}Oxl(hb,Da){Object(c.b)(this,void 0,void 0,function*(){if(this.Gg){var Bb={},Za=[];let mb=0;for(let vb=0;vb<Da.length;vb+=1){const sb={};sb.timelineId=Da[vb].TimeLineId;sb.step=Da[vb].Step;sb.lastClickTime=Da[vb].LastClickTime;mb=Da[vb].StartTimeOffset;Za.push(sb)}Bb.timelineStates=Za;Bb.startTimeOffset=mb;Za={actionContext:{navigationType:"goto"}};
Za.animationState=Bb;Za.fSkipTransition=!1;v.a("FixForGotoSlideTelemetryMinify");Bb=yield this.Gg.gotoSlide({["slideIndex"]:hb},Za);!v.a("AddLogsForGotoSlideFailure")||(null===Bb||void 0===Bb?0:Bb.fSucceeded)||H.a.J(507863833,830,10,"SlideShowCoreFrame::GoToSlideWithTimeLines: slide show core gotoSlide failed with error {0}",null===Bb||void 0===Bb?void 0:Bb.error)}})}Bue(hb,Da){return Object(c.b)(this,void 0,void 0,function*(){H.a.J(512309260,830,15,"SlideShowCoreFrame::updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",
this.eL);let Bb=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.$l,this.eL);if(v.a("AddCallerQueryParam")){const vb=this.la.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");Bb+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${vb}`}const Za={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};Za["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;const mb=new Date;return new Promise((vb,sb)=>{this.$p.rk(Bb,1,"",Za,!1,0,bc=>Object(c.b)(this,
void 0,void 0,function*(){yield this.A_j(bc,mb,Da);H.a.J(509636748,830,15,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlSucceededAfterEdit");vb()}),bc=>Object(c.b)(this,void 0,void 0,function*(){yield this.y_j(bc,hb,Da);H.a.J(509636747,830,10,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlFailedAfterEdit");sb()}),null,null)})})}A_j(hb,Da,Bb){return Object(c.b)(this,void 0,void 0,function*(){const Za=new Date;H.a.J(512309279,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit. Time-Taken : {0}",
+Za-+Da);const mb=JSON.parse(hb.data.responseData);this.iA=mb.downloadUrl;void 0!==mb.sendGetItemsRequestToPFD&&(this.lka=mb.sendGetItemsRequestToPFD);l.a.rb(this.iA)?H.a.J(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",mb):(this.rY=Date.now(),yield this.Aue(Da,Za,Bb))})}y_j(hb,Da,Bb){return Object(c.b)(this,void 0,void 0,function*(){const Za=hb.data?hb.data.Ze:-1;0<Da--?(H.a.J(512309277,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
Za),yield this.Bue(Da,Bb)):H.a.J(512309276,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : HttpStatus: {0}",Za)})}YIg(hb,Da,Bb){Bb=void 0===Bb?1:Bb;return Object(c.b)(this,void 0,void 0,function*(){H.a.J(512309259,830,15,"SlideShowCoreFrame::RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",this.eL,hb);this.eL=hb;this.LBb=Da;let Za=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.$l,this.eL);if(v.a("AddCallerQueryParam")){const sb=
this.la.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");Za+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${sb}`}const mb={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};mb["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;const vb=new Date;return new Promise((sb,bc)=>{this.$p.rk(Za,1,"",mb,!1,0,yb=>Object(c.b)(this,void 0,void 0,function*(){yield this.B_j(yb,vb);sb()}),yb=>Object(c.b)(this,void 0,void 0,function*(){yield this.z_j(yb,Bb);bc()}),null,null)})})}B_j(hb,
Da){return Object(c.b)(this,void 0,void 0,function*(){var Bb=new Date;H.a.J(512309275,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession. Time-Taken : {0}",+Bb-+Da);const Za=JSON.parse(hb.data.responseData);this.iA=Za.downloadUrl;void 0!==Za.sendGetItemsRequestToPFD&&(this.lka=Za.sendGetItemsRequestToPFD);l.a.rb(this.iA)?(H.a.J(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",Za),this.W$a()&&(Bb=
C.a.wi(413),h.AFrameworkApplication.Xs(Bb),z.Health.instance.recordQosError(C.a.Fja(Bb),["SlideShowACE"],!1,!0,!0,!0,null),this.Gg&&this.Gg.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.rY=Date.now(),yield this.Aue(Da,Bb),v.a("prefetchOnPodSessionRefreshEnabled")&&this.Gg.prefetchOnPodSessionRefresh())})}z_j(hb,Da){return Object(c.b)(this,void 0,void 0,function*(){const Bb=hb.data?hb.data.Ze:-1;0<Da--?(H.a.J(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
Bb),yield this.YIg(this.eL,this.LBb,Da)):(H.a.J(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : HttpStatus: {0}",Bb),this.W$a()&&this.exit())})}setVisibility(hb){this.xfd(hb)}qwb(hb){this.so&&(this.so.style.cursor=hb?"default":"none");va.instance.qwb(hb)}n8j(hb){if(this.e_b)this.e_b.onInkManagerActivity(hb)}f1b(hb){this.Ivh(hb)}Ivh(hb){this.ua.raiseEvent("OnSpecialKey",new K({["Key"]:hb.keyCode,["ShiftKey"]:hb.shiftKey,["AltKey"]:hb.altKey}))}Bzg(){this.so&&this.jda()}Fjb(){const hb=
new Map;hb.set("X-UserSessionId",this.ycc);hb.set("X-WacNoAuth","1");hb.set("X-WacCluster",this.LBb);hb.set("Client","Unified App");v.a("AddHostInfoTelemetry")&&hb.set("HostName",h.AFrameworkApplication.Rf.Host);this.la.Ehh&&hb.set("UseDocCache","True");return hb}kxg(hb){hb=void 0===hb?!1:hb;var Da,Bb,Za;H.a.J(507773716,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler");this.Xga&&(H.a.J(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",
this.Xga),window.clearInterval(this.Xga),this.Xga=0);this.e_b&&this.e_b.resetInkCanvas();null===(Da=this.c_b)||void 0===Da?void 0:Da.setCameraState(!1);this.M3a&&(null===(Za=null===(Bb=this.d_b)||void 0===Bb?void 0:Bb.instance)||void 0===Za?void 0:Za.hide(),window.clearTimeout(this.M3a),this.M3a=void 0);this.s6&&this.t6&&(this.s6.tabIndex=-1,this.t6.tabIndex=-1);this.Gg?(Da=this.Gg.getSlideLocation(),this.Gg.endSession(Mb.gS()),v.a("ssExitTelemetryEnabled")&&H.a.J(508071949,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: Exiting the SlideShow"),
Da?this.ua.raiseEvent("OnExit",new N({["SlideId"]:Da.slideId.sid,["IsBeforeReady"]:!1,["SlideIndex"]:Da.slideIndex,["IsFromEndOfSlideshow"]:hb})):(this.ua.raiseEvent("OnExit",new N({["IsFromEndOfSlideshow"]:hb})),H.a.J(512495889,830,10,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null")),H.a.J(507773715,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler: Exit event raised")):v.a("SendExitEventOnSlideShowTimeout")&&(this.ua.raiseEvent("OnExit",new N({["IsFromEndOfSlideshow"]:hb})),
H.a.J(507605470,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: m_slideshowCore is null, sending exit event"));this.$&&(this.$.style.width=window.screen.width+"px",this.$.style.height=window.screen.height+"px");this.xfd(!1);va.instance.WWg()}Xbd(){if(this.Gg&&this.so&&this.so.style.visibility!==Pa.a.ms){const hb=this.Gg.getSlideLocation();if(hb){const Da=this.Gg.getAnimationState(!0),Bb=Da.timelineStates,Za=[];for(let mb=0;mb<Bb.length;mb+=1)Za.push({["TimeLineId"]:Bb[mb].timelineId,["Step"]:Bb[mb].step,
["LastClickTime"]:Bb[mb].lastClickTime,["StartTimeOffset"]:Da.startTimeOffset});this.ua.raiseEvent("OnPositionChangeEventId",new O.a({["SlideId"]:hb.slideId.sid,["SlideIndex"]:hb.slideIndex,["TimeLineMappings"]:Za}))}else H.a.J(512495888,830,10,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}SYj(hb){if(this.Gg&&this.so&&this.so.style.visibility!==Pa.a.ms)switch(hb){case "Hidden":this.ua.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty);break;case "EndOfShow":this.ua.raiseEvent("OnEnterEndOfShowEventId",
Sys.EventArgs.Empty);break;default:H.a.J(512495887,830,15,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",hb)}}HIe(hb){if(this.Gg){H.a.J(512495886,830,10,"SlideshowCoreFrame.OnErrorHandler {0}",hb);let Da;hb.startsWith("Server")&&(hb="GetItemsRequestFailed");switch(hb){case "GetItemsFailedDownloadFile":H.a.J(512495885,830,10,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",this.eL);this.ua.raiseEvent("OnPodSessionExpired",new L({["Code"]:5341407,["Reason"]:"Failed To Download File",
["PodSessionId"]:this.eL}));return;case "LoadFailed":Da=407;break;case "GetItemsFailedInvalidResponse":Da=408;break;case "GetItemsRequestFailed":Da=409;break;case "GetItemsTimeout":Da=411;break;case "EnsureSlideFailed":Da=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":Da=414;break;default:Da=359}if(0!==Da)if(this.W$a()){const Bb=C.a.wi(Da);h.AFrameworkApplication.Xs(Bb);hb=409===Da?hb:C.a.Fja(Bb);z.Health.instance.recordQosError(hb,["SlideShowACE"],!1,!0,!0,!0,null);this.Gg.recordSessionStats({["errorName"]:hb})}else H.a.J(512495884,
830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",hb)}}n2j(hb){H.a.J(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.Gg&&this.so&&this.so.style.visibility!==Pa.a.ms&&this.ua.raiseEvent("OnTranscriberStartedEventId",new V({["TranscriberSessionId"]:hb}));this.qf.PBe=!0}KQc(){H.a.J(512495882,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");window.document.hidden&&this.ua.raiseEvent("OnVisibilityChangeEventId",new Y(!1))}kij(){return!!this.Ud&&
!!this.Ud.instance&&this.Ud.instance.hrl}Wah(hb){this.ua.addHandler("OnSlideshowReady",hb)}suh(hb){this.ua.removeHandler("OnSlideshowReady",hb)}T0h(hb){this.ua.addHandler("OnBrowserEvent",hb)}Iok(hb){this.ua.removeHandler("OnBrowserEvent",hb)}Hel(hb){this.ua.addHandler("OnFullscreenClick",hb)}SYl(hb){this.ua.removeHandler("OnFullscreenClick",hb)}X0h(hb){this.ua.addHandler("OnSlideshowContextMenu",hb)}Lok(hb){this.ua.removeHandler("OnSlideshowContextMenu",hb)}OJb(hb){this.ua.addHandler("OnExit",hb)}TCb(hb){this.ua.removeHandler("OnExit",
hb)}Bel(hb){this.ua.addHandler("OnSlideshowError",hb)}PYl(hb){this.ua.removeHandler("OnSlideshowError",hb)}oaf(hb){this.ua.addHandler("OnGetCurrentSlideDimensions",hb)}FKg(hb){this.ua.removeHandler("OnGetCurrentSlideDimensions",hb)}naf(hb){this.ua.addHandler("OnGetCurrentPosition",hb)}Sje(hb){this.ua.removeHandler("OnGetCurrentPosition",hb)}Xah(hb){this.ua.addHandler("OnSpecialKey",hb)}tuh(hb){this.ua.removeHandler("OnSpecialKey",hb)}gfl(hb){this.ua.addHandler("OnVisibilityChangeEventId",hb)}cpk(hb){this.ua.removeHandler("OnVisibilityChangeEventId",
hb)}o1h(hb){this.ua.addHandler("OnPodSessionExpired",hb)}Yok(hb){this.ua.removeHandler("OnPodSessionExpired",hb)}Oel(hb){this.ua.addHandler("OnLogEndOfTranscriptionSession",hb)}$Yl(hb){this.ua.removeHandler("OnLogEndOfTranscriptionSession",hb)}$9b(hb){this.ua.addHandler("OnPositionChangeEventId",hb)}OUc(hb){this.ua.removeHandler("OnPositionChangeEventId",hb)}Mel(hb){this.ua.addHandler("OnLiveSubtitlesDockedViewEventId",hb)}YYl(hb){this.ua.removeHandler("OnLiveSubtitlesDockedViewEventId",hb)}b1h(hb){this.ua.addHandler("OnEnterEndOfShowEventId",
hb)}Pok(hb){this.ua.removeHandler("OnEnterEndOfShowEventId",hb)}k1h(hb){this.ua.addHandler("OnLeaveEndOfShowEventId",hb)}Vok(hb){this.ua.removeHandler("OnLeaveEndOfShowEventId",hb)}cfl(hb){this.ua.addHandler("OnSubtitleUpdatedEventId",hb)}hZl(hb){this.ua.removeHandler("OnSubtitleUpdatedEventId",hb)}dfl(hb){this.ua.addHandler("OnTranscriberStartedEventId",hb)}iZl(hb){this.ua.removeHandler("OnTranscriberStartedEventId",hb)}mfl(hb){this.ua.addHandler("RecordQosErrorEventId",hb)}pZl(hb){this.ua.addHandler("RecordQosErrorEventId",
hb)}vel(hb){this.ua.addHandler("OnCameraErrorEventId",hb)}LYl(hb){this.ua.removeHandler("OnCameraErrorEventId",hb)}q0j(hb){this.ua.raiseEvent("OnBrowserEvent",new D({["ClientX"]:hb.clientX,["ClientY"]:hb.clientY}))}hPc(hb){this.ua.raiseEvent("OnSlideshowContextMenu",new M({["ClientX"]:hb.clientPoint.x,["ClientY"]:hb.clientPoint.y}));return!0}static gS(){return Math.round(window.performance.now())}}Object(x.a)(Mb,"SlideShowCoreFrame",null,[719])},1458:function(x,G,a){a.d(G,"a",function(){return m});
x=a(0);var c=a(17);class b{constructor(){this.Ver=1}}Object(x.a)(b,"CacheItem",null,[]);class f{constructor(){}}Object(x.a)(f,"AppsDataCacheManager",null,[519]);var e=a(413),h=a(20),u=a(508);class m{constructor(){this.Gbd=new Set;new f(u.a.instance)}Svh(n,l){n=e.a.MCf()+n;u.a.instance.setItem(n,l.toString())}YSi(){var n=e.a.xJd();c.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",n);n=u.a.instance.getItem(n);return h.a(n)}JBk(n){const l=e.a.xJd();c.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",
l);u.a.instance.setItem(l,h.c(n))}hBk(n){this.Gbd=n}qlj(){return!!u.a.instance.localStorage}static get instance(){m.Wa||(m.Wa=new m);return m.Wa}}m.Wa=null;Object(x.a)(m,"AddInCommandsCacheManager",null,[481])},1517:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=
!0;this.supportsAuthToken=!1}static Ktl(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(x.a)(c,"WopiAuthContext",null,[500])},1525:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c extends Sys.EventArgs{constructor(b,f,e){e=void 0===e?null:e;super();this.shapeId=b;this.w$i=f;this.q7=e}}Object(x.a)(c,"ReplaceObjectSuggestionPointerOverEventArgs",Sys.EventArgs,[])},1526:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c extends Sys.EventArgs{constructor(b,
f){f=void 0===f?null:f;super();this.shapeId=b;this.q7=f}}Object(x.a)(c,"ReplaceObjectSuggestionPointerOutEventArgs",Sys.EventArgs,[])},1527:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.Jbh=null}}Object(x.a)(c,"IdeasSmartArtSuggestionWrapper",null,[])},1674:function(x,G,a){a.r(G);var c=a(0),b=a(118),f=a(17),e=a(40),h=a(4),u=a(401),m=a(43),n;(function(Z){Z[Z.error=0]="error";Z[Z.warning=1]="warning";Z[Z.tip=2]="tip";Z[Z.intelligentService=3]="intelligentService"})(n||
(n={}));Object(c.b)("AccessibilityRuleCategory",n);var l=a(19),r=a(41),w=a(10),y=a(18),z=a(93),A=a(23);class B{constructor(Z,Ka,zb){this.BDh=null;this.e8k=this.U7k=!1;this.omc=Z;this.f7g=Ka;this.ya=void 0===zb?null:zb;this.Gs.za(w.a.dym,r.a.frame,Object(e.a)(this,this.lca,"closePane"))}get Gs(){return this.ya||(this.ya=h.AFrameworkApplication.vb)}set Gs(Z){this.ya=Z}$Gm(){this.U7k||(this.omc.initialize(this),this.f7g.initialize(this),this.U7k=!0)}bZj(){A.c(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});
this.f7g.FIn()}Rn(Z,Ka,zb){if(1===zb)return u.SessionStatusManager.instance.QKa?8:32;this.omc.isVisible||this.$Gm();this.lQn();return 32}lca(Z,Ka,zb){1!==zb&&this.omc.Tw();return 32}m1j(){this.omc.O4l(!0)}Dvi(Z){if(Z){if(Z.AccessibilityRules&&Object.keys(Z.AccessibilityRules).length){const zb=Z.AccessibilityRules;for(const dc in zb){var Ka=dc;const Jc=zb[dc].RuleId+"";Ka!==Jc&&A.c(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",Ka,Jc)}this.BDh=zb}else!this.BDh&&
Z.Results&&0<Z.Results.length?(A.c(18993251,200,15,"No accessibility rule definitions available"),Z.IsSuccess=!1):Z.AccessibilityRules=this.BDh;Z.IsSuccess||A.c(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.CFn(Z);this.J$m(Z);this.omc.Dvi(Z)}}CFn(Z){const Ka=Z.AccessibilityRules;if(Z=Z.Results)for(let zb=Z.length-1;0<=zb;zb--){const dc=Z[zb];let Jc="";const jd=dc.RuleId;dc.ContentName||(Jc+="Result does not have content name. ");jd in Ka||(Jc+=String.format("No accessibility check rule exists for ID {0}.",
jd));0<Jc.length&&(A.c(36214999,200,15,"Omitting invalid accessibility check result: "+Jc),Array.removeAt(Z,zb))}}CSm(){return h.AFrameworkApplication.ga.getBooleanAppSetting("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):l.a.instance.resolve("Common.IDynamicScriptLoaderProvider").LW.loadScript("accessibility-checker-pane-strings")}lQn(){this.e8k?this.omc.Rn():this.CSm().then(()=>{this.e8k=!0;this.omc.Rn()}).catch(Z=>f.ULS.sendTraceTag(540034694,334,10,
"Failed to load the resources for the accessibilityChecker feature: {0}",Z))}J$m(Z){var Ka={};const zb={};var dc=Z.Results,Jc=[];Array.add(Jc,Object.assign(new y.a,{name:"FinalViolationCount",int64:0}));Array.add(Jc,Object.assign(new y.a,{name:"FinalErrorCount",string:"0"}));Array.add(Jc,Object.assign(new y.a,{name:"FinalWarningCount",string:"0"}));Array.add(Jc,Object.assign(new y.a,{name:"FinalTipCount",string:"0"}));Array.add(Jc,Object.assign(new y.a,{name:"FinalIntelligentServiceCount",string:"0"}));
if(dc){for(const de of dc)if(Z.AccessibilityRules){var jd=Z.AccessibilityRules[de.RuleId];if(jd){if(Ka[n[jd.Category]]){let Ne=Ka[n[jd.Category]];Ka[n[jd.Category]]=++Ne}else Ka[n[jd.Category]]=1;zb[de.RuleId]?(jd=zb[de.RuleId],zb[de.RuleId]=++jd):zb[de.RuleId]=1}}Jc[0].int64=dc.length;for(var Ed in Ka)switch(Z=Ka[Ed],dc=Ed,dc="Final"+dc.charAt(0).toUpperCase()+dc.substring(1,dc.length)+"Count",dc){case "FinalErrorCount":Jc[1].string=Z.toString();break;case "FinalWarningCount":Jc[2].string=Z.toString();
break;case "FinalTipCount":Jc[3].string=Z.toString();break;case "FinalIntelligentServiceCount":Jc[4].string=Z.toString()}}m.a.sendTelemetryEvent(Object.assign(new z.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:Jc}));for(const de in zb)Ka=de,Jc=zb[de],Ed=[],Array.add(Ed,Object.assign(new y.a,{name:"RuleID",string:Ka})),Array.add(Ed,Object.assign(new y.a,{name:"FinalViolationCount",string:Jc.toString()})),m.a.sendTelemetryEvent(Object.assign(new z.a,
{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Ed}))}dispose(){this.omc&&this.omc.dispose();this.f7g&&this.f7g.dispose()}}Object(c.a)(B,"AAccessibilityCheckManager",null,[57,24]);var H=a(39),v=a(231),C=a(278),F=a(467),D=a(248);class N extends B{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne){super(Z,Ka);this.i6d=this.YJc=null;this.Ma=zb;this.Tb=dc;this.Nq=Jc;this.Rza=jd;this.va=Ed;this.pa=de;this.Ub=Ne;this.MOj=!1}TLn(Z){if(!Z)return D.a.J(507843714,
334,15,"Cannot navigate since violation data is null"),!1;if(Z.sldIdField){var Ka=new C.a(Object.assign(new F.a,{Sid:Z.sldIdField.sidField,Cid:Z.sldIdField.cidField}));Ka=this.Ub.s$a(Ka);if(!Ka)return!1;let zb=null;if(Z.spIdFieldSpecified&&(zb=Ka.uC(Z.spIdField),!zb&&this.MOj))return!1;this.JJn(Ka,zb)}else D.a.J(507843713,334,15,"There is no slide id info in violation data");return!0}bZj(){this.MOj=!1;super.bZj()}m1j(){this.MOj=!0;super.m1j()}JJn(Z,Ka){if(Z){const zb=this.va.Ga!==Z?!0:!1;Ka&&(this.i6d=
Ka,zb?this.Nq.Fea(Object(e.a)(this,this.DIe,"onActiveSlideDomChanged")):this.s1l());zb&&(this.Rza.Ga=Z);this.pa.Rw();this.Ma.Wd()}}DIe(){this.Nq.b6a(Object(e.a)(this,this.DIe,"onActiveSlideDomChanged"));this.YJc||(this.YJc=new H.a(2,1,0,Object(e.a)(this,this.P0j,"onPostActiveSlideDomChangedTask"),90,"20"),this.Tb.Qb(this.YJc))}P0j(){this.YJc=null;this.s1l()}Wd(){this.Rza.oI.Vo||this.Ma.Wd()}s1l(){if(this.i6d){const Z=Object(v.a)(284,this.i6d.Qg(this.Rza.oI.Oa));Z?Z.isDisposed?D.a.J(507843712,334,
50,"Shape view element of node {0} has been disposed",this.i6d.id):Z.isLocked?Z.twb():this.pa.selectShape(this.i6d,!0):D.a.J(507843683,334,50,"Try select node {0} but cannot find its shape view element",this.i6d.id);this.Wd();this.i6d=null}}}Object(c.a)(N,"PptAccCheckManager",B,[]);class U{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Z){Z=Sys.Serialization.JavaScriptSerializer.deserialize(Z);const Ka=Z.AccessibilityRules,zb=
{};if(Ka)for(let dc=0;dc<Ka.length;++dc){const Jc=Ka[dc];zb[Jc.Key]=Jc.Value}Z.AccessibilityRules=zb;return Z}}Object(c.a)(U,"AccessibilityCheckResultCollection",null,[]);class W{}Object(c.a)(W,"AccessibilityCheckResult",null,[]);class L{}Object(c.a)(L,"AccessibilityCheckRule",null,[]);class O{constructor(Z){this.k2c=null;this.Z6k=Z}get fileId(){return this.Z6k?this.Z6k():null}initialize(Z){this.k2c=Z}vPl(Z){this.k2c.Dvi(Z)}}Object(c.a)(O,"AAccessibilityCheckService",null,[376,24]);var M=a(68),K=
a(312);class P extends K.a{constructor(){super()}Gn(){return 56}}Object(c.a)(P,"AccCheckRequest",K.a,[]);var V=a(420);class Y extends O{constructor(Z,Ka){super(null);this.qm=Z;this.Mad=Ka}FIn(){const Z=new V.a(new P,Object(e.a)(this,this.Hnn,"onAccCheckSucceed"),Object(e.a)(this,this.Gnn,"onAccCheckFailed"));this.qm.Qb(Z)}dispose(){}get m3m(){return 0<this.Mad.tye.length}Hnn(Z){if(Z&&Z.ACResult&&(Z=this.ium(Z.ACResult))){this.vPl(Z);D.a.J(19227935,334,50,"Acc-check succeeded");return}this.XMl("Succeeded but response is invalid")}Gnn(Z){this.XMl(Z.toString());
return!0}XMl(Z){D.a.J(19227937,334,50,String.format("Acc-check failed: {0}",Z));Z=new U;Z.IsSuccess=!1;this.vPl(Z)}ium(Z){if(Z){var Ka=null;try{Ka=JSON.parse(Z)}catch(zb){return D.a.J(19227939,334,10,"Cannot parse acc-check result json: {0}",zb.toString()),null}if(Ka){Z=new U;Z.IsSuccess=!0;Z.IsPartialResult=Ka.isPartialResultField;Z.AccessibilityRules={};if(Ka.violatedRulesField){const zb=new M.a;for(const dc of Ka.violatedRulesField)if(Ka=this.jum(dc)){Z.AccessibilityRules[Ka.RuleId]=Ka;for(const Jc of dc.violationsField){const jd=
new W;jd.RuleId=Ka.RuleId;jd.ContentName=Jc.labelField;jd.ContentId=Jc;zb.add(jd)}}Z.Results=zb.toArray()}return Z}}return null}jum(Z){if(!Z)return null;if(Z.ruleIdField>=this.Mad.tye.length)return D.a.J(19227971,334,10,"Rule id {0} is bigger than total rule info list count {1}",Z.ruleIdField,this.Mad.tye.length),null;const Ka=new L;Ka.RuleId=Z.ruleIdField.toString();Ka.RuleName=this.Mad.tye[Z.ruleIdField].ruleTextField;switch(this.Mad.tye[Z.ruleIdField].ruleTypeField){case 0:Ka.Category=0;break;
case 1:Ka.Category=1;break;case 2:Ka.Category=2;break;case 3:Ka.Category=3}return Ka}}Object(c.a)(Y,"PptAccCheckService",O,[1368,376,24]);var ta=a(6);class fa{get tzm(){return Object(ta.a)("AccCheckerContentNotFoundDialogActionButton")}get uzm(){return Object(ta.a)("AccCheckerContentNotFoundDialogBody")}get vzm(){return Object(ta.a)("AccCheckerContentNotFoundDialogTitle")}get Ktn(){return Object(ta.a)("AccCheckerOutOfSyncNotificationMessageBody")}get $Ie(){return Object(ta.a)("AccCheckerPaneTitle")}get Cun(){return Object(ta.a)("AccCheckerPartialResultNotification")}}
Object(c.a)(fa,"AccessibilityCheckStringsProvider",null,[377]);class Ta{constructor(){this.q0l=this.contentId=null}}Object(c.a)(Ta,"ResultIds",null,[]);var ha=a(3),qa=a(28);class ra{constructor(Z,Ka){this._element=null;this.wu=Ka;this.yr=Z}get element(){this._element||(this._element=this.Dmf(),this.Jz());return this._element}Svb(Z){this._element=Z}dispose(){this.element&&(this.xFa(),this.Svb(null))}Jz(){this.wu&&this.yr?(this.wu.Zb(ha.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),
this.yr.Zb(ha.a.Lj,this.element,Object(e.a)(this,this.uQl,"onKeyPress"))):f.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}xFa(){this.wu&&this.yr&&(this.wu.jc(ha.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.yr.jc(ha.a.Lj,this.element,Object(e.a)(this,this.uQl,"onKeyPress")))}onClick(){this.rQl();return!0}uQl(Z){return this.a5m(Z.Sb.keyCode)?(this.rQl(),!0):!1}a5m(Z){return Z===
qa.a.Wue||Z===qa.a.hv}}Object(c.a)(ra,"AInteractivePaneElement",null,[413,24]);const I=(Z,Ka,zb)=>{Z=document.createElement(Z);Ka&&(Z.id=Ka);zb&&(Z.className=zb);Z.setAttribute("Unselectable","on");return Z};var ba=a(135),Ga=a(366),Oa=a(22);class Ja extends ra{constructor(Z,Ka,zb){super(Z,Ka);this.ikm=zb}hide(){this.element.removeAttribute(Ga.a.pi);Ga.a.Uia(this.element,Ga.a.RM,Ga.a.uE);this.element.style.display="none"}show(){Ga.a.Uia(this.element,Ga.a.RM,Ga.a.ksa);Ga.a.Uia(this.element,Ga.a.pi,
Ga.a.qze);this.element.style.display="block"}Dmf(){const Z=I("div",this.AOl,"AccCheckerNotification");Ga.a.Uia(Z,Ga.a.Nbh,Ga.a.uE);Ga.a.Uia(Z,Ga.a.rma,this.uXj);Z.tabIndex=0;const Ka=I("span",this.zOl,"AccCheckerNotificationIcon");var zb=ba.a(16,16,"Info_16x16x32","",!0,"");Ka.appendChild(zb);zb=I("span",this.uXj,"AccCheckerNotificationText");Oa.a.SA(zb,this.BOl);Z.appendChild(Ka);Z.appendChild(zb);return Z}rQl(){this.ikm()}}Object(c.a)(Ja,"APopupNotification",ra,[520,413,24]);class Qa extends Ja{constructor(Z,
Ka,zb,dc){super(Z,Ka,zb);this.Yyb=dc}get AOl(){return"AccCheckerOutOfSyncNotificationId"}get zOl(){return"AccCheckerOutOfSyncNotificationIconId"}get uXj(){return"AccCheckerOutOfSyncNotificationTextId"}get BOl(){return this.Yyb.Ktn}}Object(c.a)(Qa,"OutOfSyncNotification",Ja,[]);class Pa extends Ja{constructor(Z,Ka,zb,dc){super(Z,Ka,zb);this.Yyb=dc}get AOl(){return"AccCheckerPartialResultNotificationId"}get zOl(){return"AccCheckerPartialResultNotificationIconId"}get uXj(){return"AccCheckerPartialResultNotificationTextId"}get BOl(){return this.Yyb.Cun}}
Object(c.a)(Pa,"PartialResultNotification",Ja,[]);var ja=a(349),va=a(63);class Ha{constructor(Z,Ka,zb,dc,Jc,jd,Ed){Jc=void 0===Jc?null:Jc;jd=void 0===jd?null:jd;this.Zal=this.K7=this.yr=this.k2c=null;this.zbc=void 0===dc?null:dc;this.wu=Z;this.Je=Ka;this.yV=zb;this.Yyb=(void 0===Ed?null:Ed)||new fa;this.tPh=Jc||new Qa(this.zbc,this.wu,Object(e.a)(this,this.MEm,"dimissOutOfSyncNotification"),this.Yyb);this.PPh=jd||new Pa(this.zbc,this.wu,Object(e.a)(this,this.NEm,"dimissPartialResultNotification"),
this.Yyb)}show(){}hide(){}get zbc(){return this.yr||(this.yr=h.AFrameworkApplication.Ea.gI)}set zbc(Z){this.yr=Z}Odh(){}Tw(){}dispose(){}Z8l(){}IMe(){}g3m(Z){var Ka=this.Zal[Z];Z=Ka.contentId;if((Ka=Ka.q0l+"")&&Ka.length){const zb=[];Array.add(zb,Object.assign(new y.a,{name:"RuleID",string:Ka}));m.a.sendTelemetryEvent(Object.assign(new z.a,{name:String.format("{0}.{1}",Ha.wPk,"ViolationSelected"),dataFields:zb}))}this.zmn(Z)}zmn(Z){Z&&this.k2c.TLn(Z)||(this.Je.yia(ja.AFrame.Z2,!1),this.APn())}MEm(){this.O4l(!1);
this.IMe()}NEm(){this.Q4l(!1);this.IMe()}APn(){const Z=Object.assign(new va.a(!0),{zz:h.AFrameworkApplication.vEa,gf:1,QYc:!1});Z.uvb(1);Z.Fg(1,this.Yyb.tzm);Z.Fg(0,Object(ta.a)("DialogCancel"));Z.m7(this.Yyb.vzm,this.Yyb.uzm,Ka=>{1===Ka&&this.Fej()})}evm(Z){let Ka=null;if(Z.Results&&0<Z.Results.length){Ka={};let zb=0;for(const dc of Z.Results)dc.ResultId=Ha.vnm+ ++zb,Z=new Ta,Z.contentId=dc.ContentId,Z.q0l=dc.RuleId,Ka[dc.ResultId]=Z}return Ka}P$m(){m.a.addNamespaceMapping(Ha.wPk,Ha.ITn);m.a.sendTelemetryEvent(Object.assign(new z.a,
{name:String.format("{0}.{1}",Ha.wPk,"ShowTaskpane")}))}}Ha.vnm="AccCheckResult";Ha.wPk="Office.UX.AccChecker";Ha.ITn="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(c.a)(Ha,"BaseAccessibilityCheckPane",null,[378,24]);class gb{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=
this.updateLastScanTime=null}}Object(c.a)(gb,"AccCheckerTaskPaneProps",null,[]);var Gb=a(1643),Mb=a(521);class hb{constructor(){this.z7g=new M.a}wUc(Z){this.z7g.add(Z)}UBk(Z){for(const Ka of this.z7g)Ka(Z)}}Object(c.a)(hb,"ReactTaskPaneManager",null,[410]);var Da=a(1028),Bb=a(55);class Za extends Ha{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne){Jc=void 0===Jc?null:Jc;Ne=void 0===Ne?null:Ne;super(Ka,zb,dc,void 0===jd?null:jd,void 0,void 0,void 0===de?null:de);this.b4k=null;this.Ial=this.OPh=this.R9g=this.r$g=
this.o$g=!1;this.cWh=null;this.OUh=!!h.AFrameworkApplication.Ea&&!!h.AFrameworkApplication.Ea.Kb&&h.AFrameworkApplication.Ea.Kb.qlh;this.DXe=this.I8a=null;this.SYe=0;this.G8g=null;this.tEh=Jc;Ne&&(this.I8a=Ne.Cnm,this.DXe=Ne.AJm,this.SYe=Ne.DYm);this.I9b=new hb}get isVisible(){return this.Ial}Fed(Z){this.Ial=Z}Dvi(Z){Z&&(this.b4k=Z,Z.IsSuccess&&(this.Zal=this.evm(Z),Z.IsPartialResult&&this.Q4l(!0)),this.o$g=!0,this.r$g=!1,this.N3g())}O4l(Z){this.isVisible&&Z!==this.R9g&&(this.R9g=Z,this.N3g())}Q4l(Z){this.OPh=
Z;this.N3g()}Rn(){this.r$g||Bb.a.Py().then(Z=>{Mb.a.instance.FZ(Za.Cgd+":PaneOpen:Start");Z.showTaskPane(Za.Cgd,this.OYa());this.Fej();return null});this.isVisible?Bb.a.Py().then(Z=>{var Ka;Z.setSelectedTaskPane(Za.Cgd);(null===(Ka=h.AFrameworkApplication.ga)||void 0===Ka?0:Ka.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTOAccessibilityPaneFocusFix"))&&this.p2l();return null}):this.P$m()}N3g(){Bb.a.Py().then(Z=>{Z.updateTaskPane(Za.Cgd,this.OYa());return null})}OYa(){var Z=new gb;
this.I9b.UBk(Z);Z=Object.assign(new Da.a,{title:this.Yyb.$Ie,hideHeader:!1,width:320,location:2,contentProps:Z,onOpen:()=>{this.p2l();this.Fed(!0);h.AFrameworkApplication.Ea.Zf()},onClose:()=>{this.hwh();this.Fed(!1);this.r$g=this.o$g=!1;this.N3g();h.AFrameworkApplication.Ea.Zf()},isModernPane:!0});this.OUh&&(Z.enableResize=!0,Z.minResizeWidth=268,Z.maxResizeWidth=920);return Z}initialize(Z){const Ka=this.Je.gd(Za.Cgd);Ka.parent=ja.AFrame.vl;Ka.$V=!0;this.k2c=Z;this.Knm()}dispose(){this.Z8l();this.tPh&&
(this.tPh.dispose(),this.tPh=null);this.PPh&&(this.PPh.dispose(),this.PPh=null);super.dispose()}Knm(){this.I9b.wUc(this.onRecheckExecute());this.I9b.wUc(this.qLm());this.I9b.wUc(this.pSm());this.I9b.wUc(this.onInvokeNavigateExecute());this.I9b.wUc(this.pPm());this.I9b.wUc(this.gRm());this.I9b.wUc(this.wRm());this.I9b.wUc(this.updateLastScanTime());this.I9b.wUc(this.showHelpPane())}onRecheckExecute(){return Z=>{Z.onRecheckExecute=()=>{this.Fej()}}}qLm(){return Z=>{Z.accessibilityCheckResultCollection=
this.b4k}}pSm(){return Z=>{Z.resultsReady=this.o$g}}onInvokeNavigateExecute(){return Z=>{Z.onInvokeNavigateExecute=Ka=>{this.g3m(Ka)}}}pPm(){return Z=>{Z.helpLink=this.VHm}}gRm(){return Z=>{Z.outOfSync=this.R9g}}wRm(){return Z=>{Z.partialResult=this.OPh}}updateLastScanTime(){return Z=>{Z.updateLastScanTime=Ka=>{this.cWh=Ka}}}showHelpPane(){return Z=>{Z.showHelpPane=()=>{h.AFrameworkApplication.ga&&h.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?
h.AFrameworkApplication.bZa||this.Wgl()?this.G8g?this.G8g():this.I8a.value&&this.DXe&&this.SYe&&this.I8a.value.Qa(this.SYe,2,this.DXe):this.q5l():this.Wgl()?this.G8g?this.G8g():this.I8a.value&&this.DXe&&this.SYe&&this.I8a.value.Qa(this.SYe,2,this.DXe):this.q5l()}}}Wgl(){return!this.tEh||!this.tEh.value}q5l(){const Z=this.tEh.value;if(Z){var Ka={};Ka.query=Za.alm+Za.TJh;Ka=Object.assign(new Gb.a,{nonPersistedSettings:Ka});Z.mFa(Za.SJh,Ka)}}Fej(){this.OPh=this.R9g=this.o$g=!1;this.cWh&&this.cWh();this.N3g();
this.r$g=!0;this.k2c.bZj()}p2l(){this.Je.gh(Za.Cgd)}hwh(){this.pqj()&&this.Je.gh(this.Je.SDa)}pqj(){return!!this.Je.currentScope&&this.Je.currentScope.name===Za.Cgd}}Za.Cgd="AccessibilityCheckerPane";Za.TJh="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Za.SJh="FA000000012";Za.alm="AssetID=";Object(c.a)(Za,"ReactAccessibilityCheckPane",Ha,[]);class mb{constructor(Z,Ka,zb){this.Cnm=Z;this.AJm=Ka;this.DYm=zb}}Object(c.a)(mb,"HelpPaneProperties",null,[]);var vb=a(61),sb=a(251);class bc extends Za{constructor(Z,
Ka,zb,dc,Jc,jd,Ed,de){super(null,Ka,zb,dc,void 0,null,void 0,void 0,new mb(Ed,bc.ICf(),sb.a.mFa));this.Tgg=Z;this.Ban=Jc;this.EU=jd;this.ybg=Ed;this.qy=de}get isVisible(){return!!this.Tgg&&this.Tgg.isVisible}Fed(Z){this.Tgg&&(this.Tgg.isVisible=Z)}get VHm(){return this.Ban}Rn(){this.Fed(!0);this.EU.l7(this.Tgg,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,ja.AFrame.Z2);super.Rn();if(this.ybg){var Z=this.ybg.value;if(Z){Z.Cb(sb.a.Wsd,1);Z=!1;try{this.qy.selectRibbonTabById("AccessibleAuthoring"),
Z=!0}catch(Ka){D.a.J(507843655,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",Ka.toString())}vb.a("AccessibleAuthoringTab",Z)}else D.a.J(507843656,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else D.a.J(507843657,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")}Tbd(){}onBeforeLoadContent(){}onAfterLoadContent(){this.k2c&&this.k2c.m1j()}onAfterFirstSaveContent(){}static ICf(){const Z=
{};Z.JB=ResourceStrings.L_Help;Z.assetId="FA000000012";Z.nonPersistedSettings={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};return Z}}Object(c.a)(bc,"PptReactAccCheckControl",Za,[182]);class yb{constructor(){this.$=null}get name(){return"PowerPointWebEditor.Accessibility"}lc(Z){this.$=Z;this.$.register(Y,"PowerPointWebEditor.Accessibility.PptAccCheckService").as("PowerPointWebEditor.Accessibility.IPptAccCheckService").as("Common.App.AccessibilityChecker.IAccessibilityCheckService").ma().na(()=>
new Y(this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.$.resolve("PowerPointWebEditor.IPresentationResourcesManager")));this.$.register(378,"Common.App.AccessibilityChecker.IAccessibilityCheckPane").ma().na(()=>new bc(this.$.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.$.resolve("Common.IClickInputManager"),this.$.resolve("Common.IFocusManager"),this.$.resolve("Common.IF6Manager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").yJe,this.$.resolve("PowerPointWebEditor.ITaskPaneManager"),
this.$.ge("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IRibbonUser")));this.$.register(57,"Common.App.AccessibilityChecker.IAccessibilityCheckManager").ma().na(()=>new N(this.$.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),this.$.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.$.resolve("PowerPointWebEditor.IPPTWorkspace"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.IPresentationReader")))}init(){}dispose(){this.$.resolve("PowerPointWebEditor.IApplicationSettings").Ssb&&(this.$.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService").dispose(),this.$.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane").dispose(),this.$.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager").dispose())}static main(){b.a.instance.Fc(new yb)}}
Object(c.a)(yb,"PptAccessibilityPackage",null,[3,4]);var uc=a(45),vc=a(1594),wc=a(181),ub=a(72),aa=a(700),Na=a(269),ia=a(323);class wa{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne){this.ia=Z;this.la=Ka;this.Can=zb;this.Dan=dc;this.$mb=Jc;this.qy=Ed;this.Mad=jd;this.Ma=de;this.oc=Ne;this.Mad.tel(Object(e.a)(this,this.wXl,"refreshAccCheckButtonStatus"))}Hb(){this.la.Ssb&&(this.ia.sa(sb.a.GDg,Na.a.application,Object(e.a)(this,this.Vwm,"checkAccessibility"),4),this.ia.sa(sb.a.qWl,Na.a.application,Object(e.a)(this,
this.xBn,"queryCheckAccessibility"),97))}ve(){this.la.Ssb&&this.Ma.gd(ia.a.uch).bindAction(ub.a.eb(qa.a.Yve,ub.a.Ke|1),sb.a.GDg)}Vwm(Z,Ka,zb,dc,Jc){return 1===zb?this.oc.hl()?this.Dan.m3m?32:8:8:this.Can.Rn(Z,Ka,zb,dc,Jc)}xBn(Z,Ka,zb,dc,Jc){Jc[aa.a.On]=this.$mb.isVisible;return 32}dispose(){this.Mad.IYl(Object(e.a)(this,this.wXl,"refreshAccCheckButtonStatus"))}wXl(){this.qy.BB()}}Object(c.a)(wa,"AccCheckActor",null,[743,24]);class pa{constructor(){this.RZf=this.$=null}get name(){return"PowerPointWebEditor.LazyActors"}lc(Z){this.$=
Z}init(){this.$.resolve("PowerPointWebEditor.IAppBootCompletedListener").Uxa(()=>{this.dEe()})}dEe(){const Z=this.$.resolve("Common.AFrameworkApplication").Om.Md,Ka=this.$.resolve("Common.IActionManagerExtended");Z.Ssb&&(this.RZf=new wa(Ka,Z,this.$.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager"),this.$.resolve("PowerPointWebEditor.Accessibility.IPptAccCheckService"),this.$.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.$.resolve("PowerPointWebEditor.IPresentationResourcesManager"),
this.$.resolve("PowerPointWebEditor.IRibbonUser"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("PowerPointWebEditor.IPresentationReader")),this.RZf.Hb(),this.RZf.ve());Z.Rlh&&uc.a.get_instance().$i(7,Object(e.a)(this,this.Rlh,"loadInternalSlice"))}Rlh(){const Z=vc.a.create("pptedit.internal",null,()=>a.e(28).then(a.bind(null,1691)));wc.a.HL(Z)}dispose(){this.RZf&&this.RZf.dispose()}static main(){b.a.instance.Fc(new pa)}}Object(c.a)(pa,"PptLazyActorsPackage",null,[3,4]);var Ea=
a(492),La=a(432),Aa=a(719),nb=a(363),Wa=a(354),ea=a(274),Kb=a(268),kc=a(285),ac=a(283),eb=a(691);class Hb{constructor(Z,Ka,zb,dc,Jc,jd,Ed){this.Xe=1;this.s8=new nb.a;this.Lw=new nb.a;this.zs=!1;this.nJl="";this.MHj=this.OHj=this.Uca=this.Xbc=this.xqb=!1;this.Yll=()=>{this.Uca||this.OHj||(this.qGe||(this.qGe=new H.a(3,1,this.la.wIk,this.dismissImageDescriptionBarTask,90,"19")),this.Uca=!0,this.Tb.Qb(this.qGe))};this.Enl=()=>{this.Uca&&(this.Uca=!1,this.Tb.li(this.qGe),this.qGe=void 0)};this.Oqn=()=>
{this.OHj=!0;this.Enl();return!0};this.Pqn=()=>{this.OHj=!1;this.Yll();return!0};this.lqn=de=>this.LPl(de);this.lon=()=>{this.ia.Cb(sb.a.$ud,2);this.XAe();return!0};this.LPl=()=>{this.ia.Cb(sb.a.L6c,2);this.XAe();return!0};this.onSelectionChange=()=>{this.XAe()};this.dismissImageDescriptionBarTask=()=>{this.XAe()};if(!Z)throw Error.argumentNull("shapeNode");if(!Ka)throw Error.argumentNull("taskManager");if(!dc)throw Error.argumentNull("appSettings");if(!jd)throw Error.argumentNull("clickInputManager");
if(!Ed)throw Error.argumentNull("pptSelectionManager");this.ra=Z;this.Tb=Ka;this.rf=zb;this.la=dc;this.ia=Jc;this.ef=jd;this.ob=Ed}GAm(){this.U5=Kb.a.hg();this.U5.className="ImageDescriptionBarNew";this.ef.Zb(ha.a.click,this.U5,this.lqn);La.a.instance.Zb(ha.a.d2,this.U5,this.Oqn);La.a.instance.Zb(ha.a.e2,this.U5,this.Pqn);this.sDj=Kb.a.yx();this.LYd=document.createElement(Kb.a.poc);this.LYd.className="ImageDescriptionBarNewButton";this.LYd.appendChild(Object(eb.b)("M 768 1660 l -666 -666 l 73 -72 l 593 593 l 1105 -1105 l 73 72 z",
20,20).ta);var Z=Kb.a.yx();Z.innerText=ResourceStrings.L_ImageDescriptionBarApprove;this.LYd.appendChild(Z);this.ef.Zb(ha.a.click,this.LYd,this.lon);this.b2f=document.createElement(Kb.a.poc);this.b2f.className="ImageDescriptionBarNewButton";this.b2f.appendChild(Object(eb.b)("M 1879 169 q 39 39 59 88 q 20 50 20 102 q 0 51 -20 100 q -20 50 -59 89 l -1221 1215 l -556 183 l 195 -574 l 1203 -1203 q 38 -38 86 -57 q 48 -19 99 -19 h 4 q 53 0 103 19 q 49 19 87 57 m -1440 1206 q 85 26 147 87 q 61 62 87 147 l 995 -995 l -234 -234 m -1194 1428 l 345 -127 q -6 -43 -24 -80 q -19 -37 -48 -66 q -29 -29 -66 -48 q -37 -18 -80 -24 m 1440 -987 q 24 -24 37 -55 q 12 -30 12 -62 q 0 -33 -13 -63 q -13 -30 -35 -53 q -23 -22 -53 -36 q -31 -13 -66 -13 q -32 0 -63 12 q -31 12 -54 35 l -66 66 l 235 235 z",
20,20).ta);Z=Kb.a.yx();Z.innerText=ResourceStrings.L_ImageDescriptionBarEdit;this.b2f.appendChild(Z);this.ef.Zb(ha.a.click,this.LYd,this.LPl);this.U5.appendChild(this.sDj);this.U5.appendChild(this.LYd);this.U5.appendChild(this.b2f)}H9l(Z){const Ka=Z.indexOf("\n");this.nJl=-1===Ka?Z:Z.substring(0,Ka);this.sDj.innerText=ResourceStrings.L_ImageDescriptionBarFormatString.replace("{0}",this.nJl);this.gXk(!0)}gXk(Z){this.Dp=this.ra.wt;this.Xbc=Z;this.Hsh();this.U5.style.display=this.Xbc?ac.a.r_:ac.a.Sf;
this.Yll()}XAe(){if(this.xqb){this.Xbc=this.xqb=!1;this.ob.Bbb(this.onSelectionChange);this.Enl();this.aog&&this.aog.contains(this.U5)&&this.aog.removeChild(this.U5);const Z=Date.now()-this.Ben,Ka=new y.a;Ka.name="IsMisaligned";Ka.int64=this.MHj?1:0;vb.a("AltTextBar",!0,Z,[Ka])}}Hsh(){if(this.xqb&&this.Dp){var Z=this.Dp.copy();this.s8.gl(Z);this.Lw.gl(Z);var Ka=Aa.a.kN(ea.a.gG(Z.ha(0),Z.ha(1))),zb=Z.zj(new Wa.a(6)),dc=Z.zj(new Wa.a(4));Z=Z.zj(new Wa.a(2));Z=ea.a.Pm(dc,Z)*this.Xe;zb=ea.a.Pm(zb,dc)*
this.Xe;this.U5.style.position=ac.a.tFa;if(45<=Ka&&135>Ka||225<=Ka&&315>Ka){if(150>Z||70>zb){this.Xbc=!1;return}this.U5.style.marginLeft=(.5*(zb-Z)).toString()+"px";this.U5.style.marginTop=(.5*(zb+Z)-this.U5.offsetHeight).toString()+"px";this.U5.style.width=Z.toString()+"px"}else{if(150>zb||70>Z){this.Xbc=!1;return}this.U5.style.marginLeft="0";this.U5.style.marginTop=(Z-this.U5.offsetHeight).toString()+"px";this.U5.style.width=zb.toString()+"px"}this.MHj=0!=Ka%90}}TPn(Z){this.Ben=Date.now();this.U5&&
this.aog&&(this.xqb=!0,this.MHj=!1,this.aog.appendChild(this.U5),this.ob.QM(this.onSelectionChange),this.H9l(Z))}JXn(Z){this.ra===Z&&this.xqb&&this.H9l(this.ra.pud)}get visible(){return this.Xbc}set visible(Z){this.xqb&&(this.Xbc!==Z&&(this.Xbc=Z,this.U5.style.display=this.Xbc?ac.a.r_:ac.a.Sf),this.Xbc||this.XAe())}xq(Z){this.aog=Z.ta;this.GAm()}setPosition(){}Yi(Z){this.Xe=Z;this.xqb&&this.Hsh()}Vu(Z){this.s8=Z;this.xqb&&this.Hsh()}Kz(Z){this.Lw=Z;this.xqb&&this.Hsh()}setZIndex(Z){this.xqb&&(this.U5.style.zIndex=
Z.toString())}KR(Z){if(this.xqb&&!this.zs)switch(Z){case 1:this.rf&&(Z=this.rf.Yp("formatpainterobject.cur"),this.U5.style.cursor=Kb.a.qX(Z,kc.a.xZc));break;case 0:this.U5.style.cursor=kc.a.xZc}}vP(){return null}hG(){}LP(Z,Ka){this.xqb&&(this.gXk(!Z&&Ka||!Ka),!Z&&this.qGe&&this.Tb.Eta(this.qGe,this.la.wIk))}Qt(){return null}YZ(){return!1}hD(Z){this.zs=Z}setSelection(){}iL(){return[]}draw(){this.xqb&&this.gXk(!0)}dispose(){this.XAe();this.U5&&(this.b2f=this.LYd=this.sDj=this.U5=void 0)}}Object(c.a)(Hb,
"ImageDescriptionBarViewNew",null,[1360,760,301,24]);var ua=a(1233),Va=a(5),Yb=a(256);class Cb{constructor(Z,Ka,zb,dc){this.shapeNode=Z;this.twf=Ka;this.B5m=zb;this.imageDescription=dc}}Object(c.a)(Cb,"ImageDescriptionCache",null,[]);var ca=a(376);class Ra{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf){this.fob=new ua.a;this.w3m=yg=>{[yg]=Object(eb.c)(yg);return yg};this.xb=Z;this.qm=Ka;this.Nq=Ed;this.gGe=zb;this.ob=dc;this.u3=jd;this.IMa=Jc;this.Iz=de;this.Mb=Ne;this.uc=Re;this.loh=Cf}initialize(){this.Iz.Am(Object(e.a)(this,
this.Gh,"onPropertyChanged"));this.Nq.Vah(Object(e.a)(this,this.Ucc,"onShapeImageFirstDraw"));this.Nq.Nel(Object(e.a)(this,this.FQl,"onLocalImageViewDismissed"));this.gGe.Kel(Object(e.a)(this,this.jQl,"onImageDescriptionReady"))}dispose(){this.Iz.Pq(Object(e.a)(this,this.Gh,"onPropertyChanged"));this.Nq.yLe(Object(e.a)(this,this.Ucc,"onShapeImageFirstDraw"));this.Nq.ZYl(Object(e.a)(this,this.FQl,"onLocalImageViewDismissed"));this.gGe.VYl(Object(e.a)(this,this.jQl,"onImageDescriptionReady"))}Gh(Z,
Ka){if((Z=Ka.node)&&Z.Kg)if(Ka=Ka.property,Ka===Yb.a.alt){Ka=Object(v.a)(284,Z.tc(this.xb.Oa));const zb=Z.get_alt();zb&&this.w3m(zb)&&(Ka&&Ka.TK&&Z.get_alt()&&(Ka=this.loh.w$(Z))&&Ka.JXn(Z),this.IMa.bXn(Z),Z.get_alt()&&this.oxh(Z,Z.get_alt()))}else Ka===Yb.a.zF?Z.zF&&(Ka=Object(v.a)(284,Z.tc(this.xb.Oa)))&&Ka.TK&&(Z=this.loh.w$(Z))&&(Z.visible=!1):Ka===Yb.a.Vg&&Z.Vg!==ca.a.jS?(Ka=Object(v.a)(284,Z.tc(this.xb.Oa)))&&Ka.TK&&!Z.cka&&this.fob.ha(Z.id)&&this.fob.ha(Z.id).twf&&(this.Bzf(Z,Ka),this.fob.remove(Z.id)):
Ka===Yb.a.isDecorative&&(Z=this.loh.w$(Z))&&(Z.visible=!1)}jQl(Z,Ka){if(Z=Ka.vLd){var zb=Ka.confidence,dc=Ka.imageDescription,Jc=Ka.tCl;Ka=Ka.twf;var jd=this.u3.Ifa(Z),Ed=jd?Object(v.a)(284,jd.tc(this.xb.Oa)):null;Ka?Ed&&Ed.TK&&!jd.isLocal&&!jd.zF?this.Bzf(jd,Ed):this.fob.add(Z,new Cb(jd,!0,!0,dc)):!dc||!Jc&&60>zb?D.a.J(509092041,815,15,"isGenerateSuggestion: {0}, confidence: {1}",Jc,zb):(dc=this.Kym(zb,dc),Jc?this.Myk(jd,dc,!1):(D.a.J(509092040,815,50,"Image description ready for show and save"),
Ed&&Ed.TK?(D.a.J(509092039,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",Z.toString(),(new Date).getTime()),this.oxh(jd,dc),jd.isLocal?this.fob.add(Z,new Cb(jd,!1,!1,dc)):(D.a.J(509092038,815,50,"Save image description immediately"),this.Myk(jd,dc,!0))):this.fob.add(Z,new Cb(jd,!1,!0,dc))))}else D.a.J(509092042,815,15,"Graph node id is null")}Ucc(Z,Ka){Z=Ka.vLd;D.a.J(509092037,815,50,"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",Z?Z.toString():"",(new Date).getTime());
this.fob.Ob(Z)?this.bWl(Z):(Z=this.u3.Ifa(Z))&&Z.get_alt()&&this.oxh(Z,Z.get_alt())}Kym(Z,Ka){Ka+=String.fromCharCode(10,10);return Ka=80<=Z?Ka+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:60<=Z?Ka+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=Z?Ka+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=Z?Ka+ResourceStrings.L_ImageDescriptionWithLowConfidence:Ka+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence}FQl(Z,Ka){(Z=Ka.W5l)&&this.fob.Ob(Z.id)&&this.bWl(Z.id)}bWl(Z){const Ka=
this.fob.ha(Z).shapeNode;if(Ka){var zb=this.fob.ha(Z).twf,dc=this.fob.ha(Z).B5m,Jc=this.fob.ha(Z).imageDescription;zb?(zb=Object(v.a)(284,Ka.tc(this.xb.Oa)))&&this.Bzf(Ka,zb):(dc&&this.oxh(Ka,Jc),Ka.isLocal?D.a.J(509092035,815,15,"Try to save alt text for local picture"):this.Myk(Ka,Jc,!0));this.fob.remove(Z)}else D.a.J(509092036,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}Bzf(Z,Ka){this.qm.generateImageDescription(Z.id,Ka.ENe,Z.get_isSVGBlipFilled(),!1)}Myk(Z,Ka,zb){const dc=
Date.now();if(!zb||!Z.get_alt()){var Jc=this.Mb.qe(zb?7:15);Jc.rc(Z);Z.Wbb=zb;Z.set_alt(Va.a.Zyc(Ka));Jc.dispose();zb&&this.qm.forceOutbound();Z=Date.now()-dc;vb.a("UpdateAltText",!0,Z)}}oxh(Z,Ka){if(Z.Kg){this.uc.Cd(Z)&&D.a.J(509092033,815,50,"Graph node or parents blocked");var zb=this.ob.ud();zb&&this.ob.Y0(Z)?(D.a.J(509092003,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",Z.id.toString(),(new Date).getTime()),(Z=this.loh.w$(Z))&&Z.TPn(Ka)):D.a.J(509092032,
815,50,"Is selected shapes empty: {0}",!zb)}else D.a.J(509092034,815,50,"ShapeNode.IsPicture: {0}",Z.Kg)}}Object(c.a)(Ra,"ImageDescriptionManager",null,[24]);var bb=a(62),wb=a(476),Fa=a(267),rb=a(250);class $b{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah,Ui){this.mc=!1;this.wGj=new ua.a(0);this.Gh=($g,oh)=>{$g=oh.node;this.I3&&this.I3.includes($g)&&[Yb.a.alt,Yb.a.Eva,Yb.a.isDecorative].includes(oh.property)&&this.Jjh()};this.QLm=()=>{if(!this.I3||0===this.I3.length)return"";let $g="",oh=!0;
for(const Jh of this.I3){const ti=Jh.pud;if(!oh&&ti!==$g)return"";$g=ti;oh=!1}return $g};this.KNm=()=>{if(!this.I3||0===this.I3.length)return[!1,!1];let $g=!0,oh=!0;for(const Jh of this.I3)Jh.isDecorative?oh=!1:$g=!1;return[$g,!($g||oh)]};this.Jjh=()=>{if(this.I3&&0!==this.I3.length){this.tJl=this.L1a.checked;[this.mad,this.UTa.indeterminate]=this.KNm();this.UTa.checked=this.mad;this.UTa.disabled=!1;this.x4d.style.display=ac.a.Wm;this.EGj=this.QLm();this.N5.value=this.mad?ResourceStrings.L_ImageDescriptionPaneAltTextBoxDecorative:
this.EGj;this.N5.disabled=this.mad;this.sIj=this.y6m();var $g=!1;if(this.sIj){let oh;[$g,oh]=Object(eb.c)(this.N5.value);$g=$g&&0<oh}this.Qbc.style.display=$g||this.L1a.checked?ac.a.Wm:ac.a.Sf;this.$nb.style.display=!this.sIj||$g||this.L1a.checked?ac.a.Sf:ac.a.Wm;this.$nb.disabled=this.mad;this.acc.style.display=ac.a.Sf;""!==this.aob.innerText&&(this.aob.innerText="");this.fjf()}else this.N5.value="",this.N5.disabled=!0,this.$nb.style.display=ac.a.Sf,this.acc.style.display=ac.a.Sf,""!==this.aob.innerText&&
(this.aob.innerText=""),this.fjf(),this.Qbc.style.display=ac.a.Sf,this.x4d.style.display=ac.a.Sf};this.y6m=()=>this.I3?1===this.I3.length&&this.I3[0].Kg&&!this.I3[0].get_isSVGBlipFilled():!1;this.HZk=()=>{this.RXh(this.Rb);this.EU&&this.EU.l7(this,this.mc,ResourceStrings.L_ShapeAltTextNew,Fa.a.U_a)};this.agi=()=>{0!==this.tqh&&(window.clearTimeout(this.tqh),this.tqh=0)};this.fjf=()=>{0!==this.Qnh&&(window.clearTimeout(this.Qnh),this.Qnh=0)};this.jgl=()=>{var $g=Date.now();const oh=this.Qbc.style.display===
ac.a.Wm;oh&&(this.L1a.checked=!1,this.Qbc.style.display=ac.a.Sf,this.$nb.style.display=ac.a.Wm,this.acc.style.display=ac.a.Sf,""!==this.aob.innerText&&(this.aob.innerText=""),this.fjf(),this.oYl());this.agi();this.tqh=window.setTimeout(()=>{this.PQg()},500);if(!this.WIl){$g=Date.now()-$g;const Jh=new y.a;Jh.name="ApproveImplicitly";Jh.int64=oh?1:0;vb.d(sb.a.I8l,!0,"AltTextPane",1,12,$g,[Jh]);this.WIl=!0}};this.MVn=()=>{this.iwh();bb.FocusManager.UA(this.xv)||D.a.J(509092104,815,50,"Fail to set focus on close button")};
this.o2l=()=>{this.iwh();window.setTimeout(()=>{if(bb.FocusManager.UA(this.N5))return this.N5.selectionStart=0,this.N5.selectionEnd=0,!0;D.a.J(509092103,815,50,"Fail to set focus on alt text box");return!1},0)};this.iwh=()=>{this.Ma&&this.Ma.AS(Fa.a.U_a)};this.fAe=()=>{this.lca();return!0};this.oYl=()=>{const [$g,oh]=Object(eb.c)(this.N5.value);if($g){const Jh=this.N5.selectionStart,ti=this.N5.selectionEnd;this.N5.value=this.N5.value.substring(0,oh).trimEnd();this.N5.setSelectionRange(Jh,ti)}};this.z5h=
($g,oh)=>{var Jh=Date.now();const ti=!this.tJl;(this.L1a.checked=ti)?(this.Jmh=this.N5.value,this.oYl()):this.N5.value=this.Jmh;this.PQg();oh&&(oh=Date.now()-Jh,Jh=new y.a,Jh.name="CustomData1",Jh.int64=ti?1:0,vb.d(sb.a.$ud,!0,"AltTextPane",$g,12,oh,[Jh]))};this.Sgl=$g=>{$g.Sb.preventDefault();$g.Sb.stopPropagation();this.z5h(2,!0);window.setTimeout(()=>{this.L1a.checked=this.tJl},0);return!0};this.Tgl=$g=>$g.Sb.keyCode===qa.a.hv||$g.Sb.keyCode===qa.a.C7?($g.Sb.preventDefault(),$g.Sb.stopPropagation(),
this.z5h(1,!0),!0):!1;this.aNl=$g=>{var oh=Date.now();const Jh=!this.mad;this.UTa.indeterminate=!1;this.UTa.checked=Jh;this.$nb.disabled=Jh;this.Qbc.style.display=ac.a.Sf;(this.N5.disabled=Jh)?(this.Jmh=this.N5.value,this.N5.value=ResourceStrings.L_ImageDescriptionPaneAltTextBoxDecorative):this.N5.value=this.Jmh;this.PQg();oh=Date.now()-oh;const ti=new y.a;ti.name="CustomData1";ti.int64=Jh?1:0;vb.d(sb.a.Z8d,!0,"AltTextPane",$g,12,oh,[ti])};this.ZMl=$g=>{console.log("[markAsDecorativeClickHandler]",
this.UTa.checked);$g.Sb.preventDefault();$g.Sb.stopPropagation();this.aNl(2);window.setTimeout(()=>{this.UTa.checked=this.mad},0);return!0};this.$Ml=$g=>{console.log("[markAsDecorativeKeyDownHandler]",this.UTa.checked);return $g.Sb.keyCode===qa.a.hv||$g.Sb.keyCode===qa.a.C7?($g.Sb.preventDefault(),$g.Sb.stopPropagation(),this.aNl(1),!0):!1};this.lca=()=>{if(this.mc){var $g=Date.now();this.kfi();D.a.J(509092102,815,50,"ImageDescriptionPaneNew.closePane - Image Description pane close button clicked.");
$g=Date.now()-$g;const oh=new y.a;oh.name="CustomData1";oh.int64=0;vb.d(sb.a.R4c,!0,"AltTextPane",0,12,$g,[oh])}};this.dtl=()=>{this.Bzf();return!0};this.Bzf=()=>{var $g=Date.now();const oh=this.I3[0]?this.I3[0].tc(0):void 0;this.qm&&oh?(this.$nb.style.display=ac.a.Sf,this.acc.style.display=ac.a.r_,this.aob.innerText=ResourceStrings.L_ImageDescriptionPaneInProgress,this.fjf(),this.Qnh=window.setTimeout(()=>{this.acc.style.display=ac.a.Sf;""!==this.aob.innerText&&(this.aob.innerText="");vb.a("GeneratingAltTextMessageTimeout")},
15E3),this.MVn(),this.wGj.add(this.I3[0].id.toString(),this.I3[0].Vg),this.qm.generateImageDescription(this.I3[0].id,oh.ENe,this.I3[0].get_isSVGBlipFilled(),!0),$g=Date.now()-$g,vb.d(sb.a.atl,!0,"AltTextPane",0,12,$g)):D.a.J(509092101,815,15,"ImageDescriptionPaneNew.generateDescriptionForMe - Is shape node null or undefined {0}",!this.I3[0])};this.aXn=$g=>{$g=$g.Ae();this.Jmh="";this.PQg();this.I3=$g;this.WIl=this.L1a.checked=!1;this.Jjh()};this.onSelectionChange=$g=>{this.aXn($g);this.qj&&this.qj.Cr(Fa.a.U_a)};
this.RXh=$g=>{h.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass($g,"ImageDescriptionPaneRTL"):Sys.UI.DomElement.addCssClass($g,"ImageDescriptionPaneLTR")};this.PQg=()=>{this.agi();if(this.I3&&0!==this.I3.length){var $g=this.UTa.checked,oh=$g?"":this.N5.value;if(oh!==this.EGj||$g!==this.mad){var Jh=this.Mb.qe(15);if(Jh){Jh.rc(this.ob.ys());if($g)for(const ti of this.I3)ti.Wbb=!1,ti.isDecorative=!0;else for(const ti of this.I3)ti.Wbb=!1,ti.set_alt(oh),ti.set_altTitle("");Jh.dispose()}this.mad=
$g;this.EGj=oh;this.qy&&this.qy.BB()}}};this.g0l=$g=>$g.Sb.keyCode===qa.a.Q2||$g.Sb.keyCode===qa.a.gyb?($g.Sb.preventDefault(),$g.Sb.stopPropagation(),this.Ma.Wd(),!0):!1;this.oIk=$g=>{const oh=this.mc;$g?oh?(this.HZk(),this.o2l()):this.P1m():oh&&this.kfi();$g!==oh&&(this.qy&&this.qy.BB(),this.o8&&this.o8.BB());D.a.J(509092099,815,50,"ImageDescrptionPaneNew.showHideAltTextPaneInternal {0} to {1}",oh,$g)};this.P1m=()=>{this.Ma&&this.Ma.lm(Fa.a.U_a,!0);this.I3=this.ob.Ae();this.Jjh();this.mc=!0;this.Rb.appendChild(this.rBb);
this.Rb.style.display=ac.a.Wm;this.HZk();this.ob.QM(this.onSelectionChange);D.a.J(509092098,815,50,"ImageDescriptionPaneNew.initializeAndShowAltTextPane");if(this.ybg){try{var $g=this.ybg.value}catch(oh){D.a.J(509092096,822,10,"ImageDescriptionPaneNew: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab: {0}",oh.toString());return}if($g){$g.Cb(sb.a.Wsd,1);$g=!1;try{this.qy.selectRibbonTabById("AccessibleAuthoring"),$g=!0}catch(oh){D.a.J(509092066,822,10,"ImageDescriptionPaneNew: can't select ribbon tab AccessibleAuthoring: {0}",
oh.toString())}vb.a("AccessibleAuthoringTab",$g);this.o2l()}else D.a.J(509092067,822,10,"ImageDescriptionPaneNew: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else D.a.J(509092097,822,10,"ImageDescriptionPaneNew: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab"),rb.a("UpdateAltTextState")&&this.m9l()};this.kfi=()=>{this.mc&&(this.Ma&&this.Ma.lm(Fa.a.U_a,!1),this.ob.Bbb(this.onSelectionChange),this.PQg(),this.mc=!1,this.Rb.removeChild(this.rBb),
this.Rb.style.display=ac.a.Sf,this.HZk(),D.a.J(509092100,815,50,"ImageDescriptionPaneNew.cleanUpAndHideAltTextPane"),rb.a("UpdateAltTextState")&&this.m9l())};this.dispose=()=>{this.kfi();this.HE&&this.HE.jc(ha.a.Lj,this.Rb,this.g0l);this.ef.jc(ha.a.click,this.xv,this.fAe);this.L1d.removeHandler(this.N5,ha.a.input,this.jgl);this.ef.jc(ha.a.click,this.$nb,this.dtl);this.ef.jc(ha.a.click,this.z$c,this.Sgl);this.HE&&this.HE.jc(ha.a.Lj,this.L1a,this.Tgl);this.ef.jc(ha.a.click,this.Cad,this.ZMl);this.HE&&
this.HE.jc(ha.a.Lj,this.UTa,this.$Ml);this.Iz&&this.Iz.Pq(this.Gh);this.Sbg=this.zJj=this.UTa=this.Cad=this.x4d=this.B_f=this.sBj=this.L1a=this.z$c=this.Qbc=this.acc=this.aob=this.$nb=this.N5=this.tGj=this.moh=this.noh=this.xv=this.K6f=this.J6f=this.rBb=this.Rb=void 0;this.agi();this.fjf();D.a.J(509092065,815,50,"ImageDescriptionPaneNew.dispose")};this.layout=($g,oh)=>{const Jh=oh?$g.eP(this.width):$g.fP(this.width);this.mc&&(oh?(Sys.UI.DomElement.addCssClass(this.Rb,"ImageDescriptionPaneRTL"),Jh.eP(1)):
(Sys.UI.DomElement.addCssClass(this.Rb,"ImageDescriptionPaneLTR"),Jh.fP(1)));Kb.a.nda(this.Rb,Jh,!1);return $g};this.bXn=$g=>{this.sIj&&$g===this.I3[0]&&this.mc&&(this.wGj.Ob($g.id.toString())&&this.I3[0].Vg!==this.wGj.ha($g.id.toString())&&D.a.J(509092064,815,50,"ImageDescriptionPaneNew.updateAltTextbox - Image version have been changed after generate description"),this.Jjh())};this.K4l=()=>{this.oIk(!this.mc)};this.Rgl=()=>{this.oIk(!0);this.L1a.checked||this.z5h(0,!1)};this.Xeh=()=>{this.oIk(!0)};
if(!Ka)throw Error.argumentNull("frameContext");if(!dc)throw Error.argumentNull("clickInputManager");if(!jd)throw Error.argumentNull("selectionManager");if(!Ed)throw Error.argumentNull("focusManagerHelper");if(!de)throw Error.argumentNull("inputHandlerManager");if(!Ne)throw Error.argumentNull("transactionFactory");this.qj=Z;this.Db=Ka;this.Ma=Re;this.qm=zb;this.ef=dc;this.HE=Jc;this.ob=jd;this.eR=Ed;this.L1d=de;this.Mb=Ne;this.EU=Cf;this.ybg=yg;this.qy=bh;this.o8=Ah;this.Iz=Ui;this.Rb=Kb.a.hg();this.Rb.className=
"ImageDescriptionPaneNew";this.Rb.id="ImageDescriptionPaneNew";this.Rb.style.position=ac.a.tFa;this.Rb.setAttribute(Ga.a.pi,Ga.a.qzb);this.Rb.setAttribute(Ga.a.rma,"ImageDescriptionPaneLabel");this.HE&&this.HE.Zb(ha.a.Lj,this.Rb,this.g0l);this.rBb=Kb.a.hg();this.rBb.className="ImageDescriptionPaneLayoutRootNew";this.J6f=Kb.a.hg();this.J6f.className="ImageDescriptionPaneHeader";this.rBb.appendChild(this.J6f);this.K6f=Kb.a.hg();this.K6f.id="ImageDescriptionPaneLabel";this.K6f.className="ImageDescriptionPaneTitle";
this.K6f.innerText=ResourceStrings.L_ShapeAltTextNew;this.J6f.appendChild(this.K6f);this.xv=document.createElement(Kb.a.poc);this.xv.type="button";this.xv.setAttribute(Ga.a.yz,CommonUIStrings.l_DialogClose);this.xv.appendChild(Object(eb.b)(eb.a,20,20).ta);this.xv.className="ImageDescriptionPaneCloseButtonNew";rb.a("SvgCloseButton")&&(this.xv.className+=" SvgCloseButton");this.J6f.appendChild(this.xv);this.ef.Zb(ha.a.click,this.xv,this.fAe);this.noh=Kb.a.hg();this.noh.innerText=ResourceStrings.L_ImageDescriptionPaneLabelRefresh;
this.noh.className="ImageDescriptionLabelNew";this.rBb.appendChild(this.noh);this.moh=Kb.a.hg();this.moh.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.moh.className="ImageDescriptionHintNew";this.rBb.appendChild(this.moh);this.tGj=Kb.a.hg();this.N5=document.createElement(Kb.a.s7l);this.N5.className="AltTextTextAreaNew";this.N5.setAttribute(Ga.a.yz,ResourceStrings.L_ShapeAltTextNew);this.tGj.appendChild(this.N5);this.rBb.appendChild(this.tGj);this.L1d.addHandler(this.N5,ha.a.input,this.jgl);
Z=Kb.a.yx();Z.className="GenerateDescriptionButtonText";Z.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltipNew;this.$nb=document.createElement(Kb.a.poc);this.$nb.type="button";this.$nb.className="ImageDescriptionPaneGenerateButtonNew";this.$nb.appendChild(Z);this.rBb.appendChild(this.$nb);this.ef.Zb(ha.a.click,this.$nb,this.dtl);Z=Object(eb.b)("M1039.84,0.126321c261.41,4.108,517.2,108.271,709.24,300.861c292.63,293.471,379.52,734.393,220.11,1116.953c-154.43,370.6,-510.5,615.63,-909.38,629.51l-34.61,0.55l-16.1,-0.67c-72.623,-7.38,-129.295,-68.71,-129.295,-143.29c0,-74.57,56.672,-135.9,129.295,-143.28l12.8,-0.64c0,-0.07,0,-0.13,0,-0.19c297.81,0.84,566.77,-177.91,681.33,-452.82c114.55,-274.92,52.11,-591.774,-158.18,-802.668c-210.29,-210.893,-526.96,-274.235,-802.182,-160.458c-275.227,113.778,-454.739,382.239,-454.739,680.066l-288.129,0c0,-414.442,249.801,-788.021,632.795,-946.349c131.654,-54.426,270.122,-79.727,407.045,-77.575z",
16,16).ta;this.aob=Kb.a.yx();this.aob.setAttribute(Ga.a.pi,Ga.a.Sbh);this.aob.setAttribute(Ga.a.Vcf,Ga.a.Rbh);this.acc=Kb.a.hg();this.acc.className="ImageDescriptionPaneGeneratingMessage";this.acc.appendChild(Z);this.acc.appendChild(this.aob);this.rBb.appendChild(this.acc);this.Qbc=Kb.a.hg();this.Qbc.className="ImageDescriptionCheckboxContainer";this.z$c=document.createElement(Kb.a.nsj);this.z$c.setAttribute("for","ImageDescriptionCheckboxApprove");this.z$c.innerText=ResourceStrings.L_ApproveAltText;
this.Qbc.appendChild(this.z$c);this.L1a=Kb.a.Ozd();this.L1a.setAttribute("type","checkbox");this.L1a.setAttribute(Ga.a.I9,"ImageDescriptionTipApprove");this.L1a.id="ImageDescriptionCheckboxApprove";this.z$c.appendChild(this.L1a);this.sBj=Kb.a.yx();this.sBj.className="checkmark";this.z$c.appendChild(this.sBj);this.B_f=Kb.a.hg();this.B_f.className="ImageDescriptionInlineTip";this.B_f.innerText=ResourceStrings.L_ApproveAltTextTip;this.B_f.id="ImageDescriptionTipApprove";this.Qbc.appendChild(this.B_f);
this.rBb.appendChild(this.Qbc);this.ef.Zb(ha.a.click,this.z$c,this.Sgl);this.HE&&this.HE.Zb(ha.a.Lj,this.L1a,this.Tgl);this.x4d=Kb.a.hg();this.x4d.className="ImageDescriptionCheckboxContainer";this.Cad=document.createElement(Kb.a.nsj);this.Cad.setAttribute("for","ImageDescriptionCheckboxDecorative");this.Cad.innerText=ResourceStrings.L_MarkAsDecorative;this.x4d.appendChild(this.Cad);this.UTa=Kb.a.Ozd();this.UTa.setAttribute("type","checkbox");this.UTa.setAttribute(Ga.a.I9,"ImageDescriptionTipDecorative");
this.UTa.id="ImageDescriptionCheckboxDecorative";this.Cad.appendChild(this.UTa);this.zJj=Kb.a.yx();this.zJj.className="checkmark";this.Cad.appendChild(this.zJj);this.Sbg=Kb.a.hg();this.Sbg.className="ImageDescriptionInlineTip";this.Sbg.innerText=ResourceStrings.L_MarkAsDecorativeTip;this.Sbg.id="ImageDescriptionTipDecorative";this.x4d.appendChild(this.Sbg);this.rBb.appendChild(this.x4d);this.ef.Zb(ha.a.click,this.Cad,this.ZMl);this.HE&&this.HE.Zb(ha.a.Lj,this.UTa,this.$Ml);this.eR.pTa(Fa.a.U_a,Fa.a.vl,
this.Rb,()=>{},()=>{},!0);this.Iz&&this.Iz.Am(this.Gh);this.Qnh=this.tqh=0}m9l(){this.Db.nD({AlternativeText:"ToggleButtonModel"})}get width(){return this.mc?264+wb.a.XBa:0}get ta(){return this.Rb}get order(){return 10}get isVisible(){return this.mc}}Object(c.a)($b,"ImageDescriptionPaneNew",null,[1333,495,24]);var ec=a(664);class pc{constructor(){this.$=null}get name(){return"PowerPointWebEditor.ImageDescription"}lc(Z){this.$=Z;this.$.register(738,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>").ma().na(()=>
new ec.a(Ka=>{let zb=null;const dc=Object(v.a)(284,Ka.tc(Z.resolve("Box4.IPageView").Oa));dc&&!dc.isDisposed&&(zb=new Hb(Ka,this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPoint.IPathManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Common.IClickInputManager"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager")),zb.xq(dc.Jqa),dc.hzb(zb,4));return zb}));this.$.register(1333,"PowerPointWebEditor.IImageDescriptionPane").ma().na(()=>
new $b(this.$.resolve("Common.IF6Manager"),this.$.resolve("Box4.IAppFrame"),this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.$.resolve("Common.IClickInputManager"),this.$.resolve("Common.IKeyInputManager"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.$.resolve("PowerPointWebEditor.IInputHandlerManager"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("PowerPointWebEditor.IFocusManager"),
this.$.resolve("PowerPointWebEditor.ITaskPaneManager"),this.$.ge("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IRibbonUser"),this.$.resolve("PowerPointWebEditor.IContextMenuUser"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(10)));this.$.register(Ra,"PowerPointWebEditor.ImageDescriptionManager").ma().na(()=>new Ra(this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.$.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),
this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.IImageDescriptionPane"),this.$.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(10),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.$.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>")))}init(){this.$.resolve("PowerPointWebEditor.ImageDescriptionManager").initialize()}dispose(){this.$.resolve("PowerPointWebEditor.ImageDescriptionManager").dispose()}static main(){b.a.instance.Fc(Ea.a(new pc,
0))}}Object(c.a)(pc,"PPTWebEditorImageDescriptionPackage",null,[3,4]);var dd=a(119),Ad=a(30);class Jb extends Ad.a{constructor(){super()}static instance(){return Jb.Wa||(Jb.Wa=new Jb)}}Jb.Csn="OnTextSelectionHighlightChangeEvent";Jb.Wa=null;Object(c.a)(Jb,"TextSelectionHighlightChangeEvent",Ad.a,[]);class Bc extends dd.a{constructor(Z,Ka){super(!1,!1,!0);this.Vke=(zb,dc)=>{1===zb&&(this.Egd.Y8i=dc.tooltipPersistenceEnabled,zb=dc.textSelectionChangeEnabled,this.Egd.xZg!==zb&&this.Jmm.raiseEvent(Jb.Csn),
this.Egd.xZg=zb)};this.Egd=Z;this.Jmm=Ka}start(){const Z={["tooltipPersistenceEnabled"]:this.Egd.Y8i};Z.textSelectionChangeEnabled=this.Egd.xZg;this.Dq("",this.Vke,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:Z});f.ULS.sendTraceTag(507905246,324,50,"User opened the Accessibility Settings Dialog")}}Object(c.a)(Bc,"AccessibilitySettingsDialog",dd.a,[]);class Mc{constructor(Z,Ka){this.jPn=()=>{(new Bc(this.Egd,Jb.instance())).start();return 32};this.ya=Z;this.Egd=Ka}Hb(){this.ya.za(w.a.iPn,
r.a.frame,this.jPn)}}Object(c.a)(Mc,"AccessibilitySettingsDialogActor",null,[1459]);var ed=a(219);const Yc=Z=>{const Ka=new ed.a;h.AFrameworkApplication.ye.rk(jb(Z),1,null,null,!0,2,zb=>{200===zb.data.Ze?Ka.vj("true"===zb.data.responseData.toLowerCase()):Ka.vj(!1)},()=>{Ka.vj(!1)},null,void 0,void 0,void 0,void 0,"7");return Ka.task},ab=(Z,Ka)=>{h.AFrameworkApplication.ye.rk(jb(Z),2,Ka.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},jb=Z=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",
h.AFrameworkApplication.ga.appSettings.RoamingServiceHandlerWebServiceBase||"",Z,h.AFrameworkApplication.ui);var cc=a(51);class Hc{constructor(){this.gye=this.Rwe=null}get Y8i(){return!!this.Rwe}set Y8i(Z){Z!==this.Rwe&&(this.Rwe=Z,cc.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Z),this.flh()&&ab("saveHoverableRibbonTooltipIsEnabled",Z))}get xZg(){return!!this.gye}set xZg(Z){Z!==this.gye&&(this.gye=Z,this.flh()&&ab("saveTextSelectionHighlightChangeIsEnabled",Z))}k9m(){const Z=
new ed.a;if(this.Rwe)Z.vj(this.Rwe);else if(this.flh()){const Ka=Yc("getHoverableRibbonTooltipIsEnabled");Ka.continueWith(()=>{this.Rwe=Ka.result;cc.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Ka.result);Z.vj(Ka.result)},8)}else Z.vj(!1)}t9m(){const Z=new ed.a;if(this.gye)Z.vj(this.gye);else if(this.flh()){const Ka=Yc("getTextSelectionHighlightChangeIsEnabled");Ka.continueWith(()=>{this.gye=Ka.result;Z.vj(Ka.result)},8)}else Z.vj(!1)}flh(){const Z=h.AFrameworkApplication.ga.getBooleanAppSetting("IsRoamingServiceEnabled"),
Ka=h.AFrameworkApplication.ga.getBooleanAppSetting("IsAnonymousUser");return Z&&!Ka}}Object(c.a)(Hc,"AccessibilitySettingsInfo",null,[1386]);class Vc{constructor(){this.Ha=null}get name(){return"Common.App.AccessibilitySettings"}lc(Z){this.Ha=Z;this.Ha.register(Hc,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").na(()=>new Hc).ma();this.Ha.register(Mc,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").na(()=>
new Mc(h.AFrameworkApplication.vb,this.Ha.yb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ma()}init(){const Z=this.Ha.yb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),Ka=this.Ha.yb("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");Z&&Ka?(Ka.Hb(),Z.k9m(),Z.t9m(),A.c(508827098,200,50,"Text Selection Highlight Change Setting value on boot: {0}",Z.xZg)):A.c(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){b.a.instance.Fc(new Vc)}}
Object(c.a)(Vc,"AccessibilitySettingsPackage",null,[3,4]);var Tc=a(13),cd=a(85),Lb=a(1341),Rc=a(33),md=a(1145);class Zc extends va.a{constructor(Z,Ka,zb,dc){dc=void 0===dc?null:dc;super();this.Z8a=this.nP=this.N2c=null;this.Ip=[];this.Nzg=Jc=>{this.nP&&(this.nP.target="_blank",this.nP.submit());Jc.preventDefault()};this.Qol=()=>{f.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};this.FAn=()=>{f.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");
this.ilc&&this.ilc.stop()};this.V9g=Ka;this.zV=Z;this.nim=zb;this.v$g=dc;this.ilc=new md.a("LoadResource","LoadPrintablePdf")}P9a(){this.gf=5;this.width=40;const Z=document.createElement("span");Z.id=this.ap("DirectPrintHeaderContent");const Ka=document.createElement("span");Ka.innerText=Object(ta.a)("DirectPrintDialogHeader");Sys.UI.DomElement.addCssClass(Ka,"DirectPrintHeader");this.Z8a=document.createElement("iframe");this.Z8a.name="pdfObjectFrame";this.Z8a.title=Object(ta.a)("DirectPrintDialogIFrame");
this.Z8a.onload=this.FAn;if(this.v$g&&0<this.v$g.count){var zb=Rc.a.mSi(this.V9g,this.v$g);const dc=Rc.a.Enk(this.V9g,this.v$g);this.nP=document.createElement("form");this.nP.id="printPreviewPostForm";this.nP.method="POST";this.nP.target=this.Z8a.name;this.nP.action=dc;for(const Jc of zb)zb=document.createElement("input"),zb.type="hidden",zb.name=Jc.key,zb.value=Jc.value,this.nP.appendChild(zb)}else this.Z8a.setAttribute("src",this.V9g);Sys.UI.DomElement.addCssClass(this.Z8a,cd.a.C$k);this.nim?(Sys.UI.DomElement.addCssClass(this.Z8a,
"DirectPrintPdfObjectHidden"),Ka.innerText=Object(ta.a)("DirectPrintDialogSuccessText"),Ga.a.Uia(this.Z8a,Ga.a.RM,Ga.a.uE)):(Sys.UI.DomElement.addCssClass(this.Z8a,"DirectPrintPdfObject"),this.Ip.push(this.Z8a));Z.appendChild(Ka);Z.appendChild(document.createElement("br"));Z.appendChild(this.Z8a);this.nP&&Z.appendChild(this.nP);Z.appendChild(document.createElement("br"));Z.appendChild(this.lzm(this.nP?"#":this.V9g));this.ilc.start();this.Abd(Object(ta.a)("AppTitle"),null,null,null,null,Z);this.Nqa(this.ap("DirectPrintHeaderContent"));
this.nP&&this.nP.submit();this.UAm();f.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}lzm(Z){const Ka=document.createElement("span");var zb=document.createElement("span");zb.innerText=Object(ta.a)("DirectPrintDialogDownloadPDFHeader");Ka.appendChild(zb);h.AFrameworkApplication.ga&&(2===h.AFrameworkApplication.Ea.Kb.Im&&h.AFrameworkApplication.ga.getBooleanAppSetting("PPTDisableDirectPrintDialogDownloadPDFLink")||1===h.AFrameworkApplication.Ea.Kb.Im&&h.AFrameworkApplication.ga.getBooleanAppSetting("XLODisableDirectPrintDialogOpenPDFLink"))?
(Z=document.createElement("span"),2===h.AFrameworkApplication.Ea.Kb.Im?Z.innerText=Object(ta.a)("DirectPrintDialogDownloadPDFLabel"):1===h.AFrameworkApplication.Ea.Kb.Im&&(Z.innerText=Object(ta.a)("InternalError_Directive"),f.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.N2c=Z,Ka.appendChild(document.createElement("br")),Ka.appendChild(Z)):(zb=document.createElement("a"),zb.innerText=Object(ta.a)("DirectPrintDialogDownloadPDFLink"),zb.href=Z,zb.target=
"_blank",zb.id="PrintPDFLink",zb.className="AllowBrowserClick",this.N2c=zb,Ka.appendChild(document.createElement("br")),Ka.appendChild(zb),this.nP&&Tc.a.addHandler(zb,"click",this.Nzg),this.zV.Zb(ha.a.click,this.N2c,this.Qol,null));this.Ip.push(this.N2c);return Ka}UAm(){if(0<this.Ip.length){const Z=new Lb.a(this.Ip),Ka=bb.FocusManager.instance().Hw();Ka&&(this.N2c.focus(),Ka.nt=Z,Ka.caa=!0)}}nWd(){f.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}dispose(){this.N2c&&
(this.zV.jc(ha.a.click,this.N2c,this.Qol),this.N2c=null);Oa.a.aZ(this.Z8a);this.Z8a=null;super.dispose()}}Object(c.a)(Zc,"DirectPrintDialog",va.a,[1447]);class ld{constructor(Z){this.zV=Z}kOm(Z,Ka,zb){return new Zc(this.zV,Z,Ka,void 0===zb?null:zb)}}Object(c.a)(ld,"DirectPrintDialogFactory",null,[1409]);var fe=a(151),Ac=a(26);class R{constructor(Z,Ka){this._url=Z;this.tkm=Ka}Lol(){this.tkm?Ac.a.CFm(this._url):Ac.a.jq(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}
Object(c.a)(R,"OpenUrlInTabDialogDownloadBehavior",null,[249,24]);var za=a(7);class X extends va.a{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de){Ka=void 0===Ka?!0:Ka;zb=void 0===zb?!1:zb;dc=void 0===dc?null:dc;Jc=void 0===Jc?null:Jc;jd=void 0===jd?!1:jd;Ed=void 0===Ed?null:Ed;de=void 0===de?!1:de;super();this.Jwe=this.Iwe=this.nP=this.Nyb=null;this.Knn=bh=>{this.Dql(bh);return!0};this.Lnn=bh=>this.Elh(bh,this.Dql);this.Dql=bh=>{this.nP&&this.nP.submit();this.NDd(bh.Dc)};this.QSa=bh=>{1===bh?(this.nWd(),this.nP?
X.t1c&&this.bXl():this.OHh.Lol()):2===bh?(this.NFl(),this.AQf?this.Nll():(this.nCl||this.jRf)&&this.vGm()):0==bh&&this.nFl();this.dispose()};var Ne=this.qRk?this.qRk:Object(ta.a)("DefaultDialogTitle");X.xDe=jd;this.dgm=Ed;this.xhm=de;this.OHh=dc||new R(Z,!0);const Re=[],Cf=[];X.t1c&&(this.mbh&&this.mbh.forEach(bh=>{Array.add(Re,bh)}),this.Sfl&&this.Sfl.forEach(bh=>{Array.add(Cf,bh)}));Ka?zb?this.AQf?(this.gf=12,this.Fg(1,this.buttonText),this.Fg(2,Object(ta.a)("DownloadAsPdfDialog_CopyALinkButton")),
this.Fg(3,Object(ta.a)("DialogClose"))):this.jRf?(this.gf=12,this.Fg(1,this.buttonText),this.Fg(2,Object(ta.a)("DownloadAsPdfDialog_EmailALinkButton")),this.Fg(3,Object(ta.a)("DialogClose"))):this.nCl?(this.gf=12,this.Fg(1,this.buttonText),this.Fg(2,Object(ta.a)("DownloadACopyDialog_EmailALinkButton")),this.Fg(3,Object(ta.a)("DialogClose"))):(this.gf=4,this.Fg(1,this.buttonText),this.Fg(2,Object(ta.a)("DialogClose"))):(this.gf=6,this.Fg(0,Object(ta.a)("DialogClose"))):this.gf=5;jd=document.createElement("span");
this.kof&&(jd.className=this.kof);dc=document.createElement("a");dc.innerText=this.IFe;dc.href=Z;dc.target="_blank";dc.id=this.wXf;dc.className=ja.AFrame.v3h;if(Ed=!za.a.o3&&!za.a.wrj&&!!Jc&&0<Jc.count){de=Rc.a.mSi(Z,Jc);Jc=Rc.a.Enk(Z,Jc);dc.href="#";dc.target="_self";this.nP=document.createElement("form");this.nP.id="printPreviewPostForm1";this.nP.method="post";this.nP.target="_blank";this.nP.action=Jc;for(var yg of de)Jc=document.createElement("input"),Jc.type="hidden",Jc.name=yg.key,Jc.value=yg.value,
this.nP.appendChild(Jc)}else this.nP=null;this.nP||X.xDe?X.xDe||Array.add(Cf,{["type"]:"AppLinkProps",["id"]:this.wXf,["text"]:this.IFe,["onExecute"]:()=>{this.bXl()}}):Array.add(Cf,{["type"]:"AppLinkProps",["id"]:this.wXf,["text"]:this.IFe,["handler"]:{["href"]:Ed?"#":Z,["target"]:Ed?"_self":"_blank"}});this.n0b&&Array.add(Re,this.n0b);zb?(Z=document.createElement("span"),Z.innerText=this.n0b.replace("{0}",""),jd.appendChild(Z)):this.DNl?(Z=document.createElement("span"),Z.id=this.ap("message"),
yg=document.createElement("span"),Jc=document.createElement("span"),Ed=this.n0b.split("{0}"),yg.innerText=Ed[0],Jc.innerText=Ed[1],Z.appendChild(yg),Z.appendChild(dc),Z.appendChild(Jc),jd.appendChild(Z)):(Z=document.createElement("span"),Z.innerText=this.n0b,jd.appendChild(Z),jd.appendChild(document.createElement("br")),jd.appendChild(document.createElement("br")),jd.appendChild(dc),X.xDe||Array.add(Re,"{0}"));this.nP&&jd.appendChild(this.nP);X.t1c&&(this.Gbc&&(this.lXf?this.Vdl(this.Gbc,this.lXf):
(Array.add(Re,"{0}"),Array.add(Cf,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.Gbc,["onExecute"]:()=>{this.Nlh()}}))),this.tah(Re,Cf));this.Abd(Ne,null,this.z9i,null,this.QSa,X.t1c?null:jd);this.Nqa(this.ap("message"));!X.t1c&&this.lXf&&this.Gbc&&(Ne=document.createElement("div"),Ne.className="WACDialogLearnMoreLinkContainer",this.Nyb=document.createElement("a"),this.Nyb.innerText=this.Gbc,this.Nyb.href=this.lXf,this.Nyb.target="_blank",this.Nyb.id=this.ap("LearnMoreLinkId"),this.Nyb.className=
ja.AFrame.v3h,Ne.appendChild(this.Nyb),Ka?this.Ed.insertBefore(Ne,this.Ed.lastChild):this.Ed.appendChild(Ne),this.Nqa(String.format("{0} {1}",this.ap("message"),this.ap("LearnMoreLinkId"))));this.vWe=dc;zb?this.I8(this.F7):this.I8(this.vWe);this.NFe();h.AFrameworkApplication.Ea.rZ.Zb(ha.a.click,this.vWe,Object(e.a)(this,this.Pol,"downloadLinkClicked"),null);this.Nyb&&h.AFrameworkApplication.Ea.rZ.Zb(ha.a.click,this.Nyb,Object(e.a)(this,this.Nlh,"learnMoreLinkClicked"),null);this.X5k=!1}get z9i(){return null}get qRk(){return null}get n0b(){return null}get Sil(){return this.dgm}get Aql(){return this.xhm}get lXf(){return null}get Gbc(){return null}get DNl(){return!1}get buttonText(){return Object(ta.a)("Open")}get kof(){return null}get mbh(){return null}get Sfl(){return null}get AQf(){return!1}get jRf(){return!1}get nCl(){return!1}Nll(){const Z=
{SourceControlId:"CopyLink"};this.AQf&&(Z.shareOverrideDefaultPermission=!0);this.dEa(Z,{ControlId:"CopyLink"})}vGm(){const Z={SourceControlId:"Share"};this.jRf&&(Z.shareOverrideDefaultPermission=!0);this.dEa(Z,{ControlId:"Share"})}dEa(Z,Ka){const zb=h.AFrameworkApplication.vb;zb.vs=8;zb.Qa(w.a.dEa,2,Z,Ka)}Yfb(){this.nP&&(this.Iwe||(this.Iwe=this.Knn,this.rE.Zb(ha.a.click,this.F7,this.Iwe)),this.Jwe||(this.Jwe=this.Lnn,this.yr.Zb(ha.a.Iq,this.F7,this.Jwe)));super.Yfb()}NFl(){}nFl(){}nWd(){}Pol(){this.zYf();
this.nP?this.nP.submit():this.OHh.Lol();return!0}Nlh(){return!1}dispose(){this.OHh.dispose();this.vWe&&(h.AFrameworkApplication.Ea.rZ.jc(ha.a.click,this.vWe,Object(e.a)(this,this.Pol,"downloadLinkClicked")),this.vWe=null);this.Nyb&&(h.AFrameworkApplication.Ea.rZ.jc(ha.a.click,this.Nyb,Object(e.a)(this,this.Nlh,"learnMoreLinkClicked")),this.Nyb=null);this.rE&&this.Iwe&&(this.rE.jc(ha.a.click,this.F7,this.Iwe),this.Iwe=null);this.yr&&this.Jwe&&(this.yr.jc(ha.a.Iq,this.F7,this.Jwe),this.Jwe=null);super.dispose()}bXl(){this.nP&&
(document.body.appendChild(this.nP),this.nP.submit(),document.body.removeChild(this.nP))}static get t1c(){return h.AFrameworkApplication.Ea.Kb.XV&&h.AFrameworkApplication.Ea.Kb.hoj}static get xDe(){return X.t7k}static set xDe(Z){X.t7k=Z}}X.t7k=!1;Object(c.a)(X,"ADialogWithLinkToResource",va.a,[]);class lb extends X{constructor(Z,Ka,zb,dc,Jc,jd,Ed){zb=void 0===zb?null:zb;dc=void 0===dc?!0:dc;Jc=void 0===Jc?!1:Jc;jd=void 0===jd?null:jd;Ed=void 0===Ed?!1:Ed;super(Z,!0,!(lb.Wfd&&dc),new R(Z,Ka),zb,Jc,
jd,Ed);lb.Wfd=lb.Wfd&&dc;if(lb.Wfd){Ka=document.createElement("iframe");dc=null;Jc=this.qEm;Ka.name="pdfObjectFrame";Ka.id="pdfObjectIFrame";if(zb&&0<zb.count){jd=Rc.a.mSi(Z,zb);Z=Rc.a.Enk(Z,zb);dc=document.createElement("form");dc.id="printPreviewPostForm";dc.method="POST";dc.target=Ka.name;dc.action=Z;for(const de of jd)Z=document.createElement("input"),Z.type="hidden",Z.name=de.key,Z.value=de.value,dc.appendChild(Z)}else Ka.src=Z;Jc.appendChild(Ka);dc&&(Jc.appendChild(dc),dc.submit());Sys.UI.DomElement.addCssClass(Ka,
"DirectPrintPdfObjectHidden");Ga.a.Uia(Ka,Ga.a.RM,Ga.a.uE)}}get z9i(){return"Print_32x32x32"}get qRk(){return lb.Wfd?Object(ta.a)("PrintDialogDocumentIsReadyToPrint"):null}get n0b(){return lb.Wfd?null:Object(ta.a)("PrintDialogDocumentIsReadyToPrint")}get mbh(){const Z=[];Array.add(Z,Object(ta.a)("PrintDialogCanCloseDocument"));if(X.xDe){let Ka=Object(ta.a)("DirectPrintDialogFallbackSuggestion");""!==h.AFrameworkApplication.Ea.Kb.inl&&(Ka=h.AFrameworkApplication.Ea.Kb.inl);Array.add(Z,Ka)}return lb.Wfd?
Z:null}get IFe(){return Object(ta.a)("DirectPrintDialogDownloadPDFLink")}get wXf(){return"PrintPDFLink"}get buttonText(){return Object(ta.a)("PrintDialogOpenPDF")}get kof(){return h.AFrameworkApplication.U$b?"UIFontDialogTextLarge":null}NFe(){f.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}zYf(){h.AFrameworkApplication.Hl.Ekb(9540,1);f.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}NFl(){Object(vb.a)("PrintDialogSecondaryButtonClicked",!0)}nFl(){Object(vb.a)("PrintDialogCancelButtonClicked",
!0)}nWd(){f.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get Wfd(){return!!h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.XV&&h.AFrameworkApplication.ga.getBooleanAppSetting("DirectPrintDialogAsStandardDialogIsEnabled")&&!(za.a.o3||za.a.ul||za.a.zg||za.a.pCc)&&!h.AFrameworkApplication.oFe&&h.AFrameworkApplication.ga.getBooleanAppSetting("ShouldHostDefaultToNativeBrowserPrintExperience")&&lb.Xcl}static set Wfd(Z){lb.Xcl=Z}}lb.Xcl=!1;Object(c.a)(lb,"PrintDialogWithLinkToPdf",
X,[]);class oc{constructor(Z){this.isEnabled=Boolean.parse(Z.DirectPrintIsEnabled||"false");this.K5m=Boolean.parse(Z.DirectPrintProbeIsEnabled||"false");this.Y4m=Boolean.parse(Z.DirectPrintEnabledForInternetExplorer||"false");this.Fqe=(Z.DirectPrintSupportedMimeTypes||"").split(oc.Tui);this.ffd=(Z.DirectPrintSupportedPlugins||"").split(oc.Tui);this.I0m=(Z.DirectPrintImmersivePreviewPlugins||"").split(oc.Tui);this.lCl=Boolean.parse(Z.DirectPrintEnabledForEdge||"false");this.R3m=Boolean.parse(Z.ChromePrintLayoutFixIsEnabled||
"false");this.oxm=parseInt(Z.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.nUj=14;this.ENl=14394;if(Z=Z.DirectPrintMinimalSupportedEdgeVersion){const Ka=Z.split(".");2===Ka.length?(this.nUj=parseInt(Ka[0]),this.ENl=parseInt(Ka[1])):f.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",Z)}else f.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}oc.Tui=",";Object(c.a)(oc,
"DirectPrintBrsSettings",null,[]);class Oc{constructor(Z,Ka){this.lNk=Z;this.ffd=Ka}}Object(c.a)(Oc,"DirectPrintProbeResults",null,[]);var sd=a(94),Ld=a(21);class Qd{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re){this.gah=null;this.TRm=()=>{var Cf=this.WTm();const yg=this.VBn(),bh={},Ah={};for(let Ui=0;Ui<this.vsa.Fqe.length;Ui++)bh[this.vsa.Fqe[Ui]]=Cf[Ui];for(Cf=0;Cf<this.vsa.ffd.length;Cf++)Ah[this.vsa.ffd[Cf]]=yg[Cf];return new Oc(bh,Ah)};this.ahm=Z;this.B2e=Ka;this.uOh=zb;this.Rim=dc;this.ejm=Jc;
this.j4e=new fe.a(this.TRm);this.sHh=jd;this.j9k=Ne;this.Z6e=Ed;this.fjm=de;this.mjm=Re}get vsa(){return this.ahm}start(){}PAn(){this.vsa.K5m&&this.z$m()}UBn(){const Z=Array(this.vsa.Fqe.length);if(void 0!==this.B2e&&null!==this.B2e)for(let Ka=0;Ka<this.vsa.Fqe.length;Ka++)Z[Ka]=this.vsa.Fqe[Ka]in this.B2e&&this.Rim(this.B2e[this.vsa.Fqe[Ka]]);return Z}VBn(){const Z=Array(this.vsa.ffd.length),Ka=!(void 0===this.uOh||null===this.uOh);for(let zb=0;zb<this.vsa.ffd.length;zb++){const dc=this.vsa.ffd[zb];
Z[zb]=Ka&&dc in this.uOh?!0:this.ejm(dc)}return Z}WTm(){const Z=this.UBn(),Ka=Array(Z.length);for(let zb=0;zb<Z.length;zb++)Ka[zb]=Z[zb]?this.ZHm(this.B2e[this.vsa.Fqe[zb]]):null;return Ka}ZHm(Z){if(void 0===Z||null===Z)return null;Z=Z.enabledPlugin;return void 0===Z||null===Z?null:Z.name}z$m(){f.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.j4e.value.lNk,this.j4e.value.ffd)}aPn(){return this.mjm||!this.vsa.isEnabled||h.AFrameworkApplication.oFe?!1:this.hTn()}y4l(){if(null!=
this.gah)return this.gah;const Z=Qd.kCl(this.vsa);return this.gah=this.vsa.lCl&&Z||this.O3m()}O3m(){return za.a.hm&&this.vsa.R3m&&za.a.Exd>=this.vsa.oxm?!0:!1}hTn(){if(!this.fjm(this.vsa))return!1;var Z=Ld.a.rZi(this.j4e.value.lNk);for(const Ka of Z)if(void 0!==Ka&&null!==Ka)return!0;Z=Ld.a.rZi(this.j4e.value.ffd);for(const Ka of Z)if(Ka)return!0;return!1}iYm(){const Z=Ld.a.rZi(this.j4e.value.lNk);for(const Ka of Z)if(sd.a.contains(this.vsa.I0m,Ka))return!0;return!1}f5l(Z){var Ka=void 0===Ka?!1:Ka;
var zb=void 0===zb?null:zb;h.AFrameworkApplication.Ea&&h.AFrameworkApplication.ga.getBooleanAppSetting("DirectPrintDialogAsStandardDialogIsEnabled")?this.j9k(Z,zb):this.aPn()?this.cFm(Z,this.iYm()&&!Ka,zb):this.j9k(Z,zb)}cFm(Z,Ka,zb){zb=void 0===zb?null:zb;const dc=this.Z6e.wl("UserAction","OpenDirectPrintDialog");this.sHh.kOm(Z,Ka,zb).P9a();dc.stop()}static R6m(Z){try{return new ActiveXObject(Z),!0}catch(Ka){f.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",Z)}return!1}static t4m(Z){return void 0===
Z||null===Z?!1:!(void 0===Z.enabledPlugin||null===Z.enabledPlugin)}static create(Z){const Ka=new oc(h.AFrameworkApplication.ga.appSettings);let zb=null;try{zb=window.navigator.mimeTypes}catch(Re){f.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let dc=null;try{dc=window.navigator.plugins}catch(Re){f.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Jc=Qd.t4m,jd=Qd.R6m;Z=Z.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const Ed=
h.AFrameworkApplication.Ea.Rba,de=Qd.S6m,Ne=!!h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.XV&&!h.AFrameworkApplication.ga.getBooleanAppSetting("PrintDialogFallbackLinkEnabled");return new Qd(Ka,zb,dc,Jc,jd,Z,Ed,de,(Re,Cf)=>new lb(Re,!1,Cf,!0,Ne),h.AFrameworkApplication.h8)}static S6m(Z){return za.a.hm||za.a.ul&&Z.Y4m||Z.lCl&&Qd.kCl(Z)?!0:!1}static kCl(Z){var Ka=za.a.mZa;if(Ka){var zb=Ka.split(".");if(2===zb.length)return Ka=parseInt(zb[0]),zb=parseInt(zb[1]),Ka>Z.nUj||Ka===Z.nUj&&zb>=
Z.ENl}return!1}}Object(c.a)(Qd,"DirectPrintManager",null,[1380]);class Id{constructor(){this.U5k=this.Ha=null}get name(){return"Common.App.DirectPrint"}lc(Z){this.Ha=Z;Z.register(ld,"Common.App.DirectPrint.DirectPrintDialogFactory").ma().na(()=>new ld(h.AFrameworkApplication.Ea.rZ));Z.register(1380,"Common.App.DirectPrint.IDirectPrintManager").ma().na(()=>Qd.create(this.Ha))}init(){this.U5k=this.Ha.resolve("Common.App.DirectPrint.IDirectPrintManager");this.U5k.start()}dispose(){}}Object(c.a)(Id,"PackageManager",
null,[3,4]);var he=a(1205),xb=a(429);class Sb{constructor(Z,Ka){this.VWe=null;this.DXn=(zb,dc,Jc,jd,Ed)=>{if(1===Jc)return 32;Ed[he.a.Value]=this.VWe;Ed[xb.a.labelText]=this.VWe;Ed[he.a.Visible]=!0;return 32};this.ya=Z;this.Ba=Ka}Hb(){(this.VWe=this.Ba.La("StatusBarEnvironmentNameToUse"))&&""!==this.VWe&&this.ya.sa(w.a.HGg,r.a.frame,this.DXn,96)}}Object(c.a)(Sb,"DisplayEnvironmentName",null,[]);class Cc{constructor(){this.Ha=null}get name(){return"Common.App.DisplayEnvironmentName"}lc(Z){this.Ha=
Z;this.Ha.register(Sb,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ma().na(()=>new Sb(h.AFrameworkApplication.vb,h.AFrameworkApplication.ga))}init(){this.Ha.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Hb()}dispose(){}static main(){b.a.instance.Fc(new Cc)}}Object(c.a)(Cc,"DisplayEnvironmentNamePackage",null,[3,4]);var qb=a(47),Ob=a(105);class Pb extends Ob.a{constructor(Z){super(Z)}get szd(){return!1}createElement(){const Z=document.createElement("link");Z.setAttribute("rel",
"stylesheet");Z.setAttribute("type","text/css");Z.setAttribute("href",this.NE);return Z}Kmf(){return null}xje(){this.element.setAttribute("href","");this.element.setAttribute("href",this.Gta.NE)}}Object(c.a)(Pb,"CssResource",Ob.a,[]);var qc=a(103),Uc=a(46);class pd{constructor(){this.a$g=this.s8g=null}h9m(){this.s8g||(f.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.s8g=Uc.Task.WAA(pd.m9m(),pd.f9m()),this.s8g.continueWith(Z=>{f.ULS.sendTraceTag(21030599,324,10,"{0}",
Va.a.tNi(Z.oj))},5));return this.s8g}i9m(){if(!this.a$g)try{f.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.a$g=Uc.Task.WAA(pd.Syi(qc.a.create(h.AFrameworkApplication.ga.La("DimeUrl"),null,null))),this.a$g.continueWith(Z=>{f.ULS.sendTraceTag(39978391,324,10,"{0}",Va.a.tNi(Z.oj))},5)}catch(Z){f.ULS.sendTraceTag(594874951,324,10,"{0}",Va.a.tNi(Z))}return this.a$g}static m9m(){var Z=pd.cDe("inproductmessaging.js");Z=qc.a.create(Z,null,null);return pd.Syi(Z)}static f9m(){var Z=
pd.cDe("inproductmessaging.css");Z=new Pb(Z);return pd.Syi(Z)}static cDe(Z){return qb.a.WLb(String.format("ipm/{0}",Z))}static Syi(Z){wc.a.HL(Z);return Z.Rmb}}Object(c.a)(pd,"DependencyDownloader",null,[1484]);class Od{}Od.Qtn="inProductMessagingOverlayDiv";Od.svn="PlayButtonImage";Od.fHn="ReplayButtonImage";Object(c.a)(Od,"Constants",null,[]);class be{constructor(){this.Ubl=this.X9k=this.y4k=!0;this.gHn=this.tvn=null;this.tmn=!1;this.locale=null;this.M8l={}}get autoPlay(){return this.y4k}set autoPlay(Z){this.y4k=
Z}get PNl(){return this.X9k}set PNl(Z){this.X9k=Z}get X4l(){return this.Ubl}set X4l(Z){(this.Ubl=Z)&&this.BMn()}BMn(){this.hel(Od.svn,this.tvn);this.hel(Od.fHn,this.gHn)}hel(Z,Ka){Ka&&(this.M8l[Z]=Ka)}}Object(c.a)(be,"FirstRunExperienceUISettings",null,[1483]);class te{constructor(){this.completed=this.gFn=!1}}Object(c.a)(te,"FirstRunExperienceViewData",null,[1410]);var Le=a(49);class kf{constructor(Z,Ka,zb){this.CJm=(dc,Jc,jd,Ed,de)=>{2===jd&&this.M8g.H8m(de);return 32};this.LEm=(dc,Jc,jd,Ed,de)=>
{2===jd&&this.M8g.D8m(de);return 32};this.M0m=(dc,Jc,jd)=>2===jd?this.M8g.MUj():32;this.L0m=(dc,Jc,jd)=>2===jd?this.M8g.IUj():32;this.ya=Z;this.jo=Ka;this.M8g=zb}Hb(){this.ya.sa(w.a.DJm,r.a.frame,this.CJm,64);this.ya.za(w.a.nsl,r.a.frame,this.M0m);this.ya.za(w.a.msl,r.a.frame,this.L0m);this.ya.za(w.a.KEm,r.a.frame,this.LEm);this.ya.za(w.a.VZl,r.a.frame,Le.ActionManager.Ii);this.ya.za(w.a.nHn,r.a.frame,Le.ActionManager.Ii);this.ya.za(w.a.oHn,r.a.frame,Le.ActionManager.Ii);this.jo&&this.jo.Zf()}}Object(c.a)(kf,
"InProductMessagingActor",null,[]);class fg{constructor(){this.jYl=this.Mia=this.$6l=this.Klh=this.instance=null}}Object(c.a)(fg,"DimeExperienceUISettings",null,[]);var pe=a(515);class me{constructor(Z,Ka,zb,dc,Jc){this.Bgh=!1;this.Hqf=null;this.ya=Z;this.P9b=Ka;this.Gxe=zb;this.yW=dc;this.Tka=Jc}a2m(Z){cc.b("getHeaderApi")?(Z.fEl()&&appChrome.getHeaderApi().then(Ka=>{Ka.updateAnonymousStatus(!0);return null}),Z.isFeatureEnabled("MsoPremiumBadge",!0).then(Ka=>{const zb=Z.isFreemiumUpsellEnabled();
zb&&(appChrome.getHeaderApi().then(dc=>{dc.updatePremiumStatus(Ka,zb);return null}),Z.OCb("MsoPremiumBadge",dc=>{appChrome.getHeaderApi().then(Jc=>{Jc.updatePremiumStatus(dc.isEnabled,zb);return null})}));return null})):f.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}H8m(Z){this.Gxe.h9m().continueWith(()=>{this.P9b.LQn(Z)})}D8m(Z){let Ka="gopremium",zb=null,dc=()=>{};Z?(Z.experience&&""!==Object(v.a)(String,Z.experience)&&(Ka=Object(v.a)(String,Z.experience)),Z.onTaskComplete&&(dc=
Z.onTaskComplete),Z.campaignId&&""!==Object(v.a)(String,Z.campaignId)&&(zb=Object(v.a)(String,Z.campaignId))):f.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.Gsj(Ka,dc,zb)}Gsj(Z,Ka,zb){zb=void 0===zb?null:zb;if(this.Bgh&&this.Hqf){const dc={};dc.experience=Z||"gopremium";dc.campaignId=zb||pe.b(this.yW,this.Tka,Object(v.a)(String,dc.experience),!0);this.ya.Cb(w.a.VZl,2);f.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+dc.experience);
try{const Jc=Object.assign(new fg,{instance:this.Hqf,Klh:dc,$6l:Ka||(()=>{}),Mia:jd=>{f.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+jd.status)},jYl:()=>{f.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.Bgh=!1;this.Hqf=null}});this.P9b.PPn(Jc)}catch(Jc){f.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Jc.message),this.Bgh=!1,this.Hqf=null,this.ya.Qa(w.a.dCe,2,{["experience"]:dc.experience})}}else f.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),
this.ya.Qa(w.a.dCe,2,{["experience"]:Z})}j9m(){this.Gxe.i9m().continueWith(()=>{try{var Z=Va.a.mj(h.AFrameworkApplication.uiCulture);const dc=pe.c(this.yW);if(dc){var Ka={};Ka.partnerId=dc;Ka.language=Z;Ka.sessionId=h.AFrameworkApplication.userSessionId;Ka.authHint=h.AFrameworkApplication.ga.La("UserPrincipalName");var zb=h.AFrameworkApplication.ga.La("Puid")||"";""!==zb&&(Z={},Z.puid=zb,Ka.userInfo=Z);this.Hqf=new Dime(Ka);this.Bgh=!0;f.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else f.ULS.sendTraceTag(51675409,
324,15,"App not supported")}catch(dc){f.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+dc.message)}},3)}MUj(){return this.P9b.MUj()}IUj(){return this.P9b.IUj()}}Object(c.a)(me,"InProductMessagingUIManager",null,[1385]);class Ke{constructor(){this.Fcl=0;this.jxe=Array(5);this.jxe[0]=10;this.jxe[1]=15;this.jxe[2]=50;this.jxe[3]=100;this.jxe[4]=200}Init(Z){this.Fcl=Z}SendTrace(Z,Ka){f.ULS.sendTraceTag(34182235,this.Fcl,this.jxe[Z],"{0}",Ka)}}Object(c.a)(Ke,"DefaultNetworkingManager",
null,[1411]);var Ie=a(95);class Ef{constructor(Z){this.Je=Z}LQn(Z){Z&&(InProductMessaging.Networking.NetworkingMgr=new Ke,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(Z.X4l,Z.PNl,Z.autoPlay,Z.tmn,Z.locale,Object(e.a)(this,this.ypn,"onDismissFirstRunExperience"),Z.M8l),this.Cka(Od.Qtn,!0))}PPn(Z){if(Z&&Z.instance&&Z.Klh){let Ka=document.getElementById("wacDimeContainer");Ka||(Ka=document.createElement("div"),Ka.id="wacDimeContainer",document.body.appendChild(Ka));h.AFrameworkApplication.ga.getBooleanAppSetting("DimeFocusManagerIsEnabled")&&
this.Cka("wacDimeContainer",!1);Z.Klh.parentElementId="wacDimeContainer";Z.instance.launch(Z.Klh,Z.$6l).then(zb=>{this.LBa();document.body.removeChild(Ka);Z.Mia(zb)}).catch(zb=>{this.LBa();document.body.removeChild(Ka);Z.jYl(zb)})}else throw Error.argument("DimeExperienceUISettings");}Cka(Z,Ka){if(this.Je&&Z&&(Z=document.getElementById(Z),this.Y1m(Z),Z=this.Je.x$("InProductMessagingFocusId"))){const zb=this.Je.currentScope;zb&&"InProductMessagingFocusId"===zb.name||this.Je.yia("InProductMessagingFocusId",
!1);Ka&&this.kDn(Z.scope)}}Y1m(Z){var Ka=!1;Ka=void 0===Ka?!0:Ka;const zb=this.Je.gd("InProductMessagingFocusId");zb.parent=ja.AFrame.tE;const dc=new Ie.DOMFocusListing(()=>Z);dc.wdd=Ka;dc.ft(3);dc.ft(2);dc.ft(4);Ka=this.Je.HDa(()=>Z,zb,dc);Ka.Ndc();Ka.caa=!0;Ka.G$b=!0}kDn(Z){Z.cG(bb.FocusManager.instance().$3c);Z.cG(bb.FocusManager.instance().a4c);Z.bindAction(bb.FocusManager.instance().$3c,w.a.nsl);Z.bindAction(bb.FocusManager.instance().a4c,w.a.msl)}LBa(){this.Je&&(this.Je.qka("InProductMessagingFocusId"),
this.Je.Ddd("InProductMessagingFocusId"))}ypn(Z,Ka){this.LBa();Z=Object.assign(new te,{completed:Z,gFn:Ka});h.AFrameworkApplication.vb.Qa(w.a.BJm,2,Z)}MUj(){const Z=document.activeElement,Ka=this.Je.Hw();return Z&&Ka&&Ka.nt&&Z===Ka.nt.X9c?(Ka.nt.tZ(Z),Ka.I9d()?32:8):4}IUj(){const Z=document.activeElement,Ka=this.Je.Hw();return Z&&Ka&&Ka.nt&&Z===Ka.nt.LJa?(Ka.nt.tZ(Z),Ka.C9d()?32:8):4}}Object(c.a)(Ef,"InProductMessagingUIWrapper",null,[1384]);class We{constructor(){this.Ha=null}get name(){return"Common.App.InProductMessaging"}lc(Z){Z.register(pd,
"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").ma().na(()=>new pd);Z.register(Ef,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").ma().na(()=>new Ef(bb.FocusManager.instance()));Z.register(me,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").ma().na(()=>new me(h.AFrameworkApplication.vb,Z.resolve("Common.IInProductMessagingUIWrapper"),
Z.resolve("Common.App.InProductMessaging.IDependencyDownloader"),h.AFrameworkApplication.Ea.Kb.Im,h.AFrameworkApplication.Ea.Kb.O4a));Z.register(kf,"Common.App.InProductMessaging.InProductMessagingActor").ma().na(()=>new kf(h.AFrameworkApplication.vb,h.AFrameworkApplication.Ea,Z.resolve("Common.IInProductMessagingUIManager")));Z.register(be,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").ma().na(()=>new be);Z.register(te,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").ma().na(()=>
new te);this.Ha=Z}init(){this.Ha.resolve("Common.App.InProductMessaging.InProductMessagingActor").Hb();h.AFrameworkApplication.ga.fg(()=>{h.AFrameworkApplication.Ea.Kb.eO&&uc.a.get_instance().$i(15,()=>{this.Ha.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Z=>{this.Ha.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").a2m(Z)})});h.AFrameworkApplication.ga.getBooleanAppSetting("FreemiumUpsellShowDialogIsEnabled")&&pe.a()&&!za.a.eA&&1!==h.AFrameworkApplication.Ea.Kb.Im&&
this.Ha.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Z=>{Z.isFeatureEnabled("MsoPremiumBadge",!0).then(Ka=>{!Ka&&Z.isFreemiumUpsellEnabled()&&this.Ha.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").j9m();return null})})})}dispose(){}static main(){b.a.instance.Fc(new We)}}Object(c.a)(We,"InProductMessagingPackage",null,[3,4]);var Ae=a(709),se=a(32);class pf{static GGm(Z){return pf.iil("New",Z)}static HGm(Z){return pf.iil("Open",Z)}static $hl(Z,Ka){return pf.jwd("LoadingMenuSection",
pf.x9m,Z,pf.aff("lblLoading",Ka))}static cff(Z,Ka,zb,dc){return pf.jwd("MessageMenuSection",pf.XNl,Ka,pf.aff("lblMessage",Z,void 0===zb?null:zb,void 0===dc?null:dc))}static Uum(Z){return pf.$hl(Z,Object(ta.a)("VoicedLoadingText"))}static Vum(Z,Ka){return pf.cff(Object(ta.a)("NewCreationLocationMessage"),Z.labelText,Ka.bda,Ka.Iwb)}static Tum(Z,Ka){return pf.cff(String.format(Object(ta.a)("NewProvisioningStorageMessage"),Ka.Iwb,"\n\n"),Z.labelText)}static ail(Z){return pf.cff(Object(ta.a)("NewGenericErrorMessage"),
Z.labelText)}static Qum(Z,Ka,zb){return pf.jwd("menuNewBlank",pf.AYm,zb?Z.labelText:null,pf.Ref(Z.$ih,Z.ajh,Z.bjh,null,Z.Jxa,Z.izc,Ka,"blank"))}static mvm(){return pf.aff("lblTemplatesLoading",Object(ta.a)("VoicedLoadingText"))}static fil(){return pf.aff("lblTemplatesError",Object(ta.a)("NewTemplateErrorMessage"))}static nvm(Z,Ka){return pf.jwd("menuNewTemplates",Z,null,Ka)}static Oum(Z,Ka){return pf.jwd("menuNewMoreTemplates",pf.ysl,null,pf.Ref("menuNewMoreTemplatesButton",Object(ta.a)("NewMoreTemplates"),
Object(ta.a)("NewMoreTemplates"),null,null,null,Z,Ka))}static rum(Z,Ka,zb){let dc="";zb&&Ka&&(dc=pf.jwd("BrowseMoreMenuSection",pf.ysl,null,pf.Ref("btnBrowseMore",Ka,Ka,null,null,null,Z||"1959943459",zb)));return dc}static aff(Z,Ka,zb,dc){zb=void 0===zb?null:zb;let Jc=dc=void 0===dc?null:dc;Ka&&0<Ka.length&&(Jc=pf.hOl.kbb(Ka).trimEnd(),Jc=0<=Jc.indexOf("{0}")?String.format(Jc,dc):String.format("{0} {1}",Jc,dc));zb=zb&&dc?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',
Va.a.Re(zb),Va.a.Re(dc),Va.a.Re(Jc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Va.a.Re(Z||""),pf.hOl.kbb(Va.a.Re(Ka||"")),zb)}static Ref(Z,Ka,zb,dc,Jc,jd,Ed,de){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',Va.a.Re(Z||""),Va.a.Re(Ka||
""),Va.a.Re(zb||""),dc||"32by32",Va.a.Re(Jc||""),Va.a.Re(jd||""),Ed,Va.a.Re(de||""))}static iil(Z,Ka){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',Z,Ka)}static jwd(Z,Ka,zb,dc){zb=zb?String.format('Title="{0}"',Va.a.Re(zb)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
Va.a.Re(Z||""),Va.a.Re(Ka||""),zb,dc)}}pf.XNl="MenuMru";pf.x9m="MenuLoading";pf.AYm="MenuHeader";pf.ysl="MenuFooter";pf.hOl=se.a.UM("\n","&#10;");Object(c.a)(pf,"NewAndOpenXmlUtilities",null,[]);var eg=a(42);class pg{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(c.a)(pg,"HostInformation",null,[]);var ne=a(153),sf=a(70),Ye=a(647),Yd=a(489),Lg=a(185),Yg=a(91),Ng=a(80),df=a(179);const Pg={topLevelKpiName:"CreateNewDocument_FileMenu",featureName:"New",crewAlias:"wwbootperf",
vetoPillar:"Boot",areaName:"Boot",doNotEmitAggregatedCount:!1};class ig{get XBb(){this.S2e||(this.S2e=l.a.instance.yb("Common.App.SaveToCloudStorage.ODCXStackOperationManager"));return this.S2e}constructor(Z,Ka,zb,dc,Jc,jd){var Ed,de;this.w7e=this.XE=this.w7g=null;this.E$g=this.yTh=!1;this.Q9k=0;this.XLh=!1;this.V8h=(Ne,Re,Cf,yg,bh)=>{if(1===Cf)return 32;bh.MenuItemId=this.FQm();return this.bba.YEa.Qa(w.a.cFa,Cf,bh,yg)};this.Bee=(Ne,Re,Cf,yg,bh)=>{if(1===Cf)return 32;2!==Cf||this.XLh||(this.Q9k=(new Date).getTime(),
this.X8g&&this.j8g.logKpiUsage({kpiName:"CreateNewDocument_FileMenuRender",kpiType:Yg.b.FailureBased}),f.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.cxh,["CachedNewMenuXmlExists"]:!!this.w7g,["ShouldCallGetMoreInfo"]:this.bba.GUa}));return this.Pim&&3===this.bba.M3&&df.a.instance.b1a(h.AFrameworkApplication.mq)?(f.ULS.sendTraceTag(507863243,202,15,"CreateNewActor: session is expired"),this.Ieh(),32):this.Awn(bh)};this.SGa=Z;this.uXe=Ka;this.QFb=
new fe.a(()=>new Ae.a(zb.value,Object(e.a)(this,this.vwc,"getMoreInfoEventReceived")));this.Vjm=dc;this.r3c=Jc;this.Xlm=jd;this.t6e=this.cxh;this.e9g=!!h.AFrameworkApplication.ga&&h.AFrameworkApplication.ga.getBooleanAppSetting("GateTemplateRenderingByGetMoreInfoResponse");this.Wim=!!h.AFrameworkApplication.ga&&h.AFrameworkApplication.ga.getBooleanAppSetting("PremiumTemplateEnabled");this.Pim=null!==(de=null===(Ed=h.AFrameworkApplication.ga)||void 0===Ed?void 0:Ed.getBooleanFeatureGate("Microsoft.Office.WordOnline.CreateNewButtonGrayOutForExpiredSessionEnabled",
!1))&&void 0!==de?de:!1;this.X8g=!!h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.NewKpiForCreateNew",!1);this.j8g=Lg.a.getInstance(Pg)}get MXa(){switch(this.bba.M3){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Hb(){const Z=this.bba.YEa;Z.za(w.a.Crb,r.a.frame,Object(e.a)(this,this.Crb,"newDocument"));Z.za(w.a.Bee,r.a.frame,this.Bee);Z.za(w.a.V8h,r.a.frame,this.V8h)}Crb(Z,Ka,zb,dc,Jc){if(1===zb)return 32;
if(2===zb&&Jc){this.X8g&&this.j8g.logKpiUsage({kpiName:"CreateNewDocument_FileMenuExec",kpiType:Yg.b.FailureBased});if(h.AFrameworkApplication.ga.getBooleanAppSetting("BackstagePremiumTemplateExperienceEnabled")&&Jc.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),h.AFrameworkApplication.vb.Cb(w.a.pAn,2);if(Jc.MenuItemId&&Jc.SourceControlId)return"NewDocumentHome"===Jc.SourceControlId&&vb.a("NewDocumentFromHomeTab"),this.Uzd(Jc.MenuItemId,Jc.SourceControlId)}return 8}FQm(){switch(this.bba.M3){case 3:return"https://create.microsoft.com/en-us/word-templates";
case 1:return"https://create.microsoft.com/en-us/excel-templates";case 2:return"https://create.microsoft.com/en-us/powerpoint-templates"}return null}Uzd(Z,Ka){var zb=this.prh.bnf;if(null===zb)return this.QYf("RelativePathIsNull",!0),8;var dc=h.AFrameworkApplication.ga.getBooleanAppSetting("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const Jc=h.AFrameworkApplication.aab;"blank"===Z&&this.n5m()&&(f.ULS.sendTraceTag(508687196,202,50,"Updating blank document id with new template id for appId={0}",
this.MXa),Z="blankNew");if(Jc&&dc){f.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const jd={};jd[ne.a.p7l]=Z;jd[ne.a.MXa]=this.MXa;jd[ne.a.lcid]=h.AFrameworkApplication.lcid.toString();jd[ne.a.reason]=Ye.a.Joi;jd[ne.a.uiCulture]=h.AFrameworkApplication.uiCulture;jd[ne.a.dataCulture]=h.AFrameworkApplication.dataCulture;h.AFrameworkApplication.k3().execute(Ed=>{Ed.sendMessage(sf.a.Uzd,jd)})}else dc=(new Date).getTime(),Ka=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",
zb,Va.a.Sj(this.Wab),Va.a.Sj(Z),Va.a.Sj(this.MXa),Va.a.Sj(h.AFrameworkApplication.lcid.toString()),Va.a.Sj(dc.toString()),Va.a.Sj(Ka),Va.a.Sj(h.AFrameworkApplication.oC),h.AFrameworkApplication.ui),(zb=h.AFrameworkApplication.ga.La("ScenarioId"))&&""!==zb&&(Ka+="&wdscenarioid="+Va.a.Sj(zb)),Ka+="&"+h.AFrameworkApplication.Rjb(),zb=this.XE?this.XE.bda:null,this.XBb&&this.XBb.rSe&&(zb=this.XBb.PersonalFileStorageUrl),zb?Ka+="&DestinationUrl="+Va.a.Sj(zb):3===this.bba.M3&&this.bba.GUa&&(this.QYf("GetMoreInfoOrPersonalFileStorageUrlIsEmpty",
!0),f.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty")),"SharePoint"===this.Wab?Ng.a.BI("6f63j813;9a66f561"):Ng.a.BI("b8jd0489;3228j491"),za.a.u9c||za.a.o3||za.a.wrj||!h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForCreateNew",!1)&&!h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForOneDriveConsumerCreateNew",!1)?Ac.a.jq(Ka,"_blank",
void 0,"CreateNewDocument"):(zb={ugfu:"1"},zb.wacAadToken=h.AFrameworkApplication.ye.y_,Ac.a.FDg("_blank",Ka,zb));2!==this.bba.M3&&3!==this.bba.M3||f.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Yd.a[this.bba.M3],["Template"]:Z});h.AFrameworkApplication.ga&&h.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.bba.M3&&("blank"===Z||"blankNew"===Z?vb.b("ConsumerTemplateNewBlank"):(Z=[Object.assign(new y.a,
{name:"TemplateId",string:Z})],vb.b("ConsumerTemplateNew",null,0,!0,0,Z)));this.DFl(!0);return 32}n5m(){let Z=!1;switch(this.bba.M3){case 3:Z=h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:Z=h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:Z=h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)}return Z}ban(Z){let Ka=
Number.MAX_VALUE,zb=Number.MIN_VALUE;const dc=window.performance;if(dc&&"undefined"!==typeof dc.getEntriesByName){for(let jd=0;jd<Z.length;jd++){var Jc=dc.getEntriesByName(Z[jd]);Jc&&0<Jc.length&&(Jc=Jc[0],Ka=Math.min(parseInt(String(Jc.fetchStart)),Ka),zb=Math.max(parseInt(String(Jc.responseEnd)),zb))}zb>Ka&&f.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:zb-Ka,["MinFetchStart"]:Ka,["MaxResponseEnd"]:zb})}}Awn(Z){Z&&(this.w7g?Z.PopulationXML=
this.w7g:(this.bba.GUa&&!this.XE&&this.Nmn.Ci("Opened New menu",!0),Z.PopulationXML=this.jLm(this.jUm())));return 32}lDl(){return!this.bba.GUa||!!this.XE&&3===this.XE.state&&!!this.XE.Iwb&&!!this.XE.bda||this.XBb&&this.XBb.rSe&&!!this.XBb.PersonalFileStorageUrl}noj(){return h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.X0a&&!this.e9g?!0:this.lDl()}jUm(){if(!this.cxh&&!this.e9g&&!this.noj())return null;if(this.t6e&&!this.E$g){let Ka=!1;var Z="9";const zb=h.AFrameworkApplication.ga.appSettings;
"NumberOfTemplatesInBackstage"in zb&&(Z=zb.NumberOfTemplatesInBackstage);let dc=this.MXa;"TemplateCollectionId"in zb&&(dc=zb.TemplateCollectionId);this.Wim&&"PowerPointWAC"===dc&&(Ka=!0);Z=String.format(this.bba.f2+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",Va.a.Sj(h.AFrameworkApplication.lcid.toString()),Va.a.Sj(dc),Z);Boolean.parse(zb.AppendOriginQueryParam||"false")&&(Z+="&org=backstage");Boolean.parse(zb.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in zb&&(Z+=
"&templateTier="+zb.TemplateTier);Z=Ka?Z+"&p=1":Z+"&p=0";Z+="&"+h.AFrameworkApplication.Rjb();this.bba.RBb.rk(Z,1,null,null,!1,2,Jc=>{this.bba.m8("CreateNewActor.GetTemplateListJson",Jc.data);this.OTn(Jc.data.responseData)},Jc=>{this.bba.m8("CreateNewActor.GetTemplateListJson",Jc.data);this.NTn()},null,void 0,void 0,void 0,void 0,"5");this.t6e=!1}return this.w7e}OTn(Z){this.w7e=Z;this.t6e=!1;this.UIg();this.e9g?this.noj()?this.svi():this.XE&&(f.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),
this.QYf("GetMoreInfoReceivedButInfoIsMissing",!1),this.Ieh()):this.svi()}svi(){if(h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.X0a&&cc.c()){const Z=h.AFrameworkApplication.ga.getBooleanAppSetting("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),Ka=h.AFrameworkApplication.aab;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.w7e,!0,Z&&Ka));this.DFl(!1);3===this.bba.M3&&f.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}NTn(){this.E$g=this.t6e=
!0;this.UIg();this.QYf("TemplateServiceFailed",!1);this.Ieh();eg.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}Ieh(){h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.X0a&&cc.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.bba.M3&&f.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}DFl(Z){this.X8g&&this.j8g.logKpiSuccess({kpiName:Z?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender"})}QYf(Z,
Ka){this.X8g&&this.j8g.logKpiFailure({kpiName:Ka?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender",errorName:Z})}vUm(Z){var Ka=0;for(var zb=0;zb<Z.length;zb++)if("ST"===Z[zb].ImageType){Ka=zb;break}const dc=Z.length?Z[Ka]:null;Z=dc?dc.Url||"":"";var Jc;let jd=zb=Ka=!1;if(dc&&(Jc=dc.AspectRatio))Jc=parseFloat(Jc),1>Jc?Ka=!0:1.5<Jc?zb=!0:1===Jc&&(jd=!0);else switch(f.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:Z}),this.bba.M3){case 3:Ka=!0;break;case 2:zb=
!0;break;case 5:jd=!0}return{returnValue:Z,QQ:Ka?"95by123":zb?"123by69":jd?"100by100":"123by95"}}jLm(Z){let Ka;const zb=this.prh.swd||"1056925771",dc=(()=>{let Jc=this.Rum(Z,this.prh,zb);({Zwh:Ka}=Jc);return Jc})().returnValue;Ka&&(this.w7g=dc,f.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:(new Date).getTime()-this.Q9k}));return dc}vwc(Z,Ka){f.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.XE||3!==Z.state?
2===Z.state&&(f.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.yTh=!0,this.UIg()):(this.XE=Z,Ka||this.UIg(),h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.X0a&&cc.c()&&cc.d("setFileMenuHostInformation")&&(Z=Object.assign(new pg,{hostUrl:this.XE.bda,hostName:this.XE.Iwb,folderUrl:h.AFrameworkApplication.breadcrumbFolderUrl,folderName:h.AFrameworkApplication.breadcrumbFolderName}),this.XBb&&this.XBb.rSe&&(Z.hostUrl=this.XBb.PersonalFileStorageUrl),f.ULS.sendTraceTag(590964758,
202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(Z)),this.e9g&&this.w7e&&this.w7e.length&&(this.noj()?this.svi():(this.QYf("PersonalFileStorageInfoIsMissing",!1),this.Ieh()),f.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}Rum(Z,Ka,zb){let dc;dc=!1;const Jc=this.lDl();let jd="";this.bba.GUa&&(this.yTh?(jd=pf.ail(Ka),this.yTh=!1,f.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):
this.XE?Jc?jd=pf.Vum(Ka,this.XE):this.XE.eBl?(dc=!0,this.t6e=!1,jd=pf.Tum(Ka,this.XE),f.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(dc=!0,jd=pf.ail(Ka),f.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.XE.bda,["StorageServiceDisplayNameIsSet"]:!!this.XE.Iwb})):(jd=pf.Uum(Ka.labelText),f.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));
Jc&&(jd+=pf.Qum(Ka,zb,!jd)+(()=>{let Ed=this.lvm(Z,zb);({Zwh:dc}=Ed);return Ed})().returnValue);return{returnValue:pf.GGm(jd),Zwh:dc}}lvm(Z,Ka){let zb;zb=!1;if(!this.cxh)return zb=!0,f.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Zwh:zb};let dc="",Jc="",jd="MenuTemplate";if(this.E$g)dc=pf.fil(),this.E$g=!1,f.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(Z){try{const Ed=Sys.Serialization.JavaScriptSerializer.deserialize(Z,
!0);dc=this.kvm(Ed,Ka);f.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");h.AFrameworkApplication.jOl&&"OneDrive"===this.Wab&&(Jc=pf.Oum(this.Omn,h.AFrameworkApplication.jOl))}catch(Ed){f.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:Z}),dc=pf.fil()}zb=!0}else jd="MenuLoading",dc=pf.mvm(),f.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:pf.nvm(jd,dc)+Jc,
Zwh:zb}}kvm(Z,Ka){let zb="";const dc=[];for(let jd=0;jd<Z.length;jd++){var Jc=Z[jd];let Ed="";if(Jc){const de=Jc.Title,Ne=Jc.AssetId;Jc=Jc.Thumbnails;Ne&&de&&Jc&&({QQ:Jc,returnValue:Ed}=this.vUm(Jc),zb+=pf.Ref("jbtnNewTemplate"+jd,de,null,Jc,null,Ed,Ka,Ne))}dc[jd]=Ed}Z=new H.a(4,1,5E3,()=>{this.ban(dc)},106);this.bba.C0b.Qb(Z);return zb}UIg(){this.XLh=!0;this.bba.nrh.M2(this.prh.Auc);this.XLh=!1}get bba(){return this.SGa.value}get prh(){return this.uXe.value}get Nmn(){return this.QFb.value}get Omn(){return this.Vjm.value}get Wab(){return this.XBb&&
this.XBb.rSe?this.XBb.cdm:this.r3c.value}get cxh(){return this.Xlm.value}}Object(c.a)(ig,"CreateNewActor",null,[]);class ji{constructor(){this._initialized=!1;this.nUh={}}i3(Z){this.nql();return this.get(Z)}contains(Z){this.nql();return Z.toString()in this.nUh}nql(){this._initialized||(this.vpm(),this._initialized=!0)}Eye(Z,Ka){this.nUh[Z.toString()]=Ka}get(Z){return this.nUh[Z.toString()]}}Object(c.a)(ji,"AIntlHelper",null,[]);class Ca extends ji{constructor(){super()}vpm(){this.Eye(0,Object(ta.a)("OpenMenuEmptyMruMessage"));
this.Eye(1,Object(ta.a)("OpenMenuServerErrorMessage"));this.Eye(2,Object(ta.a)("Open"));this.Eye(3,Object(ta.a)("OpenMenuRecentDocuments"));this.Eye(4,Object(ta.a)("OpenMenuMoreOnHost"));this.Eye(5,Object(ta.a)("VoicedLoadingText"))}static get instance(){return Ca.Wa||(Ca.Wa=new Ca)}static ttn(Z){return Ca.instance.i3(Z)}}Ca.Wa=null;Object(c.a)(Ca,"MruActorIntlHelper",ji,[]);var cb;(function(Z){Z[Z.success=0]="success";Z[Z.failure=1]="failure";Z[Z.spinner=2]="spinner";Z[Z.none=3]="none"})(cb||(cb=
{}));Object(c.b)("DisplayState",cb);var Eb=a(20),fc=a(435),Ec=a(387),Ya=a(828),Ub=a(481);class rc{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de){this.nFh=null;this.DWh=!0;this.v7g="";this.Omm=0;this.ixe=null;this.NMh=3;this.D9g=new Map;this.HLh=null;this.lam="SaveAsWordDocx_32";this.Iyn="SaveAsPowerPointPptx_32";this.sHm="SaveAsExcelXlsx_32";this.y_n="LayerDiagonalColorFluent_20";this.SYn="DesktopArrowUpColorFluent_20";this.D0k="View all files";this.i_k="Open files from this device";this.Qgn="Fetching recent files info...";
this.Pgn="Recently Opened";this.YNl="MruNoDataSection";this.Rgn="MruSection";this.Bw="SourceControlId";this.menuItemId="MenuItemId";this.WNl="Mru";this.mtn=(Ne,Re,Cf,yg,bh)=>{if(1==Cf)return 32;if(!bh[this.Bw]||!this.D9g.has(bh[this.Bw]))return f.ULS.sendTraceTag(507605730,324,15,"Unable to get the url for the document"),2;bh[this.menuItemId]=this.D9g.get(bh[this.Bw])[1];bh[this.Bw]="";return this.Yv.YEa.Qa(w.a.Ycc,Cf,bh,yg)};this.S7j=(Ne,Re,Cf,yg,bh)=>{if(!this.rTd)return 2;if(1===Cf)return 32;bh.MenuItems=
Object.assign(new Ub.a,{Id:"MruList",MenuSectionList:[],UpdateDynamically:!0});return this.ywn(bh,Ya.a.instance.rxe)};this.vDg=(Ne,Re,Cf,yg,bh)=>1!==Cf&&bh?this.zwn(bh):32;this.Ba=de;this.SGa=Z;this.Yyb=Ka;this.Fhm=zb;this.agm=dc;this.$fm=Jc;this.QFb=new fe.a(()=>new Ae.a(jd.value,null));this.Yhm=new fe.a(()=>new Ae.a(Ed.value,Object(e.a)(this,this.Ogn,"mruEventResultReceived")));this.Ba.getBooleanAppSetting("WacInTabOpenMRUIsEnabledForUiHost");this.Ba.getBooleanAppSetting("UiHostSupportsDocRebootFeatures")}Ogn(Z,
Ka){this.ixe=Z;Ka||this.BXl()}SEn(){const Z=this.Yv.YEa;Z.sa(w.a.vDg,r.a.frame,this.vDg,96);Z.za(w.a.Y2j,r.a.frame,this.mtn);Z.za(w.a.S7j,r.a.frame,this.S7j)}ywn(Z,Ka){(Ka=this.rBm(Ka))?(f.ULS.sendTraceTag(507605729,324,50,"Mru flyout data loaded successfully in file menu"),Z.MenuItems.MenuSectionList.push(Ka)):this.own(Z);Ka=this.ICm();Z.MenuItems.MenuSectionList.push(Ka);return 32}rBm(Z){if(Z){var Ka=this.rni(this.Rgn,!0);Z=JSON.parse(Z);this.D9g.clear();Z.forEach((zb,dc)=>{this.D9g.set(this.WNl+
dc.toString(),[zb.FileName,zb.DocumentUrl]);const Jc=this.HQm(zb.FileName);Ka.ControlList.push(Object.assign(new Ec.a,{ExternalId:this.WNl+dc.toString(),Command:w.a.Y2j,CommandValueId:w.a.Y2j,LabelText:Jc,Alt:zb.FileName,AriaDescription:zb.FileName,ExternalImageId:this.xPm(this.Yv.M3),KeyTip:zb.FileName}))});return Ka}}ICm(){const Z=this.rni("ViewAllFilesAndUploadSection",!1);if(!this.$2c){let zb=this.Lhl;var Ka=this.Khl;zb&&Ka||!this.Yv.GUa||(Ka=this.GEf.Ci("File Open",!1),3===Ka.state&&(zb=Ka.bda));
this.$2c=zb}this.$2c&&Z.ControlList.push(Object.assign(new Ec.a,{ExternalId:"btnViewMoreFiles",Command:w.a.cFa,CommandValueId:w.a.cFa,LabelText:this.D0k,Alt:this.D0k,AriaDescription:this.D0k,ExternalImageId:this.y_n,MenuItemId:this.$2c}));Z.ControlList.push(Object.assign(new Ec.a,{ExternalId:"btnUploadDocument",Command:w.a.j$l,CommandValueId:w.a.j$l,LabelText:this.i_k,Alt:this.i_k,AriaDescription:this.i_k,ExternalImageId:this.SYn}));return Z}rni(Z,Ka){Ka=void 0===Ka?!1:Ka;return Object.assign(new fc.a,
{Title:Ka?this.Pgn:"",Id:Z,DisplayMode:"Menu",ShowMenuSectionSeparator:!0,ControlsId:"Ctrl_"+Z,ControlList:[]})}own(Z){f.ULS.sendTraceTag(507605728,324,50,"Mru data could not load in file menu flyout");Z.MenuItems.MenuSectionList.push(this.sBm())}sBm(){const Z=this.rni(this.YNl,!1);Z.ControlList.push(Object.assign(new Ec.a,{ExternalId:this.YNl,LabelText:this.Qgn}));return Z}HQm(Z){return Z&&Z.length<=rc.a$k?Z:Z.substring(0,rc.a$k-3)+"..."}xPm(Z){let Ka=this.lam;switch(Z){case 3:Ka=this.lam;break;
case 2:Ka=this.Iyn;break;case 1:Ka=this.sHm}return Ka}zwn(Z){this.XGm();this.WGm();Z.PopulationXML=pf.HGm(this.v7g+this.nFh);return 32}XGm(){let Z=3,Ka=!1;if(this.v7g&&this.Omm===this.ixe.oRk)f.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),Z=this.NMh;else{f.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var zb=this.Yv.getCurrentTime();this.ixe=this.Ngn.Ci("File Open opened",
!0);if(this.v7g&&2!==this.NMh&&3!==this.ixe.state)Ka=!0;else{const dc=this.VSm(this.ixe);h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.X0a&&cc.c()&&dc&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(dc,!0));this.v7g=(()=>{let Jc=this.kLm(this.ixe);({Gmn:Z}=Jc);return Jc})().returnValue}zb=this.Yv.getCurrentTime()-zb;f.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:zb})}2!==Z&&(zb={["DisplayState"]:cb[Z]},
1!==Z&&(zb.IsStale=Ka),f.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",zb));this.NMh=Z}VSm(Z){let Ka;try{Ka=Eb.c(Z.rug)}catch(zb){Ka=null,f.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",zb)}return Ka}WGm(){this.DWh?(f.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.nFh=(()=>{let Z=this.lfn();({R_n:this.DWh}=Z);return Z})().returnValue):f.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");
f.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.DWh,["NotDisplayingLink"]:!this.nFh})}kLm(Z){let Ka;1===Z.state||0===Z.state?(f.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),Z=2,Ka=pf.$hl(this.Fxc(2),this.Fxc(5))):3===Z.state&&Z.rug?(Ka=this.Pum(Z.rug),Z=0):(f.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),Ka=pf.cff(this.Fxc(1),this.Fxc(2)),Z=1);return{returnValue:Ka,Gmn:Z}}Pum(Z){let Ka;
const zb=this.btg.swd||"2155708348";if(Z.length){Ka=pf.aff("lblRecentDocuments",this.Fxc(3));let dc=0;for(let Jc=0;Jc<Z.length;Jc++){const jd=Z[Jc];"FileName"in jd&&"DocumentUrl"in jd&&"Path"in jd&&(Ka+=pf.Ref("MruButton"+Jc,jd.FileName.toString(),jd.Path.toString(),null,this.btg.Jxa,this.btg.izc,zb,jd.DocumentUrl.toString()),jd.IsPinned&&dc++)}Ka=pf.jwd("RecentDocumentsMenuSection",pf.XNl,this.Fxc(2),Ka);f.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:Z.length,
["NumPinnedDocuments"]:dc})}else Ka=pf.cff(this.Fxc(0),this.Fxc(2)),f.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return Ka}lfn(){let Z;Z=!0;let Ka=this.Lhl;var zb=this.Khl;if(Ka&&zb||!this.Yv.GUa)Z=!1;else{const dc=this.GEf.Ci("File Open",!1);3===dc.state&&(Ka=dc.bda,zb=dc.Iwb,Z=!1)}zb=zb?String.format(this.Fxc(4),zb):null;return{returnValue:pf.rum(this.btg.swd,zb,Ka),R_n:Z}}BXl(){this.Yv.nrh.M2(this.btg.Auc)}get Yv(){return this.SGa.value}get Fxc(){return this.Yyb.value}get btg(){return this.Fhm.value}get Lhl(){return this.agm.value}get Khl(){return this.$fm.value}get GEf(){return this.QFb.value}get Ngn(){return this.Yhm.value}get rTd(){this.HLh||
(this.HLh=this.Ba?this.Ba.getBooleanAppSetting("IsO365CommercialHost")||this.Ba.getBooleanAppSetting("IsO365ConsumerHost"):!1);return this.HLh}}rc.a$k=35;Object(c.a)(rc,"MruRenderer",null,[]);var fd=a(174),Cd=a(1129);class Jd{constructor(Z,Ka,zb,dc,Jc,jd,Ed){this.XE=null;this.zbl=!1;this.P2c=this.P4k=0;this.vwc=de=>{if(!this.XE&&3===de.state)this.XE=de;else if(2===de.state){this.zbl?f.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.GEf.Ci("NewDocumentFromStream",
!0),this.zbl=!0);return}this.Jml()};this.Jmn=de=>{if(de&&de.data&&de.data.responseData){var Ne;let Re=Eb.d(de.data.responseData);({BD:Ne}=Re);Re.returnValue?(de=Ne,de.StatusCode!==fd.a.bC&&de.StatusCode!==fd.a.m6c?(f.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.MXa,this.P2c,de.StatusCode),this.txe(null)):de.NewDocumentUrl&&""!==de.NewDocumentUrl?(f.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.MXa,this.P2c,(new Date).getTime()-this.P4k),this.Zjm(de.NewDocumentUrl)):(f.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.MXa,this.P2c),this.txe(null))):(f.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.MXa,this.P2c,{["ResponseData"]:Cd.a.i0g(de.data.responseData)}),this.txe(null))}else f.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.MXa,this.P2c),this.txe(null)};this.Imn=de=>{de&&de.data&&f.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.MXa,this.P2c,de.data.status);this.txe(null)};this.Zjm=Z;this.txe=Ka;this.E9g=zb;this.uXe=dc;this.r3c=Jc;this.SGa=jd;this.QFb=new fe.a(()=>new Ae.a(Ed.value,this.vwc))}Uzd(){!this.XE&&this.zWj.GUa?this.GEf.Ci("NewDocumentFromStream",
!0):this.Jml()}Jml(){this.P4k=(new Date).getTime();var Z=this.MIm.bnf;if(null===Z)this.txe(null);else{var Ka=this.E9g.menuItemId,zb=this.E9g.Bw,dc=this.E9g.SSn,Jc=this.E9g.PIm;this.P2c="streamBase64"===dc?Jc.length/1024:0;f.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.MXa,this.P2c);var jd=(new Date).getTime();Z=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",Z,Va.a.Sj(this.Wab),Va.a.Sj(Ka),Va.a.Sj(this.MXa),
Va.a.Sj(h.AFrameworkApplication.lcid.toString()),Va.a.Sj(jd.toString()),Va.a.Sj(zb),Va.a.Sj(h.AFrameworkApplication.oC),h.AFrameworkApplication.ui,Va.a.Sj(dc));Z+="&"+h.AFrameworkApplication.Rjb();(Ka=this.XE?this.XE.bda:null)&&(Z+="&DestinationUrl="+Va.a.Sj(Ka));this.zWj.RBb.rk(Z,2,Jc,{"Content-Type":"application/json; charset=utf-8"},!0,2,this.Jmn,this.Imn,null,void 0,void 0,void 0,void 0,"31")}}get MXa(){switch(this.zWj.M3){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";
case 5:return"VisioWAC"}return null}get MIm(){return this.uXe.value}get Wab(){return this.r3c.value}get zWj(){return this.SGa.value}get GEf(){return this.QFb.value}}Object(c.a)(Jd,"NewDocumentFromStreamOperation",null,[]);class Rd{constructor(Z,Ka,zb,dc){this.uXe=Z;this.r3c=Ka;this.SGa=zb;this.Xhm=dc}create(Z,Ka,zb){return new Jd(Z,Ka,zb,this.uXe,this.r3c,this.SGa,this.Xhm)}}Object(c.a)(Rd,"NewDocumentFromStreamOperationFactory",null,[1406]);var Me=a(485);class lf{get name(){return"Common.App.NewAndOpen.UX"}lc(Z){Z.register(Rd,
"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ma().na(()=>new Rd(new fe.a(()=>h.AFrameworkApplication.Ea.Kb.nhh()),new fe.a(()=>h.AFrameworkApplication.Wab),new fe.a(()=>Z.yb("Common.INewAndOpenCommonHelpers")),new fe.a(()=>Z.yb("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){h.AFrameworkApplication.ga.fg(()=>{this.LRb()})}LRb(){const Z=Me.a.aG(l.a.instance.Na("Common.INewAndOpenCommonHelpers")),
Ka=Me.a.aG(l.a.instance.Na("Common.IEventEmitter<Common.IGetMoreInfoResult>"));h.AFrameworkApplication.Wab&&Uc.Task.WAA.call(null,Z,Ka).continueWith(()=>{const zb=new ig(new fe.a(()=>Z.result),new fe.a(()=>h.AFrameworkApplication.Ea.Kb.nhh()),new fe.a(()=>Ka.result),new fe.a(()=>h.AFrameworkApplication.Ea.Kb.ohh().swd||"1959943459"),new fe.a(()=>h.AFrameworkApplication.Wab),new fe.a(()=>h.AFrameworkApplication.o5m));zb.Hb();zb.UIg()});if(h.AFrameworkApplication.iIg){const zb=Me.a.aG(l.a.instance.Na("Common.IEventEmitter<Common.IMruResult>"));
Uc.Task.WAA.call(null,Z,Ka,zb).continueWith(()=>{const dc=new rc(new fe.a(()=>Z.result),new fe.a(()=>Ca.ttn),new fe.a(()=>h.AFrameworkApplication.Ea.Kb.ohh()),new fe.a(()=>h.AFrameworkApplication.stn),new fe.a(()=>h.AFrameworkApplication.qtn),new fe.a(()=>Ka.result),new fe.a(()=>zb.result),h.AFrameworkApplication.ga);dc.SEn();dc.BXl()})}}dispose(){}}Object(c.a)(lf,"UXPackageManager",null,[3,4,24]);class yf extends va.a{constructor(){super();this.gf=0;this.Fg(1,Object(ta.a)("DialogClose"))}PB(Z){this.ZF(Z,
Object(ta.a)("DefaultDialogTitle"),Object(ta.a)("OneDriveContactError"),null)}Z$b(Z){this.ZF(Z,Object(ta.a)("DefaultDialogTitle"),Object(ta.a)("OneDriveContactError"),null,!0)}}Object(c.a)(yf,"ErrorDialog",va.a,[1500]);class ff{Etl(){f.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const Z=new ed.a;Z.vj("api.onedrive.com");return Z.task}}Object(c.a)(ff,"OneDriveConsumerEndpointHelper",null,[1351]);var jf=a(12);class Nf{constructor(Z,Ka,zb,dc){this.Dod=this.Z0b=null;this.MSh=this.NSh=
!1;this.uxe=null;this.Ba=Z;this.kwe=Ka;this.und=zb;this.i4=dc}get sgl(){return this.kwe}get ga(){return this.Ba}KCe(){this.uxe||(this.uxe=this.UIe?qc.a.create(this.UIe,null,null,null,!1):null);return this.uxe}setup(Z){this.Dod=Z;this.NSh||this.MSh?this.NSh&&this.Dod&&this.Dod(!0):(Z=this.KCe())?(this.MSh=!0,Z.Rmb.continueWith(Ka=>{this.Tqn(Ka)}),wc.a.HL(Z)):(f.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.Dod(!1))}S_j(Z){f.ULS.sendTraceTag(20509838,
352,15,"Failure during OneDrive API download: {0}",Z.oj?Z.oj.toString():"No error detail.")}Tqn(Z){this.MSh=!1;if(Z.vm)this.S_j(Z),this.Dod(!1);else try{this.NSh=!0,f.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.$aj(),f.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.Dod(!0)}catch(Ka){f.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",Ka.toString()),this.Dod(!1)}}yWg(Z){this.Z0b=Z;this.und?f.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):
(f.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(e.a)(this,this.CYj,"onApiReady")))}CYj(Z){Z?this.Llh():this.QE()}QE(){this.i4().PB(jf.a.Xsn)}vw(Z){f.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.Z0b&&this.Z0b(!0,Z)}dispose(){this.uxe&&this.uxe.dispose()}}Object(c.a)(Nf,"AOneDriveFilePickerApiManager",null,[80,24]);class og extends Nf{constructor(Z,Ka,zb,dc,Jc,jd){super(Ka,zb,dc,jd);this.Hp=null;
this.hSa=Z;this.Zlm=Jc}get UIe(){return this.ga.La("OneDriveApiUrl")}start(Z,Ka){this.Hp=Z;this.yWg(Ka)}$aj(){WL.init(1===this.sgl||2===this.sgl?{["client_id"]:this.ga.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.ga.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}yWg(Z){this.Z0b=Z;!this.und&&this.hSa.QPf?(f.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(e.a)(this,this.CYj,"onApiReady"))):(f.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),
this.Zlm())}Llh(){try{f.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Hp).then(Object(e.a)(this,this.vw,"onSuccess"),Object(e.a)(this,this.SF,"onFailure"))}catch(Z){f.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Z,Z.stack),this.QE()}}SF(Z){if(Z&&Z.error){if("user_canceled"===Z.error.code){f.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}f.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",
Z.error.code,Z.error.message)}else f.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.Z0b&&this.Z0b(!1,Z);this.QE()}}Object(c.a)(og,"OneDriveFilePickerApiManagerV5",Nf,[]);class Tg extends Nf{constructor(Z,Ka,zb,dc,Jc){super(Z,Ka,zb,dc);this.H8g=this.L$k=null;this.Jyh=()=>{this.H8g.style.visibility="hidden"===this.H8g.style.visibility?"":"hidden"};this.rhm=Jc;this.options={};this.options.clientId=this.ga.La("OneDriveApiV7ClientId");this.options.cancel=this.Jyh}get UIe(){return this.ga.La("OneDriveApiV72Url")}start(Z,
Ka){this.H8g=Ka;const zb=this.rhm.Etl();zb.continueWith(()=>{f.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.L$k=zb.result;this.yWg((dc,Jc)=>{this.Jyh();Z(dc,Jc)})},3);zb.continueWith(()=>{f.ULS.sendTraceTag(24134242,352,15,zb.oj.message);this.Jyh()},5)}$aj(){this.options.success=Z=>{const Ka={};Ka.data=Z;this.vw(Ka)};this.options.error=Z=>{const Ka={};Ka.error=Z;this.SF(Ka)};this.options.advanced={};this.options.advanced.linkType="share";
this.options.advanced.endpointHint=this.L$k;this.options.advanced.iframeParentDiv=this.H8g}Llh(){try{f.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.Jyh(),OneDrive.open(this.options)}catch(Z){f.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",Z.message),this.QE()}}SF(Z){this.Z0b&&this.Z0b(!1,Z);this.QE()}}Object(c.a)(Tg,"OneDriveFilePickerApiManagerV7",Nf,[]);class Ce extends Nf{constructor(Z,Ka,zb,dc){super(Z,Ka,zb,dc);this.Bfm=
Z;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.ga.La("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get UIe(){return this.ga.La("OneDriveApiV72Url")}start(Z,Ka,zb,dc){this.options.advanced.iframeParentDiv=zb;this.options.advanced.endpointHint=dc;this.options.cancel=Ka;this.Bfm.getBooleanAppSetting("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.yWg(Z)}yWg(Z){this.Z0b=Z;this.und?f.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(f.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(e.a)(this,this.CYj,"onApiReady")))}$aj(){this.options.success=Z=>{const Ka={};Ka.data=Z;this.vw(Ka)};this.options.error=Z=>{const Ka={};Ka.error=Z;this.SF(Ka)}}Llh(){try{f.ULS.sendTraceTag(23881879,216,50,
"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(Z){f.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",Z.message,Z.stack),this.QE()}}S_j(Z){f.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",Z.oj?Z.oj.toString():"No error detail.");wc.a.LFn(this.UIe);this.uxe=null}QE(){this.i4().Z$b(jf.a.$In)}SF(Z){this.Z0b&&this.Z0b(!1,Z)}}Object(c.a)(Ce,"OneDriveFilePickerApiManagerV72",Nf,[]);class vf{constructor(Z){this.olsSessionId=
this.value=this.key=null;this.olsSessionId=Z}}Object(c.a)(vf,"IExtraData",null,[]);class Eg extends Ce{constructor(Z,Ka,zb,dc){super(Z,Ka,zb,dc);this.options.advanced.filter=Z.La("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=h.AFrameworkApplication.Agl;Z.getBooleanAppSetting("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=Z.La("OneDriveApiV72CommandMode")||"none");Z.getBooleanAppSetting("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new vf(h.AFrameworkApplication.userSessionId))}get UIe(){return this.ga.La("OneDriveApiV72Url")}Llh(){try{f.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",h.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(Z){f.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",Z.message,Z.stack),this.QE()}}}Object(c.a)(Eg,"OneDriveFilePickerApiOpenManagerV72",Ce,[]);class hf{constructor(Z){this.fT=null;this.DQm=Ka=>{if(Ka.data.Ze===fd.a.c3b&&"X-NewKey"in Ka.data.fk){f.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const zb={};zb["X-Key"]=Ka.data.fk["X-NewKey"];this.Dxk(zb)}else 0<this.PRh?(f.ULS.sendTraceTag(24134237,352,
50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.PRh),this.PRh--,this.Dxk()):(f.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.fT.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};this.EQm=Ka=>{"PersonalFileStorageUrl"in Ka.data.fk&&""!==Ka.data.fk.PersonalFileStorageUrl?(f.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.fT.vj(Ka.data.fk.PersonalFileStorageUrl)):
(f.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.fT.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};this.$m=Z;this.PRh=3}Etl(){this.fT=new ed.a;f.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.Dxk();return this.fT.task}Dxk(Z){Z=void 0===Z?null:Z;const Ka=String.format("GetMoreInfoHandler.ashx?{0}",h.AFrameworkApplication.TMb);this.$m.HZ(Ka,
1,null,Z,["PersonalFileStorageUrl","X-NewKey"],!1,2,this.EQm,this.DQm,null,void 0,void 0,void 0,void 0,"21")}}Object(c.a)(hf,"OneDriveForBusinessEndpointHelper",null,[1351]);var Qh=a(583);class hi{constructor(){this.Ha=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}lc(Z){this.Ha=Z;this.Ha.register(og,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ma().na(()=>new og(Qh.a.instance,h.AFrameworkApplication.ga,
h.AFrameworkApplication.ztc,h.AFrameworkApplication.a1,va.a.$Ik,()=>new yf));h.AFrameworkApplication.N9c?this.Ha.register(1351,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().na(()=>new ff):this.Ha.register(1351,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().na(()=>new hf(h.AFrameworkApplication.ye));this.Ha.register(Tg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ma().na(()=>new Tg(h.AFrameworkApplication.ga,h.AFrameworkApplication.ztc,
h.AFrameworkApplication.a1,()=>new yf,this.Ha.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.Ha.register(Ce,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ma().na(()=>new Ce(h.AFrameworkApplication.ga,h.AFrameworkApplication.ztc,h.AFrameworkApplication.a1,()=>new yf));this.Ha.register(Eg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ma().na(()=>new Eg(h.AFrameworkApplication.ga,h.AFrameworkApplication.ztc,h.AFrameworkApplication.a1,
()=>new yf))}static main(){b.a.instance.Fc(new hi)}}Object(c.a)(hi,"PackageManager",null,[3,4]);var Vg=a(24),uh=a(84);class Eh{constructor(Z){this.NXd=this.sLj=this.N5d=this.yoh=0;this.wJj=this.SKl=null;this.krn=Ka=>{"pen"!==Ka.pointerType||this.N5d||(this.N5d=Math.floor(this.fpf()/1E3),this.N5d<=this.yoh&&(this.N5d=this.yoh),this.sLj=0)};this.lrn=()=>{this.yyl()};this.bMd=(Ka,zb)=>{0!==zb.newState&&this.yyl()};this.x$m=()=>{0<this.NXd&&this.J1l(this.NXd);this.NXd=0};Z?(this.Tb=Z,this.fpf=Date.now,
this.zBm(),this.KEn()):f.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}AMn(){this.SKl="Office.PowerPoint.Online.Data.Activity.PenInputMinutes"}KEn(){window.document.body.addEventListener("pointerenter",this.krn);window.document.body.addEventListener("pointerleave",this.lrn);l.a.instance.Na("Common.App.VisibilityManagement.IVisibilityManager").execute(Z=>{Z.G4c(this.bMd)})}yyl(){const Z=Math.ceil(this.fpf()/1E3);this.N5d&&Z>this.yoh&&(this.sLj=
Z,this.NXd+=this.sLj-this.N5d);this.yoh=Z;this.N5d=0}zBm(){this.wJj=new H.a(4,2,6E4,this.x$m);this.Tb.Qb(this.wJj)}J1l(Z){const Ka=new uh.a;Ka.name=this.SKl;const zb=[];(Z=Vg.a.iEa("PenInputSec",Z.toString(),3))&&Array.add(zb,Z);Ka.dataFields=zb;m.a.sendActivityEvent(Ka)}dispose(){0<this.NXd&&this.J1l(this.NXd);this.Tb.li(this.wJj)}}Object(c.a)(Eh,"PenMinutesManager",null,[1353]);class Bh{constructor(){this.$Ph=this.Ha=null}get name(){return"Common.App.PenMinutesManager"}lc(Z){this.Ha=Z;const Ka=
h.AFrameworkApplication.je;this.Ha.register(1353,"Common.App.PenMinutesManager.IPenMinutesManager").ma().na(()=>new Eh(Ka))}init(){this.$Ph=this.Ha.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.$Ph&&this.$Ph.dispose()}static main(){b.a.instance.Fc(new Bh)}}Object(c.a)(Bh,"PenMinutesManagerPackage",null,[3,4]);class ag extends va.a{constructor(Z,Ka){super();this.xxe=!1;this.lla=null;this.ttk=zb=>{1===zb?(f.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),
this.lla?this.ya.Qa(w.a.pMe,2,[this.lla,this.xxe]):this.ya.Cb(w.a.pMe,2)):f.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};this.ya=Z;this.eXe=Ka;this.QYc=!1}PB(Z,Ka,zb){this.lla=Ka;this.xxe=zb;f.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Z,zb);Z=this.Odi(Z);0===Z?(this.gf=6,this.Fg(0,Object(ta.a)("DialogClose"))):(this.gf=0,this.Fg(1,Object(ta.a)("DialogClose")));0===Z&&f.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.ZF(jf.a.ZIn,
this.fOm(Z),this.eOm(Z,Ka),this.ttk,!0)}Odi(Z){return 0>Z||6<Z?(f.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",Z),0):Z}eOm(Z,Ka){Z=this.Odi(Z);return this.eXe?[Object(ta.a)("FailToSaveFile"),Object(ta.a)("InvalidFileNameAllowPercentOctothorpe"),Object(ta.a)("EmptyNameText"),Object(ta.a)("InvalidPermissionText"),String.format(Object(ta.a)("OverwriteTargetText"),Ka),Object(ta.a)("LockTargetText"),Object(ta.a)("InvalidFileNameDisallowPercentOctothorpe")][Z]:[Object(ta.a)("FailToSaveFile"),
Object(ta.a)("InvalidFileNameText"),Object(ta.a)("EmptyNameText"),Object(ta.a)("InvalidPermissionText"),String.format(Object(ta.a)("OverwriteTargetText"),Ka),Object(ta.a)("LockTargetText"),Object(ta.a)("InvalidFileNameText")][Z]}fOm(Z){Z=this.Odi(Z);return[Object(ta.a)("GeneralFailTitle"),Object(ta.a)("InvalidFileNameTitle"),Object(ta.a)("EmptyNameTitle"),Object(ta.a)("GeneralFailTitle"),Object(ta.a)("GeneralFailTitle"),Object(ta.a)("GeneralFailTitle"),Object(ta.a)("InvalidFileNameTitle")][Z]}}Object(c.a)(ag,
"ErrorRetryDialog",va.a,[1511]);class zf{constructor(Z,Ka){this.Ba=Z;this.ya=Ka;this.eXe=this.Ba.getBooleanAppSetting("SaveToHostWithExtraCharsInFileName")}create(){return new ag(this.ya,this.eXe)}}Object(c.a)(zf,"ErrorRetryDialogFactory",null,[1493]);class Df extends dd.a{constructor(Z,Ka,zb,dc,Jc,jd,Ed){Ed=void 0===Ed?null:Ed;super();this.aSa=null;this.ya=Ka;this.Ayb=dc;this.$lc=jd;this.Ba=Z;this.i4=Jc;this.jo=zb;this.eXe=this.Ba.getBooleanAppSetting("SaveToHostWithExtraCharsInFileName");this.Hp=
Ed;this.Fg(1,Object(ta.a)("SaveButtonLabel"))}get Ea(){return this.jo}vol(Z,Ka){this.l_(1,!!Z&&Z!==Ka);this.aSa=document.getElementById(Df.Krl);Tc.a.addHandler(this.aSa,"change",Object(e.a)(this,this.Lrh,"onFileNameChange"));Tc.a.addHandler(this.aSa,"input",Object(e.a)(this,this.Lrh,"onFileNameChange"));this.aSa.focus()}Jrl(Z){return this.eXe?(new RegExp("["+this.uql('\\/:*?"<>|')+"]")).test(Z):(new RegExp("["+this.uql('\\/:*?"<>|#{}%~&')+"]")).test(Z)}uql(Z){return Z.replace(RegExp("[.*+?|()\\[\\]{}\\\\]",
"g"),"\\\\$&")}m2i(){const Z=Va.a.r$(h.AFrameworkApplication.Wz.TM);this.l_(1,!!this.aSa&&""!==this.aSa.value&&this.aSa.value!==Z)}Lrh(){this.aSa&&window.setTimeout(()=>{this.m2i()},0)}RBe(Z,Ka){if(1!==Z)f.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Z=Ka[Df.Krl];Ka=Df.ESl in Ka?Ka[Df.ESl]:!1;f.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Va.a.ckk(Z),Ka);const zb=Va.a.vI(h.AFrameworkApplication.fileName);
(Z=Z?Z.trim():null)&&""!==Z&&""!==zb||1===this.Ea.state?this.Jrl(Z)?this.i4.create().PB(1,Z,Ka):this.$lc.o7(Z+zb,Ka,this.Hp):this.i4.create().PB(2,Z,Ka)}}dispose(){this.aSa&&(Tc.a.removeHandler(this.aSa,"change",Object(e.a)(this,this.Lrh,"onFileNameChange")),Tc.a.removeHandler(this.aSa,"input",Object(e.a)(this,this.Lrh,"onFileNameChange")),this.aSa=null);super.dispose()}}Df.Krl="txtFileName";Df.ESl="chkOverwrite";Object(c.a)(Df,"FileNameDialogBase",dd.a,[]);class $f{static get Bl(){return dd.a.xX($f.Ny,
Object(ta.a)("SaveACopyFileName"),Object(ta.a)("SaveAsToHostOverwrite"))}}$f.Ny="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(c.a)($f,"FileNameDialogHtml",null,[]);class Kg extends Df{constructor(Z,Ka,zb,dc,Jc,jd){super(Z,Ka,zb,dc,Jc,jd);this.Bl=$f.Bl;this.uk="FileNameDialog-SaveAsToHost"}P9a(Z,Ka){const zb=Va.a.r$(h.AFrameworkApplication.Wz.TM);Ka={["txtFileName"]:Z||zb,["lblFolderName"]:Object(ta.a)("ToCurrentFolder"),["chkOverwrite"]:Ka};this.Dq(Object(ta.a)("SaveAs"),Object(e.a)(this,this.RBe,"fileNameDialogHandler"),Ka);this.vol(Z,zb)}}Object(c.a)(Kg,"FileNameDialog",Df,[1512]);class ug{constructor(Z,Ka,zb,dc,
Jc,jd){this.ya=Ka;this.Ba=Z;this.Ayb=dc;this.$lc=jd;this.i4=Jc;this.jo=zb}create(){return new Kg(this.Ba,this.ya,this.jo,this.Ayb,this.i4,this.$lc)}}Object(c.a)(ug,"FileNameDialogFactory",null,[1492]);class rh{constructor(Z,Ka,zb){this.H0l=(dc,Jc,jd,Ed,de)=>Jc.contextId!==r.a.frame||dc!==w.a.pMe?2:this.Ba.getBooleanAppSetting("SaveAsToHostBrsIsEnabled")?1===jd?u.SessionStatusManager.instance.QKa||h.AFrameworkApplication.boa?8:32:2===jd?(f.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),
dc=this.IIh.create(),de&&Object.getType(de)===Array&&2===de.length?dc.P9a(de[0],!!de[1]):dc.P9a(null,!1),32):8:8;this.$lc=zb;this.IIh=Ka;this.Ba=Z}Hb(){2===h.AFrameworkApplication.Ea.Kb.Im?h.AFrameworkApplication.vb.sa(w.a.pMe,r.a.frame,this.H0l,4):h.AFrameworkApplication.vb.za(w.a.pMe,r.a.frame,this.H0l)}}Object(c.a)(rh,"SaveAsToHostActor",null,[]);class gh{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de){this.Yu=null;this.xxe=this.R8a=!1;this.Hp=this.lla=null;this.Sua=!1;this.Ylc=null;this.Ba=Ka;this.d9a=this.Ba.appSettings.SaveAsToHostWebServiceBase;
this.R7k=dc;this.QWa=Jc;this.$m=zb;this.i4=jd;this.Un=de;this.jo=Ed;this.ya=Z;this.T8a=Ka.La("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx";this.Sua=Ka.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopyFileInNewTabEnabled",!1)}iVg(){1!==this.jo.state&&(this.Yu=this.QWa(),this.Yu.message=Object(ta.a)("CommentProgressTooltip"),this.Yu.gf=5,this.Yu.zz=!1,this.Yu.uCa(Object(ta.a)("DefaultDialogTitle"),null,null))}CUa(Z){Z=void 0===Z?0:Z;1!==this.jo.state&&this.i4.create().PB(Z,Va.a.r$(this.lla),
this.xxe)}$ie(){const Z=this.Ba.appSettings.BreadcrumbFolderUrl;this.Sua?f.ULS.sendTraceTag(8194016,219,15,"UploadToHostManager.RedirectToFolder: Opening Saved Document Folder in new tab."):f.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");Ac.a.jq(Z,Ac.a.syb(this.Sua?4:3),void 0,"UploadToHostManager.RedirectToFolder")}Zie(Z){let Ka=!1,zb=!1;this.Ba&&(Ka=this.Ba.getBooleanAppSetting("SaveACopyIsEnabledForUiHost"),zb=this.Ba.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"));
f.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url. IsEnabledForUiHost {0} uiHostSupportsFeature {1}",Ka,zb);if(Ka&&zb){f.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const dc={};dc[ne.a.mUc]="1";dc[ne.a.documentUrl]=Z;dc[ne.a.reason]=Ye.a.nOg;h.AFrameworkApplication.k3().execute(Jc=>{Jc.sendMessage(sf.a.gZa,dc)})}else Ka&&!zb&&h.AFrameworkApplication.pbc||this.Sua?(this.Sua&&f.ULS.sendTraceTag(507594581,219,15,"UploadToHostManager.RedirectToEditUrl: Opening Saved Document URL in new tab."),
Ac.a.jq(Z,Ac.a.syb(4),void 0,"UploadToHostManager.RedirectToEditUrl")):Ac.a.jq(Z,Ac.a.syb(3),void 0,"UploadToHostManager.RedirectToEditUrl")}o7(Z,Ka,zb){zb=void 0===zb?null:zb;f.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.R7k&&!this.R7k()&&this.$m&&(this.Un&&(this.Ylc=this.Un.wl("DialogShown","SaveAsToHostUploadTime")),this.iVg(),this.xxe=Ka,this.lla=Z,(this.Hp=zb)&&"true"===this.Hp.SkipSaveToHost?this.yfh():this.X9a())}X9a(){32!==this.ya.Cb(w.a.bed,1)?(f.ULS.sendTraceTag(18989378,
219,15,"The save file change is not supported, this operation may exist data losting."),this.yfh()):this.ya.Qa(w.a.bed,2,[()=>{f.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.yfh()},(Z,Ka)=>{f.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.CUa(Ka)}])}Osn(Z){this.wsc();this.R8a=!1;if(Z&&Z.data&&Z.data.responseData){let zb=Eb.d(Z.data.responseData);({BD:Ka}=zb);if(zb.returnValue)if(Z=
Ka,Z.StatusCode!==fd.a.bC&&Z.StatusCode!==fd.a.m6c){f.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var Ka={};Ka.FailureReason=Z.StatusCode.toString();Ka.ExtraInfo=Z.ExtraInfo;this.Vdc(Ka);this.CUa(parseInt(Z.ExtraInfo))}else{f.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.Zqk();try{Z.NewDocumentUrl&&""!==Z.NewDocumentUrl?this.Zie(Z.NewDocumentUrl):this.$ie()}catch(dc){f.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",
dc.toString())}this.qCg()}else f.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Cd.a.i0g(Z.data.responseData)}),this.Vdc({["FailureReason"]:"Failed to deserialize response"}),this.CUa()}else f.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.Vdc({["FailureReason"]:"null response"}),this.CUa()}Nsn(Z){5!==Z.data.status&&12!==Z.data.status||this.R8a?(f.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
{["Status"]:Z.data.status,["HttpStatus"]:Z.data.Ze}),this.Vdc({["FailureReason"]:Z.data.Ze.toString()}),this.wsc(),this.CUa(),this.qCg()):(f.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.R8a=!0,this.Hp&&"true"===this.Hp.SkipSaveToHost?this.yfh():this.X9a())}wsc(){this.Yu&&(this.Yu.close(),this.Yu=null)}qCg(){this.Ylc&&(this.Ylc.stop(),this.Ylc=null)}Zqk(){this.Hp&&"VersionHistory"===this.Hp.SaveEntryPoint&&this.ya.Cb(w.a.Tuh,2)}Vdc(Z){this.Hp&&"VersionHistory"===
this.Hp.SaveEntryPoint&&this.ya.Qa(w.a.$qk,2,Z)}yfh(){let Z=this.d9a+this.T8a;Z=Rc.a.em(Z,"qs",Va.a.Sj(h.AFrameworkApplication.ui));Z=Rc.a.em(Z,"n",Va.a.Sj((new Date).getTime().toString()));Z=Rc.a.em(Z,"ov",Va.a.Sj(this.xxe.toString()));Z=Rc.a.em(Z,"fn",Va.a.Sj(this.lla));this.Hp&&this.Hp.FileDownloadUrl&&(Z=Rc.a.em(Z,"furl",Va.a.Sj(this.Hp.FileDownloadUrl)));this.$m.rk(Z,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(e.a)(this,this.Osn,"onUploadFinished"),Object(e.a)(this,this.Nsn,
"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(c.a)(gh,"UploadToHostManager",null,[1381]);var Mh=a(1020);class Rh{constructor(){this.Ha=null;this.su=()=>{h.AFrameworkApplication.ga.getBooleanAppSetting("SaveAsToHostBrsIsEnabled")&&this.Ha.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Hb()}}get name(){return"Common.App.SaveAsToHost"}init(){h.AFrameworkApplication.ga.fg(this.su)}lc(Z){this.Ha=Z;this.Ha.register(zf,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").na(()=>
new zf(h.AFrameworkApplication.ga,h.AFrameworkApplication.vb)).ma();this.Ha.register(gh,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").na(()=>new gh(h.AFrameworkApplication.vb,h.AFrameworkApplication.ga,h.AFrameworkApplication.ye,()=>h.AFrameworkApplication.mi,()=>(new Mh.a).create(),Z.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),h.AFrameworkApplication.Ea,h.AFrameworkApplication.Ea.Rba)).ma();this.Ha.register(ug,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").na(()=>
new ug(h.AFrameworkApplication.ga,h.AFrameworkApplication.vb,h.AFrameworkApplication.Ea,h.AFrameworkApplication.Ea.Kb,Z.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Z.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma();this.Ha.register(rh,"Common.App.SaveAsToHost.SaveAsToHostActor").na(()=>new rh(h.AFrameworkApplication.ga,Z.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Z.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma()}dispose(){}static main(){b.a.instance.Fc(new Rh)}}
Object(c.a)(Rh,"SaveAsToHostPackage",null,[3,4]);class Ch extends va.a{constructor(){super();this.gf=0;this.Fg(1,Object(ta.a)("DialogClose"))}PB(Z,Ka){this.Hol(Z,Ka,jf.a.aJn)}Hol(Z,Ka,zb){f.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",zb);this.ZF(zb,Z,Ka,null)}Z$b(Z,Ka){f.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.ZF(jf.a.cJn,Z,Ka,null,!0)}}Object(c.a)(Ch,"ErrorDialog",va.a,[1491]);class ih{static get Bl(){return dd.a.xX(ih.Ny,
Object(ta.a)("FileNameLabel"),Object(ta.a)("NewFileLocationLabel"),Object(ta.a)("CurrentOnlineFolder"),"")}}ih.Ny="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(c.a)(ih,"FileNameDialogHtml",null,[]);class Mi extends Df{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de){super(Z,Ka,zb,dc,Jc,jd,de);this.a3c=this.oSh=this.Rla=null;this.qvm=Object(ta.a)("SaveToAnotherFolder");this.Bl=ih.Bl;this.uk="FileNameDialog-SaveToSharePoint";this.H5e=Ed;this.ukm=de}P9a(Z){const Ka=Va.a.r$(h.AFrameworkApplication.Wz.TM),zb=h.AFrameworkApplication.breadcrumbFolderName,dc=h.AFrameworkApplication.breadcrumbBrandName,Jc={["txtFileName"]:Z||Ka};let jd=Object(ta.a)("SaveAs");2===h.AFrameworkApplication.Ea.Kb.Im&&
(jd=Object(ta.a)("SaveACopy"));this.Dq(jd,Object(e.a)(this,this.RBe,"fileNameDialogHandler"),Jc);this.vol(Z,Ka);this.zui.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");h.AFrameworkApplication.ga.getBooleanAppSetting("HideSaveToAnotherFolderButtonforUIHost")||(this.Rla=document.getElementById("anotherFolder"),Z=document.getElementById("folderLocation"),this.oSh=Ga.a.Pbf(Z,this.Rla,"anotherFolderDescribedBy",""),this.Rla.className=
"WACButton WACDialogButtonNormal",Z=!1,zb&&zb.length?(this.Mdl(this.Rla,this.oSh,String.format(Object(ta.a)("ScreenReader_CurrentFileLocation"),dc,zb)),Z=this.Qnm(dc,zb)):this.Mdl(this.Rla,this.oSh,Object(ta.a)("CurrentOnlineFolder")),this.som(this.Rla),this.Rnm(this.Rla),Z?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Rla,"SaveToAnotherLocationTwo"),f.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Rla,
"SaveToAnotherLocationOne"),Tc.a.addHandler(this.Rla,ha.a.click,Object(e.a)(this,this.x1j,"onSaveToAnotherLocationClick")),Tc.a.addHandler(this.Rla,ha.a.Lj,Object(e.a)(this,this.nRl,"onSaveToAnotherLocationKeyDown")))}Qnm(Z,Ka){let zb;zb=!1;const dc=document.getElementById("currentLocation");dc.innerText="";const Jc=this.Avl(dc,Z),jd=this.Avl(dc,Ka);let Ed=255,de=255;255<Jc+jd&&(Ed=Math.max(238,408-Jc),de=Math.max(170,408-jd),zb=!0);this.rpm(dc,Z,de,Ka,Ed);return zb}Avl(Z,Ka){const zb=document.createElement("div");
zb.innerText=Ka;zb.style.visibility="hidden";Z.appendChild(zb);Ka=zb.clientWidth;Z.removeChild(zb);return Ka}rpm(Z,Ka,zb,dc,Jc){Ka&&(this.Ldl(Z,Ka,zb),this.jpm(Z));dc&&this.Ldl(Z,dc,Jc)}Ldl(Z,Ka,zb){const dc=document.createElement("div");dc.innerText=Ka;dc.title=Ka;dc.className="SaveToAnotherFolderBreadcrumb";dc.style.maxWidth=zb.toString()+"px";Z.appendChild(dc)}jpm(Z){const Ka=document.createElement("span");Ka.id="FolderSeparator";const zb=document.createElementNS("http://www.w3.org/2000/svg","svg");
zb.setAttribute("class","SeparatorCaret");const dc=document.createElementNS("http://www.w3.org/2000/svg","polygon");dc.setAttribute("points","1 4 1 11 5 7.5");zb.appendChild(dc);Ka.appendChild(zb);Z.appendChild(Ka)}Mdl(Z,Ka,zb){zb=String.format(Object(ta.a)("ScreenReader_SaveToAnotherFolderButton"),zb);Ka&&(Ka.innerText=zb);Z.tabIndex=0;Z.setAttribute(Ga.a.pi,Ga.a.BL)}Rnm(Z){const Ka=document.createElement("span");Ka.id="anotherFolderText";Ka.innerText=this.qvm;Ka.className="AnotherFolderTextSpan";
Z.appendChild(Ka)}som(Z){const Ka=document.createElement("span");Ka.className="cui-img-cont-float cui-img-16by16 ";this.a3c=document.createElementNS("http://www.w3.org/2000/svg","svg");this.a3c.setAttribute("class","FolderIconSVG");const zb=document.createElementNS("http://www.w3.org/2000/svg","path");zb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.a3c.appendChild(zb);Ka.appendChild(this.a3c);Z.appendChild(Ka)}nRl(Z){!Z||
Z.keyCode!==qa.a.hv&&Z.keyCode!==qa.a.Wue||this.x1j(Z)}x1j(){if(this.aSa){const Z=Va.a.vI(h.AFrameworkApplication.fileName);let Ka=this.aSa.value;this.hide();Ka&&""!==Ka&&""!==Z||1===this.Ea.state?(""!==Z&&(Ka+=Z),this.Jrl(Ka)?this.i4.create().PB(1,Ka,!1):this.H5e.start(Ka,this.ukm)):this.i4.create().PB(2,Ka,!1)}}Pwm(Z){this.Rla&&this.a3c&&(Z?(this.Rla.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Rla,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.a3c,"DisabledFolderIconSVG")):(this.Rla.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.Rla,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.a3c,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Rla,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.a3c,"DisabledFolderIconSVG"))))}m2i(){super.m2i();this.Pwm(!!this.aSa&&""!==this.aSa.value)}dispose(){this.Rla&&(Tc.a.removeHandler(this.Rla,ha.a.click,Object(e.a)(this,this.x1j,"onSaveToAnotherLocationClick")),Tc.a.removeHandler(this.Rla,ha.a.Lj,Object(e.a)(this,
this.nRl,"onSaveToAnotherLocationKeyDown")),this.Rla=null);super.dispose()}}Object(c.a)(Mi,"FileNameDialog",Df,[1506]);var Oi=a(1584),Ti=a(233),xi=a(878),uj=a(44);class Ma{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(c.a)(Ma,"SaveAsDialogInput",null,[]);class jc{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(c.a)(jc,"SaveLocation",null,[]);class Lc{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne){this.$Mh=
null;this.lla="";this.dOm=()=>{const Re=new M.a;Re.add(this.yNm());const Cf=this.mTm();Cf&&Re.addRange(Cf);return Object.assign(new Ma,{enableMoreLocations:!h.AFrameworkApplication.ga.getBooleanAppSetting("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.lla,extension:Va.a.vI(this.c9.TM),saveLocations:Re.toArray(),scenario:this.Kyb?"SaveToSharePoint":"SaveToCloudStorage"})};this.H5e=Z;this.i4=Ka;this.Hp=Ne;this.$lc=zb;this.jo=Jc;this.c9=dc;this.vsd=Ed;this.Rxe=de;jd&&(this.$Mh=new fe.a(()=>
new Ae.a(jd.value,null)));this.Kyb=!(null!==this.Hp&&this.Hp.hasOwnProperty("caller")&&"SaveToCloudManager"===this.Hp.caller.toString())}get k$l(){this.Zlc||(this.Zlc=l.a.instance.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"));return this.Zlc}yNm(){const Z=new Oi.a(Ti.a.Wn());let Ka=this.c9.breadcrumbFolderName;this.Kyb||null!=Ka&&""!=Ka||(Ka=Object(ta.a)("MyFiles"));Z.K("type","currentHost");return Object.assign(new jc,{folderName:Ka,friendlyPath:this.c9.breadcrumbBrandName,properties:Z})}q6m(Z){return!!Z&&
"ClassicMru"===Z.type&&!!Z.service_info&&!!Z.service_info.service_id&&-1!==Z.service_info.service_id.indexOf("SHAREPOINT")}mTm(){if(!this.$Mh||!this.vsd)return null;var Z=this.$Mh.value.Ci("SaveAsToSharePointDialog",!1);if(!Z||3!==Z.state||!Z.drh)return null;Z=Z.drh;const Ka=new M.a;let zb=0,dc=0;for(var Jc=0;Jc<Z.length;Jc++){var jd=Z[Jc];if(this.Kyb&&!this.q6m(jd))continue;zb++;const Ed=jd.title,de=xi.b(jd,h.AFrameworkApplication.isRtl);if(!Ed||!de)continue;if(this.Kyb&&!jd.sharepoint_info)continue;
const Ne=jd.url,Re=this.Kyb?jd.sharepoint_info.site_url:null;if(!Ne||this.Kyb&&!Re)continue;let Cf="",yg="";jd.onedrive_info&&(Cf=jd.onedrive_info.drive_id,yg=jd.onedrive_info.item_id);dc++;jd=new Oi.a(Ti.a.Wn());this.Kyb?jd.K("type","SharePoint"):jd.K("type","OneDrive");jd.K("siteUrl",Re);jd.K("folderUrl",Ne);jd.K("driveId",Cf);jd.K("folderId",yg);dc++;Ka.add(Object.assign(new jc,{folderName:Ed,friendlyPath:de,properties:jd}))}Jc=new Map;Jc.set("NumPlaces",Z.length.toString());Jc.set("NumSharepointPlaces",
zb.toString());Jc.set("placesWithMetadata",dc.toString());eg.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",Yg.b.FailureBased,"smartfio",Jc);0<zb&&(dc?.5>1*dc/zb&&eg.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):eg.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return Ka}cOm(){const Z={};Z.inputPropsCallback=this.dOm;return Z}P9a(Z){this.lla=Z;this.lla||(this.lla=String.format(Object(ta.a)("SaveACopy_Filename"),
Va.a.r$(this.c9.TM)));if(this.Kyb||h.AFrameworkApplication.ga.getBooleanAppSetting("UserCanWriteRelative")){Z={["id"]:"SaveAsDialog",["bodyControls"]:this.cOm()};var Ka=Object(ta.a)("SaveAs");2===this.jo.Kb.Im&&(Ka=Object(ta.a)("SaveACopy"));var zb=new dd.a(!1,!1,!0);zb.gf=1;zb.uk="SaveAsDialog";zb.Fg(1,Object(ta.a)("SaveButtonLabel"));zb.Dq(Ka,Object(e.a)(this,this.XIn,"saveAsDialogHandler"),Z)}else f.ULS.sendTraceTag(507610190,216,50,"load file picker directly"),Z=Va.a.vI(this.c9.TM),this.fFl(this.lla,
Z)}fQn(Z,Ka){Z&&""!==Z&&""!==Ka||1===this.jo.state?this.HDl()?this.fFl(Z,Ka):this.Kyb?(""!==Ka&&(Z+=Ka),this.H5e.start(Z,this.Hp)):(f.ULS.sendTraceTag(507610189,216,10,"Shared Picker not enabled"),this.i4.create().PB(0,Z,!1)):(f.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.i4.create().PB(2,Z,!1))}fFl(Z,Ka){eg.Health.instance.recordKpiUsage("SaveACopySFP",Yg.b.FailureBased,"smartfio",null);var zb=this.Kyb?2:0;zb=this.Rxe.Sdh(Object(ta.a)("PickerSaveACopyOkButton"),
Object(ta.a)("PickerSaveACopyTitle"),!1,!0,!1,null,"SaveACopy",zb);this.Rxe.CCf(zb).then(dc=>{if(dc&&0<dc.length){const Jc=dc[0][ne.a.fvn]||"root",jd=dc[0][ne.a.evn],Ed=dc[0][ne.a.gvn];dc=dc[0][ne.a.I6j];if(this.Kyb?""!==Ed&&""!==dc:""!==dc)this.Kyb?this.vsd.o7(dc,Z+Ka,Ed,Jc,jd,this.Hp):(f.ULS.sendTraceTag(507610126,216,50,"UploadToCloudManager called from shared"),this.k$l.o7(Jc,dc,Z+Ka,this.Hp)),eg.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.i4.create().PB(0,Z,!1);const de=uj.a.xx();
de&&(de.set("FolderIdAvailable",""===Jc?"false":"true"),de.set("DriveIdAvailable",""===jd?"false":"true"),de.set("SiteUrlAvailable",""===Ed?"false":"true"),de.set("FolderUrlAvailable",""===dc?"false":"true"));eg.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign({},{extendedProperties:de}))}}else this.i4.create().PB(0,Z,!1),eg.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(dc=>{"Canceled"===
dc?((dc=uj.a.xx())&&dc.set("IsCanceled","true"),eg.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign({},{extendedProperties:dc}))):eg.Health.instance.recordKpiFailure("SaveACopySFP",dc,!1,!1,null)})}HDl(){return this.Rxe?this.Rxe.mpj():(f.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}XIn(Z,Ka){if(Ka&&1===Z){Z=Ka.fileName;var zb=Va.a.vI(this.c9.TM);Ka.moreLocationsSelected&&this.fQn(Z,zb);if(Ka.locationCallback)if(Ka=Ka.locationCallback())if(Ka.properties&&"currentHost"===
Ka.properties.ha("type"))this.$lc.o7(Z+zb,!1,this.Hp);else if(Ka.properties&&"SharePoint"===Ka.properties.ha("type")){var dc=Ka.properties.ha("folderId");var Jc=Ka.properties.ha("driveId");var jd=Ka.properties.ha("siteUrl");Ka=Ka.properties.ha("folderUrl");this.vsd.o7(Ka,Z+zb,jd,dc,Jc,this.Hp)}else Ka.properties&&"OneDrive"===Ka.properties.ha("type")?(jd=null===(Jc=Ka.properties)||void 0===Jc?void 0:Jc.ha("folderId"),Ka=null===(dc=Ka.properties)||void 0===dc?void 0:dc.ha("folderUrl"),f.ULS.sendTraceTag(507610125,
216,50,"UploadToCloudManager called from dialog box"),this.k$l.o7(jd,Ka,Z+zb,this.Hp)):f.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back");else f.ULS.sendTraceTag(579179798,216,10,"selected location is empty");else f.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(c.a)(Lc,"ReactSaveAsDialog",null,[1506]);class gd{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re){this.ya=Ka;this.Ba=Z;this.Ayb=dc;this.$lc=jd;this.i4=Jc;this.jo=zb;this.vbl=Ed;this.wjm=void 0===de?null:
de;this.vsd=void 0===Ne?null:Ne;this.Rxe=void 0===Re?null:Re}create(Z){return this.jo&&this.jo.Kb.XV?new Lc(this.vbl,this.i4,this.$lc,h.AFrameworkApplication.Wz,this.jo,this.wjm,this.vsd,this.Rxe,Z):new Mi(this.Ba,this.ya,this.jo,this.Ayb,this.i4,this.$lc,this.vbl,Z)}}Object(c.a)(gd,"FileNameDialogFactory",null,[1488]);class Md{constructor(Z,Ka,zb,dc){this.XE=this.sHb=null;this.vwc=Jc=>{this.XE||3!==Jc.state||(this.XE=Jc)};this.jkd=Z;this.jo=zb;this.Ekm=dc;this.QFb=new fe.a(()=>new Ae.a(Ka.value,
this.vwc))}get VIe(){this.sHb||(this.QFb.value.Ci("Save As",!0),this.XE&&this.XE.bda&&this.XE.bda.length&&(this.sHb=this.RRi(this.XE.bda)));return this.sHb}start(Z){if(!this.VIe)if(h.AFrameworkApplication.breadcrumbFolderUrl&&h.AFrameworkApplication.breadcrumbFolderUrl.length)this.sHb=h.AFrameworkApplication.breadcrumbFolderUrl;else return f.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.XE),!1;const Ka=this.Ekm();Ka.SIk();const zb=Ka.xSi();if(!zb)return f.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.jkd.start((dc,Jc)=>{Ka.hide();Z(dc,Jc)},()=>{this.VYj(Ka)},zb,this.sHb);return!0}VYj(Z){Z.hide();f.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}RRi(Z){Z=Z.toLowerCase();Z.endsWith("/")||(Z+="/");const Ka=Z.indexOf("/documents/");return-1!==Ka?Z.substring(0,Ka+1)+"_layouts/15/onedrive.aspx":""}}Object(c.a)(Md,
"OneDriveFilePickerHelper",null,[1487]);class Kd extends dd.a{constructor(){super()}SIk(){this.BVe="FilePickerDialog";this.Bl="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.uk="PickerDialog-MsoSp";this.showDialog("",null)}xSi(){return document.getElementById("FilePickerDiv")}n7(){}kub(){}}Object(c.a)(Kd,"PickerDialog",dd.a,[1486]);var ye=a(974);class Se{constructor(Z,Ka,zb,dc,Jc,jd,Ed){this.Ba=Z;this.IIh=zb;this.ya=Ka;this.H5e=dc;this.jkd=Jc;this.lPh=jd;this.hgm=Ed}Hb(){const Z=this.jkd.KCe();
Z?za.a.eA||this.Ba.getBooleanAppSetting("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.ya.sa(w.a.dec,r.a.frame,Object(e.a)(this,this.R0l,"saveToSharePointActionDispatcher"),64):(Z.Rmb.continueWith(Ka=>{Ka.vm&&this.jkd.S_j(Ka)}),this.Kch()):f.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}Kch(){wc.a.Zth(Object(e.a)(this,this.R0l,"saveToSharePointActionDispatcher"));wc.a.wBe([new ye.a(w.a.dec,r.a.frame,0)],this.jkd.KCe())}get NUd(){return this.Ba.getBooleanAppSetting("SaveToAnotherFolderBrsIsEnabled")}get hjl(){return this.Ba.getBooleanAppSetting("UserCanWriteRelative")}R0l(Z,
Ka,zb,dc,Jc){return Ka.contextId!==r.a.frame||Z!==w.a.dec?2:this.NUd&&(this.lPh.VIe||this.hjl)?1===zb?u.SessionStatusManager.instance.QKa||h.AFrameworkApplication.boa?8:this.hgm()?32:8:2===zb?(f.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Jc&&Jc.SaveEntryPoint&&"VersionHistory"===Jc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.hjl?(f.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.IIh.create(Jc).P9a(null)):(f.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.H5e.start(null,Jc)),32):8:8}}Object(c.a)(Se,"SaveToSharePointActor",null,[]);class Pe{constructor(Z,Ka,zb,dc){this.Hp=this.i$k=null;this.vsd=Z;this.i4=Ka;this.lPh=zb;this.jo=dc}start(Z,Ka){f.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.i$k=Z;this.Hp=Ka;this.lPh.start((zb,dc)=>{this.processResponse(zb,dc)})||this.TIk()}processResponse(Z,Ka){Z?this.vw(Ka):this.SF(Ka)}TIk(){1!==this.jo.state&&this.i4().Z$b(Object(ta.a)("DefaultDialogTitle"),
Object(ta.a)("OneDriveContactError"))}vw(Z){f.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");let Ka="",zb="";Z&&Z.data&&Z.data.value&&Z.data.value.length&&Z.data.value[0].parentReference?(Ka=Z.data.value[0].id,zb=Z.data.value[0].parentReference.driveId,Ka&&zb||f.ULS.sendTraceTag(508040406,216,15,"Picker return invalid data, folder id is null: {0}, drive id is null: {1}.",!Ka,!zb)):f.ULS.sendTraceTag(508040405,216,15,"Picker return invalid data or empty parent reference.");
if(Z&&Z.data&&Z.data.value&&Z.data.value.length&&Z.data.value[0].sharePoint){const dc=Z.data.value[0].sharePoint.url;Z=Z.data.value[0].sharePoint.listUrl;let Jc=null;if(dc&&(Jc=Z?this.qTm(Z):this.pTm(dc))){this.vsd.o7(dc,this.i$k,Jc,Ka,zb,this.Hp);return}f.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!dc,!Jc)}f.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.TIk()}pTm(Z){Z.endsWith("/")||
(Z+="/");let Ka=0;for(let zb=0;zb<Z.length;zb++)if("/"===Z.charAt(zb)&&5===++Ka)return Z.substr(0,zb);return null}qTm(Z){Z.endsWith("/")&&(Z=Z.substring(0,Z.length-1));const Ka=Z.lastIndexOf("/");return-1!==Ka?Z.substring(0,Ka):null}SF(Z){f.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");Z&&Z.error?f.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",Z.error.errorCode,Z.error.message):f.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");
this.TIk()}}Object(c.a)(Pe,"SaveToSharePointManager",null,[1485]);class Qf{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re){this.d9a=Z;this.lla=Ka;this.Gwe=dc;this.RQh=de;this.Adb=zb;this.ETh=Jc;this.z9b=jd;this.f8g=Ed;this.T8a=Ne;this.Hp=Re}execute(Z,Ka){if(!h.AFrameworkApplication.mi&&h.AFrameworkApplication.ye){var zb={"Content-Type":"application/json; charset=utf-8"},dc=this.d9a+this.T8a;Ng.a.BI("d6454864;54012657");h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForSharePointSaveAsHandler",
!1)&&(zb["X-UseGraphFileUploader"]="1",zb["X-AADToken"]=h.AFrameworkApplication.ye.y_);this.z9b&&(dc=Rc.a.em(dc,"fo",Va.a.Sj(this.z9b)));this.f8g&&(dc=Rc.a.em(dc,"dr",Va.a.Sj(this.f8g)));dc=Rc.a.em(dc,"fu",Va.a.Sj(this.Adb));dc=Rc.a.em(dc,"su",Va.a.Sj(this.ETh));dc=Rc.a.em(dc,"fn",Va.a.Sj(this.lla));dc=Rc.a.em(dc,"n",Va.a.Sj((new Date).getTime().toString()));this.Hp&&this.Hp.FileDownloadUrl&&(dc=Rc.a.em(dc,"furl",Va.a.Sj(this.Hp.FileDownloadUrl)));dc=dc+"&"+this.RQh;this.Gwe&&this.Gwe.length?dc=Rc.a.em(dc,
"fnn",Va.a.Sj(this.Gwe)):f.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");f.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");h.AFrameworkApplication.ye.rk(dc,1,"",zb,!1,2,Z,Ka,null,void 0,void 0,void 0,void 0,"9")}}}Object(c.a)(Qf,"SharePointSaveAsCaller",null,[1408]);class sg{constructor(Z){this.bzb=Z.appSettings.SaveAsToHostWebServiceBase;this.lla=Z.appSettings.FileName;this.T8a=Z.La("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Z,
Ka,zb,dc,Jc,jd){return new Qf(this.bzb,this.lla,Z,Ka,zb,dc,Jc,h.AFrameworkApplication.ui,this.T8a,jd)}}Object(c.a)(sg,"SharePointUploadCallerFactory",null,[1382]);var Bf=a(741);class Wf{constructor(Z,Ka,zb,dc,Jc){this.Yu=this.sUe=null;this.kEh=!1;this.nSh=this.Adb=null;this.Sua=!1;this.fWh=Ka;this.QWa=zb;this.i4=dc;this.jo=Jc;this.ya=Z;this.Sua=h.AFrameworkApplication.ga?h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopyFileInNewTabEnabled",!1):!1}o7(Z,Ka,zb,
dc,Jc,jd){this.kEh=!1;f.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.iVg();this.Adb=Z;jd&&jd.SaveEntryPoint&&(this.nSh=jd.SaveEntryPoint);this.sUe=this.fWh.create(Z,Ka,zb,dc,Jc,jd);jd&&"true"===jd.SkipSaveToHost?this.X9a():this.VJm()}VJm(){const Z=()=>{f.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.X9a()};32!==this.ya.Qa(w.a.bed,2,[()=>{f.ULS.sendTraceTag(23881922,
216,50,"Call the force save file change successfully.");this.X9a()},Z])&&Z()}X9a(){f.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.sUe.execute(Object(e.a)(this,this.Orn,"onSaveToSharePointUploadFinished"),Object(e.a)(this,this.Nrn,"onSaveToSharePointUploadFailed"))}Orn(Z){if(Z&&Z.data&&Z.data.responseData){var Ka;let zb=Eb.d(Z.data.responseData);({BD:Ka}=zb);if(zb.returnValue)if(Ka.StatusCode!==fd.a.bC&&Ka.StatusCode!==fd.a.m6c)f.ULS.sendTraceTag(25235987,216,
15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Z.data.status,Ka.StatusCode),Ka.StatusCode!==fd.a.e_l&&this.Nol(Z.data.status)||(this.Vdc(Ka.StatusCode.toString()),this.HPn(Ka.StatusCode));else{f.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.Zqk();try{Ka.NewDocumentUrl?this.Zie(Ka.NewDocumentUrl):this.$ie()}catch(dc){f.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",dc.toString())}}else f.ULS.sendTraceTag(23881926,
216,10,"Failed to deserialize : {0}",{["ResponseData"]:Cd.a.i0g(Z.data.responseData)}),this.Meh()||(this.Vdc("Failed to deserialize response"),this.fVg())}else f.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.Meh()||(this.Vdc("Unknown"),this.fVg())}Nrn(Z){Z&&Z.data?this.Nol(Z.data.status)||(f.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Vdc(Bf.a[Z.data.status]),this.fVg()):(f.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.Meh()||
(this.Vdc("Unknown"),this.fVg()))}Meh(){if(!this.kEh)return f.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.kEh=!0,this.X9a(),!0;f.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}Nol(Z){f.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",Z);return this.Meh()}$ie(){this.Sua?f.ULS.sendTraceTag(23881933,216,15,"UploadToSharePointManager.RedirectToFolder: Opening Saved Document Folder in new tab."):f.ULS.sendTraceTag(23881933,
216,50,"Redirecting to Folder.");Ac.a.jq(this.Adb,Ac.a.syb(this.Sua?4:3),void 0,"UploadToSharePointManager.RedirectToFolder")}Zie(Z){var Ka=!1;let zb=!1;h.AFrameworkApplication.ga&&(Ka=h.AFrameworkApplication.ga.getBooleanAppSetting("SaveACopyIsEnabledForUiHost"),zb=h.AFrameworkApplication.ga.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"));f.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url. IsEnabledForUiHost {0}",Ka);if(Ka&&zb){f.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const dc={};dc[ne.a.mUc]="1";dc[ne.a.documentUrl]=Z;dc[ne.a.reason]=Ye.a.nOg;h.AFrameworkApplication.k3().execute(Jc=>{Jc.sendMessage(sf.a.gZa,dc)})}else Ka=this.Sua?4:3,this.Sua&&f.ULS.sendTraceTag(507594579,216,15,"UploadToSharePointManager.RedirectToEditUrl: Opening Saved Document URL in new tab."),Ac.a.jq(Z,Ac.a.syb(Ka),void 0,"UploadToSharePointManager.RedirectToEditUrl")}iVg(){this.jo&&1===this.jo.state||(this.Yu=this.QWa(),this.Yu.message=Object(ta.a)("CommentProgressTooltip"),this.Yu.gf=5,
this.Yu.zz=!1,this.Yu.uCa(Object(ta.a)("DefaultDialogTitle"),null,null))}wsc(){this.Yu&&(this.Yu.close(),this.Yu=null)}fVg(){this.QE(Object(ta.a)("SaveFailedDialogTitle"),Object(ta.a)("FailToSaveFile"))}iQn(){this.QE(Object(ta.a)("NoSavePermissionDialogTitle"),Object(ta.a)("NoSavePermissionDialogMessage"))}LPn(){const Z=String.format(Object(ta.a)("SaveAsFileTooLargeMessage"),250);this.QE(Object(ta.a)("SaveAsFileTooLargeTitle"),Z,jf.a.YIn)}QE(Z,Ka,zb){zb=void 0===zb?jf.a.bJn:zb;f.ULS.sendTraceTag(25180165,
216,10,"Upload failure with title: {0}, message: {1}",Z,Ka);this.wsc();1!==this.jo.state&&this.i4().Hol(Z,Ka,zb)}HPn(Z){f.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",Z);switch(Z){case fd.a.MOe:this.iQn();break;case fd.a.e_l:this.LPn();break;default:this.fVg()}}Zqk(){this.Sua&&this.wsc();"VersionHistory"===this.nSh&&this.ya.Cb(w.a.Tuh,2)}Vdc(Z){this.Sua&&this.wsc();"VersionHistory"===this.nSh&&this.ya.Qa(w.a.$qk,2,{["FailureReason"]:Z})}}Object(c.a)(Wf,"UploadToSharePointManager",
null,[1383]);class Xf{constructor(){this.T3c=this.oOh=this.jOh=this.Ha=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}lc(Z){this.Ha=Z;this.jOh=Me.a.aG(Z.Na("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.oOh=Me.a.aG(Z.Na("Common.IEventEmitter<Common.IMruResult>"));this.T3c=Me.a.aG(Z.Na("Common.App.SharedFilePicker.ISharedFilePicker"));Uc.Task.WAA.call(null,this.jOh,this.oOh,this.T3c).continueWith(()=>{this.cEn()})}cEn(){this.Ha.register(sg,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").na(()=>
new sg(h.AFrameworkApplication.ga)).ma();this.Ha.register(Wf,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").na(()=>new Wf(h.AFrameworkApplication.vb,this.Ha.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Mh.a).create(),()=>new Ch,h.AFrameworkApplication.Ea)).ma();this.Ha.register(Pe,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").na(()=>
new Pe(this.Ha.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Ch,this.Ha.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),h.AFrameworkApplication.Ea)).ma();this.Ha.register(Md,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").na(()=>new Md(this.Ha.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new fe.a(()=>this.jOh.result),h.AFrameworkApplication.Ea,()=>new Kd)).ma();
this.Ha.register(gd,"Common.App.SaveToSharePoint.FileNameDialogFactory").na(()=>new gd(h.AFrameworkApplication.ga,h.AFrameworkApplication.vb,h.AFrameworkApplication.Ea,h.AFrameworkApplication.Ea.Kb,this.Ha.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Ha.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Ha.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new fe.a(()=>this.oOh.result),this.Ha.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
this.T3c?this.T3c.result:null)).ma();this.Ha.register(Se,"Common.App.SaveToSharePoint.SaveToSharePointActor").na(()=>new Se(h.AFrameworkApplication.ga,h.AFrameworkApplication.vb,this.Ha.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Ha.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Ha.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.Ha.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>h.AFrameworkApplication.Ea.w5c)).ma();
h.AFrameworkApplication.ga.getBooleanAppSetting("SaveToAnotherFolderBrsIsEnabled")&&this.Ha.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Hb()}static main(){b.a.instance.Fc(new Xf)}}Object(c.a)(Xf,"PackageManager",null,[3,4]);class Xa extends va.a{constructor(){super();this.gf=0;this.Fg(1,Object(ta.a)("DialogClose"))}PB(Z){this.ZF(Z,Object(ta.a)("DefaultDialogTitle"),Object(ta.a)("ErrorSavingToOneDrive"),null)}}Object(c.a)(Xa,"ErrorDialog",va.a,[1495]);class T{}T.default=0;Object(c.a)(T,
"SaveToCloudErrorCodes",null,[]);class Ba{}Ba.ZVc="SaveToCloudStorage";Ba.WVc="SaveACopy";Object(c.a)(Ba,"SaveToCloudStorageConstants",null,[]);class kb{constructor(Z,Ka,zb,dc,Jc,jd,Ed){this.Hp=null;this.amm=Z;this.hSa=Ka;this.Zlc=zb;this.Ba=dc;this.kwe=Jc;this.i4=jd;this.S2e=Ed}get WIn(){this.sbl||(this.sbl=l.a.instance.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"));return this.sbl}start(Z){this.Hp=Z;this.S2e.rSe?this.S2e.Start(Z):(Z=null!==this.Hp&&this.Hp.hasOwnProperty("SaveEntryPoint")&&
this.Hp.SaveEntryPoint.toString()===Ba.ZVc,this.hSa.QPf?(Object(v.a)(String,h.AFrameworkApplication.Rf.Host),h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb&&1===h.AFrameworkApplication.Ea.Kb.Im&&Z?(f.ULS.sendTraceTag(508852051,216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.Zlc.o7("root","https://onedrive.live.com",null,this.Hp)):(f.ULS.sendTraceTag(6590559,216,h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb&&1===h.AFrameworkApplication.Ea.Kb.Im?
15:50,"User is signed in. We will show file picker."),null!==this.Hp&&this.Hp.hasOwnProperty("showSaveAsDialog")&&"true"===this.Hp.showSaveAsDialog?this.lwm():this.Ril())):(f.ULS.sendTraceTag(6590560,216,h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb&&1===h.AFrameworkApplication.Ea.Kb.Im?15:50,"User is not signed in. We will show sign in dialog."),this.BQn()))}lwm(){this.Hp.caller="SaveToCloudManager";const Z=this.WIn.create(this.Hp);Z.HDl()?(f.ULS.sendTraceTag(507646752,216,50,"Call ReactSaveAs dialog box"),
Z.P9a(null)):(f.ULS.sendTraceTag(507646753,216,50,"SharedSaveACopyPicker not enabled"),this.Ril())}BQn(){this.amm.create().P9a()}QE(){this.i4().PB(T.default)}Ril(){try{f.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let Z={["client_id"]:this.Ba.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.kwe||2===this.kwe)Z={["client_id"]:this.Ba.appSettings.UploadToSkyDriveClientId};WL.init(Z);f.ULS.sendTraceTag(6590562,216,h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb&&
1===h.AFrameworkApplication.Ea.Kb.Im?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(e.a)(this,this.vw,"onSuccess"),Object(e.a)(this,this.SF,"onFailure"))}catch(Z){f.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Z,Z.stack),this.QE()}}vw(Z){f.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Z&&Z.data&&Z.data.folders&&this.Zlc.o7(Z.data.folders[0].id,
Z.data.folders[0].urls.viewInBrowser,null,this.Hp)}SF(Z){if(Z&&Z.error){if("user_canceled"===Z.error.code){f.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}f.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Z.error.code,Z.error.message)}else f.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.QE()}}Object(c.a)(kb,"SaveToCloudManager",null,[1499]);class Ab{constructor(Z,Ka,zb,dc){this.n$g=
null;this.zlm=Z;this.Ba=zb;this.M$k=Ka;this.m9k=new ed.a;this.Un=dc}NUd(){return this.Ba.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")}ttl(){return w.a.ZVc}Kch(){wc.a.Zth(Object(e.a)(this,this.Q0l,"saveToCloudActionDispatcher"));wc.a.wBe([new ye.a(w.a.ZVc,r.a.frame,0)],this.M$k.KCe())}Hb(){const Z=this.M$k.KCe();Z?(Z.lma(()=>{this.m9k.vj(!0)}),this.Kch()):f.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}mXl(){f.ULS.sendTraceTag(6590597,
216,50,"User clicked on SaveToOneDrive button")}Q0l(Z,Ka,zb,dc,Jc){dc=h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb&&1===h.AFrameworkApplication.Ea.Kb.Im;var jd="";switch(Z){case w.a.ZVc:jd=Ba.ZVc;break;case w.a.WVc:jd=Ba.WVc;break;default:f.ULS.sendTraceTag(508372377,216,50,"SaveToCloudStorageActor Entry Point other than SaveToCloudStorage or SaveACopy")}if(Ka.contextId!==r.a.frame||Z!==this.ttl())return 2;if(!this.NUd())return 8;if(1===zb)return u.SessionStatusManager.instance.QKa||
h.AFrameworkApplication.boa?8:32;if(2===zb){this.mXl();const Ed=dc&&jd===Ba.ZVc&&null===Jc?{}:Jc;Ed&&(Ed.SaveEntryPoint=jd);Ed&&Ed.FileDownloadUrl&&f.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there");this.Un&&(this.n$g=this.Un.wl("DialogShown","SaveToOneDriveReponseTime"));this.m9k.task.continueWith(()=>{this.n$g&&(this.n$g.stop(),this.n$g=null);this.zlm.start(Ed)});return 32}return 8}}Object(c.a)(Ab,"SaveToCloudStorageActor",null,[1498]);var ic=a(121);class zc extends va.a{constructor(Z,
Ka,zb){super();this.A2m=dc=>{0===dc?(f.ULS.sendTraceTag(6590598,216,h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb&&1===h.AFrameworkApplication.Ea.Kb.Im?15:50,"User dismissed SignIn Dialog."),this.hide()):this.ode()};this.CRl=()=>{this.Z0&&this.hide();f.ULS.sendTraceTag(7143885,216,h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb&&1===h.AFrameworkApplication.Ea.Kb.Im?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ya.Cb(w.a.ZVc,2)};this.ya=
Z;this.hSa=Ka;this.Ayb=zb;this.nGa=!1;this.gf=1;this.uvb(1);this.Fg(1,Object(ta.a)("SignIn"));this.Fg(0,Object(ta.a)("SignInToSaveDialogCancelButton"))}P9a(){this.hSa.Lah(this.CRl);this.xG(Object(ta.a)("SignInToSaveDialogTitle"),Object(ta.a)("SaveToCloudSignInDialog"),0,this.A2m)}Ywm(){let Z="2";if(this.Ayb)switch(this.Ayb.Im){case 3:Z="0";break;case 2:Z="3";break;case 1:Z="1"}return Z}hide(){this.hSa.CYl(this.CRl);super.hide()}ode(){var Z=h.AFrameworkApplication.ga.getBooleanAppSetting("SignInAspxInWebAppsPortalIsEnabled")?
"/start/signin.aspx":"Signin.aspx";Z=new ic.QueryStringBuilder(Z);Z.Zi("prompt","1");Z.Zi("cbcxt",this.Ywm());h.AFrameworkApplication.dzb(Z);Ac.a.jq(Z.toString(),"LoginWindow",void 0,"SignInDialog")}}Object(c.a)(zc,"SignInDialog",va.a,[1516]);class Fc{constructor(Z,Ka,zb){this.ya=Z;this.hSa=Ka;this.Ayb=zb}create(){return new zc(this.ya,this.hSa,this.Ayb)}}Object(c.a)(Fc,"SignInDialogFactory",null,[1497]);class lc{constructor(Z,Ka,zb,dc,Jc,jd,Ed){this.d9a=Z;this.lla=Ka;this.Gwe=zb;this.z9b=dc;this.RQh=
Jc;this.T8a=jd;this.Hp=Ed}execute(Z,Ka){if(!h.AFrameworkApplication.mi&&h.AFrameworkApplication.ye){var zb={"Content-Type":"application/json; charset=utf-8"};Ng.a.BI("ib994913;b48ce942");var dc=h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForSkyDriveUploadHandler",!1),Jc=h.AFrameworkApplication.ye.y_,jd=!!Jc,Ed=dc&&jd;Ed?(zb["X-UseGraphFileUploader"]="1",zb["X-AADToken"]=Jc):(this.d9a="/start/",this.T8a.startsWith("/start/")&&(this.T8a=this.T8a.substring(7)));
f.ULS.sendTraceTag(507908319,216,50,"Use GraphFileUploader:{0}, flight enabled:{1}, token available:{2}",Ed,dc,jd);dc=this.d9a+this.T8a;dc=Rc.a.em(dc,"fo",Va.a.Sj(this.z9b));dc=Rc.a.em(dc,"fn",Va.a.Sj(this.lla));dc=Rc.a.em(dc,"qs",Va.a.Sj(this.RQh));dc=Rc.a.em(dc,"n",Va.a.Sj((new Date).getTime().toString()));this.Hp&&this.Hp.FileDownloadUrl&&(dc=Rc.a.em(dc,"furl",Va.a.Sj(this.Hp.FileDownloadUrl)));this.Gwe&&(dc=Rc.a.em(dc,"fnn",Va.a.Sj(this.Gwe)));h.AFrameworkApplication.ye.rk(dc,1,"",zb,!1,2,Z,Ka,
null)}}}Object(c.a)(lc,"SkyDriveUploadCaller",null,[1515]);class nd{constructor(Z){this.Ba=Z;this.bzb=Z.appSettings.SkyDriveUploadWebServiceBase;this.lla=Z.appSettings.FileName;this.T8a=Z.La("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Z,Ka,zb){return new lc(this.bzb,this.lla,Ka,Z,h.AFrameworkApplication.ui,this.T8a,zb)}}Object(c.a)(nd,"SkydriveUploadCallerFactory",null,[1496]);class vd{constructor(Z,Ka,zb,dc,Jc){this.Adb=this.Yu=this.sUe=null;this.Sua=this.R8a=!1;this.Hp=this.Ylc=
null;this.fWh=Z;this.QWa=Ka;this.i4=zb;this.jo=dc;this.Un=Jc;this.Sua=h.AFrameworkApplication.ga?h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopyFileInNewTabEnabled",!1):!1}iVg(){this.jo&&1===this.jo.state||(this.Yu=this.QWa(),this.Yu.message=Object(ta.a)("CommentProgressTooltip"),this.Yu.gf=5,this.Yu.zz=!1,this.Yu.uCa(Object(ta.a)("DefaultDialogTitle"),null,null))}wsc(){this.Yu&&(this.Yu.close(),this.Yu=null)}CUa(){1!==h.AFrameworkApplication.Ea.state&&this.i4().PB(T.default)}$ie(){this.Sua?
f.ULS.sendTraceTag(6590599,216,15,"UploadToCloudManager.RedirectToFolder: Opening Saved Document Folder URL in new tab."):f.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");Ac.a.jq(this.Adb,Ac.a.syb(this.Sua?4:3),void 0,"UploadToCloudManager.RedirectToFolder")}Zie(Z){var Ka=null!==this.Hp&&this.Hp.hasOwnProperty("SaveEntryPoint")&&this.Hp.SaveEntryPoint.toString()===Ba.ZVc;h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb&&1===h.AFrameworkApplication.Ea.Kb.Im&&Ka&&(Z+="&wdsvodm=true");
let zb=Ka=!1;h.AFrameworkApplication.ga&&(Ka=h.AFrameworkApplication.ga.getBooleanAppSetting("SaveACopyIsEnabledForUiHost"),zb=h.AFrameworkApplication.ga.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"));f.ULS.sendTraceTag(6654163,216,h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb&&1===h.AFrameworkApplication.Ea.Kb.Im?15:50,"Redirecting to edit url. IsEnabledForUiHost {0}",Ka);if(Ka&&zb){f.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const dc={};dc[ne.a.mUc]="1";dc[ne.a.documentUrl]=Z;h.AFrameworkApplication.k3().execute(Jc=>{Jc.sendMessage(sf.a.gZa,dc)})}else Ka=this.Sua?4:3,this.Sua&&f.ULS.sendTraceTag(507594583,216,15,"UploadToCloudManager.RedirectToEditUrl: Opening Saved Document URL in new tab."),Ac.a.jq(Z,Ac.a.syb(Ka),void 0,"UploadToCloudManager.RedirectToEditUrl")}o7(Z,Ka,zb,dc){zb=void 0===zb?null:zb;dc=void 0===dc?null:dc;f.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Un&&(this.Ylc=this.Un.wl("DialogShown",
"SaveToOneDriveUploadTime"));this.iVg();this.Adb=Ka;this.sUe=this.fWh.create(Z,zb,dc);this.Hp=dc;this.X9a()}X9a(){f.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.sUe.execute(Object(e.a)(this,this.Mrn,"onSaveToCloudUploadFinished"),Object(e.a)(this,this.Lrn,"onSaveToCloudUploadFailed"))}Mrn(Z){this.wsc();this.R8a=!1;if(Z&&Z.data&&Z.data.responseData){var Ka;let zb=Eb.d(Z.data.responseData);({BD:Ka}=zb);if(zb.returnValue)if(Z=Ka,Z.StatusCode!==fd.a.bC&&Z.StatusCode!==fd.a.m6c)f.ULS.sendTraceTag(6590602,
216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.CUa();else{f.ULS.sendTraceTag(6590603,216,h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb&&1===h.AFrameworkApplication.Ea.Kb.Im?15:50,"UploadToCloudManager upload success.");try{Z.NewDocumentUrl&&""!==Z.NewDocumentUrl?this.Zie(Z.NewDocumentUrl):this.$ie()}catch(dc){f.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",dc.toString())}this.qCg()}else f.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",
{["ResponseData"]:Cd.a.i0g(Z.data.responseData)}),this.CUa()}else f.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.CUa()}Lrn(Z){5!==Z.data.status&&12!==Z.data.status||this.R8a?(f.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",Z.data.status),this.wsc(),this.CUa(),this.qCg()):(f.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.R8a=!0,this.X9a())}qCg(){this.Ylc&&(this.Ylc.stop(),this.Ylc=
null)}}Object(c.a)(vd,"UploadToCloudManager",null,[1407]);class od{constructor(Z){this.Ba=Z;this.d9a=Z.appSettings.SkyDriveUploadWebServiceBase;this.T8a=Z.La("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx";Z.fg(()=>{this.wcm()})}get rSe(){if(!this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseODCXStackOperationManager",!1)||!this.C3c)return!1;var Z=this.Ba.La("FileSource");return!Z||"SharePointOnlineConsumer"!=Z&&"OneDriveWOPI"!=Z?!1:Z!=this.C3c||"SharePointOnlineConsumer"==Z}get cdm(){return"OneDriveWOPI"==
this.C3c?"OneDriveWopi":"SharePointOnlineConsumer"==this.C3c?"SharePoint":h.AFrameworkApplication.Wab}get PersonalFileStorageUrl(){return this.Ckm}Start(Z){l.a.instance.Na("Common.App.SharedFilePicker.ISharedFilePicker").execute(Ka=>{const zb=Ka.Sdh(Object(ta.a)("PickerSaveACopyOkButton"),Object(ta.a)("PickerSaveACopyTitle"),!1,!0,!1,null,"SaveACopy",0);Ka.CCf(zb).then(dc=>{dc&&0<dc.length?(f.ULS.sendTraceTag(507867474,216,50,"Got data from file picker"),dc=dc[0],(new Wd(Z,this.C3c,dc.id,dc.name,
dc.url,dc.driveId,dc.siteUrl,this.gdm)).P9a()):f.ULS.sendTraceTag(507867473,216,10,"Got null/empty data from file picker")}).catch(dc=>{f.ULS.sendTraceTag(507867472,216,50,"File picker failed with error {0}",dc)})})}gdm(Z,Ka,zb,dc,Jc,jd,Ed,de){"OneDriveWOPI"==Z?l.a.instance.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager").o7(zb,Jc,Ka,de):l.a.instance.resolve("Common.App.SaveToSharePoint.IUploadToSharePointManager").o7(Jc,Ka,Ed,zb,jd,de)}wcm(){var Z=this.Ba.La("FileSource");this.C3c=Z;
if("SharePointOnlineConsumer"==Z||"OneDriveWOPI"==Z){var Ka=this.Ba.La("LoggableUserId");if(this.Ba.La("LoggableOwnerId")!=Ka||"OneDriveWOPI"!=Z){Z=null;"MsaCid"==h.AFrameworkApplication.ga.La("LoggableUserIdSpace")?Z=Ka:"Windows Live"==h.AFrameworkApplication.ga.La("PresenceProvider")&&(Z=h.AFrameworkApplication.ga.La("PresenceUserId"));Ka=this.d9a+this.T8a;var zb={};zb.Cid=Z;h.AFrameworkApplication.ye.rk(Ka+"?cpfsi=1",1,"",zb,!1,2,dc=>{this.Ckm=dc.data.fk.PersonalFileStorageLocation;this.C3c=dc.data.fk.PersonalFileStorageHost},
()=>{},null,null,!1,1E4,2E4,"CheckConvergedUserStatus",null,!1,null,["PersonalFileStorageLocation","PersonalFileStorageHost"])}}}}Object(c.a)(od,"ODCXStackOperationManager",null,[]);class Bd{static get Bl(){return dd.a.xX(Bd.Ny,Object(ta.a)("SaveACopyFileName"))}}Bd.Ny="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(c.a)(Bd,"FileNameDialogHtml",null,[]);class Wd extends dd.a{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de){super();this.z9b=this.Adb=null;this.Fg(1,Object(ta.a)("SaveButtonLabel"));this.Bl=Bd.Bl;this.uk="FileNameDialog-SaveACopy";this.Hp=Z;this.C3c=Ka;this.BZ=de;this.z9b=zb;this.Adb=Jc;this.ETh=Ed;this.U6k=dc;this.f8g=jd}P9a(){const Z={["txtFileName"]:Va.a.r$(h.AFrameworkApplication.Wz.TM),["lblFolderName"]:String.format(Object(ta.a)("DestinationFolder"),this.U6k)};this.Dq(Object(ta.a)("SaveToOneDrive"),
Object(e.a)(this,this.RBe,"fileNameDialogHandler"),Z);f.ULS.sendTraceTag(507867471,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}RBe(Z,Ka){1!==Z?f.ULS.sendTraceTag(507867470,216,50,"User clicked cancel to cancel upload file in file name dialog."):(Z=Ka.txtFileName.trim(),f.ULS.sendTraceTag(507867469,216,50,"User clicked save to upload file with new name."),Ka=Va.a.vI(h.AFrameworkApplication.fileName),Z&&""!==Z&&""!==Ka&&(Z+=Ka),this.BZ(this.C3c,
Z,this.z9b,this.U6k,this.Adb,this.f8g,this.ETh,this.Hp))}}Object(c.a)(Wd,"FileNameDialog",dd.a,[]);class ce{constructor(){this.Ha=null}get name(){return"Common.App.SaveToCloudStorage"}init(){h.AFrameworkApplication.ga.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")&&this.Ha.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Hb()}dispose(){}lc(Z){this.Ha=Z;this.Ha.register(Fc,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").na(()=>
new Fc(h.AFrameworkApplication.vb,Qh.a.instance,h.AFrameworkApplication.Ea.Kb)).ma();this.Ha.register(nd,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").na(()=>new nd(h.AFrameworkApplication.ga)).ma();this.Ha.register(Ab,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").na(()=>new Ab(Z.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),Z.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
h.AFrameworkApplication.ga,h.AFrameworkApplication.Ea.Rba)).ma();this.Ha.register(vd,"Common.App.SaveToCloudStorage.UploadToCloudManager").na(()=>new vd(Z.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Mh.a).create(),()=>new Xa,h.AFrameworkApplication.Ea,h.AFrameworkApplication.Ea.Rba)).ma();this.Ha.register(kb,"Common.App.SaveToCloudStorage.SaveToCloudManager").na(()=>new kb(Z.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Qh.a.instance,Z.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
h.AFrameworkApplication.ga,h.AFrameworkApplication.ztc,()=>new Xa,Z.resolve("Common.App.SaveToCloudStorage.ODCXStackOperationManager"))).ma();this.Ha.register(od,"Common.App.SaveToCloudStorage.ODCXStackOperationManager").na(()=>new od(h.AFrameworkApplication.ga)).ma()}static main(){b.a.instance.Fc(new ce)}}Object(c.a)(ce,"PackageManager",null,[3,4]);class db{static get Bl(){return dd.a.xX(db.Ny,Object(ta.a)("SaveACopyFileName"))}}db.Ny="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(c.a)(db,"FileNameDialogHtml",null,[]);class gc extends dd.a{constructor(Z,Ka,zb,dc){super();this.z9b=this.Adb=null;this.ya=Z;this.Ayb=Ka;this.Zlc=zb;this.Fg(1,Object(ta.a)("SaveButtonLabel"));this.Bl=db.Bl;this.uk="FileNameDialog-SaveACopy";this.Hp=dc}P9a(Z,Ka,zb){this.z9b=Z;this.Adb=zb;Z={["txtFileName"]:Va.a.r$(h.AFrameworkApplication.Wz.TM),["lblFolderName"]:String.format(Object(ta.a)("DestinationFolder"),Ka)};this.Dq(Object(ta.a)("SaveToOneDrive"),Object(e.a)(this,this.RBe,"fileNameDialogHandler"),
Z);f.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}RBe(Z,Ka){1!==Z?f.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Z=Ka.txtFileName.trim(),f.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),Ka=Va.a.vI(h.AFrameworkApplication.fileName),Z&&""!==Z&&""!==Ka&&(Z+=Ka),this.Zlc.o7(this.z9b,this.Adb,Z,this.Hp))}}Object(c.a)(gc,"FileNameDialog",
dd.a,[1513]);class Dc{constructor(Z,Ka,zb){this.ya=Z;this.Ayb=Ka;this.Zlc=zb}create(Z){return new gc(this.ya,this.Ayb,this.Zlc,Z)}}Object(c.a)(Dc,"FileNameDialogFactory",null,[1494]);class Ua extends va.a{constructor(Z){super();this.ttk=Ka=>{1===Ka?(f.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ya.Cb(w.a.WVc,2)):f.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};this.gf=1;this.Fg(1,Object(ta.a)("RetryButtonLabel"));this.Fg(0,Object(ta.a)("DialogClose"));
this.ya=Z}PB(Z){f.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",Z);this.ZF(Z,Object(ta.a)("DefaultDialogTitle"),Object(ta.a)("ErrorSavingToOneDrive"),this.ttk)}}Object(c.a)(Ua,"RetryDialog",va.a,[1495]);class Nb extends Ab{constructor(Z,Ka,zb,dc){super(Z,Ka,zb,dc);this.nkm=Ka}NUd(){return this.Ba.getBooleanAppSetting("SaveACopyBrsIsEnabled")}ttl(){return w.a.WVc}Kch(){wc.a.Zth(Object(e.a)(this,this.Q0l,"saveToCloudActionDispatcher"));wc.a.wBe([new ye.a(w.a.WVc,r.a.frame,0)],this.nkm.KCe())}mXl(){Ng.a.BI("CreateCopy_cf;CreateCopy_tf");
f.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(c.a)(Nb,"SaveACopyActor",Ab,[]);class hc extends kb{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de){super(Ka,zb,dc,Jc,jd,Ed,de);this.Ehm=Z}vw(Z){Z&&Z.data&&Z.data.folders?(f.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.Ehm.create(this.Hp).P9a(Z.data.folders[0].id,Z.data.folders[0].name,Z.data.folders[0].urls.viewInBrowser)):(f.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),
this.QE())}SF(Z){Z&&Z.error&&"user_canceled"===Z.error.code&&f.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.SF(Z)}QE(){f.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.QE()}}Object(c.a)(hc,"SaveACopyManager",kb,[]);class Qc extends vd{constructor(Z,Ka,zb,dc,Jc,jd){super(Ka,zb,dc,Jc,jd);this.ya=Z}Poj(){return!!this.Hp&&!!this.Hp.SaveEntryPoint&&"VersionHistory"===this.Hp.SaveEntryPoint.toString()}CUa(){f.ULS.sendTraceTag(7205459,
216,50,"Display Error for Save A Copy.");this.Poj()&&this.ya.Qa(w.a.$qk,2,{["FailureReason"]:"Unknown"});super.CUa()}$ie(){f.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Poj()&&this.ya.Cb(w.a.Tuh,2);super.$ie()}Zie(Z){f.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url for Save A Copy.");this.Poj()&&this.ya.Cb(w.a.Tuh,2);super.Zie(Z)}X9a(){this.Hp&&"true"===this.Hp.SkipSaveToHost?super.X9a():32!==this.ya.Cb(w.a.bed,1)?(f.ULS.sendTraceTag(8741711,216,
15,"The save file change is not supported, this operation may result in data loss"),super.X9a()):this.ya.Qa(w.a.bed,2,[()=>{f.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");vd.prototype.X9a.call(this)},()=>{f.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.CUa()}])}}Object(c.a)(Qc,"SaveACopyUploadToCloudManager",vd,[]);class $c{constructor(){this.Ha=null;this.su=()=>{h.AFrameworkApplication.ga.getBooleanAppSetting("SaveACopyBrsIsEnabled")&&
this.Ha.resolve("Common.App.SaveACopy.SaveACopyActor").Hb()}}get name(){return"Common.App.SaveACopy"}init(){h.AFrameworkApplication.ga.fg(this.su)}dispose(){}lc(Z){this.Ha=Z;this.Ha.register(Qc,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").na(()=>new Qc(h.AFrameworkApplication.vb,Z.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Mh.a).create(),()=>new Ua(h.AFrameworkApplication.vb),h.AFrameworkApplication.Ea,h.AFrameworkApplication.Ea.Rba)).ma();this.Ha.register(Dc,
"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").na(()=>new Dc(h.AFrameworkApplication.vb,h.AFrameworkApplication.Ea.Kb,Z.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ma();this.Ha.register(Nb,"Common.App.SaveACopy.SaveACopyActor").na(()=>new Nb(Z.resolve("Common.App.SaveACopy.SaveACopyManager"),Z.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),h.AFrameworkApplication.ga,h.AFrameworkApplication.Ea.Rba)).ma();
this.Ha.register(hc,"Common.App.SaveACopy.SaveACopyManager").na(()=>new hc(Z.resolve("Common.App.SaveACopy.FileNameDialogFactory"),Z.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Qh.a.instance,Z.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),h.AFrameworkApplication.ga,h.AFrameworkApplication.ztc,()=>new Ua(h.AFrameworkApplication.vb),Z.resolve("Common.App.SaveToCloudStorage.ODCXStackOperationManager"))).ma()}static main(){b.a.instance.Fc(new $c)}}Object(c.a)($c,"PackageManager",
null,[3,4]);var Hd=a(508);class $d{constructor(Z){this.XJl=null;this.DTm=()=>{f.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")};this.FTm=Ka=>{f.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Ka=Eb.a(Ka.data.responseData).state+"";Hd.a.instance.setItem("AccountLinkedStatusCache",Ka)};f.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.Rdg=h.AFrameworkApplication.ga.La("PhoneLinkServiceEndpoint");
(this.jta=Z)||f.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.Rdg&&this.Rdg.length||f.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}FIm(Z){Z&&(this.Rdg="https://dcg-df.microsoft.com/",f.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.EIm()}EIm(){f.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.XJl)f.ULS.sendTraceTag(527574722,
306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.XJl=new Date;var Z=new Date;this.jta.qN("BayBridge",this.Rdg).then(Ka=>{const zb=+new Date-+Z;Ka.IsSuccess?(f.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",zb),this.CIm(Ka.Token,this.$Lm())):f.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
zb,Ka.ErrorCode,Ka.ErrorMessage)}).catch(Ka=>{f.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",Ka,+new Date-+Z)})}}CIm(Z,Ka){const zb={};zb.Authorization="Bearer "+Z;zb["Authorization-Type"]="AAD";zb.Accept="application/json";zb["DCG-SessionId"]=h.AFrameworkApplication.userSessionId;h.AFrameworkApplication.ye.rk(Ka,1,null,zb,!1,2,this.FTm,this.DTm,null,void 0,void 0,void 0,void 0,"39");vb.a("FetchAccountLinkedStatus")}AMm(){const Z=
Hd.a.instance.getItem("AccountLinkedStatusCache");return Z&&Z.length?"true"===Z.toLowerCase()?!0:!1:!1}$Lm(){return this.Rdg+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}}Object(c.a)($d,"PhoneLinkManager",null,[1352]);class ue{constructor(){this.Ha=null}get name(){return"Common.App.PhoneLink"}lc(Z){this.Ha=Z;this.Ha.register(1352,"Common.App.PhoneLink.IPhoneLinkManager").ma().na(()=>new $d(this.Ha.resolve("Common.App.OAuth.IOAuthManager")))}init(){h.AFrameworkApplication.ga.fg(()=>{this.LRb()})}LRb(){this.Ha.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){b.a.instance.Fc(new ue)}}
Object(c.a)(ue,"PhoneLinkPackage",null,[3,4]);var Fe;(function(Z){Z[Z.O4n=0]="myFiles";Z[Z.recent=1]="recent";Z[Z.I2n=2]="currentFolder";Z[Z.g7n=3]="yourPhone"})(Fe||(Fe={}));Object(c.b)("SharedFilePickerLandingLocation",Fe);class cf{constructor(Z){this.BAb=this.tdc=null;this._initialized=!1;this.U8i=Z}yzi(Z){this._initialized||(Z.Xt(sf.a.gXl),Z.jE(sf.a.gXl,Object(e.a)(this,this.zrn,"onReceivedPickerResponse")),this._initialized=!0)}CCf(Z){return this.BAb=new Promise((Ka,zb)=>{const dc={};dc[ne.a.JTl]=
Z;this.tdc=(Jc,jd)=>{""===jd?(f.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Ka(Jc)):("Canceled"===jd?f.ULS.sendTraceTag(572548164,306,50,jd):f.ULS.sendTraceTag(556901065,306,10,jd),zb(jd))};this.U8i.execute(Jc=>{this.yzi(Jc);Jc.sendMessage(sf.a.vtn,dc)})})}zrn(Z){this.tdc(Z.Values[ne.a.KJn],void 0===Z.Values[ne.a.B6j]||null===Z.Values[ne.a.B6j]?"":Z.Values[ne.a.B6j])}mpj(){return h.AFrameworkApplication.ga.getBooleanAppSetting("UiHostCommonFilePicker")}Sdh(Z,Ka,zb,dc,Jc,
jd,Ed,de,Ne){Ne=void 0===Ne?null:Ne;const Re={};Re[ne.a.CJn]=Z;Re[ne.a.titleText]=Ka;Re[ne.a.Frm]=zb;Re[ne.a.Grm]=dc;Re[ne.a.Hrm]=Jc;Re[ne.a.bFm]=!0;Re[ne.a.RIm]=jd;Re[ne.a.ivn]=Ed;Re[ne.a.hvn]=Fe[de];cc.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Re[ne.a.LTl]="Dark");Ne&&(null!=Ne.Xye&&(Re[ne.a.Xye]=Ne.Xye),null!=Ne.aEe&&(Re[ne.a.aEe]=Ne.aEe),Ne.N$i&&(Re[ne.a.N$i]=Ne.N$i));return Re}}Object(c.a)(cf,"SharedFilePickerManager",null,[1379]);class Ee{constructor(){this.Ha=null}get name(){return"Common.App.SharedFilePicker"}lc(Z){this.Ha=
Z;Z.register(cf,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ma().na(()=>new cf(Z.Na("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.ga.fg(()=>{this.LRb()})}LRb(){this.Ha.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){b.a.instance.Fc(new Ee)}}Object(c.a)(Ee,"SharedFilePickerPackage",null,[3,4]);class xe{constructor(Z,Ka){this.IUn=9E5;this.LUn=1E4;this.eHl=this.mHe=null;this.SBj=0;this.fpf=
Date.now;this.zUm=Z;this.Lyh=void 0===Ka?3E4:Ka;this.Mgh()}lxl(Z){Z=void 0===Z?!0:Z;const Ka=this.fpf();if(Ka<this.SBj+this.IUn)return Ka>this.SBj+this.LUn&&this.Mgh(),this.eHl;Z&&this.Mgh();return null}getToken(Z){return(Z=this.lxl(void 0===Z?!0:Z))?Promise.resolve(Z):this.Mgh()}Mgh(){return this.mHe=this.mHe||new Promise(Z=>{this.zUm().then(Ka=>{this.mHe=null;""!==Ka&&Ka&&(this.eHl=Ka,this.SBj=this.fpf(),Z(Ka));Z(null)}).catch(()=>{this.mHe=null;Z(null)});window.setTimeout(()=>{this.mHe=null;Z(null)},
this.Lyh)})}}Object(c.a)(xe,"OAuthCacheManager",null,[]);class cg{constructor(){this.jta=null;this.v6k={};this.tOe=new Oi.a(Ti.a.Wn())}getToken(Z,Ka){if(this.tOe.Ob(Ka))return this.tOe.ha(Ka).getToken();const zb=new xe(()=>this.mxl(Z,Ka));this.tOe.K(Ka,zb);return zb.getToken()}yUm(Z,Ka){if(this.tOe.Ob(Ka))return this.tOe.ha(Ka).lxl();const zb=new xe(()=>this.mxl(Z,Ka));this.tOe.K(Ka,zb);return null}mxl(Z,Ka){if(!this.jta)try{this.jta=l.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(zb){f.ULS.sendTraceTag(51689675,
1300,10,"Unable to resolve IOAuthManager: "+zb)}return this.jta?new Promise(zb=>{const dc=Date.now();this.jta.qN(Z,Ka).then(Jc=>{const jd=Jc.Token;!Jc.IsSuccess||this.g7m(jd)?(this.vMe("GetTokenInternalImplicitJS",!1,Date.now()-dc,Z,Jc.ErrorCode,Jc.ErrorMessage,Ka),zb(null)):(this.vMe("GetTokenInternalImplicitJS",!0,Date.now()-dc,Z,Jc.ErrorCode,Jc.ErrorMessage,Ka),zb(jd))}).catch(Jc=>{Jc=Jc?Eb.c(Jc):"";this.vMe("GetTokenInternalImplicitJS",!1,Date.now()-dc,Z,"Caught Exception",Jc,Ka);zb(null)})}):
new Promise(zb=>{this.vMe("GetTokenInternalImplicitJS",!1,0,Z,"Null OAuthManager","OAuthManager not set");zb(null)})}vMe(Z,Ka,zb,dc,Jc,jd,Ed){Jc=void 0===Jc?"":Jc;jd=void 0===jd?"":jd;Ed=void 0===Ed?"":Ed;var de="Search"===dc;const Ne=[];Z=Vg.a.iEa(de?"Event":"EventName",Z,2);dc=Vg.a.iEa("AppName",dc,2);Array.add(Ne,Z);Array.add(Ne,dc);de&&(dc=Vg.a.iEa("LatencyType","FetchToken",2),Array.add(Ne,dc));Jc&&""!==Jc&&(Jc=Vg.a.iEa("ErrorCode",Jc,2),Array.add(Ne,Jc));jd&&""!==jd&&(jd=Vg.a.iEa("ErrorMessage",
jd,2),Array.add(Ne,jd));Ed&&""!==Ed&&(jd=!(Ed in this.v6k),this.v6k[Ed]=jd,jd=Vg.a.iEa("WarmUpCall",jd.toString(),1),Array.add(Ne,jd),Ed=Vg.a.iEa("Service",this.bKd(Ed),2),Array.add(Ne,Ed));de=de?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";Ka=Object.assign(new uh.a,{name:de,samplingPolicy:2,dataFields:Ne,succeeded:Ka,durationMs:zb});m.a.sendActivityEvent(Ka)}bKd(Z){return Z===h.AFrameworkApplication.zZf?"Loki":Z===h.AFrameworkApplication.tXg?"Substrate":h.AFrameworkApplication.ga&&
Z===h.AFrameworkApplication.ga.La("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}g7m(Z){return!Z||!Z.length}}Object(c.a)(cg,"SearchOAuthManager",null,[1354]);class Gg{constructor(){this.Ha=null}get name(){return"Common.App.SearchOAuthManager"}lc(Z){this.Ha=Z;this.Ha.register(1354,"Common.App.SearchCommon.ISearchOAuthManager").ma().na(()=>new cg)}init(){}dispose(){}static main(){b.a.instance.Fc(new Gg)}}Object(c.a)(Gg,"SearchOAuthPackage",null,[3,4]);var Of;(function(Z){Z[Z.GKm=0]="generalException";
Z[Z.invalidArgument=1]="invalidArgument";Z[Z.cnn=2]="notAllowed";Z[Z.Xrm=3]="apiNotAvailable";Z[Z.QWn=4]="unresolvedPendingRequest";Z[Z.timeout=5]="timeout";Z[Z.yXh=6]="adalTimeout";Z[Z.zZn=7]="userNotSignedIn";Z[Z.Vzh=8]="userAborted";Z[Z.t5l=9]="silentSignInFailed";Z[Z.Xjh=10]="invalidResourceUrl";Z[Z.jBl=11]="invalidGrant";Z[Z.cll=12]="connectionLost";Z[Z.igi=13]="clientError";Z[Z.Kqa=14]="serverError"})(Of||(Of={}));Object(c.b)("ErrorCodes",Of);class ch{}Object(c.a)(ch,"HostApplicationType",null,
[]);class vg{constructor(Z,Ka){this.requestCallback=this.requestParameters=null;this.requestParameters=Z;this.requestCallback=Ka}}Object(c.a)(vg,"OutstandingRequest",null,[]);class jg{}jg.Xmn="AADSTS50058";jg.Xjh="AADSTS50001";jg.Vmn="AADSTS65001";jg.dnn="AADSTS70011";jg.Vzh="13002";jg.Iwn="Popup Window is null";jg.Hwn="Popup Window closed";jg.yXh="Token renewal operation failed due to timeout";jg.MUn="tokenRevoked";Object(c.a)(jg,"WopiHostErrorType",null,[]);var sh=a(380),Zh=a(495),ae=a(1517);class Wi{constructor(){this.authority=
this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(c.a)(Wi,"WopiIdentityInfo",null,[1405]);class ci{constructor(Z,Ka,zb){this.expiration=this.authority=this.accessToken=null;this.accessToken=Z;this.authority=Ka;this.expiration=zb}}Object(c.a)(ci,"WopiIdentityToken",null,[1404]);class Fi{constructor(Z){this._initialized=!1;this.yrn=Ka=>{let zb=null;try{const Jc=Ka.Values[ne.a.OLk],jd=Ka.Values[ne.a.QRn],Ed=Ka.Values[ne.a.h6l],de=Ka.Values[ne.a.YRn];let Ne=null,Re=
null;const Cf=this.XIe[Jc];if("undefined"!==typeof Cf&&Cf){var dc=[];Array.add(dc,Object.assign(new y.a,{name:ne.a.NLk,string:Cf.requestParameters.correlationId}));m.a.sendTelemetryEvent(Object.assign(new z.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:dc}));zb=Cf.requestCallback;delete this.XIe[Jc];"undefined"!==typeof jd&&jd&&jd.length?Re=new ci(jd,Ed,de):Ne=Of[this.Afn(Ka)];dc="getAccessToken_"+Jc;dc in this.Zxh&&(this.Zxh[dc].stop(),delete this.Zxh[dc]);
zb(Re,Ne)}else f.ULS.sendTraceTag(37856066,344,10,Eb.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Jc}))}catch(Jc){Ka=Ka.Values[ne.a.OLk],Ka in this.XIe&&delete this.XIe[Ka],this.Ylh(),f.ULS.sendTraceTag(37856067,344,10,Eb.c({["error"]:Jc.message,["stack"]:Jc.stack})),zb&&zb(null,"generalException")}};this.XIe={};this.Zxh={};this.sFa=h.AFrameworkApplication.Ea.Rba;this.U8i=Z}yzi(Z){this._initialized||(Z.Xt(sf.a.postAuthToken),Z.jE(sf.a.postAuthToken,this.yrn),this._initialized=
!0)}getAccessToken(Z,Ka,zb){zb=void 0===zb?null:zb;this.l$c(Z,Ka);return new Promise((dc,Jc)=>{if(this.dfj(Ka))if(Ka in this.XIe)Jc("unresolvedPendingRequest");else{var jd=window.setTimeout(()=>{f.ULS.sendTraceTag(37856032,344,10,Eb.c({["error"]:"Request timeout.",["callerId"]:Ka}));Jc("timeout")},12E4);this.lIi(Z,Ka,zb,(Ed,de)=>{window.clearTimeout(jd);Ed?dc(Ed):(f.ULS.sendTraceTag(37856033,369,15,Eb.c({["error"]:Of[de]})),Jc(de))})}else f.ULS.sendTraceTag(37856034,344,10,Eb.c({["error"]:"Caller is not allowed."})),
Jc("notAllowed")})}getPrimaryIdentityInfo(Z){return new Promise((Ka,zb)=>{this.dfj(Z)?this.QRm((dc,Jc)=>{dc?Ka(dc):(f.ULS.sendTraceTag(37856064,369,10,Eb.c({["error"]:Jc.toString()})),zb(Jc))}):(f.ULS.sendTraceTag(37856065,344,10,Eb.c({["error"]:"Caller is not allowed."})),zb("notAllowed"))})}getAuthContext(Z){return new Promise((Ka,zb)=>{const dc=this.getAuthContextSync(Z);dc?Ka(dc):zb("notAllowed")})}getAuthContextSync(Z){if(this.dfj(Z)){const Ka=new ae.a;Ka.upn=h.AFrameworkApplication.ga.La("UserPrincipalName");
Ka.userId=h.AFrameworkApplication.ga.La("LoggableUserId");Ka.authority=h.AFrameworkApplication.ga.La("HostAuthAuthority");Ka.tenantId=h.AFrameworkApplication.ga.La("TenantId");Ka.isAnonymous=h.AFrameworkApplication.ga.getBooleanAppSetting("IsAnonymousUser");Ka.supportsAuthToken=this.r0m(Z);Z=h.AFrameworkApplication.ga.La("HostAuthType");Ka.authorityType="aad"===Z.toLowerCase()?2:"msa"===Z.toLowerCase()?1:0;return Ka}f.ULS.sendTraceTag(40751647,344,10,Eb.c({["error"]:"Caller is not allowed."}));return null}r0m(Z){const Ka=
sh.a.ykb;return za.a.$$a?Ka&&sh.a.kPk?Array.contains(sh.a.kPk,Z.toLowerCase()):!1:Ka}lIi(Z,Ka,zb,dc){var Jc=[];Array.add(Jc,Object.assign(new y.a,{name:"CallerId",string:Ka}));Array.add(Jc,Object.assign(new y.a,{name:ne.a.NLk,string:Z.correlationId}));m.a.sendTelemetryEvent(Object.assign(new z.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Jc}));Jc=Zh.a.create().toString();const jd="getAccessToken_"+Jc,Ed=this.sFa.wl("ComponentAttach",jd);this.Zxh[jd]=Ed;const de=
{};de[ne.a.OLk]=Jc;de[ne.a.VRn]=Z.resource;de[ne.a.WRn]=Z.scope;de[ne.a.h6l]=h.AFrameworkApplication.ga.La("HostAuthType");de[ne.a.ZRn]=h.AFrameworkApplication.ga.La("UserPrincipalName");de[ne.a.XRn]=Z.silentLogin;de[ne.a.SRn]=Z.options;de[ne.a.NLk]=Z.correlationId;de[ne.a.TRn]=Ka;zb&&(de[ne.a.addinName]=zb.AddinName,de[ne.a.RRn]=zb.AddinTrustId);this.U8i.execute(Ne=>{this.yzi(Ne);Ne.sendMessage(sf.a.getAuthToken,de)});this.XIe[Jc]=new vg(Z,dc)}QRm(Z){const Ka=h.AFrameworkApplication.ga.La("UserName"),
zb=h.AFrameworkApplication.ga.La("UserPrincipalName"),dc=h.AFrameworkApplication.ga.La("LoggableUserIdSpace"),Jc=new Wi;Jc.email=zb;Jc.displayName=Ka;switch(dc){case "OrgIdPuid":Jc.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Jc.authority="MicrosoftAccount";break;default:Jc.authority=dc}Z(Jc,null)}dfj(Z){var Ka=h.AFrameworkApplication.rVm();Z=Z.toLowerCase();for(const zb of Ka)if(Z===zb.toLowerCase())return!0;Ka=sh.a.dze;for(const zb in Ka)if(Z===Ka[zb].toLowerCase())return!0;
return!1}Afn(Z){Z=Z.Values[ne.a.URn];this.Ylh();f.ULS.sendTraceTag(39068821,344,50,Eb.c({["error"]:Z}));return Z?-1<Z.indexOf(jg.Xmn)?9:-1<Z.indexOf(jg.Iwn)||-1<Z.indexOf(jg.Hwn)?12:-1<Z.indexOf(jg.Xjh)?10:-1<Z.indexOf(jg.Vzh)?8:-1<Z.indexOf(jg.dnn)||-1<Z.indexOf(jg.Vmn)||Z===jg.MUn?11:-1<Z.indexOf(jg.yXh)?6:0:13}l$c(Z,Ka){Z=this.IDn(Z.resource);f.ULS.sendTraceTag(39921882,344,50,Eb.c({["callerId"]:Ka,["resource"]:Z}))}Ylh(){f.ULS.sendTraceTag(39068822,344,50,Eb.c({["userAgent"]:window.navigator.userAgent}))}IDn(Z){return(Z?
Z:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(c.a)(Fi,"WopiIdentityManager",null,[1378]);class hh{constructor(){this.Ha=null;this.su=()=>{try{this.Ha.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(Z){f.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+Z)}}}get name(){return"Common.App.WopiIdentity"}lc(Z){this.Ha=Z;Z.register(Fi,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ma().na(()=>
new Fi(Z.Na("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.ga&&h.AFrameworkApplication.ga.fg(this.su)}dispose(){}static main(){b.a.instance.Fc(new hh)}}Object(c.a)(hh,"WopiIdentityPackage",null,[3,4]);class wf extends dd.a{constructor(Z,Ka){super(!1,!1,!0);this.Vke=(zb,dc)=>{if(1===zb){zb=dc.showRibbonChoice;if(this.hbl!==dc.ribbonLayoutChoice)appChrome.onRibbonModeToggle();this.Vbl!==zb&&("AlwaysShow"===zb?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};
this.hbl=Z;this.Vbl=Ka}start(){this.Dq("",this.Vke,{["id"]:"RibbonSettingsDialog",["bodyControls"]:{["ribbonLayoutChoice"]:this.hbl,["showRibbonChoice"]:this.Vbl}})}}Object(c.a)(wf,"RibbonSettingsDialog",dd.a,[]);class qg{constructor(Z){this.ya=Z}Hb(){this.ya.za(w.a.zQn,r.a.frame,this.AQn)}AQn(){let Z="SingleLineRibbon";"Multiline"===appChrome.selectors.getRibbonMode()&&(Z="ClassicRibbon");const Ka=appChrome.selectors.getShyState().isActive?"AutomaticallyHide":"AlwaysShow";(new wf(Z,Ka)).start();
return 32}}Object(c.a)(qg,"RibbonSettingsDialogActor",null,[1377]);class Lh{constructor(){this.Ha=null}get name(){return"Common.App.RibbonSettings"}lc(Z){this.Ha=Z;this.Ha.register(qg,"Common.App.RibbonSettings.RibbonSettingsDialogActor").as("Common.App.RibbonSettings.IRibbonSettingsDialogActor").na(()=>new qg(h.AFrameworkApplication.vb)).ma()}init(){const Z=this.Ha.yb("Common.App.RibbonSettings.IRibbonSettingsDialogActor");Z?Z.Hb():A.c(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){b.a.instance.Fc(new Lh)}}
Object(c.a)(Lh,"RibbonSettingsPackage",null,[3,4]);var dh=a(792);class wg extends dh.a{constructor(Z,Ka){super(Z,Rc.a.getOrigin(Ka))}Jdc(Z,Ka){this.isEnabled()&&this.czb(this.acb)&&(this.Xt(Z),this.jE(Z,Ka))}}Object(c.a)(wg,"InsertMediaCrossDocumentMessenger",dh.a,[1462,55,24]);class bg{getInstance(Z,Ka){return new wg(Z,Ka)}}Object(c.a)(bg,"InsertMediaCrossDocumentMessengerFactory",null,[1432]);class vh{constructor(Z,Ka,zb){this.correlationId=null;this.orb=0;this.Mzc=null;this.Aeh=0;this.qim=Z;this.Z7e=
[];this.oim=Ka;this.qcl=zb.split(";")}bpe(Z,Ka){Array.clear(this.Z7e);Z=this.qim.value;Z.$8l(Ka.FDe);Z.czb(this.oim);Z.Xt(Ka.FDe);Z.jE(Ka.FDe,zb=>{this.L_j(zb,Ka)});f.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");Z.sendMessage(Ka.enl,{["FileExtensionFilterList"]:this.qcl})}Gpm(Z){Array.contains(this.Z7e,Z)||Array.add(this.Z7e,Z)}L_j(Z,Ka){f.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");Z=Ka.cTl(Z);
const zb=[];for(let dc=0;dc<Z.length;dc++){const Jc=Z[dc];Ka.Dkh(Jc,this.qcl)?Array.add(zb,Jc):this.Gpm(Ka.owl(Jc))}zb&&zb.length?Ka.fbc(zb):f.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.Z7e.length&&(Ka=this.Z7e.join(", "),f.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",Ka),this.NQn(Ka))}NQn(Z){const Ka=new va.a;Ka.gf=0;Ka.m7(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,
Z),null)}dispose(){}}Object(c.a)(vh,"InsertMediaFromHostManager",null,[1391,24]);class fi{constructor(Z){this.Aim=Z}getInstance(){return this.Aim}}Object(c.a)(fi,"InsertMediaFromHostManagerFactory",null,[1504,1505]);class Jg{constructor(){this.jXe=document.createElement("iframe");this.jXe.src="about:blank";this.jXe.style.visibility="hidden";this.jXe.style.position="absolute";this.jXe.style.zIndex="-100"}get kEd(){return this.jXe}}Object(c.a)(Jg,"InsertMediaFromHostOneDriveHostFrame",null,[1503]);
class Dg extends dh.a{constructor(Z,Ka){super(Z,"*"===Ka?Ka:Rc.a.getOrigin(Ka));this.EXh(sf.a.tOf);this.EXh(sf.a.bdj)}reportDocumentLoadedTime(){}}Object(c.a)(Dg,"InsertMediaFromOneDriveCrossDocumentMessenger",dh.a,[54,55,24]);var fj=a(180),kj=a(1222);class ng{Abh(Z){switch(Z){case 1:Z=8;break;case 4:Z=3;break;case 2:Z=0;break;default:Z=0}return Z}Ium(Z,Ka){return String.format(Ka,this.Abh(Z))}Yhl(Z,Ka,zb,dc,Jc,jd,Ed){Z=this.Abh(Z);const de=fj.a.Ne(h.AFrameworkApplication.lcid).name,Ne=h.AFrameworkApplication.buildVersion;
h.AFrameworkApplication.vZf("ShIns226;ShIns226cf");return String.format(Ka,h.AFrameworkApplication.lcid,de,Ne,Jc,Z,jd,zb,dc,Ed)}Kum(Z,Ka){Z=this.Abh(Z);const zb=h.AFrameworkApplication.buildVersion,dc=0<zb.indexOf(".")?zb.substring(0,zb.indexOf(".")):"16";return String.format(Ka,h.AFrameworkApplication.lcid,h.AFrameworkApplication.lcid,h.AFrameworkApplication.lcid,Z,dc,zb,"Video",0,0)}Jum(Z,Ka,zb,dc,Jc,jd){Z=String.format(Ka,h.AFrameworkApplication.lcid,h.AFrameworkApplication.uiCulture,h.AFrameworkApplication.buildVersion,
zb,this.Abh(Z),dc);Z+="&flipgrid=1";Jc&&(Jc=new ic.QueryStringBuilder(Z),Jc.Zi("stream2","1"),Jc.Zi("enablegetcustomheader","1"),Z=Jc.toString());"defaultModal"!=jd&&(Jc=new ic.QueryStringBuilder(Z),Jc.Zi("modalvariation",jd),Z=Jc.toString());return Z}gTl(Z){if(!Z||!Z.Values)return null;Z=Z.Values;if(!Z)return null;let Ka="";"sourceProvider"in Z&&(Ka=Z.sourceProvider||"");return Object.assign(new kj.a,{Action:Z.action||"",Caption:Z.caption||"",ContentType:Z.contentType||"",Type:Z.extension||"",PageUrl:Z.pageUrl||
"",OriginalUrl:Z.sourceUrl||"",ContentProvider:Ka,ThumbnailUrl:Z.thumbnailUrl||"",LicenseUrl:Z.licenseUrl||"",LicenseDisplayName:Z.licenseDisplayName||"",Height:Z.height||0,Width:Z.width||0,SvgContent:Z.svgContent||"",Description:Z.description||"",ProviderName:Z.providerName||"",StartInsertTime:Z.startInsertTime||0})}qun(Z){const Ka=[];if(!Z||!Z.Values||!Z.Values.Items)return Ka;Z=Z.Values.Items;for(let dc=0;dc<Z.length;dc++){var zb=Z[dc];zb&&(zb=Object.assign(new kj.a,{Type:zb.Extension||"",OriginalUrl:zb.SourceUrl||
"",Caption:zb.caption,Description:zb.description||"",Height:zb.Height||0,Width:zb.Width||0}),Array.add(Ka,zb))}return Ka}Dkh(Z,Ka){if(!Z)return!1;for(let zb=0;zb<Ka.length;zb++)if(0<=Z.toLowerCase().indexOf(Ka[zb]))return!0;return!1}rAn(Z){let Ka="";if(Z)for(let zb=0;zb<Z.length;zb++){const dc=Z[zb];dc&&(Ka+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',dc.OriginalUrl,dc.Width,dc.Height))}return Ka}bVm(Z){return(Z=ng.NIn.exec(Z))&&2<Z.length?Z[2].trim():""}aom(Z,Ka){Z.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",
!1)?Ka.Zi("dallecore","1"):Z.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&Ka.Zi("dalle","1")}}ng.NIn=RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im");Object(c.a)(ng,"InsertMediaHelper",null,[1431]);var Oh=a(254);class Tf{constructor(Z){this.NZe=Oh.a.insertHyperlink;this.ya=Z}get LX(){return this.NZe}set LX(Z){this.NZe=Z}fbc(Z){try{f.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",Z.length);
for(let Ka=0;Ka<Z.length;Ka++)this.ya.Qa(this.LX,2,Z[Ka]);f.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",Z.length)}catch(Ka){f.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",Ka.toString())}}}Object(c.a)(Tf,"InsertOneDriveFileHandler",null,[1441]);class Kh extends Tf{constructor(Z){super(Z)}get enl(){return sf.a.bdj}get FDe(){return sf.a.F2m}cTl(Z){return Z&&Z.Values&&"Items"in Z.Values?
Z.Values.Items:null}owl(){A.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}Dkh(){return!0}dWl(Z,Ka,zb){Z=zb(Z);Z.length&&(zb={},zb.Items=Z,Ka.sendMessage(this.FDe,zb))}fTl(Z){const Ka=[];for(let zb=0;zb<Z.data.value.length;zb++){const dc=Z.data.value[zb];if(dc){const Jc={};Jc.DisplayText=dc.name;Jc.Url=dc.urls.download;Jc.sourceUrl=dc.urls.download;Jc.caption=dc.name;Array.add(Ka,Jc)}}return Ka}}Object(c.a)(Kh,"InsertOneDriveFileHelper",
Tf,[1440,1441]);class wi extends dd.a{constructor(){super()}SIk(){this.BVe="FilePickerDialog";this.Bl="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this.uk="PickerDialog-Livebooks";this.showDialog("",null)}xSi(){return document.getElementById("OpenFilePickerDiv")}n7(){}kub(){}}Object(c.a)(wi,"PickerDialog",dd.a,[1527]);class Uf{constructor(Z,Ka,zb){this.XE=this.sHb=null;this.jkd=Z;this.Jkm=zb;this.QFb=new fe.a(()=>new Ae.a(Ka.value,Object(e.a)(this,this.vwc,"getMoreInfoEventReceived")))}get VIe(){this.sHb||
(this.QFb.value.Ci("InsertFromOneDrive",!0),this.XE&&this.XE.bda&&this.XE.bda.length&&(this.sHb=this.RRi(this.XE.bda)));return this.sHb}RRi(Z){Z=Z.toLowerCase();Z.endsWith("/")||(Z+="/");const Ka=Z.indexOf("/documents/");return-1!==Ka?Z.substring(0,Ka+1)+"_layouts/15/onedrive.aspx":""}vwc(Z){this.XE||3!==Z.state||(this.XE=Z)}start(Z){if(!this.VIe)if(h.AFrameworkApplication.breadcrumbFolderUrl&&h.AFrameworkApplication.breadcrumbFolderUrl.length)this.sHb=h.AFrameworkApplication.breadcrumbFolderUrl;
else{f.ULS.sendTraceTag(26071185,352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.XE);return}const Ka=new wi;Ka.SIk();const zb=Ka.xSi();zb?this.jkd.start((dc,Jc)=>{Ka.hide();this.processResponse(dc,Jc,Z)},()=>{this.VYj(Ka)},zb,this.sHb):f.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")}VYj(Z){Z.hide();f.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")}processResponse(Z,
Ka,zb){f.ULS.sendTraceTag(26071188,352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",Z);Z&&Ka&&Ka.data&&Ka.data.value&&0<Ka.data.value.length?(Z=this.Jkm.getInstance(window.frames[0].parent,window.document.URL),zb.dWl(Ka,Z,Object(e.a)(zb,zb.fTl,"parseOneDriveV7Response"))):f.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}}Object(c.a)(Uf,"OneDriveFilePickerHelperV7",null,[1501,1502]);class Ci{constructor(Z,
Ka,zb,dc){this.ia=Ka;this.la=Z;this.DP=this.la.m0a;this.Xy=zb;this.nGl=dc}get ADa(){return this.nGl?this.nGl.instance:null}Hb(){this.ia.sa(w.a.CFe,Na.a.application,Object(e.a)(this,this.Tec,"triggerCommandforAddinCommands"),4);this.ia.sa(w.a.y4c,Na.a.application,Object(e.a)(this,this.Tec,"triggerCommandforAddinCommands"),4);this.ia.sa(w.a.Uth,Na.a.application,Object(e.a)(this,this.Tec,"triggerCommandforAddinCommands"),4);this.ia.sa(w.a.Zcd,Na.a.application,Object(e.a)(this,this.Zcd,"queryAddInCommandsLoadStatus"),
96);this.ia.za(w.a.gxh,Na.a.application,Object(e.a)(this,this.Tec,"triggerCommandforAddinCommands"));this.ia.sa(w.a.tka,Na.a.application,Object(e.a)(this,this.Tec,"triggerCommandforAddinCommands"),64);this.ia.sa(w.a.$Le,Na.a.application,Object(e.a)(this,this.Tec,"triggerCommandforAddinCommands"),64);this.ia.za(w.a.eVg,Na.a.application,Object(e.a)(this,this.Tec,"triggerCommandforAddinCommands"));this.ia.sa(w.a.xMf,Na.a.application,Object(e.a)(this,this.Tec,"triggerCommandforAddinCommands"),64);this.ia.za(w.a.jNe,
Na.a.application,Object(e.a)(this,this.Tec,"triggerCommandforAddinCommands"));this.ia.za(w.a.dvf,Na.a.application,Object(e.a)(this,this.Tec,"triggerCommandforAddinCommands"))}ve(){}Tec(Z,Ka,zb,dc,Jc){if(!this.DP)return 16;if(1===zb)return Ka=Z===w.a.y4c&&(!this.ADa||!this.ADa.NVm(Jc)),Z=Z===w.a.y4c&&!!this.ADa&&this.ADa.jOn(Jc),Ka||Z?8:32;if(this.ADa)switch(Z){case w.a.CFe:this.ADa.Jlh(Jc);break;case w.a.y4c:this.ADa.DJf(Jc);break;case w.a.Zcd:this.ADa.kWl(Jc);break;case w.a.gxh:this.ADa.mPn();break;
case w.a.tka:this.ADa.wBn(Jc);break;case w.a.$Le:this.ADa.$Le(Jc);break;case w.a.Uth:this.ADa.KDn();break;case w.a.eVg:this.ADa.eVg(Jc);break;case w.a.xMf:this.ADa.xMf(Jc);break;case w.a.jNe:this.ADa.jNe(Jc);break;case w.a.dvf:this.ADa.dvf(Jc)}else this.Xy.eX(),this.Xy.dca(Z,Jc);return 32}Zcd(Z,Ka,zb,dc,Jc){if(!this.DP)return 16;this.ADa&&this.ADa.kWl(Jc);return 32}}Object(c.a)(Ci,"AddinCommandsActor",null,[743]);var Ai=a(1132),Ii=a(48),gj=a(295),Ag=a(369),Og=a(260),aj=a(1150),Qj=a(589);class sj{constructor(Z,
Ka,zb,dc){this.Bnm=Z;this.uAn=Ka;this.nj=zb;this.ga=dc;this.PTb=!1;this.wfd=0;this.pXm=(Jc,jd,Ed)=>{if(this.Bnm.Cd(this.uAn))return 16;if(1===Ed)return 32;!this.PTb&&this.wfd<sj.BUn&&3===h.AFrameworkApplication.vb.mode&&(this.pPn(),this.wfd++,this.PTb=!0,h.AFrameworkApplication.je.Qb(new H.a(5,1,this.ga.Jc("DelayInResettingIsToastShownInMs",sj.x_c),()=>{this.PTb=!1},0,"AutoSaveToastShownResetTask")));return 32}}pPn(){var Z=sj.wyb;const Ka=Math.floor(Math.random()*Z.length);Z=this.nj.notificationBar.pX(Z[Ka],
!1);D.a.J(508122977,806,50,"Autosave toast message is shown");Z.image=5;Z.SV=sj.zUn[Ka];this.nj.notificationBar.Vh(Z)}}sj.wyb=[ResourceStrings.l_FileIOCtrlSToastMessageString1,ResourceStrings.l_FileIOCtrlSToastMessageString2,ResourceStrings.l_FileIOCtrlSToastMessageString3,ResourceStrings.l_FileIOCtrlSToastMessageString4];sj.x_c=7E3;sj.zUn=["AnimFxEntranceScale_16","Snow_DOL_16","Wand1_16","AutoSave2_16"];sj.BUn=10;Object(c.a)(sj,"AutoSaveToast",null,[]);var mi=a(388);class Wj{constructor(Z,Ka,zb,
dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah,Ui,$g,oh,Jh,ti,Mj,Yl,em,Wh,tk,Zk,Fl,yk){this.t3f=null;this.FGl=!1;this.jad=null;this.rIl=rb.a("PartialDoc.SkipCutCopyCallout");this.NGl=null;if(!Fl)throw Error.argumentNull("calloutNotificationAdapter");this.ia=Z;this.hf=Ka;this.Fb=ti;this.Ma=zb;this.pa=dc;this.Wv=Jc;this.DY=jd;this.CLl=Ed;this.$Il=de;this.Ddn=Ne;this.Vmh=Re;this.Db=Cf;this.GGe=Jh.R8i;this.MF=yg;this.oc=Mj;this.xan=Jh.Msh;this.wdn=bh;this.gnh=Ah;this.nb=oh;this.HHe=!Jh.Rh;this.bLl=Yl;this.VLl=Wh;this.RJl=
tk;this.GE=Zk;this.LHl=!Jh.stb||ti.getBooleanAppSetting("DisablePrint");this.MHl=Ui;this.Hm=$g;this.Cbn=ti.La("DownloadPdfFromPodsUrl");this.m_printUrl=ti.La("PrintPdfFromPodsUrl");this.Bbn=ti.La("DownloadOdpFromPodsUrl");this.RHl=ti.La("DownloadImagesFromPodsUrl");this.Ldn=ti.getBooleanAppSetting("UseToastForDeferredBlobsEnabled");this.hen=Jh.VJe;Z=(h.AFrameworkApplication.fileName||"").toLowerCase();Jh.Rh&&Jh.hCl?(this.FGl=!0,this.t3f=ti.La("DownloadACopyPodsUrl")):!Jh.Rh&&Jh.nDl&&(Z.endsWith(".pptx")||
Z.endsWith(".ppsx"))?this.t3f=this.mfn():this.t3f=h.AFrameworkApplication.cac;this.eGj=em;this.Ecn=Jh.vTd;this.w8=l.a.instance.Na("Common.ISystemInitiatedFeedback");this.wcn=ti.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1);this.DI=Fl;this.NGl=new sj(Ka,Jc,Cf,ti);this.AWb=rb.a("EnableFileDownloadTelemetry")?new mi.a("DocumentOperationActor::FileDownload",sb.a.downloadACopy):void 0;this.qm=yk}Hb(){const Z=!!this.MHl&&!this.bLl();D.a.J(512500629,801,50,"Limited printing access: {0}, Message shown: {1}",
this.LHl,Z);this.LHl?Z&&this.Hm.T4l(this.MHl):(this.ia.za(sb.a.print,Na.a.application,Object(e.a)(this,this.VWm,"handlePrint")),this.ia.za(sb.a.downloadACopy,Na.a.application,Object(e.a)(this,this.downloadACopy,"downloadACopy")),this.ia.za(sb.a.I6c,Na.a.application,Object(e.a)(this,this.I6c,"downloadACopyAsPdf")),this.ia.za(sb.a.H6c,Na.a.application,Object(e.a)(this,this.H6c,"downloadACopyAsOdp")),this.ia.za(sb.a.J6c,Na.a.application,Object(e.a)(this,this.J6c,"downloadAsImages")),this.ia.za(sb.a.svh,
Na.a.application,Object(e.a)(this,this.svh,"saveSlidesAsImages")),this.ia.za(sb.a.Gcd,Na.a.application,Object(e.a)(this,this.Uzn,"pptoSaveACopy")),this.ia.za(sb.a.OJe,Na.a.application,Object(e.a)(this,this.Vzn,"pptoSaveAsToHost")),this.ia.za(sb.a.PJe,Na.a.application,Object(e.a)(this,this.Wzn,"pptoSaveToSharePoint")),this.ia.za(sb.a.LKe,Na.a.application,Object(e.a)(this,this.XWm,"handlePrintNotes")),this.ia.za(sb.a.KKe,Na.a.application,Object(e.a)(this,this.WWm,"handlePrintHandouts")));this.ia.za(sb.a.Hdf,
Na.a.application,this.NGl.pXm);this.ia.za(w.a.bed,Na.a.application,Object(e.a)(this,this.bed,"saveFileChange"));this.CLl&&this.ia.sa(sb.a.aLe,Na.a.application,Object(e.a)(this,this.aLe,"querySaveStatus"),96);this.eGj.execute(Object(e.a)(this,this.d1b,"onHostPostmessengerCreated"))}ve(){const Z=this.Ma.gd(ia.a.sil);Z.bindAction(ub.a.eb(qa.a.mfc,ub.a.Ke),sb.a.print);Z.bindAction(ub.a.eb(qa.a.G8a,ub.a.Ke),w.a.oe);Z.bindAction(ub.a.eb(qa.a.Y6g,ub.a.Ke),sb.a.Hdf);Z.bindAction(ub.a.eb(qa.a.zda,ub.a.Ke),
w.a.oe);Z.bindAction(ub.a.eb(qa.a.zda,ub.a.Ke|4),w.a.oe)}Vzn(Z,Ka,zb){return this.gvk(zb,w.a.pMe,"SaveAsToHost")}Uzn(Z,Ka,zb){return this.gvk(zb,w.a.WVc,"SaveACopy")}Wzn(Z,Ka,zb){return this.gvk(zb,w.a.dec,"SaveToSharePoint")}gvk(Z,Ka,zb){if(1===Z)return h.AFrameworkApplication.RA||h.AFrameworkApplication.boa?8:this.ia.Cb(Ka,1);if(this.GE.hasDeferredContent()&&(D.a.J(512500628,843,15,"{0} is triggered while document has deferred content",zb),!this.Ldn))return this.GE.jxh(zb,null,null),8;this.xye(zb);
return this.nb.G0a?(D.a.J(512500627,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",Ka),this.ia.Qa(sb.a.gDb,2,Ka)):this.ia.Cb(Ka,2)}downloadACopy(Z,Ka,zb,dc,Jc){var jd,Ed,de,Ne,Re,Cf,yg,bh,Ah;null===(jd=this.AWb)||void 0===jd?void 0:jd.Cf("ST");if(this.hf.Cd(this.Wv))return 16;if(1===zb)return!this.oc.hl()||h.AFrameworkApplication.boa?8:Wj.grl()?32:this.$ze();if(this.GE.hasDeferredContent())return D.a.J(512500626,843,15,"DownloadACopy is triggered while document has deferred content"),
this.rIl&&this.DI.drf(),null===(Ed=this.AWb)||void 0===Ed?void 0:Ed.Cf("DismissCalloutTime"),this.GE.jxh("DownloadACopy",new aj.a,()=>{this.Cfd(Jc)}),this.GE.IHa("DownloadACopyRequestedTime",Og.a.Lf(new Date)),8;this.pa.Ti();null===(de=this.AWb)||void 0===de?void 0:de.Cf("RemoveShapeTime");this.Ma.Wd();null===(Ne=this.AWb)||void 0===Ne?void 0:Ne.Cf("EnsureFocusTime");D.a.J(512500625,801,50,"PPT save and download a copy");this.nb.G0a?this.Cfd(Jc):(this.MF.show(!0,Z),null===(Re=this.AWb)||void 0===
Re?void 0:Re.Cf("SpinnerShowTime"),Z=null===(Cf=this.qm)||void 0===Cf?void 0:Cf.$7c(),!this.Fb.getBooleanAppSetting("EnableConditionalForceSaveInDownload")||Z&&Z.$N()&&(null===(yg=this.$Il)||void 0===yg?0:yg.UV(this.Wv))?(null===(bh=this.AWb)||void 0===bh?void 0:bh.Cf("ExecutedForceSave"),this.DY.QJa(!1,!0,this.HHe,()=>{this.Cfd(Jc)},Object(e.a)(this,this.fDb,"saveFailureCallback"))):this.Cfd(Jc),null===(Ah=this.AWb)||void 0===Ah?void 0:Ah.Cf("ForceSaveCallTime"));this.xye("DownloadACopy");return 32}Cfd(Z){var Ka,
zb,dc,Jc;null===(Ka=this.AWb)||void 0===Ka?void 0:Ka.Cf("TriggerStart");this.MF.hide();null===(zb=this.AWb)||void 0===zb?void 0:zb.Cf("SpinnerHideTime");Ka=Wj.grl()?h.AFrameworkApplication.cac:this.FGl?this.gze(this.t3f):this.t3f;Z&&Z.FileDownloadUrl&&(Ka=Z.FileDownloadUrl.toString());this.Y9m();this.RJl&&!this.RJl()&&this.VLl&&this.VLl("3555692408")?this.jad.sendMessage(sf.a.download,{}):this.xan?(this.wdn.oQn(Ka),this.GE.IHa("DownloadModalTime",Og.a.Lf(new Date))):this.Db.uM(!0,Ka,!0);null===(dc=
this.AWb)||void 0===dc?void 0:dc.Cf("ET");null===(Jc=this.AWb)||void 0===Jc?void 0:Jc.BM()}Y9m(){this.wcn&&this.w8&&this.w8.execute(Z=>{Z.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})}aLe(Z,Ka,zb,dc,Jc){Z="";this.CLl&&(Z=this.$Il.UV(this.Wv)?String.format(ResourceStrings.L_SavingStatus):this.GGe?String.format(CommonUIStrings.l_SavedToStatus,this.GGe):String.format(ResourceStrings.L_SavedStatus));Jc[he.a.Value]=Z;return 32}VWm(Z,Ka,zb){return this.sck(zb,
0,Z)}XWm(Z,Ka,zb){return this.sck(zb,8,Z)}WWm(Z,Ka,zb){return this.sck(zb,4,Z)}sck(Z,Ka,zb){if(this.hf.Cd(this.Wv))return 16;if(1===Z)return!this.oc.hl()||h.AFrameworkApplication.boa?8:this.$ze();if(this.bLl())return D.a.J(512500624,328,50,"Printing not allowed for IRM protected documents"),16;D.a.J(512500623,328,50,"PPT Editor print. PublishOption: {0}",Ka);this.pa.Ti();this.Ma.Wd();this.nb.G0a?this.L0l(Ka):(this.MF.show(!0,zb),this.DY.QJa(!1,!0,this.HHe,()=>{this.L0l(Ka)},Object(e.a)(this,this.fDb,
"saveFailureCallback")));this.xye("Print-"+zb);return 32}L0l(Z){this.MF.hide();this.Ddn.print(this.nb.Nh.string,this.gze(this.m_printUrl),Z)}I6c(Z,Ka,zb){if(this.hf.Cd(this.Wv))return 16;if(1===zb)return!this.oc.hl()||h.AFrameworkApplication.boa?8:this.$ze();this.gnh.Sol=new Date;D.a.J(508065485,328,50,"PPT Editor download a copy as PDF");this.pa.Ti();this.Ma.Wd();this.nb.G0a?this.I0l():(this.MF.show(!0,Z),this.DY.QJa(!1,!0,this.HHe,()=>{this.I0l()},Object(e.a)(this,this.fDb,"saveFailureCallback")));
this.xye("DownloadACopyAsPDF");this.Vom();return 32}I0l(){this.MF.hide();this.gnh.O0l=new Date;this.Vmh.convert(this.nb.Nh.string,1,this.gze(this.Cbn))}J6c(Z,Ka,zb){if(this.hf.Cd(this.Wv))return 16;if(1===zb)return!this.oc.hl()||h.AFrameworkApplication.boa?8:this.$ze();D.a.J(508065484,801,50,"PPT Editor download as images");this.pa.Ti();this.Ma.Wd();this.nb.G0a?this.J0l():(this.MF.show(!0,Z),this.DY.QJa(!1,!0,this.HHe,()=>{this.J0l()},Object(e.a)(this,this.fDb,"saveFailureCallback")));this.xye("DownloadAsImages");
return 32}svh(Z,Ka,zb){if(this.hf.Cd(this.Wv))return 16;if(1===zb)return!this.oc.hl()||h.AFrameworkApplication.boa?8:this.$ze();D.a.J(508065483,801,50,"PPT Editor save slides as images");this.pa.Ti();this.Ma.Wd();this.nb.G0a?this.Rol():(this.MF.show(!0,Z),this.DY.QJa(!1,!0,this.HHe,()=>{this.Rol()},Object(e.a)(this,this.fDb,"saveFailureCallback")));this.xye("SaveSlidesAsImages");return 32}J0l(){this.MF.hide();this.Vmh.convert(this.nb.Nh.string,2,this.gze(this.RHl))}Rol(){this.MF.hide();var Z=this.gze(this.RHl),
Ka=this.pa.mg();0<Ka.length&&(Ka=Ag.c(Ka,zb=>zb.sid.toString()).join(","),Z=new ic.QueryStringBuilder(Z),Z.Zi(gj.a.D5l,Ka),this.Vmh.convert(this.nb.Nh.string,2,Z.toString()))}H6c(Z,Ka,zb){if(this.hf.Cd(this.Wv))return 16;if(1===zb)return!this.oc.hl()||h.AFrameworkApplication.boa?8:this.$ze();if(this.GE.hasDeferredContent())return this.rIl&&this.DI.drf(),D.a.J(512500622,843,15,"DownloadACopyAsOdp is triggered while document has deferred content"),this.GE.jxh("DownloadACopyAsOdp",new aj.a,()=>{this.ivk()}),
8;this.pa.Ti();this.Ma.Wd();this.nb.G0a?this.ivk():(this.MF.show(!0,Z),this.DY.QJa(!1,!0,this.HHe,()=>{this.ivk()},Object(e.a)(this,this.fDb,"saveFailureCallback")));return 32}fDb(){this.MF.hide();return!1}ivk(){this.MF.hide();this.Vmh.convert(this.nb.Nh.string,0,this.gze(this.Bbn))}bed(Z,Ka,zb,dc,Jc){if(this.hf.Cd(this.Wv))return 16;if(1===zb)return 32;D.a.J(508065482,801,50,"PPT Editor save file change");this.pa.Ti();this.Ma.Wd();this.DY.QJa(!1,!0,!0,jd=>{if(Jc&&1<=Jc.length)Jc[0](jd)},jd=>Jc&&
2<=Jc.length?(Jc[1](jd,jd.ServerError.Code),!0):!1);return 32}mfn(){const Z=new ic.QueryStringBuilder(Rc.a.XJa("DownloadACopyHandler.ashx"));Z.Zi(gj.a.lcd,this.nb.Nh.string);Z.Zi(gj.a.nka,this.nb.sessionInfo);Z.Zi("fn",h.AFrameworkApplication.fileName);h.AFrameworkApplication.dzb(Z);return Z.toString()}gze(Z){if(Z){const Ka=new ic.QueryStringBuilder(Z);this.nb&&this.nb.podSessionId&&0>Z.indexOf(this.nb.podSessionId)&&(Ka.Y9e(gj.a.A8+"="+this.nb.podSessionId),D.a.J(512500620,801,50,"Append PodSessionId in url: {0}",
this.nb.podSessionId));this.hen&&h.AFrameworkApplication.Wz.TM&&0<h.AFrameworkApplication.Wz.TM.length&&(Ka.Zi(gj.a.J4j,h.AFrameworkApplication.Wz.TM),D.a.J(512500619,801,50,"Appended FileName in url"));this.Ecn&&(Ka.Zi(gj.a.QSl,"true"),D.a.J(512500618,801,50,"Appended IsPasswordProtectedFile param"));h.AFrameworkApplication.dzb(Ka);return Ka.toString()}return null}xye(Z){const Ka=Ii.a.zfa(Qj.a.pdc,!0);D.a.J(509448414,801,15,"DocOperation={0};SimplifiedRibbonON={1}",Z,Ka)}Vom(){const Z=new y.a;Z.name=
"IsLabeled";const Ka=this.Fb.La("AppliedPolicyId");Z.bool=!!(Ka&&0<Ka.length);vb.a("PdfProtectionUsage",!0,void 0,[Z])}d1b(Z){this.jad=Z}$ze(){return h.AFrameworkApplication.RA?8:32}static grl(){const Z=h.AFrameworkApplication.RA,Ka=!Va.a.rb(h.AFrameworkApplication.cac),zb=h.AFrameworkApplication.ga.getBooleanAppSetting("SupportsOfficeClientCoauthoring"),dc=h.AFrameworkApplication.ga.getBooleanAppSetting("PPTClpSwitchEnabled");D.a.J(512500617,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",
Z,Ka,zb,dc);return Z&&Ka&&zb&&dc}}Object(c.a)(Wj,"DocumentOperationsActor",null,[743]);class Ff{}Ff.Bl="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(c.a)(Ff,"EmbedDialogHtml",null,[]);class oi{constructor(Z,Ka,zb,dc){this.s3j=Z;this.Lna=Ka;this.zSl=zb;this.value=dc}}Object(c.a)(oi,"OptionInfo",null,[]);class Fj{constructor(Z,Ka,zb){this.owk=Z;this.VDe=Ka;this.Lna=zb}}
Object(c.a)(Fj,"SectionInfo",null,[]);var bj=a(460);class Hg extends dd.a{constructor(Z,Ka){Ka=void 0===Ka?!1:Ka;super(!1,!1,Ka);this.p6k=476;this.g8g=288;this.Xgm=798;this.Skm=476;this.Qkm=288;this.rsh={};this.hed=[];this.mDa=this.Zjc=this.oPh=this.b8g=this.P9g=this.yxe=null;this.Lsm=zb=>{this.rjl(zb);return!0};this.Msm=zb=>this.Elh(zb,this.rjl);this.rjl=zb=>{zb=zb.kI;"visible"===zb.owk.style.visibility?(zb.owk.style.visibility="hidden",zb.Lna.className=ba.d(Hg.d6k),zb.Lna.title=Object(ta.a)("Expand"),
zb.VDe.title=Object(ta.a)("Expand")):(zb.owk.style.visibility="visible",zb.Lna.className=ba.d(Hg.Xmm),zb.Lna.title=Object(ta.a)("Collapse"),zb.VDe.title=Object(ta.a)("Collapse"))};this.ytn=zb=>{this.ySl(zb);return!0};this.ztn=zb=>this.Elh(zb,this.ySl);this.ySl=zb=>{const dc=this.rsh[zb.kI.toString()];dc.value?(dc.value=0,dc.Lna.className=ba.d(Hg.Umm),dc.zSl.setAttribute(Ga.a.c6h,Ga.a.ksa)):(dc.value=1,dc.Lna.className=ba.d(Hg.kgm),dc.zSl.setAttribute(Ga.a.c6h,Ga.a.uE));this.BXn(zb.kI.toString(),dc.value.toString())};
this.aUn=()=>{this.mDa.select()};this.KWe=h.AFrameworkApplication.QMd;this.c$g=Z;this.O9g=this.ytn;this.nPh=this.ztn;this.wEh=this.Lsm;this.lwe=this.Msm;this.R$g=this.aUn;this.Xim=Ka;this.Bl=Ff.Bl;this.gf=0;this.uk="EmbedDialog"}get WFb(){return this.g8g}set WFb(Z){this.g8g=Z}i5l(Z){const Ka={["id"]:this.uk,["bodyControls"]:{},["embedPreviewSectionTitle"]:Object(ta.a)("Preview"),["embedCodeSectionTitle"]:Object(ta.a)("EmbedCode"),["dimensionsSectionTitle"]:Object(ta.a)("Dimensions"),["interactionSectionTitle"]:Object(ta.a)("Interaction"),
["initialPreviewUrl"]:Rc.a.em(this.c$g,"wdPreview","1"),["initialEmbedUrl"]:this.KWe,["getEmbedCode"]:Hg.Cul,["codeCopiedText"]:Object(ta.a)("EmbedCodeCopied")};for(const zb of Object.keys(Z))Ka[zb]=Z[zb];this.gf=1;this.Fg(1,Object(ta.a)("CopyAction"));this.Fg(0,Object(ta.a)("Close"));this.Dq(Object(ta.a)("Embed"),null,Ka)}CYc(){if(this.Xim)this.i5l({});else{this.showDialog(Object(ta.a)("Embed"),null);this.yxe=document.getElementById("embedpreviewpane");this.P9g=document.getElementById("embedoptionpane");
this.yxe.style.width=String.format("{0}px",this.Skm);this.Zjc=document.createElement("iframe");this.Zjc.className=Hg.Pkm;this.Zjc.frameBorder="0";this.Zjc.style.height=String.format("{0}px",this.Qkm);this.Zjc.tabIndex=-1;this.yxe.appendChild(this.$dh(Object(ta.a)("Preview"),this.Zjc,Hg.ual,Hg.Rkm,Hg.ual,!0));this.mDa=document.createElement("textarea");this.mDa.className=Hg.lhm;Sys.UI.DomElement.addCssClass(this.mDa,bj.a.DDa);this.mDa.id=Hg.mhm;za.a.lk||(this.mDa.readOnly=!0);this.mDa.rows=4;this.mDa.style.fontFamily=
Object(ta.a)("UserInterfaceFontName");this.mDa.style.fontSize=Object(ta.a)("UserInterfaceFontSize");this.mDa.setAttribute(Ga.a.rma,String.format("{0} {1}",Hg.o6k,Hg.n6k));this.yxe.appendChild(this.$dh(Object(ta.a)("EmbedCode"),this.mDa,Hg.o6k));Tc.a.addHandler(this.mDa,"focus",this.R$g);var Z=document.createElement("span");Z.className=Hg.Qhm;Z.innerText=Object(ta.a)("CopyText");Z.id=Hg.n6k;this.yxe.appendChild(Z);this.b8g=document.createElement("div");this.b8g.className=Hg.$gm;this.P9g.appendChild(this.$dh(Object(ta.a)("Dimensions"),
this.b8g));this.oPh=document.createElement("div");this.P9g.appendChild(this.tAm(Hg.vkm,Object(ta.a)("Interaction"),this.oPh));this.gf=0;this.Fg(1,Object(ta.a)("Close"));this.C9l();this.V9l();za.a.lk||this.mDa.focus()}}dispose(){if(this.rsh){var Z=this.rsh;for(const Ka in Z){const zb=Z[Ka];this.rE.jc(ha.a.click,zb.s3j,this.O9g);this.yr.jc(ha.a.Lj,zb.s3j,this.nPh);this.yr.jc(ha.a.Iq,zb.s3j,this.nPh)}this.nPh=this.O9g=this.rsh=null}if(this.hed){for(Z=0;Z<this.hed.length;++Z)this.rE.jc(ha.a.click,this.hed[Z].VDe,
this.wEh),this.yr.jc(ha.a.Lj,this.hed[Z].VDe,this.lwe),this.yr.jc(ha.a.gO,this.hed[Z].VDe,this.lwe),this.yr.jc(ha.a.Iq,this.hed[Z].VDe,this.lwe);this.yr=this.wEh=this.hed=null}this.R$g&&this.mDa&&(Tc.a.removeHandler(this.mDa,"focus",this.R$g),this.R$g=null);this.mDa=this.Zjc=this.oPh=this.b8g=this.P9g=this.yxe=null;super.dispose()}kub(){super.kub();this.Ed.style.width=String.format("{0}px",this.Xgm);this.Zoc()}D9l(Z,Ka){const zb=Rc.a.em(this.KWe,Z,Ka);return this.KWe!==zb?(this.KWe=zb,this.c$g=Rc.a.em(this.c$g,
Z,Ka),!0):!1}C9l(){this.mDa&&(this.mDa.innerText=Hg.Cul(this.KWe,this.p6k,this.g8g))}V9l(){this.Zjc&&this.Zjc.contentWindow.location.replace(Rc.a.em(this.c$g,"wdPreview","1"))}BXn(Z,Ka){this.D9l(Z,Ka)&&(this.C9l(),this.V9l())}$dh(Z,Ka,zb,dc,Jc,jd){zb=void 0===zb?null:zb;dc=void 0===dc?null:dc;Jc=void 0===Jc?null:Jc;jd=void 0===jd?!1:jd;const Ed=document.createElement("div");Ed.className=Hg.Blm;dc&&(Ed.id=dc);Jc&&Ed.setAttribute(Ga.a.rma,Jc);jd&&(Ed.tabIndex=0);dc=document.createElement("span");dc.className=
Hg.Clm;dc.innerText=Z;zb&&(dc.id=zb);Ed.appendChild(dc);Ed.appendChild(Ka);return Ed}tAm(Z,Ka,zb){Ka=this.$dh(Ka,zb);const dc=this.Tp.createElement("div");dc.className=Hg.Gfm;dc.id=Hg.Ifm+Z;dc.setAttribute(Ga.a.pi,Ga.a.BL);dc.tabIndex=0;Ka.insertBefore(dc,zb);Z=ba.a(16,16,Hg.Hfm,Hg.Jfm,!0,"");dc.appendChild(Z);Z=Z.childNodes[0];Z.className=ba.d(Hg.d6k);Z.title=Object(ta.a)("Expand");dc.title=Object(ta.a)("Expand");zb.style.visibility="hidden";zb=new Fj(zb,dc,Z);Array.add(this.hed,zb);this.rE.g_(ha.a.click,
dc,this.wEh,zb);this.yr.g_(ha.a.Lj,dc,this.lwe,zb);this.yr.g_(ha.a.gO,dc,this.lwe,zb);this.yr.g_(ha.a.Iq,dc,this.lwe,zb);return Ka}static Cul(Z,Ka,zb){if(!Hg.GOh){const dc=String.format('<a target="_blank" href="{0}">{1}</a>',Va.a.ODe("https://office.com"),Object(ta.a)("Office")),Jc=String.format('<a target="_blank" href="{0}">{1}</a>',Va.a.ODe("https://office.com/webapps"),Object(ta.a)("WebAppName"));Hg.GOh=String.format(Object(ta.a)("NoFrames"),dc,Jc)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',
Va.a.ODe(Z),Ka,zb,Hg.GOh)}}Hg.GOh=null;Hg.kgm="CheckboxChecked_16x16x32";Hg.Umm="CheckboxUnchecked_16x16x32";Hg.Xmm="OutlookSearchChevronUp_16x16x32";Hg.d6k="OutlookSearchChevronDown_16x16x32";Hg.Hfm="UpArrowServer";Hg.Blm="EmbedSectionHeader";Hg.Clm="EmbedSectionName UIFontBold";Hg.Qhm="EmbedCodeFooter";Hg.Pkm="EmbedPreviewFrame";Hg.lhm="EmbedCodeTextArea";Hg.$gm="EmbedDimensionSection";Hg.Jfm="EmbedArrowIcon";Hg.Gfm="WACGlyph EmbedArrowHolder";Hg.mhm="EmbedCode";Hg.o6k="EmbedCodeHeader";Hg.ual=
"Preview";Hg.Rkm="PreviewHeader";Hg.vkm="Options";Hg.Ifm="Arrow";Hg.n6k="EmbedCodeFooter";Object(c.a)(Hg,"EmbedDialog",dd.a,[]);class rg extends Hg{constructor(Z,Ka){super(Z,!0);Ka&&Ka&&!isNaN(Ka)||D.a.J(507843799,820,10,"Invalid aspectRatio in ReactEmbedDialog");this.D9l(gj.a.PSl,Ka.toString())}CYc(){const Z=[];Z.push({["id"]:"wdEaaCheck",["checkboxInitialValue"]:!1,["checkboxLabel"]:ResourceStrings.l_AutoAdvanceLabel,["urlTransformFunctionOnChange"]:rg.aDn});this.i5l({["dimensionsOptions"]:{["isMultipleChoice"]:!1,
["defaultWidth"]:this.p6k,["defaultHeight"]:this.g8g,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:ResourceStrings.l_EmbedSlideWidth,["heightLabel"]:ResourceStrings.l_EmbedSlideHeight},["interactionOptions"]:Z})}static aDn(Z,Ka,zb){return"wdEaaCheck"===Ka?Rc.a.em(Z,Ka,zb?"1":"0"):Z}}Object(c.a)(rg,"ReactEmbedDialog",Hg,[]);class Jj{constructor(Z,Ka,zb,dc,Jc){this.kab=null;this.jEj=!1;this.jad=null;this.Db=Z;this.kFj=Ka;this.D3f=zb;this.eGj=dc;this.nb=Jc}CYc(Z,Ka,zb){(Z=(Z=h.AFrameworkApplication.fD)||
this.nb.G0a)||this.jEj||(Z=!this.p8l());return 1===zb?Z?2:32:this.FPn()}FPn(){if(!this.jEj)return 8;if(h.AFrameworkApplication.QMd&&this.D3f)this.G4l();else{const Z=h.AFrameworkApplication.Pzh?this.jad.sendMessage(sf.a.JIm,null)?32:8:2;return 32!==Z?this.Db.uM(!0,h.AFrameworkApplication.Vfh):Z}return 32}EPn(Z){Z.Values.HostEmbeddedViewUrl&&(this.D3f=h.AFrameworkApplication.QMd=Z.Values.HostEmbeddedViewUrl.toString(),this.G4l())}p8l(){return!1}fom(Z,Ka){this.kab=Ka;this.jEj=!!this.Db&&!!this.kFj&&
!(void 0===this.D3f||null===this.D3f)&&!!Z&&!!Ka}G4l(){(new rg(this.D3f,this.kab)).CYc()}}Object(c.a)(Jj,"EmbedManager",null,[]);class uk{constructor(Z,Ka,zb){this.kab=null;this.$bn={};for(Ka=0;Ka<Z.length;Ka++)this.$bn[Z[Ka].Format.toString()]=Ka;this.kab=zb&&!isNaN(zb)&&isFinite(zb)?zb:0}}Object(c.a)(uk,"FormatPicker",null,[]);class ai extends Jj{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de){super(Z,Ka,zb,jd,Ed,de);this.ia=dc;this.Ub=Jc}Hb(){this.ia.za(sb.a.CYc,Na.a.application,Object(e.a)(this,this.CYc,
"showEmbedDialog"));this.eGj.execute(Object(e.a)(this,this.d1b,"onHostPostmessengerCreated"))}ve(){}p8l(){var Z=this.Ub.lB();if(!this.kFj||!Z.height)return!1;Z=Z.width/Z.height;const Ka=new uk(this.kFj,!1,Z);this.fom(Ka,Z);return!0}d1b(Z){this.jad=Z;h.AFrameworkApplication.h8||h.AFrameworkApplication.QMd||!this.jad||(this.jad.Xt(sf.a.bjl),this.jad.jE(sf.a.bjl,Object(e.a)(this,this.EPn,"showEmbedDialogPostMessage")))}}Object(c.a)(ai,"EmbedActor",Jj,[743]);var mh=a(1580),tg=a(257),Kj=a(902),ek=a(891);
class gi{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg){this.ia=Z;this.ypb=Ka?Ka.ta:null;this.va=zb;this.uc=dc;this.ob=Jc;this.yv=jd;this.Mb=Ed;this.Qk=de;this.ee=Ne;this.bGe=null;this.Ma=Re;this.Wv=zb.presentation;this.Fe=Cf;this.jf=null;this.jpb=yg}Hb(){this.ia.sa(sb.a.ape,tg.a.application,Object(e.a)(this,this.OXm,"handleUploadAudioDialog"),4)}ve(){}OXm(Z,Ka,zb){const dc=this.va.Ga;if(!dc||this.uc.Cd(dc))return 16;if(1===zb)return 32;if(this.ypb){this.jf=Og.a.Fk("Audio::Insert");try{return ek.a.tNe("audio/*",
Kj.e,()=>Kj.d(Z,Object(e.a)(this,this.D2m,"insertAudioSuccessAfterUploadUsingMediaUpload"),"audio",this.Fe,dc),"audio",dc,this.va.presentation,this.uc,this.ee,this.jf,!1,this.jpb,50,10,3),this.jf&&this.jf.Ya("AudioDialogInitialized","true"),32}catch(Jc){D.a.J(509724633,818,10,"Error while rendering new audio selection dialog.")}}else return D.a.J(512500560,822,15,"Insert Audio initialization failed."),8;this.showErrorMessage(446,null);return 8}showErrorMessage(Z,Ka){this.jf&&(this.jf.finish(),this.jf=
null);this.ee.SK(Z,zb=>{zb.zD=1;zb.Z9a=Ka;return!1})}D2m(Z,Ka,zb,dc,Jc,jd,Ed){dc.cN(zb)&&D.a.J(512500553,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+zb.Tea);dc.mD(zb);Jc&&Jc.Ya("AudioUploadToRC","true");Object(rb.a)("FixForInsertMediaSlideNavigationIssue")||(Ed=this.va.Ga);zb=Ed.Ju();var de=this.Wv.slideWidth,Ne=this.Wv.slideHeight;dc=mh.a.vf(32,0);const Re=mh.a.vf(32,1);de=de/2-mh.a.vf(16,0);Ne=Ne/2-mh.a.vf(16,
1);if(Ed&&Ed.isConnected){var Cf=this.Mb.Fd(15,void 0,void 0,()=>{this.yv.zI=this.bGe;this.ob.selectShape(this.bGe,!0);this.Ma.Wd()});try{Cf.rc(Ed);Cf.sc=Z;Jc&&Jc.Ya("CreatingAudioShape","true");this.bGe=this.Qk.QDa(!1,Ed.Xb.cid,Ed.Xb.sid,0,10,de,Ne,dc,Re,zb+1);const yg=jd.files[0].name;this.bGe.u$b=Ka;this.bGe.t$b=yg;Ed.pI(this.bGe)}finally{Cf&&Cf.dispose()}Jc&&(Jc.Ya("AudioShapeSuccessfullyCreated","true"),Jc.finish(),Jc=null)}}}Object(c.a)(gi,"InsertAudioActor",null,[743]);var Di=a(83);class ak{constructor(){this.aEe=
this.Xye=null}}Object(c.a)(ak,"CreatePickerCustomizationDictionaryOptions",null,[1878]);var Rj=a(173),Lf=a(249);class Sh{}Sh.Bl="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(c.a)(Sh,"InsertMediaDialogHtml",null,[]);class Nh{}Nh.Bl="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(c.a)(Nh,"InsertMediaM365DialogHtml",null,[]);var Fk=a(493);class bk{static get Bl(){return dd.a.xX(bk.Ny,ResourceStrings.l_InsertOnlineVideoDescription,ResourceStrings.l_InsertOnlineVideoPrivacy,ResourceStrings.L_LearnMore,"http://go.microsoft.com/fwlink/?linkid=2010177")}}bk.Ny="<div class='VideoUrl' id='videourl'> <label id='labelVideoUrl' class='WACDialogLabel' for='url' >{0}</label> </div> <div class='VideoUrl' id='videourl'> <input type='text' id='url' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='VideoOutput' id='videooutput'> <label id='privacyandtos' class='WACDialogLabel' >{1}</label> </div> <div class='LearnMore' id='learnmore'> <a id='learnmore' class='LearnMore' href={3} target='newtab' >{2}</a> </div> <div class='VideoOutput' id='videooutput'> <label id='labelmessage' class='WACDialogLabel' >message</label> </div>";
Object(c.a)(bk,"InsertOnlineVideoDialogHtml",null,[]);class Uh extends dd.a{constructor(Z){super();this.l_(1,!0);this.Fg(1,ResourceStrings.L_Insert);this.Bl=bk.Bl;this.TTa=Z;this.nGa=!1}nwb(){this.width=50;this.Dq(ResourceStrings.L_OnlineVideo,Object(e.a)(this,this.K2m,"insertOnlineVideoDialogHandler"),{["url"]:""});document.getElementById("labelmessage").innerText="";document.getElementById("labelmessage").setAttribute(Ga.a.Vcf,Ga.a.$gl);const Z=document.getElementById("url");this.l_(1,!!Z&&0<Z.value.length);
Tc.a.addHandler(Z,ha.a.input,Object(e.a)(this,this.Trh,"onPatternChanged"));Tc.a.addHandler(Z,ha.a.change,Object(e.a)(this,this.Trh,"onPatternChanged"));this.I8(Z)}hide(){const Z=document.getElementById("url");Z&&(Tc.a.removeHandler(Z,ha.a.input,Object(e.a)(this,this.Trh,"onPatternChanged")),Tc.a.removeHandler(Z,ha.a.change,Object(e.a)(this,this.Trh,"onPatternChanged")));super.hide()}K2m(Z,Ka){if(1===Z){if(Ka){var zb=Og.a.Fk("InsertOnlineVideo",1);zb.kq=!0;Z=Ka.url.trim();(Z=this.TTa.Xql(Z))?this.TTa.Alh(Z)&&
this.TTa.nEl(Z)?(D.a.J(512500548,352,50,"[Insert Online Video] Creating Hubble request for {0}",this.TTa.FMi(Z)),this.TTa.requestVideoData(Z,dc=>{Og.a.FA(zb,()=>{this.iZ(dc)})},Object(e.a)(this,this.tIm,"failCallback"))):(D.a.J(512500547,352,10,"[Insert Online Video] Dialog url doesn't match, given url: "+this.TTa.FMi(Z)),this.fail(null,ResourceStrings.l_InsertOnlineVideoUnsupportedProvider)):(D.a.J(512500549,352,10,"[Insert Online Video] Dialog url is null!"),this.fail(null,ResourceStrings.l_InsertOnlineVideoIframeError))}}else this.hide()}iZ(Z){this.hide();
this.TTa.Ujh(Z)}tIm(Z){this.fail(Z,ResourceStrings.l_CannotInsertOnlineVideo)}fail(Z,Ka){if(document.getElementById("labelmessage")){var zb=+new Date-+this.TTa.startTime;document.getElementById("labelVideoUrl").removeAttribute("for");document.getElementById("labelmessage").innerText=Ka;document.getElementById("labelmessage").setAttribute("for","url");document.getElementById("url").focus();Z&&D.a.J(512500545,352,10,"InsertOnlineVideoDialog:Fail {0}",JSON.stringify({["TimeMs"]:zb,["ResponseCode"]:Z.data.Ze}))}else D.a.J(512500546,
352,15,"[Insert Online Video] Request failed after the dialog dissapeared!")}Trh(){Og.a.ULa();const Z=document.getElementById("url");this.l_(1,!!Z&&0<Z.value.length)}}Object(c.a)(Uh,"InsertOnlineVideoDialog",dd.a,[1529]);var Ge=a(279),Hf=a(1265),Bg=a(273);class qk{constructor(Z,Ka,zb){this.NZe=Oh.a.T7;this.IK=null;this.ya=Z;this.DKh=Ka;this.iSa=zb}get Gs(){return this.ya}get jca(){return this.IK||(this.IK=l.a.instance.resolve("Common.Utils.IAriaNotifier"))}get LX(){return this.NZe}set LX(Z){this.NZe=
Z}fbc(Z){try{f.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",Z.length);const Ka=this.DKh.rAn(Z);let zb=2;if(Ka&&0<Ka.length){const dc=new Hf.a;dc.setValue(Bg.a.mW,Ka);dc.setValue(Bg.a.r9c,!0);if(this.iSa){const Jc=this.iSa.FNe("ClipboardOperation");Jc.V4c("insertOnlineImage");dc.setValue(Bg.a.DSa,Jc)}h.AFrameworkApplication.ga.getBooleanAppSetting("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.jca.H8(Box4Intl.Box4Strings.l_ImageUploading,
!0);zb=this.ya.Qa(this.LX,2,dc)}f.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",Z.length,32===zb,""===Ka)}catch(Ka){f.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",Ka.toString())}}}Object(c.a)(qk,"InsertOnlineImageHandler",null,[1441]);class Oj extends qk{constructor(Z,Ka,zb){super(Z,Ka,void 0===zb?null:zb)}get enl(){return sf.a.tOf}get FDe(){return sf.a.H2m}cTl(Z){return this.DKh.qun(Z)}owl(Z){return Z.Type}Dkh(Z,
Ka){return this.DKh.Dkh(Z.Type,Ka)}fTl(Z){const Ka=[];if(Z&&Z.data&&Z.data.value&&0<Z.data.value.length)for(let dc=0;dc<Z.data.value.length;dc++)if(Z.data.value[dc]&&Z.data.value[dc].urls&&Z.data.value[dc].urls.download){var zb=Z.data.value[dc];zb=Object.assign(new kj.a,{OriginalUrl:zb.urls.download,Type:zb.extension||"",Caption:zb.name,ContentType:"",Height:zb.driveItem||zb.driveItem.image?zb.driveItem.image.height:0,Width:zb.driveItem||zb.driveItem.image?zb.driveItem.image.width:0});Array.add(Ka,
zb)}Ka.length||f.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");return Ka}dWl(Z,Ka,zb){zb=zb(Z);if(zb.length){Z=[];for(let dc=0;dc<zb.length;dc++){const Jc=zb[dc],jd={};jd.Extension=Jc.Type;jd.SourceUrl=Jc.OriginalUrl;jd.SourceUrl=Jc.OriginalUrl;jd.Width=Jc.Width;jd.Height=Jc.Height;Array.add(Z,jd)}zb={};zb.Items=Z;Ka.sendMessage(this.FDe,zb)}}}Object(c.a)(Oj,"InsertOnlineImageHelperBox4",qk,[1440,1441]);class Hk extends Oj{constructor(Z,
Ka,zb){super(Z,Ka);this.lrg=zb.K$a;this.LX=sb.a.pEe}fbc(Z){if(Z&&0<Z.length){var Ka=Rc.a.aN(Z[0].OriginalUrl);Ka=this.fVf(Ka)?Ka:"unsupported";D.a.J(512517837,352,50,"InsertMediaCallback: Insert online video called for {0}",Ka);this.Gs.Qa(this.LX,2,Z[0])}}fVf(Z){if(!Z)return!1;Z=Z.trim();for(const Ka of this.lrg)if((new RegExp(Ka)).test(Z))return!0;return!1}}Object(c.a)(Hk,"InsertOnlineVideoHelper",Oj,[]);class Hi{static get Bl(){return dd.a.xX(Hi.Ny,ResourceStrings.l_InsertSocialMediaDialogMsg)}}
Hi.Ny="<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>";Object(c.a)(Hi,"InsertSocailMediaDialogHtml",null,[]);var nh=a(296),Pf=a(421);class Q extends Sys.EventArgs{constructor(Z,Ka,zb,dc){super();this.slideId=Z;this.q7=zb;this.shapeId=Ka;this.iconName=dc}}Object(c.a)(Q,"IconChangedEventArgs",Sys.EventArgs,[]);var xa=a(688),ob=a(275);class Qb{constructor(Z,
Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah,Ui,$g,oh,Jh,ti,Mj,Yl,em,Wh,tk,Zk,Fl,yk,dk,Ej){this.Cag=this.oIc=this.Akh=!1;this.QHe=this.cYb=null;this.sDb=(il,Dk,sm)=>{if(!this.iwb(this.va.Ga,il,this.la.URb))return 8;if(1===sm)return 32;let hk,im;h.AFrameworkApplication.fD||h.AFrameworkApplication.RA||!this.Fb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",!1)?h.AFrameworkApplication.fD||h.AFrameworkApplication.RA||!this.la.getBooleanAppSetting("CopilotDalleLicenseCheckEnabled")?
this.Fb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&(im="dalle"):this.iab.execute(qm=>{qm.isFeatureEnabled("Copilot",!1).then(kn=>{kn&&(im="dallecore")})}):im="dallecore";Dk=new ic.QueryStringBuilder(this.wPm(il));Dk.Zi("entryPoint",sb.a.Ov(il));im&&Dk.Zi(im,"1");switch(il){case sb.a.Jzc:case sb.a.pOd:hk=1;this.oob.LX=sb.a.oEe;break;case sb.a.lEe:case sb.a.mEe:Dk.Fy("initpivot","dalle");hk=1;this.oob.LX=sb.a.oEe;break;case sb.a.e9c:hk=1;this.oob.LX=sb.a.j9c;break;case sb.a.hLb:rb.a("ChangePictureFromIconsFixEnabled")?
this.nVb.LX=sb.a.Yze:this.nVb.LX=sb.a.Xze;hk=0;break;case sb.a.C$b:hk=0;this.nVb.LX=sb.a.Yze;break;case sb.a.F5c:Dk.Fy("initpivot","dalle");hk=0;this.nVb.LX=sb.a.Yze;break;case sb.a.OOb:Dk.Zi("disabledpivots","stockvideos");hk=0;this.oob.LX=sb.a.Nyf;break;default:return D.a.J(512517955,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",il.toString()),16}this.Fb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyApiExperiment",!1)&&(Dk.Zi("gae","1"),h.AFrameworkApplication.OFe("0fecb342;2aaje503"));
this.Fb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyIngestionExperiment",!1)&&(Dk.Zi("gie","1"),Dk.Zi("semsearch","1"),h.AFrameworkApplication.OFe("421a8839;gjbhf574"));this.Fb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableHubbleSemanticSearchExperiment",!1)&&(Dk.Zi("ss","1"),h.AFrameworkApplication.OFe("fdfb7742;909ce823"));this.la.bAc&&Dk.Zi("sv","1");const Nl=Dk.toString();if(!Nl||!Nl.length)return 16;D.a.J(512517954,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");
try{const qm=Di.a.create(),kn=Va.a.DV(this.la.lPa).toString();this.iab.execute(Am=>{var fm=this.la.mdj&&Am.isFreemiumUpsellEnabled();fm=this.oIc?1:fm?0:-1;var ln=this.Fb.getBooleanAppSetting("InsertOnlineM365ExperimentEnabled")?1:0;ln=this.Loa.Yhl(Lf.App.mode,Nl,fm,hk,qm.toString(),kn,ln);Am=this.LGe.getInstance(ln,this.KGe,this.Loa,Am,Nh.Bl);Am.correlationId=qm;Am.orb=2;Am.Aeh=fm;Am.bpe(CommonUIStrings.L_PictureInsertTitle,il===sb.a.hLb||il===sb.a.C$b?this.nVb:this.oob,void 0);D.a.J(512517953,352,
50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});return 32}catch(qm){return D.a.J(512517952,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",qm.toString()),Qb.QE(nh.a.jCe,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}};this.la=Z;this.ia=Ka;this.uc=zb;this.pa=dc;this.Ma=Jc;this.va=jd;this.Mb=Ed;this.LGe=de;this.pcn=Ne;this.KGe=Re;this.Loa=Cf;this.iab=yg;this.oob=bh;this.nVb=Ah;this.Ub=Ui;this.Qk=$g;this.Ia=
oh;this.xb=Jh;this.yv=ti;this.kj=Mj;this.g5d=Yl;this.UWb=Zk;this.Jag=Fl;this.Ad=yk;this.z3=Z.Z2b;this.Gz=Z.xJ;this.Fb=Ej;this.g5d&&(this.g5d.kEd.removeAttribute("style"),this.g5d.kEd.style.display="none");this.wKj=em;this.qcn=Wh;this.TTa=tk;this.Y1a=dk;this.iab.execute(il=>{il.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Dk=>D.a.J(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",Dk)).then(Dk=>{this.oIc=Dk;this.oIc||(this.cYb=
il.OCb("MsoPremiumStockImages",()=>{this.oIc=!0;D.a.J(512517962,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));return null});il.isFeatureEnabled("OmgStreamTwo",!1).then(Dk=>{this.Cag=Dk;this.Cag||(this.nMl=il.OCb("OmgStreamTwo",()=>{this.Cag=!0}))})})}Hb(){this.Aom();this.ia.sa(sb.a.j9c,tg.a.application,Object(e.a)(this,this.TYn,"uploadIcon"),4);rb.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.sa(sb.a.Xze,tg.a.application,Object(e.a)(this,this.Rwm,"changeToIcon"),4):this.ia.sa(sb.a.Xze,
tg.a.application,Object(e.a)(this,this.Swm,"changeToIcon"),4);this.ia.sa(sb.a.gbc,tg.a.application,Object(e.a)(this,this.Mzh,"uploadOnlinePicture"),4);rb.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.sa(sb.a.bpc,tg.a.application,Object(e.a)(this,this.Wch,"changeToOnlinePicture"),4):this.ia.sa(sb.a.bpc,tg.a.application,Object(e.a)(this,this.Xch,"changeToOnlinePicture"),4);this.ia.sa(sb.a.oEe,tg.a.application,Object(e.a)(this,this.Mzh,"uploadOnlinePicture"),4);rb.a("ChangePictureOnMultiSelectFixEnabled")?
this.ia.sa(sb.a.Yze,tg.a.application,Object(e.a)(this,this.Wch,"changeToOnlinePicture"),4):this.ia.sa(sb.a.Yze,tg.a.application,Object(e.a)(this,this.Xch,"changeToOnlinePicture"),4);this.ia.sa(sb.a.yOf,tg.a.application,Object(e.a)(this,this.Mzh,"uploadOnlinePicture"),4);rb.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.sa(sb.a.Zze,tg.a.application,Object(e.a)(this,this.Wch,"changeToOnlinePicture"),4):this.ia.sa(sb.a.Zze,tg.a.application,Object(e.a)(this,this.Xch,"changeToOnlinePicture"),4);this.zom();
this.ia.sa(sb.a.jdj,tg.a.application,Object(e.a)(this,this.Mzh,"uploadOnlinePicture"),4);rb.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.sa(sb.a.Tch,tg.a.application,Object(e.a)(this,this.Wch,"changeToOnlinePicture"),4):this.ia.sa(sb.a.Tch,tg.a.application,Object(e.a)(this,this.Xch,"changeToOnlinePicture"),4);this.Bom();this.ia.sa(sb.a.pEe,tg.a.application,Object(e.a)(this,this.XYn,"uploadOnlineVideo"),4);this.ia.sa(sb.a.i9c,tg.a.application,Object(e.a)(this,this.WYn,"uploadOnlineHubbleVideo"),
4);this.ia.sa(sb.a.wdc,Na.a.application,Object(e.a)(this,this.CXn,"updateEntryPoints"),96)}Aom(){this.ia.sa(sb.a.e9c,tg.a.application,this.sDb,4);this.ia.sa(sb.a.hLb,tg.a.application,this.sDb,4);this.ia.sa(sb.a.insertOnlinePicture,tg.a.application,Object(e.a)(this,this.yIk,"showInsertPictureDialog"),4);this.ia.sa(sb.a.C5c,tg.a.application,Object(e.a)(this,this.yIk,"showInsertPictureDialog"),4);rb.a("InsertSocialMediaVideoIcon")&&this.ia.sa(sb.a.Sjh,tg.a.application,Object(e.a)(this,this.VPn,"showInsertSocialMediaDialog"),
4);rb.a("InsertDalleIcon")&&(this.ia.sa(sb.a.lEe,tg.a.application,this.sDb,4),this.ia.sa(sb.a.mEe,tg.a.application,this.sDb,4));this.ia.sa(sb.a.Jzc,tg.a.application,this.sDb,4);this.ia.sa(sb.a.C$b,tg.a.application,this.sDb,4);rb.a("ChangePictureCreateWithAI")&&this.ia.sa(sb.a.F5c,tg.a.application,this.sDb,4);this.ia.sa(sb.a.pOd,tg.a.application,this.sDb,4);this.ia.sa(sb.a.OOb,tg.a.application,this.sDb,4);this.la.N$d&&this.ia.xdd("ppt_insertOnlinePictures",sb.a.OOb,tg.a.application,this.sDb,Z=>{Lf.App.Vb.$ec(Z,
this.Y1a.iAb)});this.ia.sa(sb.a.Kzc,tg.a.application,Object(e.a)(this,this.zIk,"showInsertPictureFromHostDialog"),4);this.ia.sa(sb.a.D5c,tg.a.application,Object(e.a)(this,this.zIk,"showInsertPictureFromHostDialog"),4);this.la.N$d&&(this.ia.xdd("ppt_insertOnlinePictures",sb.a.insertOnlinePicture,tg.a.application,Object(e.a)(this,this.yIk,"showInsertPictureDialog"),Z=>{Lf.App.Vb.$ec(Z,Object(e.a)(this.Y1a,this.Y1a.iAb,"getCommandById"))}),this.ia.xdd("ppt_insertOnlinePictures",sb.a.Jzc,tg.a.application,
this.sDb,Z=>{Lf.App.Vb.$ec(Z,Object(e.a)(this.Y1a,this.Y1a.iAb,"getCommandById"))}),this.ia.xdd("ppt_insertOnlinePictures",sb.a.pOd,tg.a.application,this.sDb,Z=>{Lf.App.Vb.$ec(Z,Object(e.a)(this.Y1a,this.Y1a.iAb,"getCommandById"))}),this.ia.xdd("ppt_insertOnlinePictures",sb.a.Kzc,tg.a.application,Object(e.a)(this,this.zIk,"showInsertPictureFromHostDialog"),Z=>{Lf.App.Vb.$ec(Z,Object(e.a)(this.Y1a,this.Y1a.iAb,"getCommandById"))}))}zom(){this.la.rEe&&this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",
!1)&&(this.ia.sa(sb.a.qEe,tg.a.application,Object(e.a)(this,this.pxh,"showInsertPictureFromMobileDeviceDialog"),4),this.ia.sa(sb.a.G5c,tg.a.application,Object(e.a)(this,this.pxh,"showInsertPictureFromMobileDeviceDialog"),4),this.la.N$d&&(this.ia.xdd("mso_insertMobileDevicePictures",sb.a.qEe,tg.a.application,Object(e.a)(this,this.pxh,"showInsertPictureFromMobileDeviceDialog"),Z=>{Lf.App.Vb.$ec(Z,Object(e.a)(this.Y1a,this.Y1a.iAb,"getCommandById"))}),this.ia.xdd("mso_insertMobileDevicePictures",sb.a.G5c,
tg.a.application,Object(e.a)(this,this.pxh,"showInsertPictureFromMobileDeviceDialog"),Z=>{Lf.App.Vb.$ec(Z,Object(e.a)(this.Y1a,this.Y1a.iAb,"getCommandById"))})))}Bom(){this.ia.sa(sb.a.sEa,tg.a.application,Object(e.a)(this,this.c7b,"showInsertVideoDialog"),4);this.la.N$d&&this.ia.xdd("ppt_insertOnlineVideos",sb.a.sEa,tg.a.application,Object(e.a)(this,this.c7b,"showInsertVideoDialog"),Z=>{Lf.App.Vb.$ec(Z,Object(e.a)(this.Y1a,this.Y1a.iAb,"getCommandById"))})}sAn(){h.AFrameworkApplication.s9c()&&h.AFrameworkApplication.x4l()&&
(h.AFrameworkApplication.Ea.get_element().appendChild(this.g5d.kEd),Tc.a.addHandler(this.g5d.kEd.contentWindow,"message",Object(e.a)(this,this.c5l,"showOneDriveFilePickerDialog")),this.Akh=!0)}c5l(Z){if(Z.rawEvent&&(Z=Z.rawEvent.data))try{D.a.J(512517961,352,50,"User select images.");const Ka=Sys.Serialization.JavaScriptSerializer.deserialize(Z,!0),zb=Ka.MessageId?Ka.MessageId.toString():null;Ka&&zb&&(zb===sf.a.tOf||zb===sf.a.bdj)&&this.wKj.start(zb===sf.a.tOf?this.oob:this.qcn)}catch(Ka){D.a.J(512517960,
352,10,"malformatted postmessage here.")}}ve(){}CXn(){return 32}yIk(Z,Ka,zb){if(!this.iwb(this.va.Ga,Z,this.la.dda))return 8;if(1===zb)return 32;D.a.J(512517959,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{const dc=Di.a.create(),Jc=Va.a.DV(this.la.lPa).toString(),jd=Z===sb.a.insertOnlinePicture&&this.la.TUl?1:0;let Ed=String.format(this.la.Lzc,h.AFrameworkApplication.lcid,fj.a.Ne(h.AFrameworkApplication.lcid).name,h.AFrameworkApplication.buildVersion,dc.toString(),3,Jc,jd);
0<this.la.Lzc.search(RegExp("insertmedia.bing.office.net","gi"))&&(Ed=this.Loa.Ium(Lf.App.mode,this.la.oKe?this.la.nEe:this.la.Lzc));this.iab.execute(de=>{de=this.LGe.getInstance(Ed,this.KGe,this.Loa,de,Sh.Bl);de.Mzc=this.la.Mzc;de.correlationId=dc;de.orb=1;switch(Z){case sb.a.C5c:this.nVb.LX=sb.a.bpc;break;default:this.oob.LX=sb.a.gbc}de.bpe(CommonUIStrings.L_PictureInsertTitle,Z===sb.a.insertOnlinePicture?this.oob:this.nVb,void 0);D.a.J(512517958,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});
return 32}catch(dc){return D.a.J(512517957,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",dc.toString()),Qb.QE(nh.a.jCe,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}VPn(Z,Ka,zb){if(1===zb)return 32;Z=new dd.a(void 0,void 0,!1);Z.gf=5;Z.Bl=Hi.Bl;Z.Dq(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{["id"]:"SocialMediaExperimentDialog"});D.a.J(512517956,352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32}wPm(Z){switch(Z){case sb.a.Jzc:case sb.a.pOd:case sb.a.lEe:case sb.a.mEe:case sb.a.OOb:return this.la.Qjh;
case sb.a.e9c:return this.la.oOd;case sb.a.hLb:return rb.a("ChangePictureFromIconsFixEnabled")?this.la.oOd:this.la.sjl;case sb.a.C$b:case sb.a.F5c:return this.la.tjl;default:return this.la.Qjh}}zIk(Z,Ka,zb){if(!this.iwb(this.va.Ga,Z,h.AFrameworkApplication.s9c()&&(Qb.Wyl?!!this.wKj.VIe&&9<this.wKj.VIe.length:!0)))return 8;if(1===zb)return 32;D.a.J(512517923,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{Ka=!0;let dc=0;if(this.Fb.getBooleanAppSetting("InsertMediaSharedFilePickerEnabled")){const jd=
l.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(jd.mpj()){Ka=!1;const Ed=this.la.qdj;zb=!1;this.la.rEe&&(zb=this.sLm());const de=Object.assign(new ak,{Xye:zb,aEe:!0}),Ne=jd.Sdh(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,!0,Ed,"InsertPicture",0,de);jd.CCf(Ne).then(Re=>{if(Re&&0<Re.length){const Cf=[];for(let yg=0;yg<Re.length;yg++){const bh=Re[yg][ne.a.I6j],Ah={};Ah.Extension=Re[yg][ne.a.KTl];Ah.OriginalUrl=ne.a.D6j in Re[yg]?Re[yg][ne.a.D6j]:
bh;Ah.Type=ne.a.E6j in Re[yg]?Re[yg][ne.a.E6j]:"";Ah.Caption=ne.a.H6j in Re[yg]?Re[yg][ne.a.H6j]:"";Ah.Description=ne.a.C6j in Re[yg]?Re[yg][ne.a.C6j]:"";Ah.Width=ne.a.G6j in Re[yg]?Re[yg][ne.a.G6j]:0;Ah.Height=ne.a.F6j in Re[yg]?Re[yg][ne.a.F6j]:0;Array.add(Cf,Ah)}this.IPm(Z).fbc(Cf);D.a.J(512517922,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}dc=32}).catch(Re=>{D.a.J(512517921,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",
Re.toString());Qb.QE(nh.a.jCe,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture);dc=8})}}if(!Ka)return dc;Qb.Wyl=!0;this.Akh||this.sAn();const Jc=this.pcn.getInstance();Jc.orb=4;switch(Z){case sb.a.D5c:this.nVb.LX=sb.a.Zze;break;default:this.oob.LX=sb.a.yOf}Jc.bpe(CommonUIStrings.L_PictureInsertTitle,Z===sb.a.Kzc?this.oob:this.nVb,void 0);D.a.J(512517920,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");return 32}catch(dc){return D.a.J(512517919,
352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",dc.toString()),Qb.QE(nh.a.jCe,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}IPm(Z){if(!rb.a("ChangePictureFromOneDriveFixEnabled"))return this.oob;const Ka=(Z=Z===sb.a.Kzc)?this.oob:this.nVb;Ka.LX=Z?sb.a.yOf:sb.a.Zze;return Ka}sLm(){return l.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").AMm()}pxh(Z,Ka,zb){if(!this.iwb(this.va.Ga,Z,this.la.rEe&&this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",
!1)))return 8;if(1===zb)return 32;l.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").FIm(this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));try{let dc=0;const Jc=l.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(Jc.mpj()){const jd=Z===sb.a.qEe,Ed=this.la.qdj,de=Object.assign(new ak,{Xye:!0,aEe:!0}),Ne=Jc.Sdh(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,jd,Ed,"InsertPictureFromMobile",
3,de);Jc.CCf(Ne).then(Re=>{if(Re&&0<Re.length){const Cf=[];let yg=!1;const bh=this.Fb.La("PhoneLinkServiceEndpoint");for(let Ah=0;Ah<Re.length;Ah++){const Ui=Re[Ah][ne.a.I6j],$g=Re[Ah],oh={};oh.Extension=Re[Ah][ne.a.KTl];oh.OriginalUrl=this.gLe($g,ne.a.D6j,Ui);oh.Type=this.gLe($g,ne.a.E6j,"");oh.Caption=this.gLe($g,ne.a.H6j,"");oh.Description=this.gLe($g,ne.a.C6j,"");oh.Width=this.gLe($g,ne.a.G6j,0);oh.Height=this.gLe($g,ne.a.F6j,0);Array.add(Cf,oh);yg||(yg=-1!==oh.OriginalUrl.indexOf(bh))}Re=jd?
this.oob:this.nVb;Re.LX=yg?jd?sb.a.jdj:sb.a.Tch:jd?sb.a.yOf:sb.a.Zze;Re.fbc(Cf);D.a.J(512517918,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}dc=32}).catch(Re=>{D.a.J(512517917,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Re.toString());dc=8})}return dc}catch(dc){return D.a.J(512517916,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",dc.toString()),8}}gLe(Z,
Ka,zb){return Ka in Z?Z[Ka]:zb}Mzh(Z,Ka,zb,dc,Jc){Ka=this.va.Ga;if(!Ka)return D.a.J(512517915,352,50,"Active Slide is null"),8;if(!this.iwb(Ka,Z,this.la.dda))return 8;if(1===zb)return 32;if(!this.kj.zC(Ka,1))return this.kj.dpe(Ka),16;try{const jd=Ka.b8(this.pa.ud());if(jd&&this.uc.Cd(jd))return 16;const Ed=this.ixc(Ka,jd);let de=null;const Ne=this.Mb.Fd(15,void 0,()=>{this.pa.Rw();this.pa.Ti();this.Ma.Wd()},()=>{this.pa.selectShape(Ed,!0);de&&this.pa.selectShape(de,!1)});try{Ne.rc(Ka);Ne.sc=sb.a.insertOnlinePicture;
Ne.XC[Pf.a.S9a]=Pf.a.MQc;zb=null;Z={["actionId"]:Z};if(this.la.N2b)if(Jc.LicenseUrl&&Jc.LicenseDisplayName){const $g=Qb.Jbk(Jc);zb=Rj.c($g);if(this.la.Ncd){const oh=Ka.Xb;de=this.Qk.MSa(!0,oh.cid,oh.sid,0,0,0,Ge.a.c2,Ge.a.F6,Ka.Ju()+1,!1)}}else Z["result.LicenseDisplayName"]=Jc.LicenseDisplayName,Z["result.LicenseUrl"]=Va.a.DV(Jc.LicenseUrl);else Z.IsEnabled=this.la.N2b;D.a.J(512517914,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",Z);const Re=Jc.LicenseUrl?null:Jc.Caption,Cf=this.Fb.getBooleanAppSetting("InsertPictureSizeIncreaseEnabled"),
yg=this.Fb.Xwa("OnlinePictureSlideWidthAdjustmentFactor",0),bh=this.Fb.Xwa("OnlinePictureSlideHeightAdjustmentFactor",0),Ah=Cf&&!jd?Ka.io*yg:0,Ui=Cf&&!jd?Ka.ek*bh:0;D.a.J(508077772,352,50,`InsertMediaActor::UploadOnlinePicture:
          boundsWidth = ${Ah}, and boundsHeight: ${Ui},
          slideNode.renderedWidth = ${Ka.io}, and slideNode.renderedHeight: ${Ka.ek}`);Ed.ene(Jc.OriginalUrl,Re,zb,Jc.PageUrl,Ah,Ui);jd&&Ka.i_([jd]);Ka.pI(Ed);de&&(Ka.pI(de),Ed.szb=de.id,de.EAb=!0)}finally{Ne&&Ne.dispose()}this.yv.zI=Ed;return 32}catch(jd){return D.a.J(512517913,352,10,"InsertMediaActor::UploadOnlinePicture : Exception = [{0}].",jd.toString()),8}}Xch(Z,Ka,zb,dc,Jc){Ka=this.va.Ga;if(!Ka)return D.a.J(512517912,352,50,"Active Slide is null"),8;if(!this.iwb(Ka,Z,this.la.kPa))return 8;
if(1===zb)return 32;D.a.J(512517910,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Start changing.");if(!Jc)return 16;try{const jd=this.BHd()||this.thh();this.Bfh(jd);if(!jd||this.uc.Cd(jd))return 16;let Ed=null;const de=this.Mb.Fd(15,void 0,void 0,()=>{this.pa.selectShape(jd,!0);Ed&&this.pa.selectShape(Ed,!1);D.a.J(512517908,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Finish changing.")});try{de.rc(Ka);de.sc=sb.a.bpc;de.XC[Pf.a.S9a]=Pf.a.MQc;Z=null;if(this.la.N2b&&
Jc.LicenseUrl&&Jc.LicenseDisplayName){const Ne=Qb.Jbk(Jc);Z=Rj.c(Ne);if(this.la.Ncd){const Re=Ka.Xb;Ed=this.Qk.MSa(!0,Re.cid,Re.sid,0,0,0,Ge.a.c2,Ge.a.F6,Ka.Ju()+1,!1);D.a.J(512517907,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Adding license info to attributionShapeNode.")}}jd.ene(Jc.OriginalUrl,Jc.LicenseUrl?null:Jc.Caption,Z,Jc.PageUrl);jd.set_isSVGBlipFilled(!1);Ed&&(Ka.pI(Ed),jd.szb=Ed.id,Ed.EAb=!0)}finally{de&&de.dispose()}this.yv.zI=jd;return 32}catch(jd){return D.a.J(512517905,
352,10,"InsertMediaActor::changeToOnlinePictureSingleImage : Exception = [{0}].",jd.toString()),8}}Wch(Z,Ka,zb,dc,Jc){Ka=this.va.Ga;if(!Ka)return D.a.J(512517911,352,50,"Active Slide is null"),8;if(!this.iwb(Ka,Z,this.la.kPa))return 8;if(1===zb)return 32;D.a.J(512517909,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");if(!Jc)return 16;try{var jd=this.pa.ud();Z=[];for(var Ed of jd)Ed.Ce||Z.push(Ed);for(const Ne of Z)if(this.Bfh(Ne),!Ne||this.uc.Cd(Ne))return 16;jd=null;const de=
this.Mb.Fd(15,void 0,void 0);try{de.rc(Ka);de.sc=sb.a.bpc;de.XC[Pf.a.S9a]=Pf.a.MQc;Ed=null;if(this.la.N2b&&Jc.LicenseUrl&&Jc.LicenseDisplayName){const Re=Qb.Jbk(Jc);Ed=Rj.c(Re);if(this.la.Ncd){const Cf=Ka.Xb;jd=this.Qk.MSa(!0,Cf.cid,Cf.sid,0,0,0,Ge.a.c2,Ge.a.F6,Ka.Ju()+1,!1);D.a.J(512517906,352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}const Ne=Jc.LicenseUrl?null:Jc.Caption;for(const Re of Z)Re.ene(Jc.OriginalUrl,Ne,Ed,Jc.PageUrl),Re.set_isSVGBlipFilled(!1),
jd&&(Ka.pI(jd),Re.szb=jd.id,jd.EAb=!0)}finally{de&&de.dispose()}this.yv.zI=Z[0];return 32}catch(de){return D.a.J(512517904,352,10,"InsertMediaActor::ChangeToOnlinePicture : Exception = [{0}].",de.toString()),8}}TYn(Z,Ka,zb,dc,Jc){const jd=this.va.Ga;if(!jd)return D.a.J(512517903,352,50,"Active Slide is null"),8;if(!this.iwb(jd,Z,this.la.URb))return 8;if(1===zb)return 32;D.a.J(512517902,352,50,"InsertMediaActor::UploadIcon : Start inserting.");if(!Jc||!Jc.length)return 16;if(!this.kj.zC(jd,Jc.length))return this.kj.dpe(jd),
16;try{let Ed=null,de=null;if(!(()=>{let Re=this.CRm(Jc,jd);({qvn:de,lvn:Ed}=Re);return Re})().returnValue)return 16;const Ne=this.Mb.Fd(15,void 0,()=>{this.pa.Rw();this.pa.Ti();this.Ma.Wd()},()=>{this.pa.zka(Ed,!0)});try{for(Ne.rc(jd),Ne.sc=Z,Ne.XC[Pf.a.S9a]=Pf.a.icon,de&&jd.i_(de),Z=0;Z<Ed.length;Z++)jd.pI(Ed[Z])}finally{Ne&&Ne.dispose()}this.yv.zI=Ed[Ed.length-1];return 32}catch(Ed){return D.a.J(512517901,352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",Jc.length,
Ed.toString()),8}}CRm(Z,Ka){const zb=Array(Z.length),dc=Array(Z.length);var Jc=Ka.uGd(this.pa.ud());if(Jc&&0<Jc.length){var jd=0;for(const Ed of Jc)if(Ed&&!this.uc.Cd(Ed)&&jd<Z.length&&(zb[jd]=Ed,jd++,jd===Z.length))break}Jc=!0;for(jd=0;jd<zb.length;jd++)this.la.Zbb&&Z[jd].SvgContent&&0<Z[jd].SvgContent.length&&(!zb[jd]||zb[jd]&&15!==zb[jd].placeholderType)?dc[jd]=this.ARm(Ka,zb[jd],Z[jd],jd):(dc[jd]=this.dih(Ka,zb[jd],Z[jd],!0,jd),Jc=!1),Jc&&Og.a.SP(!0,!0),dc[jd].ene(Z[jd].OriginalUrl,Z[jd].Caption,
null,null);return{returnValue:!0,qvn:zb,lvn:dc}}ARm(Z,Ka,zb,dc){if(!Z)return null;var Jc=Z.Xb,jd=Z.Ju();Z=Object(v.a)(278,Z.tc(this.xb.Oa));const {Cwf:Ed,MR:de}=this.UWb.Dkf(Ka,zb.Width,zb.Height,Z.WK,void 0,void 0,void 0);dc=Ka?0:dc*Fk.a.pJ;Jc=this.Qk.MSa(!0,Jc.cid,Jc.sid,0,de.x+dc,de.y+dc,Ed.width,Ed.height,jd+1,!1);jd=this.UWb.qef(this.xb.yd,Ed,de,Z.WK);Jc.bV=jd;Jc.isResizable=!0;Jc.LBc=!0;Jc.OJ=!0;Jc.Yha=!0;Jc.set_isSVGBlipFilled(!0);zb=this.Jag.F0l(zb.SvgContent);Jc.cka=zb?String.format("data:image/svg+xml;charset=utf8,{0}",
encodeURIComponent(zb)):"";Ka&&(Jc.msa=Ka.id);return Jc}Bfh(Z){rb.a("ExitCropAfterReplaceImageChange")&&Z&&Z.Ww&&(Z=Z.tc(this.xb.Oa))&&Z.pW(!1)}Rwm(Z,Ka,zb,dc,Jc){Ka=this.va.Ga;if(!Ka)return D.a.J(512517900,352,50,"Active Slide is null"),8;if(!this.iwb(Ka,Z,this.la.zSc))return 8;if(1===zb)return 32;D.a.J(512517898,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!Jc||!Jc.length)return 16;try{const jd=this.pa.ud(),Ed=[];for(const Re of jd)Re.Ce||Ed.push(Re);const de=Jc[0].Caption;for(const Re of Ed){this.Bfh(Re);
if(!Ed||this.uc.Cd(Re))return 16;const Cf=this.Ia.ev(Re);de&&Cf&&this.Ad.cgk(new Q(Ka.Xb,Re.get_shapeId(),Re.get_smartArtModelId(),de))}const Ne=this.Mb.Fd(15,void 0,void 0,()=>{for(const Re of Ed){const Cf=this.Ia.ev(Re);Cf&&(this.Ad.mHg(Sys.EventArgs.Empty),this.pa.selectShape(Cf,!0),this.Ad.lHg(Sys.EventArgs.Empty))}D.a.J(512517896,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")});try{Ne.rc(Ed[0]);Ne.sc=Z;Ne.XC[Pf.a.S9a]=Pf.a.icon;for(const Re of Ed)Re.set_isSVGBlipFilled(!0),Re.ene(Jc[0].OriginalUrl,
de,null,null)}finally{Ne&&Ne.dispose()}for(const Re of Ed)this.uc.ggb(Ka,Re,this.xb.Oa,Z);return 32}catch(jd){return D.a.J(512517894,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",Jc.length,jd.toString()),8}}Swm(Z,Ka,zb,dc,Jc){Ka=this.va.Ga;if(!Ka)return D.a.J(512517899,352,50,"Active Slide is null"),8;if(!this.iwb(Ka,Z,this.la.zSc))return 8;if(1===zb)return 32;D.a.J(512517897,352,50,"InsertMediaActor::changeToIconSingleIcon : Start changing.");if(!Jc||!Jc.length)return 16;
try{const jd=this.thh()||this.BHd();this.Bfh(jd);if(!jd||this.uc.Cd(jd))return 16;const Ed=Jc[0].Caption,de=this.Ia.ev(jd);Ed&&de&&this.Ad.cgk(new Q(Ka.Xb,jd.get_shapeId(),jd.get_smartArtModelId(),Ed));const Ne=this.Mb.Fd(15,void 0,void 0,()=>{de&&(this.Ad.mHg(Sys.EventArgs.Empty),this.pa.selectShape(de,!0),this.Ad.lHg(Sys.EventArgs.Empty));D.a.J(512517895,352,50,"InsertMediaActor::changeToIconSingleIcon : Finish changing.")});try{Ne.rc(jd),Ne.sc=Z,Ne.XC[Pf.a.S9a]=Pf.a.icon,jd.set_isSVGBlipFilled(!0),
jd.ene(Jc[0].OriginalUrl,Ed,null,null)}finally{Ne&&Ne.dispose()}(zb=de||jd)&&this.uc.ggb(Ka,zb,this.xb.Oa,Z);return 32}catch(jd){return D.a.J(512517893,352,10,"InsertMediaActor::changeToIconSingleIcon : icon count = [{0}], Exception = [{1}].",Jc.length,jd.toString()),8}}thh(){let Z=null;const Ka=this.pa.ud();for(const zb of Ka)if(zb&&zb.get_isSVGBlipFilled()&&(!this.Gz||!zb.HA))if(Z)break;else Z=zb;return Z}BHd(){if(this.z3){const Z=this.pa.ud();return Z&&Z.length?this.J5h(Z)?Z[0]:this.CCe():null}return this.CCe()}J5h(Z){return null===
Z||void 0===Z?void 0:Z.filter(Ka=>!!Ka).every(Ka=>this.hTf(Ka)||1===Ka.mediaType)}CCe(){const Z=this.pa.ud();for(const Ka of Z)if(Ka&&this.hTf(Ka))return Ka;return null}hTf(Z){return Z.Kg&&!(this.Gz&&Z.HA)}QFl(Z,Ka){const zb=this.Fb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");"defaultModal"!==zb&&D.a.J(Z,352,15,`${Ka}::Modal:${zb}`)}c7b(Z,Ka,zb){if(!this.iwb(this.va.Ga,Z,this.la.oBa))return 8;if(1===zb)return 32;this.QHe=Og.a.Fk("ShowInsertVideoDialog",
1);const dc=this.Fb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");try{if(this.la.bSb){D.a.J(512517890,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");const jd=Di.a.create(),Ed=Va.a.DV(this.la.lPa).toString();let de;const Ne=this.Cag&&this.la.getBooleanAppSetting("InsertStream2FlowEnabled")&&this.la.FCc;Ne&&(de=l.a.instance.resolve("Common.App.OAuth.IOAuthManager"));D.a.J(508822735,352,50,"InsertMediaActor::ShowInsertVideoDialog : Licensing enabled for user: {0} with correlationId: {1}",
this.Cag,jd);this.iab.execute(Re=>{Re=this.LGe.getInstance(this.Loa.Jum(Lf.App.mode,this.la.bBl,jd.toString(),Ed,Ne,dc),this.KGe,this.Loa,Re,Nh.Bl);Re.correlationId=jd;Re.orb=5;const Cf=new Hk(this.ia,this.Loa,this.la);Cf.LX=sb.a.i9c;Re.bpe(CommonUIStrings.L_VideoInsertTitle,Cf,de)})}else this.la.sEe?(D.a.J(512517889,352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new Uh(this.TTa)).nwb()):(D.a.J(512517888,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),
this.iab.execute(jd=>{this.LGe.getInstance(this.Loa.Kum(Lf.App.mode,this.la.tEe),this.KGe,this.Loa,jd,Sh.Bl).bpe(CommonUIStrings.L_VideoInsertTitle,new Hk(this.ia,this.Loa,this.la),void 0)}));this.QFl(512557208,"ShowInsertOnlineVideoDialog");null!=this.QHe&&Object(xa.a)(this.QHe.actionName,(new Date).getTime()-this.QHe.Lx.getTime(),"InsertOnlineVideoDialog",this.QHe.actionId,this.QHe.Xi);const Jc=this.Fb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");
rb.a("LogInsertOnlineVideoCustomToolTip")&&"InsertOnlineVideo"!==Jc&&D.a.J(512517859,352,15,"InsertOnlineVideo::ToolTipMessage : "+Jc);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.Fb.uuc){const jd=this.Fb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",!1)?"Visible":"NotVisible";D.a.J(512517858,352,15,"InsertOnlineVideo::SocialMediaIconIs"+jd)}D.a.J(512517857,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(Jc){return D.a.J(512517856,
352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",Jc.toString()),Qb.QE(nh.a.jCe,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlineVideo),8}}XYn(Z,Ka,zb,dc,Jc){Ka=this.va.Ga;if(!Ka)return D.a.J(512517853,352,50,"Active Slide is null"),8;if(!this.iwb(Ka,Z,this.la.oBa))return 8;if(1===zb)return 32;if(!this.kj.zC(Ka,1))return this.kj.dI(Ka),16;try{const jd=Ka.b8(this.pa.ud());if(jd&&this.uc.Cd(jd))return 16;const Ed=this.ixc(Ka,jd),de=this.Loa.bVm(Jc.OriginalUrl);
Ed.fRg(de,Jc.ThumbnailUrl,Jc.Caption,Jc.Description,0<Jc.Width?Jc.Width:0,0<Jc.Height?Jc.Height:0);const Ne=this.Mb.Fd(15,void 0,()=>{this.pa.Rw();this.pa.Ti();this.Ma.Wd()},()=>{this.pa.selectShape(Ed,!0)});try{Ne.rc(Ka),Ne.sc=Z,jd&&Ka.i_([jd]),Ka.pI(Ed)}finally{Ne&&Ne.dispose()}D.a.J(512517852,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done.");this.yv.zI=Ed;return 32}catch(jd){return D.a.J(512517851,352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",jd.toString()),
8}}WYn(Z,Ka,zb,dc,Jc){Ka=this.va.Ga;if(!Ka)return D.a.J(512517850,352,50,"Active Slide is null"),8;if(!this.iwb(Ka,Z,this.la.bSb))return 8;if(1===zb)return 32;D.a.J(512517849,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");if(!this.kj.zC(Ka,1))return this.kj.dI(Ka),16;try{const jd=Ka.b8(this.pa.ud());if(jd&&this.uc.Cd(jd))return 16;const Ed=this.ixc(Ka,jd);(this.la.getBooleanAppSetting(ob.a.iyb)||this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.VideoLoadingExperience",
!1))&&Ed.setValue(Yb.a.rq,!0);const de=0<Jc.Width?Jc.Width:0,Ne=0<Jc.Height?Jc.Height:0;let Re=Jc.PageUrl;this.la.FCc&&"odspbusiness"===Jc.ProviderName.toLocaleLowerCase()&&(Re=Jc.OriginalUrl);Ed.fRg(Re,Jc.ThumbnailUrl,Jc.Caption,Jc.Description,de,Ne);const Cf=this.Mb.Fd(15,void 0,()=>{this.pa.Rw();this.pa.Ti();this.Ma.Wd()},()=>{this.pa.selectShape(Ed,!0)});try{Cf.rc(Ka),Cf.sc=Z,jd&&Ka.i_([jd]),Ka.pI(Ed)}finally{Cf&&Cf.dispose()}this.QFl(512557200,"InsertOnlineHubbleVideo");D.a.J(512517848,352,50,
"InsertMediaActor::UploadOnlineVideo : Inserting online video is done in {0} ms.",Date.now()-Jc.StartInsertTime);this.yv.zI=Ed;return 32}catch(jd){return D.a.J(512517847,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",jd.toString()),8}}iwb(Z,Ka,zb){Z=!!Z&&zb&&!this.uc.Cd(Z);switch(Ka){case sb.a.hLb:return Z&&(!!this.BHd()||!!this.thh());case sb.a.C5c:case sb.a.D5c:case sb.a.G5c:case sb.a.C$b:return Z&&this.ixm();default:return Z}}ixm(){const Z=this.BHd()||this.thh();return!Z||
this.la.xJ&&Z.HA?!1:this.Ia.ev(Z)?!1:!0}ixc(Z,Ka){return this.dih(Z,Ka,null,!1,0)}dih(Z,Ka,zb,dc,Jc){if(!Z)return null;var jd=Z.Xb;Z=Z.Ju();let Ed;dc?{width:zb,height:Ed}=Qb.XTm(Ka,zb):(zb=Ge.a.c2,Ed=Ge.a.F6);let de;de=Ka?Ka.SPb(zb,Ed):this.Ub.Nja(zb,Ed);Jc=Ka?0:Jc*Fk.a.pJ;jd=this.Qk.MSa(!0,jd.cid,jd.sid,0,de.x+Jc,de.y+Jc,zb,Ed,Z+1,!0);jd.set_isSVGBlipFilled(dc);Ka&&(jd.msa=Ka.id);return jd}dispose(){this.iab.instance&&(this.cYb&&this.iab.instance.M4b("MsoPremiumStockImages",this.cYb),this.nMl&&this.iab.instance.M4b("OmgStreamTwo",
this.nMl));this.Akh&&this.g5d.kEd.contentWindow&&(Tc.a.removeHandler(this.g5d.kEd.contentWindow,"message",Object(e.a)(this,this.c5l,"showOneDriveFilePickerDialog")),this.Akh=!1)}static gvm(){const Z=CommonUIStrings.l_AttributionText.split(/[{}]+/);return Ag.e(Z,Ka=>!!Ka)}static Gum(Z,Ka){const zb=document.createElement("body");var dc="";let Jc="",jd=CommonUIStrings.L_CCYYSA;void 0!==Ka&&null!==Ka&&(void 0!==Ka.PageUrl&&null!==Ka.PageUrl&&(dc=Ka.PageUrl),void 0!==Ka.LicenseDisplayName&&null!==Ka.LicenseDisplayName&&
0<Ka.LicenseDisplayName.length&&(jd=Ka.LicenseDisplayName),void 0!==Ka.LicenseUrl&&null!==Ka.LicenseUrl&&(Jc=Ka.LicenseUrl));for(const Ed of Z){switch(Ed){case "L_ThePhoto":Z=Qb.Xhl(CommonUIStrings.l_ThePhoto,dc);break;case "L_CCYYSA":Z=Qb.Xhl(jd,Jc);break;case "L_PhotoAuthor":Z=Qb.gil(CommonUIStrings.l_PhotoAuthor);break;default:Z=Qb.gil(Ed)}Z&&zb.appendChild(Z)}dc=document.createElement("html");dc.appendChild(zb);return dc}static gil(Z){const Ka=document.createElement("span");Ka.innerText=Z;return Ka}static Xhl(Z,
Ka){const zb=document.createElement("A");zb.setAttribute("href",Ka);zb.setAttribute("target","_blank");zb.setAttribute("rel","noreferrer");Ka=document.createElement("span");Ka.innerText=Z;zb.appendChild(Ka);return zb}static Jbk(Z){const Ka=Qb.gvm();return Qb.Gum(Ka,Z)}static QE(){}static XTm(Z,Ka){let zb;Z&&15===Z.placeholderType?(zb=mh.a.ke(Z.yve,0,!1),Z=mh.a.ke(Z.AMd,0,!1)):Ka&&0<Ka.Width&&0<Ka.Height?(zb=Ka.Width,Z=Ka.Height):(zb=mh.a.ke(2,0,!1),Z=mh.a.ke(2,0,!1));return{width:zb,height:Z}}}Qb.Wyl=
!1;Object(c.a)(Qb,"InsertMediaActor",null,[743]);var mc=a(1221);class yc{}yc.pUn=864E5;yc.Zqm=3;yc.Fnn=144E5;Object(c.a)(yc,"AddinConstantsNum",null,[]);var Sc=a(413),wd=a(896),zd=a(895);class Pd{constructor(Z,Ka,zb,dc){this.ga=(dc=void 0===dc?null:dc)?dc:h.AFrameworkApplication.ga;this.AKh=2;this.ENd=Z;this.gnm=Ka;this.IB=zb}get wzc(){return this.AKh}get vZn(){return this.gnm}Zsk(Z){if(this.ga.getBooleanAppSetting("AgaveSupportsLiveIdSpoofing"))this.ENd(Z,this.wzc,{["ak0"]:(new Date).getTime()});
else if(zd.a.q4l(Z)){var Ka=String.format(h.AFrameworkApplication.Ea.Kb.f2+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",h.AFrameworkApplication.Ea.Kb.Im,this.vZn,h.AFrameworkApplication.ui);const zb=h.AFrameworkApplication.ye;let dc=null;this.IB&&(dc=this.IB.wl("ComponentAttach",wd.a[Z]+mc.a[this.wzc]));zb.rk(Ka,1,null,null,!0,4,Jc=>{this.Ssn(Z,Jc.data.responseData);dc&&dc.stop()},Jc=>{f.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Jc.data.Ze);
this.NIe(Z,1,"request failed");dc&&dc.stop()},null)}else zd.a.q6i(Z)?(Ka=zd.a.vIi(Z),this.ENd(Z,this.wzc,{["ak0"]:Ka})):this.ga.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(this.jna?this.NIe(Z,1,"no local timestamp"):this.ENd(Z,this.wzc,null))}Ssn(Z,Ka){if(Ka&&""!==Ka)if(Ka=Sys.Net.XMLDOM(Ka)){zd.a.s0c(Sc.a.lbh,((new Date).getTime()+yc.Fnn).toString(),Z);let zb=Ka.getElementsByTagName("update");zb&&zb.length||(zb=Ka.getElementsByTagName("o:update"));zb&&0<zb.length?
(Ka=Date.parse(zb[0].firstChild.nodeValue),zd.a.vIi(Z)<Ka||zd.a.q6i(Z)?this.ENd(Z,this.wzc,{["ak0"]:Ka}):this.NIe(Z,1,"outdate timestamp in reponse")):this.NIe(Z,2,"no timestamp in response")}else this.NIe(Z,1,"response data is invalid");else this.NIe(Z,1,"no responseData")}NIe(Z,Ka,zb){this.jna&&this.ENd(Z,this.wzc,{["AddinServiceUserState"]:Ka,["DiagnosticInfo"]:zb})}get jna(){return this.ga.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.ga.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}
Object(c.a)(Pd,"AddinCommandsAnonymousAPIInitializer",null,[246]);class Je{constructor(Z,Ka,zb){this.AKh=zb;this.ENd=Z;this.Un=Ka}get wzc(){return this.AKh}Zsk(Z){let Ka=null;this.Un&&(Ka=this.Un.wl("ComponentAttach",wd.a[Z]+mc.a[this.wzc]));(null==this.yGk(Z)?0:this.yGk(Z))&&this.ENd(Z,this.wzc,{["ak0"]:(new Date).getTime()-yc.Zqm*yc.pUn});Ka&&Ka.stop()}}Object(c.a)(Je,"AddinCommandsInitializerBase",null,[246]);class ge extends Je{constructor(Z,Ka){super(Z,Ka,5)}yGk(){return!0}}Object(c.a)(ge,"AddinCommandsInitializer",
Je,[]);class tb extends Je{constructor(Z,Ka){super(Z,Ka,1)}yGk(Z){try{const Ka=Sc.a.MCf()+Z;return Boolean.parse(this.zMm(Ka)||"false")}catch(Ka){f.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",Ka.toString())}return null}zMm(Z){const Ka=localStorage;return void 0!==Ka&&null!==Ka?Ka.getItem(Z):null}}Object(c.a)(tb,"AddinCommandsLocalCacheInitializer",Je,[]);class Kc{constructor(Z,Ka){Ka=void 0===Ka?null:Ka;this.IB=Z;this.ga=Ka?Ka:h.AFrameworkApplication.ga}get appUILocale(){return fj.a.Ne(h.AFrameworkApplication.lcid).name}N1m(){const Z=
this.cJi();if(Z)if(this.ga.getBooleanAppSetting("OcpsIsEnabled"))l.a.instance.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ka=>{Ka.isFeatureEnabled("ConnectedServices",!0).then(zb=>{for(const dc of Z){if(!zb&&0===dc.key){this.jna&&this.f8l(0,dc.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const Jc=this.gtl(dc.value);Jc&&Jc.Zsk(dc.key)}return null})});else for(const Ka of Z){const zb=this.gtl(Ka.value);zb&&zb.Zsk(Ka.key)}}$sk(Z,
Ka,zb){zb&&zb[Sc.a.P4c]?(zb[Sc.a.izb]=Z,zb[Sc.a.k9a]=Ka,this.Jck(w.a.$Le,zb),zd.a.s0c(Sc.a.P4c,zb[Sc.a.P4c].toString(),Z)):this.jna?this.f8l(Z,Ka,zb):this.ga.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&0===Z&&(zb={},zb[Sc.a.izb]=Z,zb[Sc.a.k9a]=Ka,this.Jck(w.a.tka,zb))}gtl(Z){let Ka=null;switch(Z){case 1:Ka=new tb(Object(e.a)(this,this.$sk,"retrieveAddinFlagCompleted"),this.IB);break;case 2:Ka=new Pd(Object(e.a)(this,this.$sk,"retrieveAddinFlagCompleted"),this.appUILocale,
this.IB,this.ga);break;case 5:Ka=new ge(Object(e.a)(this,this.$sk,"retrieveAddinFlagCompleted"),this.IB)}return Ka}f8l(Z,Ka,zb){0===Z&&zb&&zb[Sc.a.Naf]&&(zb[Sc.a.izb]=Z,zb[Sc.a.k9a]=Ka,f.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",zb[Sc.a.Naf].toString(),JSON.stringify(zb)),this.Jck(w.a.tka,zb))}get jna(){return this.ga.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.ga.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}
Object(c.a)(Kc,"AddinCommandsInitializerHost",null,[]);var ad=a(1340),id=a(284),ud=a(175);class ke extends Kc{constructor(Z,Ka){super(Z.nih());this.EE=Z;this.Fb=Ka;ad.a.Uyc=ad.a.m9j}TVn(){this.N1m()}cJi(){const Z=new ud.a;this.Fb.getBooleanAppSetting(id.a.T4c)&&(Z.K(0,2),Z.K(16,5));this.Fb.getBooleanAppSetting(id.a.Tcj)&&Z.K(1,1);this.EE.Md.m0a&&Z.K(8,1);this.Fb.getBooleanAppSetting(id.a.a5c)&&Z.K(10,5);return Z}Jck(Z,Ka){this.EE.eS().Qa(Z,2,Ka)}}Object(c.a)(ke,"AddinCommandsInitService",Kc,[1524]);
class of{constructor(){this.$=null}get name(){return"PowerPointWebEditor.AddinCommands"}lc(Z){this.$=Z;l.a.instance.register(ke,"PowerPointWebEditor.AddinCommandsInitService").as("PowerPointWebEditor.IAddinCommandsInitService").na(()=>new ke(this.$.resolve("PowerPointWebEditor.IApplicationContext"),this.$.resolve("Common.IAppSettingsManager"))).ma()}init(){this.$.resolve("PowerPointWebEditor.IApplicationSettings").ekh&&this.$.resolve("Common.IAppSettingsManager").fg(()=>{l.a.instance.resolve("PowerPointWebEditor.IAddinCommandsInitService").TVn()})}dispose(){}}
Object(c.a)(of,"AddInCommandsInitPackage",null,[3,4]);class Yf extends lb{constructor(Z,Ka,zb,dc){super(Z,!0,void 0===Ka?null:Ka,!1,void 0,void 0===zb?null:zb,void 0===dc?!1:dc)}get z9i(){return null}get n0b(){return this.AQf?Object(ta.a)("DownloadAsPdfDialog_CopyALinkText"):this.jRf?Object(ta.a)("DownloadAsPdfDialog_EmailALinkText"):h.AFrameworkApplication.U$b?Object(ta.a)("DownLoadACopyDialogMessage"):Object(ta.a)("PrintDialogDocumentIsPrinting")}get IFe(){return Object(ta.a)("DownloadAsPdfDialogLinkSuggestion")}get buttonText(){return Object(ta.a)("Download")}get mbh(){return null}get AQf(){return"VersionHistory"===
this.Sil||1===h.AFrameworkApplication.Ea.mode||this.Aql?!1:1==h.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfShareLinkState",0)}get jRf(){return"VersionHistory"===this.Sil||1===h.AFrameworkApplication.Ea.mode||this.Aql?!1:2==h.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfShareLinkState",0)}NFe(){f.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");Ng.a.BI("tshrepdf;tshrepdf2;cshrepdf")}}Object(c.a)(Yf,
"DownloadAsPdfDialog",lb,[]);class If extends Yf{constructor(Z){super(Z)}get n0b(){return h.AFrameworkApplication.U$b?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}NFe(){D.a.J(507905935,801,50,"Images download dialog displayed")}zYf(){D.a.J(507905934,801,50,"Images download dialog link clicked")}nWd(){D.a.J(507905933,801,50,"Images download dialog button clicked")}}Object(c.a)(If,"DownloadACopyAsImagesDialog",Yf,[]);var Jf=a(395);class Th extends X{constructor(Z){super(Z,
void 0,h.AFrameworkApplication.U$b)}get n0b(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady}get IFe(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion}get wXf(){return"DownloadOdpLink"}get buttonText(){return ResourceStrings.L_Download}get kof(){return h.AFrameworkApplication.U$b?"UIFontDialogTextLarge":null}NFe(){D.a.J(8958087,801,50,"ODP download dialog displayed")}zYf(){D.a.J(8958089,801,50,"ODP download dialog link clicked")}nWd(){D.a.J(19505496,801,50,"ODP download dialog button clicked")}Nlh(){Jf.a.showHelp("PPTODF");
return!0}get lXf(){return h.AFrameworkApplication.ga&&h.AFrameworkApplication.ga.getBooleanAppSetting("EnableReactDialogs")&&rb.a("ReactDialogsODPDialogFix")?null:"#"}get Gbc(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText}get DNl(){return!h.AFrameworkApplication.U$b}}Object(c.a)(Th,"DownloadACopyAsOdpDialog",X,[]);class yh extends Yf{constructor(Z){super(Z)}get n0b(){return h.AFrameworkApplication.U$b?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}NFe(){D.a.J(507905941,
801,50,"PDF download dialog displayed")}zYf(){D.a.J(507905940,801,50,"PDF download dialog link clicked")}nWd(){D.a.J(507905939,801,50,"PDF download dialog button clicked")}}Object(c.a)(yh,"DownloadACopyAsPdfDialog",Yf,[]);var yi=a(1473),Xi=a(671);class Fh extends Xi.a{constructor(Z,Ka,zb){super();this.Wca=null;this.$mh=0;this.ee=this.DKl=null;this.Fdn=Z;this.Gbn=Ka;this.wan=zb;this.Urb=Object(e.a)(this,this.abb,"onRequestComplete");this.onError=Object(e.a)(this,this.Irn,"onRequestError")}get Ozg(){return this.DKl}set Ozg(Z){this.DKl=
Z}get pq(){return this.ee}set pq(Z){this.ee=Z}start(){this.d7b()}d7b(){1!==h.AFrameworkApplication.Ea.state&&(this.Wca=new yi.a,this.Wca.zz=!1,this.Wca.gf=5,this.Wca.message=this.Fdn,this.Wca.uCa(ResourceStrings.l_GenericDialogTitle,null,null),this.$mh=0)}RV(){this.Wca&&(this.Wca.close(),this.Wca=null)}abb(Z){this.RV();Z.nfa?this.Ozg(Z):this.CUa()}Irn(Z){Z.Zql&&this.$mh<Fh.OIn?(this.$mh+=1,Z.start()):this.CUa()}CUa(){this.RV();if(1!==h.AFrameworkApplication.Ea.state){const Z=new va.a;Z.gf=0;Z.ZF(this.wan,
ResourceStrings.l_GenericDialogTitle,this.Gbn,this.pq)}}}Fh.OIn=3;Object(c.a)(Fh,"UIBlockingTask",Xi.a,[]);var Gi=a(470);class Bj extends Fh{constructor(Z){super(ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,nh.a.KOl);this.fK=Z}start(){super.start();Gi.a.Jll(this.fK,Object(e.a)(this,this.Axa,"handleWebserviceResponse"),Object(e.a)(this,this.zxa,"handleWebserviceError"))}}Object(c.a)(Bj,"ConvertToOdpTask",Fh,[]);class ck extends Fh{constructor(Z){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.l_ConvertingToPdfErrorString,nh.a.vTl);this.fK=Z}start(){super.start();Gi.a.Kll(this.fK,Object(e.a)(this,this.Axa,"handleWebserviceResponse"),Object(e.a)(this,this.zxa,"handleWebserviceError"))}}Object(c.a)(ck,"ConvertToPdfTask",Fh,[]);class Ph{constructor(Z,Ka,zb){this.gnh=Z;this.tg=Ka;this.fEj=zb}get fBe(){return this.gnh.value}convert(Z,Ka,zb){let dc=null;0===Ka?this.fEj?new Th(zb):(dc=new Bj(Z),dc.Ozg=Object(e.a)(this,this.Yon,"onConvertOdpRequestSucceeded"),dc.start()):1===Ka?
this.tg.Md.Djj&&this.fEj?new yh(zb):Og.a.yJ(Og.a.Ab,()=>{dc=new ck(Z);dc.Ozg=Object(e.a)(this,this.Zon,"onConvertPdfRequestSucceeded");dc.start()}):2===Ka?this.tg.Md.Ykh&&this.fEj&&new If(zb):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",Ka))}Yon(Z){Z=Z.result;1!==h.AFrameworkApplication.Ea.state&&(Z=Rc.a.XJa(Z.PrintUrl),new Th(Z))}Zon(Z){Z=Z.result;1!==h.AFrameworkApplication.Ea.state&&(Z=Rc.a.XJa(Z.PrintUrl),this.fBe.Gll=new Date,new yh(Z),this.fBe.eol=new Date,
D.a.J(21050908,801,50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.fBe.Sol.toString(),this.fBe.O0l.toString(),this.fBe.Gll.toString(),this.fBe.eol.toString()))}}Object(c.a)(Ph,"Converter",null,[1528]);class qj{constructor(){this.Sol=this.O0l=this.Gll=this.eol=Lf.App.ep}}Object(c.a)(qj,"DownloadACopyAsPdfContext",null,[]);class Ik extends Fh{constructor(Z,Ka){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.L_PrintingErrorString,nh.a.HVl);this.fK=Z;this.$en=Ka}start(){super.start();Gi.a.print(this.fK,this.$en,Object(e.a)(this,this.Axa,"handleWebserviceResponse"),Object(e.a)(this,this.zxa,"handleWebserviceError"))}}Object(c.a)(Ik,"PrintTask",Fh,[]);class kk{constructor(Z,Ka,zb){if(!Z)throw Error.argumentNull("directPrintManager");this.V2f=Z;this.tg=Ka;this.Qbn=zb}qrn(Z){this.V2f.PAn();Z=Z.result;1!==h.AFrameworkApplication.Ea.state&&(Z=Rc.a.XJa(Z.PrintUrl),this.V2f.f5l(Z))}print(Z,Ka,
zb){this.tg.Md.Djj&&this.Qbn?(Z=new ic.QueryStringBuilder(Ka),Z.Zi(gj.a.YSl,this.V2f.y4l().toString()),Z.Zi(gj.a.VSl,zb.toString()),this.V2f.f5l(Z.toString())):(zb=new Ik(Z,this.V2f.y4l()),zb.Ozg=Object(e.a)(this,this.qrn,"onPrintRequestSucceeded"),zb.start())}}Object(c.a)(kk,"Printer",null,[1530]);class cj{get name(){return"PowerPointWebEditor.PrintPackage"}lc(){l.a.instance.register(kk,"PowerPointWebEditor.Printer").as("PowerPointWeb.IPrinter").ma().na(()=>new kk(l.a.instance.yb("Common.App.DirectPrint.IDirectPrintManager"),
l.a.instance.yb("PowerPointWebEditor.IApplicationContext"),l.a.instance.yb("PowerPointWebEditor.IApplicationSettings").Rh));l.a.instance.register(Ph,"PowerPointWeb.Converter").as("PowerPointWeb.IConverter").ma().na(()=>new Ph(l.a.instance.ge("PowerPointWebEditor.DownloadACopyAsPdfContext"),l.a.instance.yb("PowerPointWebEditor.IApplicationContext"),l.a.instance.yb("PowerPointWebEditor.IApplicationSettings").Rh));l.a.instance.register(qj,"PowerPointWebEditor.DownloadACopyAsPdfContext").ma().na(()=>
new qj)}init(){}dispose(){}}Object(c.a)(cj,"PrintPackage",null,[3,4]);var Bk=a(1167);class ul extends Oj{constructor(Z,Ka,zb){super(Z,Ka);this.la=zb;this.LX=sb.a.apc}fbc(Z){if(Z&&Z.length){var Ka=sb.a.Ov(this.LX),zb=this.M3m(Z[0]);try{D.a.J(512517845,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",Ka,zb?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload");if(32!==(zb?this.Gs.Qa(sb.a.Xze,2,Z):this.Gs.Qa(this.LX,2,Z[0])))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",
zb?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));D.a.J(512517844,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",Ka,zb?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(dc){D.a.J(512517843,352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",Ka,dc.toString())}}}M3m(Z){(Z=!!Z&&!!Z.OriginalUrl&&0<Z.OriginalUrl.length&&this.la.zSc&&!!this.la.z2b&&0<this.la.z2b.length&&0<=Z.OriginalUrl.toLowerCase().indexOf(this.la.z2b.toLowerCase())&&
Z.OriginalUrl.toLowerCase().indexOf(".svg")===Z.OriginalUrl.length-4)||D.a.J(512517842,352,50,"isChangeSvg = false");return Z}}Object(c.a)(ul,"ChangeOnlineImageHelper",Oj,[]);class Ug extends Oj{constructor(Z,Ka,zb){super(Z,Ka);this.qqh=this.VKl=this.FMl=0;this.la=zb;this.LX=sb.a.gbc}fbc(Z){var Ka;if(Z&&Z.length){var zb=sb.a.Ov(this.LX),dc=new Map;dc.set("InsertMediaCommand",zb);eg.Health.instance.recordKpiUsageForAlertableKpi("InsertOnlineImage",null,dc);try{const jd=[],Ed=[],de=[];for(let Re=0;Re<
Z.length;Re++){const Cf=Z[Re];this.BCl(Cf)?Array.add(jd,Cf):this.la.bAc&&this.y7m(Cf)?Array.add(de,Cf):Array.add(Ed,Cf)}this.qqh=this.qqh+Ed.length+jd.length;D.a.J(512517841,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",Ed.length,jd.length,zb);let Ne=this.LX;Ne===sb.a.j9c?Ne=sb.a.oEe:this.la.bAc&&Ne===sb.a.hbc&&(Ne=sb.a.oEe);for(Z=0;Z<Ed.length;Z++){var Jc=this.Gs.Qa(Ne,2,Ed[Z]);if(32!==Jc)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",
Ed.toString(),zb));}if(this.la.bAc&&0<de.length){this.jf||(this.S1l(Og.a.Fk("StockVideos::Insert")),null===(Ka=this.jf)||void 0===Ka?void 0:Ka.Ya("StockVideoInitiatedByRibbon","false"));this.jf&&this.jf.Ya("totalVideosSelected",de.length.toString());const Re=performance.now();for(Ka=0;Ka<de.length;Ka++)if(Jc=this.Gs.Qa(sb.a.hbc,2,de[Ka]),32!==Jc)throw this.Rpl("videosInsertedBeforeFailure",Ka,Re),Error.invalidOperation(String.format("Failed to upload video {0} with command {1}.",de.toString(),zb));
this.Rpl("videosInsertedSuccess",de.length,Re)}if(this.BCl(jd[0])&&(Jc=Ne===sb.a.Nyf?this.Gs.Qa(Ne,2,jd[0]):this.Gs.Qa(sb.a.j9c,2,jd),32!==Jc))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",jd.toString()));D.a.J(512517840,352,15,"InsertMediaCallback: Insert {0} pictures {1} svg images {2} videos success, command: {3}.",Ed.length,jd.length,de.length,zb)}catch(jd){D.a.J(512517839,352,10,"InsertMediaActor::{0}: Exception = [{1}].",this.LX.toString(),jd.toString()),
dc.set("Exception",jd.toString()),eg.Health.instance.recordKpiFailure("InsertOnlineImage","InsertMediaException",!1,!0,{extendedProperties:dc})}}}S1l(Z){this.jf=Z}Rpl(Z,Ka,zb){if(this.jf){const dc=performance.now();this.jf.Ya("VideosInsertionTimeInMilliseconds",(dc-zb).toString());this.jf.Ya(Z,Ka.toString());this.jf.finish();this.jf=null}}BCl(Z){(Z=!!Z&&!!Z.OriginalUrl&&0<Z.OriginalUrl.length&&this.la.URb&&!!this.la.z2b&&0<this.la.z2b.length&&0<=Z.OriginalUrl.toLowerCase().indexOf(this.la.z2b.toLowerCase())&&
Z.OriginalUrl.toLowerCase().indexOf(".svg")===Z.OriginalUrl.length-4)||D.a.J(512517838,352,50,"isInsertSvg = false");return Z}y7m(Z){return!!Z&&!!Z.OriginalUrl&&0<Z.OriginalUrl.length&&Z.OriginalUrl.toLowerCase().indexOf(".mp4")===Z.OriginalUrl.length-4}get tra(){return this.FMl}set tra(Z){this.FMl=Z}get zsb(){return this.udn}set zsb(Z){this.udn=Z}get LCg(){return this.VKl}set LCg(Z){this.VKl=Z}get u_g(){return this.qqh}set u_g(Z){this.qqh=Z}}Object(c.a)(Ug,"InsertOnlineImageHelper",Oj,[]);var cl=
a(898);class Vk{constructor(Z,Ka){this.C2d=!1;this.W3d=new Date(0);this.V3d=new Date(0);this.SNj=Z;this.Tb=Ka}Zxl(){this.C2d=!0}bWc(){this.C2d?D.a.J(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.W3d>this.V3d?D.a.J(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.W3d+". Last scan at "+this.V3d+"."):(this.W3d=new Date,this.Tb.Qb(new H.a(3,
1,0,Object(e.a)(this,this.cuk,"runJob"),90,"112")))}cuk(){this.V3d=new Date;this.C2d?D.a.J(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.SNj()&&this.bWc()}}Object(c.a)(Vk,"PrefetchScheduler",null,[]);class Ni{constructor(Z,Ka,zb){this.Kmh=null;this.MIl=Ka;this.QGl=zb;this.XFe=Z}OKn(Z){this.XFe!==Z&&(this.XFe=Z,this.Kmh=null)}tTm(){this.Kmh||(this.Kmh=this.hwm());return this.Kmh}hwm(){const Z=[];Array.add(Z,this.XFe);for(let Ka=
1;Ka<=this.MIl||Ka<=this.QGl;Ka++)Ka<=this.MIl&&Array.add(Z,this.XFe+Ka),Ka<=this.QGl&&0<=this.XFe-Ka&&Array.add(Z,this.XFe-Ka);return Z}}Object(c.a)(Ni,"SlideWindow",null,[]);class Pi{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de){this.Eqb=!1;this.nc=Jc;this.mr=dc;this.dUa=de;this.ZFe=new cl.a;this.JE=new Vk(Object(e.a)(this,this.RUk,"tryScan"),jd);this.Urg=new Ni(dc&&dc.Ga?dc.Ga.slideIndex:0,Ed?Ed.D6l:10,Ed?Ed.C6l:5);this.hEk(Z,Ka,zb)}start(){this.Eqb?D.a.J(507843731,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):
(D.a.J(507843730,813,100,"StreamVideoPrefetchOrchestrator Starting."),this.Eqb=!0,this.JE.bWc())}hEk(Z,Ka,zb){Z&&Z.aS(Object(e.a)(this,this.Irh,"onEditSlideChanged"));Ka&&Ka.esa(Object(e.a)(this,this.Srh,"onPageContentLoaded"));zb&&zb.$9b(Object(e.a)(this,this.ssn,"onSlideshowSlideChanged"))}Srh(Z,Ka){this.Eqb&&(Z=Object(v.a)(32,Ka.node))&&Z.yC&&(this.ZFe.remove(Z.Xb),this.JE.bWc())}Irh(Z,Ka){Ka&&Ka.I4a&&this.yR(Ka.I4a.slideIndex)}ssn(Z,Ka){Ka&&this.yR(Ka.slideIndex)}yR(Z){this.Urg.OKn(Z);this.Eqb&&
this.JE.bWc()}RUk(){const Z=this.nWi();0<Z.length&&this.Qvk(Z[0]);return 1<Z.length}nWi(){const Z=[];var Ka=this.mr.presentation;if(!Ka)throw Error.argumentNull("Presentation is null");Ka=Ka.slides||[];for(const zb of this.Urg.tTm()){const dc=Ka[zb];this.EOn(dc)&&Array.add(Z,dc)}return Z}EOn(Z){return!!Z&&Z.yC&&!Z.wP&&!this.ZFe.contains(Z.Xb)}Qvk(Z){this.ZFe.add(Z.Xb);Z=this.HTm(Z);0<Z.length&&(D.a.J(507843729,813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",Z.length),this.dUa?
this.dUa.pVl(Z):D.a.J(507843728,813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null."))}HTm(Z){if(!this.nc)return D.a.J(507843727,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),this.JE.Zxl(),[];const Ka=[];if(!Z)return Ka;Z=Object(v.a)(32,Z);if(!Z)return Ka;for(const zb of Z.xj())(Z=zb.Jra)&&this.dUa&&this.dUa.Z$a(Z)&&Array.add(Ka,Z);return Ka}static H5m(Z){return!!Z&&
Z.nlh&&!za.a.lk&&!za.a.obc&&!za.a.Fca&&!za.a.dWf}}Object(c.a)(Pi,"StreamVideoPrefetchOrchestrator",null,[]);class Gj{static addAppPLTEventToLog(Z){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Z)}catch(Ka){}}static setIsPageLoadForFirstTime(Z){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Z)}catch(Ka){}}}Object(c.a)(Gj,"VersionHistoryLogConnector",null,[]);class vk{constructor(Z,Ka,zb,dc){this.mOa=null;this.o_l=this.ResetAppVersionController;
this.hOa=Z;this.Uj=Ka;this.Aa=zb;this.oc=dc;this.ibd={}}OnVersionHistorySelected(Z,Ka){try{D.a.J(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");const zb=document.getElementById("VersionHistoryViewerSpinner");zb&&(zb.style.display="none");if(this.mOa)this.mOa.onVersionSelected(Z,Ka,this.ibd)}catch(zb){D.a.J(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",zb)}}ResetAppVersionController(Z){try{if(this.mOa)Gj.setIsPageLoadForFirstTime(!1),
this.mOa.switchParentViewContainer(Z);else{Gj.setIsPageLoadForFirstTime(!0);const Ka=new PowerPointVersionHistory.AppBootSettings;Ka.RenderServiceBase="";Ka.IsRtl=!1;const zb=new PowerPointVersionHistory.AppCallbackBag;zb.animationDecoratorCallback=Object(e.a)(this.hOa,this.hOa.vmi,"createAnimationOrTransitionStar");zb.notesIconDecoratorCallback=Object(e.a)(this,this.CreateNotesIcon,"CreateNotesIcon");Ka.IsHighContrast=!1;this.Uj&&(Ka.IsHighContrast=this.Uj.isInHighContrastMode);Ka.IsHighContrast&&
(Ka.ClientColorSettings=this.Uj.highContrastColors.foregroundTextColor+"_"+this.Uj.highContrastColors.backgroundColor+"_"+this.Uj.highContrastColors.linkColor);if(this.oc){const dc=this.oc.l_a();Ka.DefaultSlideWidth=dc.width;Ka.DefaultSlideHeight=dc.height}Ka.UserSessionId=h.AFrameworkApplication.userSessionId;Ka.VersionViewerCssUrl=this.Aa.bve;Ka.ProgressImageResourceUrl=qb.a.mX(Ge.a.nUa);this.mOa=new PowerPointVersionHistory.AppVersionController(Ka,Z,zb)}}catch(Ka){D.a.J(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",
Ka)}}CreateNotesIcon(){return ba.a(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,"Notes")}}Object(c.a)(vk,"PPTVersionHistorySelectionHandler",null,[1374]);class Qi extends X{constructor(Z){super(Z,void 0,h.AFrameworkApplication.U$b)}get n0b(){return CommonUIStrings.l_DownLoadACopyDialogMessage}get IFe(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get wXf(){return"PowerPointDownloadCopyLink"}get buttonText(){return CommonUIStrings.l_Download}get kof(){return h.AFrameworkApplication.U$b?
"UIFontDialogTextLarge":null}NFe(){D.a.J(507905890,801,50,"Download a copy dialog displayed")}zYf(){D.a.J(507905889,801,50,"Download a copy dialog clicked")}nWd(){D.a.J(507905888,801,50,"Download a copy dialog button clicked")}}Object(c.a)(Qi,"PowerPointDownloadACopyDialog",X,[]);class Hj{oQn(Z){new Qi(Z)}}Object(c.a)(Hj,"PowerPointDownloadACopyDialogFactory",null,[1313]);var mj=a(69),Xj;(function(Z){Z[Z.OK=0]="OK";Z[Z.cancel=1]="cancel";Z[Z.error=2]="error";Z[Z.open=3]="open"})(Xj||(Xj={}));Object(c.b)("HubbleAction",
Xj);var $h=a(794);const tf={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class yj{constructor(Z){this.B$c=
Z}static rlb(){return Date.now()>yj.C0l}getToken(Z){return Object(mj.b)(this,void 0,void 0,function*(){return yj.rlb()?yield this.refreshToken(Z):yj.nMe})}refreshToken(Z){return Object(mj.b)(this,void 0,void 0,function*(){yj.nMe="";if(!this.B$c)return f.ULS.sendTraceTag(508872861,352,50,"Refresh token requested without IOAuthManager."),yj.nMe;try{const Ka=yield this.B$c.qN("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");Ka.IsSuccess&&(yj.C0l=Ka.Telemetry.expiresOn?1E3*(Ka.Telemetry.expiresOn-
10):0,yj.nMe=Ka.Token);f.ULS.sendTraceTag(509096264,352,50,`Hubble token requested by: ${"PowerPointInsertMediaDialog"} successful: ${!!yj.nMe} time: ${(new Date).getTime()-Z}`)}catch(Ka){f.ULS.sendTraceTag(509096262,352,10,`Hubble token requested by: ${"showInsertMediaDialog"} successful: false time: ${(new Date).getTime()-Z} error: ${Ka}`)}return yj.nMe})}}yj.C0l=0;yj.nMe="";Object(c.a)(yj,"TokenCache",null,[]);class vj extends dd.a{constructor(Z,Ka,zb,dc,Jc){super();this.GC=null;this.ynh=!1;this.G6f=
this.cYb=this.STa=null;this.T$h="KeepFocusDiv";this.U$h="KeepFocusStartDiv";this.correlationId=null;this.orb=0;this.Mzc=null;this.Aeh=0;if(!Z)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.wJl=Z;this.JEa="";this.Loa=zb;this.hab=dc;this.Uad=[];this.vdn=Ka;this.Bl=Jc||Sh.Bl;this.uk="InsertMediaDialog";this.w6i=!1;this.gf=5}bpe(Z,Ka,zb){Object(mj.b)(this,void 0,void 0,function*(){this.JEa=Z;this.uMc=new yj(zb);this.$j=(new Date).getTime();yield this.uMc.getToken(this.$j);
this.ynh=!1;this.showDialog(this.JEa,null);this.STa=this.ehh(this.ap("insertmediaframe"));if(!this.STa)throw this.NDd(this.ich),Error.invalidOperation("Couldn't get InsertMediaIframe.");var dc=document.getElementById(this.ap("WACDialogPanel"));dc&&dc.setAttribute(Ga.a.pi,Ga.a.c5c);dc=document.createElement("div");dc.setAttribute("Id",this.U$h);dc.setAttribute("tabindex","0");dc.setAttribute("position","absolute");dc.setAttribute("width","-1000px");dc.setAttribute("top","-1000px");this.STa.parentNode.insertBefore(dc,
this.STa.parentNode.firstChild);dc=document.createElement("div");dc.setAttribute("Id",this.T$h);dc.setAttribute("tabindex","0");this.STa.parentNode.appendChild(dc);dc.setAttribute("position","absolute");dc.setAttribute("width","-1000px");dc.setAttribute("top","10000px");$addHandler(this.zui,"keydown",Object(e.a)(this,this.bL,"keyDownHandler"));this.STa.setAttribute("src",this.wJl);this.STa.setAttribute("width","100%");this.STa.setAttribute("height","100%");this.STa.setAttribute("frameborder","0");
h.AFrameworkApplication.ga.getBooleanAppSetting("ShowInsertMediaIframeWhenIframeIsReady")&&(za.a.zg||za.a.pCc)?(this.STa.style.visibility="hidden",this.G6f=Object(e.a)(this,this.rqn,"onInsertMediaIframeLoaded"),Tc.a.addHandler(this.STa,"load",this.G6f)):this.STa.style.visibility="visible";this.ehh(this.ap("WACDialogTitleText")).style.display="none";if(2===this.orb||5===this.orb)this.ehh(this.ap("WACDialogTitlePanel")).style.display="none",this.ehh(this.ap("WACDialogBodyPanel")).style.padding="0";
bb.FocusManager.instance().Hw().scope.$V=!0;dc=this.wJl;const Jc=new URL(dc),jd=tf[Jc.protocol+"//"+Jc.host];jd?dc=jd:f.ULS.sendTraceTag(508937633,352,10,`Target URL: ${Jc.host} not found`);this.GC=this.vdn.getInstance(this.STa.contentWindow,dc);this.GC.czb("https://osiziwuspersimmon002.blob.core.windows.net");this.GC.czb("https://osizewuspersimmon001.blob.core.windows.net");this.GC.czb("https://osizpscuspersimmon000.blob.core.windows.net");this.GC.czb("https://cdn.hubblecontent.msit.osi.office.net");
this.GC.czb("https://cdn.hubblecontent.osi.office.net");this.GC.Jdc(sf.a.BJb,Ed=>{this.Nnn(Ed,Object(e.a)(Ka,Ka.fbc,"insertMediaCallback"))});this.GC.Jdc(sf.a.insert,Ed=>{this.L_j(Ed,Object(e.a)(Ka,Ka.fbc,"insertMediaCallback"))});this.GC.Jdc(sf.a.Uom,Ed=>{this.Vqn(Ed)});this.GC.Jdc(sf.a.FNm,Object(e.a)(this,this.Qpn,"onGetCustomHeaders"));this.GC.Jdc(sf.a.$Sm,Object(e.a)(this,this.Zpn,"onGetSessionId"));this.GC.Jdc(sf.a.yMm,Object(e.a)(this,this.Ppn,"onGetCID"));this.GC.Jdc(sf.a.Dwm,Object(e.a)(this,
this.zon,"onCancelDialog"));2===this.orb&&0===this.Aeh&&(this.GC.Jdc(sf.a.I8m,Object(e.a)(this,this.Dqn,"onLaunchM365Upsell")),this.cYb=this.hab.OCb("MsoPremiumStockImages",Ed=>{f.ULS.sendTraceTag(512497694,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");this.GC.sendMessage(sf.a.NYn,{["LicenseTier"]:Ed.toString()})}));this.Nbb(3)})}rqn(){this.STa&&(this.STa.style.visibility="visible",window.setTimeout(()=>{if(this.Tp){const Z=this.Tp.getElementById("insertmediaframe");Z&&Z.focus()}},0))}bL(Z){Z.keyCode===
Sys.UI.Key.tab&&(Z.target.id!==this.T$h||Z.shiftKey?Z.target.id===this.U$h&&Z.shiftKey&&(Z.preventDefault(),this.Tp.getElementById(this.T$h).focus()):(Z.preventDefault(),this.Tp.getElementById(this.U$h).focus()))}dispose(){this.hab&&this.cYb&&this.hab.M4b("MsoPremiumStockImages",this.cYb);this.GC&&(this.GC.dispose(),this.GC=null);this.G6f&&(Tc.a.removeHandler(this.STa,"load",this.G6f),this.G6f=null);super.dispose()}Nnn(Z,Ka){f.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(Z=this.Loa.gTl(Z))50<
this.Uad.length?f.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this.Uad,Z),this.ynh&&(Ka(this.Uad),this.ynh=!1))}zon(){f.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.NDd(this.ich);this.Nbb(1)}Nbb(Z){if(2===this.orb||5===this.orb){const dc=h.AFrameworkApplication.ga.La("InsertMediaDialogAriaTenantNameSpace");if(dc&&""!==dc){var Ka=[],zb="InsertUnknownContent";2===this.orb?(Array.add(Ka,Object.assign(new y.a,{name:"DialogMode",
string:"M365Content"})),Array.add(Ka,Object.assign(new y.a,{name:"Provider",string:"M365Content"})),zb="InsertM365Content"):5===this.orb&&(Array.add(Ka,Object.assign(new y.a,{name:"DialogMode",string:"HubbleVideo"})),Array.add(Ka,Object.assign(new y.a,{name:"Provider",string:"HubbleVideo"})),zb="InsertHubbleVideo");Array.add(Ka,Object.assign(new y.a,{name:"InsertedFiles",int64:this.Uad.length}));Array.add(Ka,Object.assign(new y.a,{name:"DialogResult",string:Xj[Z]}));Array.add(Ka,Object.assign(new y.a,
{name:"CorrelationId",string:this.correlationId.toString()}));m.a.sendTelemetryEvent(Object.assign(new z.a,{name:String.format("{0}.{1}",dc,zb),dataFields:Ka}))}}}ehh(Z){const Ka=document.getElementById(Z);if(!Ka)throw Error.invalidOperation(String.format("Couldn't get {0}.",Z));return Ka}L_j(Z,Ka){f.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.NDd(this.ich);Ka?this.Uad&&0<this.Uad.length?(Ka(this.Uad),this.Nbb(0)):(f.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.ynh=
!0,Ka(this.Uad),this.Nbb(2)):this.Nbb(2)}Qpn(){return Object(mj.b)(this,void 0,void 0,function*(){if(this.GC){var Z=yield this.uMc.getToken(this.$j);f.ULS.sendTraceTag(509096025,352,50,`onGetCustomHeaders : Token available: ${!!Z} time: ${(new Date).getTime()-this.$j}`);this.GC.sendMessage(sf.a.xLn,{["CustomHeaders"]:Z||""})}})}Zpn(){this.GC&&(f.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.GC.sendMessage(sf.a.VMn,{["SessionId"]:h.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}Ppn(){this.GC&&
(f.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.GC.sendMessage(sf.a.eLn,{["CID"]:""}))}Vqn(Z){Z&&Z.Values&&(Z=Z.Values,delete Z.m_Origin,delete Z.m_Source,delete Z.m_ReceivedTime,f.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+Z.eventName||!1),m.a.sendOtelEvent(Object.assign(new $h.a,{otelEvent:Z})))}Dqn(){this.hab&&(f.ULS.sendTraceTag(512497693,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.hab.launchUpsellExperience("stockimages"))}}
Object(c.a)(vj,"InsertMediaDialog",dd.a,[1391,24]);class jl{getInstance(Z,Ka,zb,dc,Jc){return new vj(Z,Ka,zb,dc,Jc)}}Object(c.a)(jl,"PptInsertMediaDialogFactory",null,[1369]);var ri=a(304);class Wk{constructor(Z){this.d1d=Z;this.hEk(this.d1d.zi,this.d1d.KKl)}hEk(Z,Ka){Z&&Z.aS(Object(e.a)(this,this.Irh,"onEditSlideChanged"));Ka&&Ka.esa(Object(e.a)(this,this.Srh,"onPageContentLoaded"))}DFn(Z,Ka){Z&&Z.Dia(Object(e.a)(this,this.Irh,"onEditSlideChanged"));Ka&&Ka.e6a(Object(e.a)(this,this.Srh,"onPageContentLoaded"))}Srh(Z,
Ka){(Z=Object(v.a)(32,Ka.node))&&Z.yC&&(this.d1d.ZFe.remove(Z.Xb),this.d1d.JE.bWc())}Irh(Z,Ka){Ka&&Ka.I4a&&(this.d1d.O$c=Ka.I4a,this.d1d.JE.bWc(),this.d1d.QAj=new Date)}}Object(c.a)(Wk,"SlideEventListener",null,[]);class kl{constructor(Z,Ka,zb){this.wMl="";this.C2d=!1;this.W3d=new Date(0);this.V3d=new Date(0);this.SNj=Z;this.Tb=Ka;zb&&(this.wMl=zb)}Zxl(){this.C2d=!0}bWc(){this.C2d?D.a.J(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):
this.W3d>this.V3d?D.a.J(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.W3d+". Last scan at "+this.V3d+"."):(this.W3d=new Date,this.Tb.Qb(new H.a(3,1,0,Object(e.a)(this,this.cuk,"runJob"),90,this.wMl)))}cuk(){this.V3d=new Date;this.C2d?D.a.J(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.SNj()&&this.bWc()}}
Object(c.a)(kl,"BackgroundJobScheduler",null,[]);class tj{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf){this.Wph=null;this.QAj=new Date;this.O$c=null;this.FIl={};this.DMl={};this.JMl={};this.dIl={};if(!zb)throw Error.argumentNull("graphTopologyManager");if(!dc)throw Error.argumentNull("fontUtilsManager");this.mr=zb;this.HF=dc;this.zi=Z;this.KKl=Ka;this.xLc=de;this.UZb=Ne;this.yLc=Re;this.Uph=Cf;this.ZFe=new cl.a;this.JE=new kl(Object(e.a)(this,this.RUk,"tryScan"),Jc,"");0<jd&&window.setInterval(Object(e.a)(this,
this.EFl,"logMissingFonts"),jd);this.Tcn=Ed;Z=zb.Ga?zb.Ga.slideIndex:0;if(Ka=this.mr.presentation)Ka=Ka.slides||[],Z<Ka.length&&(this.O$c=Ka[Z],this.QAj=new Date)}dispose(){this.stop();this.EFl()}start(){this.stop();this.Wph=new Wk(this);this.JE.bWc()}stop(){this.Wph&&this.Wph.DFn(this.zi,this.KKl);this.Wph=null}nWi(){const Z=[];this.O$c&&Z.push(this.O$c);return Z}RUk(){const Z=this.nWi();0<Z.length&&(this.Qvk(Z[0]),this.ZFe.add(Z[0].Xb));return 1<Z.length}iwj(Z,Ka,zb,dc){const Jc=[];for(const jd of Object.keys(Z))Z[jd]||
this.dIl[jd]||(Jc.push(jd),this.dIl[jd]=!0);Z=Jc.length;0<Z&&(D.a.J(zb,820,15,"{0}",Z),Ka&&D.a.J(dc,820,15,"{0}",Jc.join(",")))}Qvk(Z){const Ka=Z.AQb();if(Ka&&(this.xLc||this.yLc||this.UZb||rb.a("ShouldLogMissingThirdPartyFontCount"))){var zb={},dc={},Jc={};Z.jgh.split(",").forEach(Re=>{Re&&(Re=this.HF.NH(Re),zb[Re]=!1)});Z.Dyh.split(",").forEach(Re=>{Re&&(Re=this.HF.NH(Re),dc[Re]=!1)});Z.szh.split(",").forEach(Re=>{Re&&(Re=this.HF.NH(Re),Jc[Re]=!1)});Z=[];var jd=[],Ed=[];for(let Re=0;Re<Ka.length;Re++){var de=
Ka[Re];de=Array.isArray(de.wI())?de.wI():null;for(const Cf of de)for(de=0;Cf.Za&&de<Cf.Za.length;){var Ne=Cf.Za.ha(de);Ne=Ne.formatting?this.HF.NH(ri.Font.kEa(Ne.formatting.cache.AJ.trim().toLowerCase())):"";Va.a.rb(Ne)||(Ne in zb&&!zb[Ne]?(Z.push(Ne),zb[Ne]=!0):Ne in dc&&!dc[Ne]?(jd.push(Ne),dc[Ne]=!0):Ne in zb||Ne in dc||Jc[Ne]||(Ed.push(Ne),Jc[Ne]=!0));de++}}this.xLc&&(tj.wbj(this.FIl,Z,this.HF),this.iwj(zb,!0,555886295,555886296));if(this.UZb||rb.a("ShouldLogMissingThirdPartyFontCount"))tj.wbj(this.DMl,
jd,this.HF),this.iwj(dc,this.UZb||this.Uph,555886297,555886298);this.yLc&&(tj.wbj(this.JMl,Ed,this.HF),this.iwj(Jc,this.Uph,555886299,555886300))}}EFl(){+new Date-+this.QAj<this.Tcn||(this.xLc&&tj.Cxj(this.FIl,this.HF,591003669,!0,"MissingFirstPartyFonts"),(this.UZb||rb.a("ShouldLogMissingThirdPartyFontCount"))&&tj.Cxj(this.DMl,this.HF,591003667,this.UZb||this.Uph,"MissingThirdPartyFonts"),this.yLc&&tj.Cxj(this.JMl,this.HF,587337796,this.Uph,"MissingNonLoggableFonts"))}static wbj(Z,Ka,zb){Ka.forEach(dc=>
{rb.a("ShouldNormalizeFontNamesBeforeLogging")&&(dc=zb.NH(dc));if(void 0===Z[dc]||null===Z[dc])Z[dc]=!1})}static yQm(Z,Ka){if(!Z)throw Error.argumentNull("fonts");const zb=[];for(const dc of Object.keys(Z))Z[dc]||(Ka.Hca(dc)||Ka.Hca('"'+dc+'"')||zb.push(dc),Z[dc]=!0);return zb}static Cxj(Z,Ka,zb,dc,Jc){Ka=tj.yQm(Z,Ka);Z=Ka.length;0<Z&&(Ka=Ka.join(","),dc&&587337796===zb?D.a.J(zb,820,15,"{0}",Ka):D.a.J(zb,820,15,"{0}",dc?Ka:Z.toString()),zb=new Map,dc&&zb.set("Fonts",Ka),zb.set("FontsCount",Z.toString()),
eg.Health.instance.recordQosError(Jc,["MissingFont"],!1,!1,!0,!1,{extendedProperties:zb}))}}Object(c.a)(tj,"FontLogger",null,[24]);var Mk=a(892),hj=a(820),ll=a(372);class ml{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah,Ui,$g,oh,Jh,ti,Mj,Yl,em){this.oIc=!1;this.cYb=null;this.Rcc=(Wh,tk)=>{var Zk,Fl;null!==(Zk=tk.Gx)&&void 0!==Zk&&Zk.Id&&this.Ocn===(null===(Fl=tk.Gx)||void 0===Fl?void 0:Fl.Id)&&D.a.J(507884387,846,50,`InsertLocalVideo: ${this.Ncn};InsertVideoTimeFromServer:${Date.now()}`)};
this.EQn=(Wh,tk,Zk)=>{var Fl;tk=this.va.Ga;if(!tk||this.uc.Cd(tk))return 16;if(1===Zk)return 32;D.a.J(508941190,846,50,"InsertVideoActor::InsertStockVideos Initiated");this.jf=Og.a.Fk("StockVideos::Insert");Zk=new ic.QueryStringBuilder(this.Aa.Qjh);Zk.Fy("initpivot","stockvideos");Zk.Zi("entryPoint",sb.a.Ov(Wh));Zk.Zi("sv","1");rb.a("AddDalleTabToStockVideoDialog")&&this.Loa.aom(this.Aa,Zk);const yk=new Ug(this.ia,this.Loa,this.Aa);yk.LX=sb.a.hbc;null===(Fl=this.jf)||void 0===Fl?void 0:Fl.Ya("StockVideoInitiatedByRibbon",
"true");yk.S1l(this.jf);const dk=Zk.toString();if(!dk||!dk.length)return 16;try{const Ej=Di.a.create(),il=Va.a.DV(this.Aa.lPa).toString();this.iab.execute(Dk=>{var sm=this.Aa.mdj&&Dk.isFreemiumUpsellEnabled();sm=this.oIc?1:sm?0:-1;var hk=this.Aa.getBooleanAppSetting("InsertOnlineM365ExperimentEnabled")?1:0;hk=this.Loa.Yhl(ll.App.mode,dk,sm,1,Ej.toString(),il,hk);Dk=this.LGe.getInstance(hk,this.KGe,this.Loa,Dk,Nh.Bl);Dk.correlationId=Ej;Dk.orb=2;Dk.Aeh=sm;Dk.bpe(CommonUIStrings.L_VideoInsertTitle,
yk,void 0);this.jf&&this.jf.Ya("StockVideoDialogInitialized","true");D.a.J(509100040,846,50,"InsertVideoActor::showStockVideosDialog : Show dialog success.")});return 32}catch(Ej){D.a.J(509100039,846,10,"InsertVideoActor::showStockVideosDialog : Exception = [{0}]",Ej.toString())}return 8};this.P2m=(Wh,tk,Zk,Fl,yk)=>{Wh=this.va.Ga;if(!Wh||this.uc.Cd(Wh))return 16;if(1===Zk)return 32;if(!this.kj.zC(Wh,1))return this.kj.dI(Wh),16;if(!yk||!yk.OriginalUrl)return 16;try{const dk=Wh.b8(this.ob.ud());if(dk&&
this.uc.Cd(dk))return 16;const Ej=this.dih(Wh,dk),il=this.Mb.Fd(15,void 0,()=>{this.ob.Rw();this.ob.Ti();this.Ma.Wd()},()=>{this.ob.selectShape(Ej,!0)});try{il.rc(Wh);il.sc=sb.a.hbc;il.XC[Pf.a.S9a]=Pf.a.MQc;D.a.J(509100038,846,50,"InsertVideoActor::UploadStockVideo");Ej.setValue(Yb.a.Eva,yk.LicenseUrl?null:yk.Caption);Ej.c9b=yk.Caption;Ej.setValue(Yb.a.mediaType,2);Ej.setValue(Yb.a.Zl,!0);Ej.setValue(Yb.a.nFa,!0);Ej.setValue(Yb.a.Jra,yk.OriginalUrl);Ej.setValue(Yb.a.rq,!0);const Dk=String.format("{0}{1}",
"video",Di.a.create().toString());Ej.d9b=Dk;dk&&Wh.i_([dk]);Wh.pI(Ej)}finally{il&&il.dispose()}this.yv.zI=Ej;return 32}catch(dk){return D.a.J(509100037,846,10,"InsertVideoActor:: Error while creating video shape node : Exception = [{0}].",dk.toString()),8}};this.P0l=(Wh,tk)=>{Wh=tk.node;null!=Wh&&Wh==this.aKl&&(this.Ocn=tk.revisionId.toString(),this.aKl=void 0)};this.rW=(Wh,tk)=>{var Zk;this.jf&&(this.jf.Ya("MediaFileValidationPassedOnUI","false"),this.jf.Ya("ErrorMessage",null===(Zk=tk.Message)||
void 0===Zk?void 0:Zk.toString()),this.jf.finish(),this.jf=null);Wh=tk.ExtraErrorParam?String.format(tk.Message,tk.ExtraErrorParam):tk.Message;tk=Object.assign(new hj.a,{title:tk.Title,message:Wh,timeoutInSeconds:120});this.DI.Poe(tk)};if(!Z)throw Error.argumentNull("applicationSettings");if(!Ka)throw Error.argumentNull("actionManager");if(!zb)throw Error.argumentNull("graphTopologyManager");if(!dc)throw Error.argumentNull("graphActionBlockingManager");if(!Jc)throw Error.argumentNull("pptSelectionManager");
if(!jd)throw Error.argumentNull("ribbonChangeManager");if(!Ed)throw Error.argumentNull("transactionFactory");if(!de)throw Error.argumentNull("shapeEditor");if(!Ne)throw Error.argumentNull("errorHandler");if(!Re)throw Error.argumentNull("focusManager");if(!Cf)throw Error.argumentNull("sessionInfo");if(!yg)throw Error.argumentNull("mediaUploaderFactory");if(!bh)throw Error.argumentNull("calloutNotificationAdapter");if(null===Z||void 0===Z?0:Z.bAc){if(!Ah)throw Error.argumentNull("appFeatureHelper");
if(!Ui)throw Error.argumentNull("insertMediaHelper");if(!oh)throw Error.argumentNull("insertMediaCrossDocumentMessengerFactory");if(!$g)throw Error.argumentNull("insertMediaDialogFactory");if(!Jh)throw Error.argumentNull("shapeCountValidator");if(!ti)throw Error.argumentNull("pageView");if(!Mj)throw Error.argumentNull("presReader");}if(null===Z||void 0===Z?0:Z.getBooleanAppSetting("RecordLocalVideoUploadInboundTime")){if(!em)throw Error.argumentNull("graphOperationEventHandler");if(!Yl)throw Error.argumentNull("shapeGraphNodeEventHandlers");
}this.Aa=Z;this.ia=Ka;this.va=zb;this.uc=dc;this.ob=Jc;this.yv=jd;this.Mb=Ed;this.Qk=de;this.ee=Ne;this.Ma=Re;this.Wv=zb.presentation;this.Fe=Cf;this.jpb=yg;this.DI=bh;this.iab=Ah;this.Loa=Ui;this.KGe=oh;this.LGe=$g;this.kj=Jh;this.xb=ti;this.Ub=Mj;this.Kab=Yl;this.ih=em;Mk.a.P_k=this.Aa.w0k;Mk.a.s0k=this.Aa.F$l;(null===Z||void 0===Z?0:Z.bAc)&&this.fxm()}Hb(){this.ia.sa(sb.a.c7b,tg.a.application,this.SXm.bind(this),4);this.ia.sa(sb.a.Tjh,tg.a.application,this.EQn,4);this.ia.sa(sb.a.hbc,tg.a.application,
this.P2m,4);rb.a("EnableCalloutNotificationsForVideos")&&Kj.b(this.rW);this.Aa.getBooleanAppSetting("RecordLocalVideoUploadInboundTime")&&(this.ih.nma(this.Rcc),this.Kab.fca(this.P0l))}ve(){}SXm(Z,Ka,zb){const dc=this.va.Ga;if(!dc||this.uc.Cd(dc))return 16;if(1===zb)return 32;this.jf=Og.a.Fk("Video::Insert");try{return D.a.J(509650205,846,50,"InsertLocalVideo: flow initiated"),ek.a.tNe(this.Aa.w0k.toString(),Kj.e,()=>Kj.d(Z,this.T2m.bind(this),"video",this.Fe,dc),"video",dc,this.va.presentation,this.uc,
this.ee,this.jf,!0,this.jpb,this.Aa.gfc,this.Aa.ffc,this.Aa.efc),this.jf&&this.jf.Ya("VideoDialogInitialized","true"),32}catch(Jc){D.a.J(509724677,818,10,"Exception {0} while rendering file selection dialog.",Jc)}Kj.a("video")?Kj.c(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):this.showErrorMessage(446,null);return 8}dispose(){this.iab.instance&&this.cYb&&this.iab.instance.M4b("MsoPremiumStockImages",this.cYb);this.Aa.getBooleanAppSetting("RecordLocalVideoUploadInboundTime")&&
(this.Kab.Abb(this.P0l),this.ih.Cbb(this.Rcc))}showErrorMessage(Z,Ka){this.jf&&(this.jf.finish(),this.jf=null);this.ee.SK(Z,zb=>{zb.zD=1;zb.Z9a=Ka;return!1})}T2m(Z,Ka,zb,dc,Jc,jd,Ed){dc.cN(zb)&&D.a.J(509724676,822,15,"Video::insertVideoSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+zb.Tea);dc.mD(Ed);zb=Ed.Ju();var de=this.Wv.slideHeight;dc=this.Wv.slideWidth/2-mh.a.vf(Ge.a.c2/2,0);de=de/2-mh.a.vf(Ge.a.c2/2,1);if(Ed&&Ed.isConnected){var Ne=this.Mb.Fd(15,void 0,
void 0,()=>{this.yv.zI=this.qbd;this.ob.selectShape(this.qbd,!0);this.Ma.Wd()});try{Ne.rc(Ed);Ne.sc=Z;Jc&&Jc.Ya("CreatingVideoShape","true");this.qbd=this.Qk.QDa(!1,Ed.Xb.cid,Ed.Xb.sid,0,10,dc,de,Ge.a.c2,Ge.a.F6,zb+1);const Re=jd.files[0].name;this.qbd.d9b=Ka;this.qbd.c9b=Re;rb.a("SetMediaTypeAsVideoForEmbeddedVideo")&&this.qbd.setValue(Yb.a.mediaType,2);(this.Aa.getBooleanAppSetting(ob.a.iyb)||this.Aa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.VideoLoadingExperience",!1))&&this.qbd.setValue(Yb.a.rq,
!0);Ed.pI(this.qbd);this.aKl=this.qbd}finally{Ne&&Ne.dispose()}Jc&&(Jc.Ya("VideoShapeSuccessfullyCreated","true"),Z=Date.now(),Jc.Ya("successTime",Z.toString()),this.Ncn=Jc.Tta(),Jc.finish(),Jc=null)}}fxm(){this.iab.execute(Z=>{Z.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Ka=>D.a.J(509100036,846,10,"InsertVideoActor::Constructor - Failed to load the premium state from application feature helper: {0}",Ka)).then(Ka=>{this.oIc=Ka;this.oIc||(this.cYb=Z.OCb("MsoPremiumStockImages",()=>{this.oIc=
!0;D.a.J(509100035,846,50,"InsertVideoActor:: setting isUserLicensed=1")}));return null})})}dih(Z,Ka){if(!Z)return null;var zb=Z.Xb;Z=Z.Ju();const dc=this.Ub.Nja(Ge.a.c2,Ge.a.F6);zb=this.Qk.MSa(!0,zb.cid,zb.sid,0,dc.x,dc.y,Ge.a.c2,Ge.a.F6,Z+1,!0);Ka&&(zb.msa=Ka.id);return zb}}Object(c.a)(ml,"InsertVideoActor",null,[743]);class Cj{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne){if(!Z)throw Error.argumentNull("transactionHelper");if(!Ka)throw Error.argumentNull("actionManager");if(!dc)throw Error.argumentNull("graphTopologyManager");
if(!dc.presentation)throw Error.argumentNull("graphTopologyManager.presentation");if(!zb)throw Error.argumentNull("graphActionBlockingManager");if(!Jc)throw Error.argumentNull("ribbonChangeManager");if(!jd)throw Error.argumentNull("shapeEditor");if(!Ed)throw Error.argumentNull("shapeCountValidator");if(!de)throw Error.argumentNull("appSettings");if(!Ne)throw Error.argumentNull("selectionManager");this.Xn=Z;this.ia=Ka;this.va=dc;this.uc=zb;this.yv=Jc;this.Wv=dc.presentation;this.Qk=jd;this.kj=Ed;this.la=
de;this.pa=Ne}Hb(){this.la.xJ&&this.ia.sa(sb.a.g9c,tg.a.application,this.AWm.bind(this),4)}ve(){}AWm(Z,Ka,zb){Ka=this.va.Ga;if(!Ka)return 16;if(C.a.Ax(Ka.Xb))return 8;if(this.uc.Cd(Ka))return 16;if(1===zb)return 32;if(!this.kj.zC(Ka,1))return this.kj.dI(Ka),16;var dc=Math.min(Math.min(this.Wv.Ixh,this.Wv.Exh),100);zb=Ka.Ju();var Jc=this.Wv.slideWidth,jd=this.Wv.slideHeight,Ed=mh.a.vf(dc,0);dc=mh.a.vf(dc,1);Jc=Jc/2-mh.a.vf(50,0);jd=jd/2-mh.a.vf(50,1);zb=this.Qk.QDa(!1,Ka.Xb.cid,Ka.Xb.sid,0,10,Jc,jd,
Ed,dc,zb+1);this.la.tTa&&(Ed=Ka.uGd(this.pa.ud()).filter(de=>!!de&&!this.uc.Cd(de)).find(de=>16===de.placeholderType))&&(zb.msa=Ed.id);zb.HA=!0;this.Xn.WM([zb],Ka,Z);D.a.J(508303115,352,50,"InsertCameoActor::handleInsertCameo : Inserting cameo is done.");this.yv.zI=zb;return 32}}Object(c.a)(Cj,"InsertCameoActor",null,[743]);class dj{constructor(){this.ONa=this.Sm=this.Jab=this.$=null;this.BKl=[];this.fY=!1;this.X1f=[new cj];this.Vca=[]}get name(){return"PowerPointWebEditor.Chronos2"}lc(Z){this.$=
Z;this.Jab=this.$.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.Sm=this.Jab.oAb(5,this.name);this.ONa=this.$.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");this.fY=Z.resolve("PowerPointWebEditor.IApplicationSettings").getBooleanAppSetting("blockWebsocketConnectionForPAS");for(let Jc=0;Jc<this.X1f.length;++Jc)Array.add(this.Vca,Ea.a(this.X1f[Jc],5));for(const Jc of this.Vca)Jc.lc(Z);const Ka=this.$.resolve("PowerPointWebEditor.IApplicationContext"),zb=h.AFrameworkApplication.ga.getBooleanAppSetting("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),
dc=Me.a.aG(this.$.Na("Common.IEventEmitter<Common.IGetMoreInfoResult>"));Object(rb.a)("EnhancementOfSDXPaneBootTime")||this.$.register(Bk.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").na(()=>new Bk.a(this.$.resolve("Common.IActionManager"),this.$.resolve("PowerPointWebEditor.IPPTWorkspace"),this.$.resolve("Box4.Graph.IGraphIteratorFactory"),this.$.resolve("PowerPointWebEditor.IPPTApp"),this.$.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"))).ma();
this.$.register(vk,"PowerPointWebEditor.PPTVersionHistorySelectionHandler").as("Common.IVersionHistorySelectionHandler").ma().na(()=>new vk(this.$.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.$.resolve("Common.Utils.IHighContrastDetector"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.IPresentationReader")));this.$.register(Uf,"Box4.Media.OneDriveFilePickerHelperV7").as("Box4.Media.IImageFilePickerHelper").ma().na(()=>new Uf(Z.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72"),
new fe.a(()=>dc.result),Z.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory")));this.$.register(Kh,"Box4.Media.InsertOneDriveFileHelper").ma().na(()=>new Kh(h.AFrameworkApplication.vb));this.$.register(ng,"Box4.Media.InsertMediaHelper").as("Box4.Media.IInsertMediaHelper").ma().na(()=>new ng);this.$.register(Ug,"PowerPointWebEditor.InsertOnlineImageHelper").ma().na(()=>new Ug(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Box4.Media.InsertMediaHelper"),this.$.resolve("PowerPointWebEditor.IApplicationSettings")));
this.$.register(ul,"PowerPointWebEditor.ChangeOnlineImageHelper").ma().na(()=>new ul(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Box4.Media.InsertMediaHelper"),this.$.resolve("PowerPointWebEditor.IApplicationSettings")));this.$.register(fi,"Box4.Media.InsertMediaFromHostManagerFactory").as("Box4.Media.IInsertMediaFromHostManagerFactory").ma().na(()=>new fi(new vh(new fe.a(()=>{if(h.AFrameworkApplication.x4l()){var Jc=this.$.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").kEd;
Jc=new Dg(Jc.contentWindow,"*")}else Jc=Ka.Tul();return Jc}),zb?Rc.a.getOrigin(window.document.URL):Rc.a.getOrigin(h.AFrameworkApplication.rka),h.AFrameworkApplication.ga.appSettings.ImageFetcherSupportedExtensions)));this.$.register(bg,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ma();this.$.register(Jg,"Box4.Media.InsertMediaFromHostOneDriveHostFrame").as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ma().na(()=>new Jg);
this.$.register(jl,"PowerPointWebEditor.PptInsertMediaDialogFactory").as("PowerPointWebEditor.IPptInsertMediaDialogFactory").ma();this.$.register(1313,"PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory").ma().na(()=>new Hj);this.$.register(Pi,"PowerPointWebEditor.StreamVideoPrefetchOrchestrator").ma().na(()=>new Pi(this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(8),this.$.resolve("PowerPointWebEditor.ISlideshowFrame"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.ISlideReader"),this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.Video.IStreamPreFetchService")))}init(){let Z=this.Sm.qI("resolvechronos2");const Ka=this.$.resolve("Common.AFrameworkApplication"),zb=this.$.resolve("PowerPointWebEditor.IApplicationContext"),dc=zb.Md,Jc=Ka.nj,jd=this.$.resolve("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory"),
Ed=this.$.resolve("Common.IActionManagerExtended"),de=this.$.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");var Ne=this.$.resolve("PowerPointWebEditor.IGraphTransactionHelper");const Re=this.$.resolve("PowerPointWebEditor.IFocusManager"),Cf=Jc.Pd,yg=this.$.resolve("Common.Transaction.ITransactionFactory"),bh=this.$.resolve("PowerPointWebEditor.IShapeEditor"),Ah=this.$.ge("PowerPointWebEditor.IClassFactory"),Ui=this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),$g=this.$.resolve("Box4.Graph.IGraphIteratorFactory"),
oh=this.$.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Jh=this.$.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),ti=this.$.resolve("PowerPointWebEditor.IPresentationReader"),Mj=Jc.gCb,Yl=this.$.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),em=this.$.resolve("PowerPointWebEditor.IGraphHotColdManager"),Wh=this.$.resolve("PowerPointWebEditor.ISaveBlockingUI"),tk=this.$.resolve("PowerPointWebEditor.IRibbonChangeManager"),Zk=this.$.resolve("PowerPointWebEditor.IShapeReader"),
Fl=this.$.resolve("PowerPointWebEditor.View.IPPTPageView");this.Sm.uI(Z);Z=this.Sm.qI("regactorschronos2");Ne=[...(Object(rb.a)("EnhancementOfSDXPaneBootTime")?[]:[new Ai.a(dc,this.$.resolve("Common.IAppSettingsManager"),Ne,Ed,Cf,this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),yg,Ah,de,this.$.Na("PowerPointWebEditor.IAppForOfficeManager"),$g,oh,Jh)]),new Ci(dc,Ed,de,this.$.Na("PowerPointWebEditor.IAddinCommandsManager")),new Qb(dc,Ed,oh,Ui,Re,this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
yg,this.$.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.$.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),this.$.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.$.resolve("Box4.Media.InsertMediaHelper"),this.$.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.$.resolve("PowerPointWebEditor.InsertOnlineImageHelper"),this.$.resolve("PowerPointWebEditor.ChangeOnlineImageHelper"),ti,bh,Zk,Fl,tk,Jh,this.$.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),
this.$.resolve("Box4.Media.IImageFilePickerHelper"),this.$.resolve("Box4.Media.InsertOneDriveFileHelper"),this.$.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),this.$.resolve("PowerPointWebEditor.IInsertImageHelper"),this.$.resolve("PowerPointWebEditor.IJSanityHelper"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("Common.IExternalUICommandDefinitionMapping"),this.$.resolve("Common.IAppSettingsManager")),new gi(Ed,this.$.resolve("PowerPointWebEditor.ISlidePane"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),oh,Ui,tk,this.$.resolve("Common.Transaction.ITransactionFactory"),bh,this.$.resolve("PowerPointWebEditor.IErrorHandler"),Re,this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.$.resolve("PowerPointWebEditor.IMediaUploader")),new Cj(Ne,Ed,oh,this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),tk,bh,Jh,this.$.resolve("PowerPointWebEditor.IApplicationSettings"),Ui),new ml(this.$.resolve("PowerPointWebEditor.IApplicationSettings"),
Ed,this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),oh,Ui,tk,this.$.resolve("Common.Transaction.ITransactionFactory"),bh,this.$.resolve("PowerPointWebEditor.IErrorHandler"),Re,this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.$.resolve("PowerPointWebEditor.IMediaUploader"),this.$.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),this.$.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.$.resolve("Box4.Media.InsertMediaHelper"),this.$.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),
this.$.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.$.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(10),this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"))];for(const yk of Ne)yk.Hb(),yk.ve();de.r9e=!0;this.Sm.uI(Z);h.AFrameworkApplication.ga.fg(()=>{Z=this.Sm.qI("regfullactorschronos2");
const yk=[new Wj(Ed,oh,Re,Ui,this.$.resolve("PowerPointWebEditor.IPPTWorkspace").Qf,Yl,zb.o$a().uDl,em,this.$.resolve("PowerPointWeb.IPrinter"),this.$.resolve("PowerPointWeb.IConverter"),this.$.resolve("Box4.IAppFrame"),Wh,jd,this.$.resolve("PowerPointWebEditor.DownloadACopyAsPdfContext"),Ka.Oej,this.$.resolve("PowerPointWebEditor.IBusinessBarController"),this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("Common.IAppSettingsManager"),
this.$.resolve("PowerPointWebEditor.IPresentationReader"),()=>h.AFrameworkApplication.fD,zb.WHd(),dk=>h.AFrameworkApplication.Ea.Kb.dTg(dk),()=>h.AFrameworkApplication.oFe,this.$.resolve("PowerPointWebEditor.IDeferredContentManager"),this.$.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper")),new ai(Jc,dc.Csl,Mj.sBe,Ed,ti,zb.WHd(),this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"))];
for(const dk of yk)dk.Hb(),dk.ve();this.Sm.uI(Z)});D.a.J(512360593,809,50,"Chronos2Package::Init");for(const yk of this.Vca)this.Sm.qI(yk.name),yk.init(),this.Sm.uI(yk.name);Z=this.Sm.qI("al");this.fY||this.S1m();this.Sm.uI(Z);h.AFrameworkApplication.ga.fg(()=>{if(dc.fPa){Z=this.Sm.qI("idea");var yk=this.d2m();this.c2m(yk);this.Sm.uI(Z)}dc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1)&&(Z=this.Sm.qI("fastcards"),this.X1m(),this.Sm.uI(Z));dc.kUa&&(Z=this.Sm.qI("smartLookup"),
this.r2m(),this.Sm.uI(Z));h.AFrameworkApplication.ZVf()&&(Z=this.Sm.qI("versionhistory"),this.t2m(),this.Sm.uI(Z));Pi.H5m(dc)&&uc.a.get_instance().$i(7,()=>{this.$.resolve("PowerPointWebEditor.StreamVideoPrefetchOrchestrator").start()});const dk=this.$.resolve("PowerPointWebEditor.IApplicationSettings");if(dk&&(dk.XFk||dk.WFk||dk.YFk)){const Ej=!Va.a.rb(h.AFrameworkApplication.ga.La("TenantId"))&&Array.contains(dk.q7l,h.AFrameworkApplication.ga.La("TenantId"));this.$.register(tj,"PowerPointWebEditor.Text.FontLogger").ma().na(()=>
new tj(this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(8),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.IFontUtilsManager"),this.$.resolve("Common.ITaskManager"),dk.KNl,dk.JNl,dk.XFk,dk.WFk&&h.AFrameworkApplication.ga.getBooleanAppSetting("IsO365ConsumerHost"),dk.YFk,dk.Jpl&&Ej));yk=this.$.resolve("PowerPointWebEditor.Text.FontLogger");this.BKl.push(yk);yk.start()}});h.AFrameworkApplication.bZa||
(Z=this.Sm.qI("appforoffice"),this.R1m(),this.Sm.uI(Z));Object(rb.a)("StoreAndLogFlightsData")&&this.$.resolve("PowerPointWebEditor.IAppBootCompletedListener").Uxa(()=>{this.MSn()})}dispose(){for(const Z of this.Vca)Z.dispose();for(const Z of this.BKl)try{Z&&Z.dispose()}catch(Ka){D.a.J(512360592,306,10,"Exception disposing a disposable. {0} {1}",Ka.message,Ka.stack)}}S1m(){D.a.J(512360591,809,50,"Start to download augloop.hermes.js file and its dependency files");try{const Z=vc.a.create("pptedit.augloop",
null,()=>a.e(10).then(a.bind(null,1679)));if(this.$.resolve("PowerPointWebEditor.IApplicationSettings").cfe){const Ka=this.$.resolve("Common.ISharedDependencyLoader"),zb=h.AFrameworkApplication.xh("augloop-runtime-shim-ie",2);Ka.Jbc(zb).continueWith(()=>{wc.a.HL(Z)})}else wc.a.HL(Z)}catch(Z){D.a.J(512360590,306,10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",Z.message,Z.stack)}}d2m(){D.a.J(512360588,809,50,"Start to download infrared.hermes.js file");var Z=
[this.ONa.FMb(h.AFrameworkApplication.xh("ir-plugin-ski.min.js",5))];Z=vc.a.create("pptedit.infrared",Z,()=>a.e(24).then(a.bind(null,1684)));wc.a.HL(Z);return Z}c2m(Z){D.a.J(512360587,809,50,"Start to download ideas.hermes.js file");Z=this.ONa.FAe(h.AFrameworkApplication.xh("microsoft.ideas.runtime.js",5),[Z],null,null,null,!1);Z=vc.a.create("pptedit.ideas",[Z],()=>a.e(16).then(a.bind(null,1686)));wc.a.HL(Z)}X1m(){D.a.J(508958302,809,50,"Start to download fastcards.hermes.js file");const Z=vc.a.create("pptedit.fastcards",
null,()=>a.e(22).then(a.bind(null,1687)));wc.a.HL(Z)}r2m(){D.a.J(512360586,809,50,"Start to download smartlookup.hermes.js file");const Z=vc.a.create("pptedit.smartlookup",null,()=>a.e(9).then(a.bind(null,1681)));wc.a.HL(Z)}t2m(){var Z=h.AFrameworkApplication.xh("pptVersionHistory.js",5);Z=this.ONa.FMb(Z);try{wc.a.HL(Z)}catch(Ka){D.a.J(512360585,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",Ka.toString())}}R1m(){const Z=this.$.resolve("PowerPointWebEditor.IApplicationSettings");
l.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").pLf()?dj.oaj():Z.Rh?h.AFrameworkApplication.ga.fg(dj.GAl):uc.a.get_instance().$i(8,()=>{dj.GAl()})}static main(){h.AFrameworkApplication.mi&&za.a.zg?D.a.J(512360584,809,15,"Firefox attempts to load chronos2 package when App is disposing"):b.a.instance.Fc(Ea.a(new dj,5))}static oaj(){l.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").eX();b.a.instance.Fc(new of)}static GAl(){let Z=!1;try{window.self.requestIdleCallback(dj.oaj)}catch(Ka){Z=
!0}Z&&window.setTimeout(dj.oaj,0)}MSn(){try{const Z=this.$.resolve("Common.IAppSettingsManager"),Ka=JSON.stringify(Z.uuc),zb=h.AFrameworkApplication.buildVersion,dc=localStorage.getItem("flightsData"),Jc=localStorage.getItem("buildVersion");if(dc)dj.W$m(dc,Ka,Jc,zb),dj.FXn(Ka,zb);else try{localStorage.setItem("flightsData",Ka),localStorage.setItem("buildVersion",zb)}catch(jd){D.a.J(507598856,809,10,"Failed to store flights data to local storage. Exception: {0}",jd.toString())}}catch(Z){D.a.J(507597726,
809,10,"Failed to access local storage. Exception: {0}",Z.toString())}}static W$m(Z,Ka,zb,dc){Z=JSON.parse(Z);Ka=JSON.parse(Ka);let Jc=0,jd=0,Ed=0;const de=[];for(const Ne in Z)Ka[Ne]?Z[Ne]!==Ka[Ne]&&(Jc++,de.push(Ne)):jd++;for(const Ne in Ka)Z[Ne]||Ed++;D.a.J(507598855,809,50,"cachedBuildVersion: {0}, currentBuildVersion: {1}, cacheHit: {2}, buildVersion: {3}, countOfFlightsWithDifferentValue: {4}, countOfNewFlights: {5}, countOfRemovedFlights: {6}",zb,dc,0===Jc&&0===jd?"true":"false",dc===zb?"same":
"different",Jc,Ed,jd);D.a.J(507598977,809,50,"Flights with different value: {0}",de)}static FXn(Z,Ka){try{localStorage.setItem("flightsData",Z),localStorage.setItem("buildVersion",Ka)}catch(zb){D.a.J(507598976,809,10,"Failed to update flights data to local storage. Exception: {0}",zb.toString())}}}Object(c.a)(dj,"Chronos2Package",null,[3,4]);var Rg=a(383),Ri;(function(Z){Z[Z.unsupported=0]="unsupported";Z[Z.designer=1]="designer";Z[Z.blank=2]="blank"})(Ri||(Ri={}));Object(c.b)("AgendaSlideThemeType",
Ri);var Yi=a(313);class ma{constructor(){this.AgendaSlideSid=this.AgendaSlideCid=0;this.CorrelationId=null}}Object(c.a)(ma,"AgendaApplyInfo",null,[]);class Sa{constructor(){this.DeckSuggestionId=this.CorrelationId=this.AgendaSessionId=null;this.FIsBlankOption=!1}}Object(c.a)(Sa,"AgendaThemeApplyInfo",null,[]);class Zb{constructor(Z,Ka){this.hCi=!1;this.dck=[];this.onl=Z;this.lIm=Ka}}Object(c.a)(Zb,"DeckOptionInformation",null,[]);class Wc{constructor(){this.HMl=this.IMl=0;this.FHl=[]}get azh(){return this.IMl}set azh(Z){this.IMl=
Z}get $yh(){return this.HMl}set $yh(Z){this.HMl=Z}get YAd(){return this.FHl}set YAd(Z){this.FHl=Z}cUl(Z,Ka,zb){const dc=new M.a;if(Z)for(let Jc=0;Jc<zb-1&&Jc<Z.length;Jc++)dc.add(new Zb(Z[Jc],!1));Va.a.rb(Ka)||dc.add(new Zb(Ka,!0));this.YAd=dc.toArray()}}Object(c.a)(Wc,"AgendaDeckSessionInformation",null,[]);class rd{constructor(){this.e_f=this.f_f=this.vGl=0;this.ZNj=this.vmh=this.iKj=this.Toh=null}TKn(Z){Z&&(this.vGl=Z.body.slideIndex)}xMn(Z){Z.body&&Z.body.outlineRequestContent&&(this.Toh=JSON.stringify(Z.body.outlineRequestContent))}PKn(Z){Z.body&&
(this.e_f=Z.body.slideCId)}SKn(Z){Z.body&&(this.f_f=Z.body.slideSId)}QKn(Z){this.vmh=Z.id}u3m(Z){return Z===this.vmh?(this.vmh=this.Toh=null,!0):!1}l7m(){return!Va.a.rb(this.Toh)&&!Va.a.rb(this.vmh)}uMn(Z){Z.body&&Z.body.outlineRequestContent&&Z.body.outlineRequestContent.Slides&&(this.iKj=Z.body.outlineRequestContent.Slides.length)}RKn(Z){this.ZNj=Z.body.score}}Object(c.a)(rd,"AgendaDetection",null,[]);var ee=a(1537);class De{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg){this.Pbc=this.n8=null;
this.Cmh=0;this.I1a=null;this.KHe="";this.wnh=!1;this.WUb=0;this.enb=new M.a;this.yJl=!1;this.qm=Z;this.Ub=Ka;this.va=zb;this.uc=dc;this.Aa=Jc;this.Kr=jd;this.Jf=de;this.ob=Ne;this.dY=Re;this.e6d=Cf;this.Fb=yg;this.dY.Apn(this.Aa)}W7l(){this.h3l();this.hAm();this.LBe()?(this.I1a=new Wc,this.I1a.azh=this.xca(),this.mVn()):1!==this.WUb||this.Aa.mtf?2===this.WUb&&this.Aa.ltf&&(this.I1a=new Wc,this.I1a.azh=this.xca(),this.HVn()):this.GVn()}hAm(){this.Pbc=Di.a.create().toString();this.dY.lHn(this.Pbc);
this.dY.Onn()}NSk(Z,Ka){if(this.n8){if(!this.n8.f_f||!this.n8.e_f){var zb=this.Ub.fw(this.n8.vGl);this.n8.f_f=zb.Xb.sid;this.n8.e_f=zb.Xb.cid}zb=this.Ub.fw(0);this.qm.generateAgendaSuggestion(zb.Xb.cid,zb.Xb.sid,this.Pbc,this.n8.Toh,this.RKm(),Z,Ka)}else Ka(null)}GVn(){this.NSk(Object(e.a)(this,this.Xqn,"onPODSTriggerAgendaConversionSuccessV1"),Object(e.a)(this,this.OQl,"onPODSTriggerAgendaConversionFailureV1"));this.uc.blockContent(this.va.presentation,"ApplyAgenda",!0,void 0,void 0)}HVn(){for(const Z of this.enb)Z&&
Z.pVn();this.NSk(Object(e.a)(this,this.Yqn,"onPODSTriggerAgendaConversionSuccessV2"),Object(e.a)(this,this.Wqn,"onPODSTriggerAgendaConversionFailureV2"))}mVn(){this.NSk(Object(e.a)(this,this.Zqn,"onPODSTriggerAgendaConversionSuccessV3"),Object(e.a)(this,this.PQl,"onPODSTriggerAgendaConversionFailureV3"));this.uc.blockContent(this.va.presentation,"ApplyAgenda",!0,void 0,void 0)}Jbe(Z,Ka){if(Ka.property===Yb.a.Lsb&&this.Cmh){Z=Object(v.a)(571,Ka.node);if(Z.Lsb===De.Dam)for(const zb of this.enb)zb&&
zb.aon();else if(Z.Lsb===De.Eam){for(const zb of this.enb)zb&&zb.aPl();this.wnh=!0}this.e6d.Pq(Object(e.a)(this,this.Jbe,"onPresentationPropertyChange"));this.Cmh=0}}RKm(){const Z={};this.Aa.ltf&&2===this.WUb&&(Z.shouldGenerateThemes="true",Z.themeCount="3");this.LBe()&&(Z.shouldNotConvertToGVMLBytes="true",Z.shouldInsertBlankSlides="true");return Yi.c(Z)}NKm(Z){const Ka={};Ka.SlideCount=this.hl().toString();Ka.isBlankThemeRequest=(this.I1a.YAd[Z].lIm&&!this.LBe()).toString();Ka.isRequestForDeckDesignerForNonBlankSlides=
this.LBe();return Yi.c(Ka)}LBe(){return this.Aa.mtf&&(1===this.WUb||0===this.WUb)}lVn(){this.ob.Ti();const Z=this.va.presentation;if(Z){const Ka=this.Kr.qe(15);try{Ka.rc(Z),Ka.sc=sb.a.hze,Z.jzb=Object.assign(new ma,{CorrelationId:this.Pbc,AgendaSlideSid:this.n8.f_f,AgendaSlideCid:this.n8.e_f})}finally{Ka&&Ka.dispose()}this.uc.vx(Z,sb.a.hze);this.uc.mD(Z)}else this.Drh()}X7l(Z){this.ob.Ti();this.dY.Asm(this.eMi(Z));const Ka=this.va.presentation;if(Ka){const zb=this.Kr.qe(15);try{zb.rc(Ka),zb.sc=sb.a.hze,
Ka.Lsb=De.Cam,this.Cmh=this.xca(),this.e6d.Am(Object(e.a)(this,this.Jbe,"onPresentationPropertyChange")),Ka.kzb=Object.assign(new Sa,{DeckSuggestionId:this.eMi(Z),AgendaSessionId:this.Pbc,CorrelationId:Di.a.create().toString()})}finally{zb&&zb.dispose()}this.uc.vx(Ka,sb.a.hze);this.uc.mD(Ka)}else this.Drh()}Drh(){for(const Z of this.enb)Z&&Z.$nn();this.uc.mD(this.va.presentation)}Xqn(){this.lVn();this.wnh=!0;for(const Z of this.enb)Z&&Z.aPl()}Yqn(Z){this.I1a.$yh=this.xca();const Ka=this.Iul(),zb=
new M.a;if(Z.Images)for(const dc of Z.Images)zb.add("data:image/jpg;base64, "+dc);zb.add(Ka);Va.a.rb(Z.BlankSuggestionId)&&(Z.BlankSuggestionId=Di.a.create().toString());this.I1a.cUl(Z.DeckSuggestionId,Z.BlankSuggestionId,De.w2k);for(const dc of this.enb)dc&&dc.don(zb.toArray());this.RSk(0)}Zqn(){this.I1a.$yh=this.xca();this.I1a.cUl(null,Di.a.create().toString(),De.w2k);this.RSk(0)}RSk(Z){this.LBe()?this.a8l(Z,Object(e.a)(this,this.arn,"onPODSTriggerAgendaDeckSuggestionSuccessForNonBlankTheme"),Object(e.a)(this,
this.PQl,"onPODSTriggerAgendaConversionFailureV3")):this.a8l(Z,Object(e.a)(this,this.$qn,"onPODSTriggerAgendaDeckSuggestionSuccess"),Object(e.a)(this,this.QQl,"onPODSTriggerAgendaDeckSuggestionFailure"))}a8l(Z,Ka,zb){if(this.I1a.$yh<this.I1a.azh)this.W7l();else if(this.dY.Hsn(Z),this.KHe=this.eMi(Z),this.sIm(this.I1a.YAd[Z])){var dc=Di.a.create().toString();this.qm.generateAgendaDeckSuggestion(this.n8.e_f,this.n8.f_f,dc,this.Pbc,this.KHe,this.NKm(Z),Ka,zb);D.a.J(512496859,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",
dc,this.KHe)}else this.DOl(this.I1a.YAd[Z].dck,this.KHe),this.dY.XOl(Z,!0)}$qn(Z){if(Z.Images&&Z.Images.length){var Ka=new M.a;for(var zb of Z.Images)Ka.add("data:image/jpg;base64, "+zb);this.DOl(Ka.toArray(),Z.DeckSuggestionId);var dc;if(zb=(()=>{let Jc=this.rul(Z.DeckSuggestionId);({themeIndex:dc}=Jc);return Jc})().returnValue)zb.dck=Ka.toArray(),zb.hCi=!0;this.dY.XOl(dc,!1)}else this.QQl(Z)}arn(Z){Z.Images&&Z.Images.length?this.X7l(0):this.Drh()}DOl(Z,Ka){for(const zb of this.enb)zb&&Ka===this.KHe&&
zb.Wnn(Z)}QQl(Z){try{let Ka;const zb=(()=>{let dc=this.rul(Z.DeckSuggestionId);({themeIndex:Ka}=dc);return dc})().returnValue;zb&&(zb.hCi=!1,zb.dck=[]);this.dY.Vnn(Ka);if(this.KHe!==Z.DeckSuggestionId)return!0}catch(Ka){D.a.J(512496858,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+Ka.message)}for(const Ka of this.enb)Ka&&Ka.$Ol();return!0}OQl(){this.Drh();return!0}PQl(Z){return this.OQl(Z)}Wqn(){const Z=this.Iul(),Ka=new M.a;Ka.add(Z);for(const zb of this.enb)zb&&(zb.bon(Ka.toArray()),
zb.$Ol());return!0}Iul(){const Z=this.Ub.fw(0);return this.Jf.RK(Z.Xb).image.src}Fna(Z,Ka){try{this.n8||(this.n8=new rd);let zb=!1;Ka?this.n8.u3m(Z.id)&&(this.w2l(!1,this.WUb),zb=!0):(this.n8.TKn(Z),this.n8.xMn(Z),this.n8.PKn(Z),this.n8.SKn(Z),this.n8.QKn(Z),this.n8.RKn(Z),this.h3l(),this.n8.l7m()&&(this.w2l(!0,this.WUb),this.n8.uMn(Z)));if(!(0>=this.enb.count))for(const dc of this.enb)try{dc&&(zb?window.setTimeout(()=>{dc.COl()},100):dc.COl())}catch(Jc){D.a.J(512496857,813,10,"Exception message: "+
Jc.message)}}catch(zb){D.a.J(512496856,813,10,"Exception message: "+zb.message)}}eEn(Z){Z&&this.enb.add(Z)}FWn(Z){this.enb.remove(Z)}w2l(Z,Ka){this.yJl=this.Aa.mtf?Z:Z&&0!==Ka}avl(){return this.yJl&&!this.wnh}s2j(Z){this.wnh=!Z}hl(){return this.va.presentation.slideCount+this.n8.iKj}h3l(){this.WUb=this.rUm();this.dY.qHn(Ri[this.WUb]);this.jHn()}jHn(){this.LBe()?this.dY.Lqk("V3"):1!==this.WUb||this.Aa.mtf?2===this.WUb&&this.Aa.ltf&&this.dY.Lqk("V2"):this.dY.Lqk("V1")}rUm(){try{const Z=this.Ub.KL();
if(Z&&0<Z.length)for(const Ka of Z)if(Ka){const zb=Ka.ThemeFamilyId;if(this.Aa.ltf&&zb.toLowerCase()===De.nbm.toLowerCase())return 2;if(0<=Array.indexOf(this.Aa.agl,zb)||Object(rb.a)("EnableNonEmptyThemeIdFixForAgendaToPPT")&&!this.Fb.getBooleanAppSetting("DisableAgendaToPPTForUnsupportedTheme")&&void 0===ee.a.Iec.find(dc=>dc.Ofh===zb))return 1}return 0}catch(Z){return D.a.J(512496855,813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+Z.message),0}}eMi(Z){return this.I1a.YAd[Z].onl}rul(Z){let Ka;
Ka=0;for(const zb of this.I1a.YAd){if(zb.onl===Z)return{returnValue:zb,themeIndex:Ka};Ka++}D.a.J(512496854,813,10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+Z);return{returnValue:null,themeIndex:Ka}}sIm(Z){return Z?!Z.hCi:(D.a.J(512496853,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),!1)}dispose(){this.e6d.Pq(Object(e.a)(this,this.Jbe,"onPresentationPropertyChange"));this.Cmh=0}xca(){return(new Date).getTime()}}
De.w2k=4;De.nbm="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F";De.Eam=1;De.Dam=2;De.Cam=0;Object(c.a)(De,"AgendaConverterManager",null,[24]);class Af{constructor(Z,Ka,zb){this.dY=Z;this.Ad=Ka;this.Hya=zb;this.Jz()}Jz(){this.Ad.taf(Object(e.a)(this,this.u1b,"onUndoRedo"))}dispose(){this.Ad.JKg(Object(e.a)(this,this.u1b,"onUndoRedo"))}eLf(Z,Ka){Z===sb.a.hze&&(this.dY.s2j(Ka),this.Hya.s2j(Ka))}u1b(Z,Ka){this.eLf(Ka.rzh,Ka.bab)}}Object(c.a)(Af,"AgendaConverterUndoRedoController",null,[1331]);class mg{constructor(){this.isEntryState=
!1;this.pptAppFrameDomElement=null;this.maxTryAgainCount=0}}Object(c.a)(mg,"IAgendaSettings",null,[]);class dg{constructor(Z,Ka,zb,dc,Jc){this.yil="HighConfidenceAgendaDetected";this.s3=null;this.ua=new Ad.a;this.umh=null;this.sqh=0;this.la=zb;this.lr=Ka;this.Ma=Jc;this.s3||(Ka=new mg,Ka.isEntryState=!0,Ka.pptAppFrameDomElement=this.lr.sP(),Ka.maxTryAgainCount=this.la.e3h,this.s3=agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(Ka));this.YSn();this.Hya=Z;this.la&&this.la.ktf&&
this.Hya.eEn(this);this.dY=dc;this.ZWd=!1}COl(){this.Hya&&(this.Hya.avl()?(this.dY.iHn(this.Hya.n8.ZNj),this.A4l(this.umh),1===this.Hya.n8.ZNj&&this.ua.raiseEvent(this.yil,null)):this.X7i())}pVn(){this.s3&&(this.dY.Xnn(),this.s3.showAgendaToPptDialog(this.Hya.hl()),this.Ma.hEe(Fa.a.d3h,Fa.a.vl,document.getElementById("AgendaToPptDialogHostElement"),!0),this.Ma.lm(Fa.a.d3h,!0),this.ZWd=!0)}aPl(){this.X7i();this.dY.Znn();window.setTimeout(()=>{this.vVn()},8E3)}don(Z){this.n5l(Z);this.dY.YOl(!0)}bon(Z){this.n5l(Z);
this.dY.YOl(!1)}Wnn(Z){this.qQn(Z)}$nn(){this.sqh>=this.la.e3h?this.s3.showAgendaToPptDismissCard():(this.sqh+=1,this.s3.showAgendaToPptFailureCard());this.dY.HQl()}$Ol(){this.s3&&this.ZWd&&this.s3.showSlidePreviewError()}aon(){this.s3.showMergeSlidesError();this.dY.HQl()}A4l(Z){this.la.ktf&&(this.Kyk(Z),this.s3&&this.umh&&this.Hya&&this.Hya.avl()&&(this.s3.showAgendaCard(this.umh,this.Hya.n8.iKj),this.dY.Unn()))}X7i(){D.a.J(507843726,829,100,"AgendaConverterView::HideAgendaEntryCard");this.s3&&!this.ZWd&&
(this.s3.hideAgendaCard(),this.Kyk(null))}n5l(Z){this.s3&&this.ZWd&&this.s3.populateThemesInAgendaDialog(Z)}qQn(Z){this.s3&&this.ZWd&&this.s3.populatePreviewSlidesInAgendaDialog(Z)}Kyk(Z){this.umh=Z}vVn(){if(this.la.mUl)try{const Z=l.a.instance.Na("Common.ISystemInitiatedFeedback");Z&&(D.a.J(507843725,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),Z.execute(Ka=>{Ka.logActivity("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled")}))}catch(Z){D.a.J(507843724,
813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",Z)}}YSn(){this.s3.on(dg.Fam,()=>{this.wrm()});this.s3.on(dg.Iam,()=>{this.zrm()});this.s3.on(dg.Gam,()=>{this.xrm()});this.s3.on(dg.Ham,()=>{this.yrm()});this.s3.on(dg.Mam,Z=>{this.vrm(Z)});this.s3.on(dg.Jam,Z=>{this.$fl(Z,!1)});this.s3.on(dg.Kam,()=>{this.Arm()});this.s3.on(dg.Lam,Z=>{this.$fl(Z,!0)})}wrm(){this.r6l()}zrm(){this.dY.Jsn();this.r6l()}xrm(){this.Zfl();this.dY.tPl()}yrm(){this.Zfl();this.dY.xpn()}Zfl(){this.cleanup();
this.Hya.FWn(this)}r6l(){this.Hya.W7l()}vrm(Z){this.Hya.RSk(Z)}$fl(Z,Ka){this.dY.Ynn(Z,Ka);this.ZWd=!1;this.s3.hideAgendaToPptDialog();this.Hya.X7l(Z)}Arm(){this.ZWd=!1;this.s3.hideAgendaToPptDialog();this.dY.tPl()}cleanup(){this.Kyk(null);this.sqh=0;this.s3.cleanup()}kqm(Z){this.ua.addHandler(this.yil,Z)}}dg.Fam="AgendaCardAddSlides";dg.Iam="AgendaCardTryAgain";dg.Gam="AgendaCardCancel";dg.Ham="AgendaCardDismiss";dg.Mam="AgendaToPptDialogThemeSuggestionSelected";dg.Jam="AgendaToPptDialogApply";dg.Kam=
"AgendaToPptDialogCancel";dg.Lam="AgendaToPptDialogMergeTryAgain";Object(c.a)(dg,"AgendaConverterView",null,[1332,1350]);var Zg=a(888);class Gh{constructor(){this.Pdg={}}Vxh(Z){this.Pdg[Z]=new Zg.a(Z,!0)}JNe(Z){if(Z in this.Pdg){var Ka=this.Pdg[Z];Ka.stop();Ka=Ka.MCd;delete this.Pdg[Z];return Ka}return-1}r3j(Z){return Z in this.Pdg}}Object(c.a)(Gh,"AgendaPerfLogger",null,[]);class wh{constructor(){this.Fkh=this.wBl=this.yBl=this.xBl=!1}L$m(){this.Fkh&&!this.xBl&&(this.xBl=!0,vb.b(wh.xvm))}han(){this.Fkh&&
!this.yBl&&(this.yBl=!0,vb.b(wh.yvm))}l$m(){this.Fkh&&!this.wBl&&(this.wBl=!0,vb.b(wh.wvm))}static W9m(Z){Z&&Z.isCreateNew&&vb.b(wh.vvm)}}wh.xvm="WAC_Exp_AgendaToPPTHighConfidenceSeen";wh.yvm="WAC_Exp_AgendaToPPTHighConfidenceTried";wh.wvm="WAC_Exp_AgendaToPPTHighConfidenceKept";wh.vvm="WAC_Exp_AgendaToPPTIsCreateNew";Object(c.a)(wh,"ExperimentationMetrics",null,[]);class Ji{constructor(){this.FDj=this.TCj=this.ZAj=this.Pbc=null;this.lEj=!1;this.bIl=this.uGl=this.zMl=this.Aa=null;this.YPj="";this.mEj=
!1;this.YAj=""}reset(){this.zMl={};this.uGl=new Gh;this.bIl=new wh;this.YPj="";this.mEj=!1;this.YAj="";this.FDj=this.TCj=this.ZAj=this.Pbc=null;this.lEj=!1}get telemetryData(){return this.zMl}get Dfh(){return this.bIl}get Jfb(){return this.uGl}get Md(){return this.Aa}set Md(Z){this.Aa=Z}get xyh(){return this.YPj}set xyh(Z){this.YPj=Z}get e7c(){return this.mEj}set e7c(Z){this.mEj=Z}get CDa(){return this.YAj}set CDa(Z){this.YAj=Z}get sSa(){return this.Pbc}set sSa(Z){this.Pbc=Z}get Aja(){return this.ZAj}set Aja(Z){this.ZAj=
Z}get PIa(){return this.TCj}set PIa(Z){this.TCj=Z}get documentOpenType(){return this.FDj}set documentOpenType(Z){this.FDj=Z}get HPf(){return this.lEj}set HPf(Z){this.lEj=Z}}Object(c.a)(Ji,"AgendaMetricsState",null,[]);var bi=a(205);class ni{constructor(Z,Ka){if(!Z)throw Error.argumentNull("AgendaThemetype is null");if(!Ka)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.Wbc=new bi.a;this.Wbc.yJb(Object.assign(new y.a,{name:"AgendaThemeType",string:Z}));this.Wbc.yJb(Object.assign(new y.a,
{name:"AgendaFlowVersion",string:Ka}))}Pbb(Z){Va.a.rb(Z)||this.Wbc.yJb(Object.assign(new y.a,{name:"AgendaSessionId",string:Z}));return this}Tvh(Z){this.Wbc.yJb(Object.assign(new y.a,{name:"AgendaThemeIndexSelected",int64:Z}));return this}qme(Z){Va.a.rb(Z)||this.Wbc.yJb(Object.assign(new y.a,{name:"AgendaCardState",string:Z}));return this}UWc(Z){Va.a.rb(Z)||this.Wbc.yJb(Object.assign(new y.a,{name:"AgendaDialogState",string:Z}));return this}ped(Z){Va.a.rb(Z)||this.Wbc.yJb(Object.assign(new y.a,{name:"AgendaButtonClickedType",
string:Z}));return this}uwh(Z){Va.a.rb(Z)||this.Wbc.yJb(Object.assign(new y.a,{name:"AgendaSeenTriedKept",string:Z}));return this}N6a(Z){Va.a.rb(Z)||this.Wbc.yJb(Object.assign(new y.a,{name:"DocumentOpenType",string:Z}));return this}build(){return this.Wbc.dataFields}}Object(c.a)(ni,"AgendaToPptActivityDataPointBuilder",null,[]);class eh{constructor(){this.Dg=null;this.dbd=new Zg.a("AgendaToPpt",!1);this.iEk()}iEk(){this.Dg=new Ji;this.Dg.reset();this.Dg.telemetryData.Flights="";h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",
!1)&&(this.Dg.telemetryData.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");this.Dg.telemetryData.InitialUserThemeType=this.Dg.CDa}Apn(Z){Z&&(this.Dg.Md=Z,this.Dg.documentOpenType=eh.oOm(Z),wh.W9m(this.Dg.Md),this.Dg.telemetryData.IsDocumentOpenTypeCreateNew=this.Dg.Md.isCreateNew.toString())}ZOl(Z,Ka){if(this.Dg.Jfb.r3j("AgendaToPptDialogThemeApply")&&"V2"===this.Dg.Aja){var zb=this.Dg.Jfb.JNe("AgendaToPptDialogThemeApply");this.Dg.telemetryData.TotalTimeTakenToMerge=zb.toString();vb.a(eh.zSa,
Z,zb,Ka)}else this.Dg.Jfb.r3j("OnAddSlidesClicked")?(zb=this.Dg.Jfb.JNe("OnAddSlidesClicked"),this.Dg.telemetryData.TotalTimeTakenToMerge=zb.toString(),vb.a(eh.zSa,Z,zb,Ka)):this.Dg.Jfb.r3j("OnTryAgainClicked")&&(zb=this.Dg.Jfb.JNe("OnTryAgainClicked"),this.Dg.telemetryData.TotalTimeTakenToMerge=zb.toString(),vb.a(eh.zSa,Z,zb,Ka));this.Dg.HPf=!1}Unn(){this.Dg.HPf=!1;if(!("Seen"in this.Dg.telemetryData)){this.Zta("OnAgendaCardShown");this.dbd.start();this.Dg.telemetryData.Seen="true";D.a.J(508692634,
813,50,"AgendaCard shown");const Z=(new ni(this.Dg.CDa,this.Dg.Aja)).qme("AgendaCardShown").uwh("Seen").N6a(this.Dg.documentOpenType).build();vb.a(eh.zSa,!0,0,Z);this.Dg.Dfh.L$m()}}Onn(){this.Dg.HPf?this.ian():this.F9m()}F9m(){this.Zta("OnAddSlidesClicked");this.dbd.stop();this.Dg.telemetryData.Tried="true";this.Dg.Jfb.Vxh("OnAddSlidesClicked");D.a.J(508692633,813,50,"AgendaCard tried in MS:{0}",this.dbd.MCd);const Z=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).qme("AgendaCardShown").ped("AddSlides").uwh("Tried").N6a(this.Dg.documentOpenType).build();
vb.a(eh.zSa,!0,this.dbd.MCd,Z);this.Dg.Dfh.han()}Znn(){this.Zta("OnAgendaToPPTApply");this.Dg.e7c=!0;this.Dg.telemetryData.Kept="true";this.Dg.telemetryData.Event="AgendaCompleted";const Z=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).qme("AgendaCompleted").N6a(this.Dg.documentOpenType).build();this.ZOl(!0,Z);D.a.J(508692632,813,50,"AgendaToPPT Completed successfully")}Jsn(){this.Dg.HPf=!0;this.Zta("OnTryAgainClicked");this.Dg.telemetryData.Tried="true";this.Dg.telemetryData.Event="AgendaTryAgain";
this.Dg.Jfb.Vxh("OnTryAgainClicked");D.a.J(508692631,813,50,"AgendaCard retry attempt")}ian(){const Z=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).qme("AgendaMergeError").ped("TryAgain").uwh("Tried").N6a(this.Dg.documentOpenType).build();vb.a(eh.zSa,!0,0,Z)}Xnn(){this.Zta("OnAgendaDialogShown");this.Dg.PIa="Loading";D.a.J(508692630,813,50,"AgendaDialog shown");const Z=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).UWc(this.Dg.PIa).N6a(this.Dg.documentOpenType).build();vb.a(eh.zSa,!0,0,Z)}YOl(Z){this.Zta("OnAgendaThemePaneLoadedSuccess");
this.Dg.PIa=Z?"ThemeSuggestions":"ThemeSuggestionsFailure";Z=this.Dg.Jfb.JNe("OnAddSlidesClicked");this.Dg.telemetryData.ThemePaneLoadingTime=Z.toString();const Ka=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).UWc(this.Dg.PIa).N6a(this.Dg.documentOpenType).build();vb.a(eh.zSa,!0,Z,Ka)}Asm(Z){this.Zta("ThemeDeckSuggestionId");this.Dg.telemetryData.SelectedDeckSuggestionId=Z}Hsn(Z){"V2"===this.Dg.Aja&&(this.Zta("OnTriggerDifferentThemeWorkflow"),this.Dg.PIa="ThemeSuggestions",this.Dg.Jfb.Vxh("TriggerDeckLevelDesigner_"+
Z),Z=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).UWc(this.Dg.PIa).Tvh(Z).ped("ThemeSelected").N6a(this.Dg.documentOpenType).build(),vb.a(eh.zSa,!0,0,Z))}XOl(Z,Ka){this.Zta("OnAgendaDeckPreviewLoaded");this.Dg.PIa=Ka?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";Ka=this.Dg.Jfb.JNe("TriggerDeckLevelDesigner_"+Z);this.Dg.telemetryData["DeckPreviewLoadTime_"+Z]=Ka.toString();Z=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).UWc(this.Dg.PIa).Tvh(Z).N6a(this.Dg.documentOpenType).build();
vb.a(eh.zSa,!0,Ka,Z)}Vnn(Z){const Ka=this.Dg.Jfb.JNe("TriggerDeckLevelDesigner_"+Z);this.Zta("OnAgendaDeckPreviewError");this.Dg.PIa="AgendaDeckPreviewError";let zb="";"DeckPreviewFailure"in this.Dg.telemetryData&&(zb=this.Dg.telemetryData.DeckPreviewFailure.toString());this.Dg.telemetryData.DeckPreviewFailure=zb+Z.toString()+";";Z=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).UWc(this.Dg.PIa).Tvh(Z).N6a(this.Dg.documentOpenType).build();vb.a(eh.zSa,!1,Ka,Z)}Ynn(Z,Ka){this.Zta("OnAgendaDialogThemeApply");
this.Dg.PIa=Ka?"AgendaDeckMergeError":this.Dg.PIa;this.Dg.Jfb.Vxh("AgendaToPptDialogThemeApply");Z=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).Tvh(Z).UWc(this.Dg.PIa).ped(Ka?"TryAgain":"Apply").N6a(this.Dg.documentOpenType).build();vb.a(eh.zSa,!0,0,Z)}tPl(){this.Zta("OnCancelClicked");this.Dg.e7c=!0;this.Dg.telemetryData.Kept="false";this.Dg.telemetryData.Event="AgendaCancelled";D.a.J(508692629,813,50,"AgendaToPPT clicked Cancel button");const Z=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).ped("Cancel").N6a(this.Dg.documentOpenType);
"V2"===this.Dg.Aja?Z.UWc(this.Dg.PIa):Z.qme("AgendaMergeError");vb.a(eh.zSa,!0,0,Z.build())}xpn(){this.Zta("OnDismissClicked");this.Dg.e7c=!0;this.Dg.telemetryData.Kept="false";this.Dg.telemetryData.Event="AgendaDismissed";D.a.J(508692628,813,50,"AgendaToPPT clicked Dismiss button");const Z=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).ped("Dismiss").N6a(this.Dg.documentOpenType);"V2"===this.Dg.Aja?Z.UWc(this.Dg.PIa):Z.qme("AgendaMergeError");vb.a(eh.zSa,!0,0,Z.build())}HQl(){this.Zta("OnMergingErrorInAgenda");
this.Dg.e7c=!0;this.Dg.telemetryData.Kept="false";this.Dg.telemetryData.Event="AgendaError";const Z=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).N6a(this.Dg.documentOpenType);"V2"===this.Dg.Aja?(this.Dg.PIa="AgendaMergeError",Z.UWc("AgendaMergeError")):Z.qme("AgendaMergeError");this.ZOl(!1,Z.build())}s2j(Z){let Ka=!1;this.Zta("OnUndoRedoClicked");let zb=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).N6a(this.Dg.documentOpenType);if("Kept"in this.Dg.telemetryData){this.Dg.telemetryData.Kept=
(!Z).toString();const dc=Z?"UndoClicked":"RedoClicked";this.Dg.telemetryData.Event=dc;zb=zb.ped(dc)}else Ka=!0,zb.ped("UndoRedoPostAgendaKept");vb.a(eh.zSa,!0,0,zb.build());D.a.J(508692627,813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!Z).toString(),Ka.toString())}lHn(Z){this.Zta("ReportCorrelationID");this.Dg.telemetryData.CorrelationId=Z;this.Dg.sSa=Z}qHn(Z){this.Zta("ReportInitialUserThemeType");this.Dg.telemetryData.InitialUserThemeType=Z;this.Dg.CDa=Z}Lqk(Z){this.Zta("ReportAgendaToPptFlowVersion");
this.Dg.telemetryData.AgendaToPptFlowVersion=Z;this.Dg.Aja=Z}iHn(Z){this.Zta("ReportAgendaScore");this.Dg.telemetryData.AgendaScore=Z.toString();1===Z&&this.pHn()}pHn(){this.Zta("ReportHighConfidenceAgendaDetected");this.Dg.telemetryData.HighConfidenceAgendaDetected="true";this.Dg.Dfh.Fkh=!0}dispose(){D.a.J(508692626,813,50,"AgendaToPPTMetrics: {0}",Yi.c(this.Dg.telemetryData))}sHn(){if(!this.Dg.telemetryData||!Ld.a.count(this.Dg.telemetryData))return"";const Z=Yi.c(this.Dg.telemetryData);if(this.Dg.xyh===
Z)return"";this.Dg.xyh=Z;if("Kept"in this.Dg.telemetryData){const Ka=(new ni(this.Dg.CDa,this.Dg.Aja)).Pbb(this.Dg.sSa).uwh("Kept").N6a(this.Dg.documentOpenType).build(),zb=Boolean.parse(this.Dg.telemetryData.Kept.toString());vb.a(eh.zSa,zb,0,Ka);zb&&this.Dg.Dfh.l$m()}this.Dg.e7c&&(this.iEk(),this.Dg.e7c=!1);D.a.J(508692625,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",this.Dg.xyh,this.Dg.e7c.toString());return Z}Zta(Z){this.Dg.telemetryData||(D.a.J(508692624,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",
Z),this.iEk())}static oOm(Z){return Z.isCreateNew?"NewDocument":Z.m1a?"ViewOnlyDocument":"EditDocument"}}eh.zSa="AgendaToPptEvents";Object(c.a)(eh,"AgendaMetrics",null,[1330]);class nj{constructor(){this.Aa=this.$=null;this.dLl=!0;this.tGl="AugLoop_AgendaDetection_AgendaDetectionAnnotation";this.Hya=null}get name(){return"PowerPointWebEditor.AgendaConverter"}lc(Z){this.$=Z;this.$.register(1330,"PowerPointWebEditor.IAgendaMetrics").ma().na(()=>new eh);this.$.register(De,"PowerPointWebEditor.AgendaConverter.AgendaConverterManager").ma().na(()=>
new De(this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),
this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.IAgendaMetrics"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(7),this.$.resolve("Common.IAppSettingsManager")));this.$.register(1331,"PowerPointWebEditor.IAgendaConverterUndoRedoController").ma().na(()=>new Af(this.$.resolve("PowerPointWebEditor.IAgendaMetrics"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager")));this.$.resolve("PowerPointWebEditor.IAgendaConverterUndoRedoController");
const Ka=Rg.a(this.$);rb.a("AgendaToPPT.DisableLocalizedStrings")?Ka("agendaConverter").then(()=>{this.$.register(1332,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().na(()=>new dg(this.$.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.IAgendaMetrics"),this.$.resolve("PowerPointWebEditor.IFocusManager")));this.$.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>
{}):Ka("powerpoint-agenda-to-ppt-strings").then(()=>{Ka("agendaConverter").then(()=>{this.$.register(1332,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().na(()=>new dg(this.$.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.IAgendaMetrics"),this.$.resolve("PowerPointWebEditor.IFocusManager")));this.$.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>
{})}).catch(()=>{})}init(){this.$.resolve("Common.IAppSettingsManager").fg(Object(e.a)(this,this.dEn,"registerAgendaDetectionEventHandler"))}dispose(){}dEn(){this.Aa=this.$.resolve("PowerPointWebEditor.IApplicationSettings");this.Hya=this.$.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager");const Z=this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Aa.Cpl&&this.dLl&&2===Z.mode&&(this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ka=>{Ka.e0(this.tGl);
Ka.LXl(this.tGl,Object(e.a)(this.Hya,this.Hya.Fna,"handleAnnotationEvent"))}),this.dLl=!1)}static main(){b.a.instance.Fc(new nj)}}Object(c.a)(nj,"AgendaConverterPackage",null,[3,4]);var Al=a(1103);class dl{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf){this.XZf=0;this.ia=Z;this.Db=Ka;this.la=zb;this.Ma=dc;this.rf=Jc;this.pa=jd;this.hq=Ed;this.DY=de;this.MF=Ne;this.EE=Re;this.ucc=Cf}Hb(){this.Lnm();this.la.yVl&&this.jrl()&&this.ucc.continueWith(()=>{this.ucc.result.logActivity("HasPresentInTeamsSeen",
"PresentToTeamsTeachingUIEnabled")})}Lnm(){this.ia.sa(sb.a.qdc,Na.a.application,Object(e.a)(this,this.qdc,"presentToTeams"),4);this.ia.sa(sb.a.FKe,Na.a.application,Object(e.a)(this,this.qdc,"presentToTeams"),4);this.ia.sa(sb.a.Ysh,Na.a.application,Object(e.a)(this,this.qdc,"presentToTeams"),4)}K0l(){this.MF.hide();this.KEi()}KEi(){let Z;Og.a.Xse();Z=this.wtn();this.showDialog();return Z}wtn(){this.EE.sbc=!0;const Z=Di.a.create().toString(),Ka=this.rf.documentUrl;try{const dc={};dc.pptSharingUrl=Al.b(Ka);
const Jc=encodeURIComponent(Eb.c(dc));let jd=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}","1",Z,Jc);if(!Va.a.rb(null)){const Ed=Rc.a.aN(null);jd=jd+"&fqdn="+Ed;const de=encodeURIComponent(Eb.c({joinUrl:null}));jd=jd+"&meetingContext="+de}var zb=jd;f.ULS.sendTraceTag(556541766,838,50,"actionId: {0}, deepLinkId: {1}",this.XZf,Z);window.open(zb,"_top")}catch(dc){return f.ULS.sendTraceTag(508692483,838,15,"PresentToTeamsActor: failed with error: {0}",dc),!1}return!0}showDialog(){const Z=
new va.a;Z.gf=4;Z.Fg(1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);Z.Fg(2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);Z.xG(ResourceStrings.l_PresentingFileInTeamsTitle,ResourceStrings.l_PresentingFileInTeamsMessage,0,Object(e.a)(this,this.n3b,"protocolLaunchingDialogResultHandler"))}n3b(Z){1===Z||0===Z?(f.ULS.sendTraceTag(508692482,838,50,"PresentToTeamsActor - restarting PPT session"),this.p6a()):2===Z&&(f.ULS.sendTraceTag(508692481,838,50,"PresentToTeamsActor - retry present to teams"),
this.ia.Cb(sb.a.Ysh,2))}p6a(){this.ia.Qa(sb.a.refresh,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"})}jrl(){return!!this.rf.documentUrl}qdc(Z,Ka,zb){if(!this.jrl())return f.ULS.sendTraceTag(508692480,838,10,"PresentToTeamsActor: Document not supported"),8;if(1===zb)return 32;this.XZf=Z;if(this.hq.isPaused)return this.Ma.Wd(),this.KEi()?32:8;this.pa.Ti();this.Ma.Wd();if(Z===sb.a.Ysh||1===this.Db.mode)return this.KEi()?32:8;this.DY.QJa(!0,!0,!0,()=>{this.K0l()},()=>{f.ULS.sendTraceTag(508692451,
838,15,"PresentToTeamsActor: ForceSave failed");this.K0l();return!0});this.MF.show(!1,this.XZf);return 32}M6(){}K6(){}}Object(c.a)(dl,"PresentToTeamsActor",null,[85]);class Zi{constructor(){this.$=null}get name(){return"PowerPointWebEditor.PresentToTeams"}lc(Z){this.$=Z}init(){h.AFrameworkApplication.ga.fg(()=>{(new dl(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Box4.IAppFrame"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.IFocusManager"),
this.$.resolve("PowerPoint.IPathManager"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("Box4.IReplicationScheduler"),this.$.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),this.$.resolve("PowerPointWebEditor.ISaveBlockingUI"),this.$.resolve("PowerPointWebEditor.IApplicationContext"),Me.a.aG(l.a.instance.Na("Common.ISystemInitiatedFeedback")))).Hb()})}dispose(){}static main(){b.a.instance.Fc(new Zi)}}Object(c.a)(Zi,"PPTWebEditorPresentToTeamsPackage",null,[3,
4]);var Sj=a(1494),Ei=a(134);class oj{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.CorrelationId=null;this.SuggestionSid=this.SuggestionCid=0}}Object(c.a)(oj,"DesignerSuggestionApplyInfo",null,[]);var fk=a(824),zk=a(879),nl=a(317);class Ck{constructor(){this.Jbh=null}}Object(c.a)(Ck,"IdeasSlideSuggestionWrapper",null,[]);var Ak=a(302);class Pk{constructor(){this.trigger=null;this.cid=this.sid=0;this.Ina=null;this.timestamp=new Date;this.correlationId=Di.a.create().toString()}}Object(c.a)(Pk,
"DesignerRequestData",null,[]);var vl=a(71);class Bl{}Object(c.a)(Bl,"SlideSuggestionData",null,[]);class Zf{}Zf.ygn="mivTitle";Zf.xgn="mivSubtitle";Zf.arh="mivContainer";Zf.wgn="mivButtonsContainer";Zf.LNl="mivButton";Zf.vgn="mivButtonImage";Zf.hIe="mivOverlayContainer";Zf.uUj="mivIcon";Zf.iIe="mivTerm";Zf.NNl="mivFrame";Zf.zgn="mivView";Zf.ONl="mivIdx";Zf.wUj="mivKeepFocusStart";Zf.vUj="mivKeepFocusEnd";Zf.rpl="Editor";Zf.Qxi="EditorContainer";Zf.nGm="EditorTitle";Zf.kGm="EditorSubtitleContainer";
Zf.tpl="EditorSubtitle";Zf.$Fm="EditorBucketContainer";Zf.VCd="EditorPrev";Zf.btf="EditorPrevDisabled";Zf.qBe="EditorPrevEnabled";Zf.Pxi="EditorBucketCurrent";Zf.aGm="EditorBucketTotalCount";Zf.ipl="EditorBucketTotal";Zf.oBe="EditorNext";Zf.pBe="EditorNextEnabled";Zf.atf="EditorNextDisabled";Zf.dGm="EditorDescription";Zf.gGm="EditorIgnoreContainer";Zf.Zsf="EditorIgnore";Zf.jGm="EditorSeeMoreContainer";Zf.etf="EditorSeeMoreLabel";Zf.jpl="EditorCardContent";Zf.wpl="EditorSuggestionsContainer";Zf.O6c=
"EditorSuggestionContainer";Zf.cfh="EditorSuggestionArrow";Zf.lGm="EditorSuggestionCheck";Zf.vpl="EditorSuggestionText";Zf.upl="EditorSuggestionInstances";Zf.hGm="EditorNoMoreContainer";Zf.mGm="EditorSvgCheck";Zf.pGm="EditorWhiteCheck";Zf.fGm="EditorGreenFill";Zf.eGm="EditorGreenBorder";Zf.iGm="EditorNoMoreLabel";Object(c.a)(Zf,"IdeasCss",null,[]);class Ki{}Ki.VMf="IdeasPane";Ki.N6c="editorSuggestionIdx";Ki.lca="ClosePane";Ki.y0m="IdeasPaneOpen";Ki.Jsg=6;Ki.Vfn=3;Ki.vnl="Architecture Backgrounds Cities Nature People Technology".split(" ");
Object(c.a)(Ki,"IdeasPaneConstants",null,[]);var Xg=a(701),el=a(358),Dj=a(385);class Sg{constructor(Z,Ka,zb,dc,Jc,jd,Ed){this.T6f=null;this.va=Z;this.oc=Ka;this.la=zb;this.Vd=dc;this.wph=(Z=this.la.cfc)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";this.xph=Z?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.Tb=Jc;this.rf=jd;this.YFe=Ed}xun(Z){const Ka=[];try{if(!Z||!Z.SlideSuggestions)return D.a.J(510248778,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse"),
Ka;for(let zb=0;zb<Z.SlideSuggestions.length;zb++){if(!Z.SlideSuggestions[zb])continue;const dc=Z.SlideSuggestions[zb].Base64Img;let Jc=null;try{Jc=Object.assign(new Bl,{suggestionIndex:Z.SlideSuggestions[zb].Index.toString(),suggestionCid:Z.SlideSuggestions[zb].SlideId.Cid.toString(),suggestionSid:Z.SlideSuggestions[zb].SlideId.Sid.toString(),imageData:dc.startsWith("data:image")?dc:"data:image/png;base64,"+dc,label:String.format(ResourceStrings.l_DesignerSuggestionItem,zb+1)})}catch(jd){D.a.J(510248777,
829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),Jc=null}Jc||(Jc=Object.assign(new Bl,{suggestionIndex:Z.SlideSuggestions[zb].Index.toString(),suggestionSid:Z.SlideSuggestions[zb].SlideSid.toString(),imageData:dc.startsWith("data:image")?dc:"data:image/png;base64,"+dc,label:String.format(ResourceStrings.l_DesignerSuggestionItem,zb+1)}));Array.add(Ka,Jc)}}catch(zb){D.a.J(510248776,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",
zb)}return Ka}aOm(Z,Ka,zb){if(!Z)throw Error.argumentNull("suggestionsContainer");return Z.querySelector("#"+Ka+" ."+Sg.soc+'[correlationId="'+zb+'"]')}XYi(){return this.la.Snl?this.la.Rnl:this.la.Qnl}Cjh(Z){if(!this.la.PSa)return!1;let Ka=!0;switch(Z){case Xg.a.moreIdeas:Ka=!1;break;case Xg.a.Crb:Ka=!1}return Ka}fqk(Z){D.a.J(510248775,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",this.Vd.correlationId,Z.UEd);if(Z.RAe&&Z.Cfh&&Z.wDb){var Ka=this.Pej(),zb=Z.wDb.parentNode.parentNode.id;
if(Z.GJk&&this.la.gsc&&Z.UEd)switch(Z.RAe.DocumentUpsellStatus){case 0:this.upm(Z.wDb);break;case 1:this.vom(Z.wDb);break;case 2:this.mom(Z.wDb)}Z.UEd&&this.la.ktf&&this.JZl(Z.wDb);var dc=Z.UEd?this.HAm(Z.Cfh,Z.Wh,Z.wDb,Ka,Z.Rzh):this.aOm(Z.wDb,zb,Z.Wh);if(dc)try{const jd=this.Vd.B5c,Ed=!sd.a.rb(jd)&&zb===Ki.VMf,de=this.jvm(Z.RAe,Ed,jd);if(Z.UEd){this.Vd.iRk=new Date;Z.Rzh&&this.fSn(Z.PHm);for(var Jc=0;Jc<dc.childNodes.length;Jc++){const Ne=dc.childNodes[Jc];Z.Rzh&&this.QOn(de,Jc)?Sg.UPn(Ka,Jc,Ne):
this.Gpk(Ed?jd[Jc].Type:0,Z.wDb,Ne,zb,Z.Cfh,de[Jc.toString()],Jc,Z.GJk,Z.RAe.DocumentUpsellStatus)}this.la.Rzb&&Z.RAe.HasPaginationInfo&&this.a5l(Z.wDb,Z.Wh)}else if(Z.Rzh){D.a.J(510248774,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",this.Vd.correlationId,Ld.a.count(de));for(Jc of Object.keys(de)){const Ne=parseInt(Jc),Re=Z.wDb.querySelector("#"+zb+" ["+Sg.yoc+'="'+Ne+'"]');de[Jc]&&Re&&Sys.UI.DomElement.containsCssClass(Re.firstChild,
"IncSuggestionPlaceholder")&&this.Gpk(Ed?jd[Ne].Type:0,Z.wDb,Re,zb,Z.Cfh,de[Jc],Ne,Z.GJk,Z.RAe.DocumentUpsellStatus)}}}catch(jd){D.a.J(510248773,829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",this.Vd.correlationId,jd)}}}RGn(Z,Ka,zb,dc){try{if(!(Z&&Z.SlideSuggestions&&Z.SlideSuggestions.length&&Ka))return!1;this.djh(Ka);const Jc=Ka.querySelector("."+Sg.soc);if(!Jc)return!1;const jd=Jc.childNodes.length,Ed=Jc.childNodes.length+Z.SlideSuggestions.length,de=this.Pej(),
Ne=Ka.parentNode.parentNode.id;for(let Re=0;Re<Z.SlideSuggestions.length;++Re){const Cf=this.lml(jd+Re,Ed,de);this.Gpk(0,Ka,Cf,Ne,Ed,Z.SlideSuggestions[Re],jd+Re,dc,Z.DocumentUpsellStatus);Jc.appendChild(Cf)}Z.HasPaginationInfo&&this.a5l(Ka,zb);return!0}catch(Jc){return D.a.J(510248772,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",Jc),!1}}jvm(Z,Ka,zb){const dc={};if(Ka)for(const Jc of zb)switch(Jc.Type){case 0:Ka=Jc;zb=null;for(const jd of Z.SlideSuggestions)if(jd.Index===Ka.IndexInDesigner){zb=
jd;break}dc[Jc.Index.toString()]=zb;break;default:dc[Jc.Index.toString()]=Jc}else for(const Jc of Z.SlideSuggestions)dc[Jc.Index.toString()]=Jc;return dc}QOn(Z,Ka){Ka=Ka.toString();return!(Ka in Z)||!Z[Ka]}upm(Z){const Ka=Kb.a.hg();Ka.className="DesignerFreeTrialCardContainer";const zb=Kb.a.hg();zb.className="DesignerFreeTrialCardTitle";zb.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;const dc=Kb.a.hg();dc.className="DesignerFreeTrialCardContent";dc.innerText=String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,
this.XYi());const Jc=Kb.a.hg();Jc.className="DesignerStartFreeTrialButtonsContainer";const jd=Kb.a.hg();jd.className=Sg.Qze;jd.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;jd.tabIndex=0;jd.setAttribute(Ga.a.yz,jd.innerText);jd.setAttribute(Ga.a.pi,Ga.a.BL);const Ed=Kb.a.hg();Ed.className=Sg.xch;const de=document.createElement("i");de.className=Sg.Cch;de.style.lineHeight="20px";de.setAttribute("Unselectable","on");const Ne=Kb.a.hg();Ne.className="DesignerStartTrialGoPremiumButtonText";
Ne.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Ne.setAttribute("Unselectable","on");Ed.setAttribute(Ga.a.yz,Ne.innerText);Ed.setAttribute(Ga.a.pi,Ga.a.BL);Ed.tabIndex=0;Ed.appendChild(de);Ed.appendChild(Ne);Jc.appendChild(jd);Jc.appendChild(Ed);Ka.appendChild(zb);Ka.appendChild(dc);Ka.appendChild(Jc);Ka.setAttribute(Ga.a.yz,String.format("{0}. {1}",zb.innerText,dc.innerText));Ka.setAttribute(Ga.a.pi,Ga.a.qzb);Z.appendChild(Ka)}Aml(){const Z=Kb.a.hg();Z.className="DesignerInFreeTrialView";
const Ka=document.createElement("i");Ka.className=h.AFrameworkApplication.isRtl?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";const zb=Kb.a.hg();zb.className=Sg.Tff;zb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;zb.tabIndex=0;const dc=Kb.a.hg();dc.className=h.AFrameworkApplication.isRtl?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";dc.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;zb.setAttribute(Ga.a.pi,
Ga.a.Pbh);zb.setAttribute(Ga.a.q$b,Ga.a.ksa);zb.setAttribute(Ga.a.yz,zb.innerText);Z.appendChild(Ka);Z.appendChild(zb);Z.appendChild(dc);Z.setAttribute(Ga.a.yz,zb.innerText+" "+dc.innerText);Z.setAttribute(Ga.a.pi,Ga.a.qzb);return Z}YUn(){const Z=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(Z)for(let Ka=0;Ka<Z.length;Ka++){const zb=Z[Ka];if(zb.parentNode){const dc=this.Aml();zb.parentNode.replaceChild(dc,zb)}}this.h9l()}vom(Z){const Ka=this.Aml();Z.appendChild(Ka)}mom(Z){const Ka=
Kb.a.hg();Ka.className="DesignerFreeTrialCardContainer";const zb=Kb.a.hg();zb.className="DesignerFreeTrialCardTitle";zb.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle;const dc=Kb.a.hg();dc.className="DesignerFreeTrialCardContent";dc.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent;const Jc=Kb.a.hg();Jc.className=Sg.Sff;const jd=document.createElement("i");jd.className=Sg.Cch;jd.style.lineHeight="20px";const Ed=Kb.a.hg();Ed.className="DesignerTrialExhaustedGoPremiumButtonText";
Ed.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Jc.setAttribute(Ga.a.yz,Ed.innerText);Jc.setAttribute(Ga.a.pi,Ga.a.BL);Jc.tabIndex=0;Jc.appendChild(jd);Jc.appendChild(Ed);Ka.appendChild(zb);Ka.appendChild(dc);Ka.appendChild(Jc);Ka.setAttribute(Ga.a.yz,String.format("{0}. {1}",zb.innerText,dc.innerText));Ka.setAttribute(Ga.a.pi,Ga.a.qzb);Z.appendChild(Ka)}a5l(Z,Ka){const zb=Kb.a.hg();zb.className=Sg.Bch;zb.setAttribute(Sg.Pze,Ka);zb.tabIndex=0;Ka=new Dj.a;Ka.mh(16,16);Ka.AUa("0,0,2048,2048");
const dc=new el.a;dc.Bka("M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");
Ka.appendChild(dc);Ka=Ka.ta;Ka.setAttribute("class","DesignerMoreIdeasButtonIcon");zb.appendChild(Ka);Ka=Kb.a.hg();Ka.className="DesignerMoreIdeasButtonLabel";Ka.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;zb.appendChild(Ka);zb.setAttribute(Ga.a.yz,Ka.innerText);zb.setAttribute(Ga.a.pi,Ga.a.BL);Z.appendChild(zb)}bQn(Z){if(Z){var Ka=Kb.a.uJ();Ka.className="DesignerMoreIdeasLoading";Ka.src=qb.a.mX(Ge.a.nUa);Z.appendChild(Ka)}}djh(Z){if(Z){var Ka=Z.querySelector("."+Sg.Bch);Ka&&Z.removeChild(Ka);
(Ka=Z.querySelector(".DesignerMoreIdeasLoading"))&&Z.removeChild(Ka)}}HAm(Z,Ka,zb,dc,Jc){const jd=Kb.a.hg();jd.className=Sg.soc;jd.setAttribute(Sg.Pze,Ka);jd.setAttribute(Ga.a.yz,ResourceStrings.l_DesignerSuggestions);jd.setAttribute(Ga.a.pi,Ga.a.Hnc);Jc&&(this.Vd.Lhf=this.DMm());for(Ka=0;Ka<Z;++Ka)jd.appendChild(this.lml(Ka,Z,dc));zb.appendChild(jd);return jd}lml(Z,Ka,zb){const dc=Kb.a.hg();dc.className=zb?this.wph+"4x3":this.wph;dc.setAttribute(Sg.yoc,Z);dc.tabIndex=0;dc.setAttribute(Ga.a.yz,String.format(ResourceStrings.l_DesignerSuggestionItem,
Z+1));dc.setAttribute(Ga.a.pi,Ga.a.q9a);dc.setAttribute(Ga.a.rze,Z+1);dc.setAttribute(Ga.a.sze,Ka);return dc}Gpk(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne){let Re=null;this.la.PSa&&(Ka&&(Re=Ka.querySelector("#"+dc+' [IncSuggestionPlaceholder="'+Ed+'"]')),Re&&Sys.UI.DomElement.addCssClass(Re,"ShimmerPaused"),this.k$m(Ed,Jc));Ka=!1;switch(Z){case 0:this.hNn(zb,jd,Ed);Ka=(Z=de&&this.la.gsc)&&1!==Ne;Jc=dc=Ne=!1;if(jd&&jd.Categories)for(const Cf of jd.Categories)2===Cf?Ne=de&&!Z:1===Cf?dc=!0:3===Cf?Jc=!0:4===Cf&&this.daj(zb,
"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,Ed);(Ne||Ka)&&this.wNn(zb);dc?this.daj(zb,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,Ed):Jc&&(this.daj(zb,"commoncontrolanimationsuggestioniconnoborder.svg",ResourceStrings.l_DesignerAnimationSuggestionItem,Ed),zb.setAttribute(Sg.H$h,Sg.H$h),zb.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Designer.EnableDesignDescriptions",
!1)&&this.bom(zb,jd);break;case 1:this.PGn(zb,jd);break;case 2:this.LGn(zb);break;case 3:case 4:this.WGn(zb,jd)}Re&&Re.parentNode.removeChild(Re);jd=Kb.a.hg();jd.className=Sg.Fch;Ka&&(jd.style.visibility=kc.a.visible,zb.removeAttribute("tabindex"),zb.setAttribute(Ga.a.RM,Ga.a.uE));zb.appendChild(jd)}PGn(Z,Ka){if(Ka){Z.className=Zf.arh;Z.setAttribute(Ga.a.yz,ResourceStrings.L_MakeItVisualCardTitle);var zb=Kb.a.yx();zb.className=Zf.ygn;zb.innerText=ResourceStrings.L_MakeItVisualCardTitle;var dc=Kb.a.yx();
dc.className=Zf.xgn;dc.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;var Jc=Kb.a.hg();Jc.className=Zf.wgn;Jc.setAttribute(Ga.a.pi,Ga.a.Hnc);var jd=0,Ed=new cl.a,de=Math.min(Ki.Jsg,Ka.SearchTerms.length);for(let Ne=0;Ne<de;Ne++)jd=this.Gml(Ka.SearchTerms[Ne].Term,Jc,Ed,Ne,jd);for(Ka=de;Ka<Ki.Jsg;Ka++)for(const Ne of Ki.vnl)if(!Ed.contains(Ne)){jd=this.Gml(Ne,Jc,Ed,Ka,jd);break}Z.appendChild(zb);Z.appendChild(dc);Z.appendChild(Jc);this.Vd.Kqh=!0}}Gml(Z,Ka,zb,dc,Jc){const jd=Kb.a.hg();jd.className=
Zf.LNl;jd.setAttribute(Ga.a.pi,Ga.a.q9a);const Ed=Zf.iIe+"."+dc,de=Kb.a.uJ();de.className=Zf.vgn;de.src=(()=>{let Cf=this.oQm(Z,zb,Jc);({$ac:Jc}=Cf);return Cf})().returnValue;de.setAttribute(Ga.a.rma,Ed);const Ne=Kb.a.hg();Ne.className=Zf.hIe;Ne.tabIndex=0;Ne.setAttribute(Zf.ONl,dc);Ne.setAttribute(Ga.a.pi,Ga.a.BL);dc=document.createElement("i");dc.className=Zf.uUj;dc.innerText="\ue721";dc.setAttribute(Ga.a.pi,Ga.a.KZ);const Re=Kb.a.yx();Re.className=Zf.iIe;Re.innerText=Z;Re.id=Ed;jd.appendChild(de);
jd.appendChild(Ne);Ne.appendChild(dc);Ne.appendChild(Re);Ka.appendChild(jd);return Jc}oQm(Z,Ka,zb){for(const dc of Ki.vnl)if(dc.toLowerCase()===Z.toLowerCase())return Ka.add(dc),{returnValue:this.rf.Yp(Z+".png"),$ac:zb};return{returnValue:this.rf.Yp("stock"+zb++ +".png"),$ac:zb}}gNn(Z,Ka){if(Z){var zb=document.createElement("video");zb.className="SuggestedVideoBackgroundContainer";zb.setAttribute("Src",Ka);zb.setAttributeNode(document.createAttribute("muted"));vl.a.N5m()||(zb.setAttributeNode(document.createAttribute("autoplay")),
zb.setAttributeNode(document.createAttribute("loop")),zb.addEventListener("canplay",()=>{zb.muted="true";zb.play()}));Z.appendChild(zb)}}daj(Z,Ka,zb,dc){if(Z){var Jc=Kb.a.uJ();Jc.src=this.rf.Yp(Ka);Jc.className="SuggestedMediaIcon";Ka=Kb.a.yx();Ka.className="SuggestedMediaContainer";Ka.appendChild(Jc);Z.setAttribute(Ga.a.yz,String.format(zb,dc+1));Ka.setAttribute("aria-hidden",Ga.a.uE);Ka.setAttribute("Unselectable","on");Z.appendChild(Ka)}}bom(Z,Ka){Z&&Ka&&Ka.DesignDescription&&0!=Ka.DesignDescription.length&&
Z.setAttribute(Ga.a.yz,Ka.DesignDescription)}wNn(Z){if(Z)if(this.la.gsc)Sys.UI.DomElement.addCssClass(Z,kc.a.wcd);else{Z.setAttribute(Sg.Ach,Sg.Ach);var Ka=Z.getAttribute(Ga.a.yz);Ka&&Z.setAttribute(Ga.a.yz,String.format("{0}. {1}",Ka.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem));Ga.a.Uia(Z,Ga.a.q$b,Ga.a.ksa);Ka=Kb.a.hg();Ka.className=Sg.Dch;var zb=document.createElement("i");zb.className=Sg.Cch;Ka.appendChild(zb);Z.appendChild(Ka)}}h9l(){const Z=document.getElementsByClassName(Sg.zgf);
if(Z)for(let Ka=0;Ka<Z.length;Ka++){Sys.UI.DomElement.removeCssClass(Z[Ka].parentNode,kc.a.wcd);Z[Ka].parentNode.tabIndex=0;Z[Ka].parentNode.removeAttribute(Ga.a.RM);const zb=Oa.a.Afa(Z[Ka].parentNode,Sg.Fch);!zb||zb.getAttribute(Sg.Dai)&&zb.getAttribute(Sg.Dai).toString()===Sg.Cil||(zb.style.visibility=kc.a.hidden)}}RWn(){if(this.la.gsc){var Z=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(Z)for(var Ka=0;Ka<Z.length;Ka++)Z[Ka].parentNode.removeChild(Z[Ka]);if(Z=document.getElementsByClassName("DesignerInFreeTrialView"))for(Ka=
0;Ka<Z.length;Ka++)Z[Ka].parentNode.removeChild(Z[Ka]);this.h9l()}else if(Z=document.getElementsByClassName(Sg.Dch))for(Ka=0;Ka<Z.length;Ka++){Z[Ka].style.display="none";const dc=Z[Ka].parentNode;dc.removeAttribute(Sg.Ach);dc.removeAttribute(Ga.a.q$b);var zb=dc.getAttribute(Ga.a.yz);zb&&(zb=zb.toString(),zb=zb.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,""),dc.setAttribute(Ga.a.yz,zb))}}hNn(Z,Ka,zb){if(Z&&Ka)try{let dc=!1;try{Z.setAttribute(Sg.Jwd,Ka.SlideId.Sid),Z.setAttribute(Sg.Ech,
Ka.SlideId.Cid),dc=!0}catch(jd){D.a.J(510248771,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),dc=!1}dc||Z.setAttribute(Sg.Jwd,Ka.SlideSid);const Jc=Kb.a.uJ();Jc.className=Sg.zgf;Jc.src=Ka.Base64Img;this.Vd.T$b.contains(Ka.Index)||this.Vd.T$b.add(Ka.Index);this.la.v6c&&!Va.a.rb(Ka.DesignerMediaURL)&&Ka.Categories&&sd.a.contains(Ka.Categories,1)&&this.gNn(Z,Ka.DesignerMediaURL);Z.appendChild(Jc);D.a.J(510248770,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",
zb,this.Vd.correlationId)}catch(dc){Z.parentNode.removeChild(Z),D.a.J(510248769,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",zb,this.Vd.correlationId,dc)}}LGn(Z){if(sd.a.rb(this.Vd.WSa)||!this.Vd.izm())Z.style.display=kc.a.none;else{Z.className=Zf.Qxi;var Ka=Kb.a.yx();Ka.className=Zf.nGm;Ka.innerText=ResourceStrings.L_ConsistencyCardTitle;var zb=Kb.a.hg();zb.className=Zf.kGm;var dc=Kb.a.yx();dc.className=dc.id=Zf.tpl;
dc.innerText=dc.title=this.Vd.WSa[0].critiques[0].explanationLabel;var Jc=Kb.a.hg();Jc.className=Zf.$Fm;var jd=Kb.a.yx();jd.innerText="<";jd.tabIndex=0;Sys.UI.DomElement.addCssClass(jd,Zf.VCd);Sys.UI.DomElement.addCssClass(jd,Zf.btf);jd.id=Zf.VCd;var Ed=Kb.a.yx();Ed.innerText="1";Ed.id=Zf.Pxi;this.Vd.hwa=0;var de=Kb.a.yx();de.innerText="/";var Ne=Kb.a.yx();Ne.className=Zf.aGm;Ne.id=Zf.ipl;Ne.innerText=this.Vd.WSa.length.toString();var Re=Kb.a.yx();Re.innerText=">";Re.tabIndex=0;Re.className=Re.id=
Zf.oBe;0<this.Vd.WSa.length-1?Sys.UI.DomElement.addCssClass(Re,Zf.pBe):Sys.UI.DomElement.addCssClass(Re,Zf.atf);Jc.appendChild(jd);Jc.appendChild(Ed);Jc.appendChild(de);Jc.appendChild(Ne);Jc.appendChild(Re);zb.appendChild(dc);zb.appendChild(Jc);dc=Kb.a.yx();dc.className=Zf.dGm;dc.innerText=ResourceStrings.L_ConsistencyCardDescription;Jc=Sg.mml();this.zyl(Jc,0);jd=Kb.a.hg();jd.className=Zf.gGm;Ed=Kb.a.hg();Ed.className=Zf.Zsf;Ed.innerText=ResourceStrings.L_ConsistencyCardIgnore;Ed.title=ResourceStrings.L_ConsistencyCardIgnoreTitle;
Ed.tabIndex=0;jd.appendChild(Ed);Ed=Kb.a.hg();Ed.className=Zf.jGm;de=Kb.a.yx();de.className=Zf.etf;de.innerText=ResourceStrings.L_ConsistencyCardSeeMore;de.tabIndex=0;Ed.appendChild(de);de=Kb.a.hg();de.id=Zf.jpl;de.appendChild(zb);de.appendChild(dc);de.appendChild(Jc);de.appendChild(jd);Z.appendChild(Ka);Z.appendChild(de);Z.appendChild(Ed);this.Vd.bfh=!0}}WGn(Z,Ka){if(Ka){Z.className=Sg.Hil;Z.setAttribute(Ga.a.yz,Ka.TitleText);Z.setAttribute(Sg.yoc,Ka.Index);var zb=this.cTn(Ka.ExecutionActionName);
if(zb){var dc=Kb.a.uJ();dc.src=this.rf.Yp("pegal.png");dc.className=zb;var Jc=Kb.a.yx();Jc.className="cui-img-container cui-img-24by24";Jc.appendChild(dc);Z.appendChild(Jc)}dc=Kb.a.yx();dc.className="DesignerSuggestedActionTitle";dc.innerText=Ka.TitleText;Jc=Kb.a.yx();Jc.className="DesignerSuggestedActionSubtitle";Jc.innerText=Ka.DescriptionText;Ka=Kb.a.hg();Ka.className=zb?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";Ka.appendChild(dc);Ka.appendChild(Jc);Z.appendChild(Ka)}}JZl(Z){try{if(this.YFe&&
this.YFe.instance){const Ka=Kb.a.hg();Ka.id="AgendaCardContainer";Ka.className="AgendaCardContainer";Z.appendChild(Ka);this.YFe.instance.A4l(Ka)}}catch(Ka){D.a.J(510248768,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Vd.correlationId,Ka)}}txm(){try{this.YFe&&this.YFe.instance&&this.YFe.instance.X7i()}catch(Z){D.a.J(510248729,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Vd.correlationId,
Z)}}cTn(Z){switch(Z){case "PowerPointConvertImageToTable":return"pegal_ImageToTable_24x24x32";default:return null}}zyl(Z,Ka){Ka=this.Vd.WSa[Ka].critiques[0].suggestions;const zb=Math.min(Ki.Vfn,Ka.length);for(let dc=0;dc<zb;dc++)this.bXm(Z,Ka[dc].description,Ka[dc].numberOfInstances,dc)}bXm(Z,Ka,zb,dc){const Jc=Kb.a.hg();Jc.className=Zf.O6c;Jc.tabIndex=0;Jc.setAttribute(Ki.N6c,dc);const jd=Kb.a.yx();jd.className=Zf.cfh;jd.innerText="\u2192";jd.setAttribute(Ki.N6c,dc);const Ed=Kb.a.yx();Ed.className=
Zf.vpl;Ed.innerText=Ka;Ed.setAttribute(Ki.N6c,dc);Ka=Kb.a.yx();Ka.className=Zf.upl;Ka.innerText=String.format("[{0}]",zb);Ka.setAttribute(Ki.N6c,dc);Jc.appendChild(jd);Jc.appendChild(Ed);Jc.appendChild(Ka);Z.appendChild(Jc)}fSn(Z){this.Yxh();this.T6f=new H.a(2,1,this.la.reh,()=>{this.j$m(Z)},void 0,"IncrementalRenderTimeoutTask");this.Tb.Qb(this.T6f)}Yxh(){this.T6f&&(this.Tb.li(this.T6f),this.T6f=null)}j$m(Z){this.Yxh();for(let Ka=0;Ka<Z;Ka++)this.Vd.T$b.contains(Ka)||this.Vd.Bjh.add(Ka)}k$m(Z,Ka){if(!this.Vd.A5c.contains(Z)&&
(this.Vd.A5c.add(Z),Z=this.Vd.A5c.count,Z===Ka&&(this.Vd.mbf=new Date,this.Yxh()),!this.Vd.xPe&&Z>=this.Vd.Lhf)){for(Ka=0;Ka<this.Vd.Lhf;Ka++)if(!this.Vd.A5c.contains(Ka))return;this.Vd.xPe=new Date}}DMm(){const Z=document.getElementById("WACDocumentPanel");if(Z){const Ka=this.la.cfc,zb=this.Pej();return Math.floor((Z.offsetHeight-87)/(Ka||zb?135:101))}return 1}Pej(){const Z=this.lB();return.01>=Math.abs(Z.width/Z.height-1.33)}Mjl(Z,Ka){this.AZk(this.qCe(Z,Ka),Ka,!1)}W1l(Z,Ka){this.AZk(Z,Ka,!0)}wWn(Z){if(Z&&
(Z=Z.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var Ka=-1!==Z.className.indexOf("4x3");this.AZk(Z,Ka,!1)}}AZk(Z,Ka,zb){Z&&(zb?(Z.className=Ka?this.xph+"4x3":this.xph,Ga.a.Uia(Z,Ga.a.qKb,Ga.a.uE)):(Z.className=Ka?this.wph+"4x3":this.wph,Ga.a.Uia(Z,Ga.a.qKb,Ga.a.ksa)))}lB(){return this.oc.lB()}qCe(Z,Ka){return Z.querySelector("."+(Ka?this.xph+"4x3":this.xph))}get Ga(){return Object(v.a)(32,
this.va.Ga)}g1l(Z,Ka){if(Z){if(Z=Z.querySelector("["+Sg.yoc+'="'+Ka+'"]'))Ka=Ac.a.Ni(Z),Z.contains(Ac.a.sPb(new Sys.UI.Point(Ka.x,Ka.y)))&&Z.contains(Ac.a.sPb(new Sys.UI.Point(Ka.x+Ka.width-1,Ka.y)))?Z.contains(Ac.a.sPb(new Sys.UI.Point(Ka.x,Ka.y+Ka.height-1)))&&Z.contains(Ac.a.sPb(new Sys.UI.Point(Ka.x+Ka.width-1,Ka.y+Ka.height-1)))||Z.scrollIntoView(!1):Z.scrollIntoView(!rb.a("Designer.ScrollIntoViewFix"))}else D.a.J(510248728,829,15,"Designer view has been removed from DesignerViewContainer")}static Tti(Z){let Ka=
null;try{Ka=Eb.a(Z)}catch(zb){D.a.J(510248727,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return Ka}static fun(Z){const Ka=Z.CardData;let zb=null;try{if(zb=Eb.a(Ka),!Z.SlideSuggestions&&zb)for(zb=Ag.e(zb,dc=>0!==dc.Type),Z=0;Z<zb.length;Z++)zb[Z].Index=Z}catch(dc){D.a.J(510248726,829,10,"parsing cards failed with exception: {0}",dc)}return zb}static UPn(Z,Ka,zb){zb.style.backgroundColor="white";const dc=Kb.a.hg();dc.className=Z?"IncSuggestionPlaceholder placeholder_237x178":
"IncSuggestionPlaceholder placeholder_237x137";dc.setAttribute("IncSuggestionPlaceholder",Ka);(za.a.hm||za.a.zg)&&Sys.UI.DomElement.addCssClass(dc,"Shimmer");zb.appendChild(dc)}static mml(){const Z=Kb.a.hg();Z.className=Z.id=Zf.wpl;return Z}}Sg.soc="DesignerSuggestionList";Sg.Pze="correlationId";Sg.yoc="suggestionIndex";Sg.Jwd="slideId";Sg.Ech="slideCid";Sg.Ach="isShownAsPremiumContent";Sg.H$h="containsAnimation";Sg.Cil="Refreshing";Sg.Dai="SourceTrigger";Sg.zgf="SuggestionImg";Sg.Cch="ms-Icon ms-Icon--Diamond";
Sg.Dch="ShadowedTriangleContainer";Sg.Fch="DesignerSuggestionListDisabled";Sg.Bch="DesignerMoreIdeasButton";Sg.Hil="DesignerSuggestedActionResult";Sg.Tff="DesignerInFreeTrialViewGoPremiumText";Sg.Sff="DesignerFreeTrialCardGoPremiumButton";Sg.Qze="DesignerStartFreeTrialButton";Sg.xch="DesignerStartFreeTrialGoPremiumButton";Object(c.a)(Sg,"DesignerViewHelper",null,[1321]);class Jk{constructor(){this.cid=this.sid=0;this.mjh=this.Ina=this.trigger=null}}Object(c.a)(Jk,"PendingRequest",null,[]);class lk{constructor(){this.yNj=
!1;this.CIc=null}get oDl(){return this.yNj}get KEl(){return this.CIc}static get e8(){const Z=new lk;Z.yNj=!0;Z.CIc=new Date;return Z}static get ready(){const Z=new lk;Z.yNj=!1;Z.CIc=null;return Z}}Object(c.a)(lk,"RequestState",null,[]);var Bi=a(823),wk=a(591);class Cl{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah,Ui,$g,oh,Jh,ti,Mj,Yl,em,Wh,tk,Zk,Fl,yk,dk,Ej,il,Dk){this.nta=null;this.SMc=this.OIl=0;this.SJl=!1;this.n$c=this.cnh=this.P$c=null;this.GHl=!1;this.WJl=0;this.dcc=!1;this.RWm=(sm,hk,
im)=>{if(1===im)return 32;try{this.aD&&this.aD.KE&&this.aD.KE.isVisible?Bb.a.Py().then(Nl=>{Nl.setSelectedTaskPane(Fa.a.Uma);return null}).catch(Nl=>{D.a.J(509354911,811,10,"DesignerPane::SelectPane exception: {0}",Nl.toString())}):this.ia.Cb(sb.a.pEd,2)}catch(Nl){return D.a.J(509354910,811,10,"DesignerPane::OpenOrSelectPane exception: {0}",Nl.toString()),8}return 32};this.QD=Ed;this.aD=de;this.FI=Ne;this.cW=Re;this.Vd=Cf;this.ia=Z;this.$C=Ka;this.ob=Jc;this.Ma=jd;this.va=yg;this.ih=bh;this.Ad=Ah;
this.la=$g;this.uc=zb;this.Mb=dc;this.qm=oh;this.$Yb=Jh;this.tZb=lk.ready;this.OTa=ti;this.xb=Mj;this.od=Yl;this.Tb=em;this.xcc=Wh;this.B3f=Fl;this.oc=yk;this.jta=dk;this.dY=Ej;this.sGl=il;this.vHl=Dk;this.NIl=Object(e.a)(this,this.oWm,"handleFirstRunExperienceEvent");Zk&&Zk.isFeatureEnabled("PowerPointEnterpriseDesigner",!1).then(sm=>{this.SJl=sm;return null});this.ia.Bia(this);this.dcc=rb.a("AddMoreDesignerLogsEnabled")}Hb(){this.la.QQf&&(this.ia.sa(sb.a.qIk,Na.a.application,Object(e.a)(this,this.L4l,
"showHideIdeas"),4),this.ia.sa(sb.a.nxh,Na.a.application,Object(e.a)(this,this.L4l,"showHideIdeas"),4),rb.a("Designer.QueryNewPane")&&this.ia.sa(sb.a.HTc,Na.a.application,Object(e.a)(this,this.MBn,"queryShowHideDesignerPane"),96),this.ia.sa(sb.a.ish,Na.a.application,this.RWm,4),this.ia.sa(sb.a.pEd,Na.a.application,Object(e.a)(this,this.MUg,"showHideDesigner"),4),this.ia.sa(sb.a.EDa,Na.a.application,Object(e.a)(this,this.EDa,"applyDesignerSuggestion"),4),this.ia.sa(sb.a.mKb,Na.a.application,Object(e.a)(this,
this.EDa,"applyDesignerSuggestion"),4),this.ia.za(sb.a.kOc,Na.a.application,Object(e.a)(this,this.Cbd,"navigateDesignerSuggestion")),this.ia.za(sb.a.d$d,Na.a.application,Object(e.a)(this,this.Cbd,"navigateDesignerSuggestion")),this.ia.za(sb.a.Fbd,Na.a.application,Object(e.a)(this,this.Cbd,"navigateDesignerSuggestion")),this.ia.za(sb.a.jOc,Na.a.application,Object(e.a)(this,this.Cbd,"navigateDesignerSuggestion")),this.ia.za(sb.a.b$d,Na.a.application,Object(e.a)(this,this.Cbd,"navigateDesignerSuggestion")),
this.ia.za(sb.a.Dbd,Na.a.application,Object(e.a)(this,this.Cbd,"navigateDesignerSuggestion")),this.ia.za(sb.a.c$d,Na.a.application,Object(e.a)(this,this.Cbd,"navigateDesignerSuggestion")),this.ia.za(sb.a.Ebd,Na.a.application,Object(e.a)(this,this.Cbd,"navigateDesignerSuggestion")),this.ia.sa(sb.a.Fbb,Na.a.application,Object(e.a)(this,this.Fbb,"reportSuggestionSessionInfo"),64),this.ia.za(sb.a.weh,Na.a.application,Object(e.a)(this,this.AVn,"triggerOnUndoRedo")),this.ia.za(sb.a.Rjh,Na.a.application,
Object(e.a)(this,this.nyl,"handleImageUploadForDesigner")),this.ia.za(sb.a.AOf,Na.a.application,Object(e.a)(this,this.nyl,"handleImageUploadForDesigner")),this.$Yb.f$b(Object(e.a)(this,this.vta,"onSlidePresenceChanged")),this.ih.aS(Object(e.a)(this,this.XDm,"designerTargetSlideChangedHandler")),this.la.PSa&&this.Ad.Sel(Object(e.a)(this,this.Hrn,"onRenderSuggestions")),this.la.Rzb&&this.Ad.nel(Object(e.a)(this,this.Nqn,"onMoreIdesClicked")),this.la.Vti&&this.Ad.c$b(Object(e.a)(this,this.V4a,"onRibbonTabSwitched")),
this.la.mH&&this.ih.RJb(Object(e.a)(this,this.WDm,"designerSlidesSelectionChangedHandler")),this.la.x6c&&this.OTa.Std(Object(e.a)(this,this.HOa,"onBlockingStateChanged")),this.ih.Oah(Object(e.a)(this,this.bbe,"onForceOutboundGraphTransactionDisposed")),this.xcc.Fye(Object(e.a)(this,this.ube,"onMarkedUndo")),this.la.veh&&this.od.i9a(Object(e.a)(this,this.Scc,"onSessionEnding")),rb.a("FixSessionRehydrationIssueForDesigner")&&this.od.$td(Object(e.a)(this,this.OIe,"onSessionExpired")),this.od.VG(Object(e.a)(this,
this.Oq,"onSessionRehydrated")),this.B3f&&this.B3f.execute(Z=>{Z.Ael(Object(e.a)(this,this.LZj,"onEditorCritiques"))}),this.sGl&&this.sGl.execute(Z=>{Z.kqm(Object(e.a)(this,this.iqn,"onHighConfidenceAgendaDetected"))}),this.la.Jnl?(this.OIl=window.setTimeout(Object(e.a)(this,this.gVk,"tryTriggerNewDocDesignerRequest"),this.la.Inl),window.addEventListener("FREDecisionEvent",this.NIl,!0)):this.gVk(),!Va.a.rb(this.la.Osh)&&this.YDm(this.la.Osh)&&(this.dWm(),this.wVn(this.la.Osh)))}oWm(Z){window.removeEventListener("FREDecisionEvent",
this.NIl,!0);window.clearTimeout(this.OIl);(Z=Z.detail)&&Z.show&&Z.show||this.gVk()}ve(){const Z=this.Ma.gd(Fa.a.Uma);Z.bindAction(ub.a.eb(qa.a.P8,0),sb.a.kOc);Z.bindAction(ub.a.eb(qa.a.CG,0),sb.a.kOc);Z.bindAction(ub.a.eb(qa.a.FK,0),sb.a.d$d);Z.bindAction(ub.a.eb(qa.a.vu,4),sb.a.Fbd);Z.bindAction(ub.a.eb(qa.a.O8,0),sb.a.jOc);Z.bindAction(ub.a.eb(qa.a.BG,0),sb.a.jOc);Z.bindAction(ub.a.eb(qa.a.wz,0),sb.a.b$d);Z.bindAction(ub.a.eb(qa.a.vu,0),sb.a.Dbd);Z.bindAction(ub.a.eb(qa.a.V3,0),sb.a.c$d);Z.bindAction(ub.a.eb(qa.a.w_,
0),sb.a.Ebd)}MUg(Z,Ka,zb,dc,Jc){return this.l7(this.aD,Fa.a.Uma,zb,Z,Jc)}L4l(Z,Ka,zb,dc,Jc){return Jc||!this.QD.isVisible?this.l7(this.aD,Fa.a.BRb,zb,Z,Jc):0}l7(Z,Ka,zb,dc,Jc){var jd=this.va.presentation;jd=!!this.va.Ga&&!!jd&&!this.uc.Cd(jd);if(this.la.mH){const Ed=this.ob.mg();jd=!!Ed&&1===Ed.length&&jd}if(!jd)return 16;if(!this.cW.isEnabled())return 8;if(1===zb)return 32;Jc||this.Ma.lm(Ka,Z.KE.isVisible);dc===sb.a.pEd?this.Vd.correlationId&&!this.Vd.nFe(this.Vd.correlationId)||this.wAb(Xg.a.xse):
Z.KE.isVisible?Z.KE.wA(!1,Bi.a.ONe):(this.wAb(dc===sb.a.nxh?Xg.a.xse:Xg.a.vOe),Z.KE.wA(!0,Bi.a.none));return 32}MBn(Z,Ka,zb,dc,Jc){if(!Object(Ei.a)(nl.a,Jc)||!this.aD||!this.aD.KE)return 8;Jc.xg(this.aD.KE.isVisible);return 32}EDa(Z,Ka,zb,dc,Jc){Ka=this.va.presentation;if(!this.va.Ga||!Ka||this.uc.Cd(Ka))return 16;dc=null;let jd=!0;Object(Ei.a)(oj,Jc)?dc=Jc:Object(Ei.a)(Ck,Jc)&&(dc=Jc.Jbh,jd=!1);if(!this.cW.isEnabled()||!dc)return 8;if(this.cW.Xtn())return D.a.J(512496589,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",
dc.CorrelationId,Z),8;if(1===zb)return 32;if(!this.ob.Rt()){if(1===this.ob.ud().length&&this.ob.ud()[0].Ww)return this.ob.Ti(),D.a.J(512496588,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",dc.CorrelationId,Z),8;this.ob.Ti()}if(!this.la.Rzb&&this.Vd.NXa.sid===dc.SuggestionSid)return D.a.J(512496587,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",
dc.CorrelationId,dc.SuggestionSid),2;zb=this.Mb.qe(15);try{this.la.x6c&&(this.Vd.$4c=new Date),zb.rc(Ka),zb.sc=Z,Ka.ZYa=dc,this.Vd.NXa=C.a.Yq(dc.SuggestionSid,dc.SuggestionCid),this.Vd.yya=!0,D.a.J(512496586,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}, slideID:{3}",dc.CorrelationId,Z,dc.SuggestionSid,dc.ActiveSlideSid)}finally{zb&&zb.dispose()}this.la.Pzb?this.uc.ggb(Ka,this.va.Ga,this.xb.Oa,Z):this.uc.vx(Ka,Z);this.QD.isVisible&&this.Ma.gh(Fa.a.BRb);
jd&&this.Vd.pSj();return 32}Cbd(Z,Ka,zb){Ka=this.va.presentation;if(!this.va.Ga||!Ka||this.uc.Cd(Ka))return 16;if(!this.cW.isEnabled())return 8;if(1===zb)return 32;this.cW.DXm(Z);return 32}Fbb(Z,Ka,zb,dc,Jc){if(this.cW.aD.KE.isVisible)return 0;this.gme(Jc.Skh,Jc.HHn);return 32}gme(Z,Ka,zb){const dc=this.Vd.correlationId;if(Va.a.rb(dc))D.a.J(512496585,829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",Ka);else if(this.Vd.nFe(dc))D.a.J(512496584,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",
dc,Ka);else{var Jc={};Jc.CachedTrigger=this.Vd.Vai;Jc.SuggestionSlideId=this.Vd.NXa.sid.toString();Jc.SuggestionSlideCreationId=this.Vd.NXa.cid.toString();Jc.AppliedSuggestion=this.Vd.yya;Jc.DisplaySuggestionsTimeoutInMs=this.la.ueh;Jc.SuggestionsTimeout=this.Vd.P9c;Jc.ClientAbort=this.Vd.EEe||this.cW.Vtn();Jc.DesignerPaneClosed=Z;Jc.ResetReason=Ka;Jc.HoverPreviewDesignerTriggered=this.Vd.zCl;Jc.DesignerFixPaneOpenHint=this.la.Wti;Jc.DesignerSendTraceRequestOnSessionEnded=this.la.veh;Jc.UseWin32DesignerIconEnabled=
this.la.TAe;Jc.IsSimplifiedRibbon=this.BCc();rb.a("DesignerLogRetriggerReason")&&zb&&(Jc.RetriggerReason=zb);this.la.Vti&&(Jc.DesignerDesignTabTriggerEnabled=!0);this.aD.sac()&&(this.la.gsc?(Jc[Pf.a.l_k]=this.FI.XYi(),Jc[Pf.a.n_k]=!0,this.Vd.uMk&&(Jc.StartUpsellFreeTrial=!0)):Jc[Pf.a.zki]=!0);Z=!!Ka&&0<=Ka.indexOf(Xg.a.moreIdeas);this.la.Rzb&&(Jc.TermCorrelationId=Cl.PXi(),Z||(Jc.TermAction=this.kUm()));zb=Eb.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString());var jd={};jd.ClientOS=
zb.Os;jd.Browser=zb.Browser||"";jd.BrowserVersion=zb.BrowserVersion||"";jd.BrowserMajorVersion=zb.BrowserMajorVersion||"";jd.BrowserMinorVersion=zb.BrowserMinorVersion||"";this.Vd.xXg&&this.Vd.xDb&&this.Vd.xDb>this.Vd.xXg&&(jd.SuggestionsE2ETimeMs=+this.Vd.xDb-+this.Vd.xXg);this.la.PSa&&(this.FI.Yxh(),this.AMk(),Jc[Pf.a.U$i]=!0,jd.VisibleSuggestionsCount=this.Vd.Lhf,0<this.Vd.Bjh.count&&(jd.IncrementalRenderTimeoutIndexes=this.Vd.Bjh.toArray().join(",")),0<this.Vd.NBb.count&&(jd.MissingDesignerCardIndexes=
this.Vd.NBb.toArray().join(",")),0<this.Vd.A5c.count&&(jd.CardIndexes=this.Vd.A5c.toArray().join(",")),0<this.Vd.T$b.count&&(jd.DesignerCardIndexes=this.Vd.T$b.toArray().join(",")),this.Vd.RDa&&(this.Vd.Ctg&&this.Vd.Ctg>this.Vd.RDa&&(jd.MissingDesignerCardsReceivedTime=+this.Vd.Ctg-+this.Vd.RDa),this.Vd.mbf&&this.Vd.mbf>this.Vd.RDa&&(jd.AllIncRenderReceivedTime=+this.Vd.mbf-+this.Vd.RDa),this.Vd.xPe&&this.Vd.xPe>this.Vd.RDa&&(jd.VisibleIncRenderReceivedTime=+this.Vd.xPe-+this.Vd.RDa)));this.tom(jd);
try{if(this.dY.instance){const Ed=this.dY.instance.sHn();Va.a.rb(Ed)||(Jc.AgendaMetrics=Ed)}}catch(Ed){D.a.J(512496583,813,10,"exception while populating AgendaMetrics",Ed)}Jc.BrowserData=jd;this.Vd.RDa&&this.Vd.xDb&&this.Vd.xDb>this.Vd.RDa&&(Jc.TimeToDisplaySuggestionsInMs=+this.Vd.xDb-+this.Vd.RDa);this.Vd.iRk&&this.Vd.UZg&&(Jc.TimeSuggestionsRendered=this.Vd.iRk.toUTCString());this.Vd.UZg&&(Jc.TimeDesignerPaneClosed=this.Vd.UZg.toUTCString());this.Vd.xcf&&0<this.Vd.xcf.count&&(Jc.AppliedSuggestionHis=
this.Vd.xcf.toArray().join(" "));this.qm.Fbb(dc,Yi.c(Jc),Ka===Bi.a.Nvh);this.IXn(dc,Ka);this.Vd.Sdl(dc,this.la.Rzb&&Z);D.a.J(512496582,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",Ka,dc)}}BCc(){return h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.Cx?!0:!1}tom(Z){Z.IdeasMivShown=this.Vd.Kqh;Z.IdeasMivDrillIn=this.Vd.XRj;Z.IdeasEditorShown=this.Vd.bfh;Z.IdeasEditorKept=this.Vd.afh;Z.IdeasEditorDrillIn=
this.Vd.kpl;Z.AnyCardShown=this.Vd.bfh||this.Vd.Kqh||0<this.Vd.A5c.count;Z.AnyCardKept=this.Vd.afh||this.Vd.yya}IXn(Z,Ka){this.cW.GOc(Z,Ka===Bi.a.ONe||Ka===Bi.a.jyh||Ka===Bi.a.noSuggestion||Ka===Bi.a.Bol?fk.a.wOc:fk.a.pending)}Hrn(Z,Ka){Ka.M6l.addRange(this.Vd.T$b);this.xjl(Ka.M6l,Ka.Nql,Ka.slideId,Ka.trigger,Ka.correlationId);Ka.UEd&&(this.n$c||this.Vd.NBb.count||this.bSn(Ka.trigger,Ka.Nql))}Nqn(Z,Ka){this.wAb(Xg.a.moreIdeas,null,Ka.qVd)}V4a(Z,Ka){!Ka.Brb||"PptRibbon.Design"!==Ka.Brb&&"Design"!==
Ka.Brb||2!==Ka.gw&&3!==Ka.gw&&4!==Ka.gw||this.cW.aD.KE.isVisible||32!==this.ia.Cb(sb.a.lNe,1)||this.wAb(Xg.a.peh)}bSn(Z,Ka){this.AMk();const zb=this.va.Ga.Xb,dc=this.Vd.correlationId;this.n$c=new H.a(2,1,this.la.Tdd,()=>{this.Vd.nFe(dc)||this.xjl(this.Vd.T$b,Ka,zb,Z,dc,Ka)},void 0,"CheckAndFetchMissingDesignerCardsTask");this.Tb.Qb(this.n$c)}xjl(Z,Ka,zb,dc,Jc,jd){jd=void 0===jd?-1:jd;if(this.Vd.T$b.count===Ka)this.AMk();else if(Z&&Z.count&&!(0<this.Vd.NBb.count)){if(-1===jd)for(const Ed of Z)Ed>jd&&
(jd=Ed);this.dxm(Z,Ka,jd)&&this.LVn(zb,dc,Jc)}}dxm(Z,Ka,zb){for(let dc=0;dc<Ka&&(Z.contains(dc)||this.Vd.NBb.contains(dc)||this.Vd.NBb.add(dc),dc!==zb||this.Vd.NBb.count);dc++);return 0<this.Vd.NBb.count}LVn(Z,Ka,zb){const dc={};dc.MissingDesignerCardIndexes=this.Vd.NBb.toArray().join(",");this.n$c=new H.a(0,1,0,()=>{this.qm.fAb(Z.cid,Z.sid,zb,Cl.PXi(),Ka,null,Yi.c(dc),()=>{D.a.J(512496581,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",
dc.MissingDesignerCardIndexes,zb)},Jc=>{D.a.J(512496580,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",dc.MissingDesignerCardIndexes,Jc.HttpStatusCode);return!0})},void 0,"FetchMissingDesignerCardsTask");this.Tb.Qb(this.n$c)}AMk(){this.n$c&&(this.Tb.li(this.n$c),this.n$c=null)}vta(Z,Ka){(Z=this.va.Ga)&&Ka.slideId.equals(Z.Xb)&&(this.cW.Hxh(Ka.H5l,Ka.AVl),this.cW.aD.KE.isVisible&&!this.cW.isEnabled()&&
(D.a.J(512496579,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",Ka.H5l,Ka.AVl,this.Vd.correlationId),this.QD.wA(!1,Bi.a.nym)),this.QD.isVisible&&(this.cW.isEnabled()||this.cW.GOc(this.Vd.correlationId,fk.a.wOc)))}XDm(Z,Ka){Ka.I4a?(Z=Object.assign(new zk.a,{slideId:Ka.I4a.Xb}),this.ia.Qa(sb.a.a4b,2,Z),this.cW.Hxh(Z.upe,Z.Wbk),this.QD.isVisible&&(D.a.J(512496577,
829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Vd.correlationId),this.cW.isEnabled()&&!Ka.I4a.wP?this.wAb(Xg.a.Gxh):Ka.I4a.wP&&this.la.PAe||(this.QD.wA(!1,Bi.a.slideNavigation),this.cW.GOc(this.Vd.correlationId,fk.a.wOc)))):D.a.J(512496578,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.Vd.correlationId)}aLf(Z){this.la.fsc&&(this.tZb=lk.ready,this.nta&&(this.QD.isVisible?
(D.a.J(512496576,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.nta.trigger,this.nta.sid),Z()):this.nta=null))}fce(Z,Ka){this.aLf(Ka);D.a.J(512496547,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",Z.HttpStatusCode);return!0}WDm(){if(this.cW.aD.KE.isVisible){const Z=this.ob.mg();Z&&1<Z.length&&(D.a.J(512496546,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),
this.QD.isVisible&&this.QD.wA(!1,Bi.a.qmn))}}HOa(Z,Ka){Z=this.Vd.$4c;const zb=this.la.Pzb?"UnblockContentWhenDraw":"SessionRehydrated";Z&&Object(v.a)(String,Ka.actionName)===zb&&(this.Vd.xcf.add(String.format("{0}:{1}:{2}",this.Vd.NXa,+Z-+this.Vd.xDb,+new Date-+Z)),this.Vd.$4c=null)}Scc(Z,Ka){this.cW.aD.KE.isVisible&&(D.a.J(512496545,829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.Vd.correlationId,wk.a[Ka.aI]),1!==Ka.aI&&3!==Ka.aI||this.gme(!0,Bi.a.Nvh))}OIe(){D.a.J(507917086,
829,50,"DesignerActor::OnSessionExpired");this.aD.KE.isVisible&&this.l7(this.aD,Fa.a.Uma,2,null,null)}Oq(){D.a.J(512496544,829,50,"DesignerActor::OnSessionRehydrated");if(rb.a("FixSessionRehydrationIssueForDesigner"))this.aD.KE.isVisible&&this.l7(this.aD,Fa.a.Uma,2,null,null);else{const Z={};Z[Pf.a.qwf]=!0;this.wAb(Xg.a.refresh,Z)}}bbe(Z,Ka){this.la.ZEi?Ka&&void 0!==Ka.actionId&&null!==Ka.actionId?this.cW.sBl(Ka.actionId)&&this.UJf(Ka.actionId,Ka.transaction.XC):this.dcc&&D.a.J(507881238,829,50,"DesignerActor::onForceOutboundGraphTransactionDisposed args {0} and actionId {1}",
Ka,Ka?Ka.actionId:null):Ka&&this.UJf(Ka.actionId,Ka.transaction.XC)}ube(Z,Ka){if(this.la.ZEi)if(Ka&&Ka.t9c)if(Z={},this.cW.Lqj(Ka.actionId)){if(Ka.revisionId){var zb=Og.a.bN(Ak.a.TO,Og.a.m_a(Ka.revisionId.toString()).toString());zb&&1===zb.length&&(Z[Pf.a.Lx]=zb[0].Lx)}this.UJf(Ka.actionId,Z)}else!this.cW.sBl(Ka.actionId)&&this.QD.isVisible&&(rb.a("FixDesignerPerfPaintNextFrameIssue")?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.l7(this.aD,Fa.a.Uma,2,Ka.actionId,null)},0)}):this.l7(this.aD,
Fa.a.Uma,2,Ka.actionId,null));else this.dcc&&D.a.J(508137872,829,50,"DesignerActor::onMarkedUndo args or isMarkUndoSucceeded is false actionId {0}",Ka?Ka.actionId:null);else Ka.t9c&&this.cW.Lqj(Ka.actionId)&&(Z={},Ka.revisionId&&(zb=Og.a.bN(Ak.a.TO,Og.a.m_a(Ka.revisionId.toString()).toString()))&&1===zb.length&&(Z[Pf.a.Lx]=zb[0].Lx),this.UJf(Ka.actionId,Z))}nyl(Z,Ka,zb,dc,Jc){switch(Z){case sb.a.Rjh:return this.Vd.Kfn(Jc),32;case sb.a.AOf:return this.Vd.PFn(Jc),32;default:return 2}}vfn(Z,Ka,zb){if(Z!==
Xg.a.insertPicture&&Z!==Xg.a.iUa&&Z!==Xg.a.qOf)return null;const dc=zb?zb[Pf.a.O8c]:!1,Jc=zb?zb[Pf.a.rDe]:!1,jd=zb?zb[Pf.a.P8c]:!1,Ed=zb?zb[Pf.a.qDe]:!1;let de=null;switch(Ka){case sb.a.pka:case sb.a.bdc:de=dc?Pf.a.nTl:Jc?Pf.a.mTl:jd?Pf.a.oTl:Ed?Pf.a.lTl:null;break;case sb.a.cdc:de=dc?Pf.a.rTl:Jc?Pf.a.qTl:jd?Pf.a.sTl:Ed?Pf.a.pTl:null;break;case sb.a.Aye:de=Pf.a.copilot;break;case sb.a.huc:de=Pf.a.cHi;break;case sb.a.insertOnlinePicture:case sb.a.sEa:case sb.a.hbc:de=Pf.a.MQc;break;case sb.a.Ojh:de=
Pf.a.icon}de||D.a.J(512496543,829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",Z,Ka,this.Vd.correlationId);delete zb[Pf.a.O8c];delete zb[Pf.a.rDe];delete zb[Pf.a.P8c];delete zb[Pf.a.qDe];return de}wfn(Z,Ka){rb.a("DesignerLogActionId")&&D.a.J(507881234,829,50,"DesignerActor::ActionId for trigger mapping {0}",Z);switch(Z){case sb.a.huc:case sb.a.insertOnlinePicture:case sb.a.sEa:case sb.a.a2b:case sb.a.Ojh:case sb.a.Aye:case sb.a.hbc:return Xg.a.insertPicture;
case sb.a.cdc:case sb.a.pka:case sb.a.bdc:case sb.a.qCb:return Ka&&Ka[Pf.a.O8c]||Ka&&Ka[Pf.a.rDe]&&this.la.$7l?Xg.a.insertPicture:Ka&&Ka[Pf.a.P8c]?Xg.a.iUa:Ka&&Ka[Pf.a.qDe]&&this.la.QSk?Xg.a.qOf:this.la.oRa?Xg.a.g5a:"";case sb.a.Mv:case sb.a.iYa:case sb.a.p$b:return Xg.a.p$b;case sb.a.xma:return Xg.a.Cxh;case sb.a.pne:case sb.a.qne:case sb.a.wed:case sb.a.xed:case sb.a.wec:return Ka&&Pf.a.N8c in Ka&&Ka[Pf.a.N8c]?Xg.a.Uch:Xg.a.refresh;case sb.a.kjf:case sb.a.rIa:return Ka&&Pf.a.N8c in Ka&&Ka[Pf.a.N8c]?
Xg.a.Uti:Xg.a.refresh;case Oh.a.Wja:return Xg.a.wVc;case sb.a.Ipa:case sb.a.TBa:case sb.a.hec:case sb.a.bringForward:case sb.a.bringToFront:case sb.a.sendToBack:case sb.a.sendBackward:return rb.a("EnableDesignerSuggestionForZIndexActions")?Xg.a.refresh:Xg.a.wVc;case Oh.a.wvd:case Oh.a.zvd:case Oh.a.Zfb:case Oh.a.yvd:case Oh.a.Avd:case Oh.a.Adf:case Oh.a.SXa:case Oh.a.Cdf:case Oh.a.Ddf:case Oh.a.Edf:case Oh.a.Fdf:case Oh.a.Cvd:case Oh.a.Evd:case Oh.a.backspace:case Oh.a.Mva:case Oh.a.mF:case Oh.a.aJa:case Oh.a.enter:case Oh.a.QA:case Oh.a.Mz:return Xg.a.Mz;
case sb.a.iUa:return Xg.a.iUa;case sb.a.A2b:return this.la.getBooleanAppSetting("DesignerUseRefreshTriggerForInsertTable")?Xg.a.refresh:Xg.a.insertTable;case sb.a.h2:case sb.a.o$d:case sb.a.Drb:case sb.a.oF:return Xg.a.HAa;case sb.a.o$b:return Xg.a.Lbh;case sb.a.Vch:return Xg.a.Sch;case sb.a.apc:return Xg.a.apc;default:return Xg.a.refresh}}AVn(Z){const Ka={};rb.a("DesignerLogActionId")&&D.a.J(508134675,829,50,"DesignerActor::triggerOnUndoRedo  ActionId {0}",Z);Ka[Pf.a.undoRedo]=!0;this.wAb(Xg.a.refresh,
Ka);return 32}UJf(Z,Ka){if(rb.a("EnableDesignerSuggestionForZIndexActions")){if(this.tBl(Z)&&this.o3m(Z))return}else if(this.tBl(Z))return;const zb=jd=>{const Ed={};Ed[Pf.a.timestamp]=jd.timestamp;Ed[Pf.a.correlationId]=jd.correlationId;Ed[Pf.a.trigger]=jd.trigger;Ed[Pf.a.sid]=jd.sid;Ed[Pf.a.cid]=jd.cid;Ed[Pf.a.Ina]=jd.Ina;jd=this.Mb.Fd(4);try{jd.rc(this.va.presentation),jd.sc=sb.a.qeh,this.va.presentation.Qzb=Yi.c(Ed)}finally{jd&&jd.dispose()}},dc=this.wfn(Z,Ka);this.dcc&&D.a.J(507881237,829,50,
"DesignerActor::handleDesignerRequestOnEdit  ActionId {0} trigger {1}",Z,dc);const Jc=this.vfn(dc,Z,Ka);Ka||(Ka={});rb.a("DesignerLogRetriggerReason")&&dc===Xg.a.refresh&&(Ka[Pf.a.$uh]=Z);this.xkh(dc)||this.QD.isVisible?(Va.a.rb(Jc)||(Ka[Pf.a.S9a]=Jc),this.cW.Lqj(Z)&&this.QD.isVisible?this.fti(dc,this.la.SAe,Ka,zb):dc===Xg.a.refresh&&this.QD.isVisible&&rb.a("DesignerDelayRefreshTrigger")?this.fti(dc,this.la.Nnl,Ka,zb):Z===sb.a.Aye?(Z=this.la.Jc("ChatPPTDesignerTriggerDelayMs",100),this.WJl=Date.now(),
this.fti(dc,Z,Ka,zb)):this.zfh(zb,dc,Ka)):this.dcc&&D.a.J(507642453,829,50,"DesignerActor::handleDesignerRequestOnEdit  trigger is not entry trigger {0}",dc)}fti(Z,Ka,zb,dc){this.dcc&&D.a.J(507881236,829,50,"DesignerActor::delayTriggerDesignerTask  trigger {0}",Z);if(this.P$c){if(this.cnh===Xg.a.insertPicture&&Z===Xg.a.refresh){this.Tb.li(this.P$c);this.Tb.Qb(this.P$c);return}this.qfi()}this.QD.isVisible&&(this.cW.GOc(this.Vd.correlationId,fk.a.pending),this.owh(Z));const Jc=this.va.Ga;if(Jc){var jd=
Jc.sid,Ed=Jc.cid;this.cnh=Z;this.P$c=new H.a(2,1,Ka,()=>{this.qfi();this.QD.isVisible&&D.a.J(512496542,829,50,"Potential candidate for {0} request for designer pane",Z);this.UOn(Z,jd,Ed)?this.dcc&&D.a.J(507642452,829,50,"DesignerActor::delayTriggerDesignerTask  shouldSkipRefreshTrigger true"):this.zfh(dc,Z,zb)},void 0,"DesignerDelayTriggerTask");this.Tb.Qb(this.P$c)}}qfi(){this.P$c&&(this.dcc&&D.a.J(507881235,829,50,"DesignerActor::cleanupAnyDelayTriggerDesignerTask  trigger {0}",this.cnh),this.Tb.li(this.P$c),
this.cnh=this.P$c=null)}wAb(Z,Ka,zb){Ka=void 0===Ka?null:Ka;zb=void 0===zb?null:zb;Ka||(Ka={});this.dcc&&D.a.J(507642451,829,50,"DesignerActor::handleDesignerRequestNonEdit before executeDesignerRequestProcessingWithAuth  trigger {0} lastShownCorrelationId {1}",Z,zb);this.zfh(dc=>{if(this.la.fsc){if(this.tZb.oDl&&+new Date-+this.tZb.KEl<this.la.EBd){this.nta=new Jk;this.nta.sid=dc.sid;this.nta.cid=dc.cid;this.nta.trigger=dc.trigger;this.nta.mjh=dc.Ina;D.a.J(512496541,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",
Z,dc.sid);return}this.tZb=lk.e8;this.nta=null}const Jc=()=>{this.wAb(this.nta.trigger,this.nta.mjh,zb)};this.qm.fAb(dc.cid,dc.sid,dc.correlationId,Cl.PXi(),dc.trigger,zb,Yi.c(dc.Ina),jd=>{jd&&jd.Status===Pf.a.prk?this.avh(()=>{this.wAb(dc.trigger,dc.Ina,zb)}):this.SMc=0;this.SMc||this.aLf(Jc)},jd=>this.fce(jd,Jc))},Z,Ka)}avh(Z){this.SMc<this.la.DBd?this.Tb.Qb(new H.a(2,1,1E3,()=>{D.a.J(512496540,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Vd.correlationId);
this.tZb=lk.ready;this.SMc++;Z()},void 0,"RetryRequestOnWait")):D.a.J(512496539,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Vd.correlationId)}sPm(Z,Ka){Ka=(void 0===Ka?null:Ka)||{};this.la.nqf&&Z===Xg.a.Crb&&(Ka[Pf.a.Ipl]="true");this.la.Onl&&(Ka[Pf.a.N6l]=this.SJl);this.aD.sac()&&(this.la.gsc?(Ka[Pf.a.l_k]=this.FI.XYi(),Ka[Pf.a.n_k]=!0):Ka[Pf.a.zki]=!0);this.FI.Cjh(Z)&&(Ka[Pf.a.U$i]=!0);this.cW.U3m()&&(Ka[Pf.a.ddh]=this.cW.ddh());Ka.NewPaneEnabled=
!0;var zb=!sd.a.rb(this.Vd.WSa);(Ka.RequestForEditorCardsForNewIdeasPane=zb)&&(Ka.NumEditorCritiques=this.cAm());zb={};zb.SupportsImageToTableSuggestedAction=32===this.ia.Cb(sb.a.Jsh,1);Ka.PPTOEnabledSuggestedActions=Yi.c(zb);this.la.oRa&&Z===Xg.a.g5a&&(Ka[Pf.a.vsb]=this.la.vsb,Ka[Pf.a.$Bg]=this.la.$Bg,Ka[Pf.a.ZBg]=this.la.ZBg);return Ka}cAm(){let Z=0;for(const Ka of this.Vd.WSa)for(const zb of Ka.critiques)Z+=zb.suggestions.length;return Z}tBl(Z){if(void 0===Z||null===Z)return!0;switch(Z){case sb.a.EDa:case sb.a.mKb:case sb.a.jOc:case sb.a.b$d:case sb.a.Dbd:case sb.a.kOc:case sb.a.d$d:case sb.a.Fbd:case sb.a.c$d:case sb.a.Ebd:case sb.a.qeh:return!0;
case sb.a.MDd:return this.la.getBooleanAppSetting("ChatPPTImgShowDesigner")&&rb.a("DesignerIgnore")&&Date.now()<this.WJl+this.la.Jc("ChatPPTImgIgnoreRefreshMs",2E4);case sb.a.Ipa:case sb.a.TBa:case sb.a.hec:case Oh.a.Wja:case sb.a.bringForward:case sb.a.bringToFront:case sb.a.sendToBack:case sb.a.sendBackward:return!this.Vd.yya;default:return!1}}o3m(Z){if(rb.a("EnableDesignerSuggestionForMoveShapes")&&Z===sb.a.Ipa||rb.a("EnableDesignerSuggestionForResizeShape")&&Z===sb.a.TBa||rb.a("EnableDesignerSuggestionForPictureCropInfo")&&
Z===sb.a.hec)return!1;if(rb.a("EnableDesignerSuggestionForZIndexActions"))switch(Z){case sb.a.bringForward:case sb.a.bringToFront:case sb.a.sendToBack:case sb.a.sendBackward:return!1;default:!0}return!0}QBm(Z,Ka){Ka=void 0===Ka?null:Ka;const zb=this.va.Ga;return zb?Object.assign(new Pk,{trigger:Z,sid:zb.sid,cid:zb.cid,Ina:this.sPm(Z,Ka)}):null}Q5m(Z){return Object(mj.b)(this,void 0,void 0,function*(){if(!Z||!Z.sid||!this.xkh(Z.trigger)&&!this.QD.isVisible)return!1;switch(Z.trigger){case Xg.a.HAa:case Xg.a.vOe:case Xg.a.xse:case Xg.a.insertPicture:case Xg.a.p$b:case Xg.a.peh:case Xg.a.Fdh:case Xg.a.iUa:case Xg.a.Gxh:case Xg.a.Cxh:case Xg.a.insertTable:return!0;
case Xg.a.qOf:return this.la.QSk;case Xg.a.Mz:return this.la.$ti&&this.QD.isVisible;case Xg.a.wVc:return this.la.QAe&&this.Vd.yya;case Xg.a.Uch:case Xg.a.Uti:return this.la.NAe;case Xg.a.g5a:return this.la.oRa;case Xg.a.Lbh:case Xg.a.Sch:case Xg.a.apc:return this.la.AOe;case Xg.a.refresh:return this.P5m(Z.Ina);case Xg.a.moreIdeas:return this.la.Rzb;case Xg.a.Crb:const Ka=0===(yield this.vHl.zBf());return this.la.nqf&&this.la.isCreateNew&&!Ka;case Xg.a.rbh:return this.la.Zyh;default:return D.a.J(512496538,
829,15,"invalid trigger: {0}",Z.trigger),!1}})}P5m(Z){return Pf.a.qwf in Z&&Z[Pf.a.qwf]||Pf.a.undoRedo in Z&&Z[Pf.a.undoRedo]||this.la.Mnl&&this.cW.aD.KE.isVisible?!0:!1}xkh(Z){switch(Z){case Xg.a.vOe:case Xg.a.xse:case Xg.a.insertPicture:case Xg.a.qOf:case Xg.a.Cxh:case Xg.a.Uch:case Xg.a.p$b:case Xg.a.iUa:case Xg.a.Crb:case Xg.a.Lbh:case Xg.a.peh:case Xg.a.Fdh:return!0;case Xg.a.rbh:return this.la.Zyh;case Xg.a.g5a:return this.la.oRa;default:return!1}}n3m(Z){if(!(this.la.w6c&&Pf.a.Lx in Z.Ina&&
Z.Ina[Pf.a.Lx]))return!1;switch(Z.trigger){case Xg.a.vOe:case Xg.a.xse:case Xg.a.Gxh:case Xg.a.Crb:return!1;case Xg.a.refresh:return!(Pf.a.qwf in Z.Ina)||!(Pf.a.undoRedo in Z.Ina);default:return!0}}owh(Z){const Ka=Z===Xg.a.Mz||Z===Xg.a.refresh?4:Z===Xg.a.moreIdeas?7:1;(this.cW.aD.KE.isVisible||this.xkh(Z))&&this.aD.Aed(Ka)}VAi(Z,Ka,zb){var dc,Jc;Object(mj.b)(this,void 0,void 0,function*(){this.dcc&&D.a.J(507642450,829,50,"DesignerActor::executeDesignerRequestProcessing trigger {0}",Ka);const jd="PasteText"==
Ka?new mi.a("DesignerActor::executeDesignerRequest",sb.a.qCb):void 0;null===jd||void 0===jd?void 0:jd.Cf("ST");this.qfi();const Ed=this.QBm(Ka,zb);null===jd||void 0===jd?void 0:jd.Cf("TA_RequestData");var de=yield this.Q5m(Ed);null===jd||void 0===jd?void 0:jd.Cf("TA_await");de?this.Vd.C6m(this.va.Ga.sid)?(this.owh(Ed.trigger),this.avh(()=>{this.zfh(Z,Ka,zb)}),null===jd||void 0===jd?void 0:jd.Cf("TA_setPaneViewDirect")):(de=null!==(Jc=null===(dc=Ed.Ina)||void 0===dc?void 0:dc.q1n)&&void 0!==Jc?Jc:
null,D.a.J(512496537,829,50,"trigger: {0}; sid: {1}; correlationId: {2} ReTriggerReason: {3}",Ed.trigger,Ed.sid,Ed.correlationId,de),null===jd||void 0===jd?void 0:jd.Cf("TB_sendTraceRequest"),this.Vd.correlationId&&!this.Vd.nFe(this.Vd.correlationId)&&(rb.a("DesignerLogRetriggerReason")?this.gme(this.cW.aD.KE.isVisible,Ed.trigger,de):this.gme(this.cW.aD.KE.isVisible,Ed.trigger)),null===jd||void 0===jd?void 0:jd.Cf("TA_sendTraceRequest"),this.Vd.xXg=new Date,this.Vd.correlationId=Ed.correlationId,
this.Vd.Vai=Ed.trigger,this.Vd.RDa=this.n3m(Ed)?Ed.Ina[Pf.a.Lx]:new Date,Ed.Ina[Pf.a.S9a]===Pf.a.copilot&&(this.Vd.eQf=!0),Z(Ed),null===jd||void 0===jd?void 0:jd.Cf("TA_requestAction"),this.owh(Ed.trigger),null===jd||void 0===jd?void 0:jd.Cf("TA_setPaneViewState"),this.cW.GOc(Ed.correlationId,fk.a.pending),null===jd||void 0===jd?void 0:jd.Cf("ET"),null===jd||void 0===jd?void 0:jd.BM()):(D.a.J(512496536,829,50,"Designer call not currently allowed for trigger {0}",Ka),this.QD.wA(!1,Bi.a.Bol))})}zfh(Z,
Ka,zb){if(this.la.BBd&&this.jta){this.owh(Ka);var dc=new Date;this.jta.qN(this.la.lfe,this.la.FBd).then(Jc=>{const jd=+new Date-+dc;Jc.IsSuccess?(zb[Pf.a.Frl]=jd,zb[Pf.a.Q1l]=Jc.Token):(zb[Pf.a.MCi]=jd,D.a.J(512496535,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+Jc.ErrorCode+": "+Jc.ErrorMessage));this.VAi(Z,Ka,zb)}).catch(Jc=>{D.a.J(512496534,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",Jc);zb[Pf.a.MCi]=
+new Date-+dc;this.VAi(Z,Ka,zb)})}else this.VAi(Z,Ka,zb)}gVk(){return Object(mj.b)(this,void 0,void 0,function*(){if(this.la.nqf&&this.la.isCreateNew)if(0===(yield this.vHl.zBf()))D.a.J(509162323,829,50,"No Triggering NewDocument designer request in Copilot.");else if(this.oc){var Z=this.va.presentation;if(!Z)throw Error.argumentNull("Presentation is null");var Ka=this.oc.KL();if(!Ka||0>=Ka.length)D.a.J(512496531,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");
else{var zb="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===Ka[0].ThemeFamilyId.toLowerCase();zb&&1!==Ka.length?D.a.J(512496530,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):this.la.BOe||zb?!Z.slides||0>=Z.slides.length?D.a.J(512496528,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):zb&&1!==Z.slides.length?D.a.J(512496527,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):
(Z=null,this.la.M1l&&this.la.uda&&0<this.la.uda.length&&(Z={},Z.TemplateId=this.la.uda),D.a.J(512496526,829,50,"Triggering NewDocument designer request"),this.wAb(Xg.a.Crb,Z)):D.a.J(512496529,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else D.a.J(512496532,829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");else D.a.J(512496533,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",
this.la.nqf,this.la.isCreateNew)})}LZj(Z,Ka){this.Vd.AXn(Ka.dtf)}UOn(Z,Ka,zb){const dc=this.va.Ga;if(!dc)return!0;const Jc=dc.cid;return dc.sid!=Ka||Jc!=zb||!this.QD.isVisible&&!this.xkh(Z)}kUm(){const Z=document.querySelector("."+Sg.soc);return Z&&(this.FI.qCe(Z,!1)||this.FI.qCe(Z,!0))?"Kept":"NotKept"}Yul(Z){const Ka=new M.a;if(Z&&Z.children)for(let zb=0;zb<Z.children.length;zb++){const dc=Z.children[zb].innerText;dc&&0<dc.length&&Ka.add(Z.children[zb].innerText)}return Ka.toArray()}xRm(Z){if(!Z)return null;
var Ka=Z.oa(Bg.a.ibb,null);if(Ka)return Ka.replace("\r","\n").replace("\n\n","\n").split("\n");if(Ka=Z.oa(Bg.a.mW,null))if(Ka=this.$C.cBa(Ka))return this.Yul(Ka);if(Ka=Z.oa(Bg.a.fJe,null))if(Z=this.$C.cBa(Ka))return this.Yul(Z);return null}getName(){return"DesignerActor"}M6(){}K6(Z){var Ka,zb;if(this.la.oRa&&Z.actionId===sb.a.qCb&&32===Z.response){var dc=Z.$c,Jc=Z.actionId;(null===(Ka=this.la)||void 0===Ka?0:Ka.getBooleanAppSetting("DelayDesignerActionOnPaste"))?(Z=new H.a(0,1,null===(zb=this.la)||
void 0===zb?void 0:zb.Jc("TimeDelayForDesignerInBrowserPaste",0),()=>{Cl.kBl(dc,Jc,this)},226),h.AFrameworkApplication.je.Qb(Z)):Cl.kBl(dc,Jc,this)}}static kBl(Z,Ka,zb){const dc=new mi.a("DesignerActor::invokeDesignerActionOnPaste",sb.a.qCb);null===dc||void 0===dc?void 0:dc.Cf("ST");var Jc=zb.ob.ud();Jc&&1===Jc.length&&Jc[0].id&&(null===dc||void 0===dc?void 0:dc.Cf("TB_getPastedText"),!(Z=zb.xRm(Object(v.a)(91,Z)))||0>=Z.length||(Jc={},Jc[Pf.a.tTl]=Z,null===dc||void 0===dc?void 0:dc.Cf("TA_getPastedText"),
zb.UJf(Ka,Jc),null===dc||void 0===dc?void 0:dc.Cf("TA_handleDesignerRequest"),null===dc||void 0===dc?void 0:dc.BM()))}YDm(Z){switch(Z){case Pf.a.L1k:return this.la.Fpl;default:return!1}}dWm(){this.QD.wA(!0,Bi.a.none);this.wAb(Xg.a.Fdh);this.aD.Aed(3)}wVn(Z){switch(Z){case Pf.a.L1k:this.xVn()}}xVn(){if(this.la.nUl)try{const Z=l.a.instance.Na("Common.ISystemInitiatedFeedback");Z&&(D.a.J(512496525,829,50,"Floodgate survey for word to presentation triggered"),Z.execute(Ka=>{Ka.logActivity("ConvertWordToPresentationActivity",
"PowerPointDesignerWordToPptSurveyEnabled")}))}catch(Z){D.a.J(512496524,829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",Z)}}iqn(){this.la.Zyh&&(this.QD.isVisible||this.GHl||(this.QD.wA(!0,Bi.a.none),this.wAb(Xg.a.rbh),this.aD.Aed(3),D.a.J(512496523,829,50,"Auto opening designer pane for high confidence agenda")),this.GHl=!0)}static PXi(){const Z=document.querySelector("."+Sg.soc);return Z&&Z.getAttribute(Sg.Pze)?Z.getAttribute(Sg.Pze).toString():null}}Object(c.a)(Cl,"DesignerActor",
null,[85]);var Ul=a(1224),Ql=a(1361);class Vl{constructor(Z){this.bucketId=Z;this.critiques=[]}}Object(c.a)(Vl,"BucketedEditorData",null,[]);class Il{constructor(Z){this.Vai=this.correlationId=this.L$c=this.WGl=null;this.EEe=this.P9c=this.yya=!1;this.UZg=this.iRk=null;this.zCl=!1;this.B5c=this.suggestions=this.xPe=this.mbf=this.RDa=this.$4c=this.Ctg=this.xDb=this.xXg=null;this.hwa=0;this.eQf=this.uMk=this.XRj=this.Kqh=this.kpl=this.afh=this.bfh=!1;this.gCj=[];this.VOj=[];this.H2f=Z;this.NXa=C.a.empty;
this.xcf=new M.a;this.A5c=new M.a;this.T$b=new M.a;this.Bjh=new M.a;this.NBb=new M.a;this.Lhf=1}Ifn(){this.ned(0,0)}Hfn(){this.ned(1,0)}pSj(){this.ned(2,4)}ned(Z,Ka){this.H2f&&this.H2f.execute(zb=>{const dc=Object.assign(new Ql.a,{cardId:Ul.a.F5l,actionType:Z,actionEngagement:Ka});zb.xrh(dc)})}Sdl(Z,Ka){this.nFe(Z)||(Array.add(this.gCj,Z),D.a.J(509112540,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",Z,this.gCj.length));this.Nrk(!Ka)}nFe(Z){return Array.contains(this.gCj,
Z)}Kfn(Z){Array.add(this.VOj,Z)}PFn(Z){Array.remove(this.VOj,Z)}C6m(Z){return Array.contains(this.VOj,Z)}get $ji(){return this.L$c}izm(){if(this.L$c)return!0;try{const Z=l.a.instance.yb("PowerPointWebEditor.Proofing.IConsistencyCheckActor");if(Z)return this.L$c=Z,!0}catch(Z){D.a.J(509112539,829,15,"error resolving consistencyCheckActor. ex: {0}",Z)}return!1}AXn(Z){if(Z){var Ka=[],zb=new ua.a;for(const dc of Z.critiques){Z=dc.bucketId;let Jc=zb.ha(Z);Jc||(Jc=new Vl(Z),zb.K(Z,Jc),Ka.push(Jc));Jc.critiques.push(dc)}this.WGl=
Ka}}get WSa(){return this.WGl}Nrk(Z){this.correlationId="";this.NXa=C.a.empty;this.Vai="";this.EEe=this.P9c=this.yya=!1;this.UZg=null;this.zCl=!1;this.$4c=this.Ctg=this.xDb=this.xXg=null;this.xcf.clear();this.xPe=this.mbf=this.RDa=null;this.Lhf=1;this.A5c.clear();this.T$b.clear();this.Bjh.clear();this.NBb.clear();this.hwa=0;this.eQf=this.uMk=this.bfh=this.afh=this.Kqh=this.XRj=!1;Z&&(this.suggestions=this.B5c=null)}}Object(c.a)(Il,"DesignerContext",null,[1324]);class Qk{constructor(){this.CardData=
null;this.DocumentUpsellStatus=0;this.HasPaginationInfo=!1;this.SlideSuggestions=null}}Object(c.a)(Qk,"DesignerSuggestions",null,[]);var oa;(function(Z){Z[Z.init=0]="init";Z[Z.loading=1]="loading";Z[Z.noSuggestion=2]="noSuggestion";Z[Z.showSuggestion=3]="showSuggestion";Z[Z.refreshing=4]="refreshing";Z[Z.sameSlideCoauthNoSuggestion=5]="sameSlideCoauthNoSuggestion";Z[Z.makeItVisualDrillIn=6]="makeItVisualDrillIn";Z[Z.loadingMoreIdeas=7]="loadingMoreIdeas";Z[Z.moreIdeas=8]="moreIdeas";Z[Z.noSuggestionRibbon=
9]="noSuggestionRibbon"})(oa||(oa={}));Object(c.b)("DesignerViewState",oa);class Ia{constructor(){this.suggestions=[]}}Object(c.a)(Ia,"SlideSuggestionNotificationData",null,[]);var Db=a(424),Vb=a(600);class Ic{constructor(Z,Ka,zb){this.B9b=this.rL=!1;Z&&(this.hab=Z,this.hab.isFeatureEnabled("PowerPointDesigner",!1).then(dc=>{(this.rL=dc)?D.a.J(507843550,829,50,"DesignerStateManager:: Designer is enabled"):(this.B9b=this.hab.isFreemiumUpsellEnabled(),this.isFreemiumUpsellEnabled?zb?D.a.J(507843553,
829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):D.a.J(507843552,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):D.a.J(507843551,829,50,"DesignerStateManager:: Upsell experience is disbaled"));return null}),this.Kdn=this.hab.OCb("PowerPointDesigner",Object(e.a)(this,this.iOb,"featureStateChangeCallback")),this.ndn=Ka)}sac(){return!this.isEnabled&&this.isFreemiumUpsellEnabled}dispose(){this.hab&&(this.hab.M4b("PowerPointDesigner",
this.Kdn),this.hab=null)}get isEnabled(){return this.rL}get isFreemiumUpsellEnabled(){return this.B9b}launchUpsellExperience(Z){this.hab&&this.hab.launchUpsellExperience(Z)}iOb(Z){Z&&"PowerPointDesigner"===Z.featureName&&(!this.isEnabled&&Z.isEnabled&&this.ndn(),this.rL=Z.isEnabled)}}Object(c.a)(Ic,"DesignerStateManager",null,[]);class Pc{constructor(Z,Ka,zb){this.Cen=Z;this.jK=Ka;this.oen=zb}toString(){return"SuggestionIndex:"+this.Cen+" SlideId:"+this.jK+" CreationId:"+this.oen}}Object(c.a)(Pc,
"LoggableSourceContext",null,[]);var bd=a(1531),qd=a(1213),td=a(1223);class Nd{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah){this.sad=this.S3a=!1;this.rRj=0;this.xv=this.nGe=null;this.ua=new Ad.a;this.hOd=Ui=>{!this.isVisible||Ui.keyCode!==qa.a.hv&&Ui.keyCode!==qa.a.C7||this.wA(!1,Bi.a.Mz)};this.Czb=()=>{this.isVisible&&(D.a.J(509089857,829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Vd.correlationId),this.wA(!1,Bi.a.ONe));return!0};
this.S3a=rb.a("SvgCloseButton");this.Db=Z;this.rf=Ka;this.ef=zb;this.jA=dc;this.ia=Jc;this.Vd=jd;this.eR=Ed;this.od=de;this.oR=Ne;this.fc=Re;this.Ma=Cf;this.la=yg;this.ez=bh;this.rG=Ki.VMf;this.rdn=ResourceStrings.L_Designer;this.EU=Ah;this.Rb=document.createElement("div");this.Rb.className=Ge.a.Knl;this.Rb.id=Ki.VMf;this.Rb.style.position=ac.a.tFa;this.Rb.setAttribute(Ga.a.pi,Ga.a.qzb);this.Rb.setAttribute(Ga.a.rma,Ge.a.teh);this.mc=!1;this.Ybc=Kb.a.hg();this.Ybc.className="DesignerPaneLayoutRoot";
this.S3a&&(this.Ybc.style.display=ac.a.r_);this.Rb.appendChild(this.Ybc);Z=h.AFrameworkApplication.ga.La("PPTFabricIconDiamondCssUrl");Ka=document.createElement("link");Ka.setAttribute("rel","stylesheet");Ka.setAttribute("type","text/css");Ka.setAttribute("href",Z);this.Rb.appendChild(Ka);this.Db.pSa(Object(e.a)(this,this.d_,"onSetOffline"))}dispose(){this.Dja();this.Rb.removeChild(this.Ybc);this.Db.UCb(Object(e.a)(this,this.d_,"onSetOffline"));D.a.J(509089863,829,50,"DesignerPane::Dispose")}initialize(){this.S3a||
(this.xv=Nd.Nqc(this.rf),Sys.UI.DomElement.addCssClass(this.xv,"DesignerPaneCloseButton"),this.xv.setAttribute(Ga.a.pi,Ga.a.BL),this.Ybc.appendChild(this.xv));this.nGe=Kb.a.hg();this.nGe.id=Ge.a.teh;this.nGe.className=Ge.a.teh;this.nGe.innerText=this.rdn;this.Ybc.appendChild(this.nGe);this.S3a&&(this.xv=Nd.zAe(),Sys.UI.DomElement.addCssClass(this.xv,"DesignerPaneCloseButtonNew"),this.Ybc.appendChild(this.xv));this.ef.Zb(ha.a.click,this.xv,this.Czb);this.jA.addHandler(this.xv,ha.a.Lj,this.hOd);this.eR.pTa(this.Kul(),
Fa.a.vl,this.Rb,Z=>{Z===this.Ma.gd(Fa.a.s_)&&this.xv?this.eZ(!0):rb.a("DesignerPaneArrowKeyFocusFix")?this.fia(!1):this.fia(!0)},()=>{this.fia(!1)});this.od.fsa(Object(e.a)(this,this.eE,"onUnifiedAppStateChanged"));this.od.VG(Object(e.a)(this,this.qta,"onPodSessionRehydrated"));this.oR.a$b(Object(e.a)(this,this.qta,"onPodSessionRehydrated"));D.a.J(509089862,829,50,"DesignerPane::Initialize")}Kul(){return Fa.a.Uma}Dja(){this.ef&&0<this.Ybc.childNodes.length&&(this.ef.jc(ha.a.click,this.xv,this.Czb),
this.jA.removeHandler(this.xv,ha.a.Lj,this.hOd),this.Ybc.removeChild(this.nGe),this.Ybc.removeChild(this.xv));this.od.U4b(Object(e.a)(this,this.eE,"onUnifiedAppStateChanged"));this.od.wka(Object(e.a)(this,this.qta,"onPodSessionRehydrated"));this.oR.PUc(Object(e.a)(this,this.qta,"onPodSessionRehydrated"));this.Ma.currentScope&&this.Ma.currentScope.name===Fa.a.Uma&&this.Ma.lm(Fa.a.Uma,!1)}eE(Z,Ka){Ka.nlb&&!this.fc.Mp&&this.isVisible&&(D.a.J(509089861,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",
this.Vd.correlationId),this.wA(!1,Bi.a.ONe))}d_(Z){Z&&this.isVisible&&this.wA(!1,Bi.a.ONe)}qta(){D.a.J(509089860,801,50,"Designer Pane is closed because session is rehydrated.");this.wA(!1,Bi.a.LKn)}layout(Z,Ka){const zb=Ka?Z.eP(this.width):Z.fP(this.width);this.isVisible&&(Ka?(Sys.UI.DomElement.addCssClass(this.Rb,Ge.a.Zti),zb.eP(Ge.a.seh)):(Sys.UI.DomElement.addCssClass(this.Rb,Ge.a.Yti),zb.fP(Ge.a.seh)));Kb.a.nda(this.Rb,zb,!1);return Z}wA(Z,Ka){if(this.mc!==Z){this.mc=Z;var zb=this.la.Wti||this.id!==
Ki.VMf?Pf.a.ISl:Ki.y0m;Z?(Ka={},Ka[zb]=!0,this.ez.eYg(Yi.c(Ka)),this.initialize(),this.Rb.style.display=ac.a.r_,this.Vd.Ifn(),D.a.J(509089859,829,50,"DesignerPane::SetIsVisible - Set to visible")):(Z={},Z[zb]=!1,this.ez.eYg(Yi.c(Z)),this.Dja(),this.Rb.style.display=ac.a.Sf,this.TQn(Ka)||(this.Vd.UZg=new Date,1===this.rRj&&(this.Vd.EEe=!0),this.ia.Qa(sb.a.Fbb,2,new td.a(!0,Ka))),this.Vd.Hfn(),D.a.J(509089858,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.RXh(this.Rb);zb=ResourceStrings.L_Designer;
this.EU.l7(this,this.mc,this.id===Ki.VMf?zb:ResourceStrings.L_ShowHideDesignerPane,this.Kul());this.mc&&this.Vd.eQf&&rb.a("DesignerFocusChatPPT")&&this.ia.Cb(sb.a.JDa,2,null)}}RXh(Z){h.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(Z,Ge.a.Zti):Sys.UI.DomElement.addCssClass(Z,Ge.a.Yti)}TQn(Z){return Z===Bi.a.nkl||this.isVisible&&Z===Bi.a.ONe}fia(Z){Z?this.ua.raiseEvent("OnDesignerPaneFocusOn"):this.ua.raiseEvent("OnDesignerPaneFocusBlur")}h1h(Z){this.ua.addHandler("OnDesignerPaneFocusOn",
Z)}Sok(Z){this.ua.removeHandler("OnDesignerPaneFocusOn",Z)}i1h(Z){this.ua.addHandler("OnDesignerPaneFocusBlur",Z)}Tok(Z){this.ua.removeHandler("OnDesignerPaneFocusBlur",Z)}eZ(Z){(this.sad=Z)&&this.xv.focus()}get nyb(){return this.rRj}set nyb(Z){this.rRj=Z}ane(Z){this.setFocus("#"+this.id+" ."+Zf.LNl+":nth-child("+Z+") > ."+Zf.hIe)}HLn(){this.setFocus("#"+Zf.VCd)}GLn(){this.setFocus("#"+Zf.oBe)}cwh(Z){this.setFocus("."+Zf.O6c+"["+Ki.N6c+'="'+Z+'"')}ELn(){this.setFocus("."+Zf.Zsf)}FLn(){this.setFocus("."+
Zf.etf)}setFocus(Z){(Z=document.querySelector(Z))&&bb.FocusManager.UA(Z)}get isVisible(){return this.mc}get FAc(){return this.sad}get ta(){return this.Rb}get order(){return 7}get id(){return this.rG}get width(){let Z=0;this.isVisible&&(Z=Ge.a.Lnl,Z+=Ge.a.seh+wb.a.XBa);return Z}static Nqc(Z){return Nd.J$b(Z,"per","cui-img-16by16","cui-ctl-iconContainer","ClosePaneGlyph_16x16x32",CommonUIStrings.l_DialogClose,null)}static zAe(){const Z=document.createElement(Kb.a.poc);Z.type="button";Z.setAttribute(Ga.a.yz,
CommonUIStrings.l_DialogClose);Z.appendChild(Object(eb.b)(eb.a,20,20).ta);Z.className="SvgCloseButton";return Z}static J$b(Z,Ka,zb,dc,Jc,jd,Ed){const de=Kb.a.uJ();de.alt=jd;de.className=ba.e(Ka,Jc);de.src=Z.Yp(Ka+".png");de.setAttribute("Unselectable","on");Z=Kb.a.yx();Z.className=zb+" cui-img-cont-float";Z.appendChild(de);zb=Kb.a.yx();zb.className=dc;zb.setAttribute("Unselectable","on");zb.appendChild(Z);dc=Kb.a.JYa();dc.className="cui-ctl DesignerPaneButton";dc.title=jd;dc.setAttribute(Ga.a.pi,
Ga.a.BL);dc.tabIndex=0;dc.appendChild(zb);Ed&&(jd=Kb.a.yx(),jd.className="cui-ctl-mediumlabel",jd.setAttribute("Unselectable","on"),jd.innerText=Ed,dc.appendChild(jd));return dc}}Object(c.a)(Nd,"DesignerPane",null,[1320,495,24]);class Zd{constructor(Z,Ka,zb,dc,Jc,jd){this.S3a=!1;this.oqh=this.r0f=this.iHe=this.Ft=null;this.vHj=this.dSf=!1;this.hPj=null;this.S3a=rb.a("SvgCloseButton");this.la=Ka;this.ia=Z;this.odn=jd;this.ef=dc;this.jA=Jc;this.ZHl=ub.a.eb(qa.a.gyb,0);this.ia.za(sb.a.k_k,r.a.frame,
Object(e.a)(this,this.eym,"closeCallout"));this.GEa=Kb.a.hg();this.GEa.className="GoPremiumCalloutContainer";Z=document.createElement("i");Z.className=Sg.Cch+" GoPremiumIcon";Z.setAttribute(Ga.a.pi,Ga.a.KZ);Z.setAttribute("Unselectable","on");Z.setAttribute(Ga.a.RM,Ga.a.uE);this.S3a?(zb=document.createElement("div"),zb.className="GoPremiumHeader",zb.appendChild(Z),this.Tbc=Nd.zAe(),Sys.UI.DomElement.addCssClass(this.Tbc,"GoPremiumCalloutCloseNew"),zb.appendChild(this.Tbc),this.GEa.appendChild(zb)):
(this.Tbc=Nd.Nqc(zb),Sys.UI.DomElement.addCssClass(this.Tbc,"GoPremiumCalloutClose"),this.Tbc.setAttribute(Ga.a.pi,Ga.a.BL),this.GEa.appendChild(this.Tbc),this.GEa.appendChild(Z));this.m_title=Kb.a.hg();this.m_title.className="GoPremiumTitle";this.GEa.appendChild(this.m_title);this.iY=Kb.a.hg();this.iY.className="GoPremiumSubtitle";this.GEa.appendChild(this.iY);this.DWb=Kb.a.hg();this.DWb.className="GoPremiumButton";zb=Kb.a.yx();zb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;zb.setAttribute("Unselectable",
"on");zb.setAttribute(Ga.a.RM,Ga.a.uE);this.DWb.appendChild(zb);this.DWb.tabIndex=0;this.DWb.setAttribute(Ga.a.yz,zb.innerText);this.DWb.setAttribute(Ga.a.pi,Ga.a.BL);this.GEa.appendChild(this.DWb);this.Jz()}show(Z,Ka,zb,dc,Jc,jd){this.lS&&this.dismiss();this.iHe=dc;this.r0f=Ka;this.oqh=Jc;this.hPj=jd;this.iHe&&Sys.UI.DomElement.addCssClass(this.iHe,this.oqh);zb?(this.m_title.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.iY.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):
(this.m_title.innerText=ResourceStrings.l_DesignerUpsellCalloutTitle,this.iY.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);Ka.setAttribute(Ga.a.q$b,Ga.a.uE);this.la.syi?this.Ft=new qd.a(Z,document.body,h.AFrameworkApplication.Ea.rZ,null):(this.Ft=bd.a.Ymf(Z,document.body,document.body,2,Object(e.a)(this,this.dismiss,"dismiss")),this.Ft.oOe=120);this.Ft.$ba=310;this.GEa.setAttribute(Ga.a.yz,String.format("{0}. {1}",this.m_title.innerText,this.iY.innerText));this.GEa.setAttribute(Ga.a.pi,
Ga.a.qzb);this.jA&&this.jA.addHandler(this.GEa,ha.a.Lj,Object(e.a)(this,this.hOd,"inputKeyPressHandler"));this.Ft.content=this.GEa;this.DHa();Ka=new Sys.UI.Bounds(0,0,Oa.a.dDe(),Oa.a.aLd());this.Ft.p0=this.KJi(Ka,Z,240,zb);this.Ft.zz=!1;this.Ft.ecd=()=>{rb.a("CalloutCrashFix")&&!this.Ft?D.a.J(507605718,829,15,"PremiumContentCallout::m_callout is null."):(this.GEa.parentNode&&Sys.UI.DomElement.addCssClass(this.GEa.parentNode,"GoPremiumCalloutContentContainer"),this.Ft.xM&&(Sys.UI.DomElement.addCssClass(this.Ft.xM,
"GoPremiumCalloutOuter"),this.Ft.xM.removeAttribute(Ga.a.pi),this.la.syi||(this.Ft.xM.style.zIndex=String(h.AFrameworkApplication.Ea.tmc))),this.Ft.RMe(),this.I8(this.DWb),this.dSf=!0)};this.Ft.show()}DHa(){if(bb.FocusManager.tV()){var Z=bb.FocusManager.instance(),Ka=Z.gd("callout/modal");Ka.parent=Fa.a.vl;Z.U9e("callout/modal",Fa.a.vl,this.GEa);Z.yia("callout/modal",!1);Ka.bindAction(this.ZHl,sb.a.k_k);Ka=new Ie.DOMFocusListing(()=>this.GEa);Ka.wdd=!0;Ka.ft(2);Z=Z.HDa(()=>this.GEa,Z.gd("callout/modal"),
Ka);Z.Ndc();Z.caa=!0;Z.G$b=!0}}Cje(){if(bb.FocusManager.tV()&&!h.AFrameworkApplication.mi){const Ka=bb.FocusManager.instance();var Z=Ka.gd("callout/modal");Z&&Z.cG(this.ZHl);Ka.qka("callout/modal");(Z=Ka.x$("callout/modal"))&&Z.nt.tZ(null);Ka.Ddd("callout/modal")}}I8(Z){bb.FocusManager.tV()?bb.FocusManager.instance().x$("callout/modal").nt.Huc(Z):Z.focus()}get lS(){return!!this.Ft&&this.Ft.lS}GXm(){this.lS&&(this.dSf?this.Tbc.focus():this.DWb.focus(),this.dSf=!this.dSf)}Fol(){this.dismiss();return!0}eym(){this.dismiss();
return 32}dismiss(){if(!this.vHj){this.vHj=!0;try{this.Cje(),this.r0f&&(this.r0f.setAttribute(Ga.a.q$b,Ga.a.ksa),bb.FocusManager.UA(this.r0f),this.r0f=null),this.iHe&&(Sys.UI.DomElement.removeCssClass(this.iHe,this.oqh),this.iHe=null),this.hPj=this.oqh=null,this.dSf=!1,this.Ft&&(this.Ft.dismiss(),this.Ft.dispose(),this.Ft=null),this.jA&&this.jA.removeHandler(this.GEa,ha.a.Lj,Object(e.a)(this,this.hOd,"inputKeyPressHandler"))}finally{this.vHj=!1}}}dispose(){this.dismiss();this.xFa();this.GEa=this.Tbc=
this.DWb=null}hOd(Z){if(Z.keyCode===qa.a.hv||Z.keyCode===qa.a.C7){Z.preventDefault();Z=document.activeElement;try{Z?Z.click():D.a.J(508372757,829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(Ka){D.a.J(508372756,829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",Ka)}}}bQl(){this.odn(this.hPj);return!0}Jz(){this.ef?(this.ef.Zb(ha.a.click,this.Tbc,Object(e.a)(this,this.Fol,"dismissAndReturn")),this.ef.Zb(ha.a.click,this.DWb,Object(e.a)(this,this.bQl,
"onGoPremiumClicked"))):D.a.J(508372755,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")}xFa(){this.ef&&(this.ef.jc(ha.a.click,this.Tbc,Object(e.a)(this,this.Fol,"dismissAndReturn")),this.ef.jc(ha.a.click,this.DWb,Object(e.a)(this,this.bQl,"onGoPremiumClicked")))}KJi(Z,Ka,zb,dc){if(dc)return 0;dc=6;Ka.y-Z.y<zb&&(dc=3);return dc}}Object(c.a)(Zd,"PremiumContentCallout",null,[]);class Sd{constructor(Z,Ka,zb,
dc,Jc,jd,Ed,de){this.RAe=Z;this.PHm=Ka;this.Cfh=zb;this.Wh=dc;this.wDb=Jc;this.UEd=jd;this.GJk=Ed;this.Rzh=de}}Object(c.a)(Sd,"RenderSuggestionsArgs",null,[1388]);class qe extends Sys.EventArgs{constructor(Z){super();this.card=Z}}Object(c.a)(qe,"ClickSuggestedActionEventArgs",Sys.EventArgs,[]);class Xe extends Sys.EventArgs{constructor(Z){super();this.qVd=Z}}Object(c.a)(Xe,"DesignerClickMoreIdesEventArgs",Sys.EventArgs,[]);class Te extends Sys.EventArgs{constructor(Z,Ka){super();this.MJn=Z;this.fTn=
Ka}}Object(c.a)(Te,"DesignerClickSuggestionEventArgs",Sys.EventArgs,[]);class af extends Db.a{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah){super(new Vb.a,Z,jd);this.OYd=this.PYd=this.bta=this.e2a=this.p2f=this.MTa=null;this.QIl=this.SIl=0;this.fta=!1;this.CMl=this.bJc=this.GC=null;this.EVb=0;this.QD=zb;this.FI=dc;this.Vd=Jc;this.Ma=Ed;this.ef=de;this.rf=Ka;this.UB=Ne;this.jA=Re;this.ia=Cf;this.Ge=yg;this.la=bh;this.r$l=this.la.cfc;this.QEa=new fe.a(()=>new Zd(this.ia,this.la,Ka,de,Re,Object(e.a)(this,
this.Nxl,"goPremiumExperience")));this.IHl=new Ic(Ah,Object(e.a)(this,this.Jnn,"onAccountUpgrade"),bh.gsc);this.Loa=new ng;this.rcn=Object.assign(new Ug(Cf,this.Loa,this.la),{LX:sb.a.gbc})}dispose(){this.fta&&this.Njl();this.GC&&(this.GC.dispose(),this.GC=null);this.QEa.wMd&&this.QEa.value.dispose();super.dispose();D.a.J(512496477,829,50,"DesignerView::Dispose")}VNd(){this.MTa=Kb.a.hg();this.MTa.className="DesignerViewContainer";this.container.appendChild(this.MTa);this.fta=!0;D.a.J(512496476,829,
50,"DesignerView::InitializeView")}Njl(){this.la.ktf&&this.FI.txm();if(this.MTa.children&&0<this.MTa.children.length)for(const Z=0;Z<this.MTa.children.length;)this.MTa.removeChild(this.MTa.children[Z]);this.QD.nyb=0;this.QD.Sok(Object(e.a)(this,this.onFocus,"onFocus"));this.QD.Tok(Object(e.a)(this,this.YPl,"onFocusBlur"));this.QEa.wMd&&this.QEa.value.dismiss();D.a.J(512496475,829,50,"DesignerView::CleanUpView")}Aed(Z){D.a.J(512496474,829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",
this.Vd.correlationId,oa[Z]);this.R4();4!==Z&&7!==Z&&8!==Z&&(this.Njl(),this.MTa.id=this.Vd.correlationId);this.QD.nyb=Z;switch(this.QD.nyb){case 1:this.l1m();this.pNn();break;case 7:this.oNn();break;case 2:this.r1m();break;case 9:this.q1m();break;case 5:this.y1m();break;case 3:this.A1m();break;case 6:this.m1m();break;case 4:if(Z=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(let Ka=0;Ka<Z.length;Ka++)Z[Ka].style.visibility=kc.a.visible,Z[Ka].setAttribute(Sg.Dai,Sg.Cil);this.la.getBooleanAppSetting("DesignerDisableMoreIdeasOnRefreshEnabled")&&
(Z=document.querySelector("."+Sg.Bch))&&(Z.style.backgroundColor="transparent",Z.style.pointerEvents="none",Z.style.border="1px solid #a19f9d",Z.style.color="#a19f9d",Z.setAttribute("disabled",!0))}this.QD.h1h(Object(e.a)(this,this.onFocus,"onFocus"));this.QD.i1h(Object(e.a)(this,this.YPl,"onFocusBlur"))}sac(){return this.la.bui&&this.IHl.sac()}Nxl(Z){this.la.bui&&(D.a.J(512496473,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",Z?Z.toString():""),this.QEa.wMd&&this.QEa.value.dismiss(),
this.IHl.launchUpsellExperience(this.la.gsc?"designertrial":"designer"))}startFreeTrial(){this.QEa.wMd&&this.QEa.value.dismiss();this.FI.YUn();this.Vd.uMk=!0;this.CS(0,!0);D.a.J(512496472,829,50,"DesignerView::StartFreeTrial Free Trial started")}Jnn(){D.a.J(512496471,829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");this.QEa.wMd&&this.QEa.value.dismiss();this.FI.RWn()}l1m(){this.p2f=Kb.a.hg();this.p2f.className="DesignerLoadingView";const Z=Kb.a.uJ();Z.className=h.AFrameworkApplication.isRtl?
"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";Z.src=qb.a.mX(Ge.a.nUa);const Ka=Kb.a.hg();Ka.className=h.AFrameworkApplication.isRtl?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";Ka.innerText=ResourceStrings.L_DesignerLoading;this.p2f.appendChild(Z);D.a.J(512496470,829,50,"DesignerView::spinner shows up");this.p2f.appendChild(Ka);this.MTa.appendChild(this.p2f);D.a.J(512496469,829,50,"DesignerView::InitLoadingState")}s1m(){const Z=Kb.a.hg();Z.className="DesignerNoSuggestionNewButton";
Z.tabIndex=0;Z.innerText=ResourceStrings.L_DesignerLearnMoreShort;Z.setAttribute("Unselectable","on");Z.setAttribute(Ga.a.yz,Z.innerText);Z.setAttribute(Ga.a.pi,Ga.a.BL);Z.setAttribute("href",Ge.a.Xti);this.ef.Zb(ha.a.click,Z,Object(e.a)(this,this.hkl,"clickSuggestionLinkHandler"));this.e2a.appendChild(Z)}p1m(){const Z=Kb.a.JYa();Z.className="DesignerNoSuggestionView-Link";Z.setAttribute("href",Ge.a.Xti);Z.setAttribute("target","_blank");Z.innerText=ResourceStrings.L_DesignerLearnMore;Z.tabIndex=
0;Z.setAttribute(Ga.a.pi,Ga.a.Pbh);this.e2a.appendChild(Z);this.ef.Zb(ha.a.click,Z,Object(e.a)(this,this.hkl,"clickSuggestionLinkHandler"))}r1m(){this.QD.isVisible&&(this.Aaj(!1),this.PYd.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,this.OYd.innerText=ResourceStrings.L_DesignerNoSuggestionContent,D.a.J(512496468,829,50,"DesignerView::InitNoSuggestionState"))}q1m(){this.QD.isVisible&&(this.Aaj(!0),this.PYd.innerText=ResourceStrings.L_DesignerNoIdeasHeader,this.OYd.innerText=ResourceStrings.L_DesignerNoIdeas,
D.a.J(512496467,829,50,"DesignerView::InitNoSuggestionState"))}y1m(){this.QD.isVisible&&(this.Aaj(!1),this.PYd.innerText=ResourceStrings.L_DesignerCoauthorHeader,this.OYd.innerText=ResourceStrings.L_DesignerCoauthorContent,D.a.J(512496466,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"))}Aaj(Z){this.e2a=Kb.a.hg();this.e2a.className=h.AFrameworkApplication.isRtl?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";this.PYd=Kb.a.hg();this.OYd=Kb.a.hg();this.FI.JZl(this.MTa);if(Z){this.PYd.className=
"DesignerNoSuggestionNew-Header";this.OYd.className="DesignerNoSuggestionNew-Content";const Ka=Kb.a.uJ();Ka.src=this.rf.Yp("DesignerNoIdeas.svg");Ka.className="DesignerNoIdeasIllustration";this.e2a.appendChild(Ka)}else this.PYd.className="DesignerNoSuggestionView-Header",this.OYd.className="DesignerNoSuggestionView-Content";this.e2a.appendChild(this.PYd);this.e2a.appendChild(this.OYd);Z?this.s1m():this.p1m();this.MTa.appendChild(this.e2a);this.jA.addHandler(this.e2a,ha.a.Lj,Object(e.a)(this,this.hOd,
"inputKeyPressHandler"))}A1m(){this.QD.isVisible||this.QD.wA(!0,Bi.a.none);this.bta=Kb.a.hg();const Z=this.r$l?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",Ka=this.r$l?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";this.bta.className=h.AFrameworkApplication.isRtl?Ka:Z;this.MTa.appendChild(this.bta);this.la.$ti||(this.Ma.lm(Fa.a.Uma,!0),this.Ma.Wd());this.ef.Zb(ha.a.click,this.bta,Object(e.a)(this,this.Uxm,"clickSuggestionHandler"));this.jA.addHandler(this.bta,ha.a.Lj,
Object(e.a)(this,this.Mjh,"inputKeyApplyHandler"));this.UB.Zb(ha.a.KP,this.bta,Object(e.a)(this,this.P3,"onPointerOver"));this.UB.Zb(ha.a.AR,this.bta,Object(e.a)(this,this.O3,"onPointerOut"));D.a.J(512496465,829,50,"DesignerView::InitShowSuggestionState")}KSm(){return this.yHf(this.bta.querySelector("#"+this.KE.id+" .DesignerSuggestionResultSelected"))}vPm(){return this.yHf(this.bta.querySelector("#"+this.KE.id+" ["+Sg.Jwd+"]:hover"))}yHf(Z){let Ka;return(()=>{let zb=this.Swl(Z);({suggestionIndex:Ka}=
zb);return zb})().returnValue?parseInt(Ka):-1}Swl(Z){let Ka,zb,dc;dc=zb=Ka="";if(Z){const Jc=Z.getAttribute(Sg.yoc),jd=Z.getAttribute(Sg.Jwd);if(!Jc||!jd)return D.a.J(512496464,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",this.Vd.correlationId),{returnValue:!1,suggestionIndex:Ka,slideId:zb,uKk:dc};Ka=Jc.toString();zb=jd.toString();(Z=Z.getAttribute(Sg.Ech))?dc=Z.toString():D.a.J(512496463,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",
this.Vd.correlationId);return{returnValue:!0,suggestionIndex:Ka,slideId:zb,uKk:dc}}return{returnValue:!1,suggestionIndex:Ka,slideId:zb,uKk:dc}}XCe(){return this.bta.querySelectorAll("#"+this.KE.id+" ["+Sg.yoc+"]").length}hkl(Z){return this.QD.isVisible&&Z&&Z.Oj?this.Pxl(Z.Oj.className):!1}uAb(){const Z=this.la.cfc?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",Ka=this.la.cfc?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return this.container.querySelector("."+(h.AFrameworkApplication.isRtl?
Ka:Z))}Txm(Z){Z=Z.getAttribute(Sg.yoc).toString();Z=this.Vd.B5c[parseInt(Z)];if(!Z||3!==Z.Type&&4!==Z.Type)return!1;this.Ge.BWl(new qe(Z));return!0}ggh(Z,Ka){for(;Z&&Z.className!==Ka;)Z=Z.parentNode;return Z}Uxm(Z){if(!this.QD.isVisible||Z.cD!==Sys.UI.MouseButton.leftButton||!this.FI.Ga||!Z.Dc)return!1;var Ka=Z.Dc;try{if(Ka.className){if(Ka.className===Zf.hIe||Ka.className===Zf.iIe||Ka.className===Zf.uUj||Ka.className===Zf.arh)return this.Rxm(Ka);if(Ka.className.startsWith(Zf.rpl))return this.Qxm(Ka)}else D.a.J(512496462,
829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(bh){return D.a.J(512496461,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",Ka.className,bh.message),!1}var zb=this.ggh(Ka,Sg.Hil);if(zb)return this.Txm(zb);if(this.sac()){if(Ka.className===Sg.Qze)return this.startFreeTrial(),!0;if(Ka.className===Sg.Tff)return Z=Ac.a.Ni(Ka),this.QEa.value.show(Z,Ka,!0,Ka,"DesignerInFreeTrialViewGoPremiumTextSelected",null),!0;(zb=this.ggh(Ka,Sg.Sff))||(zb=this.ggh(Ka,Sg.xch));
if(zb)return this.Nxl(null),!0}if(this.la.Rzb&&(zb=this.ggh(Ka,Sg.Bch))){this.FI.djh(this.uAb());if(!zb.getAttribute(Sg.Pze))return!1;this.FI.bQn(this.uAb());Ka=new Xe(zb.getAttribute(Sg.Pze).toString());this.Ge.EWl(Ka);return!0}if(Sys.UI.DomElement.containsCssClass(Ka,"ms-Icon--Diamond")){if(Ka=Ka.parentNode,!Ka)return!1}else if(!(Sys.UI.DomElement.containsCssClass(Ka,Sg.Dch)||Sys.UI.DomElement.containsCssClass(Ka,Sg.zgf)||Sys.UI.DomElement.containsCssClass(Ka,Sg.Fch)||(Ka=Ka.firstChild,Ka)))return!1;
const dc=Ka.parentNode;zb=document.querySelector("#"+this.KE.id+" ."+Sg.soc);let Jc,jd,Ed;if(!(()=>{let bh=this.Swl(dc);({suggestionIndex:Jc,slideId:jd,uKk:Ed}=bh);return bh})().returnValue)return!1;var de=parseInt(Jc),Ne=parseInt(jd),Re=parseInt(Ed)||0,Cf=this.Vd.NXa.sid===Ne;Object(rb.a)("DesignerPaneArrowKeyFocusFix")&&(this.EVb=de,this.CS(de,!0));this.la.Rzb&&(Cf=this.FI.qCe(zb,!1)===dc||this.FI.qCe(zb,!0)===dc);if(Cf)return D.a.J(512496460,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),
this.Ge.Ffk(new Te(de,this.XCe())),!1;if(dc&&dc.getAttribute(Sg.Ach)){Ka=null;Z=dc.childNodes;for(zb=0;zb<Z.length;zb++)if(de=Z[zb],Sys.UI.DomElement.containsCssClass(de,Sg.Dch)){Ka=de;break}Z=new Pc(Jc,jd,Ed);Ka=Ac.a.Ni(Ka||dc);this.QEa.value.show(Ka,dc,!1,null,null,Z);return!1}if(Sys.UI.DomElement.containsCssClass(Ka,Sg.Fch))return!1;Cf=this.zSm(Ka,Ne,Re);Ne=Object.assign(new oj,{SuggestionCid:Re,SuggestionSid:Ne,CorrelationId:zb.getAttribute("correlationId").toString(),ActiveSlideCid:this.FI.Ga.cid,
ActiveSlideSid:this.FI.Ga.sid});Re=Ka;Re=.01>=Math.abs(Re.width/Re.height-1.33);let yg=void 0;this.FI.qCe(zb,Re)?(this.FI.Mjl(zb,Re),Cf&&Cf.parentNode&&Cf.parentNode.parentNode&&this.FI.Mjl(Cf.parentNode.parentNode,Re),yg=sb.a.mKb,this.ia.Qa(yg,2,Ne),D.a.J(512496459,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):(yg=sb.a.EDa,this.ia.Qa(yg,2,Ne),D.a.J(512496458,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));Object(rb.a)("DesignerInteractivePerfTrackingEnabled")&&
Le.ActionManager.nE(Z.Sb.rawEvent,Le.ActionManager.D9?Le.ActionManager.D9(yg):"",void 0);this.la.Hnl&&dc&&dc.getAttribute(Sg.H$h)&&l.a.instance.Na("Common.ISystemInitiatedFeedback").execute(bh=>{try{bh.logActivity("DesignerAnimationSuggestion",null)}catch(Ah){D.a.J(512496457,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",Ah)}});this.FI.W1l(Ka.parentNode,Re);Cf&&this.FI.W1l(Cf.parentNode,Re);this.FI.g1l(this.MTa,de);this.Ge.Ffk(new Te(de,this.XCe()));return!0}zSm(Z,Ka,
zb){var dc="["+Sg.Jwd+'="'+Ka+'"] > .'+Sg.zgf;zb&&(dc=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',Sg.Jwd,Ka,Sg.Ech,zb,Sg.zgf));Ka=document.querySelectorAll(dc);if(!Ka)return null;for(zb=0;zb<Ka.length;zb++)if(dc=Ka[zb],dc!==Z)return dc;return null}hOd(Z){this.QD.isVisible&&(Z.keyCode!==qa.a.hv&&Z.keyCode!==qa.a.C7||this.Pxl(Z.target.className))}Mjh(Z){if(this.QD.isVisible){if(Z.keyCode===qa.a.hv||Z.keyCode===qa.a.C7){Z.preventDefault();Z.stopPropagation();var Ka=document.activeElement;Ka&&Ka.click()}Object(rb.a)("DesignerPaneArrowKeyFocusFix")&&
(Z.keyCode==qa.a.x_&&(Z.preventDefault(),Z.stopPropagation(),Ka=0>this.EVb-1?0:this.EVb-1,this.EVb=0>this.EVb-1?0:this.EVb-1,this.CS(Ka,!0)),Z.keyCode==qa.a.U3&&(Z.preventDefault(),Z.stopPropagation(),Z=this.XCe(),Ka=this.EVb+1<Z?this.EVb+1:Z-1,this.EVb=this.EVb+1<Z?this.EVb+1:Z-1,this.CS(Ka,!0)))}}CS(Z,Ka){if(!(0>Z)){var zb=this.bta.querySelector("["+Sg.yoc+'="'+Z+'"]');zb?Ka&&(bb.FocusManager.UA(zb),this.FI.g1l(this.MTa,Z)):D.a.J(512496456,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",
Z)}}txl(){return this.sac()?this.bta.querySelector("."+Sg.Tff)?2:this.bta.querySelector("."+Sg.Qze)?1:this.bta.querySelector("."+Sg.Sff)?3:0:0}PDl(){return!!this.bta.querySelector("."+Sg.Qze+":focus")}VRg(Z){const Ka=this.bta.querySelector("."+Sg.Qze);Ka?Z?bb.FocusManager.UA(Ka):Ka.blur():D.a.J(512496455,829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}Kyl(){this.jEl()&&this.QEa.value.GXm()}jEl(){return this.QEa.wMd&&this.QEa.value.lS}i7m(Z){return Z?!!Z&&(Z.className===
Sg.Qze||Z.className===Sg.xch||Z.className===Sg.Tff||Z.className===Sg.Sff):!1}h6b(Z,Ka){let zb=null;1===Ka?zb=this.bta.querySelector("."+Sg.xch):2===Ka?zb=this.bta.querySelector("."+Sg.Tff):3===Ka&&(zb=this.bta.querySelector("."+Sg.Sff));zb?Z?bb.FocusManager.UA(zb):zb.blur():D.a.J(512496454,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",Ka)}iNn(Z,Ka){(Ka=9===Ka?this.e2a.querySelector(".DesignerNoSuggestionNewButton"):this.e2a.querySelector(".DesignerNoSuggestionView-Link"))?
Z?Ka.focus():Ka.blur():D.a.J(512496453,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}P6m(Z){return!(9===Z?!this.e2a.querySelector(".DesignerNoSuggestionNewButton:focus"):!this.e2a.querySelector(".DesignerNoSuggestionView-Link:focus"))}Pxl(Z){try{const Ka=this.e2a.querySelector("."+Z);if(!Ka)return!1;const zb=Ka.getAttribute("href").toString();if(!zb)return!1;Ac.a.openWindow(4,zb);return!0}catch(Ka){return D.a.J(512496452,829,10,"DesignerView:GoToSuggestionLink exception: {0}",
Ka),!1}}YPl(){this.QD.isVisible&&this.QEa.wMd&&this.QEa.value.lS&&this.QEa.value.dismiss()}onFocus(){if(this.QD.isVisible)if(2===this.QD.nyb)bb.FocusManager.UA(this.e2a.lastChild);else if(3===this.QD.nyb){var Z=this.txl();if(1===Z)this.VRg(!0);else if(3===Z)this.h6b(!0,Z);else{Z=this.KSm();var Ka=this.vPm();-1===Z?this.CS(-1===Ka?0:Ka,!0):this.CS(Z,!0)}}}P3(Z){return this.QD.isVisible&&Z.Dc?this.qpl(Z.clientPoint):!1}usm(Z){var Ka;if(Z){var zb=Z.getAttribute(Sg.Jwd);if((Ka=Z.getAttribute(Sg.Ech))&&
zb)Ka=Ka.toString(),zb=zb.toString();else{D.a.J(509371461,829,10,"DesignerView::applyFirstDesignerSuggestion - Failed to parse suggestion slide creation id and slideId, CorrelationId: {0}",this.Vd.correlationId);return}}D.a.J(508941526,829,50,"DesignerView::applyFirstDesignerSuggestion - CorrelationId: {0}",this.Vd.correlationId);Z=parseInt(zb);Ka=parseInt(Ka)||0;Ka=Object.assign(new oj,{SuggestionCid:Ka,SuggestionSid:Z,CorrelationId:this.Vd.correlationId,ActiveSlideCid:this.FI.Ga.cid,ActiveSlideSid:this.FI.Ga.sid});
this.ia.Qa(sb.a.EDa,2,Ka)}EDa(Z,Ka){D.a.J(509089807,829,50,"DesignerView::applyDesignerSuggestion - auto apply designer, CorrelationId: {0}",this.Vd.correlationId);Z=Object.assign(new oj,{SuggestionCid:Ka,SuggestionSid:Z,CorrelationId:this.Vd.correlationId,ActiveSlideCid:this.FI.Ga.cid,ActiveSlideSid:this.FI.Ga.sid});this.ia.Qa(sb.a.EDa,2,Z)}O3(Z){return this.QD.isVisible&&Z.Dc?this.qpl(Z.clientPoint):!1}vWm(Z){this.R4();this.Aed(2);D.a.J(512496451,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",
Z);this.QD.isVisible&&(this.Vd.P9c=!0,this.ia.Qa(sb.a.Fbb,2,new td.a(!1,Bi.a.jyh)))}pNn(){const Z=this.Vd.correlationId;this.SIl=window.setTimeout(()=>{this.vWm(Z)},this.la.ueh)}uWm(Z){this.R4();this.FI.djh(this.uAb());D.a.J(512496450,829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",Z)}oNn(){const Z=this.Vd.correlationId;this.QIl=window.setTimeout(()=>{this.uWm(Z)},this.la.ueh)}R4(){window.clearTimeout(this.SIl);window.clearTimeout(this.QIl)}get KE(){return this.QD}m1m(){this.bta.style.display=
kc.a.none;this.Vd.XRj=!0;this.bJc=Kb.a.hg();this.bJc.className=Zf.zgn;const Z=this.Bml(Zf.wUj),Ka=document.createElement("iframe");Ka.className=Ka.id=Zf.NNl;const zb=this.Bml(Zf.vUj);this.bJc.appendChild(Z);this.bJc.appendChild(Ka);this.bJc.appendChild(zb);this.MTa.appendChild(this.bJc);const dc=this.Ma.gd(Fa.a.UMf);dc.parent=ja.AFrame.tE;this.ef.x4c(Fa.a.UMf,Ka);dc.G9(()=>{Ka.focus();const Jc=Object.assign(new Ie.DOMFocusListing(()=>this.bJc),{wdd:!0});Jc.ft(3);Jc.ft(2);Jc.ft(4);Jc.ft(1);Jc.ft(6);
Jc.ft(5);bb.FocusManager.instance().hff(this.bJc,dc,Jc);const jd=bb.FocusManager.instance().x$(Fa.a.UMf);jd.Ndc();jd.caa=!0;jd.G$b=!0;dc.cG(bb.FocusManager.instance().$3c);dc.cG(bb.FocusManager.instance().a4c);Jc.tZ(Ka)});this.Ma.gh(Fa.a.UMf);this.jA.addHandler(this.bJc,ha.a.Lj,Object(e.a)(this,this.bL,"keyDownHandler"))}Bml(Z){const Ka=document.createElement("div");Ka.setAttribute("Id",Z);Ka.setAttribute("tabindex",0);Ka.setAttribute("position","absolute");Ka.setAttribute("width","-1000px");Ka.setAttribute("top",
"-1000px");return Ka}bL(Z){Z.keyCode===Sys.UI.Key.tab&&(Z.target.id!==Zf.vUj||Z.shiftKey?Z.target.id===Zf.wUj&&Z.shiftKey&&this.I2l(Z,Zf.vUj):this.I2l(Z,Zf.wUj))}I2l(Z,Ka){Z.preventDefault();Z.stopPropagation();(Z=document.getElementById(Ka))&&Z.focus()}Rxm(Z){switch(Z.className){case Zf.arh:return this.KE.ane(1),!0;case Zf.hIe:Z=Z.querySelector("."+Zf.iIe).innerText;break;case Zf.iIe:Z=Z.innerText;break;case Zf.uUj:Z=Z.parentNode.querySelector("."+Zf.iIe).innerText;break;default:return!1}return this.QGn(Z)}QGn(Z){this.la.Rzb&&
(this.CMl=this.uAb().querySelector("."+Sg.soc).getAttribute("correlationId").toString());this.Aed(6);var Ka=Va.a.DV(this.la.lPa).toString();Ka=String.format(this.la.Lzc,h.AFrameworkApplication.lcid,fj.a.Ne(h.AFrameworkApplication.lcid).name,h.AFrameworkApplication.buildVersion,Di.a.create().toString(),3,Ka,0);Ka=Ka.replace(RegExp("&amp;","g"),"&").replace(RegExp("&p=3"),"&p=6")+"&q="+Z;Z=document.getElementById(Zf.NNl);Z.setAttribute("src",Ka);Z.style.visibility=kc.a.visible;this.GC=(new bg).getInstance(Z.contentWindow,
Ka);this.GC.Jdc(sf.a.BJb,zb=>{if(zb=this.Loa.gTl(zb)){const dc=[];Array.add(dc,zb);this.ia.Cb(sb.a.OUg,2);this.KE.wA(!1,Bi.a.nkl);this.rcn.fbc(dc)}});this.GC.Jdc(Ki.lca,()=>{this.Aed(3);const zb=new Sd(this.Vd.suggestions,this.Vd.suggestions?this.Vd.suggestions.SlideSuggestions.length:0,this.Vd.B5c.length,this.la.Rzb?this.CMl:this.Vd.correlationId,this.uAb(),!0,this.sac(),this.FI.Cjh(Xg.a.makeItVisual));this.FI.fqk(zb)});return!0}Qxm(Z){return Sys.UI.DomElement.containsCssClass(Z,Zf.qBe)||Sys.UI.DomElement.containsCssClass(Z,
Zf.pBe)?this.jWm(Z):Sys.UI.DomElement.containsCssClass(Z,Zf.O6c)||Sys.UI.DomElement.containsCssClass(Z,Zf.cfh)||Sys.UI.DomElement.containsCssClass(Z,Zf.vpl)||Sys.UI.DomElement.containsCssClass(Z,Zf.upl)?this.kWm(Z):Sys.UI.DomElement.containsCssClass(Z,Zf.Zsf)?this.yWm():Sys.UI.DomElement.containsCssClass(Z,Zf.etf)?this.QWm():!1}QWm(){this.ia.Cb(sb.a.Nsh,2);this.KE.wA(!1,Bi.a.ntn);return this.Vd.kpl=!0}qpl(Z){const Ka=this.Vd.$ji;if(!Ka||sd.a.rb(this.Vd.WSa))return!1;Z=Ac.a.sPb(Z);this.r4m(Z)?Ka.kjh(this.nul()):
Ka.kjh([]);return!0}r4m(Z){for(;Z&&Z.className!==Zf.Qxi;)Z=Z.parentNode;return!!Z&&Z.className===Zf.Qxi}yWm(){const Z=this.Vd.$ji;if(!Z)return!1;Z.ignoreCritiques(this.nul(),4);this.Vd.WSa.splice(this.Vd.hwa,1);if(this.Vd.hwa===this.Vd.WSa.length){let Ka;(Ka=this.Vd).hwa=Ka.hwa-1}this.SDn();return!0}nul(){const Z=[];for(const Ka of this.Vd.WSa[this.Vd.hwa].critiques)Z.push(Ka.critiqueId);return Z}jWm(Z){if(Sys.UI.DomElement.containsCssClass(Z,Zf.qBe)){let Ka;(Ka=this.Vd).hwa=Ka.hwa-1;this.Vd.hwa||
(Sys.UI.DomElement.removeCssClass(Z,Zf.qBe),Sys.UI.DomElement.addCssClass(Z,Zf.btf));Z=document.getElementById(Zf.oBe);Sys.UI.DomElement.removeCssClass(Z,Zf.atf);Sys.UI.DomElement.addCssClass(Z,Zf.pBe)}else{let Ka;(Ka=this.Vd).hwa=Ka.hwa+1;this.Vd.hwa===this.Vd.WSa.length-1&&(Sys.UI.DomElement.removeCssClass(Z,Zf.pBe),Sys.UI.DomElement.addCssClass(Z,Zf.atf));Z=document.getElementById(Zf.VCd);Sys.UI.DomElement.removeCssClass(Z,Zf.btf);Sys.UI.DomElement.addCssClass(Z,Zf.qBe)}document.getElementById(Zf.Pxi).innerText=
(this.Vd.hwa+1).toString();this.B9l(this.Vd.hwa);return!0}B9l(Z){var Ka=this.Vd.WSa[Z].critiques[0].explanationLabel;document.getElementById(Zf.tpl).innerText=Ka;Ka=document.getElementById(Zf.wpl);const zb=Sg.mml();Ka.parentNode.replaceChild(zb,Ka);this.FI.zyl(zb,Z)}kWm(Z){const Ka=this.Vd.$ji;if(sd.a.rb(this.Vd.WSa)||!Ka)return!1;Z=Z.getAttribute(Ki.N6c);var zb=document.querySelector("."+Zf.cfh+"["+Ki.N6c+'="'+Z+'"]');zb&&(zb.innerText="\u2713",Sys.UI.DomElement.removeCssClass(zb,Zf.cfh),Sys.UI.DomElement.addCssClass(zb,
Zf.lGm));zb=new ua.a(0);for(const dc of this.Vd.WSa[this.Vd.hwa].critiques)zb.add(dc.critiqueId,Z);Ka.Z6l(zb);return this.Vd.afh=!0}SDn(){var Z=document.getElementById(Zf.ipl);let Ka=parseInt(Z.innerText);Ka--;if(0>=Ka)this.hQn(document.getElementById(Zf.jpl));else{Z.innerText=Ka.toString();this.B9l(this.Vd.hwa);Z=this.Vd.hwa===this.Vd.WSa.length-1;const zb=document.getElementById(Zf.oBe);1<Ka&&!Z?(Sys.UI.DomElement.addCssClass(zb,Zf.pBe),Sys.UI.DomElement.removeCssClass(zb,Zf.atf)):(Sys.UI.DomElement.addCssClass(zb,
Zf.atf),Sys.UI.DomElement.removeCssClass(zb,Zf.pBe));Z&&(document.getElementById(Zf.Pxi).innerText=Ka.toString());Z=document.getElementById(Zf.VCd);1<Ka&&this.Vd.hwa?(Sys.UI.DomElement.addCssClass(Z,Zf.qBe),Sys.UI.DomElement.removeCssClass(Z,Zf.btf)):(Sys.UI.DomElement.addCssClass(Z,Zf.btf),Sys.UI.DomElement.removeCssClass(Z,Zf.qBe))}}hQn(Z){const Ka=Kb.a.hg();Ka.className=Zf.hGm;const zb=new Dj.a;zb.mh(40,40);zb.AUa("0,0,2048,2048");zb.Zv(Zf.mGm);var dc=new el.a;dc.Bka("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
const Jc=new el.a;Jc.Bka("M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");Jc.ta.setAttribute("class",Zf.pGm);const jd=
new el.a;jd.Bka("M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
jd.ta.setAttribute("class",Zf.fGm);const Ed=new el.a;Ed.Bka("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
Ed.ta.setAttribute("class",Zf.eGm);zb.appendChild(dc);zb.appendChild(Jc);zb.appendChild(jd);zb.appendChild(Ed);dc=Kb.a.yx();dc.innerText=ResourceStrings.l_ConsistencyCardNoMore;dc.className=Zf.iGm;Ka.appendChild(zb.ta);Ka.appendChild(dc);Z.parentNode.replaceChild(Ka,Z)}}af.bGm=[Zf.VCd,Zf.oBe,Zf.O6c,Zf.Zsf,Zf.etf];Object(c.a)(af,"DesignerView",Db.a,[1319,181,145,24]);var nf=a(389);class mf extends Sys.EventArgs{constructor(Z,Ka){super();this.slideId=Z.slideId;this.M6l=Z.dfd;this.Nql=Z.ura;this.UEd=
Ka;this.trigger=Z.trigger;this.correlationId=Z.correlationId}}Object(c.a)(mf,"RenderSuggestionsEventArgs",Sys.EventArgs,[]);class Mf{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah){this.mJl=new cl.a;this.aD=Z;this.FI=Ka;this.Vd=zb;this.la=dc;this.ia=Jc;this.va=jd;this.Mb=Ed;this.Ad=de;this.xb=Ne;this.Ma=Re;this.Tb=Cf;this.Y0f=this.kCj=0;this.lad=yg;this.Van=bh;this.ucc=Ah;this.Jz()}Jz(){this.Ad.zel(Object(e.a)(this,this.QRl,"onSuggestionsUpdated"));this.Ad.yel(Object(e.a)(this,this.zPl,"onCoauthModifiedSameSlide"));
this.Van.execute(Z=>{Z.ppm(Object(e.a)(this,this.jsn,"onShowMoreSuggestions"),()=>{this.JMe(this.aD,3)})});this.la.PSa&&this.Ad.efl(Object(e.a)(this,this.kSl,"onUserBeginUploadPicture"));this.Ad.taf(Object(e.a)(this,this.u1b,"onUndoRedo"))}dispose(){this.Ad.OYl(Object(e.a)(this,this.QRl,"onSuggestionsUpdated"));this.Ad.NYl(Object(e.a)(this,this.zPl,"onCoauthModifiedSameSlide"));this.la.PSa&&this.Ad.jZl(Object(e.a)(this,this.kSl,"onUserBeginUploadPicture"));this.Ad.JKg(Object(e.a)(this,this.u1b,"onUndoRedo"))}pKn(Z){this.ia.Qa(sb.a.Fbb,
2,new td.a(!1,Z))}JMe(Z,Ka){Z?Z.Aed(Ka):D.a.J(512496522,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",this.Vd.correlationId,Ka)}DXm(Z){const Ka=this.jEm(Z);if(Ka){var zb=Ka.KE;D.a.J(512496521,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",Z,oa[zb.nyb]);switch(zb.nyb){case 3:this.xmn(Z,Ka);break;case 2:case 9:this.wmn(Z,Ka,zb.nyb)}}}jEm(Z){switch(Z){case sb.a.jOc:case sb.a.b$d:case sb.a.Dbd:case sb.a.kOc:case sb.a.d$d:case sb.a.Fbd:case sb.a.c$d:case sb.a.Ebd:Z=
this.aD;break;default:return null}return Z}xmn(Z,Ka){if(Ka&&Ka.KE){var zb=document.activeElement;if(zb){var dc=zb.getAttribute(Sg.yoc),Jc=Ka.i7m(zb),jd=Sys.UI.DomElement.containsCssClass(zb,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(zb,"IdeasText"),Ed=this.MNl(zb)||this.lpl(zb),de=Ka.jEl();if(dc||jd||Ed||Jc||de)if(dc=dc?parseInt(dc.toString()):-1,Jc=Ka.XCe()-1,!(1>Jc))switch(jd=Ka.KE,Ed=Ka.txl(),Z){case sb.a.jOc:if(de||1===Ed||3===Ed)break;jd.eZ(!1);dc<Jc&&(Ka.CS(dc,!1),Ka.CS(dc+
1,!0));break;case sb.a.b$d:if(de||1===Ed||3===Ed)break;jd.eZ(!1);dc!==Jc&&(Ka.CS(dc,!1),Ka.CS(Jc,!0));break;case sb.a.Dbd:if(de){Ka.Kyl();break}this.LWm(Ka,dc,Jc,Ed);break;case sb.a.kOc:if(de||1===Ed||3===Ed)break;jd.eZ(!1);0<dc&&(Ka.CS(dc,!1),Ka.CS(dc-1,!0));break;case sb.a.d$d:if(de||1===Ed||3===Ed)break;jd.eZ(!1);dc&&(Ka.CS(dc,!1),Ka.CS(0,!0));break;case sb.a.Fbd:if(de){Ka.Kyl();break}this.MWm(Ka,dc,Jc,Ed);break;case sb.a.c$d:case sb.a.Ebd:de||1===Ed||3===Ed||(Z=Z===sb.a.Ebd,Ka=Ka.KE,this.MNl(zb)?
this.OWm(Z,Ka):this.lpl(zb)&&this.NWm(Z,Ka))}}}}LWm(Z,Ka,zb,dc){const Jc=Z.KE;if(-1===Ka){switch(dc){case 1:Jc.FAc?(Jc.eZ(!1),Z.VRg(!0)):Z.PDl()?(Z.VRg(!1),Z.h6b(!0,dc)):(Z.h6b(!1,dc),Jc.eZ(!0));return;case 2:Jc.FAc?(Jc.eZ(!1),Z.CS(0,!0)):(Z.h6b(!1,dc),Jc.eZ(!0));return;case 3:Ka=Jc.FAc;Jc.eZ(!Ka);Z.h6b(Ka,dc);return}Jc.eZ(!1);Z.CS(0,!0)}else Ka===zb?(Z.CS(Ka,!1),2===dc?Z.h6b(!0,dc):Jc.eZ(!0)):(Z.CS(Ka,!1),Z.CS(Ka+1,!0))}MWm(Z,Ka,zb,dc){const Jc=Z.KE;if(0<Ka)Z.CS(Ka,!1),Z.CS(Ka-1,!0);else if(-1===
Ka){switch(dc){case 1:Jc.FAc?(Jc.eZ(!1),Z.h6b(!0,dc)):Z.PDl()?(Z.VRg(!1),Jc.eZ(!0)):(Z.h6b(!1,dc),Z.VRg(!0));return;case 2:Jc.FAc?(Jc.eZ(!1),Z.h6b(!0,dc)):(Z.h6b(!1,dc),Z.CS(zb,!0));return;case 3:Ka=Jc.FAc;Jc.eZ(!Ka);Z.h6b(Ka,dc);return}Jc.FAc&&(Jc.eZ(!1),Z.CS(zb,!0))}else Z.CS(0,!1),Jc.eZ(!0)}wmn(Z,Ka,zb){if(Ka){var dc=Ka.KE;if(Z===sb.a.Dbd||Z===sb.a.Fbd||Z===sb.a.kOc||Z===sb.a.jOc)Z=Ka.P6m(zb),dc.eZ(Z),Ka.iNn(!Z,zb)}}MNl(Z){return Sys.UI.DomElement.containsCssClass(Z,Zf.arh)||Sys.UI.DomElement.containsCssClass(Z,
Zf.hIe)}lpl(Z){return Z.className.startsWith(Zf.rpl)}OWm(Z,Ka){var zb=document.activeElement;zb&&(Sys.UI.DomElement.containsCssClass(zb,Zf.hIe)?(zb=parseInt(zb.getAttribute(Zf.ONl).toString())+1,Z?zb!==Ki.Jsg?Ka.ane(zb+1):Ka.ane(1):1!==zb?Ka.ane(zb-1):Ka.ane(Ki.Jsg)):Z?Ka.ane(1):Ka.ane(Ki.Jsg))}NWm(Z,Ka){var zb=document.activeElement;if(zb){for(var dc=af.bGm,Jc=0;!Sys.UI.DomElement.containsCssClass(zb,dc[Jc]);)if(Jc++,Jc===dc.length){Jc=-1;break}var jd=document.querySelectorAll("."+Zf.O6c).length;
dc[Jc]!==Zf.O6c?Z?Jc!==dc.length-1&&-1!==Jc?dc[Jc+1]!==Zf.O6c?this.nDe(dc[Jc+1],Ka):Ka.cwh(0):this.nDe(dc[0],Ka):Jc&&-1!==Jc?dc[Jc-1]!==Zf.O6c?this.nDe(dc[Jc-1],Ka):Ka.cwh(jd-1):this.nDe(dc[dc.length-1],Ka):(zb=parseInt(zb.getAttribute(Ki.N6c).toString()),Z?zb!==jd-1?Ka.cwh(zb+1):this.nDe(dc[Jc+1],Ka):zb?Ka.cwh(zb-1):this.nDe(dc[Jc-1],Ka))}}nDe(Z,Ka){switch(Z){case Zf.VCd:Ka.HLn();break;case Zf.oBe:Ka.GLn();break;case Zf.Zsf:Ka.ELn();break;case Zf.etf:Ka.FLn()}}eLf(Z,Ka){if(this.la.QQf&&this.aD.KE.isVisible){if(Ka&&
(Z===sb.a.EDa||Z===sb.a.mKb)){this.Vd.NXa=C.a.empty;Ka=this.va.presentation;const zb=this.Mb.Fd(7,void 0,void 0,void 0,!0);try{zb.rc(Ka),this.la.Pnl&&(zb.sc=Z),Ka.removeProperty(Yb.a.ZYa)}finally{zb&&zb.dispose()}}this.FI.wWn(this.aD.uAb());Ka=rb.a("AddMoreDesignerLogsEnabled");rb.a("FixSessionRehydrationIssueForDesigner")?this.la.aui&&(Z!==sb.a.EDa&&Z!==sb.a.mKb||(Z==sb.a.EDa||Z==sb.a.mKb)&&!this.Vd.yya)&&(Ka&&D.a.J(507642455,829,50,"DesignerActor::handleUndoRedoAction actionId {0}, isSuggestionApplied {1}",
Z,this.Vd.yya),this.ia.Cb(sb.a.weh,2)):this.la.aui&&Z!==sb.a.EDa&&Z!==sb.a.mKb&&(Ka&&D.a.J(507642454,829,50,"DesignerActor::handleUndoRedoAction actionId {0}",Z),this.ia.Cb(sb.a.weh,2))}}u1b(Z,Ka){this.eLf(Ka.rzh,Ka.bab)}S3m(Z){return this.Vd.nFe(Z)}Lqj(Z){switch(Z){case Oh.a.wvd:case Oh.a.zvd:case Oh.a.Zfb:case Oh.a.yvd:case Oh.a.Avd:case Oh.a.Adf:case Oh.a.SXa:case Oh.a.Cdf:case Oh.a.Ddf:case Oh.a.Edf:case Oh.a.Fdf:case Oh.a.Cvd:case Oh.a.Evd:case Oh.a.backspace:case Oh.a.Mva:case Oh.a.mF:case Oh.a.aJa:case Oh.a.enter:case Oh.a.QA:case Oh.a.Mz:return!0;
default:return!1}}sBl(Z){switch(Z){case Oh.a.Wja:case sb.a.zye:case sb.a.addSlideTitle:case sb.a.X4c:case sb.a.o$b:case sb.a.Bja:case sb.a.JZ:case sb.a.FDa:case sb.a.ica:case sb.a.GDa:case sb.a.jsa:case sb.a.tSa:case sb.a.pzb:case sb.a.p$b:case sb.a.bringForward:case sb.a.bringToFront:case sb.a.gYa:case sb.a.apc:case sb.a.Xze:case sb.a.bpc:case sb.a.IDa:case sb.a.B9a:case sb.a.Vch:case sb.a.C9a:case sb.a.iG:case sb.a.Mv:case sb.a.xma:case sb.a.iYa:case sb.a.kjf:case sb.a.rIa:case sb.a.r6c:case sb.a.tsa:case sb.a.Nrc:case sb.a.fNb:case sb.a.Orc:case sb.a.deleteComment:case sb.a.UC:case sb.a.oF:case sb.a.MDd:case sb.a.sca:case sb.a.huc:case sb.a.NOb:case sb.a.IFd:case sb.a.HFd:case sb.a.v7c:case sb.a.Nyf:case sb.a.POb:case sb.a.l$:case sb.a.Cac:case sb.a.T8c:case sb.a.zAb:case sb.a.c9c:case sb.a.jEe:case sb.a.kEe:case sb.a.i9c:case sb.a.j9c:case sb.a.Ojh:case sb.a.Aye:case sb.a.gbc:case sb.a.insertOnlinePicture:case sb.a.sEa:case sb.a.pEe:case sb.a.insertPicture:case sb.a.tEa:case sb.a.MAb:case sb.a.NAb:case sb.a.Xja:case sb.a.f9c:case sb.a.Z8d:case sb.a.pka:case sb.a.bdc:case sb.a.a2b:case sb.a.cdc:case sb.a.eJe:case sb.a.fCb:case sb.a.hUa:case sb.a.hbb:case sb.a.ncd:case sb.a.ddc:case sb.a.dJe:case sb.a.jfd:case sb.a.$bb:case sb.a.BDb:case sb.a.ADb:case sb.a.CDb:case sb.a.iUa:case sb.a.vRc:case sb.a.vde:case sb.a.Ish:case sb.a.qCb:case sb.a.q5a:case sb.a.mdc:case sb.a.A2b:case sb.a.nW:case sb.a.ska:case sb.a.q5a:case sb.a.jdc:case sb.a.rCb:case sb.a.mergeTableCells:case sb.a.Gzc:case sb.a.t7:case sb.a.Kta:case sb.a.Jta:case sb.a.qda:case sb.a.Lta:case sb.a.bBe:case sb.a.aBe:case sb.a.uCb:case sb.a.tCb:case sb.a.sCb:case sb.a.Fcd:case sb.a.MJe:case sb.a.ndc:case sb.a.h2:case sb.a.o$d:case sb.a.HAa:case sb.a.Drb:case sb.a.oF:case sb.a.Tth:case sb.a.oLe:case sb.a.Bdd:case sb.a.Gje:case sb.a.RCb:case sb.a.SCb:case sb.a.xka:case sb.a.Ske:case sb.a.Udd:case sb.a.Ibb:case sb.a.dDb:case sb.a.eDb:case sb.a.Zdd:case sb.a.Ydd:case sb.a.iFa:case sb.a.gMe:case sb.a.hMe:case sb.a.sendBackward:case sb.a.sendToBack:case sb.a.setAsSlideTitle:case sb.a.vec:case sb.a.QMe:case sb.a.pne:case sb.a.qne:case sb.a.wed:case sb.a.xed:case sb.a.wec:case sb.a.ywh:case sb.a.nDb:case sb.a.hk:case sb.a.Qvb:case sb.a.oDb:case sb.a.Vbb:case sb.a.Fwh:case sb.a.Ged:case sb.a.DS:case sb.a.sW:case sb.a.ape:case sb.a.POe:case sb.a.ROe:case sb.a.TOe:case sb.a.aPe:case sb.a.zFa:case sb.a.cPe:case sb.a.dPe:case sb.a.gPe:case sb.a.EDa:case sb.a.mKb:case sb.a.jOc:case sb.a.b$d:case sb.a.Dbd:case sb.a.kOc:case sb.a.d$d:case sb.a.Fbd:case sb.a.c$d:case sb.a.Ebd:case sb.a.qeh:case sb.a.Ipa:case sb.a.TBa:case sb.a.hec:return!0;
default:return!1}}isEnabled(){return this.la.QQf}U3m(){return 0<this.Y0f}ddh(){return this.Y0f}zPl(Z,Ka){Z=Ka.slideId;D.a.J(512496520,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",Z.sid);if((Ka=this.va.Ga)&&Ka.Xb.equals(Z)){Ka="unopened";this.aD.KE.isVisible&&(this.aD.KE.isVisible&&this.JMe(this.aD,5),Ka="set to SameSlideCoauthNoSuggestion UI");let zb="unopened";this.aD.KE.isVisible&&(this.GOc(this.Vd.correlationId,fk.a.wOc),zb="closed");"unopened"===Ka&&
"unopened"===zb||D.a.J(512496519,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",Ka,zb,Z.sid,Z.cid,this.Vd.correlationId,this.kCj,this.Y0f)}}QRl(Z,Ka){D.a.J(512496518,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.la.QQf,
this.kCj,this.Y0f,Ka.correlationId,Ka.trigger);if(this.isEnabled()){if(Z=this.va.Ga)if(Ka.slideId.equals(Z.Xb))if(this.S3m(Ka.correlationId))D.a.J(512496515,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",Ka.correlationId);else if(this.DZn(Ka.correlationId))D.a.J(512496514,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",
Ka.correlationId);else{this.Vd.correlationId!==Ka.correlationId&&(this.Vd.Sdl(Ka.correlationId,this.la.Rzb&&Ka.trigger===Xg.a.moreIdeas),D.a.J(512496513,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Vd.correlationId,Ka.correlationId));if(this.Vd.correlationId===Ka.correlationId&&this.aD.KE.isVisible&&3===this.aD.KE.nyb)if(this.la.PSa&&sd.a.any(Ka.dfd.toArray(),zb=>0<=this.Vd.NBb.indexOf(zb)))this.Vd.Ctg=
new Date,D.a.J(512496512,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",Ka.correlationId,Ka.dfd.toString(),this.Vd.NBb.toString());else if(Z=Ka.Gec,!this.la.PSa||this.Vd.T$b.contains(Z)){D.a.J(512496483,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",Ka.correlationId,Z.toString());return}Z=Sg.Tti(Ka.Uhb);
this.eJn(Z,Ka);this.FXm(Ka);this.EXm(this.aD,Ka,Z,Ka.ura,sd.a.rb(this.Vd.B5c)?Ka.ura:this.Vd.B5c.length)}else D.a.J(512496516,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",Ka.correlationId)}else D.a.J(512496517,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",Ka.correlationId)}eJn(Z,Ka){if(Z&&Ka.trigger!==Xg.a.moreIdeas){this.Vd.suggestions||(this.Vd.suggestions=Object.assign(new Qk,
{CardData:Z.CardData,SlideSuggestions:Array(Ka.sNf?Ka.ura:Ka.FUa)}));if(!sd.a.rb(Z.SlideSuggestions))for(const zb of Z.SlideSuggestions)this.Vd.suggestions.SlideSuggestions[zb.Index]=zb;this.Vd.B5c||(this.Vd.B5c=Sg.fun(Z))}}EXm(Z,Ka,zb,dc,Jc){D.a.J(512496482,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",Ka.correlationId,Ka.trigger,Ka.ura,dc);if(Ka.trigger===Xg.a.moreIdeas){this.Vd.xDb||(this.Vd.xDb=new Date);var jd=Z.XCe();this.FI.RGn(zb,
Z.uAb(),Ka.correlationId,Z.sac())||(this.FI.djh(Z.uAb()),jd=Z.XCe()-1);Z.CS(jd,!0);this.JMe(Z,8)}else if(!dc)!this.la.OAe||Ka.trigger!==Xg.a.vOe&&Ka.trigger!==Xg.a.xse?this.JMe(Z,2):this.JMe(Z,9),this.aD.KE.isVisible?this.GOc(this.Vd.correlationId,fk.a.wOc):this.pKn(Bi.a.noSuggestion);else if(this.MOn(Ka.trigger,Z.KE)){var Ed=!0;if(this.la.PSa){Ed=null;var de=Z.uAb();de&&(Ed=de.querySelector("#"+Z.KE.id+" ."+Sg.soc+'[correlationId="'+Ka.correlationId+'"]'));Ed=!Ed;D.a.J(512496481,829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",
Ka.correlationId,Ka.trigger,Ed);de=new mf(Ka,Ed);this.Ad.OWl(de)}if(Ed){this.JMe(Z,3);this.Vd.xDb||(this.Vd.xDb=new Date);try{this.la.OUl&&this.ucc.execute(Ne=>{Ne.logActivity("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(Ne){D.a.J(512496480,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",Ne)}}dc=new Sd(zb,dc,Jc,Ka.correlationId,Z.uAb(),Ed,Z.sac(),this.FI.Cjh(Ka.trigger));this.FI.fqk(dc);this.Vd.eQf&&this.la.getBooleanAppSetting("ChatPPTHideImg")&&
this.MHn();this.Vd.eQf&&this.la.getBooleanAppSetting("ChatPPTImgAutoApplyDesigner")&&"InsertPicture"===Ka.trigger&&(rb.a("DesignerChatPPTApplyOnFirstRender")?Ed&&0<(null===(jd=null===zb||void 0===zb?void 0:zb.SlideSuggestions)||void 0===jd?void 0:jd.length)?Z.EDa(zb.SlideSuggestions[0].SlideId.Sid,zb.SlideSuggestions[0].SlideId.Cid):D.a.J(509089808,829,Ed?10:50,"DesignerManager::HandleSuggestionUpdate: not able to get suggestion to apply"):(Ka=Z.uAb().querySelector("."+Sg.soc),null!=Ka&&Z.usm(Ka.childNodes[0])))}}MHn(){const Z=
this.va.Ga;if(Z){var Ka=Z.AX(zb=>0!==zb.ofd);Ka&&Ka.length&&(Ka.forEach(zb=>{zb.ofd=0}),Ka=new H.a(2,1,this.la.Jc("ChatPPTUnhideUpdateMs",2E3),()=>{Z.f8(this.xb.Oa,252,!0)},void 0,"ResetTempHiddenShapeTask"),this.Tb.Qb(Ka))}}FXm(Z){Z.sNf?(sd.a.rb(this.Vd.suggestions.SlideSuggestions)||this.Vd.suggestions.SlideSuggestions.length===Z.ura)&&this.GOc(Z.correlationId,fk.a.success,this.Vd.suggestions,Z.trigger):this.GOc(Z.correlationId,fk.a.success,this.Vd.suggestions,Z.trigger)}MOn(Z,Ka){return Ka.isVisible||
Z!==Xg.a.HAa&&Z!==Xg.a.Sch&&Z!==Xg.a.apc}Hxh(Z,Ka){this.Y0f=Z;this.kCj=Ka;this.Ad.WH(new nf.a(1))}kSl(){this.aD.KE.isVisible&&3===this.aD.KE.nyb&&(this.mJl.add(this.Vd.correlationId),this.aD.Aed(1))}DZn(Z){return this.mJl.contains(Z)}GOc(Z,Ka,zb,dc){zb=void 0===zb?null:zb;dc=void 0===dc?"":dc;D.a.J(512496479,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",Z,Ka,dc);this.lad.execute(Jc=>{const jd=this.Rzm(Z,zb);Va.a.rb(dc)||(jd.trigger=dc);Jc.notifySlideSuggestion(Ka,
jd)})}Rzm(Z,Ka){const zb=new Ia;zb.correlationId=Z;if(!Ka)return D.a.J(512496478,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",Z),zb;zb.suggestions=this.FI.xun(Ka);return zb}jsn(Z){Z=new Sd(this.Vd.suggestions,Z.suggestions.length,Z.suggestions.length,Z.correlationId,this.aD.uAb(),!0,this.aD.sac(),this.FI.Cjh(Z.trigger));this.FI.fqk(Z);this.Ma.lm(Fa.a.Uma,!0)}Xtn(){return 4===this.aD.KE.nyb}Vtn(){return 1===this.aD.KE.nyb}}Object(c.a)(Mf,
"DesignerManager",null,[1322,24]);var Mg=a(336);class Sf{constructor(Z,Ka){this.g6d=this.y2a=null;this.ten=Ka;this.Qi=Z;this.zN=!1}get Er(){return this.zN}setup(){this.Er||(this.g6d=Kb.a.hg(),this.g6d.setAttribute("Unselectable","on"),this.g6d.style.position=kc.a.absolute,this.Qi.addCssClass(this.g6d,"designerPreviewImageContainer"),this.y2a=new Mg.a,this.zN=!0)}dispose(){this.Er&&(this.dismiss(),this.y2a&&this.y2a.ta.parentNode&&(this.y2a.fr(),this.Qi.removeCssClass(this.y2a.ta,"designerPreviewImageContainer")))}dismiss(){this.Er?
(this.N4b(),this.y2a.setVisibility(!1)):D.a.J(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")}setImage(Z){if(this.Er){this.g6d&&(this.g6d.appendChild(this.y2a.ta),this.Qi.addCssClass(this.y2a.ta,"designerPreviewImageContainer"),this.y2a.setVisibility(!1));var Ka=this.ten.Yc;if(Z=this.BMb(Z))this.N4b(),Ka.xNe.appendChild(this.g6d),this.y2a.ta.appendChild(Z),this.y2a.setVisibility(!0);this.y2a.mh(Ka.rr.clientWidth,Ka.rr.clientHeight)}else D.a.J(38099037,829,15,"DesignerPreviewImageView::SetImage - called before setup")}BMb(Z){if(!Va.a.rb(Z)){const Ka=
Kb.a.uJ();Ka.setAttribute("Unselectable","on");Ka.src=Z;Ka.style.height="100%";Ka.style.width="100%";return Ka}return null}N4b(){this.y2a.ta.firstChild&&this.y2a.ta.removeChild(this.y2a.ta.firstChild)}}Object(c.a)(Sf,"DesignerPreviewImageView",null,[1323]);var Kf=a(337);class fh{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg){this.nta=null;this.SMc=0;this.ia=Z;this.Mb=Ka;this.ob=zb;this.va=dc;this.xb=Jc;this.la=jd;this.qm=Ed;this.Uv=de;this.uc=Ne;this.OTa=Re;this.Tb=Cf;this.ee=yg;this.tZb=lk.ready}Hb(){this.ia.sa(sb.a.fixIt,
Na.a.application,Object(e.a)(this,this.pWm,"handleFixIt"),4);this.ia.sa(sb.a.TKe,Na.a.application,Object(e.a)(this,this.ZWm,"handleQueryFixIt"),96);this.ia.sa(sb.a.X4c,Na.a.application,Object(e.a)(this,this.X4c,"applyFixItSuggestion"),4);this.ia.sa(sb.a.hVc,Na.a.application,Object(e.a)(this,this.hVc,"reportFixItSessionInfo"),64);this.OTa.Std(Object(e.a)(this,this.HOa,"onBlockingStateChanged"))}dispose(){this.OTa.vLe(Object(e.a)(this,this.HOa,"onBlockingStateChanged"))}pWm(Z,Ka,zb){Ka=this.ob.ud();
if(2>Ka.length)return 8;if(1===zb)return 32;zb=this.va.presentation;this.la.Pzb?this.uc.ggb(zb,this.va.Ga,this.xb.Oa,Z):this.uc.vx(zb,Z);this.Uv.nkh=!0;const dc=[];Ka.forEach(Jc=>{Array.add(dc,Jc.get_shapeId())});Z={};Z.SelectedShapeIds=dc.join(",");this.Uv.Yvb=dc;this.o2i(Z);this.Uv.bse=window.setTimeout(()=>{this.qWm(this.Uv.correlationId)},this.la.cFi);return 32}qWm(Z){this.Uv.P9c=!0;D.a.J(507843603,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",Z);this.ia.Qa(sb.a.hVc,2,Bi.a.jyh);
this.ee.jJa(nh.a.wi(170),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}o2i(Z,Ka){Ka=void 0===Ka?null:Ka;this.DHm(zb=>{if(this.la.fsc){if(this.tZb.oDl&&+new Date-+this.tZb.KEl<this.la.EBd){this.nta=new Jk;this.nta.sid=zb.sid;this.nta.cid=zb.cid;this.nta.mjh=zb.Ina;return}this.tZb=lk.e8;this.nta=null}const dc=()=>{this.o2i(this.nta.mjh,Ka)};this.qm.fAb(zb.cid,zb.sid,zb.correlationId,null,Pf.a.fixIt,Ka,Yi.c(zb.Ina),Jc=>{Jc&&Jc.Status===Pf.a.prk?this.avh(()=>
{this.o2i(zb.Ina,Ka)}):this.SMc=0;this.SMc||this.aLf(dc)},Jc=>this.fce(Jc,dc))},void 0===Z?null:Z)}avh(Z){this.SMc<this.la.DBd?this.Tb.Qb(new H.a(2,1,1E3,()=>{D.a.J(507843602,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Uv.correlationId);this.tZb=lk.ready;this.SMc++;Z()},void 0,"RetryRequestOnWait")):D.a.J(507843601,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Uv.correlationId)}X4c(Z,Ka,zb,dc,Jc){Ka=this.va.presentation;
if(!this.va.Ga||!Ka)return 16;dc=null;Object(Ei.a)(oj,Jc)&&(dc=Jc);if(!dc)return 8;if(1===zb)return 32;zb=this.Mb.qe(15);try{this.la.x6c&&(this.Uv.$4c=new Date),zb.rc(Ka),zb.sc=Z,Ka.ZYa=dc,this.Uv.NXa=C.a.Yq(dc.SuggestionSid,dc.SuggestionCid),this.Uv.yya=!0,D.a.J(507843600,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",dc.CorrelationId,Z,dc.SuggestionSid)}finally{zb&&zb.dispose()}return 32}DHm(Z,Ka){Ka=void 0===Ka?null:Ka;const zb=this.va.Ga;zb&&
zb.sid&&(Ka=Object.assign(new Pk,{sid:zb.sid,cid:zb.cid,Ina:Ka||{}}),D.a.J(507843599,829,50,"FixIt; sid: {0}; correlationId: {1}",Ka.sid,Ka.correlationId),this.Uv.correlationId&&this.gme(Bi.a.wVc),this.Uv.efd=new Date,this.Uv.correlationId=Ka.correlationId,this.Uv.RDa=new Date,Z(Ka))}aLf(Z){this.la.fsc&&(this.tZb=lk.ready,this.nta&&Z())}fce(Z,Ka){this.aLf(Ka);D.a.J(507843598,829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",Z.HttpStatusCode);return!0}ZWm(Z,
Ka,zb,dc,Jc){this.nVn();if(!Object(Ei.a)(nl.a,Jc))return 8;if(1<this.ob.iDb()){let jd;(jd=this.Uv).Nze=jd.Nze+1;return 32}return 8}hVc(Z,Ka,zb,dc,Jc){if(Jc===Bi.a.noSuggestion||Jc===Bi.a.jyh)this.la.Pzb?this.uc.Vec(Kf.e(this.va.Ga,this.xb.Oa)):this.uc.mD(this.va.presentation);this.gme(Jc);return 32}HOa(Z,Ka){if(this.Uv.nkh){Z=this.uc.Cd(this.va.presentation);const zb=this.la.Pzb?"UnblockContentWhenDraw":"SessionRehydrated";Z||Object(v.a)(String,Ka.actionName)!==zb||(window.clearTimeout(this.Uv.bse),
this.Uv.P9c||(this.Uv.cfd=new Date),this.Uv.$4c=null,this.Uv.nkh=!1)}}gme(Z){const Ka=this.Uv.correlationId;if(Va.a.rb(Ka))D.a.J(507843597,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",Z);else{var zb={};this.Uv.NXa&&(zb.SuggestionSlideId=this.Uv.NXa.sid.toString(),zb.SuggestionSlideCreationId=this.Uv.NXa.cid.toString());zb.AppliedSuggestion=this.Uv.yya;zb.DisplaySuggestionsTimeoutInMs=this.la.cFi;zb.SuggestionsTimeout=this.Uv.P9c;zb.ClientAbort=this.Uv.EEe;
zb.ResetReason=Z;zb.DesignerSendTraceRequestOnSessionEnded=this.la.veh;var dc=Eb.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString()),Jc={};Jc.ClientOS=dc.Os;Jc.Browser=dc.Browser||"";Jc.BrowserVersion=dc.BrowserVersion||"";Jc.BrowserMajorVersion=dc.BrowserMajorVersion||"";Jc.BrowserMinorVersion=dc.BrowserMinorVersion||"";this.Uv.efd&&this.Uv.PNe&&this.Uv.PNe>this.Uv.efd&&(Jc.SuggestionsE2ETimeMs=+this.Uv.PNe-+this.Uv.efd);this.Uv.efd&&this.Uv.cfd&&this.Uv.cfd>this.Uv.efd&&(Jc.SuggestionAppliedE2ETimeMs=
+this.Uv.cfd-+this.Uv.efd);zb.BrowserData=Jc;this.Uv.RDa&&this.Uv.cfd&&this.Uv.cfd>this.Uv.RDa&&(zb.TimeToDisplaySuggestionsInMs=+this.Uv.cfd-+this.Uv.RDa);this.Uv.hRk&&(zb.TimeSuggestionsRendered=this.Uv.hRk.toUTCString());this.qm.Fbb(Ka,Yi.c(zb),Z===Bi.a.Nvh);this.Uv.Nrk();D.a.J(507843596,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",Z,Ka)}}nVn(){try{const Z=l.a.instance.Na("Common.ISystemInitiatedFeedback");Z&&
Z.execute(Ka=>{Ka.logActivity("AutoFixInViewportActivity",null)})}catch(Z){D.a.J(507843595,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",Z)}}M6(){}K6(){}}Object(c.a)(fh,"FixItActor",null,[85]);class xh{constructor(){this.Nze=0;this.correlationId=this.Yvb=null;this.bse=0;this.EEe=this.nkh=this.yya=this.P9c=!1;this.suggestion=this.RDa=this.cfd=this.$4c=this.PNe=this.efd=this.hRk=null;this.NXa=C.a.empty}Nrk(){this.Nze=0;this.correlationId=this.Yvb=null;this.NXa=
C.a.empty;this.bse=0;this.EEe=this.nkh=this.yya=this.P9c=!1;this.RDa=this.cfd=this.$4c=this.PNe=this.efd=this.hRk=null}}Object(c.a)(xh,"FixItContext",null,[1327]);var Qg=a(1210),th=a(1518),Hh=a(1180),Fg=a(1201);class Ij{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re){this.ia=Z;this.va=Ka;this.Mb=zb;this.Ad=dc;this.Uv=Jc;this.ih=jd;this.xcc=Ed;this.VL=de;this.od=Ne;this.ee=Re;this.Jz()}Jz(){this.xcc.Fye(Object(e.a)(this,this.Zca,"onEvent"));this.ih.aS(Object(e.a)(this,this.Zca,"onEvent"));this.od.i9a(Object(e.a)(this,
this.Zca,"onEvent"));this.od.VG(Object(e.a)(this,this.Zca,"onEvent"));this.Ad.Fel(Object(e.a)(this,this.PRl,"onSuggestionReceived"));this.Ad.taf(Object(e.a)(this,this.u1b,"onUndoRedo"))}dispose(){this.Ad.RYl(Object(e.a)(this,this.PRl,"onSuggestionReceived"));this.Ad.JKg(Object(e.a)(this,this.u1b,"onUndoRedo"))}PRl(Z,Ka){if(Z=this.va.Ga)if(Ka.slideId.equals(Z.Xb))if(this.Uv.correlationId!==Ka.correlationId)D.a.J(508134790,829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",
this.Uv.correlationId,Ka.correlationId);else if(Z=Ij.Tti(Ka.Uhb),Z.SlideSuggestion)this.Uv.PNe||(this.Uv.PNe=new Date),Ka=Object.assign(new oj,{SuggestionCid:Z.SlideSuggestion.SlideId.Cid,SuggestionSid:Z.SlideSuggestion.SlideId.Sid,CorrelationId:Ka.correlationId,ActiveSlideCid:Object(v.a)(32,this.va.Ga).cid,ActiveSlideSid:Object(v.a)(32,this.va.Ga).sid}),this.ia.Qa(sb.a.X4c,2,Ka);else switch(this.ia.Qa(sb.a.hVc,2,Bi.a.noSuggestion),Z.ResponseDescription){case "Invalid request":this.ee.jJa(nh.a.wi(122),
0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest);break;case "No suggestion":rb.a("DisableErrorDialogueForNoSuggestionInAutoFix")||this.ee.jJa(nh.a.wi(132),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItNoSuggestion);break;default:this.ee.jJa(nh.a.wi(134),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}else D.a.J(508134791,829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",
Ka.correlationId)}Qja(Z){this.Uv.correlationId&&Z!==sb.a.X4c&&this.ia.Qa(sb.a.hVc,2,Bi.a.EPe+this.VL.Mia(Z))}eLf(Z,Ka,zb){if(this.Uv.correlationId&&zb&&Ka===sb.a.X4c){this.Uv.NXa=C.a.empty;zb=this.va.presentation;const dc=this.Mb.Fd(7,void 0,void 0,void 0,!0);try{dc.rc(zb),dc.sc=Ka,zb.removeProperty(Yb.a.ZYa)}finally{dc&&dc.dispose()}this.ia.Qa(sb.a.hVc,2,Bi.a.EPe+this.VL.Mia(Z))}}u1b(Z,Ka){this.eLf(Ka.actionId,Ka.rzh,Ka.bab)}Zca(Z,Ka){Z=!1;let zb="";if(Object(Ei.a)(Qg.a,Ka)){D.a.J(508134789,829,
50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",this.Uv.correlationId,wk.a[Object(v.a)(Qg.a,Ka).aI]);if(1===Object(v.a)(Qg.a,Ka).aI||3===Object(v.a)(Qg.a,Ka).aI)Z=!0;zb=Bi.a.Nvh}else Object(Ei.a)(th.a,Ka)?(D.a.J(508134788,829,50,"FixItManager::OnSessionRehydrated"),Z=!0,zb=Bi.a.bFn):Object(Ei.a)(Hh.a,Ka)?(Z=!0,zb=Bi.a.slideNavigation):Object(Ei.a)(Fg.a,Ka)&&Object(v.a)(Fg.a,Ka).t9c&&this.Qja(Object(v.a)(Fg.a,Ka).actionId);Z&&this.Uv.correlationId&&this.ia.Qa(sb.a.hVc,2,zb);this.K$m()}K$m(){0<
this.Uv.Nze&&(D.a.J(508134787,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",this.Uv.Nze),this.Uv.Nze=0)}static Tti(Z){let Ka=null;try{Ka=Eb.a(Z)}catch(zb){D.a.J(508134786,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}return Ka}}Object(c.a)(Ij,"FixItManager",null,[1326,24]);var ej=a(1151),Yj=a(126),Qe;(function(Z){Z[Z.seen=0]="seen";Z[Z.keep=1]="keep";Z[Z.drillIn=2]="drillIn"})(Qe||(Qe={}));Object(c.b)("IdeasCardAction",Qe);var ef;(function(Z){Z[Z.designer=
0]="designer";Z[Z.makeItVisual=1]="makeItVisual";Z[Z.editor=2]="editor";Z[Z.UNKNOWN=3]="UNKNOWN"})(ef||(ef={}));Object(c.b)("IdeasCardType",ef);class Ig{constructor(Z,Ka){this.Rbc=null;this.Cdg=!1;this.ia=Z;this.la=Ka;this.ia.za(sb.a.ideasPaneOpened,Na.a.application,Object(e.a)(this,this.xWm,"handleIdeasPaneOpen"));this.ia.za(sb.a.vjh,Na.a.application,Object(e.a)(this,this.wWm,"handleIdeasPaneClose"));this.ia.za(sb.a.D9i,Na.a.application,Object(e.a)(this,this.lyl,"handleIdeasKeep"));this.ia.za(sb.a.E9i,
Na.a.application,Object(e.a)(this,this.B2i,"handleIdeasSee"));this.ia.za(sb.a.J9i,Na.a.application,Object(e.a)(this,this.B2i,"handleIdeasSee"));this.ia.za(sb.a.K9i,Na.a.application,Object(e.a)(this,this.A2i,"handleIdeasDrillIn"));this.ia.za(sb.a.H9i,Na.a.application,Object(e.a)(this,this.lyl,"handleIdeasKeep"));this.ia.za(sb.a.I9i,Na.a.application,Object(e.a)(this,this.B2i,"handleIdeasSee"));this.ia.za(sb.a.F9i,Na.a.application,Object(e.a)(this,this.A2i,"handleIdeasDrillIn"));this.ia.za(sb.a.G9i,
Na.a.application,Object(e.a)(this,this.A2i,"handleIdeasDrillIn"))}xWm(){if(!this.la.xCb)return 2;this.Cdg=!0;this.a4m()||this.kSn(Di.a.create());return 32}wWm(){if(!this.la.xCb)return 2;this.Cdg=!1;return 32}lyl(Z){if(!this.la.xCb)return 2;this.TUn(this.nui(Z));return 32}B2i(Z){if(!this.la.xCb)return 2;this.Ryh(this.nui(Z));return 32}A2i(Z){if(!this.la.xCb)return 2;this.SUn(this.nui(Z));return 32}nui(Z){switch(Z){case sb.a.D9i:case sb.a.E9i:case sb.a.F9i:Z=0;break;case sb.a.J9i:case sb.a.K9i:Z=1;
break;case sb.a.H9i:case sb.a.I9i:case sb.a.G9i:Z=2;break;default:Z=3}return Z}kSn(){this.la.xCb&&(this.Rbc=new ej.a)}Ryh(Z){this.la.xCb&&this.Cdg&&3!==Z&&this.Rbc&&!this.Rbc.any(Ka=>Ka.key===Z)&&this.Rbc.add(new Yj.a(Z,0))}TUn(Z){this.Cdg&&3!==Z&&this.Rbc&&this.Rbc.add(new Yj.a(Z,1))}SUn(Z){this.Cdg&&3!==Z&&this.Rbc&&this.Rbc.add(new Yj.a(Z,2))}a4m(){return!!this.Rbc&&0<this.Rbc.length}}Object(c.a)(Ig,"IdeasContext",null,[1325]);class Wg{constructor(){this.ix=this.hx=null;this.Ez=this.Tv=0}}Object(c.a)(Wg,
"ImageLocationInfo",null,[]);var Vh=a(698);class zi{}Object(c.a)(zi,"ImageToTableRequest",null,[]);class di{}di.zAl="ImageToTableTile";di.xAl="ImageToTable.Request";di.yAl="ImageToTable.Response";Object(c.a)(di,"ImateToTableAugmentationSchemaNames",null,[]);class ph{constructor(){this.Aha=this.Dga=null}get rN(){return"ImageToTableALWorkflow"}get proto(){return""}get Ync(){this.Dga||(this.Dga=Object.assign(new Vh.a,{name:"LambdaBefore_ImageToTableAL",inputSchema:di.zAl,outputSchema:di.xAl,func:Object(e.a)(this,
this.fUb,"lambdaBeforeFunc")}));return this.Dga}get enc(){return null}get EUc(){this.Aha||(this.Aha=Object.assign(new Vh.a,{name:"LambdaRemote_ImageToTableAL",inputSchema:di.xAl,outputSchema:di.yAl,func:null}));return this.Aha}fUb(Z,Ka,zb){Z=Object.assign(new zi,{image:Z.image});zb(Z)}}Object(c.a)(ph,"ImageToTableALWorkflow",null,[1361]);class ki{constructor(){this.html=this.processId=this.errorDescription=null;this.errorCode=this.shapeId=this.slideId=0}}Object(c.a)(ki,"ImageToTableALv2ResponseWrapper",
null,[]);class Yh{constructor(){this.sessionId=null;this.shapeId=this.slideSid=0;this.image=this.hYf=null}}Object(c.a)(Yh,"ImageToTableTile",null,[]);class Xh{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf){this.ia=Z;this.ob=Ka;this.uc=zb;this.zi=dc;this.az=Jc;this.Ub=Ed;this.Qk=de;this.BBj=Ne;this.NWb=Re;this.la=Cf}initialize(){this.ia.za(sb.a.Jsh,Na.a.application,Object(e.a)(this,this.byl,"handleConvertImageToTable"));this.ia.za(sb.a.Psh,Na.a.application,Object(e.a)(this,this.Cyl,"handleReplaceImageWithHtmlTable"));
this.zi.aS(Object(e.a)(this,this.yR,"onActiveSlideChanged"));this.BBj.execute(Z=>{const Ka=new ph;Z.registerSimpleRemoteWorkflow(Ka.rN,Ka.Ync,Ka.EUc,Ka.enc);Z.addEventHandler(di.yAl,Object(e.a)(this,this.zWm,"handleImageToTableALResults"));Z.e0("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");Z.GBa("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",Object(e.a)(this,this.Fna,"handleAnnotationEvent"))})}dispose(){this.ia.h_(sb.a.Jsh,Na.a.application,Object(e.a)(this,this.byl,"handleConvertImageToTable"));
this.ia.h_(sb.a.Psh,Na.a.application,Object(e.a)(this,this.Cyl,"handleReplaceImageWithHtmlTable"));this.zi.Dia(Object(e.a)(this,this.yR,"onActiveSlideChanged"))}yR(){this.NWb.close()}byl(Z,Ka,zb){if(!this.la.wKe)return 16;if(1===zb)return 32;Z=this.ob.ud();if(1!==Z.length)return 8;const dc=this.NWb.otn();if(!dc)return D.a.J(512496449,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),8;const Jc=Z[0];this.la.Uak&&(this.NWb.uLn(dc,Jc.slideSid,Jc.get_shapeId(),Xh.woi(Jc)),
this.NWb.DPl(dc));this.BBj.execute(jd=>{jd.UYn(Jc.slideCid,Jc.slideSid,Jc.get_shapeId(),Ed=>{this.myl(dc,Jc,Ed)},()=>{this.myl(dc,Jc,null);return!0})});return 32}Fna(Z){if(Z&&"errorDescription"in Z&&"parentPath"in Z&&"errorCode"in Z){var Ka=new ki,zb=Z.errorDescription.split(";");Ka.errorDescription=zb[0].split(":")[1];Ka.processId=zb[1].split(":")[1];Ka.errorCode=Z.errorCode;D.a.J(512496448,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",Ka.processId,
Ka.errorCode,Ka.errorDescription);zb=Z.parentPath[1].split("|");Ka.slideId=Number.parseInvariant(zb[0]);Ka.shapeId=Number.parseInvariant(zb[2]);Ka.html=Z.html;this.NWb.sLn(Ka);this.NWb.CPl()}}myl(Z,Ka,zb){if(zb&&zb.ImgData)if(this.la.Uak)this.NWb.tLn(Z,zb.ImgData),this.NWb.CPl();else{const dc=Xh.woi(Ka),Jc=Object.assign(new Yh,{sessionId:Z,slideSid:Ka.slideSid,shapeId:Ka.get_shapeId(),hYf:dc,image:zb.ImgData});this.BBj.execute(jd=>{jd.submit(di.zAl,Jc)});this.NWb.DPl(Z)}else this.NWb.mqn(Z)}zWm(Z,
Ka,zb,dc){D.a.J(512496419,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",dc.processId,dc.errorCode,dc.errorDescription);this.NWb.Xon(Ka,dc)}Cyl(Z,Ka,zb,dc,Jc){Z=this.Ub.XZ(Jc.slideSid);if(!Z)return 8;zb=(Ka=Z.WZ(Jc.shapeId))?Xh.woi(Ka):Jc.hYf;if(!zb)return 8;D.a.J(512496418,829,50,"Replacing image with html table. Shape id: {0}",Ka.get_shapeId());Jc=this.Qk.DAe(!1,Z.cid,Z.sid,0,!1,zb.hx,zb.ix,zb.Tv,zb.Ez,Z.Ju()+1,Jc.W6l,"");this.az.WM([Jc],Z,0,null,
Ka);this.uc.vx(Z,"ImageToTable");return 32}static woi(Z){return Object.assign(new Wg,{hx:Z.hx,ix:Z.ix,Tv:Z.Tv,Ez:Z.Ez})}}Object(c.a)(Xh,"ImageToTableActor",null,[]);class Li{constructor(Z){this.shapeId=this.slideId=0;this.f$i=null;this.N1k=0;this.G7i=!1;this.wAg=null;this.Skh=!1;this.wjh=this.xjh=this.TOl=this.uSl=null;this.sessionId=Z}}Object(c.a)(Li,"ImageToTableConversionContext",null,[]);class ij{constructor(){this.shapeId=this.slideSid=0;this.W6l=this.hYf=null}}Object(c.a)(ij,"ReplaceImageWithHtmlTableData",
null,[]);class Nk{constructor(Z,Ka,zb,dc){this.ia=Z;this.Hd=Ka;this.Aa=zb;this.LJj=dc;this.gob=null}initialize(){this.Hd.execute(Z=>{Z.maf(Object(e.a)(this,this.XPl,"onFirstPartyAddInHidden"))});this.LJj.E0h(Object(e.a)(this,this.syl,"handleMessage"))}dispose(){this.Hd.execute(Z=>{Z.cGn(Object(e.a)(this,this.XPl,"onFirstPartyAddInHidden"))});this.LJj.HYl(Object(e.a)(this,this.syl,"handleMessage"))}otn(){this.close();const Z=new Li(Di.a.create().toString());Z.uSl=new Promise(zb=>{Z.TOl=()=>{zb(Z.sessionId)}});
const Ka={};Ka.JB=ResourceStrings.L_DataFromPicturePaneTitle;Ka.assetId="FA000000050";Ka.LU=()=>{this.eQc(Z)};Ka.nonPersistedSettings={["SessionID"]:Z.sessionId};Ka.sourceLocationOverrideResourceId=this.Aa.nKe;return 32===this.ia.Qa(sb.a.mFa,2,Ka)?(this.gob=Z,this.gob.sessionId):this.gob=null}close(){this.Kgi(this.gob)}eQc(Z){D.a.J(509208392,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",Z.sessionId);const Ka=this.Hd.instance.xT("FA000000050");if(Ka&&Ka.settings&&"SessionID"in Ka.settings){var zb;
let dc=Eb.d(Ka.settings.SessionID);({BD:zb}=dc);dc.returnValue&&(Z.sessionId===zb?(Z.wAg=Ka.Kp,D.a.J(509208391,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",Ka.Kp)):D.a.J(509208390,375,50,"[ImageToTablePane] Failed to find the taskpane"))}}Kgi(Z){Z&&Z.wAg&&(Z.Skh=!0,this.ia.Qa(sb.a.JLb,2,Z.wAg))}uLn(Z,Ka,zb,dc){if(Z=this.WGd(Z))Z.slideId=Ka,Z.shapeId=zb,Z.f$i=dc}uAk(Z){if(Z=this.WGd(Z))Z.xjh=void 0}sLn(Z){const Ka=this.gob;Ka&&Ka.slideId===Z.slideId&&Ka.shapeId===Z.shapeId&&(this.gob.wjh=
Z)}tLn(Z,Ka){if(Z=this.WGd(Z))Z.xjh=Ka}DPl(Z){const Ka=this.WGd(Z);Ka&&(Ka.N1k=window.setTimeout(()=>{this.cWm(Ka)},this.Aa.lKe))}Xon(Z,Ka){if(Z&&Ka){var zb=this.WGd(Z.sessionId);if(zb&&!zb.G7i)if(zb.slideId=Z.slideSid,zb.shapeId=Z.shapeId,zb.f$i=Z.hYf,window.clearTimeout(zb.N1k),0===Ka.errorCode){const dc={};dc.tableHtml=Ka.html;dc.imageData=Z.image;this.sendMessage(zb.sessionId,dc)}else this.Evh(Z.sessionId,"Failed to convert image to table")}}CPl(){const Z=this.gob;if(Z&&!Z.G7i&&Z.wjh&&Z.xjh)if(window.clearTimeout(Z.N1k),
0===Z.wjh.errorCode){const Ka={};Ka.tableHtml=Z.wjh.html;Ka.imageData=Z.xjh;this.sendMessage(Z.sessionId,Ka)}else this.Evh(Z.sessionId,"Failed to convert image to table")}mqn(Z){this.Evh(Z,"Failed to render the image shape")}cWm(Z){Z.G7i=!0;this.Evh(Z.sessionId,"Failed to convert image to table using AL")}syl(Z,Ka){Ka=Ka.message;(Z=this.WGd(Ka.session_id))&&!Z.Skh&&("ACK"===Ka.cmd_type?(D.a.J(509208389,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",Ka.cmd_type),Z.TOl()):
"cancel"===Ka.cmd_type?(D.a.J(509208388,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",Ka.cmd_type),this.Kgi(Z)):"insert_html"===Ka.cmd_type?(D.a.J(509208387,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",Ka.cmd_type),Ka=Object.assign(new ij,{slideSid:Z.slideId,shapeId:Z.shapeId,hYf:Z.f$i,W6l:Ka.parameters}),this.Kgi(Z),this.ia.Qa(sb.a.Psh,2,Ka)):D.a.J(509208386,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",
Ka.cmd_type))}Evh(Z,Ka){this.sendMessage(Z,{["errorMessage"]:Ka})}sendMessage(Z,Ka){const zb=this.WGd(Z);zb&&zb.sessionId===Z&&zb.uSl.then(()=>{this.LJj.sendMessage(zb.wAg,Ka)})}WGd(Z){return Z&&this.gob&&this.gob.sessionId===Z?this.gob:null}XPl(Z,Ka){Ka&&this.gob&&Ka.Kp===this.gob.wAg&&(this.gob=null)}}Object(c.a)(Nk,"ImageToTablePane",null,[1329]);class xk extends Sys.EventArgs{constructor(Z){super();this.message=Z}}Object(c.a)(xk,"ImageToTablePaneMessageReceivedArgs",Sys.EventArgs,[]);class ui{constructor(Z){this.ua=
new Ad.a;this.Aa=Z}E0h(Z){this.ua.addHandler("ImageToDocPaneMessageReceived",Z)}HYl(Z){this.ua.removeHandler("ImageToDocPaneMessageReceived",Z)}initialize(){try{window.addEventListener?window.addEventListener("message",Object(e.a)(this,this.ntg,"messageReceivedHandler"),!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",Object(e.a)(this,this.ntg,"messageReceivedHandler")):D.a.J(507843165,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(Z){D.a.J(507843164,
375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",Z.message,Z.stack)}}sendMessage(Z,Ka){const zb={["imageToTablePaneWildcard"]:"."};for(const dc of Object.keys(Ka))zb[dc]=Ka[dc];OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Z,"onCustomMessage",zb,dc=>{dc&&D.a.J(507843163,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",dc)})}ntg(Z){if(Z&&this.wTd(Z.origin)){let Ka=Eb.d(Z.data);({BD:Z}=Ka);
Ka.returnValue&&Z&&"."===Z.imageToTablePaneWildcard&&this.ua.raiseEvent("ImageToDocPaneMessageReceived",new xk(Z))}}wTd(Z){return Z&&Z.length&&"null"!==Z?Z===this.Aa.mKe:!1}}Object(c.a)(ui,"ImageToTablePaneMessenger",null,[1328]);var pj=a(1255);class wj{constructor(){this.Scenario=0;this.ShapeIds=null;this.SlideSid=this.SlideCid=0}}Object(c.a)(wj,"ImageTransformInfo",null,[]);class ok{constructor(Z,Ka,zb,dc){this.ia=Z;this.ob=Ka;this.va=zb;this.Ad=dc}initialize(){this.Ad.lel(Object(e.a)(this,this.ORl,
"onSuggestedActionClick"))}dispose(){this.Ad.DYl(Object(e.a)(this,this.ORl,"onSuggestedActionClick"))}ORl(Z,Ka){if((Z=Ka.card)&&this.va.Ga){var zb=this.va.Ga.xj(),dc=[];Ka=[];for(var Jc of zb)for(const jd of Z.Selects)if(jd.Id===Jc.get_shapeId()){Array.add(dc,Jc);Array.add(Ka,Jc.get_shapeId());break}this.ob.Rw();this.ob.Ti();this.ob.zka(dc,!0);if(4===Z.Type){if(Jc=this.va.presentation)Jc.IAb=Object.assign(new wj,{Scenario:Z.Scenario,SlideSid:this.va.Ga.sid,SlideCid:this.va.Ga.cid,ShapeIds:Ka})}else this.ia.Cb(pj.a.Mwd(Z.ExecutionActionName),
2)}}}Object(c.a)(ok,"SuggestedActionsHandler",null,[]);class Lj{constructor(){this.$=null;this.Tca=!1}get name(){return"PowerPointWebEditor.Designer"}lc(Z){this.$=Z;this.$.register(1319,"PowerPointWebEditor.IDesignerView").ma().na(()=>new af(this.$.resolve("Box4.IHtmlViewRootFactory"),this.$.resolve("PowerPoint.IPathManager"),this.$.resolve("PowerPointWebEditor.IDesignerPane"),this.$.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.$.resolve("PowerPointWebEditor.IDesignerContext"),this.$.resolve("Box4.IViewManager"),
this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("Common.IClickInputManager"),this.$.resolve("Common.IPointerInputManager"),this.$.resolve("PowerPointWebEditor.IInputHandlerManager"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.$.register(1320,"PowerPointWebEditor.IDesignerPane").ma().na(()=>
new Nd(this.$.resolve("Box4.IAppFrame"),this.$.resolve("PowerPoint.IPathManager"),this.$.resolve("Common.IClickInputManager"),this.$.resolve("PowerPointWebEditor.IInputHandlerManager"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IDesignerContext"),this.$.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.$.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.IInboundHelper"),this.$.resolve("PowerPointWebEditor.ITaskPaneManager")));this.$.register(1321,"PowerPointWebEditor.IDesignerViewHelper").ma().na(()=>new Sg(this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.IDesignerContext"),
this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPoint.IPathManager"),this.$.Na("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")));this.$.register(1322,"PowerPointWebEditor.IDesignerManager").ma().na(()=>new Mf(this.$.resolve("PowerPointWebEditor.IDesignerView"),this.$.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.$.resolve("PowerPointWebEditor.IDesignerContext"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("Common.IActionManagerExtended"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("Common.ITaskManager"),this.$.Na("PowerPointWebEditor.IDesignerServiceProvider"),this.$.Na("PowerPointWebEditor.IApplyDesignerSuggestions"),this.$.Na("Common.ISystemInitiatedFeedback")));this.$.register(1323,
"PowerPointWebEditor.Designer.IDesignerPreviewImageView").ma().na(()=>new Sf(this.$.resolve("PowerPoint.IBrowserHelperManager"),this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager")));this.$.register(1324,"PowerPointWebEditor.IDesignerContext").ma().na(()=>new Il(this.$.Na("PowerPointWebEditor.IDesignerServiceProvider")));this.$.register(1325,"PowerPointWebEditor.Infrared.IIdeasContext").ma().na(()=>new Ig(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IApplicationSettings")));
this.$.register(1326,"PowerPointWebEditor.IFixItManager").ma().na(()=>new Ij(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.IFixItContext"),this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.$.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.$.resolve("PowerPointWebEditor.IActionNameResolver"),
this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("PowerPointWebEditor.IErrorHandler")));this.$.register(1327,"PowerPointWebEditor.IFixItContext").ma().na(()=>new xh);(this.Tca=this.$.resolve("PowerPointWebEditor.IApplicationContext").Md.Rh)&&this.$.register(Sj.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>new Sj.a(h.AFrameworkApplication.ye,this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),
this.$.resolve("PowerPointWebEditor.IErrorHandler"),this.$.resolve("Common.ITaskManager"),this.$.resolve("Common.IAppSettingsManager")));this.$.register(Xh,"PowerPointWebEditor.Designer.ImageToTableActor").ma().na(()=>new Xh(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.$.resolve("PowerPointWebEditor.IGraphTransactionHelper"),
this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("PowerPointWebEditor.IShapeEditor"),this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.$.resolve("PowerPointWebEditor.Designer.IImageToTablePane"),this.$.resolve("PowerPointWebEditor.IApplicationSettings")));this.$.register(1328,"PowerPointWebEditor.Designer.IImageToTablePaneMessenger").ma().na(()=>new ui(this.$.resolve("PowerPointWebEditor.IApplicationSettings")));
this.$.register(1329,"PowerPointWebEditor.Designer.IImageToTablePane").ma().na(()=>new Nk(this.$.resolve("Common.IActionManagerExtended"),this.$.Na("PowerPointWebEditor.IAppForOfficeManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger")));this.$.register(ok,"PowerPointWebEditor.Designer.SuggestedActionsHandler").ma().na(()=>new ok(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource")))}init(){const Z=this.$.resolve("Common.IAppSettingsManager");Z.fg(()=>{if(Z.getBooleanAppSetting(id.a.xfe)){this.Tca&&this.$.resolve("PowerPointWebEditor.PodsInfoSender");var Ka=this.$.resolve("PowerPointWebEditor.IDesignerView");const zb=l.a.instance.resolve("PowerPointWebEditor.IDesignerPane").ta;Ka.aIa(zb);Ka.VNd();Ka=null;if(Z.getBooleanAppSetting(id.a.BBd)&&(Ka=this.$.resolve("Common.App.OAuth.IOAuthManager"))){const dc=
new Date;Ka.qN(Z.La(id.a.lfe),Z.La(id.a.FBd)).then(Jc=>{const jd=+new Date-+dc;Jc.IsSuccess?D.a.J(512262863,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+jd):(D.a.J(512262862,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+Jc.ErrorCode+": "+Jc.ErrorMessage),D.a.J(512262861,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+jd))}).catch(Jc=>{D.a.J(512262860,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+
(+new Date-+dc));D.a.J(512262859,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",Jc)})}Ka=new Cl(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Box4.IClipboardDataHelper"),this.$.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.$.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("PowerPointWebEditor.IDesignerPane"),
this.$.resolve("PowerPointWebEditor.IDesignerView"),this.$.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.$.resolve("PowerPointWebEditor.IDesignerManager"),this.$.resolve("PowerPointWebEditor.IDesignerContext"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),
this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.$.resolve("PowerpointPresence.IPresenceEventHandlers"),this.$.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.$.resolve("PowerPointWebEditor.Infrared.IIdeasContext"),this.$.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.$.Na("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),Ka,this.$.Na("PowerPointWebEditor.IAgendaMetrics"),this.$.Na("PowerPointWebEditor.AgendaConverter.IAgendaConverterView"),this.$.resolve("PowerPointWebEditor.ICopilotEnableStateChecker"));Ka.Hb();Ka.ve();(new fh(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.$.resolve("PowerPointWebEditor.IFixItContext"),this.$.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.$.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPointWebEditor.IErrorHandler"))).Hb();
this.$.resolve("PowerPointWebEditor.IApplicationSettings").CBd&&this.$.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").setup();this.$.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger").initialize();this.$.resolve("PowerPointWebEditor.Designer.IImageToTablePane").initialize();this.$.resolve("PowerPointWebEditor.Designer.ImageToTableActor").initialize();this.$.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").initialize();this.$.resolve("PowerPointWebEditor.IFixItManager")}else D.a.J(512262858,
829,50,"Designer setting is disabled")})}dispose(){this.$.resolve("PowerPointWebEditor.IApplicationSettings").CBd&&this.$.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").dispose();this.$.resolve("PowerPointWebEditor.Designer.IImageToTablePane").dispose();this.$.resolve("PowerPointWebEditor.Designer.ImageToTableActor").dispose();this.$.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").dispose();this.$.resolve("PowerPointWebEditor.IFixItManager").dispose()}static main(){b.a.instance.Fc(Ea.a(new Lj,
0))}}Object(c.a)(Lj,"PPTWebEditorDesignerPackage",null,[3,4]);class Tj{constructor(){this.$=null}get name(){return"PowerPointWebEditor.PenMinutes"}lc(Z){this.$=Z}init(){const Z=this.$.yb("Common.App.PenMinutesManager.IPenMinutesManager");Z&&Z.AMn()}dispose(){}static main(){b.a.instance.Fc(new Tj)}}Object(c.a)(Tj,"PPTWebEditorPenMinutesPackage",null,[3,4]);var rk=a(1350);class Kk{}Object(c.a)(Kk,"TextToSmartArtSuggestionData",null,[]);class ol{constructor(){this.suggestions=[]}}Object(c.a)(ol,"TextToSmartArtSuggestionNotificationData",
null,[]);class pi{}pi.wEk="ShapePresence";pi.slideNavigation="SlideNavigation";pi.EPe="WebActionId:";pi.G8="SelectionChanged";pi.NSg="ShapePositionChanged";pi.wVc="Retrigger";pi.VWj="NoSuggestions";pi.van="LowSuggestions";pi.rrh="NewSession";pi.eRn="SlideShowStarted";pi.Kqa="ServerError";pi.jkl="ClientSuggestionTimeOut";Object(c.a)(pi,"ReplaceObjectResetReason",null,[]);class Uj{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah,Ui,$g,oh,Jh,ti){this.yad=this.AGj=this.n1d=!1;this.pa=Z;this.Ma=Ka;
this.va=zb;this.uc=dc;this.OTa=Jc;this.ih=jd;this.ia=Ed;this.E3=de;this.FKc=Ne;this.G3=Re;this.xcc=yg;this.$Yb=bh;this.tph=Ah;this.Ad=Ui;this.VL=$g;this.Tb=oh;this.Db=Jh;this.sS=Cf;this.lad=ti;this.zN=!1}get Er(){return this.zN}setup(){this.Er||(this.Jz(),this.AGj=2===this.Db.mode,this.zN=!0)}Jz(){this.pa.QM(Object(e.a)(this,this.QH,"onSelectionChanged"));this.xcc.Fye(Object(e.a)(this,this.DSj,"markedUndo"));this.ih.aS(Object(e.a)(this,this.yR,"onActiveSlideChanged"));this.$Yb.f$b(Object(e.a)(this,
this.vta,"onSlidePresenceChanged"));this.Ad.Tel(Object(e.a)(this,this.e1j,"onReplaceObjectResponse"));this.FKc.xqm(Object(e.a)(this,this.f1j,"onReplaceObjectViewDragEnd"));this.OTa.Std(Object(e.a)(this,this.HYj,"onApplyReplaceObjectBlockingStateChanged"));this.ih.jaf(Object(e.a)(this,this.I2g,"updateEditState"));this.Db.PM(Object(e.a)(this,this.Av,"onAppFrameModeSwitched"));this.Ad.K0h(Object(e.a)(this,this.jPl,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval"));this.Ad.J0h(Object(e.a)(this,
this.iPl,"onApplyReplaceObjectSuggestionAfterSelectionRemoval"));this.Ad.taf(Object(e.a)(this,this.u1b,"onUndoRedo"))}dispose(){this.Er&&(this.pa.Bbb(Object(e.a)(this,this.QH,"onSelectionChanged")),this.xcc.nuh(Object(e.a)(this,this.DSj,"markedUndo")),this.ih.Dia(Object(e.a)(this,this.yR,"onActiveSlideChanged")),this.$Yb.SKg(Object(e.a)(this,this.vta,"onSlidePresenceChanged")),this.Ad.cZl(Object(e.a)(this,this.e1j,"onReplaceObjectResponse")),this.FKc.kGn(Object(e.a)(this,this.f1j,"onReplaceObjectViewDragEnd")),
this.OTa.vLe(Object(e.a)(this,this.HYj,"onApplyReplaceObjectBlockingStateChanged")),this.Db.R3(Object(e.a)(this,this.Av,"onAppFrameModeSwitched")),this.ih.CKg(Object(e.a)(this,this.I2g,"updateEditState")),this.Ad.Eok(Object(e.a)(this,this.jPl,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval")),this.Ad.Dok(Object(e.a)(this,this.iPl,"onApplyReplaceObjectSuggestionAfterSelectionRemoval")),this.Ad.JKg(Object(e.a)(this,this.u1b,"onUndoRedo")),this.zN=!1)}Hed(Z){return this.lij()?this.tph.z5g(Z):!1}selectShape(Z){Z&&
this.pa.selectShape(Z,!1)}Gkh(Z){switch(Z){case sb.a.o$b:case sb.a.O9d:case sb.a.YNc:case sb.a.ZNc:case sb.a.$Nc:case sb.a.aOc:case sb.a.Ipa:return!0;default:return!1}}lij(){return this.n1d&&this.AGj}hTl(Z,Ka){const zb=[];if(Va.a.rb(Z))return zb;Z=Z.split(";");if(Z.length<Ka)return D.a.J(507843422,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",Ka,Z.length),zb;for(let dc=0;dc<Ka;++dc){const Jc=Z[dc].split(":");if(3!==Jc.length)throw Ka=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",
dc,Z[dc]),D.a.J(507843421,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",Ka),Error.create(Ka);const jd=rk.a.exl(Number.parseInvariant(Jc[1]));Array.add(zb,Object.assign(new Kk,{index:Jc[0],labelText:Va.a.rb(jd)?ResourceStrings.L_SmartArt:jd,imageData:this.zhh(Jc[2])}))}return zb}jPl(){this.yad=!0}iPl(){this.yad=!1}u1b(Z,Ka){this.Qja(Ka.actionId)}zhh(Z){return Va.a.rb(Z)?null:"data:image/png;base64,"+Z}Av(Z){D.a.J(507843420,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",
Z.mode);this.AGj=2===Z.mode}I2g(){this.n1d||D.a.J(507843419,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");this.n1d=!0}yIe(Z,Ka,zb,dc){this.lad.execute(Jc=>{const jd=Object.assign(new ol,{correlationId:Z,shapeId:Ka,suggestions:zb});Jc.notifyTextToSmartArtSuggestion(dc,jd)})}Dyl(Z,Ka,zb){if(Ka.Jca)if(Ka.qmb&&0!==Z.Dub)D.a.J(507843417,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",Z.Dub);else{if(0===Z.Dub){if(0>=
Z.ETa){D.a.J(507843416,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",Z.correlationId);this.closeSession(Ka,pi.VWj);return}if(Z.ETa<zb.QLe){D.a.J(507843415,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",Z.correlationId);this.closeSession(Ka,pi.van);return}Ka.qmb=!1;Ka.suggestions=this.hTl(Z.Uhb,Z.ETa);Ka.suggestionCount=Z.ETa;D.a.J(507843414,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",Ka.suggestionCount,
Z.correlationId)}else if(1===Z.Dub){if(Va.a.rb(Z.Uhb)){D.a.J(507843413,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",Z.correlationId);return}Ka.suggestions=this.hTl(Z.Uhb,Z.ETa);Ka.nOe=new Date;zb.fPa&&this.yIe(Z.correlationId,Ka.shapeId,Ka.suggestions,fk.a.success)}else 2===Z.Dub&&(Ka.vrj=!1,Ka.shapeId=Z.shapeId,this.yIe(Ka.correlationId,Z.shapeId,Ka.suggestions,fk.a.success));zb=Ka.shape;Ka.slide&&Ka.slide.isConnected&&zb&&zb.isConnected&&this.sS.ACc(zb)&&this.lij()&&
(1===Z.Dub?this.G3.GXl(Ka.correlationId):this.G3.txh(zb))}else D.a.J(507843418,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",Z.correlationId)}}Object(c.a)(Uj,"BaseReplaceObjectManager",null,[1318,1349]);class sk{}sk.none="";sk.NSg="ShapePositionChanged";Object(c.a)(sk,"ReplaceObjectRetriggerReason",null,[]);class $i{}$i.selectShape="SelectShape";$i.wVc="Retrigger";$i.jtm="AugLoopRetrigger";$i.htm="AugLoopDefault";Object(c.a)($i,"ReplaceObjectTrigger",null,[]);
var Dl=a(690);class El extends Uj{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah,Ui,$g,oh,Jh,ti,Mj,Yl,em,Wh){super(de,zb,dc,Jc,jd,Ed,Ne,Re,Cf,yg,bh,Ui,$g,oh,Jh,Mj,Yl,em,Wh);this.Mya=Z;this.Dmh=Ka;this.Qdn=Ah;this.la=ti;this.kLl=this.la.PLe}Jz(){this.la.bVc?this.Dmh.execute(Z=>{Z.addEventHandler("ShapeTextConvertable",Object(e.a)(this,this.eWl,"processShapeTextConvertibleClientAL"))}):this.Mya.execute(Z=>{Z.addEventHandler("ShapeTextConvertable",Object(e.a)(this,this.kdk,"processShapeTextConvertible"))});
this.Ad.xfl(Object(e.a)(this,this.ash,"onSlideShowStarted"));super.Jz()}dispose(){this.Er&&(this.la.bVc?this.Dmh.execute(Z=>{Z.removeEventHandler("ShapeTextConvertable",Object(e.a)(this,this.eWl,"processShapeTextConvertibleClientAL"))}):this.Mya.execute(Z=>{Z.removeEventHandler("ShapeTextConvertable",Object(e.a)(this,this.kdk,"processShapeTextConvertible"))}),this.Ad.yZl(Object(e.a)(this,this.ash,"onSlideShowStarted")));super.dispose()}kdk(Z,Ka){if(Z&&Ka){try{var zb=Eb.a(Z);var dc=Eb.a(Ka)}catch(jd){D.a.J(508692432,
829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");return}if(zb&&!isNaN(zb.sid)&&!isNaN(zb.cid)&&!isNaN(zb.shapeId)&&this.va.Ga&&(Z=new Date(zb.c),D.a.J(508692431,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",zb.sid,zb.cid,zb.shapeId,zb.t,zb.c?(new Date).getTime()-zb.c:-1),(Ka=this.va.Ga.WZ(zb.shapeId))&&(sd.a.contains(this.uwl(),Ka.get_shapeId())||"activeSlideChanged"===zb.t)))if(dc&&!dc.isTextConvertible)this.G3.O4b(Ka,
!0);else{var Jc=this.E3.WFf(Ka.get_shapeId());if(Jc&&Jc.Vzb&&(Jc=new Dl.a(Ka,Jc.FDb),this.ia.Qa(sb.a.ubb,2,Jc),!Jc.$xa))return;this.Hed(Ka)&&this.fAb(this.va.Ga,Ka,dc&&dc.smartArtInfo?dc.smartArtInfo.length:0,zb.t||$i.htm,sk.none,Z)}}}eWl(Z,Ka,zb,dc){Ka&&dc&&dc.ContextId&&dc.Payload&&this.kdk(dc.ContextId,dc.Payload)}ash(){this.Cgi(pi.eRn)}QH(Z,Ka){if(!this.Er)D.a.J(508692430,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.yad&&(Ka.RH.length||
!this.Ma.currentScope||this.Ma.currentScope.name!==Fa.a.kh)){Z=this.uwl();for(const zb of this.E3)zb.Jca&&!Array.contains(Z,zb.shapeId)&&this.closeSession(zb,pi.G8);this.kLl&&!Array.contains(Z,this.G3.kDe)&&this.G3.zFn()}}f1j(Z,Ka){this.Er?(Z=this.E3.WFf(Ka.shape.get_shapeId()))&&Z.Jca&&(Ka=Z.shape,this.closeSession(Z,pi.NSg),this.Hed(Ka)&&this.fAb(this.va.Ga,Ka,0,$i.jtm,sk.NSg)):D.a.J(508692429,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}DSj(Z,
Ka){Ka.t9c&&this.Qja(Ka.actionId)}yR(){this.Cgi(pi.slideNavigation)}vta(Z,Ka){if(Ka.Psa&&Ka.shapes)for(const zb of Ka.shapes)(Z=this.E3.WFf(zb))&&Z.Jca&&this.closeSession(Z,pi.wEk)}e1j(Z,Ka){(Z=this.E3.KJd(Ka.correlationId))?this.Dyl(Ka,Z,this.la):D.a.J(508692428,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",Ka.correlationId)}HYj(){if(this.Er)for(const Z of this.E3)Z.ZRd&&0===Z.suggestionType&&!this.uc.Cd(this.va.presentation)&&
(Z.ZRd=!1,this.G3.O4b(Z.shape,!0))}Hed(Z){const Ka=this.E3.Gdl;return 1<=Ka?(D.a.J(508692427,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",Ka),!1):super.Hed(Z)}fAb(Z,Ka,zb,dc,Jc,jd){jd=void 0===jd?null:jd;try{let Ed=this.E3.WFf(Ka.get_shapeId());Ed&&this.closeSession(Ed,pi.rrh);Ed=this.E3.Wdh(Z,Ka.get_shapeId(),dc,Jc,this.la);Ed.TZg=jd;Ed.Vzb="richEditTextUnicodeChanged"===dc;this.G3.x2g(Ed.correlationId);const de=this.Qdn.F1l(Ed);
D.a.J(508692426,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",Ed.correlationId,Ed.slide.sid,Ed.slide.cid,Ed.shapeId,de);D.a.J(508692425,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",Ed.correlationId,zb,Math.min(zb,this.la.lke),dc);zb&&this.la.RLe&&(zb=Math.min(zb,
this.la.lke),Ed.suggestions=this.WKm(zb),Ed.suggestionCount=zb,Ed.qmb=!1,this.G3.txh(Ka));0===de&&this.la.fPa&&this.yIe(Ed.correlationId,Ed.shapeId,[],fk.a.pending)}catch(Ed){D.a.J(508692424,829,10,"GenerateSuggestion failed!! {0} ",Ed.message)}}WKm(Z){const Ka=Array(Z);for(let zb=0;zb<Z;zb++)Array.add(Ka,Object.assign(new Kk,{index:zb.toString(),labelText:ResourceStrings.l_Loading,imageData:null}));return Ka}Qja(Z){this.Er?this.Gkh(Z)||this.Cgi(pi.EPe+this.VL.Mia(Z)):D.a.J(508692423,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")}nOn(Z){if(!this.kLl)return!1;
const Ka=this.pa.ud();return Z.Vzb&&Array.contains(Ka,Z.shape)}closeSession(Z,Ka){0===Z.suggestionType&&(Ka===pi.VWj?this.G3.O4b(Z.shape,!0):Z.Vzb&&this.G3.O4b(Z.shape,!0,Ka!==pi.rrh,this.nOn(Z)),this.E3.Zjh(Z,Ka),this.la.fPa&&this.yIe(Z.correlationId,Z.shapeId,Z.suggestions,fk.a.wOc))}Cgi(Z){for(const Ka of this.E3)this.closeSession(Ka,Z)}uwl(){const Z=this.pa.ud(),Ka=[];Z&&Z.forEach(zb=>{Array.add(Ka,zb.get_shapeId())});return Ka}}Object(c.a)(El,"AugmentationLoopReplaceObjectManager",Uj,[]);class Rl{constructor(Z,
Ka){this.disabled=!1;this.YJl=Lf.App.ep;this.la=Z;this.Tb=Ka}j2l(Z){this.disabled=!0;this.YJl=new Date;const Ka=new H.a(2,1,this.la.jke,()=>{this.disabled&&+new Date-+this.YJl>=this.la.jke&&Z()});this.Tb.Qb(Ka)}aMn(Z){const Ka=new H.a(2,1,550,()=>{Z()});this.Tb.Qb(Ka)}static gZn(Z,Ka){return 7<=Z&&8>=Z&&1!==Ka}}Object(c.a)(Rl,"FlyoutAnchorTimer",null,[]);var mk=a(692);class al{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah,Ui){this.EP=null;this.yad=!1;this.Ad=Ka;this.pa=Z;this.E3=zb;this.va=
dc;this.Ia=Jc;this.la=jd;this.G3=Ed;this.qm=de;this.sS=Ne;this.$Yb=Re;this.OTa=Cf;this.u2a=yg;this.Zqg=bh;this.VL=Ah;this.fc=Ui}Jz(){this.Ad.Jel(Object(e.a)(this,this.hQl,"onIconSuggestionNotification"));this.pa.QM(Object(e.a)(this,this.QH,"onSelectionChanged"));this.Ad.K0h(Object(e.a)(this,this.hPl,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Ad.J0h(Object(e.a)(this,this.gPl,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Ad.Iel(Object(e.a)(this,this.gQl,"onIconChanged"));
this.$Yb.f$b(Object(e.a)(this,this.vta,"onSlidePresenceChanged"));this.OTa.Std(Object(e.a)(this,this.HOa,"onBlockingStateChanged"));this.Zqg.Fye(Object(e.a)(this,this.ube,"onMarkedUndo"))}xVk(){this.Ad.UYl(Object(e.a)(this,this.hQl,"onIconSuggestionNotification"));this.pa.Bbb(Object(e.a)(this,this.QH,"onSelectionChanged"));this.Ad.Eok(Object(e.a)(this,this.hPl,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Ad.Dok(Object(e.a)(this,this.gPl,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));
this.Ad.TYl(Object(e.a)(this,this.gQl,"onIconChanged"));this.$Yb.SKg(Object(e.a)(this,this.vta,"onSlidePresenceChanged"));this.OTa.vLe(Object(e.a)(this,this.HOa,"onBlockingStateChanged"));this.Zqg.nuh(Object(e.a)(this,this.ube,"onMarkedUndo"))}dispose(){this.xVk()}setup(){this.Jz()}hPl(){this.yad=!0}gPl(){this.yad=!1}gQl(Z,Ka){Ka&&this.EP&&this.EP.bPg&&this.EP.slide.sid===Ka.slideId.sid&&this.EP.slide.cid===Ka.slideId.cid&&this.EP.shapeId===Ka.shapeId&&this.EP.v7a===Ka.q7&&(this.EP.ywk=Ka.iconName)}vta(Z,
Ka){if(Ka.Psa&&Ka.shapes&&this.EP)for(const zb of Ka.shapes)this.EP.shapeId===zb&&this.ESa(pi.wEk)}ube(Z,Ka){Ka.t9c&&!this.Gkh(Ka.actionId)&&this.ESa(pi.EPe+this.VL.Mia(Ka.actionId))}Gkh(Z){switch(Z){case sb.a.o$b:case sb.a.O9d:case sb.a.YNc:case sb.a.ZNc:case sb.a.$Nc:case sb.a.aOc:case sb.a.Ipa:return!0;default:return!1}}HOa(){if(this.EP){const Z=this.EP.shape,Ka=this.Ia.ev(Z);Z&&Ka&&!this.u2a.Cd(Ka)&&(this.EP.ZRd=!1,this.G3.O4b(Z,!0),this.EP.RZg=new Date,this.EP.ESa(pi.G8))}}QH(){if(!this.yad){var Z=
this.Ia.hKa(this.pa.ud());if(Z){if(this.EP&&this.EP.Jca){if(mk.a.ZMe(Z.sQa,this.EP.sQa))return;this.ESa(pi.G8)}this.Hed(Z)&&this.fAb(this.va.Ga,Z,$i.selectShape)}else this.EP&&this.EP.Jca&&this.ESa(pi.G8)}}fAb(Z,Ka,zb){this.EP=this.E3.g6c(Z,Ka.get_shapeId(),zb,"",this.la,Ka.get_smartArtModelId());this.EP.qmb=!0;this.G3.x2g(this.EP.correlationId);D.a.J(507843340,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.EP.correlationId,
this.EP.slide.sid,this.EP.slide.cid,this.EP.shapeId,this.EP.v7a);const dc=Ka.get_smartArtModelId()?this.Ia.ev(Ka):Ka;dc?this.qm.ftl(Z.cid,Z.sid,dc.get_shapeId(),this.sS.fih(dc),this.sS.eih(dc),Ka.get_smartArtModelId(),74,74,this.EP.correlationId,zb,Object(e.a)(this,this.kqn,"onIconSuggestionResponseSuccess"),Object(e.a)(this,this.fce,"onTaskFailure")):D.a.J(507843339,829,15,"Parent ShapeNode of a {0} is null",Ka.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")}kqn(Z){if(Z&&Z.SuggestionResult){var Ka=
Z.CorrelationId,zb=this.E3.KJd(Ka);if(zb)if(zb.Jca){Ka=null;try{Ka=Sys.Serialization.JavaScriptSerializer.deserialize(Z.SuggestionResult)}catch(dc){D.a.J(507843335,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",dc)}if(Ka){zb.suggestions=this.nun(Ka);zb.nOe=new Date;if(zb.qmb){if(this.TBl(zb)){D.a.J(507843333,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",zb.yjf,this.la.Mcd);this.ESa(pi.jkl);
return}D.a.J(507843332,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");zb.suggestionCount=zb.suggestions?zb.suggestions.length:0;zb.qmb=!1;this.G3.txh(zb.shape)}this.G3.GXl(zb.correlationId)}else this.ESa(pi.Kqa),D.a.J(507843334,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else D.a.J(507843336,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",
this.EP?this.EP.correlationId:"",Ka);else D.a.J(507843337,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",Ka)}else this.ESa(pi.Kqa),D.a.J(507843338,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")}fce(Z){this.ESa(pi.Kqa);D.a.J(507843331,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",
Z.HttpStatusCode);return!0}Hed(Z){return this.fc.Mp?Z.get_smartArtModelId()&&Z.get_isSVGBlipFilled()?(Z=this.Ia.ev(Z),!!Z&&!Z.xF):!1:!1}ESa(Z){this.EP&&(this.G3.O4b(this.EP.shape,!0),this.E3.Zjh(this.EP,Z),this.EP=null)}zhh(Z){return Va.a.rb(Z)?null:Z.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+encodeURIComponent(Z):"data:image/png;base64,"+Z}nun(Z){const Ka=[];if(!Z||!Z.length)return Ka;for(let zb=0;zb<Z.length;++zb){const dc=Object.assign(new Kk,{index:Z[zb].Index.toString(),labelText:Z[zb].Label,
imageData:this.zhh(Z[zb].Render),renderData:this.zhh(Z[zb].Replace)});Array.add(Ka,dc)}return Ka}eBm(Z,Ka){const zb=[];if(Va.a.rb(Z)||!Ka)return zb;for(var dc=0;dc<Ka;++dc){var Jc=Object.assign(new Kk,{index:dc.toString(),labelText:"",imageData:null,renderData:null});Array.add(zb,Jc)}Z=Z.split(";");if(Z.length-1!==Ka)return D.a.J(507843330,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",
zb.length,Ka),zb;for(dc=0;dc<Ka;++dc)Jc=Z[dc].indexOf(":"),0>Jc?D.a.J(507843329,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):zb[dc].labelText=Z[dc].substr(Jc+1);return zb}mun(Z){let Ka,zb,dc,Jc;Ka="";dc=zb=0;Jc=null;if(Va.a.rb(Z))return D.a.J(507843299,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),{returnValue:!1,correlationId:Ka,ETa:zb,vXj:dc,suggestions:Jc};const jd=Z.split("|");if(4!==jd.length)return D.a.J(507843298,
829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+Z.length),{returnValue:!1,correlationId:Ka,ETa:zb,vXj:dc,suggestions:Jc};Ka=jd[0];zb=parseInt(jd[1]);dc=Number.parseInvariant(jd[2]);Jc=this.eBm(jd[3],zb);return{returnValue:!0,correlationId:Ka,ETa:zb,vXj:dc,suggestions:Jc}}hQl(Z,Ka){let zb,dc,Jc,jd;if((()=>{let de=this.mun(Ka.Uhb);({correlationId:zb,ETa:dc,vXj:Jc,suggestions:jd}=de);return de})().returnValue)if(Z=this.E3.KJd(zb))if(Z.Jca&&
Z.qmb){var Ed=Z.shape;0===Jc&&(0>=dc?(D.a.J(507843294,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",zb),this.ESa(pi.VWj)):this.TBl(Z)?(D.a.J(507843293,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",Z.yjf,this.la.Mcd),this.ESa(pi.jkl)):(Z.qmb=!1,Z.suggestionCount=dc,Z.suggestions=jd,D.a.J(507843292,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",
Z.correlationId,Z.suggestionCount),this.G3.txh(Ed)))}else D.a.J(507843295,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.EP?this.EP.correlationId:"",zb,Z.Jca,Z.qmb);else D.a.J(507843296,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",zb);else D.a.J(507843297,829,
50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}TBl(Z){const Ka=new Date,zb=Z.FDb,dc=this.la.Mcd;return Ka&&zb&&0<dc&&+Ka-+zb>dc?(Z.yjf=+Ka-+zb,!0):!1}}Object(c.a)(al,"ReplaceIconManager",null,[]);var fl=a(1362),nk=a(1527);class ii extends Sys.EventArgs{constructor(Z){super();this.sQa=Z}}Object(c.a)(ii,"OnBeforeReplaceObjectSuggestionApplyEventArgs",Sys.EventArgs,[]);class gl{constructor(){this.shape=null;this.action=0}}Object(c.a)(gl,"ShowHideReplaceObjectGalleryData",
null,[]);class Xk{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh){this.zN=this.n1d=!1;this.ia=Ka;this.Ma=zb;this.va=Jc;this.ih=dc;this.uc=jd;this.GKc=Ed;this.G3=Cf;this.xb=yg;this.Ia=bh;this.pa=Z;this.Ad=de;this.E3=Ne;this.Mb=Re}get Er(){return this.zN}setup(){this.Er||(this.Jz(),this.Hb(),this.ve(),this.zN=!0)}dispose(){this.Er&&(this.xVk(),this.zN=!1)}Jz(){this.ih.jaf(Object(e.a)(this,this.I2g,"updateEditState"))}xVk(){this.ih.CKg(Object(e.a)(this,this.I2g,"updateEditState"))}Hb(){this.ia.sa(sb.a.o$b,
Na.a.application,Object(e.a)(this,this.o$b,"applyReplaceObjectSuggestion"),4);this.ia.sa(sb.a.KYc,Na.a.application,Object(e.a)(this,this.KYc,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.sa(sb.a.Xoe,Na.a.application,Object(e.a)(this,this.KYc,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.sa(sb.a.tIe,Na.a.application,Object(e.a)(this,this.fOl,"navigateReplaceObjectSuggestion"),4);this.ia.sa(sb.a.sIe,Na.a.application,Object(e.a)(this,this.fOl,"navigateReplaceObjectSuggestion"),4)}ve(){const Z=
this.Ma.gd(Fa.a.sX),Ka=this.Ma.gd(Fa.a.kh),zb=this.Ma.gd(Fa.a.Jdd);Z.bindAction(ub.a.eb(qa.a.hv,2),sb.a.Xoe);Ka.bindAction(ub.a.eb(qa.a.hv,2),sb.a.Xoe);zb.bindAction(ub.a.eb(qa.a.hv,2),sb.a.Xoe);zb.bindAction(ub.a.eb(qa.a.Q2,0),sb.a.Xoe);zb.bindAction(ub.a.eb(qa.a.Yba,0),sb.a.tIe);zb.bindAction(ub.a.eb(qa.a.oja,0),sb.a.sIe)}I2g(){this.n1d||D.a.J(507843088,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.n1d=!0}o$b(Z,Ka,zb,dc,Jc){if(!this.Er)return D.a.J(33698392,829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),
16;Ka=this.va.presentation;if(!this.va.Ga||!Ka||this.uc.Cd(Ka))return 16;if(1===zb)return 32;zb=!0;dc=null;Object(Ei.a)(fl.a,Jc)?dc=Jc:Object(Ei.a)(nk.a,Jc)&&(dc=Jc.Jbh,zb=!1);Jc=new mk.a(C.a.Yq(dc.ActiveSlideSid,dc.ActiveSlideCid),dc.ShapeId,dc.SmartArtSubNodeId);const jd=new ii(Jc);this.GKc.mCn(jd);const Ed=this.E3.LJd(Jc);if(Ed&&Ed.shapeId===dc.ShapeId){let de=null;1===Ed.suggestionType&&(de=this.Ia.ev(Ed.shape));Jc=this.Mb.Fd(15,void 0,()=>{1===Ed.suggestionType||this.pa.Rt()||(this.Ad.mHg(Sys.EventArgs.Empty),
this.pa.Ti(),this.Ad.lHg(Sys.EventArgs.Empty))},()=>{de&&(this.Ad.mHg(Sys.EventArgs.Empty),this.pa.selectShape(de,!0),this.Ad.lHg(Sys.EventArgs.Empty))});try{Jc.rc(Ka),Jc.sc=dc.SmartArtSubNodeId?sb.a.Vch:Z,Ka.ZCb=dc,Ed.Hbh=dc.SuggestionSid,Ed.y4h=dc.Label,Ed.yya=!0,Ed.SZg=new Date,D.a.J(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",dc.CorrelationId,Z,dc.SuggestionSid)}finally{Jc&&Jc.dispose()}Ed.vrj=!0;Ed.ZRd=!0;zb&&Ed.pSj();
0===Ed.suggestionType?this.uc.vx(Ka,Z):de?this.uc.ggb(Ka,de,this.xb.Oa,Z):D.a.J(507843086,808,15,"Invalid smartArtShape")}else D.a.J(33863682,808,15,"Couldn't find active replaceObjectContext");return 32}KYc(Z,Ka,zb,dc,Jc){if(!this.Er)return D.a.J(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;Ka=this.va.presentation;if(!this.va.Ga||!Ka||this.uc.Cd(Ka))return 16;if(1===zb)return 32;zb=null;Ka=0;if(Z===sb.a.KYc){Z=Object(v.a)(gl,Jc);if(!Z)return 16;
zb=Z.shape;Ka=Z.action}else if(Z===sb.a.Xoe){Z=this.pa.ud();if(1!==Z.length)return 32;zb=Z[0]}if(!zb)return D.a.J(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;Z=this.E3.LJd(zb.sQa);if(!Z||!this.n1d&&Z&&0===Z.suggestionType)return 2;if(Z&&Z.Jca&&Z.shapeId===zb.get_shapeId())switch(this.pa.Rj(),this.Ma.Wd(),Ka){case 0:this.G3.FUn(Z.correlationId);break;case 1:this.G3.v8.isVisible||this.G3.tJk(Z.correlationId);break;case 2:this.G3.q8i(zb)}return 32}fOl(Z,
Ka,zb){if(!this.Er)return D.a.J(33698396,829,15,"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;Ka=this.va.presentation;return this.va.Ga&&Ka&&!this.uc.Cd(Ka)?1===zb?32:this.G3.v8.isVisible?Z===sb.a.tIe?(this.G3.tIe(),32):Z===sb.a.sIe?(this.G3.sIe(),32):16:16:16}}Object(c.a)(Xk,"ReplaceObjectActor",null,[]);class hl{constructor(Z,Ka){this.B1=Z;this.Emh=Ka}initialize(){this.B1.execute(Z=>{Z.registerSimpleRemoteWorkflow(this.Emh.rN,this.Emh.Ync,this.Emh.EUc,this.Emh.enc)})}}
Object(c.a)(hl,"ReplaceObjectAugLoopRuntimeManager",null,[]);var wl=a(1272),Sl;(function(Z){Z[Z.textToSmartArt=0]="textToSmartArt";Z[Z.iconChunking=1]="iconChunking"})(Sl||(Sl={}));Object(c.b)("ReplaceObjectType",Sl);class $l{constructor(Z,Ka){this.Lqd=this.gva=this.la=null;this.shapeId=0;this.v7a=null;this.suggestionType=0;this.Vzb=!1;this.Hbh=0;this.y4h=null;this.Ajj=this.ajj=this.ZRd=this.yya=!1;this.RZg=this.SZg=this.bRk=this.nOe=this.VZg=this.w_c=this.TZg=this.FDb=null;this.YBe=this.wXg=0;this.QRh=
this.$Ib=this.a9=null;this.qmb=!1;this.suggestions=null;this.yjf=this.suggestionCount=0;this.vrj=!1;this.Jle=null;this.bPg=!1;this.ywk=null;this.eMh=!1;this.xHe=[];this.qm=Z;this.H2f=Ka;this.reset()}g6c(Z,Ka,zb,dc,Jc,jd){this.Jca&&this.ESa(pi.rrh);if(!Z)throw Error.argumentNull("slide");const Ed=Z.hxc(new mk.a(Z?Z.Xb:null,Ka,jd));if(!Ed)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",Ka));this.gva=Z;this.Lqd=Ed;this.shapeId=Ka;this.v7a=jd;this.a9=
Di.a.create().toString();this.eMh=!0;this.$Ib=zb;this.QRh=dc;this.la=Jc;this.FDb=new Date;this.suggestionType=this.UTm();return this.correlationId}Wdh(Z,Ka,zb,dc,Jc){return this.g6c(Z,Ka,zb,dc,Jc,null)}UTm(){const Z=this.shape;return this.la.VMd&&Z&&this.v7a&&Z.get_isSVGBlipFilled()?1:0}ESa(Z){if(this.Jca&&!this.J5m(this.correlationId)){const Ka={};Ka.SuggestionCount=this.suggestionCount;Ka.ClientSuggestionTimeoutInMs=this.yjf;Ka.IsApplied=this.yya;Ka.AppliedSuggestionId=this.yya?this.Hbh.toString():
"";Ka.AppliedSuggestionLabel=this.yya?this.y4h:"";Ka.IsFloatieShown=this.ajj;Ka.IsGalleryShown=this.Ajj;Ka.Trigger=this.trigger;Ka.RetriggerReason=this.$uh;Ka.ResetReason=Z;Ka.IconId=this.la.Udc;Ka.SlideCID=this.slide.cid;Ka.SlideSID=this.slide.sid;Ka.ShapeID=this.shapeId;Ka.AnimId=this.la.hke;Ka.AnimEnabled=this.la.kke;Ka.GalleryHoverEnabled=this.la.ike;Ka.ReplaceSuggestionType=Sl[this.suggestionType];Ka.SeeMoreButtonClicked=this.bPg;Ka.SeeMoreIconName=this.bPg?this.ywk:"";this.FDb&&(Ka.SessionLiveTimeInMs=
+new Date-+this.FDb);this.v7a&&(Ka.SmartArtSubNodeId=this.v7a);this.w_c&&this.nOe&&this.nOe>this.w_c&&(Ka.SuggestionsReadyInMs=+this.nOe-+this.w_c);0<this.wXg&&(Ka.SuggestionsDisplayedForMs=this.wXg);0<this.YBe&&(Ka.FloatieDisplayedForMs=this.YBe);this.w_c&&this.FDb&&this.w_c>this.FDb&&(Ka.FloatieReadyInMs=+this.w_c-+this.FDb);this.FDb&&this.TZg&&this.FDb>this.TZg&&(Ka.TriggeredByAugLoopInMs=+this.FDb-+this.TZg);this.SZg&&this.RZg&&this.RZg>this.SZg&&(Ka.SuggestionAppliedInMs=+this.RZg-+this.SZg);
if(0<this.suggestions.length){Z=[];for(let zb=0;zb<this.suggestions.length;zb++)Array.add(Z,this.suggestions[zb].labelText);Ka.SuggestionLabels=Yi.c(Z)}1!==this.suggestionType||Va.a.rb(this.Jle)||(Z=wl.a.Ljb(this.Jle))&&Z.hasChildNodes()&&(wl.a.iac(),wl.a.kYl(this.Jle));this.qm.a_l(this.correlationId,Yi.c(Ka),void 0,Object(e.a)(this,this.oxg,"onFailureCallback"));this.Ffn(this.correlationId)}this.reset()}reset(){this.eMh=!1;this.gva=null;this.vrj=this.Ajj=this.ajj=this.ZRd=this.yya=this.Vzb=!1;this.QRh=
this.$Ib=this.a9="";this.suggestions=[];this.Hbh=0;this.y4h="";this.qmb=!1;this.yjf=this.suggestionCount=0;this.RZg=this.SZg=this.bRk=this.nOe=this.VZg=this.w_c=this.TZg=this.FDb=null;this.suggestionType=this.YBe=this.wXg=0;this.Jle="";this.Lqd=null;this.bPg=!1;this.ywk=""}J5m(Z){return this.xHe?Array.contains(this.xHe,Z):!1}Ffn(Z){this.xHe&&!Array.contains(this.xHe,Z)&&(Array.add(this.xHe,Z),D.a.J(512496034,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",
Z,this.xHe.length))}oxg(Z){D.a.J(512496033,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",Z.HttpStatusCode);return!0}pSj(){this.dNl(2,4)}Jfn(){this.dNl(3,3)}dNl(Z,Ka){this.H2f&&this.H2f.execute(zb=>{const dc=Object.assign(new Ql.a,{cardId:Ul.a.M5l,actionType:Z,actionEngagement:Ka});zb.xrh(dc)})}get slide(){return this.gva}get shape(){return this.Lqd}get correlationId(){return this.a9}get trigger(){return this.$Ib}get $uh(){return this.QRh}get Jca(){return this.eMh}get appSettings(){return this.la}get sQa(){return new mk.a(this.slide?
this.slide.Xb:null,this.shapeId,this.v7a)}}Object(c.a)($l,"ReplaceObjectContext",null,[1367]);class ka{constructor(){this.ua=new Ad.a}mCn(Z){this.ua.raiseEvent("ReplaceObjectBSA",Z)}fqm(Z){this.ua.addHandler("ReplaceObjectBSA",Z)}ZFn(Z){this.ua.removeHandler("ReplaceObjectBSA",Z)}QWl(Z){this.ua.raiseEvent("ReplaceObjectSPOver",Z)}Jqm(Z){this.ua.addHandler("ReplaceObjectSPOver",Z)}rGn(Z){this.ua.removeHandler("ReplaceObjectSPOver",Z)}PWl(Z){this.ua.raiseEvent("ReplaceObjectSPOut",Z)}Iqm(Z){this.ua.addHandler("ReplaceObjectSPOut",
Z)}qGn(Z){this.ua.removeHandler("ReplaceObjectSPOut",Z)}nCn(Z){this.ua.raiseEvent("ReplaceObjectViewDE",Z)}xqm(Z){this.ua.addHandler("ReplaceObjectViewDE",Z)}kGn(Z){this.ua.removeHandler("ReplaceObjectViewDE",Z)}}Object(c.a)(ka,"ReplaceObjectEventSource",null,[1364,1365,1366]);class ib extends Uj{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah,Ui,$g,oh,Jh,ti,Mj,Yl){super(jd,Z,Ka,zb,dc,Jc,Ed,de,Ne,Re,Cf,bh,Ah,Ui,$g,Jh,ti,Mj,Yl);this.Ht=de.Hul();this.qm=yg;this.la=oh}QH(Z,Ka){if(!this.Er)D.a.J(507843267,
829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.yad&&Ka.RH.length)if(Z=this.pa.ud(),1!==Z.length)this.Ht.Jca&&this.closeSession(this.Ht,pi.G8);else{Z=Z[0];if(this.Ht.Jca){if(this.Ht.shapeId===Z.get_shapeId())return;this.closeSession(this.Ht,pi.G8)}this.Hed(Z)&&this.fAb(this.va.Ga,Z,$i.selectShape,"")}}f1j(Z,Ka){this.Er?this.Ht.Jca&&this.Ht.shape===Ka.shape&&(Z=this.Ht.shape,this.closeSession(this.Ht,pi.NSg),this.Hed(Z)&&this.fAb(this.va.Ga,Z,$i.wVc,sk.NSg)):
D.a.J(507843266,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}DSj(Z,Ka){Ka.t9c&&this.Qja(Ka.actionId)}yR(){this.Ht.Jca&&this.closeSession(this.Ht,pi.slideNavigation)}vta(Z,Ka){this.Ht.Jca&&Ka.Psa&&Ka.shapes&&Array.contains(Ka.shapes,this.Ht.shapeId)&&this.closeSession(this.Ht,pi.wEk)}e1j(Z,Ka){Ka.correlationId!==this.Ht.correlationId?D.a.J(507843265,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Ht.correlationId,
Ka.correlationId):this.Dyl(Ka,this.Ht,this.la)}HYj(){this.Er&&this.Ht.ZRd&&0===this.Ht.suggestionType&&!this.uc.Cd(this.va.presentation)&&(this.Ht.ZRd=!1,this.G3.O4b(this.Ht.shape,!0))}fAb(Z,Ka,zb,dc){dc=void 0===dc?"":dc;try{const Jc=this.Ht.Wdh(Z,Ka.get_shapeId(),zb,dc,this.la);this.Ht.qmb=!0;this.G3.x2g(this.Ht.correlationId);this.qm.WHi(Z.cid,Z.sid,Ka.get_shapeId(),Jc,zb,null,this.sS.fih(Ka),this.sS.eih(Ka),void 0,Object(e.a)(this,this.fce,"onTaskFailure"));this.la.fPa&&this.yIe(Jc,this.Ht.shapeId,
this.Ht.suggestions,fk.a.pending)}catch(Jc){D.a.J(507843264,829,15,"GenerateSuggestion failed!! {0} ",Jc.message)}}fce(Z){D.a.J(507843235,829,15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",Z.HttpStatusCode);return!0}Qja(Z){this.Er?this.Ht.Jca&&!this.Gkh(Z)&&this.closeSession(this.Ht,pi.EPe+this.VL.Mia(Z)):D.a.J(507843234,829,15,"ReplaceObjectManager::HandleAction - called before setup")}closeSession(Z,Ka){Z.Vzb&&this.G3.O4b(Z.shape,!0);Z.ESa(Ka);
this.la.fPa&&this.yIe(Z.correlationId,Z.shapeId,Z.suggestions,fk.a.wOc)}}Object(c.a)(ib,"ReplaceObjectManager",Uj,[]);var Rb=a(29);class tc{constructor(Z){this.fW=-1;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.uBj=Array.clone(Z)}get_current(){if(-1===this.fW||this.fW>=this.uBj.length)throw Error.invalidOperation();return this.uBj[this.fW]}moveNext(){this.fW++;return this.fW<this.uBj.length}reset(){this.fW=-1}}Object(c.a)(tc,"ArrayEnumerator",null,[103]);class xc{constructor(Z){this.EKc=
[];this.$$ge=this.getEnumerator;this.Odn=Z}getEnumerator(){return new tc(this.EKc)}[Symbol.iterator](){return Object(Rb.a)(this.getEnumerator())}Zjh(Z,Ka){Z&&(Z.ESa(Ka),Array.remove(this.EKc,Z))}KJd(Z){for(const Ka of this.EKc)if(Ka.correlationId===Z)return Ka;return null}LJd(Z){for(const Ka of this.EKc)if(mk.a.ZMe(Z,Ka.sQa))return Ka;return null}mwl(Z,Ka){for(const zb of this.EKc)if(zb.shapeId===Z&&(!Ka&&!zb.v7a||Ka&&Ka===zb.v7a))return zb;return null}WFf(Z){return this.mwl(Z,null)}Hul(){return 0<
this.EKc.length?this.EKc[0]:null}g6c(Z,Ka,zb,dc,Jc,jd){let Ed=this.LJd(new mk.a(Z.Xb,Ka,jd));Ed&&this.Zjh(Ed,pi.rrh);Ed=this.Odn(Z,Ka,zb,dc,Jc,jd);Array.add(this.EKc,Ed);return Ed}Wdh(Z,Ka,zb,dc,Jc){return this.g6c(Z,Ka,zb,dc,Jc,null)}get Gdl(){let Z=0;this.EKc.forEach(Ka=>{Ka.Jca&&Z++});return Z}}Object(c.a)(xc,"ReplaceObjectMultipleContextManager",null,[1317,98]);class hd{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re){this.va=Z;this.lLl=Ka;this.Rdn=zb;this.sS=jd;this.FKc=Jc;this.E3=dc;this.v8=Ed;this.Ma=
de;this.xe=Ne;this.Ia=Re;this.zN=!1;this.D8g=-1}get Er(){return this.zN}get kDe(){return this.D8g}setup(){this.Er||(this.FKc.fqm(Object(e.a)(this,this.nPl,"onBeforeReplaceObjectSuggestionApply")),this.FKc.Jqm(Object(e.a)(this,this.mRl,"onReplaceObjectSuggestionPointerOver")),this.FKc.Iqm(Object(e.a)(this,this.lRl,"onReplaceObjectSuggestionPointerOut")),this.zN=!0)}dispose(){this.Er&&(this.FKc.ZFn(Object(e.a)(this,this.nPl,"onBeforeReplaceObjectSuggestionApply")),this.FKc.rGn(Object(e.a)(this,this.mRl,
"onReplaceObjectSuggestionPointerOver")),this.FKc.qGn(Object(e.a)(this,this.lRl,"onReplaceObjectSuggestionPointerOut")),this.zN=!1)}nPl(Z,Ka){if(!this.va.Ga)throw Error.argumentNull("ActiveSlide is null");(Z=this.va.Ga.hxc(Ka.sQa))&&this.O4b(Z,!1)}mRl(Z,Ka){this.va.Ga&&(Z=new mk.a(this.va.Ga.Xb,Ka.shapeId,Ka.q7),(Z=this.va.Ga.hxc(Z))&&this.sJk(Z,Ka.w$i))}lRl(Z,Ka){this.va.Ga&&(Z=new mk.a(this.va.Ga.Xb,Ka.shapeId,Ka.q7),(Z=this.va.Ga.hxc(Z))&&this.wMf(Z))}sJk(Z,Ka){let zb=Z;Z.get_smartArtModelId()&&
(zb=this.Ia.ev(Z));if(Z=this.Twl(zb))this.S4l(zb,!1),Z.sJk(Ka)}wMf(Z){let Ka=Z;Z.get_smartArtModelId()&&(Ka=this.Ia.ev(Z));if(Z=this.Twl(Ka))this.S4l(Ka,!0),Z.wMf()}Twl(Z){return Z&&!Z.get_smartArtModelId()&&Object(v.a)(284,Z.tc(this.xe))?this.Rdn.w$(Z):null}hHm(Z){return Z&&Object(v.a)(284,Z.tc(this.xe))?this.lLl.w$(Z):null}UTi(Z){return Z&&Object(v.a)(284,Z.tc(this.xe))?this.lLl.k5(Z):null}txh(Z){if(!this.Er)D.a.J(507843098,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");
else if(Z){var Ka=this.hHm(Z);if(Ka){const zb=this.E3.LJd(Z.sQa);!zb||zb.Vzb&&this.kDe!==zb.shapeId||(zb.Vzb?this.kDe===zb.shapeId&&(Ka.ifh(),this.D8g=-1):(this.O4b(Z,!0,!(this.v8.Idd&&this.v8.isVisible&&mk.a.ZMe(Z.sQa,this.v8.Idd.sQa))),Ka.display()),zb.Vzb=!0)}}}zFn(){if(-1!==this.kDe&&this.va.Ga){var Z=this.va.Ga.WZ(this.kDe);Z&&this.O4b(Z,!0)}}O4b(Z,Ka,zb,dc){zb=void 0===zb?!0:zb;dc=void 0===dc?!1:dc;this.Er?Z&&(Ka&&this.wMf(Z),zb&&this.q8i(Z),Ka=this.UTi(Z))&&(dc?(Ka.Geh(),this.D8g=Z.get_shapeId()):
(this.kDe===Z.get_shapeId()&&(this.D8g=-1),Ka.visible&&Ka.dismiss(),(dc=this.E3.LJd(Z.sQa))&&Z.get_shapeId()===dc.shapeId&&(dc.Vzb=!1))):D.a.J(507843097,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}x2g(Z){this.v8.x2g(Z)}FUn(Z){if(this.Er)if(this.v8.isVisible){const Ka=this.E3.KJd(Z);Ka&&Ka.Jca&&Ka.correlationId===Z&&this.wMf(Ka.shape);this.q8i(Ka.shape)}else this.tJk(Z);else D.a.J(507843096,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup")}q8i(Z){this.v8.isVisible&&
this.v8.Idd&&mk.a.ZMe(this.v8.Idd.sQa,Z.sQa)&&(this.v8.dismiss(),(Z=this.UTi(this.v8.Idd.shape))&&Z.root&&(Z.root.style.zIndex="0"),this.Ma.lm(Fa.a.Jdd,!1))}tJk(Z){const Ka=this.E3.KJd(Z);if(Ka&&Ka.correlationId===Z&&Ka.Jca){var zb=this.UTi(Ka.shape);if(zb){var dc=zb.root;dc?this.v8.isVisible&&this.v8.Idd&&!mk.a.ZMe(this.v8.Idd.sQa,Ka.sQa)||(dc=this.sS.getBounds(dc),this.v8.show(Z,dc.x,dc.y),zb.root.style.zIndex=String(h.AFrameworkApplication.Ea.tmc),this.Ma.lm(Fa.a.Jdd,!0),Ka.Ajj=!0):D.a.J(507843093,
829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else D.a.J(507843094,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}GXl(Z){this.Er?this.v8.isVisible&&this.tJk(Z):D.a.J(507843092,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}tIe(){if(this.Er){var Z=this.v8.TNi();Z&&(-1===Z?this.v8.CS(0,!0):(this.v8.CS(Z,!1),this.v8.CS(Z-1,!0)))}else D.a.J(507843091,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup")}sIe(){if(this.Er){var Z=
this.v8.TNi();Z+1!==this.v8.RTm()&&(-1===Z?this.v8.CS(0,!0):(this.v8.CS(Z,!1),this.v8.CS(Z+1,!0)))}else D.a.J(507843090,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup")}S4l(Z,Ka){Z&&(Z=Object(v.a)(284,Z.tc(this.xe)))&&((Z=Z.ta)?Z.he(Ka):D.a.J(507843089,829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}}Object(c.a)(hd,"ReplaceObjectPresenter",null,[1349]);class Fd{constructor(){this.shapeId=this.slideCid=this.slideSid=0;this.jJe=null;this.h6j=
0}}Object(c.a)(Fd,"TaskItem",null,[]);class Td{constructor(Z,Ka,zb){this.O6d=[];this.qm=Z;this.sS=Ka;this.gHl=zb}jJm(Z,Ka,zb){for(let dc=0;dc<this.O6d.length;dc++)if(this.O6d[dc].slideSid===Z&&this.O6d[dc].slideCid===Ka&&this.O6d[dc].shapeId===zb)return this.O6d[dc];return null}F1l(Z){var Ka=this.jJm(Z.slide.sid,Z.slide.cid,Z.shapeId);if(Ka)return Ka.jJe=Z,Ka.h6j++,1;const zb=Object.assign(new Fd,{slideSid:Z.slide.sid,slideCid:Z.slide.cid,shapeId:Z.shapeId,h6j:0,jJe:null});Array.add(this.O6d,zb);
Z.qmb=!0;Ka=Z.correlationId;const dc=Z.slide,Jc=Z.shape;this.qm.WHi(dc.cid,dc.sid,Jc.get_shapeId(),Ka,Z.trigger,null,this.gHl?this.sS.fih(Jc):this.sS.RGf(Jc),this.gHl?this.sS.eih(Jc):this.sS.QGf(Jc),()=>{this.SRl(zb)},jd=>{this.SRl(zb);D.a.J(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",jd.HttpStatusCode);return!0});return 0}SRl(Z){Array.remove(this.O6d,Z);Z.jJe&&Z.jJe.Jca&&(D.a.J(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",
Z.jJe.correlationId,Z.h6j-1),this.F1l(Z.jJe))}}Object(c.a)(Td,"ReplaceObjectRequestManager",null,[1316]);class na{constructor(Z){this.BHj=!0;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.St=Z}get_current(){return this.St}moveNext(){return this.BHj?(this.BHj=!1,!0):!1}reset(){this.BHj=!0}}Object(c.a)(na,"SingleEnumerator",null,[103]);class $a{constructor(Z){this.$$ge=this.getEnumerator;this.Ht=Z}getEnumerator(){return new na(this.Ht)}[Symbol.iterator](){return Object(Rb.a)(this.getEnumerator())}Zjh(Z,
Ka){Z&&Z===this.Ht&&Z.ESa(Ka)}KJd(){return this.Ht}LJd(){return this.Ht}WFf(){return this.Ht}mwl(){return this.Ht}Hul(){return this.Ht}g6c(Z,Ka,zb,dc,Jc,jd){this.Ht.g6c(Z,Ka,zb,dc,Jc,jd);return this.Ht}Wdh(Z,Ka,zb,dc,Jc){return this.g6c(Z,Ka,zb,dc,Jc,null)}get Gdl(){return this.Ht.Jca?1:0}}Object(c.a)($a,"ReplaceObjectSingleContextManager",null,[1317,98]);var Fb=a(318);class Xb{constructor(Z,Ka,zb,dc,Jc){this.FBb=null;this.PHe=this.BDj=!1;this.dZb=null;this.visible=!1;this.ZD=Z;this.kMa=Ka;this.h2a=
zb;this.sS=Jc;this.Rmg=dc;this.zN=!1}get Er(){return this.zN}setup(){this.Er||(this.dZb=new Mg.a,this.FBb=this.Rmg.OBm(this.dZb.ta),this.kMa&&!this.kMa.isDisposed&&this.kMa.Jqa&&(this.kMa.Jqa.appendChild(this.dZb),this.he(!1),this.PHe=!0,this.kMa.hzb(this,3),this.visible=this.kMa.TK||this.kMa.Ho),this.zN=!0)}xq(){D.a.J(25306526,829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")}KR(){}Qt(){if(!this.Er)return D.a.J(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),
null;if(!this.BDj||!this.FBb.Er||!this.FBb.sxa)return null;const Z=Kb.a.Vn(this.FBb.sxa.ta.style.left),Ka=Kb.a.Vn(this.FBb.sxa.ta.style.top),zb=Kb.a.Vn(this.FBb.sxa.ta.style.width),dc=Kb.a.Vn(this.FBb.sxa.ta.style.height);return new Fb.a(new ea.a(Z,Ka),new ea.a(Z+zb,Ka),new ea.a(Z+zb,Ka+dc),new ea.a(Z,Ka+dc))}YZ(){return!1}hD(){}hG(){}setPosition(){}Yi(){this.PHe=!0;this.KB()}Vu(){this.PHe=!0;this.KB()}Kz(){this.PHe=!0;this.KB()}setZIndex(Z){this.dZb&&this.dZb.AG(Z)}LP(){}vP(){return null}iL(){return[]}draw(){}dispose(){this.h2a();
this.Er&&(this.FBb.dispose(),this.dZb.ta.parentNode&&this.dZb.fr(),this.dZb=null,this.zN=!1)}sJk(Z){this.Er?(this.HQg(Z),this.KB()):D.a.J(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")}wMf(){this.Er?this.E$b():D.a.J(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")}HQg(Z){this.Er?(this.FBb.setImage(Z),this.he(!0)):D.a.J(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")}E$b(){this.Er?
(this.FBb.dismiss(),this.he(!1)):D.a.J(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")}setSelection(){}KB(){if(this.BDj&&this.PHe){var Z=this.sS.RGf(this.ZD),Ka=this.sS.QGf(this.ZD);this.mh(Z,Ka);this.dZb&&(Z=this.sS.sSm(this.ZD),vl.a.setRotation(this.dZb.ta,Z));this.PHe=!1}}he(Z){this.BDj=Z;this.dZb.he(Z)}mh(Z,Ka){this.FBb&&this.FBb.mh(Z,Ka)}}Object(c.a)(Xb,"ReplaceObjectSuggestionPreviewView",null,[1362,1363,760,301,24,1349]);var nc=a(457),Nc=a(391),yd=a(1526),
Ud=a(1525);class ie extends Sys.EventArgs{constructor(Z){super();this.shape=Z}}Object(c.a)(ie,"ReplaceObjectViewDragEndEventArgs",Sys.EventArgs,[]);class Be{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg){this.$Ll=!1;this.fqb=this.ead=null;this.ia=Jc;this.Qi=jd;this.kd=Ed;this.E3=de;this.GKc=Ne;this.Rmg=dc;this.h2a=zb;this.ZD=Z;this.kMa=Ka;this.BP=!1;this.la=Re;this.vNj=Cf;this.zN=this.visible=!1;this.Aqb=yg}get Er(){return this.zN}wCe(){return this.E3.LJd(this.ZD.sQa)}setup(){if(!this.Er){var Z=
this.wCe();Z=Z?Z.suggestionType:0;this.$Ll=1===Z;this.fqb=new Mg.a;this.ead=this.Rmg.TAm(this.fqb,Be.zch,Object(e.a)(this,this.Mpn,"onFlyoutAnchorClick"),Object(e.a)(this,this.Npn,"onFlyoutAnchorHover"),Z);this.kMa&&!this.kMa.isDisposed&&this.kMa.Jqa&&(this.xq(this.kMa.Jqa),this.kMa.hzb(this,3));this.zN=!0}}ifh(){this.Er?this.ead&&this.ead.ifh():D.a.J(512496032,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")}Geh(){this.Er?this.ead&&this.ead.Geh():D.a.J(512496031,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")}display(){if(!this.Er)D.a.J(512496030,
829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.visible){this.KB();this.ead.show();this.visible=!0;this.afc();var Z=this.wCe();if(Z){Z.ajj=!0;const Ka=new Date;Z.w_c||(Z.w_c=Ka);Z.VZg=Ka;D.a.J(512496029,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",Z.trigger,Z.correlationId)}}}get root(){return this.Er?this.fqb.ta:(D.a.J(512496027,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)}dismiss(){if(this.Er){this.ead.dismiss();
this.visible=!1;var Z=this.wCe();Z&&(Z.Vzb=!1,Z.VZg&&(Z.YBe+=+new Date-+Z.VZg,D.a.J(512496025,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",Z.YBe,Z.VZg,Z.trigger,Z.correlationId)))}else D.a.J(512496026,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")}xq(){this.visible=!1;this.Qi.addCssClass(this.fqb.ta,"replaceObjectBody");document.body.appendChild(this.fqb.ta);this.kd.qSa(Object(e.a)(this,this.xo,
"onResize"));this.KB()}KR(){}Qt(){return null}YZ(){return!1}hD(){}hG(){}setPosition(){}Yi(){}Vu(){}Kz(){}setZIndex(){}LP(Z){if(this.Er){if(Z)this.visible=!1,this.afc();else if(this.BP){const Ka=new ie(this.ZD);this.GKc.nCn(Ka)}this.BP=Z}else D.a.J(512496024,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")}vP(){return null}iL(){return[]}draw(){this.Er?this.KB():D.a.J(512496023,829,15,"ShapeReplaceObjectView::Draw - called before setup")}setSelection(){}dispose(){this.h2a();this.Er&&
(this.kd.VCb(Object(e.a)(this,this.xo,"onResize")),this.fqb&&(this.fqb.ta.parentNode&&this.fqb.fr(),this.Qi.removeCssClass(this.fqb.ta,"replaceObjectBody")),this.dismiss(),this.ead.dispose(),this.fqb=null,this.zN=!1)}afc(){this.fqb.ta.style.visibility=this.visible?kc.a.visible:kc.a.hidden;const Z=this.wCe();Z&&(Z.Vzb=this.visible)}KB(){var Z;let Ka=null;const zb=this.kMa.Jqa;zb&&(Ka=this.Qi.Ni(zb.ta,null===(Z=this.Aqb.Yc)||void 0===Z?void 0:Z.rr));Ka?(Z=Ka.x-(Be.zch+10),this.$Ll&&this.kMa&&this.kMa.td&&
(Z=this.kMa.td.yd.ke(this.ZD.Tv,0),Z=Ka.x+Z+10),vl.a.Rqa(this.fqb.ta,1),this.fqb.setPosition(1*Z,Ka.y),this.fXn(1*Z,Ka.y)):D.a.J(512496022,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")}fXn(Z,Ka){if(this.vNj.isVisible){var zb=this.wCe(),dc=this.vNj.Idd;dc&&zb&&dc.correlationId===zb.correlationId&&this.vNj.updatePosition(Z,Ka)}}Mpn(Z){if(Z.cD!==Sys.UI.MouseButton.leftButton)return!1;this.ia.Qa(sb.a.KYc,2,Object.assign(new gl,{shape:this.ZD,action:0}));return!0}Npn(){if(!this.la.ike)return!1;
const Z=this.wCe();if(Z&&1===Z.suggestionType)return!1;this.ia.Qa(sb.a.KYc,2,Object.assign(new gl,{shape:this.ZD,action:1}));return!0}xo(Z,Ka){this.visible&&(Z=null,Ka&&Ka.yA&&(Z=Ka.yA.zd),Z&&Z.Xb.equals(this.ZD.slideId)&&this.KB())}}Be.zch=32;Object(c.a)(Be,"ShapeReplaceObjectView",null,[1347,1348,760,301,24,1349]);var oe=a(873),rf=a(92);class Vf{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg){this.Nad=this.QTa=this.Pad=this.Pab=this.vG=null;this.fqh=0;this.gFj=-1;this.Xu=this.Ht=null;this.Qi=Z;
this.ef=zb;this.UB=Ka;this.va=dc;this.ia=Jc;this.eR=Ne;this.GKc=jd;this.E3=Ed;this.L1d=de;this.Ma=Re;this.la=Cf;this.ien=!yg.hm;this.zN=this.cxe=!1}get Er(){return this.zN}get isVisible(){return this.cxe}get Idd(){return this.Ht}setup(){this.Er||(this.vG=Kb.a.hg(),this.vG.setAttribute("Unselectable","on"),this.vG.style.position=kc.a.absolute,this.Qi.addCssClass(this.vG,"replaceObjectContainer"),this.Wrk(null),document.body.appendChild(this.vG),this.z4b(),this.eR.pTa(Fa.a.Jdd,Fa.a.vl,this.vG,()=>{},
()=>{},!0),this.zN=!0)}dispose(){this.Er&&(this.dismiss(),this.N1g(),this.vG&&this.vG.parentNode&&this.vG.parentNode.removeChild(this.vG),this.zN=!1)}dismiss(){this.Er?(h.AFrameworkApplication.Ea.V9a(!0),this.setVisibility(!1),this.jIe.style.display=kc.a.none,this.jIe.style.zIndex="-1",this.Nad=this.QTa=null,this.Wrk(null)):D.a.J(508692386,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")}show(Z,Ka,zb){if(!this.Er)D.a.J(508692385,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");
else if(!Va.a.rb(Z)){var dc=this.E3.KJd(Z);dc&&dc.correlationId===Z&&dc.Jca&&!dc.qmb&&(this.Ht=dc,this.Fwn(Z,this.Ht.suggestions),this.fqh=this.Ht.suggestionCount,this.q_l(),h.AFrameworkApplication.Ea.t9a(!0),this.jIe.style.zIndex=String(h.AFrameworkApplication.Ea.wDa),this.vG.style.zIndex=String(h.AFrameworkApplication.Ea.tmc),this.jIe.style.visibility=kc.a.hidden,this.jIe.style.display=kc.a.block,this.jIe.style.visibility=kc.a.visible,this.PSb()?this.Qi.addCssClass(this.vG,"replaceIconObjectContainer"):
this.Qi.removeCssClass(this.vG,"replaceIconObjectContainer"),this.updatePosition(Ka,zb),this.setVisibility(!0))}}updatePosition(Z,Ka){let zb,dc;this.setPosition(0,0);if(this.PSb()){zb=Z+Be.zch+7;dc=Ka;const Jc=oe.a(0,0);zb+this.vG.offsetWidth>Jc.width&&(zb=Z+Be.zch-this.vG.offsetWidth,dc=Ka-7-this.vG.offsetHeight)}else zb=Z,dc=Ka-7-this.vG.offsetHeight;this.setPosition(zb,dc)}RTm(){return this.Er?this.fqh:(D.a.J(508692384,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),
0)}TNi(){return this.Er?this.isVisible?this.vG?this.vG.querySelector(".replaceObjectSuggestionsList")?this.gFj:(D.a.J(508692381,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(D.a.J(508692382,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),-1):-1:(D.a.J(508692383,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}CS(Z,Ka){if(!this.Er)D.a.J(508692380,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>Z)&&this.isVisible)if(this.vG)if(Z>=this.fqh)D.a.J(508692378,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.fqh,Z);else{var zb=this.vG.querySelector(".replaceObjectSuggestionsList");zb?(zb=zb.children)?(zb=zb[Z])?Ka?(this.gFj=Z,bb.FocusManager.UA(zb)&&this.e5l(zb.firstChild)):(this.q_l(),bb.FocusManager.KVn(zb)&&
this.mzl(zb.firstChild)):D.a.J(508692375,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):D.a.J(508692376,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):D.a.J(508692377,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else D.a.J(508692379,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")}x2g(Z){this.Pad&&(this.Pad.className=
"ReplaceObjectCorrelation "+Z)}Fwn(Z,Ka){this.Wrk(Z);if(Z=this.zCm(Z,Ka))Ka=this.yCm(),this.vG.appendChild(Ka),this.vG.appendChild(Z),this.PSb()&&(Z=this.xCm(),this.vG.appendChild(Z))}Wrk(Z){this.vG&&(this.Pab&&(this.ef.jc(ha.a.click,this.Pab,Object(e.a)(this,this.xQl,"onLinkClick")),this.Pab=null),this.Qi.wx(this.vG),this.Pad=Kb.a.hg(),this.Pad.setAttribute("Unselectable","on"),this.Pad.className=Va.a.rb(Z)?"ReplaceObjectCorrelation":"ReplaceObjectCorrelation "+Z,this.Pad.style.position=kc.a.absolute,
this.Pad.style.display=kc.a.none,this.vG.appendChild(this.Pad),this.vG.style.zIndex="-1")}yCm(){const Z=Kb.a.yx();Z.setAttribute("Unselectable","on");this.PSb()?(Z.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,this.Qi.addCssClass(Z,"replaceIconObjectContainerTitle")):(Z.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,this.Qi.removeCssClass(Z,"replaceIconObjectContainerTitle"));this.Qi.addCssClass(Z,"UIFont replaceObjectContainerTitle");return Z}zCm(Z,Ka){if(Va.a.rb(Z))return D.a.J(508692374,
829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),null;if(!Ka||!Ka.length)return D.a.J(508692373,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),null;const zb=Kb.a.jrc();zb.id=Z;zb.setAttribute("Unselectable","on");zb.setAttribute(Ga.a.pi,Ga.a.ahl);this.Qi.addCssClass(zb,"replaceObjectSuggestionsList");this.QTa||(this.QTa=new rf.a);this.Nad||(this.Nad=new rf.a);for(var dc of Ka)Va.a.rb(dc.imageData)||
this.QTa.K(dc.index,dc.imageData),this.PSb()&&!Va.a.rb(dc.renderData)&&this.Nad.K(dc.index,dc.renderData),Z=this.Aum(dc.index,dc.labelText),zb.appendChild(Z);if(this.ien&&0<this.Nad.count&&this.PSb()&&(Va.a.rb(this.Ht.Jle)&&(this.Ht.Jle=Zh.a.create().toString()),(dc=wl.a.Ljb(this.Ht.Jle))&&!dc.hasChildNodes())){dc.style.position=kc.a.absolute;dc.style.left="0px";dc.style.top="0px";for(const Jc of this.Nad.values)Z=Kb.a.uJ(),Z.src=Jc,Z.style.display=kc.a.block,Z.style.position=kc.a.absolute,dc.appendChild(Z);
wl.a.v$b()}return zb}xCm(){this.Pab=Kb.a.yx();this.Pab.setAttribute("Unselectable","on");this.Pab.setAttribute("tabindex","-1");this.Pab.setAttribute(Ga.a.pi,Ga.a.Pbh);this.Qi.addCssClass(this.Pab,"UIFont replaceObjectContainerLink");this.PSb()&&this.la.zSc&&this.la.URb&&(this.Pab.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,this.ef.Zb(ha.a.click,this.Pab,Object(e.a)(this,this.xQl,"onLinkClick")));const Z=Kb.a.hg();Z.appendChild(this.Pab);return Z}z4b(){this.vG&&(this.ef.Zb(ha.a.click,
this.vG,Object(e.a)(this,this.onClick,"onClick")),this.L1d.addHandler(this.vG,ha.a.Lj,Object(e.a)(this,this.Mjh,"inputKeyApplyHandler")),this.UB.Zb(ha.a.KP,this.vG,Object(e.a)(this,this.P3,"onPointerOver")),this.UB.Zb(ha.a.AR,this.vG,Object(e.a)(this,this.O3,"onPointerOut")))}N1g(){this.vG&&(this.ef.jc(ha.a.click,this.vG,Object(e.a)(this,this.onClick,"onClick")),this.L1d.removeHandler(this.vG,ha.a.Lj,Object(e.a)(this,this.Mjh,"inputKeyApplyHandler")),this.UB.jc(ha.a.KP,this.vG,Object(e.a)(this,this.P3,
"onPointerOver")),this.UB.jc(ha.a.AR,this.vG,Object(e.a)(this,this.O3,"onPointerOut")))}P3(Z){Z=this.dXi(Z.Dc);this.e5l(Z);return!0}O3(Z){Z=this.dXi(Z.Dc);this.mzl(Z);return!0}Mjh(Z){if(this.isVisible&&!Z.ctrlKey&&!Z.altKey&&(!Z.shiftKey||Z.keyCode===qa.a.vu&&this.PSb()))if(Z.keyCode===qa.a.hv||Z.keyCode===qa.a.C7)Z.preventDefault(),(Z=this.vG.querySelector(":focus"))&&Z.firstChild.click();else if(Z.keyCode===qa.a.vu&&this.PSb()){const Ka=this.vG.querySelector(":focus");Ka&&this.Pab&&(Ka===this.Pab?
(Z.preventDefault(),Z.stopPropagation(),this.CS(0,!0)):Ka.parentNode&&Ka.parentNode.className&&0<=Ka.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(Z.preventDefault(),Z.stopPropagation(),this.CS(this.TNi(),!1),bb.FocusManager.UA(this.Pab)))}}onClick(Z){if(Z.cD!==Sys.UI.MouseButton.leftButton)return!1;var Ka=this.dXi(Z.Dc);if(!this.Spj(Ka)||!this.N6m(Ka))return!0;Z=this.rNm(Ka);const zb=this.yHf(Ka);Ka=this.TTm(Ka);Va.a.rb(Z)||Va.a.rb(zb)||(Z=Object.assign(new fl.a,{SuggestionSid:parseInt(zb),
ShapeId:this.Ht.shapeId,CorrelationId:Z,ActiveSlideCid:this.va.Ga.cid,ActiveSlideSid:this.va.Ga.sid,Label:Ka,SmartArtSubNodeId:this.Ht.v7a?this.Ht.v7a:null,ReplaceObjectType:this.Ht.suggestionType}),this.ia.Qa(sb.a.o$b,2,Z));return!0}xQl(){this.Ht&&(this.Ht.bPg=!0);this.P1i();this.ia.Cb(sb.a.hLb,2);return!0}e5l(Z){Z&&this.Spj(Z)&&(Z=this.yHf(Z),Va.a.rb(Z)||(Z=this.PSb()?this.Nad.Ob(Z)?this.Nad.ha(Z):"":this.QTa.Ob(Z)?this.QTa.ha(Z):"",Va.a.rb(Z)||(Z=new Ud.a(this.Ht.shapeId,Z,this.Ht.v7a),this.GKc.QWl(Z))))}mzl(Z){Z&&
this.Spj(Z)&&(Z=new yd.a(this.Ht.shapeId,this.Ht.v7a),this.GKc.PWl(Z))}dXi(Z){if(!Z)throw Error.argumentNull("sourceElement");return"a"===Z.nodeName.toLowerCase()?Z:Z.parentNode}rNm(Z){return Z?Z.parentNode.parentNode.id:null}yHf(Z){if(!Z)return null;Z=Z.id.split("_");return 2!==Z.length?null:Z[1]}TTm(Z){return Z?Z.title:null}Spj(Z){return!!Z&&!Va.a.rb(Z.className)&&-1!==Z.className.indexOf("ObjectSuggestionContainer")}N6m(Z){return!!Z&&!Va.a.rb(Z.className)&&-1===Z.className.indexOf("ReplaceObjectSuggestionLoading")}Aum(Z,
Ka){const zb=this.QTa.Ob(Z);var dc=zb?this.QTa.ha(Z):qb.a.mX(Ge.a.nUa);zb||D.a.J(508692372,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");const Jc=Kb.a.uJ();Jc.setAttribute("Unselectable","on");Jc.src=dc;Jc.title=Ka;Jc.setAttribute(Ga.a.pi,Ga.a.KZ);this.Qi.addCssClass(Jc,"replaceObjectSuggestionThumbnail");dc=Kb.a.JYa();dc.id="ROS_"+Z;dc.setAttribute("Unselectable","on");dc.title=Ka;dc.setAttribute(Ga.a.pi,"none");let jd=this.PSb()?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";
this.Ht.yya&&this.Ht.Hbh.toString()===Z&&(jd+="Selected");this.Qi.addCssClass(dc,jd);zb||this.Qi.addCssClass(dc,"ReplaceObjectSuggestionLoading");dc.appendChild(Jc);Z=this.Qi.hoi();Z.setAttribute("Unselectable","on");Z.setAttribute("tabindex","-1");Z.setAttribute(Ga.a.pi,Ga.a.KZ);Z.setAttribute(Ga.a.yz,Ka);Z.appendChild(dc);return Z}setPosition(Z,Ka){this.Er?(0>Z&&(Z=0),0>Ka&&(Ka=0),this.vG.style.left=this.Qi.Uc(Z),this.vG.style.top=this.Qi.Uc(Ka)):D.a.J(508692371,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")}setVisibility(Z){if(this.vG){if(this.Ht)if(Z)this.Ht.bRk=
new Date,this.Ht.Jfn();else{let Ka;(Ka=this.Ht).wXg=Ka.wXg+(+new Date-+this.Ht.bRk)}this.vG.style.visibility=Z?kc.a.visible:kc.a.hidden;this.cxe=Z;this.Ma.lm(Fa.a.Jdd,Z)}}q_l(){this.gFj=-1}PSb(){return!!this.Ht&&1===this.Ht.suggestionType}get jIe(){this.Xu&&"undefined"!==typeof this.Xu||(this.Xu=this.Qi.hg(),this.Xu.setAttribute("id","ModalDiv"),this.Qi.addCssClass(this.Xu,"cui-modalDiv"),this.Xu.setAttribute("Unselectable","on"),document.body.appendChild(this.Xu),nc.a.instance.Zb(ha.a.TH,this.Xu,
Object(e.a)(this,this.wbe,"onModalPointerDown")),nc.a.instance.Zb(ha.a.BR,this.Xu,Object(e.a)(this,this.xbe,"onModalPointerUp")),nc.a.instance.Zb(ha.a.xcd,this.Xu,Object(e.a)(this,this.Lqn,"onModalPointerMove")),nc.a.instance.Zb(ha.a.AR,this.Xu,Object(e.a)(this,this.Mqn,"onModalPointerOut")),Nc.a.instance.Zb(ha.a.click,this.Xu,Object(e.a)(this,this.Kqn,"onModalClick")),La.a.instance.Zb(ha.a.s0b,this.Xu,Object(e.a)(this,this.gyg,"onModalMouseWheel")));return this.Xu}wbe(){return!0}xbe(){return this.P1i()}Lqn(){return!0}Mqn(){return!0}Kqn(){return this.P1i()}gyg(){return!0}P1i(){if(!this.Ht||
!this.Ht.slide)return!0;const Z=this.Ht.shape;if(!Z)return!0;this.ia.Qa(sb.a.KYc,2,Object.assign(new gl,{action:2,shape:Z}));return!0}}Object(c.a)(Vf,"ReplaceObjectSuggestionsGalleryView",null,[1314,1349]);class xg{constructor(Z,Ka,zb,dc){this.Sdn=Z;this.sS=Ka;this.va=zb;this.la=dc}VLm(Z){if(!this.va.Ga)return!1;Z=this.va.Ga.WZ(Z);return this.z5g(Z)}z5g(Z){return!(Z&&Z.get_shapeId()&&Z.hasText&&this.sS.ACc(Z))||Z.get_shapeRotation()||Z.xF||Z.Lca||Z.Uq||!this.Sdn.validate(Z)?!1:!0}v7m(Z){return!Array.contains(this.la.NLe,
Z)}}Object(c.a)(xg,"ReplaceObjectValidationHelper",null,[]);class qh{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne){this.tO=this.r2a=null;this.zN=!1;this.mta=Z;this.ef=Ka;this.UB=zb;this.Iza=dc;this.CBb=Jc;this.rf=Ed;this.la=jd;this.aXd=Ne}get Er(){return this.zN}Geh(){this.la.kke?this.tO.setAttribute("Src",this.rf.Yp("BLUEBOLT_Deactivated.gif")):this.tO.style.opacity=".3";this.aXd.j2l(Object(e.a)(this,this.dismiss,"dismiss"))}ifh(){this.la.kke?this.tO.setAttribute("Src",this.rf.Yp("BLUEBOLT_Reactivated.gif")):
this.tO.style.opacity="initial";this.aXd.disabled=!1}show(){this.la.kke?this.tO.setAttribute("Src",this.rf.Yp("BLUEBOLT_Entrance.gif")):this.tO.setAttribute("Src",this.rf.Yp("LightningIdeasOOUI_blue_32x.png"))}dismiss(){this.la.kke?(this.tO.setAttribute("Src",this.rf.Yp("BLUEBOLT_Exit.gif")),this.aXd.aMn(()=>{this.mta.ta.style.visibility=kc.a.hidden})):(this.tO.setAttribute("Src",""),this.mta.ta.style.visibility=kc.a.hidden)}setup(){this.Er||(this.mta?(this.r2a=new Mg.a,this.r2a.ta.style.visibility=
kc.a.inherit,this.r2a.ta.style.position=kc.a.absolute,this.tO=Kb.a.uJ(),this.tO.setAttribute("Unselectable","on"),this.tO.setAttribute(Ga.a.pi,Ga.a.KZ),this.tO.className="gifFloatie",this.r2a.ta.appendChild(this.tO),this.mta.appendChild(this.r2a),this.z4b()):D.a.J(38072903,829,15,"parentElement is null"),this.zN=!0)}fQl(Z){let Ka;switch(this.la.Udc){case 7:Ka="BLUEBOLT_Hover_on.gif";break;case 8:Ka="BLUEBOLT_HoverWhite_On.gif";break;default:Ka="BLUEBOLT_Hover_on.gif"}this.tO.setAttribute("Src",this.rf.Yp(Ka));
return this.CBb(Z)}onBlur(){let Z;switch(this.la.Udc){case 7:Z="BLUEBOLT_Hover_off.gif";break;case 8:Z="BLUEBOLT_HoverWhite_Off.gif";break;default:Z="BLUEBOLT_Hover_off.gif"}this.tO.setAttribute("Src",this.rf.Yp(Z));return!0}z4b(){this.Iza&&this.ef.Zb(ha.a.click,this.tO,this.Iza);this.CBb&&(this.UB.Zb(ha.a.KP,this.tO,Object(e.a)(this,this.fQl,"onHover")),this.UB.Zb(ha.a.AR,this.tO,Object(e.a)(this,this.onBlur,"onBlur")))}ZVk(){this.Iza&&this.ef.jc(ha.a.click,this.tO,this.Iza);this.CBb&&(this.UB.jc(ha.a.KP,
this.tO,Object(e.a)(this,this.fQl,"onHover")),this.UB.jc(ha.a.AR,this.tO,Object(e.a)(this,this.onBlur,"onBlur")))}dispose(){this.dismiss();this.ZVk();this.zN=!1}}Object(c.a)(qh,"GifFlyoutAnchor",null,[1390,1349]);class k{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah){this.tO=this.dW=null;this.mta=Z;this.JMa=Ka;this.icn=zb;this.jcn=dc;this.kJl=yg.Udc;this.AGl=yg.hke;this.BGl=yg.kke;this.oLc=jd;this.Rmg=Jc;this.ef=Ed;this.UB=de;this.Iza=Ne;this.CBb=Re;this.Qi=Cf;this.Den=bh;this.aXd=Ah;this.zN=
!1}get prf(){return 1===this.Den?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:this.aXd.disabled?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip}get Er(){return this.zN}setup(){this.Er||(this.dW=new Mg.a,this.tO=this.Rmg.NBm(),this.dW.ta.style.visibility=kc.a.inherit,this.LKb(),this.zN=!0)}Geh(){this.aXd.j2l(Object(e.a)(this,this.dismiss,"dismiss"));this.E$b();this.HQg();this.dW.gll("replaceObjectGrayedFlyoutAnchor")||this.dW.Zv("replaceObjectGrayedFlyoutAnchor")}show(){this.Er?
this.HQg(this.BGl):D.a.J(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")}ifh(){this.aXd.disabled=!1;this.E$b();this.HQg();this.dW.J4b("replaceObjectGrayedFlyoutAnchor")}HQg(Z){this.Er?this.tO.setImage(this.kPm(void 0===Z?!1:Z),""):D.a.J(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")}kPm(Z){const Ka=this.oLc.Eni(this.JMa,this.JMa,this.icn,this.jcn,this.prf,null);this.Qi.addCssClass(this.dW.ta,"replaceObjectFlyoutAnchorBase");this.Qi.addCssClass(this.dW.ta,
"replaceObjectFlyoutAnchor"+this.kJl);Z&&(this.Qi.addCssClass(this.dW.ta,"replaceObjectFlyoutAnchorAnimBase"),this.Qi.addCssClass(this.dW.ta,"replaceObjectFlyoutAnchorAnim"+this.AGl));return Ka}E$b(){this.Er?(this.tO.clear(),this.Qi.removeCssClass(this.dW.ta,"replaceObjectFlyoutAnchorBase"),this.Qi.removeCssClass(this.dW.ta,"replaceObjectFlyoutAnchor"+this.kJl),this.BGl&&(this.Qi.removeCssClass(this.dW.ta,"replaceObjectFlyoutAnchorAnimBase"),this.Qi.removeCssClass(this.dW.ta,"replaceObjectFlyoutAnchorAnim"+
this.AGl))):D.a.J(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")}dispose(){this.Er&&(this.ZVk(),this.dW&&this.dW.ta.parentNode&&this.dW.fr(),this.dismiss(),this.tO.dispose(),this.dW=null,this.zN=!1)}dismiss(){this.Er?(this.E$b(),this.mta.ta.style.visibility=kc.a.hidden):D.a.J(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")}LKb(){this.mta?(this.dW.ta.style.width=this.Qi.Uc(this.JMa),this.dW.ta.style.height=this.Qi.Uc(this.JMa),this.dW.ta.setAttribute(Ga.a.pi,
Ga.a.BL),this.mta.appendChild(this.dW),this.tO.LKb(this.dW.ta),this.z4b()):D.a.J(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")}aCb(){return!0}z4b(){this.Iza&&this.ef.Zb(ha.a.click,this.dW.ta,this.Iza);this.ef.Zb(ha.a.doubleClick,this.dW.ta,Object(e.a)(this,this.aCb,"onDoubleClick"));this.CBb&&(this.UB.Zb(ha.a.KP,this.dW.ta,this.CBb),this.UB.Zb(ha.a.KP,this.dW.ta.firstChild,this.CBb),this.UB.Zb(ha.a.KP,this.dW.ta.firstChild.firstChild,this.CBb))}ZVk(){this.Iza&&this.ef.jc(ha.a.click,
this.dW.ta,this.Iza);this.ef.jc(ha.a.doubleClick,this.dW.ta,Object(e.a)(this,this.aCb,"onDoubleClick"));this.CBb&&(this.UB.jc(ha.a.KP,this.dW.ta,this.CBb),this.UB.jc(ha.a.KP,this.dW.ta.firstChild,this.CBb),this.UB.jc(ha.a.KP,this.dW.ta.firstChild.firstChild,this.CBb))}}Object(c.a)(k,"ReplaceObjectFlyoutAnchor",null,[1390,1349]);class E{constructor(Z,Ka){this.j4=null;this.eo=Z;this.Qi=Ka;this.zN=!1}get Er(){return this.zN}get sxa(){return this.j4}setup(){this.Er||(this.j4=new Mg.a,this.LKb(),this.zN=
!0)}LKb(){this.eo?(this.eo.appendChild(this.sxa.ta),this.Qi.addCssClass(this.sxa.ta,"replaceObjectPreviewContainer"),this.sxa.setVisibility(!1)):D.a.J(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")}setImage(Z){if(this.Er){if(Z=this.BMb(Z))this.N4b(),this.sxa.ta.appendChild(Z),this.sxa.setVisibility(!0)}else D.a.J(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")}mh(Z,Ka){this.Er?this.sxa.mh(Z,Ka):D.a.J(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")}dispose(){this.Er&&
(this.dismiss(),this.sxa&&this.sxa.ta.parentNode&&(this.sxa.fr(),this.Qi.removeCssClass(this.sxa.ta,"replaceObjectPreviewContainer")),this.j4=null)}dismiss(){this.Er?(this.N4b(),this.sxa.setVisibility(!1)):D.a.J(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")}BMb(Z){if(!Va.a.rb(Z)){const Ka=Kb.a.uJ();Ka.setAttribute("Unselectable","on");Ka.src=Z;Ka.style.height="100%";Ka.style.width="100%";return Ka}return null}N4b(){this.sxa.ta.firstChild&&this.sxa.ta.removeChild(this.sxa.ta.firstChild)}}
Object(c.a)(E,"ReplaceObjectPreviewImageView",null,[1349]);var S=a(1348);class la{constructor(Z,Ka,zb,dc,Jc,jd,Ed){this.ef=Z;this.UB=Ka;this.Qi=zb;this.oLc=dc;this.la=Jc;this.rf=jd;this.LIl=Ed}TAm(Z,Ka,zb,dc,Jc){Z=Rl.gZn(this.la.Udc,Jc)?new qh(Z,this.ef,this.UB,zb,dc,this.la,this.rf,this.Qi,this.LIl):new k(Z,Ka,"per","PowerPointDesigner_32x32x32",this,this.oLc,this.ef,this.UB,zb,dc,this.Qi,this.la,Jc,this.LIl);Z.setup();return Z}OBm(Z){Z=new E(Z,this.Qi);Z.setup();return Z}NBm(){return new S.a(this.Qi)}}
Object(c.a)(la,"ReplaceObjectViewFactory",null,[]);class sa{constructor(Z,Ka,zb){this.Qi=Z;this.va=zb;this.Aqb=Ka}fih(Z){if(!Z)throw Error.argumentNull("shape");var Ka=Z.bV;Z=this.uAe(Ka.TopLeft);Ka=this.uAe(Ka.TopRight);return ea.a.Pm(Z,Ka)}eih(Z){if(!Z)throw Error.argumentNull("shape");var Ka=Z.bV;Z=this.uAe(Ka.TopRight);Ka=this.uAe(Ka.BottomRight);return ea.a.Pm(Z,Ka)}RGf(Z){return this.fih(Z)*this.Exl()}QGf(Z){return this.eih(Z)*this.Exl()}sSm(Z){if(!Z)throw Error.argumentNull("shape");var Ka=
Z.bV;Z=this.uAe(Ka.TopLeft);Ka=this.uAe(Ka.TopRight);return Aa.a.kN(ea.a.gG(Z,Ka))}utl(){return this.getBounds(this.Aqb.Yc.rr)}getBounds(Z){var Ka;return this.Qi.Ni(Z,null===(Ka=this.Aqb.Yc)||void 0===Ka?void 0:Ka.rr)}Exl(){const Z=this.Aqb.Yc;return Z?Z.WK:1}uAe(Z){return new ea.a(Z.X,Z.Y)}ACc(Z){return Z?!!this.va.Ga&&this.va.Ga.Xb.equals(Z.slideId):!1}}Object(c.a)(sa,"ReplaceObjectViewHelper",null,[]);var pb=a(699);class Ib{constructor(Z,Ka,zb){this.Aha=this.Dga=null;this.Mya=Z;this.Pdn=Ka;this.tph=
zb}get rN(){return"ReplaceObjectWacALWorkflow"}get proto(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'}get Ync(){this.Dga||(this.Dga=Object.assign(new Vh.a,{name:"LambdaBefore_ReplaceObjectWacAL",inputSchema:pb.a.Mwh,outputSchema:pb.a.Mwh,func:Object(e.a)(this,this.fUb,"lambdaBeforeFunc")}));return this.Dga}get enc(){return null}get EUc(){this.Aha||(this.Aha=Object.assign(new Vh.a,{name:"LambdaRemote_ReplaceObjectWacAL",
inputSchema:pb.a.Mwh,outputSchema:"ShapeTextConvertable",func:Object(e.a)(this,this.FWf,"lambdaRemoteFunc")}));return this.Aha}fUb(Z,Ka,zb){if(Z&&this.Pdn.lij())if(Z){try{var dc=Eb.a(Z.ContextId)}catch(Jc){D.a.J(507843271,375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.rN);zb(null);return}this.tph.v7m(dc.t)?this.tph.VLm(dc.shapeId)?zb(Z):(D.a.J(507843269,375,50,"{0}:LambdaBeforeDone - shape invalid",this.rN),zb(null)):(D.a.J(507843270,375,50,"{0}:LambdaBeforeDone - trigger invalid",
this.rN),zb(null))}else zb(null),D.a.J(507843272,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.rN);else D.a.J(507843273,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.rN),zb(null)}FWf(Z,Ka,zb){Z?Z?this.Mya.execute(dc=>{dc.WLe(Z.Topic,Z.Data,Z.ContextId,Jc=>{this.m6a(Jc)},Jc=>{this.j6a(Jc)},zb)}):zb(null):zb(null)}m6a(Z){if(!h.AFrameworkApplication.mi&&Z&&Z.data){var Ka=Z.data.state;if(Ka){try{var zb=Eb.a(Z.data.responseData)}catch(dc){Ka(null);D.a.J(507843268,375,10,"Try parse aug response failed:{0}",
dc.message);return}Ka(zb)}}}j6a(Z){!h.AFrameworkApplication.mi&&Z&&Z.data&&(Z=Z.data.state)&&Z(null)}}Object(c.a)(Ib,"ReplaceObjectWacALWorkflow",null,[1361]);var Wb=a(411);class Gc{constructor(){this.PWj=null}z5g(Z){return this.validate(Z)?this.PWj?this.PWj.z5g(Z):!0:!1}tMn(Z){this.PWj=Z}}Object(c.a)(Gc,"ReplaceObjectWall",null,[]);class kd extends Gc{constructor(){super();this.sS=null}xwl(Z){const Ka=this.sS.RGf(Z);Z=this.sS.QGf(Z);var zb=Ka*Z;const dc=this.sS.utl().width,Jc=this.sS.utl().height;
zb=zb/(dc*Jc)*100;D.a.J(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",Ka,Z,dc,Jc,zb);return zb}}Object(c.a)(kd,"AreaRatioWall",Gc,[]);class Gd extends kd{constructor(Z,Ka){super();this.Ycn=Z;this.sS=Ka}validate(Z){return this.xwl(Z)<=this.Ycn}}Object(c.a)(Gd,"MaxAreaRatio",kd,[]);class Xd extends Gc{constructor(Z,Ka){super();this.Xcn=Z;this.sS=Ka}validate(Z){return this.sS.QGf(Z)<=this.Xcn}}Object(c.a)(Xd,
"MaxShapeHeight",Gc,[]);class Oe extends Gc{constructor(Z,Ka){super();this.Zcn=Z;this.sS=Ka}validate(Z){return this.sS.RGf(Z)<=this.Zcn}}Object(c.a)(Oe,"MaxShapeWidth",Gc,[]);class le extends kd{constructor(Z,Ka){super();this.cdn=Z;this.sS=Ka}validate(Z){return this.xwl(Z)>=this.cdn}}Object(c.a)(le,"MinAreaRatio",kd,[]);var ve=a(258);class He extends Gc{constructor(Z,Ka){super();this.bdn=Z;this.Ia=Ka}validate(Z){return this.kRm(Z,this.Ia)>=this.bdn}kRm(Z,Ka){if(!Z)return 0;let zb=0;Ka.VH(Z,dc=>{dc.Ra(ve.a.tq)&&
(dc=dc.gb(ve.a.tq))&&0<dc.length&&zb++});return zb}}Object(c.a)(He,"MinParagraphCount",Gc,[]);class Ze extends Gc{constructor(Z,Ka){super();this.adn=Z;this.sS=Ka}validate(Z){return this.sS.QGf(Z)>=this.adn}}Object(c.a)(Ze,"MinShapeHeight",Gc,[]);class bf extends Gc{constructor(Z,Ka){super();this.edn=Z;this.sS=Ka}validate(Z){return this.sS.RGf(Z)>=this.edn}}Object(c.a)(bf,"MinShapeWidth",Gc,[]);class Vd{constructor(Z,Ka,zb){this.Hpa=null;this.la=Z;this.Ia=Ka;this.bIe=zb;this.init(this.la.MLe)}validate(Z){return this.Hpa?
this.Hpa.z5g(Z):!0}init(Z){Z=this.LCm(Z);this.pvm(Z)}LCm(Z){const Ka={};if(Va.a.rb(Z))return Ka;Z=Z.split(";");for(const zb of Z)Va.a.rb(zb)||(Z=zb.split(":"),2===Z.length?Ka[Z[0]]=Z[1]:D.a.J(507843084,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",zb));return Ka}pvm(Z){const Ka=[];"MinParagraphCount"in Z&&Array.add(Ka,new He(Wb.d(Z,"MinParagraphCount",0),this.Ia));"MinShapeHeight"in Z&&Array.add(Ka,new Ze(Wb.b(Z,"MinShapeHeight",0),this.bIe));"MaxShapeHeight"in Z&&Array.add(Ka,new Xd(Wb.b(Z,
"MaxShapeHeight",Number.MAX_VALUE),this.bIe));"MinShapeWidth"in Z&&Array.add(Ka,new bf(Wb.b(Z,"MinShapeWidth",0),this.bIe));"MaxShapeWidth"in Z&&Array.add(Ka,new Oe(Wb.b(Z,"MaxShapeWidth",Number.MAX_VALUE),this.bIe));"MinShapeAreaRatio"in Z&&Array.add(Ka,new le(Wb.b(Z,"MinShapeAreaRatio",0),this.bIe));"MaxShapeAreaRatio"in Z&&Array.add(Ka,new Gd(Wb.b(Z,"MaxShapeAreaRatio",Number.MAX_VALUE),this.bIe));for(Z=0;Z<Ka.length-1;Z++)Ka[Z].tMn(Ka[Z+1]);0<Ka.length&&(this.Hpa=Ka[0])}}Object(c.a)(Vd,"ReplaceObjectWalls",
null,[1315]);class re{constructor(){this.$=null;this.Tca=this.FHj=this.jIj=!1}get name(){return"PowerPointWebEditor.ReplaceObject"}lc(Z){this.$=Z;(this.Tca=this.$.resolve("PowerPointWebEditor.IApplicationContext").Md.Rh)&&this.$.register(Sj.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>new Sj.a(h.AFrameworkApplication.ye,this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),
this.$.resolve("PowerPointWebEditor.IErrorHandler"),this.$.resolve("Common.ITaskManager"),this.$.resolve("Common.IAppSettingsManager")));Z.register(ka,"PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers").ma().na(()=>new ka);Z.register(sa,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper").ma().na(()=>
new sa(Z.resolve("PowerPoint.IBrowserHelperManager"),Z.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));Z.register(1314,"PowerPointWebEditor.IReplaceObjectGalleryView").ma().na(()=>new Vf(Z.resolve("PowerPoint.IBrowserHelperManager"),Z.resolve("Common.IPointerInputManager"),Z.resolve("Common.IClickInputManager"),Z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Z.resolve("Common.IActionManagerExtended"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),
Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Z.resolve("PowerPointWebEditor.IInputHandlerManager"),Z.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),Z.resolve("PowerPointWebEditor.IFocusManager"),Z.resolve("PowerPointWebEditor.IApplicationSettings"),Z.resolve("Common.IBrowserUtils")));Z.register(1315,"PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls").ma().na(()=>new Vd(Z.resolve("PowerPointWebEditor.IApplicationSettings"),Z.resolve("PowerPointWebEditor.IShapeReader"),
Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")));Z.register(xg,"PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper").ma().na(()=>new xg(Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),Z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Z.resolve("PowerPointWebEditor.IApplicationSettings")));Z.register(1316,"PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager").ma().na(()=>
new Td(Z.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),Z.resolve("PowerPointWebEditor.IApplicationSettings").vFe));Z.register(1317,"PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager").ma().na(()=>Z.resolve("Common.IAppSettingsManager").getBooleanAppSetting(id.a.aSc)?new xc((Ka,zb,dc,Jc,jd,Ed)=>{const de=new $l(Z.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Z.Na("PowerPointWebEditor.IDesignerServiceProvider"));
de.g6c(Ka,zb,dc,Jc,jd,Ed);return de}):new $a(new $l(Z.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Z.Na("PowerPointWebEditor.IDesignerServiceProvider"))));Z.register(1318,"PowerPointWebEditor.IReplaceObjectManager").ma().na(()=>Z.resolve("Common.IAppSettingsManager").getBooleanAppSetting(id.a.aSc)?new El(Z.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),Z.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),Z.resolve("PowerPointWebEditor.IFocusManager"),
Z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Z.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Z.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),Z.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),Z.resolve("PowerPointWebEditor.IPptSelectionManager"),Z.resolve("Common.IActionManagerExtended"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),
Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager"),Z.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),Z.resolve("PowerpointPresence.IPresenceEventHandlers"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),Z.resolve("PowerPointWebEditor.View.IViewEventSource"),Z.resolve("PowerPointWebEditor.IApplicationSettings"),
Z.resolve("PowerPointWebEditor.IActionNameResolver"),Z.resolve("Common.ITaskManager"),Z.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Z.Na("PowerPointWebEditor.IDesignerServiceProvider")):new ib(Z.resolve("PowerPointWebEditor.IFocusManager"),Z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Z.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Z.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),Z.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
Z.resolve("PowerPointWebEditor.IPptSelectionManager"),Z.resolve("Common.IActionManagerExtended"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),Z.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Z.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),
Z.resolve("PowerpointPresence.IPresenceEventHandlers"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),Z.resolve("PowerPointWebEditor.View.IViewEventSource"),Z.resolve("PowerPointWebEditor.IApplicationSettings"),Z.resolve("PowerPointWebEditor.IActionNameResolver"),Z.resolve("Common.ITaskManager"),Z.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Z.Na("PowerPointWebEditor.IDesignerServiceProvider")));Z.register(hd,"PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").ma().na(()=>
new hd(Z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Z.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>"),Z.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),
Z.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),Z.resolve("PowerPointWebEditor.IFocusManager"),Z.resolve("Box4.IPageView").Oa,Z.resolve("PowerPointWebEditor.IShapeReader")));Z.register(Rl,"PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer").ma().na(()=>new Rl(Z.resolve("PowerPointWebEditor.IApplicationSettings"),Z.resolve("Common.ITaskManager")));Z.register(la,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory").ma().na(()=>new la(Z.resolve("Common.IClickInputManager"),Z.resolve("Common.IPointerInputManager"),
Z.resolve("PowerPoint.IBrowserHelperManager"),Z.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),Z.resolve("PowerPointWebEditor.IApplicationSettings"),Z.resolve("PowerPoint.IPathManager"),Z.resolve("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer")));Z.register(738,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>").ma().na(()=>new ec.a((Ka,zb)=>{let dc=null;const Jc=Object(v.a)(284,Ka.tc(Z.resolve("Box4.IPageView").Oa));
Jc&&!Jc.isDisposed&&Jc.Jqa&&(dc=new Be(Ka,Jc,zb,Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),Z.resolve("Common.IActionManagerExtended"),Z.resolve("PowerPoint.IBrowserHelperManager"),Z.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),Z.resolve("PowerPointWebEditor.IApplicationSettings"),Z.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),
Z.resolve("PowerPointWebEditor.IActiveSlideViewManager")),dc.setup());return dc}));Z.register(738,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>").ma().na(()=>new ec.a((Ka,zb)=>{let dc=null;const Jc=Object(v.a)(284,Ka.tc(Z.resolve("Box4.IPageView").Oa));Jc&&!Jc.isDisposed&&Jc.Jqa&&(dc=new Xb(Ka,Jc,zb,Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")),
dc.setup());return dc}));Z.register(Ib,"PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>new Ib(this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.$.resolve("PowerPointWebEditor.IReplaceObjectManager"),this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper")));Z.register(hl,"PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").ma().na(()=>
new hl(this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.$.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow")));Z.register(Xk,"PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").ma().na(()=>new Xk(Z.resolve("PowerPointWebEditor.IPptSelectionManager"),Z.resolve("Common.IActionManagerExtended"),Z.resolve("PowerPointWebEditor.IFocusManager"),Z.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),Z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Z.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),Z.resolve("PowerPointWebEditor.View.IViewEventSource"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Z.resolve("Common.Transaction.ITransactionFactory"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),Z.resolve("PowerPointWebEditor.View.IPPTPageView"),Z.resolve("PowerPointWebEditor.IShapeReader")));
Z.register(al,"PowerPointWebEditor.ReplaceObject.ReplaceIconManager").ma().na(()=>new al(Z.resolve("PowerPointWebEditor.IPptSelectionManager"),Z.resolve("PowerPointWebEditor.View.IViewEventSource"),Z.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Z.resolve("PowerPointWebEditor.IShapeReader"),Z.resolve("PowerPointWebEditor.IApplicationSettings"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),
Z.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Z.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),Z.resolve("PowerpointPresence.IPresenceEventHandlers"),Z.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),Z.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingStatusChecker"),Z.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),Z.resolve("PowerPointWebEditor.IActionNameResolver"),Z.resolve("PowerPointWebEditor.Core.IUnifiedAppState")))}init(){this.Tca&&
this.$.resolve("PowerPointWebEditor.PodsInfoSender");const Z=this.$.resolve("Common.IAppSettingsManager");Z.fg(()=>{const Ka=new Date;Z.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?D.a.J(512262752,324,50,"PPTO TestEcsFeature Client Flight Enabled."):D.a.J(512262751,324,50,"PPTO TestEcsFeature Client Flight Disabled.");if(this.jIj=Z.getBooleanAppSetting(id.a.OLe))Z.getBooleanAppSetting(id.a.bVc)&&this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").initialize(),
this.$.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.$.resolve("PowerPointWebEditor.IReplaceObjectManager").setup();if(this.FHj=Z.getBooleanAppSetting(id.a.VMd))this.$.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),
this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").setup();D.a.J(512262750,829,50,"ReplaceObject::Callback duration:{0}",+new Date-+Ka)})}dispose(){this.jIj&&(this.$.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.$.resolve("PowerPointWebEditor.IReplaceObjectManager").dispose(),this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose());
this.FHj&&(this.$.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose(),this.$.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").dispose())}static main(){b.a.instance.Fc(Ea.a(new re,0))}}Object(c.a)(re,"PPTWebEditorReplaceObjectPackage",null,[3,4]);var qf=a(425),lg=a(139),we=a(1263);class Ue{constructor(){this.appName=
0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=!1;this.wdDisableSPOFileCache=this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(c.a)(Ue,"AppSettings",
null,[]);class ze{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}}Object(c.a)(ze,"ControllerFactoryParameters",null,[]);var Gf=a(846),Ve=a(475);class gf{}gf.none="None";gf.vhFailedToLoadVersionList="VHFailedToLoadVersionList";gf.vhFailedToGetDownloadToken="VHFailedToGetDownloadToken";gf.vhFailedToParseVersionList="VHFailedToParseVersionList";gf.vhFetchFailed="VHFetchFailed";gf.vhVersioningNotEnabled="VHVersioningNotEnabled";
gf.vhFileNotFound="VHFileNotFound";gf.vhVersionTooOld="VHVersionTooOld";gf.v_n="VHFailedToRenderThumbnails";gf.u_n="VHFailedToRenderSlide";gf.t_n="VHFailedToRenderNotes";gf.r_n="VHFailedToRenderDiff";gf.w_n="VHFailedToShowAnimaitonIcon";gf.x_n="VHFailedToShowHiddenEffect";gf.s_n="VHFailedToRenderInitPresInfo";Object(c.a)(gf,"ErrorName",null,[]);class hg{constructor(){this.tLc=new ua.a;this.tLc.add(0,gf.none);this.tLc.add(100,gf.vhFailedToLoadVersionList);this.tLc.add(101,gf.vhFailedToGetDownloadToken);
this.tLc.add(102,gf.vhFailedToParseVersionList);this.tLc.add(103,gf.vhFetchFailed);this.tLc.add(104,gf.vhVersioningNotEnabled);this.tLc.add(105,gf.vhFileNotFound);this.tLc.add(106,gf.vhVersionTooOld);this.QMc=new ua.a;this.QMc.add(0,gf.none);this.QMc.add(100,gf.v_n);this.QMc.add(101,gf.u_n);this.QMc.add(102,gf.t_n);this.QMc.add(103,gf.r_n);this.QMc.add(104,gf.w_n);this.QMc.add(105,gf.x_n);this.QMc.add(106,gf.s_n)}get bOn(){return this.tLc}get A_n(){return this.QMc}static Dwl(){hg.Xuk||(hg.Xuk=new hg);
return hg.Xuk}}hg.vil="ErrorCode";hg.Xuk=null;Object(c.a)(hg,"VersionHistoryTelmetryHelper",null,[]);var kg=a(580);class Rf{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah,Ui,$g,oh){this.xqh=this.pR=this.PIl=this.Zoh=this.JTa=this.Rga=this.QQj=this.mOa=this.dka=null;this.Vbc=-1;this.uGe=null;if(!oh)throw Error.argumentNull("clientRequestManager");this.ia=Z;this.hOa=Ka;this.Uj=zb;this.Aa=dc;this.oc=Jc;this.ibd={};this.Ma=jd;this.qj=Ed;this.MHe={};this.fc=Ne;this.wqh={};this.xdn=de;this.jka=Re;
this.nb=Cf;this.SCj=[];yg&&(this.PIl=yg,this.PIl.execute(Jh=>{this.pR=Jh}));this.XL=bh;this.uh=Ah;this.b0f=Ui;this.n_b=$g;this.$p=oh;this.Yen=new kg.a(dc.tia)}Hb(){this.ia.za(w.a.Xed,r.a.frame,Object(e.a)(this,this.OQn,"showVersionHistoryDialogAction"));this.Aa.jKe||this.ia.za(sb.a.Qsh,r.a.frame,Object(e.a)(this,this.SEg,"pptoShowFileVersion"));this.ia.za(sb.a.$zh,r.a.frame,Object(e.a)(this,this.TXm,"handleVersionHistoryCopySlides"))}OQn(Z,Ka,zb){if(1===zb)return Z=!1,this.nb.G0a&&(Z=!0),Z?2:32;2===
zb&&(this.xqh=Di.a.create().toString(),f.ULS.sendTraceTag(512508634,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: ${this.m_versionHistoryLaunchSessionId}. disableVHSPOFileCache: ${this.disableVHSPOFileCache()}"),vb.c(sb.a.osh,!0),this.ibd.VersionHistoryLaunchSessionId=this.xqh,this.MHe.VersionHistoryLaunchSessionId=this.xqh,this.ibd.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.Zoh=[],this.dka||(this.dka=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new ze,
{ulsLogger:new lg.a,serviceBase:this.Aa.getSetting("VersionHistoryWebServiceBase"),latestStreamServiceBase:this.Aa.getBooleanAppSetting("PPTVHPodsBootEnabled")?this.Aa.getSetting("PODSLatestServiceBase")+"&PodSID="+this.Aa.getSetting("PodSID"):"",docId:h.AFrameworkApplication.ui,appSettings:Object.assign(new Ue,{appName:100,wdEnableDownloadTokens:!0,retryCount:this.Aa.getSetting("PodVHRetryCount"),wdEnableRestore:this.fc.Mp,userSessionId:h.AFrameworkApplication.userSessionId,wacCluster:this.Aa.La("WacCluster"),
uiLocale:this.Aa.Bsb?this.Aa.Bsb:"en-us",isRtl:h.AFrameworkApplication.isRtl,disabledChangeGates:this.Aa.La("VHSDisabledChangeGates"),disableSaveACopy:!this.fc.Mp,wdEnableDeleteVersions:this.Aa.getBooleanAppSetting("PPTVersionHistoryDeleteVersionsIsEnabled"),wdDisableSPOFileCache:this.Y$b()}),perfTelemetryInfos:this.Zoh}))),this.dka&&this.dka.setDisableSaveACopy(h.AFrameworkApplication.RA),this.PQn());return 32}SEg(Z,Ka,zb){return 1===zb&&this.nb.G0a?2:this.ia.Cb(w.a.DYc,zb)}TXm(Z,Ka,zb){if(1===zb)return this.p4l()?
2:32;this.mOa.onCopySlides();return 32}PQn(){var Z;if(!document.getElementById("VersionHistoryOverlay")){this.BEn();this.zEn();this.AEn();this.tEn();this.sEn();this.xEn();this.wEn();this.uEn();const Ka=document.createElement("div");Ka.id="VersionHistoryOverlay";Ka.style.width="100%";Ka.style.zIndex="998";Ka.style.display="block";Ka.style.position="absolute";Ka.style.top="0px";if(this.Aa.getBooleanAppSetting("RegionComposerIsEnabled")){const zb=(null===(Z=document.getElementById("HeaderRegion"))||
void 0===Z?void 0:Z.offsetHeight)||0;Ka.style.top=zb+"px";Ka.style.bottom="0px";Ka.style.height=`calc(100vh - ${zb}px)`}else Ka.style.height="calc(100% + "+ja.AFrame.$ed+"px)";document.getElementById("WACInnerFrame").appendChild(Ka);this.QQj=this.dka.createVersionHistoryDialog(Ka);this.v6b()}document.getElementById("VersionHistoryOverlay").style.display="block";this.dka.getTipVersion&&this.Aa.getBooleanAppSetting("PPTVHPodsBootEnabled")&&this.dka.getTipVersion();this.dka.getVersions("");this.Inm()}Inm(){try{this.uGe=
this.xdn.lul();for(let Z=0;Z<this.uGe.length;Z++)this.qj.Cr(this.uGe[Z]);this.qj.XW(Fa.a.ave)}catch(Z){f.ULS.sendTraceTag(512508633,822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",Z)}}aDm(){try{if(this.uGe)for(let Z=0;Z<this.uGe.length;Z++)this.qj.XW(this.uGe[Z]);else f.ULS.sendTraceTag(512508632,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");this.qj.Cr(Fa.a.ave)}catch(Z){f.ULS.sendTraceTag(512508631,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",
Z)}}BEn(){this.dka.getFullAppErrorEvent().addListener(Z=>{try{const Ka=hg.Dwl().bOn.ha(Z);this.MHe[hg.vil]=Ka;f.ULS.sendTraceTag(512508630,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",Ka,this.xqh)}catch(Ka){f.ULS.sendTraceTag(512508629,822,10,"Exception in FullAppErrorEvent call back: {0}.",Ka)}})}zEn(){this.dka.getVersionsReadyEvent().addListener(Z=>{this.o_l(Z.containerDiv);try{f.ULS.sendTraceTag(508843726,822,50,"registerForVersionReadyEvent - getVersionsReadyEvent - disableVHSPOFileCache: ${this.disableVHSPOFileCache()}");
const Ka=Z.versions;if(this.Y$b()){let zb=Z=!1;const dc=Rf.Zwc(this.Rga),Jc=Rf.Zwc(this.JTa);for(const jd of Ka){if(!jd)continue;this.G2g(jd);const Ed=Rf.Zwc(jd);dc&&Ed===dc?Z=!0:Jc&&Ed===Jc&&(zb=!0)}this.Rga&&!Z?(this.G2g(this.Rga),Ka.push(this.Rga)):this.JTa&&!zb&&(this.G2g(this.JTa),Ka.push(this.JTa))}this.Ipm(Ka);this.Ma.yia("VersionHistoryOverlay",!0);this.Rga&&this.JTa&&this.Qeh(this.Rga.DownloadUrl)&&this.Qeh(this.JTa.DownloadUrl)&&this.mOa&&(this.ram(),this.OAl(),this.mOa.onVersionSelected(this.Rga,
this.JTa,this.ibd),this.$jl())}catch(Ka){f.ULS.sendTraceTag(512508628,822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",Ka)}})}Qeh(Z){return Z.length?(new URL(Z)).host?!0:(f.ULS.sendTraceTag(508397020,822,10,"VersionHistoryPaneActor: DownloadUrl has no host"),!1):(f.ULS.sendTraceTag(508397021,822,10,"VersionHistoryPaneActor: DownloadUrl is empty"),!1)}Ipm(Z){if(this.mOa){var Ka=this.mOa.getAppDataStore();for(const zb of Z)Ka.AddVersionInfoToStore(zb)}}AEn(){this.dka.getVersionSelectedEvent().addListener(Z=>
{this.Rga=Z.currentVersion;this.JTa=Z.baseVersion;if(this.mOa){this.Y$b()&&(this.Rga&&!this.Qeh(this.Rga.DownloadUrl)&&this.G2g(this.Rga),this.JTa&&!this.Qeh(this.JTa.DownloadUrl)&&this.G2g(this.JTa));try{this.ram(),this.OAl(),this.mOa.onVersionSelected(this.Rga,this.JTa,this.ibd),this.XEn(),this.$jl()}catch(Ka){f.ULS.sendTraceTag(512508627,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",Ka)}}})}XEn(){const Z=this.DIf(2);Z&&(Tc.a.addHandler(Z,ha.a.Lj,Object(e.a)(this,
this.bL,"keyDownHandler")),bj.a.instance.Zb(Z,Object(e.a)(this,this.tJ,"contextMenuHandler")))}NWn(){const Z=this.DIf(2);Z&&(Tc.a.removeHandler(Z,ha.a.Lj,Object(e.a)(this,this.bL,"keyDownHandler")),bj.a.instance.jc(Z,Object(e.a)(this,this.tJ,"contextMenuHandler")))}bL(Z){try{if(Z.shiftKey&&Z.keyCode===qa.a.kDa||Z.keyCode===qa.a.pcb){const Ka=we.a.create(ha.a.contextMenu,Z,1);this.tJ(Ka)}}catch(Ka){f.ULS.sendTraceTag(512508626,822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",Ka)}}tJ(Z){if(1===
Z.yg){const Ka=this.DIf(2);Ka&&(Z.clientPoint.x=Ac.a.iAf(Ka)+Ge.a.$va,Z.clientPoint.y=Ac.a.jAf(Ka)+Ge.a.$va)}return 32===this.ia.Qa(sb.a.Adh,2,Z)}tEn(){this.dka.getDownloadTokenReadyEvent().addListener(Z=>{try{if(f.ULS.sendTraceTag(512508625,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.JTa)if(Z&&Z.updatedVersions&&2<=Z.updatedVersions.length){let Ka=null,zb=null;const dc=Rf.Zwc(this.Rga),Jc=Rf.Zwc(this.JTa);for(const jd of Z.updatedVersions){if(!jd)continue;const Ed=
Rf.Zwc(jd);dc&&dc===Ed?Ka=jd:Jc&&Jc===Ed&&(zb=jd);if(Ka&&zb)break}Ka&&zb?(this.Rga=Ka,this.JTa=zb,this.mOa.diff(this.Rga,this.JTa)):f.ULS.sendTraceTag(512508623,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",dc,Jc)}else f.ULS.sendTraceTag(512508622,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
else f.ULS.sendTraceTag(512508624,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(Ka){f.ULS.sendTraceTag(512508621,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",Ka)}})}Y$b(){return this.Yen.brl||this.Aa.getBooleanAppSetting("DisableVHSPOFileCache")}IFm(Z){return Z?0!=Z.indexOf("SequenceNumber")?(f.ULS.sendTraceTag(508859522,822,15,"VersionHistoryPaneActor - downloadUrlIsValidSyncToken - Download URL does not start with SequenceNumber: {0}",
Z),!1):!0:(f.ULS.sendTraceTag(508859523,822,15,"VersionHistoryPaneActor - downloadUrlIsValidSyncToken - Download URL is null or empty"),!1)}G2g(Z){if(Z&&this.IFm(Z.DownloadUrl)){const zb=this.Aa.B8;var Ka=zb+"VersionHistoryDownloadLink.ashx";const dc=h.AFrameworkApplication.ui;if(dc)Ka=new ic.QueryStringBuilder(Ka),Ka.Zi(gj.a.TSl,dc),Ka.Zi(gj.a.S4j,Z.DownloadUrl),Ka.Zi(gj.a.WSl,Rf.Zwc(Z)),Z.DownloadUrl=Ka.toString(),Z=new URL(zb),f.ULS.sendTraceTag(508940565,822,50,`VersionHistoryPaneActor - updateDownloadUrl - Generated download URL with popsServiceBase host: ${Z.host}`);
else throw f.ULS.sendTraceTag(508936896,822,15,"VersionHistoryPaneActor - updateDownloadUrl - QuerySignature not found"),Error("Could not update downloadUrl with valid VersionHistoryDownloadLink - QuerySignature not found");}else f.ULS.sendTraceTag(508371797,822,15,"VersionHistoryPaneActor - updateDownloadUrl - Invalid SyncToken")}xEn(){this.dka.getSaveACopySelectedEvent().addListener(Z=>{var Ka=h.AFrameworkApplication.N9c;this.Aa.getBooleanAppSetting("VHSaveACopyForOdcOnSpoEnabled")&&(Ka=32===this.ia.Cb(sb.a.Gcd,
1));f.ULS.sendTraceTag(512508620,822,10,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent - shouldUseSaveACopyCommand: {0}",Ka);this.Aa.getBooleanAppSetting("PowerPointVersionHistoryFloodGateIsEnabled")&&Rf.unn();this.Y$b()&&(-1!=Z.indexOf("VersionHistoryDownloadLink.ashx")?Z="app=ppt ver="+(new ic.QueryStringBuilder(Z)).jSi(gj.a.S4j):f.ULS.sendTraceTag(508699020,832,10,"DownloadURL did not contain VersionHistoryDownloadLink"));Z={["FileDownloadUrl"]:Z,["SaveEntryPoint"]:"VersionHistory"};
Ka=Ka?this.ia.Qa(sb.a.Gcd,2,Z):this.ia.Qa(w.a.dec,2,Z);32!==Ka?(vb.c(sb.a.wjf,!1),f.ULS.sendTraceTag(512508619,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",Ka)):vb.c(sb.a.wjf,!0)})}i8l(Z,Ka){try{(new Promise((zb,dc)=>{this.dka.setRestoreInProgress();this.jka.N5c(this.nb.pk,this.nb.podSessionId,this.nb.Nh.string,this.Aa.getSetting(id.a.$l),this.nb.sia,!1,!0,()=>{zb(!0)},Jc=>{dc("ClosePopWacSessionSync:: "+Jc.error.message)})})).then(()=>{(new Promise((zb,dc)=>{this.jka.Pdd(this.nb.Nh.string,
Z,()=>{zb(!0)},Jc=>{dc("RestoreFileVersion:: "+Jc.error.message)})})).then(()=>{const zb=Date.now()-Ka;f.ULS.sendTraceTag(512508618,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",zb);this.MHe.RestoreSucceededTime=zb;this.ia.Qa(sb.a.refresh,2,{["IsSourceVH"]:!0});vb.c(sb.a.Rxd,!0)}).catch(zb=>{const dc=Date.now()-Ka;this.dka.setRestoreFailedAtServer(()=>{this.ia.Qa(sb.a.refresh,2,{["IsSourceVH"]:!0})});f.ULS.sendTraceTag(512508617,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",
zb,dc);this.MHe.RestoreFailedTime=dc;vb.c(sb.a.Rxd,!1)})})}catch(zb){f.ULS.sendTraceTag(512508616,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",zb.message),vb.c(sb.a.Rxd,!1)}}wEn(){this.dka.getRestoreVersionSelectedEvent().addListener(Z=>{f.ULS.sendTraceTag(512508615,832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",Z);const Ka=Date.now();this.pR?(this.SCj=this.pR.J7c(),0<this.SCj.length?(f.ULS.sendTraceTag(512508614,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",
this.SCj.length),vb.c(sb.a.Rxd,!1),this.dka.setCoauthRestoreError()):this.i8l(Z,Ka)):(f.ULS.sendTraceTag(512508613,832,10,"VersionHistoryPaneActor: presence manager is null"),this.i8l(Z,Ka))})}uEn(){this.dka.getDownloadVersionSelectedEvent().addListener(Z=>{f.ULS.sendTraceTag(512508612,832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");Z=new ic.QueryStringBuilder(Z);Z.Zi(gj.a.J4j,h.AFrameworkApplication.fileName);Z=this.ia.Qa(w.a.downloadACopy,2,{["FileDownloadUrl"]:Z.toString()});
32!==Z?(vb.c(sb.a.vjf,!1),f.ULS.sendTraceTag(512508611,832,10,"Download version failed with result: {0}",Z)):vb.c(sb.a.vjf,!0)})}ram(){for(const Z of this.Zoh){const Ka=Z.TelemetryEventKey?Z.TelemetryEventKey:Z.telemetryEventKey?Z.telemetryEventKey:"",zb=Z.TelemetryEventData?Z.TelemetryEventData:Z.telemetryEventData?Z.telemetryEventData:"";Va.a.rb(Ka)||Va.a.rb(zb)||(this.ibd[Ka]=zb)}}$jl(){this.Zoh=[];this.ibd={}}sEn(){this.dka.getCloseSelectedEvent().addListener(()=>{this.Aa.getBooleanAppSetting("PowerPointVersionHistoryFloodGateIsEnabled")&&
Rf.N8m();this.okl()})}okl(){this.aDm();this.Ma.qka("VersionHistoryOverlay");document.getElementById("VersionHistoryOverlay").style.display="none";this.Aa.k7h&&(this.Rga=null);f.ULS.sendTraceTag(512508610,822,50,Eb.c(this.MHe))}o_l(Z){try{if(this.mOa)Gj.setIsPageLoadForFirstTime(!1),this.mOa.switchParentViewContainer(Z);else{Gj.setIsPageLoadForFirstTime(!0);const Ka=new PowerPointVersionHistory.AppBootSettings;Ka.RenderServiceBase="";Ka.IsRtl=h.AFrameworkApplication.isRtl;const zb=new PowerPointVersionHistory.AppCallbackBag;
zb.animationDecoratorCallback=Object(e.a)(this.hOa,this.hOa.vmi,"createAnimationOrTransitionStar");zb.notesIconDecoratorCallback=Object(e.a)(this,this.wBm,"createNotesIcon");zb.addToF6LoopCallback=Object(e.a)(this,this.Bpm,"addToF6Loop");zb.copySlideCallback=Object(e.a)(this,this.copySlideCallback,"copySlideCallback");zb.reportViewerErrorCallback=dc=>{this.MHe[hg.vil]=hg.Dwl().A_n.ha(dc);106!==dc&&103!==dc||this.dka.setViewerError(!0);f.ULS.sendTraceTag(512508609,822,50,"Versions viewer error: {0}",
dc);0!==dc&&(h.AFrameworkApplication.Xs(nh.a.wi(406)),eg.Health.instance.recordQosError("VersionHistoryFailed",["VersionHistoryACE"],!1,!1,!0,!1,null));return!0};Ka.IsHighContrast=!1;this.Uj&&(Ka.IsHighContrast=this.Uj.isInHighContrastMode);Ka.IsHighContrast&&(Ka.ClientColorSettings=this.Uj.highContrastColors.foregroundTextColor+"_"+this.Uj.highContrastColors.backgroundColor+"_"+this.Uj.highContrastColors.linkColor);if(this.oc){const dc=this.oc.l_a();Ka.DefaultSlideWidth=dc.width;Ka.DefaultSlideHeight=
dc.height}Ka.UserSessionId=h.AFrameworkApplication.userSessionId;Ka.VersionViewerCssUrl=this.Aa.bve;Ka.ProgressImageResourceUrl=qb.a.mX(Ge.a.nUa);Ka.ThumbnailShareOptimizationEnabled=this.Aa.BKe;Ka.SlidePrefetchSettings=Object.assign(new PowerPointVersionHistory.SlidePrefetchSettings,{SlidePrefetchEnabled:this.Aa.getBooleanAppSetting("PPTVHSlidePrefetchEnabled"),SlidePrefetchAhead:this.Aa.getSetting("PPTVHSlidePrefetchAhead"),SlidePrefetchBehind:this.Aa.getSetting("PPTVHSlidePrefetchBehind"),SlidePrefetchChunkSize:this.Aa.getSetting("PPTVHSlidePrefetchChunkSize"),
SlidePrefetchDelay:this.Aa.getSetting("PPTVHSlidePrefetchDelay")});Ka.FileExtension=void 0!==this.Aa.e_&&null!==this.Aa.e_?Va.a.vI(this.Aa.e_).toLowerCase():"";Ka.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;Ka.NotesButtonLabel=ResourceStrings.L_Notes;Ka.SynchronizerTimeout=this.Aa.getSetting("PptVersionHistorySynchronizerTimeout");Ka.IsRtl=h.AFrameworkApplication.isRtl;Ka.IsCopySlidesEnabled=!0;Ka.SlidePaneLabel=ResourceStrings.L_SlidePaneLabelVH;Ka.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;
Ka.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;Ka.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;Ka.Lcid=h.AFrameworkApplication.lcid;Ka.EnableOverflowXOnSlideAndNotePane=this.Aa.getBooleanAppSetting("PodVHEnableOverflowXOnSlideAndNotePane");Ka.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;Ka.IsModernCatchUpUxEnable=!0;Ka.IsRevisionTrackingFlyoutEnabled=rb.a("EnableRevisionTrackingFlyoutForVH");Ka.RevisionTrackingFlyoutContent=ResourceStrings.l_SlideIsChanged;this.mOa=new PowerPointVersionHistory.AppVersionController(Ka,
Z,zb)}}catch(Ka){this.dka.setViewerError(!0),f.ULS.sendTraceTag(512508608,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",Ka)}}wBm(){return ba.a(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,ResourceStrings.L_Notes)}v6b(){const Z=this.Ma.gd("VersionHistoryOverlay");Z.parent=ja.AFrame.vl;Z.$V=!0;Z.Hsk=!0;Z.csa(Ka=>{Ka&&"dialog/modal"===Ka.name?this.dka.setSaveACopyCanceled():Ka&&Ka.name===ja.AFrame.FR||(this.Vbc=-1,this.w8l(!0))});this.qj.P7("VersionHistoryOverlay");
this.qj.ted(Fa.a.ave,Ka=>{this.w8l(Ka)});this.qj.sec(Fa.a.ave,()=>{2===this.Vbc&&Sys.UI.DomElement.addCssClass(this.DIf(2),"PPTVHViewerElementSelected");3===this.Vbc&&Sys.UI.DomElement.addCssClass(this.DIf(3),"PPTVHViewerElementSelected")})}w8l(Z){try{const Ka=this.wih();(this.Vbc=this.QQm(Z))?1===this.Vbc?this.QQj.then(zb=>{zb.enterHeaderFocusTrapZone();return null}):Ka&&bb.FocusManager.UA(document.getElementById(Ka[this.Vbc])):this.QQj.then(zb=>{zb.enterFocusTrapZone();return null})}catch(Ka){f.ULS.sendTraceTag(512508579,
822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",Ka)}}QQm(Z){const Ka=this.wih();let zb=this.Vbc;do if(Z?Ka&&(zb=(zb+1)%Ka.length):Ka&&(zb=0<zb?zb-1:Ka.length-1),!zb||1===zb||Ka&&"none"!==document.getElementById(Ka[zb]).style.display)return zb;while(zb!==this.Vbc);return 0}OAl(){const Z=Rf.Zwc(this.Rga);Z&&!this.wqh[Z]&&(this.wqh[Z]=["VersionListPane","vhHeader"],this.Vbc=-1)}wih(){if(!this.Rga)return this.Aa.k7h?["VersionListPane","vhHeader"]:null;const Z=Rf.Zwc(this.Rga);
return Z&&this.wqh[Z]?this.wqh[Z]:null}DIf(Z){const Ka=this.wih();return Ka&&Ka.length>Z?document.getElementById(Ka[Z]):null}Bpm(Z){try{const Ka=this.wih();Ka&&Ka.push(Z)}catch(Ka){f.ULS.sendTraceTag(512508578,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",Ka)}return!0}copySlideCallback(Z){if(this.p4l())return!1;const Ka=Di.a.create().toString();f.ULS.sendTraceTag(512508577,832,50,"Execute CopySlideCallback - correlationid : {0}",Ka);const zb=this.XL.Mqc(1,Z.SlideIds.length),dc=
{};dc.WacSessionId=h.AFrameworkApplication.userSessionId;dc.CallerCorrelationId=Ka;var Jc={};Jc.Source=Z.Source;Jc.SlideIds=Z.SlideIds;Jc.CcpId=zb.fp;Jc.PackageAccessKey=zb.Fx;Z=JSON.stringify(Jc);Jc=String.format("{0}{1}",this.Aa.$l,"vhcopyslide.ashx");const jd=Date.now();try{if(this.$p.rk(Jc,2,Z,dc,!1,0,Ed=>{Rf.q_n(Ed,jd,Ka)},Ed=>{Rf.p_n(Ed,jd,Ka)},null,null),this.uh.contentWindow&&this.uh.contentWindow.document&&this.uh.contentWindow.document.body){Kb.a.D$b(this.uh);const Ed=Kb.a.JYa();Ed.innerText=
Kb.a.vrh;Ed.setAttribute(Ve.a.fp,zb.fp);Ed.setAttribute(Ve.a.aC,zb.aC);Ed.setAttribute(Ve.a.count,zb.objectCount.toString());const de=Gf.a(zb.dataType);Ed.setAttribute(Ve.a.type,de);Ed.setAttribute(Ve.a.location,zb.location);Ed.setAttribute(Ve.a.Fx,zb.Fx);this.uh.contentWindow.document.body.appendChild(Ed);this.b0f.wUa(this.uh);this.n_b.copy(this.uh)}else f.ULS.sendTraceTag(512508576,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(Ed){f.ULS.sendTraceTag(512508575,
832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",Ed)}return!0}p4l(){return(h.AFrameworkApplication.fD||h.AFrameworkApplication.RA)&&!h.AFrameworkApplication.ZSa}dispose(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&this.okl();this.NWn()}static Zwc(Z){return Z?Z.RevisionID?Z.RevisionID:Z.revisionID?Z.revisionID:"":null}static q_n(Z,Ka,zb){const dc=Date.now();try{JSON.parse(Z.data.responseData).IsCopied?
f.ULS.sendTraceTag(512508574,832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",dc-Ka,zb):f.ULS.sendTraceTag(512508573,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",dc-Ka,zb)}catch(Jc){f.ULS.sendTraceTag(512508572,832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",Jc,zb)}}static p_n(Z,Ka,zb){const dc=Date.now();f.ULS.sendTraceTag(512508571,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",
dc-Ka,Z.data?Z.data.Ze:-1,zb)}static N8m(){const Z=l.a.instance.yb("Common.ISystemInitiatedFeedback");Z?(Z.logActivity("VersionHistoryExited",null),Z.logActivity("VersionHistoryCheckExited",null)):f.ULS.sendTraceTag(512508570,822,50,"ISystemInitiatedFeedback was null")}static unn(){const Z=l.a.instance.yb("Common.ISystemInitiatedFeedback");Z?Z.logActivity("VersionHistoryExited",null):f.ULS.sendTraceTag(512508569,822,10,"ISystemInitiatedFeedback was null")}}Object(c.a)(Rf,"VersionHistoryPaneActor",
null,[1336,24]);class xf{constructor(){this.S9g=this.Ha=null}get name(){return"PowerPointWebEditor.VersionHistory"}lc(Z){this.Ha=Z}init(){h.AFrameworkApplication.ga.fg(Object(e.a)(this,this.su,"onFullAppSettingsReady"))}su(){h.AFrameworkApplication.ZVf()?this.Ha.resolve("PowerPointWebEditor.IApplicationSettings").vTd?f.ULS.sendTraceTag(507843211,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected"):(f.ULS.sendTraceTag(507843210,
202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),uc.a.get_instance().$i(7,()=>{Rg.a(this.Ha)("versionHistory").catch(Z=>f.ULS.sendTraceTag(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",Z)).then(()=>this.Rsn()).catch(Z=>f.ULS.sendTraceTag(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",Z))})):f.ULS.sendTraceTag(507843212,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}Rsn(){this.zzd();
return null}zzd(){this.Ha.register(Rf,"PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor").na(()=>new Rf(h.AFrameworkApplication.vb,this.Ha.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.Ha.resolve("Common.Utils.IHighContrastDetector"),this.Ha.resolve("PowerPointWebEditor.IApplicationSettings"),this.Ha.resolve("PowerPointWebEditor.IPresentationReader"),bb.FocusManager.instance(),qf.a.instance,this.Ha.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.Ha.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Ha.resolve("PowerPointWebEditor.IPopWebService"),this.Ha.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Ha.Na("PowerpointPresence.IPresenceManager"),this.Ha.resolve("PowerPointWebEditor.IClipServiceManager"),this.Ha.resolve("PowerPointWebEditor.IDesignModeManager").CSa,this.Ha.resolve("PowerPoint.IBrowserHelperManager"),this.Ha.resolve("PowerPointWebEditor.ISystemClipboard"),h.AFrameworkApplication.ye)).ma();this.S9g=this.Ha.resolve("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor");
this.S9g.Hb()}dispose(){this.S9g&&this.S9g.dispose()}}Object(c.a)(xf,"PPTWebEditorVersionHistoryPackageManager",null,[3,4]);var zj=a(707),si=a(1389),rj;(function(Z){Z[Z.anyone=0]="anyone";Z[Z.organization=1]="organization"})(rj||(rj={}));Object(c.b)("AccessControlEnum",rj);var Rk=a(474);class Cg{constructor(){this.token=this.timeStamp=null}}Object(c.a)(Cg,"CachedAccessToken",null,[]);class zh{constructor(Z){this.QBj={};this.Ibn=Z}Xvm(Z,Ka){if(!Va.a.rb(Z)&&!Va.a.rb(Ka)){const zb=new Cg;zb.token=Ka;
zb.timeStamp=new Date;this.QBj[Z]=zb}}Vtl(Z){return Z in this.QBj&&(Z=Object(v.a)(Cg,this.QBj[Z]),+new Date-+Z.timeStamp<6E4*this.Ibn)?Z.token:null}}Object(c.a)(zh,"AccessTokenCache",null,[]);class Ih{constructor(){this.reject=this.resolve=this.frame=this.pCb=this.J_k=this.resource=this.appId=this.authority=this.id=null;this.bse=0;this.crk=null;this.mDg=0;this.z8l=!1}}Object(c.a)(Ih,"DirectAuthRequest",null,[]);class xj{constructor(Z){this.Mdg={};this.la=Z;this.uMc=new zh(this.la.wUl);window.addEventListener("message",
Object(e.a)(this,this.vHn,"requestCompletionMessageHandler"),!1)}Pul(Z){const Ka={},zb=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let dc;for(;dc=zb.exec(Z);)Ka[Object(v.a)(String,dc[1])]=Object(v.a)(String,dc[2]);return Ka}vHn(Z){if("data"in Z){let Ka=Eb.d(Z.data);({BD:Z}=Ka);Ka.returnValue&&Z&&"DirectAuthRequestID"in Z&&this.mDe(Z)}}mDe(Z){try{const dc=Z.DirectAuthRequestID;if(dc in this.Mdg){var Ka=null,zb=Object(v.a)(Ih,this.Mdg[dc]);if(zb&&zb.id===dc){D.a.J(507843535,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",
dc,"Timeouted"in Z,"FromPolling"in Z);window.clearTimeout(zb.bse);delete this.Mdg[dc];window.clearTimeout(zb.mDg);const Jc=new Rk.a;Jc.IsSuccess=!1;Jc.ErrorCode="";Jc.ErrorMessage="";Jc.Token="";"Timeouted"in Z?(D.a.J(507843534,833,10,"DirectAuth: Request timed out with host: "+window.location.host),Jc.ErrorCode="Timeout",Jc.ErrorMessage="No response received in time for the authentcation request",zb.resolve(Jc)):"PopupWindowClosed"in Z&&zb.pCb?(Jc.ErrorCode="User_aborted",Jc.ErrorMessage="User aborted log in by closing the popup window",
zb.resolve(Jc)):(zb.frame?Ka=this.Pul(zb.frame.contentWindow.location.hash):zb.pCb&&!zb.pCb.closed&&(Ka=this.Pul(zb.pCb.location.hash)),"access_token"in Ka?(Jc.IsSuccess=!0,Jc.Token=Object(v.a)(String,Ka.access_token),this.uMc&&this.uMc.Xvm(zb.crk,Jc.Token),zb.resolve(Jc)):(Jc.ErrorCode="error"in Ka?Object(v.a)(String,Ka.error):"unknown",0<=Array.indexOf(this.la.yUl,Jc.ErrorCode)&&zb.z8l&&zb.frame&&!zb.pCb?this.Gwn(zb.authority,zb.appId,zb.resource,zb.J_k,this.la.zUl).then(jd=>{zb.resolve(jd)}).catch(jd=>
{zb.reject(jd)}):(Jc.ErrorMessage="error_description"in Ka?Object(v.a)(String,Ka.error_description):"unknown",zb.resolve(Jc))));zb.frame?document.body.removeChild(zb.frame):zb.pCb&&!zb.pCb.closed&&zb.pCb.close()}else D.a.J(507843533,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",dc)}else D.a.J(507843536,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(Z))}catch(dc){D.a.J(507843532,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+
dc.message)}}fll(){const Z=window.location.protocol,Ka=window.location.host;var zb="/p/";D.a.J(507843531,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",Z,Ka,"ffc-powerpoint.officeapps.live.com"===Ka||"ppc-powerpoint.officeapps.live.com"===Ka);if(void 0===zb||null===zb){zb=window.location.pathname;const dc=zb.lastIndexOf("/");zb=0<=dc?zb.substring(0,dc+1):""}return Z+"//"+Ka+zb+"WacDirectAuth.html"}OVn(Z,Ka,zb,dc,Jc,jd){return this.SQn(Z,Ka,zb,dc,Jc,void 0===
jd?!1:jd)}Gwn(Z,Ka,zb,dc,Jc){if(Va.a.rb(Z))throw Error.argumentNull("authority");if(Va.a.rb(Ka))throw Error.argumentNull("appId");if(Va.a.rb(zb))throw Error.argumentNull("resource");if(Va.a.rb(dc))throw Error.argumentNull("userUPN");const jd=!Va.a.rb(dc)&&dc.indexOf("@")<dc.indexOf("."),Ed=this.fll(),de=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",Z,Ka,encodeURIComponent(zb),encodeURIComponent(Ed));
if(this.uMc){const Cf=this.uMc.Vtl(de);if(!Va.a.rb(Cf))return D.a.J(507843530,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(yg=>{const bh=new Rk.a;bh.IsSuccess=!0;bh.ErrorCode="";bh.ErrorMessage="";bh.Token=Cf;yg(bh)})}const Ne=Di.a.create().toString(),Re=String.format("{0}&state={1}",de,Ne);return new Promise((Cf,yg)=>{const bh=new Ih;bh.authority=Z;bh.appId=Ka;bh.resource=zb;bh.J_k=dc;bh.resolve=Cf;bh.reject=yg;bh.id=Ne;bh.crk=de;bh.pCb=window.open("",Ne,"width=400, height=600");
bh.pCb?(this.Mdg[Ne]=bh,bh.pCb.location.replace(Re),D.a.J(507843528,833,50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",Ne,jd),this.l6l(bh,1E3*Jc).then(()=>{const Ah={};Ah.DirectAuthRequestID=Ne;Ah.FromPolling=!0;this.mDe(Ah)}).catch(Ah=>{"WindowClosed"===Object(v.a)(String,Ah)&&(Ah={},Ah.DirectAuthRequestID=Ne,Ah.PopupWindowClosed=!0,D.a.J(507843527,833,10,"DirectAuth: Popup window closed for request with ID of: "+Ne),this.mDe(Ah))}),bh.bse=window.setTimeout(()=>{const Ah=
{};Ah.DirectAuthRequestID=Ne;Ah.Timeouted=!0;D.a.J(507843526,833,10,"DirectAuth: Popup request timedout with ID of: "+Ne);this.mDe(Ah)},1E3*Jc)):(D.a.J(507843529,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",Ne),yg=new Rk.a,yg.IsSuccess=!1,yg.ErrorCode="fail_to_open_popup",yg.ErrorMessage="Failed to create popup window!",yg.Token="",Cf(yg))})}SQn(Z,Ka,zb,dc,Jc,jd){if(Va.a.rb(Z))throw Error.argumentNull("authority");if(Va.a.rb(Ka))throw Error.argumentNull("appId");
if(Va.a.rb(zb))throw Error.argumentNull("resource");if(Va.a.rb(dc))throw Error.argumentNull("userUPN");const Ed=!Va.a.rb(dc)&&dc.indexOf("@")<dc.indexOf(".");var de=this.fll();const Ne=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",Z,Ka,encodeURIComponent(zb),encodeURIComponent(de));if(this.uMc){const yg=this.uMc.Vtl(Ne);if(!Va.a.rb(yg))return D.a.J(507843525,833,50,"DirectAuth: Found valid cached token and use it!"),
new Promise(bh=>{const Ah=new Rk.a;Ah.IsSuccess=!0;Ah.ErrorCode="";Ah.ErrorMessage="";Ah.Token=yg;bh(Ah)})}const Re=Di.a.create().toString();de=Ed?String.format("{0}&login_hint={1}&state={2}",Ne,encodeURIComponent(dc),Re):String.format("{0}&state={1}",Ne,Re);const Cf=document.createElement("iframe");Cf.style.display="none";Cf.src=de;return new Promise((yg,bh)=>{const Ah=new Ih;Ah.authority=Z;Ah.appId=Ka;Ah.resource=zb;Ah.J_k=dc;Ah.frame=Cf;Ah.resolve=yg;Ah.reject=bh;Ah.id=Re;Ah.crk=Ne;Ah.z8l=jd;document.body.appendChild(Cf);
D.a.J(507843524,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",Re,Ed);this.l6l(Ah,1E3*Jc).then(()=>{const Ui={};Ui.DirectAuthRequestID=Re;Ui.FromPolling=!0;this.mDe(Ui)});Ah.bse=window.setTimeout(()=>{const Ui={};Ui.DirectAuthRequestID=Re;Ui.Timeouted=!0;D.a.J(507843523,833,10,"DirectAuth: Silent request timedout with ID of: "+Re);this.mDe(Ui)},1E3*Jc);this.Mdg[Re]=Ah})}l6l(Z,Ka){return new Promise((zb,dc)=>{const Jc=Ka/50;let jd=0;Z.mDg=window.setInterval(()=>
{try{jd++>Jc&&(window.clearInterval(Z.mDg),D.a.J(507843522,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",Ka,Jc),dc(""));const Ed=Z.frame?Z.frame.contentWindow:Z.pCb;if(!Ed||Ed.closed)window.clearInterval(Z.mDg),D.a.J(507843521,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),dc("WindowClosed");let de=null,Ne=null;try{de=Ed.location.href,Ne=Ed.location.hash}catch(Re){}de&&"about:blank"!==de?Va.a.rb(Ne)||(window.clearInterval(Z.mDg),
zb(Ne)):D.a.J(507843520,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===de)}catch(Ed){D.a.J(507843491,833,15,"DirectAuth: WindowHashPoller: threw exception {0}",Ed.message)}},50)})}}Object(c.a)(xj,"DirectAuthHelper",null,[]);class pm{constructor(){this.welcomeScreenErrorImageUrl=this.welcomeScreenBackgroundImageUrl=this.hostElement=null;this.urlBarHeightInPercentage=this.baseZIndex=0;this.reactionsBarLayerHostId=this.dialogLayerHostId=this.urlBarLayerHostId=
this.calloutContainerId=this.welcomeScreenLayerHostId=null;this.isPowerpointLiveReactionEnabled=this.showTryAgainButton=!1;this.resourceCDNPath=this.onboardingScreenHostId=null;this.enableNewLiveWelcomeScreen=this.enablePrefetchLiveResource=!1;this.podsUrl=this.userSessionId=null}}Object(c.a)(pm,"ILiveActorSettings",null,[]);class gk{constructor(){this.react=null;this.reactionCount=0;this.reactionImagePath=null;this.numberOfAnimationFrames=0}}Object(c.a)(gk,"ILiveReaction",null,[]);class xl{constructor(){this.isPaused=
this.isPrivate=!1;this.participantsCount=0;this.sessionURLPromise=null;this.sessionCurrentState=0}}Object(c.a)(xl,"ILiveSessionState",null,[]);class Wl{constructor(){this.sessionQRCode=this.participantUrl=null}}Object(c.a)(Wl,"ILiveSessionURL",null,[]);class vm{constructor(){this.XKl=this.WKl=null}}Object(c.a)(vm,"PollObjectInfo",null,[]);var cm;(function(Z){Z[Z.none=0]="none";Z[Z.singleLineRibbon=1]="singleLineRibbon";Z[Z.multipleLineRibbon=2]="multipleLineRibbon";Z[Z.slideShowToolbar=3]="slideShowToolbar";
Z[Z.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";Z[Z.welcomeScreenTryAgain=5]="welcomeScreenTryAgain"})(cm||(cm={}));Object(c.b)("LiveEntryPoint",cm);var Sk;(function(Z){Z[Z.none=0]="none";Z[Z.callout=1]="callout";Z[Z.businessBar=2]="businessBar";Z[Z.pausedSessionTimeout=3]="pausedSessionTimeout";Z[Z.slideshowContextMenu=4]="slideshowContextMenu";Z[Z.accessControlChange=5]="accessControlChange";Z[Z.welcomeScreenTryAgain=6]="welcomeScreenTryAgain"})(Sk||(Sk={}));Object(c.b)("LiveExitPoint",
Sk);var jj=a(1124);class Vj{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah){this.ua=new Ad.a;this.gGc=this.BGe=this.znh=this.zEj=this.pIl=!1;this.z4f=this.wEj=this.Bnh=!0;this.Slg=this.UHe=!1;this.ry=this.Vv=this.RUb=this.CF=null;this.s$c=0;this.$Ge=-1;this.AHe=30;this.Fbg=-1;this.Ng=this.hZb=this.P1a=null;this.JLl=this.RMl=this.Mph=this.Kph=0;this.E_f=this.Nbc=this.o$c=null;this.RIj=this.EYd=0;this.wpe=null;this.dQj=new Set;this.cQj=new Map;this.zoh=null;this.Icg=1;this.Ebg=this.rGe=this.eL=
this.zAa=this.$Qj=this.yDj=null;this.rf=dc;this.la=Z;this.tIl=!1;this.vd=zb;this.oc=jd;this.mr=Ed;this.od=de;this.oR=Ne;this.nb=Re;null===Cf||void 0===Cf?void 0:Cf.execute(Ui=>{this.qf=Ui});this.Su=yg;this.opb=bh;this.Ma=Ah;if(this.lr=Ka)this.RUb=Ka.sP();this.jta=Jc;this.s$c=this.krl?1:0;this.la.nbb&&(this.yDj=new xj(this.la));this.od.VG(Object(e.a)(this,this.qta,"onPodSessionRehydrated"));this.oR.waf(Object(e.a)(this,this.Wbd,"onPodSessionUnavailable"));this.d7c()&&this.Su.execute(Ui=>{Ui.show(ResourceStrings.L_LivePresentations_Disconnected,
jj.a.Ibd);Ui.hide()});D.a.J(512496260,833,50,"LivePresenter: Host auth type is: "+this.la.hostAuthType)}get XM(){return this.la.nbb&&this.Bnh}get gEd(){return this.zEj}set gEd(Z){(this.zEj=Z)&&this.ua.raiseEvent("OnLiveResourcesLoaded",Sys.EventArgs.Empty)}get PK(){return!!this.ry}get Wzb(){return this.tIl}set Wzb(Z){this.tIl=Z}get oac(){return this.pIl}set oac(Z){this.pIl=Z}get Rtc(){return!!this.ry&&this.ry.isPaused}get mIm(){return this.znh}get Ttc(){return this.z4f}set Ttc(Z){this.z4f=Z}get eIm(){return this.gEd&&
this.XM&&!!this.CF}get accessControl(){return this.s$c}set accessControl(Z){this.s$c=Z}get krl(){return"true"===this.gwl("wdDisablePrivateSession")?!1:"aad"===this.la.hostAuthType}get hrl(){return this.XM&&this.PK&&this.Vv?this.Vv.isWelcomeScreenVisible():!1}MBe(){return this.la.mTd&&this.la.BEg&&this.qf.Pvf?this.qf.PBe?this.Slg=!0:this.qf.orl||this.Slg:!0}ash(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne){if(this.XM){this.vd.b1h(Object(e.a)(this,this.FRl,"onSlideShowEnterEndOfShow"));this.vd.k1h(Object(e.a)(this,this.GRl,
"onSlideShowLeaveEndOfShow"));this.vd.oaf(Object(e.a)(this,this.$0b,"onGetCurrentSlideDimensionsHandler"));this.BGe=!1;this.gGc=!0;try{this.la.LDg&&this.eLm();const Re=this.kQi(Jc,dc);if(this.CF)(this.oac||this.Rtc)&&this.CF.FetchDocumentDownloadURL(Re);else{D.a.J(512496259,833,50,"Creating Broadcast monitor ...");const Cf=new PowerPointLive.PPTBroadcastMonitorSettings;Cf.isBlueChicken=this.la.isBlueChicken;Cf.fileDownloadUrl=Re;Cf.rendezvousSvcBaseUri=this.la.Jde;Cf.broadcastSubtitlesFromSpeechFrontDoor=
!0;Cf.pragueInitTimeoutInMS=this.la.BUl;Cf.preferredSubtitleLanguage=this.qf.AIf();Cf.useStateService=this.la.KUl;Cf.numMaxAttempts=this.la.EUl;Cf.delayInSecsToCloseBroadcasterOnPause=this.la.vUl;Cf.batchedRequestsEnabled=this.la.sUl;Cf.sharedSessionSettings={};Cf.websocketAliveTimeAfterLoseFocusInMs=this.la.LUl;Cf.pingTimeoutInMs=this.la.CUl;Cf.pongTimeoutInMs=this.la.DUl;Cf.enableTransientSessionHandling=this.la.XUl;Cf.maxStateServiceRoundtripRaw=h.AFrameworkApplication.ga.Jc("PPTLiveMaxStateServiceRoundtripRaw",
300);Cf.sharedSessionSettings.MaxStateServiceRoundtripRaw=Cf.maxStateServiceRoundtripRaw;Cf.documentSnapshotRequestUrlGenerator=this.la.UUl?()=>this.kQi(this.nb.podSessionId,this.nb.rp):null;this.la.X8j&&(Cf.sharedSessionSettings.IsAutomation=!0);this.CF=new PowerPointLive.PPTBroadcastMonitor(Cf);this.CF.RegisterParticipantsCountChangeEventListener(yg=>{this.Ng.telemetryData.maxParticipantCount=Math.max(this.Ng.telemetryData.maxParticipantCount,yg);this.Vv&&this.Vv.setParticipantCount(yg);this.ua.raiseEvent("ParticipantsCountChanged",
Sys.EventArgs.Empty)});this.CF.RegisterNewReactionEventListener(Object(e.a)(this,this.Pmn,"newReactionHandler"));this.CF.RegisterConnectionStateEventListener(Object(e.a)(this,this.hzm,"connectionStateHandler"))}this.CF.SetCurrentPosition(Z,Ka-1,null);this.EYd=Z;this.oac&&!this.ry&&Ne?(this.tWg(h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.Cx?1:2,Ed,zb,Jc,de),this.rym(Z),this.Nbc=new Set):this.P1a&&this.yDe();this.Nbc&&this.Nbc.add(Z)}catch(Re){D.a.J(512496258,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",
Re.toString())}}}DVn(){window.setTimeout(()=>{const Z=this.EYd===this.RIj;this.XM&&this.PK&&Z&&this.ry&&!this.ry.isPaused&&(D.a.J(512496257,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),this.ozh(0),this.EOe(0))},6E4*this.la.GUl)}nsn(){this.XM&&(this.vd.Pok(Object(e.a)(this,this.FRl,"onSlideShowEnterEndOfShow")),this.vd.Vok(Object(e.a)(this,this.GRl,"onSlideShowLeaveEndOfShow")),this.vd.FKg(Object(e.a)(this,this.$0b,"onGetCurrentSlideDimensionsHandler")),this.gGc=
this.BGe=!1,this.PK&&this.Vv&&(this.Vv.hideAll(),this.ipj()||(this.Lun(),this.aQn()),this.d7c()&&this.Su.instance.hide()))}hSn(Z,Ka,zb,dc,Jc,jd){try{const Ed=new PowerPointLive.RendezvousSessionConfig;Ed.userSessionId=Z;Ed.webServiceBase=Ka;Ed.podSessionId=zb;Ed.docId=dc;Ed.sessionId=Jc;Ed.accessControl=1===this.s$c?"organization":"anyone";Ed.authTokenFunc=jd;Ed.locale=h.AFrameworkApplication.uiCulture;Ed.presentationName=Va.a.r$(h.AFrameworkApplication.fileName);Ed.slideHeight=this.oc.lB().height;
Ed.slideWidth=this.oc.lB().width;Ed.correlationId=this.Ng.telemetryData.correlationId;Ed.showQRCodeAfterFetchingDocDownloadUrl=this.la.dVl;Ed.presenterTenantId=!this.la.isBlueChicken&&this.la.gak?h.AFrameworkApplication.ga.La("TenantId"):null;Ed.fileSource=h.AFrameworkApplication.ga.La("FileHost");this.la.IUl||(Ed.fileName=h.AFrameworkApplication.fileName,Ed.bootstrapperUrl=this.la.hKe);const de=this.CF.StartLiveBroadcasting(Ed,this.Ng,!this.la.Ssh);this.e2m();if(de){this.ry=new xl;this.ry.isPrivate=
1===this.s$c;this.ry.isPaused=!1;this.ry.participantsCount=0;this.ry.sessionCurrentState=0;const Ne=de.then(Re=>{const Cf=new Wl;Cf.participantUrl=Re.sessionInfo.shortParticipantUrl;Cf.sessionQRCode=Re.sessionInfo.sessionQRCode;this.ry.sessionCurrentState=1;return Cf});this.ry.sessionURLPromise=Ne;this.la.CEg?this.Ebg.then(()=>{this.Vv.actOnSessionRequested(this.ry)}):this.Vv.actOnSessionRequested(this.ry);this.vd.Wah(Object(e.a)(this,this.HRl,"onSlideShowReady"));this.vd.dfl(Object(e.a)(this,this.cSl,
"onTranscriberStarted"));this.vd.o1h(Object(e.a)(this,this.WQl,"onPodSessionExpired"));de.then(Re=>{this.Ng.telemetryData.pragueDocId=Re.sessionInfo.pragueDocId;this.Ng.telemetryData.sessionCreationWebServiceCallTimeInMS=this.xca()-this.Mph;this.Ng.telemetryData.startAttemptCount=Re.numAttempt;D.a.J(512496256,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",this.Ng.telemetryData.sessionId,this.Ng.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());this.la.Ssh?
(this.tQg(),this.CF.InitializeStateService().then(()=>{this.q3l(Re);this.B1a("StartLiveBroadcasting")}).catch(Cf=>{this.Ng.telemetryData.sessionEndedBeforePragueInitialized||this.Ng.telemetryData.sessionId!==Jc||(D.a.J(512496227,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",this.Ng.telemetryData.sessionId,Cf?Cf.toString():""),this.Ng.telemetryData.SetErrorCode(2,Cf?Cf.toString():""),this.B1a("StartLiveBroadcasting"),this.uxh())})):this.q3l(Re);this.la.WUl&&
$addHandler(window,"visibilitychange",Object(e.a)(this,this.crn,"onPageVisibilityChangedHandler"));this.B1a("StartLiveBroadcasting")}).catch(Re=>{D.a.J(512496226,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",this.Ng.telemetryData.sessionId,Re.toString());this.Ng.telemetryData.SetErrorCode(4,Re.toString());this.B1a("StartLiveBroadcasting");this.uxh()})}else this.uxh(),this.Ng.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),D.a.J(512496225,
833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(Ed){this.uxh(),this.Ng.telemetryData.SetErrorCode(4,Ed.toString()),D.a.J(512496224,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",this.Ng.telemetryData.sessionId,Ed.toString())}finally{this.B1a("StartLiveBroadcasting")}}q3l(Z){const Ka=this.qf.KMm(this.qf.Ybb);Ka?this.CF.SetDefaultSubtitlesLanguage(Ka):D.a.J(512496223,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",
this.Ng.telemetryData.sessionId);this.vd.sOe(!0,this.CF.GetPragueSessionInfoJSONString());this.vd.$9b(Object(e.a)(this,this.Czg,"onSlideShowPositionChanged"));this.vd.cfl(Object(e.a)(this,this.NRl,"onSubtitleUpdated"));this.la.Ssh&&!this.Vv.isWelcomeScreenVisible()||this.tQg();this.ua.raiseEvent("OnLiveSessionStarted",Z.sessionInfo);this.MBe()||!this.qf.Pvf||this.qf.orl||this.Slg||!this.d7c()||(this.UHe=!0,this.Su.instance.show(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",
fj.a.Ne(h.AFrameworkApplication.uiCulture).displayName),jj.a.Ibd));this.E_f=this.CF.CreateSurvey(Z.authToken,null,null,null);this.E_f.then(zb=>{if(zb){const dc={};dc.surveyeeName=h.AFrameworkApplication.userName;dc.surveyId=zb.surveyId;dc.surveyResponseUrl=zb.surveyResponseUrl;this.CF.SetAudienceFeedbackInfo(JSON.stringify(dc))}});this.la.LDg&&(this.cQj.clear(),this.dQj.forEach(zb=>{try{const dc=zb.WKl;this.CF.CreateSurvey(Z.authToken,null,dc,zb.XKl).then(Jc=>{Jc?this.cQj.set(dc,Jc.surveyId):D.a.J(512496222,
833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",this.Ng.telemetryData.sessionId)}).catch(Jc=>{D.a.J(512496221,833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",this.Ng.telemetryData.sessionId,Jc.toString());this.Ng.telemetryData.SetErrorCode(13,Z.toString())})}catch(dc){D.a.J(512496220,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",this.Ng.telemetryData.sessionId,dc.toString())}}));
this.opb.init()?this.opb.Gye(Object(e.a)(this,this.Ubd,"onNetworkConnectivityChanged")):D.a.J(512496219,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",this.Ng.telemetryData.sessionId)}gwl(Z){Z=new RegExp(String.format("[\\?&]{0}=([^&#]*)",Z));return(Z=window.location.search.match(Z))&&2===Z.length?Z[1]:""}tWg(Z,Ka,zb,dc,Jc){this.$Qj=Ka;this.zAa=zb;this.eL=dc;this.rGe=Jc;this.Mph=this.xca();this.Kph=this.xca();var jd=this.gwl("wdSetLiveSessionId");jd="rdvSession_"+(jd.length?
jd:Di.a.create().toString());this.Ng=new PowerPointLive.LiveSessionTelemetry;this.Ng.telemetryData.sessionId=jd;this.Ng.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Ng.telemetryData.accessControl=rj[this.s$c];this.Ng.telemetryData.sessionEntryPoint=cm[Z];this.Ng.telemetryData.isSubtitleStartedByLive=this.Wzb;this.Ng.telemetryData.isAutomation=this.la.X8j;this.Ng.telemetryData.correlationId=Di.a.create().toString();this.B1a("StartLiveBroadcasting");try{this.XM&&
this.CF&&this.muf()&&!this.ry?(this.n9m(),this.vd.naf(Object(e.a)(this,this.aQl,"onGetCurrentSlideShowPosition")),this.vd.getCurrentPosition(),this.ZBi()&&this.Vv&&this.Ebg&&this.Ebg.then(()=>{this.Vv.showOnboardingScreen();this.W0k=!0}),this.hSn(Ka,zb,dc,Jc,jd,()=>this.Xzf("StartLiveBroadcasting",this.Ng.telemetryData.sessionId))):(this.Ng.telemetryData.SetErrorCode(4,"Live actor or broadcast monitor is null while trying to start live session!"),D.a.J(512496218,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")),
this.Ng.telemetryData.isMordernSlideShow=!!this.vd&&this.vd instanceof si.a}catch(Ed){this.Ng.telemetryData.SetErrorCode(4,Ed.toString()),D.a.J(512496217,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",this.Ng.telemetryData.sessionId,Ed.toString())}finally{this.B1a("StartLiveBroadcasting")}}Lun(){if(this.XM&&this.PK&&this.CF&&this.muf()&&!this.ry.isPaused){this.ozh(2);this.EOe(2);try{this.Ng.telemetryData.sessionPauseCount+=1,this.Ng.telemetryData.sessionActiveDurationInMS+=
this.xca()-this.Kph,D.a.J(512496216,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.Ng.telemetryData.sessionId),this.Vv.actOnSessionPaused(),this.ry.isPaused=!0,this.JLl=this.xca(),this.CF.PauseLiveBroadcasting(()=>this.Xzf("PauseLiveBroadcasting",this.Ng.telemetryData.sessionId)),this.ua.raiseEvent("OnLiveSessionPaused",Sys.EventArgs.Empty),this.lSn(),this.vd.sOe(!1)}catch(Z){this.Ng.telemetryData.SetErrorCode(5,Z.toString()),D.a.J(512496215,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",
this.Ng.telemetryData.sessionId,Z.toString())}finally{this.B1a("PauseLiveBroadcasting")}}}I_l(){if(this.XM&&this.PK&&this.CF&&this.muf()&&this.ry.isPaused)try{this.Kph=this.xca(),this.Ng.telemetryData.sessionResumeCount+=1,D.a.J(512496214,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",this.Ng.telemetryData.sessionId),this.r_l(),this.Vv.actOnSessionResumed(),this.CF.ResumeLiveBroadcasting(()=>this.Xzf("ResumeLiveBroadcasting",this.Ng.telemetryData.sessionId)),this.ry.isPaused=!1,this.ua.raiseEvent("OnLiveSessionResumed",
Sys.EventArgs.Empty),this.DMk(),this.vd.sOe(!0,this.CF.GetPragueSessionInfoJSONString())}catch(Z){this.Ng.telemetryData.SetErrorCode(6,Z.toString()),D.a.J(512496213,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",this.Ng.telemetryData.sessionId,Z.toString())}finally{this.B1a("ResumeLiveBroadcasting")}}Htf(Z){if(this.XM&&this.PK&&this.CF&&this.muf()){this.EOe(3);try{this.sVn(Z,()=>{this.Ng.telemetryData.sessionExitPoint=Sk[Z];this.ry.isPaused||(this.Ng.telemetryData.sessionActiveDurationInMS+=
this.xca()-this.Kph);this.P1a&&this.yDe();this.DMk();this.d7c()&&this.Su.instance.hide();D.a.J(512496212,833,50,"SessionId: {0}, Message: End live broadcasting ...",this.Ng.telemetryData.sessionId);this.Vv.actOnSessionEnded();this.vd.suh(Object(e.a)(this,this.HRl,"onSlideShowReady"));this.vd.OUc(Object(e.a)(this,this.Czg,"onSlideShowPositionChanged"));this.vd.hZl(Object(e.a)(this,this.NRl,"onSubtitleUpdated"));this.vd.iZl(Object(e.a)(this,this.cSl,"onTranscriberStarted"));this.opb.ouh(Object(e.a)(this,
this.Ubd,"onNetworkConnectivityChanged"));this.vd.Yok(Object(e.a)(this,this.WQl,"onPodSessionExpired"));this.gGc&&this.vd.sOe(!1);this.E_f=this.ry=null;this.ua.raiseEvent("OnLiveSessionEnded",Sys.EventArgs.Empty);this.la.BEg&&this.qf.Pvf&&(this.Slg=this.UHe=!1);if(3!==Z){const Ka=this.CF.EndLiveBroadcasting(()=>this.Xzf("EndLiveBroadcasting",this.Ng.telemetryData.sessionId));Ka?Ka.then(()=>{this.B1a("EndLiveBroadcasting");D.a.J(512496211,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",
this.Ng.telemetryData.sessionId)}).catch(zb=>{this.Ng.telemetryData.SetErrorCode(7,zb.toString());this.B1a("EndLiveBroadcasting");D.a.J(512496210,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",this.Ng.telemetryData.sessionId,zb.toString())}):(this.Ng.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),D.a.J(512496209,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else this.CF.CleanUpBroadcastBeforeEnd(),
D.a.J(512496208,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");this.B1a("EndLiveBroadcasting")})}catch(Ka){this.Ng.telemetryData.SetErrorCode(7),D.a.J(512496207,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",this.Ng.telemetryData.sessionId,Ka.toString())}finally{3!==Z&&this.Cxb(),this.B1a("EndLiveBroadcasting")}}}C2l(){this.XM&&this.CF&&this.CF.SetPresenterState("muted")}D2l(){this.XM&&this.CF&&this.CF.SetPresenterState("unmuted")}showCallout(Z){this.XM&&
this.Vv&&(this.znh=!0,this.Vv.showCallout(Z))}showWelcomeScreen(){this.XM&&this.Vv&&(this.Vv.showWelcomeScreen(),this.YAk())}showEndSessionDialog(Z,Ka){this.XM&&this.PK&&this.Vv&&this.Vv.showEndSessionDialogWithCallbacks(Z,Ka)}uxh(){this.Vv.isWelcomeScreenVisible()||this.ry.isPaused||this.showWelcomeScreen();this.ry=null;this.Vv.onSessionRequestError()}muf(){if(this.XM&&!this.Vv&&this.RUb){const Z=new pm;Z.hostElement=this.RUb;Z.baseZIndex=50005;Z.welcomeScreenBackgroundImageUrl=this.rf.Yp("LiveWelcomeScreenBackground.png");
Z.welcomeScreenErrorImageUrl=this.rf.Yp("LiveWelcomeScreenError.png");Z.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";Z.calloutContainerId="LiveCalloutContainer";Z.urlBarLayerHostId="LiveURLBarLayerHost";Z.dialogLayerHostId="LiveDialogLayerHost";Z.reactionsBarLayerHostId="LiveReactionBarLayerHost";Z.showTryAgainButton=!0;Z.isPowerpointLiveReactionEnabled=!rb.a("PPTLive.ReactionToggleInLiveCallout");Z.onboardingScreenHostId="LiveOnboardingScreenLayerHost";Z.resourceCDNPath=this.la.Ocd;Z.enablePrefetchLiveResource=
this.la.CEg;Z.enableNewLiveWelcomeScreen=this.la.CEg;Z.userSessionId=this.$Qj;Z.podsUrl=this.zAa;this.Vv=liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(Z);this.Vv.on("OnWelcomeScreenOpenedAction",()=>{this.mXc("LiveWelcomeScreenLayerHost");this.YAk();this.RMl=Date.now();this.Ng.telemetryData.welcomeShownCount+=1});this.Vv.on("OnWelcomeScreenClosedAction",()=>{this.BGe&&this.Vv.hideURLBar();this.Wjl();this.vd.jda();this.Ng.telemetryData.welcomeScreenDurations.push(Date.now()-this.RMl);this.Ng.telemetryData.welcomeScreenFirstTimeDuration=
this.Ng.telemetryData.welcomeScreenDurations[0];this.B1a("OnWelcomeScreenClosedAction");this.CF.SetWelcomeScreenState(!1);this.la.LDg&&this.e8l();this.UHe&&this.d7c()&&window.setTimeout(()=>{this.Su.instance.hide();this.UHe=!1},5E3)});this.Vv.on("ResumeSessionAction",()=>{this.I_l();this.BGe||this.Vv.showURLBar()});this.Vv.on("EndSessionAction",()=>{this.Htf(this.gGc?1:2);this.vd.jda()});this.Vv.on("OnCalloutOpenedAction",()=>{this.znh=!0;this.ua.raiseEvent("OnCalloutOpened",Sys.EventArgs.Empty);
this.Ng.telemetryData.calloutShownCount+=1});this.Vv.on("OnCalloutClosedAction",()=>{this.znh=!1;this.ua.raiseEvent("OnCalloutDismissed",Sys.EventArgs.Empty);this.vd.jda()});this.Vv.on("OnEndSessionDialogOpenedAction",()=>{this.ULn()});this.Vv.on("OnEndSessionDialogClosedAction",()=>{this.aIn()});this.Vv.on("OnCalloutMenuDefinitionChangedAction",()=>{this.ua.raiseEvent("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty)});this.Vv.on("OnTryAgainAction",()=>{D.a.J(512496206,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",
this.Ng.telemetryData.sessionId);this.tWg(5,this.$Qj,this.zAa,this.eL,this.rGe)});this.Vv.on("PresenterDisabledReactions",()=>{this.wEj=!1});this.Vv.on("PresenterEnabledReactions",()=>{this.wEj=!0});this.Vv.on("OnOnboardingScreenOpenedAction",()=>{this.mXc("LiveOnboardingScreenLayerHost");this.YAk()});this.Vv.on("OnOnboardingScreenClosedAction",()=>{this.tQg()})}return!!this.Vv}tQg(){this.Vv&&(this.ZBi()&&this.Vv.isOnboardingScreenVisible()?this.mXc("LiveOnboardingScreenLayerHost"):this.Vv.isWelcomeScreenVisible()?
this.mXc("LiveWelcomeScreenLayerHost"):(-1!==this.Fbg&&this.Wjl(),this.vd.jda()))}D4m(){const Z=document.getElementById("LiveWelcomeScreenLayerHost"),Ka=document.getElementById("LiveOnboardingScreenLayerHost");let zb=!1;Z&&(zb=Z.contains(document.activeElement));return document.activeElement===Ka||document.activeElement===Z||zb}YAk(){this.Vv&&-1===this.Fbg&&(this.Fbg=window.setInterval(()=>{this.D4m()||this.tQg()},500))}Wjl(){window.clearInterval(this.Fbg);this.Fbg=-1}mXc(Z){this.RUb&&this.Vv&&window.setTimeout(()=>
{bb.FocusManager.UA(this.RUb.ownerDocument.getElementById(Z))},50)}ULn(){this.gGc?this.mXc("LiveDialogLayerHost"):(this.Ma.hEe(Fa.a.Rsh,Fa.a.vl,document.getElementById("LiveDialogLayerHost"),!0),this.Ma.lm(Fa.a.Rsh,!0))}aIn(){this.gGc?this.vd.jda():this.Ma.lm(Fa.a.Rsh,!1)}tyl(){this.la.BEg&&this.qf.Pvf&&(this.d7c()&&this.UHe&&(this.Su.instance.hide(),this.UHe=!1),this.Slg=!0)}n9m(){try{this.Ebg||!this.ZBi()&&!this.la.CEg||(this.Ebg=Rg.a(l.a.instance)("liveActorLazy"))}catch(Z){D.a.J(512496205,833,
10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.Ng.telemetryData.sessionId,Z.toString())}}HRl(){this.XM&&this.CF&&(this.Rtc?(window.setTimeout(()=>{this.ua.raiseEvent("OnRelaunchPausedSession",Sys.EventArgs.Empty)},500),this.I_l()):this.ry&&this.Vv&&this.Vv.isWelcomeScreenVisible()&&this.tQg())}Czg(Z,Ka){this.XM&&this.CF&&(this.CF.SetCurrentPosition(Ka.slideId,Ka.slideIndex,Ka.tfd),this.EYd!==Ka.slideId&&this.r_l(),this.EYd=Ka.slideId,this.Nbc&&(this.o$c&&
10>this.Icg&&10*this.Nbc.size>=this.Icg*this.o$c.size&&(this.EOe(4),this.Icg+=1),this.Nbc.add(Ka.slideId)),this.la.LDg&&this.e8l(),Z=!!this.o$c&&this.o$c.size>=this.la.FUl,this.EYd===this.RIj&&Z&&this.DVn())}FRl(){this.BGe=!0;this.XM&&this.PK&&this.Vv&&(this.Vv.hideURLBar(),this.ozh(1),this.EOe(1))}GRl(){this.BGe=!1;this.XM&&this.PK&&this.Vv&&this.Vv.showURLBar()}NRl(Z,Ka){this.XM&&this.PK&&this.CF&&(Ka.isFinal?this.CF.UpdateFinalSubtitles(Ka.WUn):this.CF.UpdatePartialSubtitles(Ka.WUn))}cSl(Z,Ka){this.Ng.telemetryData.transcriberSessionIds+=
Ka.Uyh+",";this.XM&&this.PK&&this.vd.sOe(!0,this.CF.GetPragueSessionInfoJSONString())}lSn(){D.a.J(512496204,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",this.Ng.telemetryData.sessionId);-1!==this.$Ge&&window.clearInterval(this.$Ge);this.AHe=30;this.$Ge=window.setInterval(Object(e.a)(this,this.Oun,"pausedSessionAutoExpireTimerCallBack"),6E4)}DMk(){-1!==this.$Ge&&(D.a.J(512496203,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",this.Ng.telemetryData.sessionId),window.clearInterval(this.$Ge),
this.$Ge=-1)}Oun(){--this.AHe;0>=this.AHe?(D.a.J(512496202,833,50,"SessionId: {0}, Ending long paused session.",this.Ng.telemetryData.sessionId),this.yDe(),this.Htf(3)):this.P1a&&(this.P1a.message=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.AHe.toString()))}aQn(){if(!this.P1a&&this.lr&&!h.AFrameworkApplication.mi&&0!==this.ry.sessionCurrentState){var Z=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.AHe.toString());Z=new zj.a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,
Z,null);Z.closeable=!0;Z.EV=Object(e.a)(this,this.uon,"onBusinessBarClosed");Z.image=3;Z.addButton(ResourceStrings.l_LiveBusinessBarButton_ResumeSession,Object(e.a)(this,this.won,"onBusinessBarResumeSessionButtonClicked"),"");Z.Dye(ResourceStrings.l_LiveBusinessBarButton_EndSession,Object(e.a)(this,this.von,"onBusinessBarEndSessionButtonClicked"),"");this.lr.businessBar.Vh(Z,!1);this.lr.ls();this.P1a=Z}}ipj(){var Z=6E4*this.la.aVl;Z=0<Z?this.xca()-this.Mph>=Z:!1;D.a.J(512496201,833,50,"LivePresenter::IsSessionStale {0}",
Z);return Z}yDe(){try{this.lr&&this.P1a?(this.DMk(),this.lr.businessBar.removeEntry(this.P1a),this.lr.ls(),D.a.J(512496200,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",!this.P1a.businessBar),this.P1a=null):D.a.J(512496199,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",!!this.lr,!!this.P1a)}catch(Z){D.a.J(512496198,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",Z.toString())}}uon(Z){Z===this.P1a&&(this.P1a=null)}won(Z){Z===
this.P1a&&this.Vv&&(this.yDe(),this.ipj()||h.AFrameworkApplication.vb.Cb(sb.a.EUa,2))}von(Z){Z===this.P1a&&this.Vv&&(this.ipj()?this.yDe():this.Vv.showEndSessionDialog())}crn(){const Z=this.xca(),Ka=window.document.hidden;D.a.J(512496197,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",Ka?"hidden":"visible",Z);Ka||this.Rtc&&18E5<=Z-this.JLl&&this.yDe()}ZIi(Z,Ka,zb){return!this.la.nbb||0===this.s$c&&this.la.isBlueChicken?new Promise(dc=>{dc(null)}):!zb&&!this.jta||zb&&!this.yDj?
(D.a.J(512496196,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",Z,Ka,zb),new Promise((dc,Jc)=>{Jc("AuthHelperNotSet")})):new Promise((dc,Jc)=>{const jd=this.la.hostAuthType;let Ed="";if("aad"===jd||this.la.isBlueChicken)Ed=this.la.rKe;else if("msa"===jd)Ed=this.la.$Ul;else{D.a.J(512496195,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",Z,Ka);Jc("HostAuthTypeInvalid");return}const de=
"true"===h.AFrameworkApplication.ga.La("IsAnonymousUser").toLowerCase();let Ne=h.AFrameworkApplication.ga.La(h.AFrameworkApplication.QI);Va.a.rb(Ne)&&(Ne="Unset");const Re=new Date;let Cf=null;Cf=zb?this.yDj.OVn(this.la.uUl,this.la.tUl,Ed,h.AFrameworkApplication.ga.La("UserPrincipalName"),this.la.HUl,this.la.xUl&&"StartLiveBroadcasting"===Z&&!this.la.gak):this.jta.qN(this.la.qKe,Ed);Cf.then(yg=>{this.vFl(Ka,Z,jd,zb,de,Ne,yg.IsSuccess,+new Date-+Re,yg.ErrorCode,yg.ErrorMessage);yg.IsSuccess?dc(yg.Token):
Jc(yg.ErrorCode)}).catch(yg=>{this.vFl(Ka,Z,jd,zb,de,Ne,!1,+new Date-+Re,"exception",yg.toString());Jc("exception")})})}Xzf(Z,Ka){if(!this.la.nbb||0===this.s$c&&this.la.isBlueChicken)return new Promise(dc=>{dc(null)});D.a.J(508384139,833,50,"LivePresenter::GetToken with user credentials for type: {0}",this.la.hostAuthType);const zb=this;return new Promise((dc,Jc)=>{const jd=this.la.getBooleanAppSetting("PowerpointLiveBroadcastEnableDirectAuthFallback");zb.ZIi(Z,Ka,!1).then(Ed=>{D.a.J(508384138,833,
50,"LivePresenter::GetToken succeeded with OAuth");dc(Ed)}).catch(Ed=>{D.a.J(508384137,833,50,"LivePresenter::GetToken - failed OAUth token retrieval: {0}",Ed.toString());zb.ZIi(Z,Ka,!1).then(de=>{D.a.J(508384136,833,50,"LivePresenter::GetToken - Retry with OAuth succeeded");dc(de)}).catch(de=>{D.a.J(508384135,833,50,"LivePresenter::GetToken - failed OAUth token retrieval Retry: {0}",de.toString());jd?zb.ZIi(Z,Ka,!0).then(Ne=>{D.a.J(508621791,833,50,"LivePresenter::GetToken - Retry with Direct Auth succeeded");
dc(Ne)}).catch(Ne=>{D.a.J(508384134,833,50,"LivePresenter::GetToken - Direct auth Re-Retry Failed with error:{1}",Ne.toString());Jc(Ne)}):(D.a.J(508384133,833,50,"LivePresenter::GetToken - Request Failed with error:{1}",de.toString()),Jc(de))})})})}xca(){return(new Date).getTime()}vFl(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re){const Cf={};Cf.SessionId=Z;Cf.Action=Ka;Cf.HostAuthType=zb;Cf.UseDirectAuth=dc;Cf.IsAnonymousUser=Jc;Cf.UiHost=jd;Cf.IsSuccess=Ed;Cf.Latency=de;Cf.ErrorCode=Ne;Cf.ErrorMessage=Re;D.a.J(51197915,
833,50,JSON.stringify(Cf))}B1a(Z){this.Ng.telemetryData.action=Z;this.Ng.telemetryData.sessionDurationInMS=this.xca()-this.Mph;this.Ng.telemetryData.hostAuthType=this.la.hostAuthType;this.Ng.SetStateServiceMetrics();this.Ng.telemetryData.errorCode.length&&(!this.Ng.telemetryData.errorMessage.length||0>Array.indexOf(this.la.AUl,this.Ng.telemetryData.errorMessage))&&(this.Ng.telemetryData.hasUnexpectedError=!0);Z=this.la.Jde.toLowerCase();-1!==Z.indexOf("pptservicescast.officeapps.live.com")?this.Ng.telemetryData.rendezvousServiceEnvironment=
"prod":-1!==Z.indexOf("pptservicescast.edog.officeapps.live.com")?this.Ng.telemetryData.rendezvousServiceEnvironment="edog":-1!==Z.indexOf("pptservicescast.officeapps.live-int.com")?this.Ng.telemetryData.rendezvousServiceEnvironment="int":this.Ng.telemetryData.rendezvousServiceEnvironment="dev";D.a.J(50706442,833,this.Ng.telemetryData.hasUnexpectedError?15:50,JSON.stringify(this.Ng.telemetryData))}rym(Z){if(this.oc)try{var Ka=this.mr.presentation;if(!Ka)throw Error.argumentNull("Presentation is null");
const zb=Ka.slides||[];this.RIj=zb[zb.length-1].sid;let dc=Ka=!1;this.o$c=new Set;for(const Jc of zb)Ka||Jc.sid!==Z||(Ka=!0,dc=Jc.ol),!Ka||Jc.ol&&!dc||this.o$c.add(Jc.sid),dc&&!Jc.ol&&(dc=!1)}catch(zb){this.Ng.telemetryData.SetErrorCode(16,zb.toString()),D.a.J(512496193,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",this.Ng.telemetryData.sessionId,zb.toString())}}ozh(Z){return new Promise(Ka=>{if(this.XM&&this.CF&&this.ry&&
this.E_f)try{this.E_f.then(zb=>{let dc=!1;switch(Z){case 2:if(!this.Nbc||!this.o$c||10*this.Nbc.size<8*this.o$c.size){Ka(!0);return}break;case 3:dc=!0}const Jc={triggeredSurveyType:"Survey.AudienceFeedback"};Jc.isMandatory=dc;Jc.triggerEventId=Di.a.create().toString();Jc.surveyeeName=h.AFrameworkApplication.userName;zb?(Jc.surveyId=zb.surveyId,Jc.surveyResponseUrl=zb.surveyResponseUrl):D.a.J(512496192,833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",this.Ng.telemetryData.sessionId);
this.CF.TriggerSurvey(JSON.stringify(Jc));D.a.J(512496163,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",this.Ng.telemetryData.sessionId,Z);Ka(!0)}).catch(zb=>{D.a.J(512496162,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",this.Ng.telemetryData.sessionId,zb.toString());this.Ng.telemetryData.SetErrorCode(13,zb.toString());Ka(!1)})}catch(zb){this.Ng.telemetryData.SetErrorCode(17,zb.toString()),
D.a.J(512496161,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",this.Ng.telemetryData.sessionId,zb.toString()),Ka(!1)}else Ka(!0)})}aQl(Z,Ka){this.vd&&this.CF&&Ka&&(this.vd.Sje(Object(e.a)(this,this.aQl,"onGetCurrentSlideShowPosition")),this.CF.SetCurrentPosition(Ka.slideId,Ka.slideIndex,Ka.tfd))}$0b(Z,Ka){this.Vv&&this.Vv.actOnCurrentSlideDimensionChange(Ka.slideHeight,Ka.oKk,Ka.slideWidth,Ka.yKk)}getCalloutMenuDefinition(){return this.muf()?
this.Vv.getCalloutMenuDefinition():null}e2m(){const Z=String.format("{0}{1}",this.la.Ocd,"reactions/heart/default/240_anim_f/heart.png"),Ka=String.format("{0}{1}",this.la.Ocd,"reactions/yes/default/240_anim_f/yes.png"),zb=String.format("{0}{1}",this.la.Ocd,"reactions/clap/default/240_anim_f/clap.png"),dc=String.format("{0}{1}",this.la.Ocd,"reactions/laugh/default/240_anim_f/laugh.png"),Jc=String.format("{0}{1}",this.la.Ocd,"reactions/surprised/default/240_anim_f/surprised.png"),jd=String.format("{0}{1}",
this.la.Ocd,"reactions/wonder/default/240_anim_f/wonder.png");this.hZb=[Object.assign(new gk,{react:"yes",reactionCount:0,reactionImagePath:Ka,numberOfAnimationFrames:40}),Object.assign(new gk,{react:"heart",reactionCount:0,reactionImagePath:Z,numberOfAnimationFrames:16}),Object.assign(new gk,{react:"clap",reactionCount:0,reactionImagePath:zb,numberOfAnimationFrames:40}),Object.assign(new gk,{react:"laugh",reactionCount:0,reactionImagePath:dc,numberOfAnimationFrames:77}),Object.assign(new gk,{react:"surprised",
reactionCount:0,reactionImagePath:Jc,numberOfAnimationFrames:68}),Object.assign(new gk,{react:"wonder",reactionCount:0,reactionImagePath:jd,numberOfAnimationFrames:70})];this.wpe=new Map;this.Icg=1;this.zoh=null}r_l(){if(this.hZb){for(const Z of this.hZb)Z.reactionCount=0;this.Vv&&this.Vv.resetReactions()}}Pmn(Z){if(this.wpe){var Ka=this.wpe.has(Z.slideId)?this.wpe.get(Z.slideId)+1:1;this.wpe.set(Z.slideId,Ka)}if(this.hZb&&!this.Rtc&&this.wEj){for(const zb of this.hZb)if(zb.react===Z.react){zb.reactionCount+=
1;break}if(this.Vv){Z=Array(this.hZb.length);for(Ka=0;Ka<this.hZb.length;Ka++)Z[Ka]=Object.assign(new gk,{react:this.hZb[Ka].react,reactionCount:this.hZb[Ka].reactionCount,reactionImagePath:this.hZb[Ka].reactionImagePath,numberOfAnimationFrames:this.hZb[Ka].numberOfAnimationFrames});this.Vv.setReactions(Z)}}}EOe(Z){return new Promise(Ka=>{if(this.XM&&this.CF&&this.ry)try{if(1>this.wpe.size)D.a.J(512496160,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",this.Ng.telemetryData.sessionId,
Z),Ka(!0);else if(2===Z&&(!this.Nbc||1>this.Nbc.size))D.a.J(512496159,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",this.Ng.telemetryData.sessionId,Z),Ka(!0);else{var zb=null,dc=0;this.wpe.forEach((jd,Ed)=>{jd>dc&&(zb=Ed.toString(),dc=jd)});if(this.zoh&&zb===this.zoh)D.a.J(512496158,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",this.Ng.telemetryData.sessionId,Z),Ka(!0);else{var Jc=this.CF.TriggerSaveThumbnails(()=>
this.Xzf("SaveThumbnails",this.Ng.telemetryData.sessionId),zb);Jc?Jc.then(()=>{this.zoh=zb;D.a.J(512496156,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",this.Ng.telemetryData.sessionId,Z);Ka(!0)}).catch(jd=>{D.a.J(512496155,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",this.Ng.telemetryData.sessionId,jd.toString(),Z);Ka(!1)}):(this.Ng.telemetryData.SetErrorCode(15,"Triggering save thumbnails failed to created Promise object!"),
D.a.J(512496157,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),Ka(!1))}}}catch(jd){this.Ng.telemetryData.SetErrorCode(15,jd.toString()),D.a.J(512496154,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",this.Ng.telemetryData.sessionId,jd.toString()),Ka(!1)}else Ka(!0)})}d7c(){return this.la.nBa&&this.Su&&this.Su.instance?!0:!1}hzm(Z){if(this.d7c())switch(Z){case 0:this.gGc&&this.Su.instance.show(ResourceStrings.L_LivePresentations_Disconnected,
jj.a.VBb);this.Ng.telemetryData.SetErrorCode(3);this.B1a("DisconnectdToPrague");break;case 1:this.Su.instance.hide();break;case 2:this.gGc&&this.Su.instance.show(ResourceStrings.L_LivePresentations_Connecting,jj.a.Ibd);break;default:D.a.J(512496152,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Ng.telemetryData.sessionId)}else D.a.J(512496153,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",this.Ng.telemetryData.sessionId)}Ubd(Z,Ka){this.d7c()?
Ka.isConnected?this.Su.instance.hide():this.gGc&&this.Su.instance.show(ResourceStrings.L_LivePresentations_InternetDisconnected,jj.a.Ibd):D.a.J(512496151,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Ng.telemetryData.sessionId)}kQi(Z,Ka){Z=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.la.$l,Z,Ka);this.la.JUl&&(Z+="&shareable=true");return Z}sVn(Z,Ka){try{const zb=new M.a;if(1===Z||2===Z||4===Z)zb.add(this.ozh(3)),
zb.add(this.EOe(3));zb.count?Promise.all(zb.toArray()).then(()=>Ka()).catch(()=>Ka()):Ka()}catch(zb){D.a.J(512496150,833,10,"failed to create end session task promises, error : {0}",zb),Ka()}}get W0k(){const Z=Ii.a.get("PPTLivePresentationOnboarded");return Z?"true"===Z.toLowerCase():!1}set W0k(Z){Ii.a.n_("PPTLivePresentationOnboarded",Z.toString(),Ii.a.b_)||D.a.J(512496149,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",Z.toString())}ZBi(){return this.la.bVl&&!this.W0k}qta(){try{if(D.a.J(512496148,
833,15,"Pods session rehydrated!"),this.Bnh=!0,this.XM&&this.PK&&this.CF){D.a.J(512496147,833,15,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Ng.telemetryData.sessionId,this.nb.rp);const Z=this.kQi(this.nb.podSessionId,this.nb.rp);this.CF.OnPodSessionUpdated(Z)}}catch(Z){D.a.J(512496146,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",Z.toString())}}Wbd(){this.Bnh=!1}WQl(){this.Bnh=!1}Cxb(){if(this.la.cVl)try{const Z=l.a.instance.Na("Common.ISystemInitiatedFeedback");
Z&&(D.a.J(512496145,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),Z.execute(Ka=>{Ka.logActivity("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(Z){D.a.J(512496144,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",Z)}}Zvl(Z){const Ka=document.createElement("a");Ka.setAttribute("href",Z);return(Z=Ka.search.match(RegExp("[\\?&]Id=([^&#]*)")))&&2===Z.length?Z[1]:""}eLm(){var Z=this.oc.tKd();let Ka=
1;this.dQj.clear();for(const zb of Z){Z=zb.xj();for(const dc of Z)if(!Va.a.rb(dc.J0b)){Z=this.Zvl(dc.J0b);const Jc=new vm;Jc.WKl=Z;Jc.XKl=Ka.toString();this.dQj.add(Jc);Ka+=1}}}e8l(){var Z=this.oc.XZ(this.EYd).xj();for(const Ka of Z)Va.a.rb(Ka.J0b)||(Z=this.Zvl(Ka.J0b),Z=this.cQj.get(Z),Va.a.rb(Z)||this.CF.SetCurrentPollInfoState(Z,this.EYd))}yqm(Z){this.ua.addHandler("OnLiveResourcesLoaded",Z)}lGn(Z){this.ua.removeHandler("OnLiveResourcesLoaded",Z)}Vel(Z){this.ua.addHandler("OnLiveSessionStarted",
Z)}eZl(Z){this.ua.removeHandler("OnLiveSessionStarted",Z)}Uel(Z){this.ua.addHandler("OnLiveSessionEnded",Z)}dZl(Z){this.ua.removeHandler("OnLiveSessionEnded",Z)}gqm(Z){this.ua.addHandler("OnCalloutDismissed",Z)}$Fn(Z){this.ua.removeHandler("OnCalloutDismissed",Z)}Rel(Z){this.ua.addHandler("OnRelaunchPausedSession",Z)}bZl(Z){this.ua.removeHandler("OnRelaunchPausedSession",Z)}hqm(Z){this.ua.addHandler("CalloutMenuDefinitionChanged",Z)}aGn(Z){this.ua.removeHandler("CalloutMenuDefinitionChanged",Z)}}
Object(c.a)(Vj,"LivePresenter",null,[1289]);class hm{constructor(){this.$=null;this.JKl=0}get name(){return"PowerPointWebEditor.Live"}lc(Z){this.$=Z;const Ka=this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),zb=this.$.resolve("PowerPointWebEditor.IApplicationSettings");this.$.register(1289,"PowerPointLive.ILivePresenter").ma().na(()=>new Vj(zb,Ka,this.$.resolve("PowerPointWebEditor.ISlideshowFrame"),this.$.resolve("PowerPoint.IPathManager"),this.$.resolve("Common.App.OAuth.IOAuthManager"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.$.Na("PowerPointWebEditor.ISubtitleContext"),l.a.instance.Na("PowerPointWebEditor.ISlideShowVoiceNotification"),this.$.resolve("PowerPointWebEditor.Core.INetworkConnectivityProvider"),this.$.resolve("PowerPointWebEditor.IFocusManager")))}o9m(){try{this.$.resolve("PowerPointWebEditor.IApplicationSettings").nbb?
(this.JKl=Date.now(),D.a.J(509441559,833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),uc.a.get_instance().$i(7,()=>{const Z=this.$.resolve("Common.IDynamicScriptLoaderProvider").LW,Ka=Rg.a(this.$),zb=new M.a;zb.add(Z.loadScript("PPTLiveBroadcast"));zb.add(Z.loadScript("BroadcastMonitor"));zb.add(Ka("liveActor"));h.AFrameworkApplication.Ea.Kb.Cx||zb.add(Ka("uiFabricLazy"));Promise.all(zb.toArray()).then(()=>this.Eqn()).catch(dc=>D.a.J(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",
dc))})):D.a.J(509441560,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(Z){D.a.J(509441558,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",Z)}}su(){try{if(this.$.resolve("PowerPointWebEditor.IApplicationSettings").nbb){if(this.$.resolve("PowerPointWebEditor.IApplicationSettings").VUl){const Z=Va.a.vI((h.AFrameworkApplication.fileName||"").toLowerCase());if(".ppt"===Z||".pps"===Z){D.a.J(509441556,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");
return}".pptx"!==Z&&D.a.J(509441555,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+Z)}this.$.resolve("PowerPointWebEditor.IApplicationSettings").YUl&&this.$.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(4)?D.a.J(509441554,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format."):this.$.resolve("PowerPointWebEditor.IApplicationSettings").ZUl&&(this.$.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32)||this.$.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32768))?
D.a.J(509441553,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file."):this.$.resolve("PowerPointWebEditor.IApplicationSettings").fak&&"msa"===this.$.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType?D.a.J(509441552,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users."):this.$.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Z=>{Z.isFeatureEnabled("PowerPointLivePresentations",!1).then(Ka=>{Ka?this.o9m():
(D.a.J(509441551,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}else D.a.J(509441557,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(Z){D.a.J(509441550,833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",Z)}}Eqn(){D.a.J(509441549,833,50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-this.JKl);this.$.resolve("PowerPointLive.ILivePresenter").gEd=
!0;this.$.resolve("PowerPointWebEditor.IApplicationSettings").fak||"msa"!==this.$.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}init(){h.AFrameworkApplication.ga.fg(Object(e.a)(this,this.su,"onFullAppSettingsReady"))}dispose(){}static main(){b.a.instance.Fc(new hm)}}Object(c.a)(hm,"PPTWebEditorLivePackage",null,[3,4]);var ah=a(1154);class wm{}Object(c.a)(wm,
"LokiTokenResult",null,[]);class Si{constructor(Z){this.H9g=Z}nvl(){const Z=this.jQm();return Z?Si.rTd?new Promise((Ka,zb)=>{this.H9g.continueWith(()=>{this.H9g.In||this.H9g.vm?zb(Error.create("Error downloading auth library")):this.H9g.result.qN("Loki",Z).then(dc=>{dc=h.AFrameworkApplication.ga.getBooleanAppSetting("ForceLokiFallbackToACLPTokenIsEnabled")?this.kQm():dc.IsSuccess&&dc.Token?Object.assign(new wm,{isSuccess:!0,token:dc.Token,errorMessage:null}):Object.assign(new wm,{isSuccess:!1,token:null,
errorMessage:JSON.stringify(dc)});Ka(dc);return dc})})}):Promise.resolve(Object.assign(new wm,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new wm,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",ah.a.Qgh())}))}kQm(){const Z=h.AFrameworkApplication.ga.La("LokiUserDataSignature")||"";return Object.assign(new wm,{isSuccess:!0,token:Z,errorMessage:null})}jQm(){let Z=
null;const Ka=ah.a.pGd();2===Ka?Z=h.AFrameworkApplication.ga.La("LokiAADAppId"):1===Ka&&(Z=h.AFrameworkApplication.ga.La("LokiMSAAppId"));return Z}static get rTd(){return h.AFrameworkApplication.ga.getBooleanAppSetting("IsO365CommercialHost")||h.AFrameworkApplication.ga.getBooleanAppSetting("IsO365ConsumerHost")}}Object(c.a)(Si,"LokiTokenManager",null,[1338]);class pl{get name(){return"Common.App.LivePersonaUtils"}init(){l.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}lc(Z){Z.register(Si,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ma().na(()=>new Si(Me.a.aG(Z.Na("Common.App.OAuth.IOAuthManager"))))}static main(){b.a.instance.Fc(new pl)}}Object(c.a)(pl,"LivePersonaUtilsPackage",null,[3,4]);var Xl=a(397);class dm{constructor(){this.displayName=this.critique=null;this.optOut=!1;this.category=null}}Object(c.a)(dm,"RehearsalCritique",null,[]);class Dh{static K1m(){Dh.uba[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Dh.uba[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
Dh.uba[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Dh.uba[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;Dh.Xnl=ResourceStrings.L_SubtitleDetection_MicReady;Dh.Ynl=ResourceStrings.L_SubtitleDetection_SoundReminder;Dh.pql=ResourceStrings.L_SubtitleDetection_NoMicrophone;Dh.sql=ResourceStrings.l_NoCamera;Dh.ptl=ResourceStrings.L_SpeechGenericRetryErrorMessage}}Dh.Ail=20;Dh.fYl=50002;Dh.uba=Array(Dh.Ail);Dh.Xnl=null;Dh.Ynl=null;Dh.pql=null;Dh.sql=null;Dh.ptl=null;Dh.uDi="fillerWords";
Dh.Ctn="originality";Dh.j0n="wordsPerMinute";Dh.xKn="sensitivePhrases";Dh.aAm="correctedSensitivePhrases";Dh.Lwn="positivity";Dh.J_i="grammar";Dh.GUj="monotone";Dh.Ddk="pronunciation";Dh.Rqi="crutchWords";Dh.H$l="visionFace";Dh.H_n="visionGaze";Dh.G_n="visionGazeGood";Dh.J_n="visionOcclusion";Dh.I_n="visionOcclusionGood";Dh.D_n="visionDistanceGood";Dh.E_n="visionDistanceTooClose";Dh.F_n="visionDistanceTooFar";Dh.CTm="GetStartedButton";Dh.b9m="ListeningElement";Dh.ozm="ContainerElement";Dh.Nun="PausedElement";
Dh.hYl="RehearsalFeedbackSettingPane";Dh.A9j="PPTCoachRehearsalFREShown";Object(c.a)(Dh,"RehearsalResourceString",null,[]);const am=(Z,Ka)=>Va.a.rb(Ka)?(f.ULS.sendTraceTag(508692422,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1):Z?Ka.toLowerCase()in Z:!0,an=(Z,Ka)=>{let zb=null;try{if(!Z||Va.a.rb(Ka))return f.ULS.sendTraceTag(508692421,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),null;const Jc=
Va.a.rb(Z.AJg)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(Z.AJg,!0);zb={};for(const jd in Jc){Z=jd;var dc=Jc[jd];if(dc){const Ed=Ld.a.Jze(dc.split(","));Ed&&Ka.toLowerCase()in Ed&&(zb[Z.toLowerCase()]=!0)}}}catch(Jc){D.a.J(508692420,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",Jc.toString()),zb=null}return zb},Zn=(Z,Ka)=>{if(Va.a.rb(Ka)||Va.a.rb(Z.Y6j))return null;try{var zb=Sys.Serialization.JavaScriptSerializer.deserialize(Z.Y6j,
!0);if(Va.a.rb(Ka)){f.ULS.sendTraceTag(508692416,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty.");var dc=null}else dc=Ka.split("-")[0].toLowerCase();return zb[dc]}catch(Jc){return D.a.J(508692417,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",Jc.toString()),null}},bn=Z=>{if(Z&&3<Z.length){let Ka="";"ws"===Z.substring(0,2)?Ka="http"+Z.substring(2,Z.length):"wss"===Z.substring(0,3)&&(Ka="https"+Z.substring(3,
Z.length));return Ka}return Z},rm=Z=>{if(Va.a.rb(Z))return f.ULS.sendTraceTag(508692387,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",Z),"en-US";switch(Z.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return Z}};class hn{constructor(){this.userCritiques=null}}Object(c.a)(hn,"RehearseRoamingSettings",null,[]);class $n{constructor(){this.critiquesDisabledByDefault=
this.critiquesDisabled=null}}Object(c.a)($n,"UserCritiqueSettings",null,[]);class Yk{constructor(Z,Ka,zb,dc){this.ua=new Ad.a;this.Woa=this.v1f=this.FNa=null;this.eta=!1;this.lHl=null;this.occ=this.pcc=0;this.$p=Z;this.la=Ka;this.Ooa=zb;this.ia=dc}y2m(){try{this.jwl(()=>{this.ua.raiseEvent("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs)})}catch(Z){D.a.J(508692293,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",Z.toString())}}clh(){return 2===this.pcc&&2===this.occ}bVk(){try{0!==
this.pcc&&3!==this.pcc||this.jwl(Object(e.a)(this,this.Pgk,"raiseRehearsalGetCritiquesEvent")),0!==this.occ&&3!==this.occ||this.AOm()}catch(Z){D.a.J(508692292,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",Z.toString())}}wNm(){if(!this.v1f)return D.a.J(508692291,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(this.Woa)for(const Z of this.v1f)this.Woa.contains(Z.critique.toLowerCase())?Z.optOut=!0:Z.optOut=!1}catch(Z){D.a.J(508692290,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",
Z.toString())}return this.v1f.toArray()}UXn(Z,Ka){this.Q9l(Z,Ka);"vision"===Z.toLowerCase()&&(this.eta=!Ka,Z={},Z.triggerPoint=Dh.hYl,this.ia.Qa(sb.a.J_c,2,Z))}Nvl(Z){Z=void 0===Z?!1:Z;let Ka="";if(this.Woa&&0<this.Woa.count)if(rb.a("RehearsalFilterOptOutCritiqueEnabled")&&Z){a:{var zb=this.la;Z=this.la.x4b;var dc=null;try{if(!zb||Va.a.rb(Z)){f.ULS.sendTraceTag(508692419,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");
var Jc=null;break a}var jd=Va.a.rb(zb.AJg)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(zb.AJg,!0);dc={};for(const de in jd){Jc=de;var Ed=jd[de];if(Ed){const Ne=Ld.a.Jze(Ed.split(","));dc[Jc.toLowerCase()]=Ne&&Z.toLowerCase()in Ne?!0:!1}}}catch(de){D.a.J(508692418,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",de.toString()),dc=null}Jc=dc}if(Ed=Jc)for(const de of this.Woa)if(jd="vision"===de?Dh.H$l.toLowerCase():de.toLowerCase(),
jd in Ed?Ed[jd]:1)Ka=Va.a.rb(Ka)?de.toLowerCase():Ka+","+de.toLowerCase()}else for(dc of this.Woa)Ka=Va.a.rb(Ka)?dc.toLowerCase():Ka+","+dc.toLowerCase();return Ka}rvh(){if(2!==this.pcc)D.a.J(508692289,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(this.b6m()){D.a.J(508692259,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var Z=new hn;Z.userCritiques=Object.assign(new $n,{critiquesDisabled:this.Nvl(),critiquesDisabledByDefault:this.FNa.userCritiques.critiquesDisabledByDefault});
var Ka=Eb.c(Z),zb=this.la.dZ+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",h.AFrameworkApplication.ui),dc={};dc["X-StatelessPopsAffinityRoutingEnabled"]=this.la.oba.toString();this.$p.rk(zb,2,Ka,dc,!1,2,Jc=>{this.Qrn(Jc,Z)},Object(e.a)(this,this.Prn,"onSaveUserCritiquesFailed"),null,void 0,void 0,void 0,void 0,Xl.a("17"))}else D.a.J(508692288,822,50,"SaveRehearseUserCritiques(), skipping save operation")}get uCi(){return this.eta}set uCi(Z){this.eta=
Z;this.Q9l("vision",!this.eta);this.clh()&&this.ua.raiseEvent("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty)}uqm(Z){this.ua.addHandler("OnRehearsalOptOutSettingsRequestFinished",Z)}hGn(Z){this.ua.removeHandler("OnRehearsalOptOutSettingsRequestFinished",Z)}tqm(Z){this.ua.addHandler("OnRehearsalGetCritiquesSucceeded",Z)}gGn(Z){this.ua.removeHandler("OnRehearsalGetCritiquesSucceeded",Z)}sqm(Z){this.ua.addHandler("OnRehearsalGetCritiquesFailed",Z)}fGn(Z){this.ua.removeHandler("OnRehearsalGetCritiquesFailed",
Z)}vqm(Z){this.ua.addHandler("OnRehearsalSettingsUpdatedExternally",Z)}iGn(Z){this.ua.removeHandler("OnRehearsalSettingsUpdatedExternally",Z)}Q9l(Z,Ka){this.Woa&&(Z=Z.toLowerCase(),Ka&&!this.Woa.contains(Z)?this.Woa.add(Z):!Ka&&this.Woa.contains(Z)&&this.Woa.remove(Z),rb.a("RehearsalRoamingSettingAutoSaveEnabled")&&this.rvh())}b6m(){let Z=!1;try{var Ka=Va.a.rb(this.FNa.userCritiques.critiquesDisabled);if(!this.Woa||!this.Woa.count&&Ka)return!1;if(Ka&&0<this.Woa.count||!Ka&&!this.Woa.count)return!0;
const zb=new Set(this.FNa.userCritiques.critiquesDisabled.split(","));if(this.Woa.count!==zb.size)return!0;for(Ka=0;Ka<this.Woa.count;Ka++)if(!zb.has(this.Woa.ha(Ka).toLowerCase())){Z=!0;break}}catch(zb){D.a.J(508692258,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",zb.toString())}return Z}Qrn(Z,Ka){this.FNa=Ka;D.a.J(508692257,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+Z.data.zr-+Z.data.WC,+Z.data.qq-+Z.data.WC)}Prn(Z){const Ka=this.Ooa.LV(Z);D.a.J(508692256,
822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",Ka,Z.data.state)}jwl(Z){const Ka=this.la.dZ+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",h.AFrameworkApplication.ui),zb={};zb["X-StatelessPopsAffinityRoutingEnabled"]=this.la.oba.toString();this.$p.rk(Ka,1,null,zb,!1,2,dc=>{this.cqn(dc,Z)},dc=>{this.bqn(dc,Z)},null,void 0,void 0,void 0,void 0,Xl.a("16"));this.pcc=1}cqn(Z,Ka){let zb=0;try{Z.data.responseData&&0<Z.data.responseData.trim().length&&
(zb=Z.data.responseData.length,this.FNa=JSON.parse(Z.data.responseData));this.FNa&&this.FNa.userCritiques||(this.FNa=new hn,this.FNa.userCritiques=new $n);Va.a.rb(this.FNa.userCritiques.critiquesDisabledByDefault)&&(this.FNa.userCritiques.critiquesDisabledByDefault="vision",Va.a.rb(this.FNa.userCritiques.critiquesDisabled)?this.FNa.userCritiques.critiquesDisabled="vision":this.FNa.userCritiques.critiquesDisabled+=",vision");this.Woa=new M.a;if(!Va.a.rb(this.FNa.userCritiques.critiquesDisabled)){const dc=
this.FNa.userCritiques.critiquesDisabled.split(",");for(const Jc of dc)this.Woa.add(Jc.toLowerCase())}this.eta=!this.Woa.contains("vision");this.pcc=2}catch(dc){this.pcc=3,D.a.J(508692255,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",dc.toString())}Ka&&Ka();Z=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",zb,JSON.stringify(Z.data.WC),JSON.stringify(Z.data.qq),JSON.stringify(Z.data.zr));D.a.J(508692254,822,50,Z)}bqn(Z,
Ka){this.pcc=3;Ka&&Ka();Z=this.Ooa.LV(Z);D.a.J(508692253,822,50,"OnGetUserCritiquesFailed: Web service failed with {0}",Z)}AOm(){try{const Ka=this.wIm();if(Va.a.rb(Ka))D.a.J(508692252,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request");else{var Z=new XMLHttpRequest;Z.open("GET",Ka,!0);Z.onreadystatechange=()=>{if(4===Z.readyState){if(200===Z.status){D.a.J(508692251,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");
const zb=Eb.b(Z.responseText);if(zb){this.v1f=new M.a;for(const dc of zb.critiquesData)this.v1f.add(Object.assign(new dm,{category:dc.category,displayName:dc.displayName,optOut:!1,critique:dc.critique.toLowerCase()}));this.lHl=zb.categoriesData;this.occ=2}else this.occ=3}else this.occ=3;this.Pgk()}};Z.send("");this.occ=1}}catch(Ka){this.occ=3,this.Pgk(),D.a.J(508692250,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",Ka.toString())}}wIm(){const Z=Eb.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString()).Ring||
"Unknown",Ka=this.la.wCb.replace("wss","https");return Ka&&Ka.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",Ka,Z,rm(this.la.x4b)):null}Pgk(){0!==this.pcc&&1!==this.pcc&&0!==this.occ&&1!==this.occ&&(this.clh()?this.ua.raiseEvent("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs):this.ua.raiseEvent("OnRehearsalGetCritiquesFailed",new Sys.EventArgs))}}Object(c.a)(Yk,"RehearsalFeedbackSettings",null,[1286]);class Qn{constructor(){this.type=
"RehearsalCritiqueWithGroupProps";this.retryToFetchCritiqueSettings=this.locale=this.updateCritiqueState=this.categoriesData=this.groupItems=null;this.isExternalUpdated=this.showErrorMessage=this.showLoadingMessage=!1}}Object(c.a)(Qn,"RehearsalCritiqueWithGroupProps",null,[]);class Rn{constructor(Z,Ka,zb,dc,Jc){this.L2a=this.mc=!1;Z("powerpoint-presenter-coach-strings").then(()=>{this.L2a=!0;D.a.J(509138183,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(jd=>{D.a.J(509138182,
822,10,"Failed to load powerpoint-presenter-coach-strings "+jd.toString())});this.ia=Ka;this.la=Jc;this.eR=zb;this.E1=dc;this.ia.Bia(this)}Hb(){this.ia.za(sb.a.UUg,Na.a.application,Object(e.a)(this,this.UUg,"showRehearsalFeedbackSettingsPane"));this.ia.za(sb.a.nNe,Na.a.application,Object(e.a)(this,this.nNe,"showHideRehearsalFeedbackSettingsPane"));this.ia.sa(sb.a.dLe,Na.a.application,Object(e.a)(this,this.dLe,"queryShowHideRehearsalFeedbackSettingsPane"),96)}ve(){}getName(){return"RehearsalSettings"}M6(){}K6(){}UUg(Z,
Ka,zb){if(Ka.contextId!==Na.a.application||!this.L2a)return 2;if(1===zb)return 32;this.mc?Bb.a.Py().then(dc=>{dc.setSelectedTaskPane(Fa.a.Kdc);this.eZ(!0);return null}).catch(dc=>{D.a.J(509138180,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",dc.toString())}):(this.mc=!0,this.ZXl(),(Z=!this.E1.clh())&&this.E1.bVk(),Z=this.ML(Z,!1),this.FUg(Z),D.a.J(509138181,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane"));return 32}nNe(Z,Ka,
zb){if(Ka.contextId!==Na.a.application||!this.L2a)return 2;if(1===zb)return 32;(this.mc=!this.mc)?(this.ZXl(),(Z=!this.E1.clh())&&this.E1.bVk(),Z=this.ML(Z,!1),this.FUg(Z),D.a.J(509138179,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(this.gym(),D.a.J(509138178,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32}dLe(Z,Ka,zb,dc,Jc){if(!Object(Ei.a)(nl.a,Jc))return 8;Jc.xg(this.mc);return 32}FUg(Z,Ka){Ka=void 0===
Ka?!1:Ka;const zb=Object.assign(new Da.a,{title:ResourceStrings.L_RehearseFeedbackSettings,hideHeader:!1,width:320,location:2,contentProps:Z,onOpen:()=>{},onClose:()=>{this.mc=!1;this.HDm();this.E1.rvh()},onHide:()=>{this.E1.rvh()},isModernPane:!0});Z=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");this.eR.pTa(Fa.a.Kdc,Fa.a.vl,Z,()=>{this.eZ(!0)},()=>{this.eZ(!1)});Bb.a.Py().then(dc=>{Ka?this.mc&&dc.updateTaskPane(Fa.a.Kdc,zb):dc.showTaskPane(Fa.a.Kdc,zb);return null}).catch(dc=>
{D.a.J(509138177,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",dc.toString())})}gym(){Bb.a.Py().then(Z=>{Z.hideTaskPane(Fa.a.Kdc,2);return null}).catch(Z=>{D.a.J(509138176,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",Z.toString())})}ML(Z,Ka){return Object.assign(new Qn,{groupItems:Z||Ka?null:this.E1.wNm(),categoriesData:this.E1.lHl,locale:this.la.x4b,updateCritiqueState:(zb,dc)=>{this.E1.UXn(zb,dc)},retryToFetchCritiqueSettings:()=>
{this.E1.bVk()},showLoadingMessage:Z,showErrorMessage:Ka})}eZ(Z){const Ka=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");Z&&Ka&&Ka.focus()}ZXl(){this.E1.tqm(Object(e.a)(this,this.fRl,"onRehearsalGetCritiquesSucceeded"));this.E1.sqm(Object(e.a)(this,this.eRl,"onRehearsalGetCritiquesFailed"));this.E1.vqm(Object(e.a)(this,this.hRl,"onRehearsalSettingsUpdatedExternally"))}HDm(){this.E1.gGn(Object(e.a)(this,this.fRl,"onRehearsalGetCritiquesSucceeded"));this.E1.fGn(Object(e.a)(this,
this.eRl,"onRehearsalGetCritiquesFailed"));this.E1.iGn(Object(e.a)(this,this.hRl,"onRehearsalSettingsUpdatedExternally"))}fRl(){const Z=this.ML(!1,!1);this.FUg(Z,!0)}eRl(){const Z=this.ML(!1,!0);this.FUg(Z,!0)}hRl(){const Z=this.ML(!1,!1);Z.isExternalUpdated=!0;this.FUg(Z,!0)}}Object(c.a)(Rn,"RehearsalFeedbackSettingsPane",null,[85]);var Hm;(function(Z){Z[Z.none=0]="none";Z[Z.ribbon=1]="ribbon";Z[Z.slideShowToolbar=2]="slideShowToolbar";Z[Z.summaryPage=3]="summaryPage";Z[Z.ribbonTopBar=4]="ribbonTopBar";
Z[Z.deepLink=5]="deepLink"})(Hm||(Hm={}));Object(c.b)("RehearsalEntryPoint",Hm);class cn{constructor(){this.imagesBaseFilePath=this.slideState=this.rootContainer=null;this.zIndex=0;this.fUseCountdownWelcomeScreen=this.fShowRealtimeFeedbackEnabledCheckbox=this.fEnableVision=!1;this.speechFDBase=null;this.fUseNewRealtimeCheckbox=this.fUseNewRealtimePanel=this.fDontShowTooltips=!1}}Object(c.a)(cn,"ICoachActorConfig",null,[]);class dn{constructor(){this.rootContainer=this.imagesBaseFilePath=null;this.zIndex=
0}}Object(c.a)(dn,"ICoachFREActorConfig",null,[]);class Sn{constructor(){this.customSettings=this.requestedRehearsalOptOutFeatures=this.requestedCoachFeatures=this.documentDownloadConfig=this.userSessionId=this.disabledCoachRealtimeFeatures=this.logger=null;this.fEnableVision=!1;this.supportedRehearsalTemplates=this.sourceLanguage=this.entryPoint=this.wacDatacenter=this.wacHost=this.locale=this.buildVersion=this.audienceGroup=this.audienceChannel=this.identityProvider=this.tenantId=this.userId=this.speechFDBase=
this.webcamConfig=null;this.fEnableServiceSideAggregationForCoach=!1;this.httpTimeoutForCoachSummaryData=0;this.enableTimeStampedCritiqueTelemetry=this.fSendClientMetaDataOnSessionStart=!1;this.audioInputDeviceCount=0}}Object(c.a)(Sn,"ICoachSessionConfig",null,[]);class Tn{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(c.a)(Tn,"IDocumentDownloadConfig",null,[]);class en{constructor(){this.totalSlideCount=this.currentSlideIndex=0}}Object(c.a)(en,
"ISlideState",null,[]);class Un{constructor(){this.workingCanvas=this.videoView=null;this.requestedVideoHeight=this.requestedVideoWidth=this.webcamFrameWidth=this.numFramesPerSecond=0}}Object(c.a)(Un,"IWebcamConfig",null,[]);var Im=a(1219);class So{constructor(Z,Ka,zb,dc,Jc,jd,Ed,de,Ne,Re,Cf,yg,bh,Ah){this.cad=!1;this.R5=this.iCj=this.KTa=this.RUb=null;this.vmg=0;this.aLl=-1;this.kbd=0;this.Eqh=this.zqh=null;this.yEj=this.tEj=!1;this.iNj=this.nZb=0;this.eta=!1;this.ua=new Ad.a;this.hbd=null;this.wIl=
this.hRj=this.ABj=!1;this.kNj=null;this.F_f=this.oHl=0;this.YLl=this.eIl=!1;this.iIl=h.AFrameworkApplication.ga.getBooleanAppSetting("FirstRehearsalExperienceEnabled");this.XVb=zb;Ka&&(this.RUb=Ka.sP());this.vd=dc;this.ia=Z;this.oc=Jc;this.va=jd;this.nb=Ed;this.la=de;this.Su=Ne;this.pBb=Re;this.umg=Cf;this.E1=yg;this.e1=bh;this.qy=Ah;this.Xvf()&&this.E1.uqm(Object(e.a)(this,this.gRl,"onRehearsalOptOutSettingsRequestFinished"))}Hb(){this.ia.za(sb.a.GNe,Na.a.application,Object(e.a)(this,this.GNe,"startRehearsalManager"));
this.ia.za(sb.a.J_c,Na.a.application,Object(e.a)(this,this.J_c,"toggleRehearsalVisionEnabled"));this.ia.za(sb.a.tdd,Na.a.application,Object(e.a)(this,this.tdd,"rehearsePresentationDropDown"));this.ia.sa(sb.a.Adc,Na.a.application,Object(e.a)(this,this.Adc,"queryRehearsalVisionEnabled"),96)}Adc(Z,Ka,zb,dc,Jc){if(!Jc||!Object(Ei.a)(nl.a,Jc))return D.a.J(512496082,822,10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;Jc.xg(this.eta);return 32}tdd(Z,Ka,zb){switch(zb){case 1:if(this.cad&&
this.Yqj())return this.ia.Cb(sb.a.tUa,1);break;default:D.a.J(512496081,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8}J_c(Z,Ka,zb,dc,Jc){switch(zb){case 2:return this.eta=!this.eta,h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.Cx&&Lf.App.Vb.nD({ToggleRehearsalVisionEnabled:"CheckboxModel"}),this.Xvf()&&Jc&&Jc.triggerPoint!==Dh.hYl&&(this.E1.uCi=this.eta),32;case 1:if(this.cad&&this.Yqj())return 32;break;default:D.a.J(512496080,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8}GNe(Z,
Ka,zb,dc,Jc){switch(zb){case 2:return this.mSn(Jc),32;case 1:if(this.cad&&this.Yqj())return 32;break;default:D.a.J(512496079,822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8}YVd(){try{this.oHl=Date.now();const Z=this.XVb.LW;Z.loadScript("powerpoint-presenter-coach-strings").then(()=>{const Ka=new M.a;Ka.add(Z.loadScript("CoachActorPackage"));Ka.add(Z.loadScript("CoachPackage"));Promise.all(Ka.toArray()).then(()=>{this.Hon();return null}).catch(zb=>{D.a.J(512496078,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",
zb);return null})})}catch(Z){D.a.J(512496077,822,10,"RehearsalManager: Exception in LoadResources : {0}.",Z)}}iqm(Z){this.ua.addHandler("OnCoachResourcesLoaded",Z)}bGn(Z){this.ua.removeHandler("OnCoachResourcesLoaded",Z)}Hon(){const Z=h.AFrameworkApplication.ga.La("CoachPackageCssUrl"),Ka=document.createElement("link");Ka.setAttribute("rel","stylesheet");Ka.setAttribute("type","text/css");Ka.setAttribute("href",Z);$addHandler(Ka,"load",()=>{this.cad=!0;rb.a("PollToRefreshCoachEntryPointOnRibbon")&&
this.qy&&this.qy.BB();this.ua.raiseEvent("OnCoachResourcesLoaded",new Sys.EventArgs);D.a.J(512496076,822,50,"RehearsalManager: Coach package loading time: {0}ms",Date.now()-this.oHl)});document.body.appendChild(Ka)}TEn(){this.vd.Wah(Object(e.a)(this,this.KRl,"onSlideshowReady"));this.vd.$9b(Object(e.a)(this,this.Czg,"onSlideShowPositionChanged"));this.vd.OJb(Object(e.a)(this,this.dCb,"onSlideshowExitHandler"));this.vd.Xah(Object(e.a)(this,this.gcd,"onSpecialKeyHandler"))}IDm(){this.vd.suh(Object(e.a)(this,
this.KRl,"onSlideshowReady"));this.vd.OUc(Object(e.a)(this,this.Czg,"onSlideShowPositionChanged"));this.vd.TCb(Object(e.a)(this,this.dCb,"onSlideshowExitHandler"));this.vd.tuh(Object(e.a)(this,this.gcd,"onSpecialKeyHandler"))}gcd(Z,Ka){Ka.key===qa.a.i2c&&this.dAk()}dAk(){if(0===this.nZb){var Z=this.R5.getCoachElement(Dh.CTm);Z&&this.mXc(Z)}else 2===this.nZb?(Z=this.R5.getCoachElement(Dh.Nun))&&this.mXc(Z):1===this.nZb&&(Z=this.R5.getCoachElement(Dh.b9m))&&this.mXc(Z)}mXc(Z){this.RUb&&this.R5&&window.setTimeout(()=>
{bb.FocusManager.UA(Z)},50)}bL(Z){try{Z.keyCode!==qa.a.vu&&(Z.keyCode===qa.a.V3||Z.keyCode===qa.a.P8?(this.vd.prev(),this.dAk()):Z.keyCode===qa.a.w_||Z.keyCode===qa.a.O8?(this.vd.next(),this.dAk()):Z.keyCode===qa.a.hv||Z.keyCode===qa.a.Wue||Z.shiftKey||this.vd.jda())}catch(Ka){D.a.J(512496075,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",Ka)}}EEn(){const Z=this.R5.getCoachElement(Dh.ozm),Ka=document.getElementById("HiddenFocusTrapAnchor");this.RUb.insertBefore(Z,Ka);Z&&Tc.a.addHandler(Z,
ha.a.Lj,Object(e.a)(this,this.bL,"keyDownHandler"))}mSn(Z){if(!this.va.Ga)throw Error.argumentNull("ActiveSlide is null");Dh.K1m();this.TEn();this.Xvf()&&(this.E1.rvh(),this.E1.hGn(Object(e.a)(this,this.gRl,"onRehearsalOptOutSettingsRequestFinished")));const Ka=new en;this.hbd=an(this.la,this.la.x4b);this.eta&&!this.la.jtb&&D.a.J(512496074,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.eta=this.eta&&this.la.jtb;var zb=new lg.a,dc=Object(v.a)(31,this.oc.XZ(this.va.Ga.Xb.sid));
Ka.currentSlideIndex=dc?dc.ph:0;Ka.totalSlideCount=this.oc.hl();dc=this.LMm(Ka);this.R5=(new CoachActorPackage.CoachActorFactory).createCoachActorManager(dc,zb);this.eta&&(this.zqh=this.R5.getRehearsalVideoElement(),this.Eqh=this.R5.getRehearsalVideoCanvas());this.iNj=Z;Z=this.xKi(Ka,this.zqh,this.Eqh);this.KTa=(new CoachPackage.CoachSessionFactory).createCoachManager(Z);Z=this.MMm();this.iCj=(new CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(Z,zb);rb.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&
this.e1.enumerateDevices(Object(e.a)(this,this.vPc,"onEnumerateDevicesSuccess"),Object(e.a)(this,this.Srb,"onDevicesFailure"),Object(e.a)(this,this.csb,"onUnsupported"));this.iEn();this.jEn();this.vmg=0;this.yEj=!1;this.EEn();2===this.iNj&&(zb=localStorage.getItem(Dh.A9j),this.iIl&&!zb?this.n6l():this.YLk())}YLk(){this.nZb=0;this.pBb.execute(Z=>{Z.l_(Im.a.SubtitlesButton,!1);Z.l_(Im.a.LiveButton,!1);Z.l_(Im.a.CoachButton,!1);Z.l_(Im.a.MicButton,!1)});this.KTa.startSession(!0)}n6l(){this.iCj.showCoachFREUI(Z=>
{localStorage.setItem(Dh.A9j,"true");this.YLl=Z;this.YLk()})}vPc(Z){this.F_f=0;if(Z.length)for(var Ka of Z)"audioinput"===Ka.kind&&(this.F_f+=1);else this.F_f=0;this.eIl=!0;Z=new en;Ka=Object(v.a)(31,this.oc.XZ(this.va.Ga.Xb.sid));Z.currentSlideIndex=Ka?Ka.ph:0;Z.totalSlideCount=this.oc.hl();Z=this.xKi(Z,this.zqh,this.Eqh);this.KTa.updateSessionConfiguration(Z)}Srb(Z){D.a.J(512496073,822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",Z.toString())}csb(){D.a.J(512496072,
822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",za.a.Iy)}KRl(){const Z=localStorage.getItem(Dh.A9j);this.iIl&&!Z?this.n6l():this.YLk()}Czg(Z,Ka){Z=new en;Z.currentSlideIndex=Ka.slideIndex;Z.totalSlideCount=this.oc.hl();Ka=this.xKi(Z,this.zqh,this.Eqh);this.KTa.updateSessionConfiguration(Ka);this.R5.updateCoachSlideComponent(Z)}getTraceRequestMetadata(Z,Ka){const zb={};if(Z)for(const dc in Z)zb[dc]=Z[dc];if(Ka)for(const dc in Ka)zb[dc]=Ka[dc];Z=Eb.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString());
zb.AudienceGroup=Z.Ring||"Unknown";zb.BuildVersion=h.AFrameworkApplication.buildVersion||"Unknown";zb.ClientType="web";zb.IdentityProvider=this.la.hostAuthType||h.AFrameworkApplication.ga.La("HostAuthType")||"Unknown";zb.Locale=this.la.Bsb||"Unknown";zb.SpeechMode="rehearsal";zb.TenantId=h.AFrameworkApplication.ga.La("TenantId");zb.UserId=this.getUserId();zb.WacDatacenter=Z.WACDatacenter||"Unknown";zb.WacHost=Z.Host||"Unknown";zb.SourceLanguage=this.la.Pgi||rm(this.la.x4b);return zb}getUserId(){let Z=
h.AFrameworkApplication.ga.La("PptEditingUserId");Va.a.rb(Z)&&(Z=h.AFrameworkApplication.ga.La("LoggableUserId"),f.ULS.sendTraceTag(512496071,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",Va.a.rb(Z)));return Z}kKn(){if(this.la.STl){var Z=this.KTa.getTraceRequestMetadata(),Ka=this.R5.getTraceRequestMetadata(),zb=this.la.wCb.replace("wss","https");if(zb&&zb.length){var dc=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",zb);zb=new XMLHttpRequest;zb.open("POST",
dc,!0);dc=Di.a.create().toString();zb.setRequestHeader("X-Correlation",dc);try{f.ULS.sendTraceTag(512496069,822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",dc);const Jc=this.getTraceRequestMetadata(Z,Ka);zb.send(Eb.c(Jc))}catch(Jc){f.ULS.sendTraceTag(512496068,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",dc)}}else f.ULS.sendTraceTag(512496070,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}}dCb(){this.IDm();this.nZb=3;this.KTa.stopSession();
this.iCj.hideCoachFREAndWelcomeUI();this.R5.hideCoachUI();this.hRj=this.ABj=!1;try{this.KTa.getSessionSummary(Z=>{Z.timeSpentInSeconds=this.vmg;this.ia.Cb(sb.a.ttf,2);this.ia.Cb(sb.a.ptf,2);window.clearInterval(this.aLl);this.yEj&&this.umg.instance.Eec(Z,this.eta,this.hbd,this.kNj,()=>{this.kKn()})})}catch(Z){f.ULS.sendTraceTag(512496067,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",Z)}}lSm(){let Z=",visionFace";this.la.hVl&&(Z+=","+Dh.H_n+","+Dh.G_n);this.la.iVl&&(Z+=
","+Dh.J_n+","+Dh.I_n);this.la.gVl&&(Z+=","+Dh.D_n+","+Dh.E_n+","+Dh.F_n);return Dh.j0n+(am(this.hbd,Dh.uDi)?","+Dh.uDi:"")+","+Dh.xKn+","+Dh.aAm+","+Dh.Ctn+","+Dh.Lwn+(this.la.E$j&&am(this.hbd,Dh.J_i)?","+Dh.J_i:"")+(this.la.Z6j&&am(this.hbd,Dh.GUj)?","+Dh.GUj:"")+(this.la.jtb&&am(this.hbd,Dh.H$l)?Z:"")+(this.la.Wfe&&am(this.hbd,Dh.Ddk)?","+Dh.Ddk:"")+(this.la.Vfe&&am(this.hbd,Dh.Rqi)?","+Dh.Rqi:"")}xKi(Z,Ka,zb){const dc=new Sn;dc.disabledCoachRealtimeFeatures="";dc.userSessionId=h.AFrameworkApplication.userSessionId;
var Jc=new Tn;Jc.docId=h.AFrameworkApplication.ui;Jc.podsSessionId=this.nb.podSessionId;Jc.userDataCenterClusterId=this.nb.rp;Jc.webServiceBase=this.la.$l;dc.documentDownloadConfig=Jc;Jc=new lg.a;dc.logger=Jc;Jc={};Jc.currentSlideIndex=Z.currentSlideIndex.toString();dc.customSettings=Jc;dc.fEnableServiceSideAggregationForCoach=this.la.Rcd;dc.httpTimeoutForCoachSummaryData=this.la.oVl;dc.fSendClientMetaDataOnSessionStart=this.la.Npl;dc.speechFDBase=this.la.wCb;dc.requestedCoachFeatures=this.lSm();
this.Xvf()&&(this.kNj=this.E1.Nvl(!0),dc.requestedRehearsalOptOutFeatures=this.kNj);rb.a("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(dc.enableTimeStampedCritiqueTelemetry=!0);dc.entryPoint=Hm[this.iNj];dc.fEnableVision=this.eta;dc.fEnableVision&&Ka&&zb&&(dc.webcamConfig=Object.assign(new Un,{videoView:Ka,workingCanvas:zb,numFramesPerSecond:this.la.tKe,webcamFrameWidth:this.la.kVl}));dc.supportedRehearsalTemplates=this.R5.getSupportedRehearsalTemplates();rb.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&
this.eIl&&(dc.audioInputDeviceCount=this.F_f);Z=Eb.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString());dc.userId=this.getUserId();dc.tenantId=h.AFrameworkApplication.ga.La("TenantId");dc.identityProvider=this.la.hostAuthType||h.AFrameworkApplication.ga.La("HostAuthType")||"Unknown";dc.audienceChannel="";dc.audienceGroup=Z.Ring||"Unknown";dc.buildVersion=h.AFrameworkApplication.buildVersion||"Unknown";dc.locale=this.la.Bsb||"Unknown";dc.wacHost=Z.Host||"Unknown";dc.wacDatacenter=
Z.WACDatacenter||"Unknown";dc.sourceLanguage=this.la.Pgi||rm(this.la.x4b);D.a.J(512496066,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",this.la.Bsb,this.la.x4b);return dc}MMm(){const Z=new dn;Z.rootContainer=this.RUb;Z.zIndex=Dh.fYl;Z.imagesBaseFilePath=h.AFrameworkApplication.ga.La("CoachImagesBaseFilePath");return Z}LMm(Z){const Ka=new cn;Ka.rootContainer=this.RUb;Ka.slideState=Z;Ka.imagesBaseFilePath=h.AFrameworkApplication.ga.La("CoachImagesBaseFilePath");
Ka.zIndex=Dh.fYl;Ka.fEnableVision=this.eta;Ka.fShowRealtimeFeedbackEnabledCheckbox=this.la.RTl;Ka.fUseNewRealtimePanel=this.la.sdd;Ka.fUseCountdownWelcomeScreen=h.AFrameworkApplication.ga.getBooleanAppSetting("PptCoachEnableCountdownWelcomeUI");Ka.speechFDBase=bn(this.la.wCb);Ka.fDontShowTooltips=za.a.zg;Ka.fUseNewRealtimeCheckbox=rb.a("UseNewRealtimeCheckbox");return Ka}eYn(){2!==this.nZb&&(this.vmg+=1,this.R5&&this.R5.updateTimer(this.vmg))}iEn(){this.R5.on("CoachSessionStarted",()=>{this.nZb=1;
this.aLl=window.setInterval(Object(e.a)(this,this.eYn,"updatePresentationTimer"),1E3);this.KTa.enableVoiceStreaming();this.DQn();this.yEj=!0});this.R5.on("CoachSessionPaused",()=>{this.nZb=2;this.KTa.pauseSession();this.eOb()&&this.Su.instance.hide()});this.R5.on("CoachSessionResumed",()=>{this.nZb=1;this.KTa.resumeSession()})}jEn(){this.KTa.on("SpeechRecognitionStarted",()=>{this.tEj&&this.eOb()&&(this.Su.instance.hide(),this.tEj=!1)});this.KTa.on("PPTCoachRealtimeNotification",Z=>{this.aWm(Z)});
this.KTa.on("QualityStatusChanged",Z=>{this.YWm(Z)});this.KTa.on("MediaStatusChanged",Z=>{this.FWm(Z)});this.KTa.on("Error",Z=>{this.handleError(Z)});this.KTa.on("ConnectionRetry",()=>{this.rWm()})}rWm(){this.tEj=!0;this.eOb()&&this.Su.instance.show(Dh.ptl,jj.a.VBb)}aWm(Z){this.R5.updateCoachRealtimeNotification(Z)}handleError(Z){Z=Object(v.a)(String,Z);this.nZb=4;Z?Z.startsWith("ErrorAudio")?(this.R5&&this.R5.showCoachDisabledUI(0),this.eOb()&&this.Su.instance.show(Dh.pql,jj.a.VBb)):Z.startsWith("ErrorVideo")?
(this.R5&&this.R5.showCoachDisabledUI(1),this.eOb()&&this.Su.instance.show(Dh.sql,jj.a.VBb)):D.a.J(512496064,822,10,"RehearsalManager::handleError unhandled errorInfo"):D.a.J(512496065,822,10,"RehearsalManager::handleError errorInfo null")}i6l(){this.R5&&(this.eta&&this.R5.enableCoachVideoUI(),this.R5.showCoachRealtimeUI(this.YLl));this.eOb()&&this.Su.instance.show(Dh.Xnl,jj.a.z$d)}FWm(Z){"AudioDeviceConnected"===Z.mediaStatus?(this.ABj=!0,this.eta&&!this.hRj||this.i6l()):"VideoSetupCompleted"===
Z.mediaStatus&&(this.hRj=!0,this.ABj&&(this.R5&&this.R5.enableCoachVideoUI(),this.i6l()))}YWm(Z){if(this.la.nBa){var Ka=Z.severity,zb=Z.shortCode;if(0<zb&&zb<Dh.Ail&&Dh.uba[zb])switch(Ka){case 0:this.eOb()&&this.Su.instance.hide();break;case 1:(Z=0<zb?Dh.uba[zb]:Z.shortString)&&this.eOb()&&this.Su.instance.show(Z,jj.a.Ibd);break;case 2:(Z=0<zb?Dh.uba[zb]:Z.shortString)&&this.eOb()&&this.Su.instance.show(Z,jj.a.VBb)}else D.a.J(512496035,822,10,"onQualityStatusChanged: Invalid short code")}}eOb(){return this.la.nBa&&
this.Su&&this.Su.instance&&2!==this.nZb?!0:!1}DQn(){this.eOb()&&(this.Su.instance.show(Dh.Ynl,jj.a.z$d),this.kbd=window.setTimeout(Object(e.a)(this,this.vMf,"hideSoundReminderNotification"),3E3))}vMf(){this.eOb()&&(window.clearTimeout(this.kbd),this.Su.instance.hide())}Xvf(){return this.la.BSc&&!!this.E1}Yqj(){return this.Xvf()?this.wIl:!0}gRl(){this.wIl=!0;this.eta=this.E1.uCi;rb.a("PollToRefreshCoachEntryPointOnRibbon")&&this.qy&&this.qy.BB()}}Object(c.a)(So,"RehearsalManager",null,[1287]);class To{constructor(Z,
Ka,zb){this.Tm=Z;this.ia=Ka;this.la=zb}Eec(Z,Ka,zb,dc,Jc){try{const de=document.createElement("div");de.id="SummaryPageOverlay";de.style.width="100%";de.style.height="100%";de.style.zIndex="999";de.style.display="flex";de.style.flexDirection="column";de.style.justifyContent="center";de.style.position="absolute";var jd=document.getElementById("SummaryPageOverlay");jd&&document.body.removeChild(jd);document.body.insertBefore(de,document.body.firstChild);const Ne=de.parentNode;Tc.a.addHandler(Ne,ha.a.Lj,
Object(e.a)(this,this.TQl,"onParentNodeKeyDownHandler"));var Ed=Z.thumbIndices;if(Ed){jd={};let bh=0;const Ah=this.uTm(Ed);for(let Ui=0;Ui<Ed.length;Ui++)jd[Ed[Ui].toString()]=Ah[Ui],Ah[Ui]||bh++;D.a.J(507843151,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",Ed.length,bh);Z.slideImageSrcs=jd}else Z.slideImageSrcs={},D.a.J(507843150,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");
const Re=h.AFrameworkApplication.$F;Re||D.a.J(507843149,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");zb||(zb=an(this.la,this.la.x4b));Ed={};const Cf=Eb.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString()).WACSessionID;Ed.fFeedbackCardEnabled=this.la.TTl&&Re;Ed.fShowFeedbackButton=Re;Ed.fMonotoneEnabled=this.la.Z6j&&am(zb,Dh.GUj);Ed.fGrammarEnabled=this.la.E$j&&am(zb,Dh.J_i);Ed.fFillersCardEnabled=am(zb,Dh.uDi);Ed.locale=this.la.x4b;Ed.fPronunciationCardEnabled=
this.la.Wfe&&am(zb,Dh.Ddk);Ed.fCrutchWordCardEnabled=this.la.Vfe&&am(zb,Dh.Rqi);Ed.fVisionEnabled=Ka&&this.la.jVl&&this.la.jtb;const yg=Zn(this.la,this.la.x4b);Va.a.rb(yg)||(Ed.fPacingGaugeRange=yg);Va.a.rb(Cf)||(Ed.clientSessionId=Cf);this.la.BSc&&(Ed.rehearsalOptOutFeatures=dc);(new rehearsalSummaryPage.RehearsalSummaryPageController(de,Z,()=>{D.a.J(507843148,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");Jc&&Jc();this.ia&&(de.parentNode.removeChild(de),this.ia.Qa(sb.a.tUa,
2,{entryPoint:3}))},()=>{Jc&&Jc();Tc.a.removeHandler(Ne,ha.a.Lj,Object(e.a)(this,this.TQl,"onParentNodeKeyDownHandler"))},this.la.$l,decodeURIComponent(this.la.ucd),()=>{this.KPn()},Ed,bn(this.la.wCb),"Web",()=>{this.wPn()})).renderSummaryPage()}catch(de){D.a.J(507843146,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",de.toString())}}TQl(Z){"MainApp"===Z.target.id&&(Z.preventDefault(),Z.stopPropagation())}wPn(){D.a.J(507843145,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");
this.ia&&this.la.BSc&&this.ia.Qa(sb.a.UUg,2,null)}KPn(){D.a.J(507843144,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");this.ia&&(this.la.MUl?this.ia.Qa(sb.a.nmk,2,null):this.ia.Qa(w.a.Aca,2,!1))}uTm(Z){const Ka=Array(Z.length);if(!this.Tm)return Ka;const zb=this.Tm.DJ(),dc=this.Tm.v$a();for(let Jc=0;Jc<Z.length;Jc++){const jd=dc[zb[Z[Jc]].sid.toString()];jd&&jd.thumbnailImage.length&&(Ka[Jc]=jd.thumbnailImage)}return Ka}}Object(c.a)(To,"RehearsalSummaryPageHelper",
null,[]);class Jm{constructor(Z,Ka,zb,dc,Jc){this.cad=!1;this.ua=new Ad.a;this.ia=Z;this.EGe=new To(Ka,this.ia,dc);this.lJj=zb;this.Vph=Jc}Hb(){this.ia.za(sb.a.Eec,Na.a.application,Object(e.a)(this,this.GQn,"showSummaryPage"));this.ia.za(sb.a.nmk,Na.a.application,Object(e.a)(this,this.NPn,"showFloodgateSurvey"))}Eec(Z,Ka,zb,dc,Jc){this.EGe.Eec(Z,Ka,zb,dc,Jc)}GQn(Z,Ka,zb,dc,Jc){switch(zb){case 2:return this.EGe.Eec(Jc,!1,null,null,null),32;case 1:if(this.cad)return 32;break;default:D.a.J(509117593,
822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8}NPn(Z,Ka,zb){switch(zb){case 2:return this.Vph.execute(dc=>{dc.wwb("PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),32;case 1:if(this.cad)return 32;break;default:D.a.J(509117592,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8}YVd(){const Z=Date.now();this.lJj("rehearsalSummaryPage").then(()=>{const Ka=h.AFrameworkApplication.ga.La("RehearsalSummaryPageCssUrl"),zb=document.createElement("link");
zb.setAttribute("rel","stylesheet");zb.setAttribute("type","text/css");zb.setAttribute("href",Ka);$addHandler(zb,"load",()=>{this.cad=!0;this.ua.raiseEvent("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs);D.a.J(509117591,817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-Z)});document.body.appendChild(zb);return null})}wqm(Z){this.ua.addHandler("OnRehearsalSummaryResourcesLoaded",Z)}jGn(Z){this.ua.removeHandler("OnRehearsalSummaryResourcesLoaded",Z)}}Object(c.a)(Jm,"RehearsalSummaryPageActor",
null,[1285]);class Uo{constructor(Z,Ka,zb,dc,Jc){this.mDl=this.VBl=!1;this.ia=Z;this.Aa=Ka;this.jNj=zb;this.umg=dc;this.ucc=Jc;this.jNj.execute(jd=>{jd.iqm(Object(e.a)(this,this.yPl,"onCoachResourcesLoaded"))});this.umg.execute(jd=>{jd.wqm(Object(e.a)(this,this.iRl,"onRehearsalSummaryResourcesLoaded"))})}dispose(){this.jNj.instance&&this.jNj.instance.bGn(Object(e.a)(this,this.yPl,"onCoachResourcesLoaded"));this.umg.instance&&this.umg.instance.jGn(Object(e.a)(this,this.iRl,"onRehearsalSummaryResourcesLoaded"))}yPl(){this.VBl=
!0;this.g8l()}iRl(){this.mDl=!0;this.g8l()}g8l(){this.VBl&&this.mDl&&uc.a.get_instance().$i(10,null).continueWith(()=>{if(this.Aa.bHk&&this.Aa.fVl){const Z=document.getElementById("rehearsal-loading-dialog-modal");Z?(Z.style.display="none",D.a.J(507843080,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):D.a.J(507843079,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===this.ia.Cb(sb.a.tUa,1))if(this.Aa.bHk)this.ia.Qa(sb.a.tUa,2,{entryPoint:5});
else if(!this.Aa.isCreateNew&&this.Aa.zak&&this.Aa.NUl)try{this.ucc.continueWith(()=>{this.ucc.result.logActivity("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled")}),D.a.J(507843078,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(Z){D.a.J(507843077,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",Z)}})}}Object(c.a)(Uo,"RehearsalTrigger",null,[1288]);class bl{constructor(){this.$=this.E1=
null}get name(){return"PowerPointWebEditor.Rehearsal"}bzm(){this.$.register(1285,"PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").ma().na(()=>new Jm(h.AFrameworkApplication.vb,this.$.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),Rg.a(this.$),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.Na("Common.ISystemInitiatedFeedback")));this.$.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").Hb()}lc(Z){this.$=Z;this.$.Na("PowerPointWebEditor.IThumbnailDataStoreManager").execute(()=>
{this.bzm()});if(this.$.resolve("PowerPointWebEditor.IApplicationSettings").mBa){this.$.register(1286,"PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings").ma().na(()=>new Yk(h.AFrameworkApplication.ye,this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.$.resolve("Common.IActionManagerExtended")));this.E1=this.$.resolve("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");const Ka=this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame");
this.$.register(1287,"PowerPointWebEditor.Rehearsal.IRehearsalManager").ma().na(()=>new So(h.AFrameworkApplication.vb,Ka,this.$.resolve("Common.IDynamicScriptLoaderProvider"),this.$.resolve("PowerPointWebEditor.ISlideshowFrame"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),l.a.instance.Na("PowerPointWebEditor.ISlideShowVoiceNotification"),
l.a.instance.Na("PowerPointWebEditor.ISlideshowToolbar"),l.a.instance.Na("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),this.E1,this.$.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.$.resolve("PowerPointWebEditor.IRibbonUser")));this.$.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").Hb();this.$.register(1288,"PowerPointWebEditor.Rehearsal.IRehearsalTrigger").ma().na(()=>new Uo(h.AFrameworkApplication.vb,this.$.resolve("PowerPointWebEditor.IApplicationSettings"),
l.a.instance.Na("PowerPointWebEditor.Rehearsal.IRehearsalManager"),l.a.instance.Na("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),Me.a.aG(l.a.instance.Na("Common.ISystemInitiatedFeedback"))));this.$.resolve("PowerPointWebEditor.Rehearsal.IRehearsalTrigger")}}init(){h.AFrameworkApplication.ga.fg(Object(e.a)(this,this.su,"onFullAppSettingsReady"))}su(){this.$.resolve("PowerPointWebEditor.IApplicationSettings").HVf&&uc.a.get_instance().$i(7,()=>{this.$.Na("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").execute(()=>
{this.initialize()})})}initialize(){this.$.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").YVd();this.$.resolve("PowerPointWebEditor.IApplicationSettings").mBa&&this.$.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").YVd();if(this.$.resolve("PowerPointWebEditor.IApplicationSettings").BSc){const Z=new Rn(Rg.a(this.$),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.E1,this.$.resolve("PowerPointWebEditor.IApplicationSettings"));
Z.Hb();Z.ve();this.E1.y2m()}}dispose(){}static main(){b.a.instance.Fc(new bl)}}Object(c.a)(bl,"PPTWebEditorRehearsalPackage",null,[3,4]);class Km{static Xib(Z){try{return caches.open(Km.O4k).then(Ka=>Ka.match(Z))}catch(Ka){return Promise.reject(null)}}static Q7c(Z,Ka){try{return Km.Xib(Z).then(zb=>zb&&Number.parseInvariant(zb.headers.get("cachedTime"))>Date.now()-Ka?Promise.resolve(zb.text().toLocaleString()):Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch(zb){return Promise.reject(null)}}static store(Z,
Ka){try{return caches.open(Km.O4k).then(zb=>{zb.put(Z,Ka).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(zb){return Promise.resolve(!0)}}static NSn(Z,Ka){const zb={};zb.body=Ka;const dc={};dc.cachedTime=Date.now().toString();zb.headers=dc;Ka=new Response(Ka,zb);Km.store(Z,Ka).then(()=>!0)}}Km.O4k="ConsentState";Object(c.a)(Km,"CacheManager",null,[]);class Vn{constructor(){this.message=null;this.httpStatusCode=0}}Object(c.a)(Vn,"HttpRequstToPromiseRejectData",null,[]);class Ok{constructor(Z){this.Uyb=
Z}Vmb(Z,Ka,zb,dc,Jc,jd){m.a.sendTelemetryEvent(Object.assign(new z.a,{name:"Office.Online."+Z,dataFields:[Object.assign(new y.a,{name:"EventMessage",string:Ka}),Object.assign(new y.a,{name:"FormFactor",string:this.Uyb.formFactor}),Object.assign(new y.a,{name:"CorrelationId",string:this.Uyb.correlationId}),Object.assign(new y.a,{name:"AccountType",string:this.Uyb.accountType}),Object.assign(new y.a,{name:"OSVersion",string:this.Uyb.osVersion}),Object.assign(new y.a,{name:"AppId",string:this.Uyb.appId}),
Object.assign(new y.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new y.a,{name:"ConsentLanguage",string:this.Uyb.consentLanguage}),Object.assign(new y.a,{name:"EventCode",string:zb}),Object.assign(new y.a,{name:"Region",string:this.Uyb.region}),Object.assign(new y.a,{name:"ModelType",string:dc}),Object.assign(new y.a,{name:"ModelId",string:Jc}),Object.assign(new y.a,{name:"Platform",string:this.Uyb.os}),Object.assign(new y.a,{name:"ReConsentReason",string:""}),Object.assign(new y.a,
{name:"ConsentType",string:jd})]}))}}Object(c.a)(Ok,"TelemetryLogger",null,[]);class xm{constructor(Z,Ka,zb){this.wgm="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Ba=Z;this.$m=Ka;this.h4c=zb;this.vHa=new Ok(zb)}X9(Z,Ka){return new Promise((zb,dc)=>{const Jc=this.Ba.Jc("UCNoticeCheckinCallTimeoutMs",5E3);let jd=this.Ba.La("UCNoticeCheckinStateUrl");jd&&jd.length||(jd=this.wgm);this.$m.HZ(jd,1,null,this.DPb(Z),null,!1,0,Ed=>{try{if(void 0===Ed||null===Ed||void 0===Ed.data||
null===Ed.data||void 0===Ed.data.responseData||null===Ed.data.responseData){this.vHa.Vmb("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);const Ne=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");dc(this.Hfa(Ne,Ed))}else if(Ed.data.Ze!==fd.a.bC){this.vHa.Vmb("UnifiedConsent.ConsentGetFailed","CheckInApi : HTTP failure",Ed.data.Ze.toString(),
null,null,null);const Ne=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Ed.data.Ze,"UnifiedConsent.ConsentGetFailed");dc(this.Hfa(Ne,Ed))}else{var de=Ka(Ed.data.responseData);if(de)zb(de);else{this.vHa.Vmb("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty","712",null,null,null);const Ne=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
"UnifiedConsent.ConsentGetFailed");dc(this.Hfa(Ne,Ed))}}}catch(Ne){this.vHa.Vmb("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),de=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Ne,"UnifiedConsent.ConsentGetFailed"),dc(this.Hfa(de,Ed))}},Ed=>{this.vHa.Vmb("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",Ed.data.Ze.toString(),null,null,null);const de=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",
Ed.data.Ze,"UnifiedConsent.ConsentGetFailed");dc(this.Hfa(de,Ed))},null,void 0,void 0,2500,Jc)})}Hfa(Z,Ka){const zb=new Vn;zb.message=Z;zb.httpStatusCode=Ka&&Ka.data?Ka.data.Ze:-1;return zb}DPb(Z){const Ka={};Ka["Accept-Language"]=this.h4c.consentLanguage;Ka.consentsurface="AppStart";Ka.platform="Web";Ka.formfactor=za.a.u9c?"Mobile":"Desktop";Ka["x-Cid"]=this.h4c.correlationId;Ka.Authorization="Bearer "+Z;return Ka}}Object(c.a)(xm,"HttpRequestToPromiseUtility",null,[]);class ym{constructor(){this.accountType=
"MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(c.a)(ym,"WebSdkAdapterProps",null,[]);class Ml{constructor(Z,Ka,zb,dc){this.A7k=this.jgc=this.iHb=this.Ryb=null;this.gun=Jc=>{if(void 0===Jc||null===Jc)return this.vHa.Vmb(Ml.Xmd,"Checkin response undefined or null",
"705",this.Ryb,this.iHb,this.jgc),null;try{const {BD:jd}=Eb.d(Jc);return jd}catch(jd){this.vHa.Vmb(Ml.Xmd,"Checkin response parse error : "+jd.message,"706",this.Ryb,this.iHb,this.jgc)}return null};this.kwe=dc;this.Ba=Z;this.Sfm=zb;this.$m=Ka;this.h4c=this.dCf();this.vHa=new Ok(this.h4c)}zPn(){"MSA"===(this.Ba.La("HostAuthType")||"").toUpperCase()&&Km.Q7c(this.h4c.userId,this.Ba.Jc("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.vHa.Vmb(Ml.Xmd,"CacheFound","701",this.Ryb,this.iHb,this.jgc);return{}}).catch(()=>
{this.Sfm.execute(Z=>{Z.qN("Consent",Ml.wmm).then(Ka=>{Ka.IsSuccess?(this.vHa.Vmb(Ml.Xmd,"CheckInTokenSuccess","702",this.Ryb,this.iHb,this.jgc),this.bNm(Ka.Token).then(zb=>{this.BQm(zb);this.Ryb&&""!==this.Ryb&&Z.qN("Consent",Ml.xmm).then(dc=>{dc.IsSuccess?(this.vHa.Vmb(Ml.Xmd,"WebTokenSuccess","703",this.Ryb,this.iHb,this.jgc),this.jQn(dc,this.Ryb)):this.vHa.Vmb(Ml.Xmd,"WebTokenFailed : "+dc.ErrorMessage,dc.ErrorCode,this.Ryb,this.iHb,this.jgc);return{}});return{}})):this.vHa.Vmb(Ml.Xmd,"CheckInTokenFailed : "+
Ka.ErrorMessage,Ka.ErrorCode,this.Ryb,this.iHb,this.jgc);return{}})})})}bNm(Z){this.A7k=new xm(this.Ba,this.$m,this.h4c);return this.A7k.X9(Z,this.gun).then(Ka=>Promise.resolve(Ka),Ka=>Promise.reject("Error while getting result"+Ka))}BQm(Z){for(const Ka of Z.consentValues)if(Ka.needConsent&&!Ka.maxPromptsReached){this.iHb=Ka.id;this.jgc=Ka.consentType;this.Ryb=Ka.modelType;return}Km.NSn(this.h4c.userId,Eb.c(Z))}jQn(Z,Ka){if(cc.a("showConsentNotice")){const zb=document.createElement("div");document.body.appendChild(zb);
appChrome.api.showConsentNotice(this.jOm(Z.Token,Ka),zb)}else this.vHa.Vmb(Ml.pjm,"1JS : ShowConsentNotice API not found","704",this.Ryb,this.iHb,this.jgc)}jOm(Z,Ka){const zb=this.h4c;zb.token=Z;zb.modelType=Ka;return zb}dCf(){const Z=this.Iaj(this.Ba.La("SessionStartInfoJson"));return Object.assign(new ym,{emailId:this.Ba.La("UserPrincipalName"),userId:this.Ba.La("LoggableUserId"),accountType:"AAD"===(this.Ba.La("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Ba.La("OfficeApplicationId"),
appVersion:this.Ba.La("appVersion"),appName:"Application"in Z?Z.Application:"",appEnv:this.kwe,consentLanguage:this.Ba.La("UICulture")||"en-US",formFactor:za.a.u9c?"Mobile":"Desktop",os:"Os"in Z?Z.Os:"",osVersion:"OsVersion"in Z?Z.OsVersion:"",region:this.Ba.La("region"),correlationId:Di.a.create().toString(),isDarkMode:this.Ba.getBooleanAppSetting("DarkModeIsOn"),useCache:!0})}Iaj(Z){let Ka={};try{Ka=Eb.b(Z)}catch(zb){}return Ka}}Ml.xmm="https://consentservice.microsoft.com/web";Ml.wmm="https://consentservice.microsoft.com/checkin";
Ml.pjm="UnifiedConsent.ConsentGetFailed";Ml.Xmd="UnifiedConsent.AuthTokenStatus";Object(c.a)(Ml,"ConsentNoticeManager",null,[1337]);class jn{constructor(){this.Ha=null}get name(){return"Common.App.ConsentNoticeDialog"}lc(Z){this.Ha=Z;Z.register(Ml,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").ma().na(()=>new Ml(h.AFrameworkApplication.ga,h.AFrameworkApplication.ye,Z.Na("Common.App.OAuth.IOAuthManager"),h.AFrameworkApplication.ztc))}init(){this.Ha.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){b.a.instance.Fc(new jn)}}
Object(c.a)(jn,"ConsentNoticeDialogPackage",null,[3,4]);var Nm;(function(Z){Z[Z.Log=0]="Log";Z[Z.sbm=1]="ClientCount"})(Nm||(Nm={}));Object(c.b)("MessageType",Nm);var Lm;(function(Z){Z[Z.Edm=0]="ReadyToReceiveMessages";Z[Z.xdm=1]="QueryWaitingClients";Z[Z.$am=2]="ActivationSignal"})(Lm||(Lm={}));Object(c.b)("ClientRequestType",Lm);var Wn;(function(Z){Z[Z.Info=0]="Info";Z[Z.Error=1]="Error";Z[Z.Warning=2]="Warning"})(Wn||(Wn={}));Object(c.b)("LoggingLevel",Wn);class Xn{constructor(Z){this.ben="/pods/pptsw.ashx";
this.kXm=(Ka,zb)=>{Ka.addEventListener("updatefound",()=>{f.ULS.sendTraceTag(507605647,801,50,`ServiceWorkerManager.handleServiceWorkerUpdate: Installing new SW, this page was loaded with SW:${!!zb}`);const dc=Ka.installing;null!=dc&&(dc.onstatechange=()=>{"installed"===dc.state&&this.C1l()})});Ka.active&&Ka.waiting&&this.C1l()};this.jYn=Ka=>{Object(mj.b)(this,void 0,void 0,function*(){var zb,dc;if(0==Ka.Pun){const Jc=((yield null===(zb=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||
void 0===zb?void 0:zb.getRegistrations())||[]).find(jd=>jd.waiting);zb={ikl:Lm.$am};null===(dc=null===Jc||void 0===Jc?void 0:Jc.waiting)||void 0===dc?void 0:dc.postMessage(zb)}f.ULS.sendTraceTag(507594304,801,50,`ServiceWorkerManager.updateSWIfApplicable: pendingClientCount ${Ka.Pun}`)})};this.C1l=()=>{var Ka;const zb={ikl:Lm.xdm,data:""};null===(Ka=navigator.serviceWorker.controller)||void 0===Ka?void 0:Ka.postMessage(zb)};this.snn=()=>{var Ka;const zb={ikl:Lm.Edm,data:""};null===(Ka=navigator.serviceWorker.controller)||
void 0===Ka?void 0:Ka.postMessage(zb)};this.$lk=(Ka,zb)=>{null===Ka||void 0===Ka?void 0:Ka.addEventListener("statechange",dc=>{f.ULS.sendTraceTag(507605646,801,50,`ServiceWorkerManager.register: initial state: ${zb}, state changed to ${dc.target.state}`)})};this.HEn=()=>{navigator.serviceWorker.addEventListener("message",Ka=>{try{const zb=Ka.data;switch(zb.messageType){case Nm.Log:this.M$m(zb);break;case Nm.sbm:this.jYn(zb)}}catch(zb){f.ULS.sendTraceTag(507603107,801,10,`ServiceWorkerManager.message: failed to parse message, error msg: ${zb.message}`)}})};
this.M$m=Ka=>{Ka.loggingLevel==Wn.Error?f.ULS.sendTraceTag(507605645,801,10,`ServiceWorkerManager.message: ${JSON.stringify(Ka)}`):f.ULS.sendTraceTag(507605644,801,50,`ServiceWorkerManager.message: ${JSON.stringify(Ka)}`)};this.Fb=Z}Wlk(){za.a.gum&&navigator.serviceWorker.getRegistrations?this.aXm():f.ULS.sendTraceTag(507609371,801,10,"ServiceWorkerManager.registerServiceWorker: ServiceWorker is not supported")}aXm(){const Z=this.Fb.getBooleanAppSetting("EnableSWRegistration"),Ka=Z?"registration":
"unregistration";(Z?this.register():this.unregister()).then(()=>{f.ULS.sendTraceTag(507609373,801,50,`ServiceWorkerManager.handleRegistration: ${Ka} completed`)}).catch(zb=>{f.ULS.sendTraceTag(507609372,801,10,`ServiceWorkerManager.handleRegistration: ${Ka} failed: ${zb}`)})}register(){return Object(mj.b)(this,void 0,void 0,function*(){const Z=navigator.serviceWorker.controller;this.HEn();this.snn();return navigator.serviceWorker.register(this.ben).then(Ka=>{this.$lk(Ka.installing,"installing");this.$lk(Ka.active,
"active");this.$lk(Ka.waiting,"waiting");this.kXm(Ka,Z)})})}unregister(){return Object(mj.b)(this,void 0,void 0,function*(){const Z=yield navigator.serviceWorker.getRegistrations();for(const Ka of Z)return Ka.unregister()})}}Object(c.a)(Xn,"ServiceWorkerManager",null,[]);class zm{constructor(){this.Fb=this.$=null}get name(){return"PowerPointWebEditor.ServiceWorkerPackage"}lc(Z){this.$=Z;this.Fb=this.$.resolve("Common.IAppSettingsManager")}init(){this.Fb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnablePPTServiceWorkerPackage",
!1)&&this.$.resolve("PowerPointWebEditor.IAppBootCompletedListener").Uxa(()=>{this.Wlk()})}Wlk(){(new Xn(this.Fb)).Wlk()}dispose(){}static main(){b.a.instance.Fc(new zm)}}Object(c.a)(zm,"ServiceWorkerPackage",null,[3,4]);var Yn=a(154);Type.registerNamespace("Box4.Media");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointVersionHistory");Type.registerNamespace("PowerPointWeb");Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerPointWebEditor.Accessibility");Type.registerNamespace("PowerPointWebEditor.AgendaConverter");Type.registerNamespace("PowerPointWebEditor.Designer");Type.registerNamespace("PowerPointWebEditor.ImageDescription");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.Live");Type.registerNamespace("PowerPointWebEditor.PenMinutes");Type.registerNamespace("PowerPointWebEditor.PresentToTeams");Type.registerNamespace("PowerPointWebEditor.Rehearsal");
Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");Type.registerNamespace("PowerPointWebEditor.Text");Type.registerNamespace("PowerPointWebEditor.VersionHistory");Object(Yn.c)("Chronos2");Type.registerNamespace("Common.App.AccessibilityChecker");yb.main();pa.main();pc.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AccessibilitySettings");Vc.main();Type.registerNamespace("Common.App.RibbonSettings");
Lh.main();Type.registerNamespace("Common.App.DirectPrint");b.a.instance.Fc(new Id);Type.registerNamespace("Common.App.DisplayEnvironmentName");Cc.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.InProductMessaging");We.main();Type.registerNamespace("Common.App.NewAndOpen.UX");b.a.instance.Fc(new lf);Type.registerNamespace("Common.App.OneDriveFilePickerApi");hi.main();Type.registerNamespace("Common.App.PenMinutesManager");Bh.main();Type.registerNamespace("Common.App.SaveAsToHost");
Rh.main();Type.registerNamespace("Common.App.SaveToSharePoint");Xf.main();Type.registerNamespace("Common.App.SaveToCloudStorage");ce.main();Type.registerNamespace("Common.App.SaveACopy");$c.main();Type.registerNamespace("Common.App.PhoneLink");ue.main();Type.registerNamespace("Common.App.SharedFilePicker");Ee.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SearchOAuthManager");Gg.main();Type.registerNamespace("Common.App.WopiIdentity");hh.main();Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("Common.App.ConsentNoticeDialog");jn.main();dj.main();nj.main();Zi.main();Lj.main();Tj.main();re.main();b.a.instance.Fc(Ea.a(new xf,0));hm.main();Type.registerNamespace("Common.App.LivePersonaUtils");pl.main();bl.main();zm.main();Object(Yn.b)("Chronos2")},475:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.BQ="data-copystatus";c.ODa="data-copyfailedreason";c.fp="data-clipservice-ccpid";c.version="data-clipservice-version";
c.location="data-clipservice-location";c.aC="data-clipservice-dc";c.type="data-clipservice-type";c.Mbd="data-clipservice-param";c.count="data-clipservice-count";c.i8="data-clipservice-cut";c.Ssa="data-clipservice-isEmptyPlaceholder";c.client="data-clipservice-client";c.bdh="data-clipboardasbytes-url";c.CPe="wacserver";c.sessionId="data-SessionId";c.Yvb="data-ShapeIds";c.slideId="data-SlideId";c.timeStamp="data-TimeStamp";c.yjh="data-willexpire";c.YDe="ClipboardAsImage";c.Fx="data-pkey";Object(x.a)(c,
"ClipServiceConstants",null,[])},493:function(x,G,a){a.d(G,"a",function(){return y});x=a(0);var c=a(5),b=a(94),f=a(1580),e=a(231),h=a(274);class u{constructor(){this.shapeType=this.e0b=this.ybd=this.Qbd=this.Pbd=0;this.om=this.Go=this.Zl=this.Kg=!1;this.s9a=null}}Object(x.a)(u,"ShapeProperties",null,[]);var m=a(248),n=a(260),l=a(302),r=a(178),w=a(250);class y{constructor(z,A,B,H,v,C,F,D,N){this.Xn=z;this.Qk=A;this.Ia=F;this.WZb=C.dxh;this.fmg=this.rnf();this.mr=B;this.cL=H;this.xe=v.Oa;this.wag=C.oRa;
this.Ub=N}cJe(z,A,B,H,v,C){C=void 0===C?null:C;if(A){var F=this.Ia.hKa(B);F&&(Array.remove(B,F),Array.add(B,this.Ia.ev(F)));this.Gpe(B);var D=B.length;F=Array(D);H=this.o8c(A,H);for(var N=0;N<D;N++){var U=B[N],W=this.UEf(U,H);F[N]=Object.assign(new u,{Pbd:W.x,Qbd:W.y,ybd:U.Tv,e0b:U.Ez,shapeType:U.shapeType,Kg:U.Kg,Zl:U.Zl||2===U.mediaType||1===U.mediaType,Go:U.Zc,om:U.om,s9a:""});F[N].Kg&&(W=Object(e.a)(284,U.tc(this.xe)),F[N].s9a=W?W.ENe:"",m.a.J(512500632,826,50,"PendingImage: {0}, State: {1}, HasImageId: {2}",
U.Eyc,this.cL.UV(U),0<F[N].s9a.length))}N=A.Xb;U=A.Ju();W=[];H=!0;var L=z.lj===A.lj,O=z.en===A.en,M=!1;z!==A&&(L?(M=z.WKa||A.WKa,O||(M=z.OKa||A.OKa||M),H=!M):H=!1,!H||z.io===A.io&&z.ek===A.ek||(H=!1));for(var K=0;K<D;K++)this.YTg(B[K])||(W.push(B[K]),H&&(H=this.lTg(B[K],O)));B=W;m.a.J(512500631,826,50,"{0}",{["LocalRenderEnabled"]:H,["SameSlide"]:z===A,["SameMaster"]:L,["SameLayout"]:O,["ThemeOverrides"]:M});D=[];K=M=O=L=W=!1;for(let P=0;P<B.length;P++){const V=F[P],Y=this.Qk.AAe(!1,N.cid,N.sid,V.Pbd,
V.Qbd,0,!1,V.ybd,1>V.e0b?1:V.e0b,U+B[P].get_zIndex(),z.id,B[P],V.shapeType,V.Kg,V.s9a,H);c.a.rb(C)||(Y.hc=C);D.push(Y);W=W||V.Kg;L=L||V.Zl;O=O||V.Go;M=M||V.om;K=K||this.wag&&y.YTf(Y)}v=y.Ake(W,L,O,M,K,v);if(0<D.length&&(z=H?B:null,this.Xn.WM(D,A,v,z),H&&n.a.Ab)){if(z){A="";for(const P of z)A+=this.Ia.sAb(P)+",";n.a.Ab.Ya(l.a.Gdh,A);n.a.Ab.Ya(l.a.Hwh,z.length.toString())}n.a.Ab.Xi=!0;n.a.Ab.BUa=!0}}}ceh(z,A,B,H,v,C){var F=this.o8c(z,B);B=[];const D=A.WBb,N=!!D&&!b.a.rb(D.kUd);C=this.TEf(C,F);for(F=
0;F<A.objectCount;F++){const U=this.Qk.Mdh(!0,z.cid,z.sid,0,C.x,C.y,v);if(Object(w.a)("CutPasteResizeShapeInvisibleFix")){const W=!!D&&!b.a.rb(D.lUd);U.Ce=W&&D.lUd[F]}U.isEditable=N&&D.kUd[F];B.push(U)}0<B.length&&this.Xn.WM(B,z,H)}vFf(z){try{const A=atob(z.slice(0,50)).slice(16,24),B=Uint8Array.from(A,v=>v.charCodeAt(0)),H=new DataView(B.buffer);return{width:H.getInt32(0),height:H.getInt32(4)}}catch(A){return m.a.J(508127176,307,10,"Exception while calculating image dimension. Exception : {0}",A),
{width:0,height:0}}}TEf(z,A){const B=A*y.pJ;A*=y.pJ;var H=new h.a(B,A);z&&(H={width:z.clientWidth,height:z.clientHeight},Object(w.a)("GetPngDimension")&&z.src&&(z=z.src,z=z.slice(22,-1),H=this.vFf(z)),H=this.Ub.Nja(H.width,H.height))&&(H.x+=B,H.y+=A);return H}YTg(z){return z.Cz&&this.WZb||!z.bSd}lTg(z,A){return z.Eyc||this.cL.UV(z)||z.pl&&z.hasText&&!A&&10!==z.placeholderType&&12!==z.placeholderType||z.ht?!1:!0}Gpe(z){z.sort((A,B)=>A.get_zIndex()-B.get_zIndex())}$kh(z){return z?this.fmg.contains(z):
!1}o8c(z,A){if(!z)return 0;if(!A)return y.Wff;let B,H;return A.K(B=z.Xb,(H=A.ha(B))+1),H}UEf(z,A){var B=this.mr.presentation;if(!B)throw Error.argumentNull("Presentation is null");let H=z.hx,v=z.ix;z=B.jih(B.QB(z.slideId));B=Math.round(y.pJ/z)*z;z=f.a.vf(B,0);for(B=f.a.vf(B,1);0<A;)H+=z,v+=B,A--;return new h.a(H,v)}fzh(z){try{if(z&&z.clipboardData){const A=z.clipboardData.types;for(let B=0;B<A.length;B++){const H=z.clipboardData.getData(A[B]);if(this.aQf(H))return H}}}catch(A){}return null}aQf(z){return!!z&&
0<z.length&&this.RVf(z)}RVf(z){z=z.trim().toLowerCase();return z.startsWith("http:")||z.startsWith("https:")}lwh(z,A,B){z&&(z.setAttribute(y.p5c,A.toString()),z.setAttribute(y.o5c,B.toString()),z.setAttribute(y.r5c,"true"))}rnf(){const z=new r.a;z.add("param");z.add("map");z.add("area");z.add("script");z.add("noscript");z.add("col");z.add("colgroup");z.add("caption");z.add("head");z.add("title");z.add("link");z.add("meta");z.add("style");z.add("base");z.add("input");z.add("textarea");z.add("select");
z.add("option");z.add("optgroup");z.add("button");z.add("hr");return z}Ahh(z){return this.Efd(z,y.p5c)}yhh(z){return this.Efd(z,y.o5c)}qSf(z){return z?"true"===z.getAttribute(y.r5c):!1}ezh(z){if(this.tUd(z)){const A=z.indexOf('"')+1,B=z.lastIndexOf('"');if(1<A&&B>A&&(z=z.slice(A,B),z.startsWith(y.agf)))return z}return null}tUd(z){return!!z&&z.length>y.jgf&&z.startsWith(y.bgf)}Efd(z,A){let B=0;this.qSf(z)&&(B=parseFloat(z.getAttribute(A)));return isNaN(B)?0:B}t5c(z){return this.Eoc(z).returnValue}Eoc(z){let A;
A=2;let B=0,H=0,v=0,C=0,F=0,D=0,N=0,U=0,W=0,L=0,O=0,M=0,K=0,P=0,V=0,Y=0,ta=0;for(const fa of z)fa.Zc?(A=2===A?6:20,B++):fa.rg?(A=2===A?12:20,H++):fa.om?(A=2===A?7:20,v++):fa.Ce?(A=2===A?13:20,C++):22===fa.y$a?(A=2===A?10:20,F++):fa.Kg?(A=2===A?5:20,D++):fa.Uq?(A=2===A?3:20,N++):fa.Lca?(A=2===A?14:20,fa.Cz&&W++,U++):fa.pl?(A=2===A?14:20,fa.Cz&&O++,L++):fa.au?(A=2===A?15:20,M++):fa.OX?(A=2===A?16:20,K++):fa.Zl?(A=2===A?18:20,P++):fa.ht?(A=2===A?11:20,V++):fa.B5?(A=2===A?17:20,Y++):(A=2===A?4:20,ta++);
return{returnValue:String.format("numTotalShapes={0}, numTables={1}, numSmartArt={2}, numCharts={3}, numGroups={4}, numInk={5}, numPictures={6}, numTextbox={7}, numTitlePlaceholder={8}, numEmptyTitlePlaceholder={9}, numNonTitlePlaceholder={10}, numEmptyNonTitlePlaceholder={11}, numLine={12}, numActiveX={13}, numMedia={14}, numAppForOffice={15}, numOleObject={16}, numNormalShape={17}",z.length,B,H,v,C,F,D,N,U,W,L,O,M,K,P,V,Y,ta),contentType:A}}static Bvh(z){for(const A of z)if(!A.bSd||A.isLocal)return!1;
return!0}static YTf(z){return z&&4===z.nJ?(!z.fill||!!z.fill.noFillField)&&(!z.lineStyle||!!z.lineStyle.noFillField):!1}static Ake(z,A,B,H,v,C){return z||A||B||H||v?C:0}}y.r5c="data-from-ppt-online";y.p5c="data-image-width-mu";y.o5c="data-image-height-mu";y.agf="data:image/";y.bgf="<img src=";y.jgf=14;y.Wff=1;y.pJ=15;Object(x.a)(y,"CopyPasteUtility",null,[816])},568:function(x,G,a){a.d(G,"a",function(){return r});x=a(0);var c=a(231),b=a(259),f=a(584),e=a(345),h=a(256),u=a(278),m=a(248),n=a(703),l=
a(704);class r{constructor(w){this.Dx=w}get node(){return this.Dx}get propertySet(){return this.Dx}get KN(){if(1074135132===this.Dx.Me)return 0;if(1074135137===this.Dx.Me)return 1;m.a.J(508842136,802,10,"Invalid AppType {0}",f.a[this.Dx.Me]);return-1}get id(){return 0===this.KN?this.propertySet.oa(h.a.I4,null)+this.shapeId.toString()+this.slideId.toString():this.propertySet.oa(h.a.I4,null)}get Neh(){return this.propertySet.oa(b.a.fze,null)}get visibility(){return this.propertySet.oa(b.a.n$b,!1)}get width(){return this.propertySet.oa(b.a.Cbh,
320)}get row(){return this.propertySet.oa(b.a.Bbh,0)}get fkh(){return this.propertySet.oa(e.a.isForUILessAction,!1)}get oub(){return this.propertySet.oa(b.a.Ofb,null)}get version(){return this.propertySet.oa(b.a.qnc,null)}get store(){return this.propertySet.oa(b.a.pnc,null)}get storeType(){return this.propertySet.gb(h.a.m$b)}get assetId(){return this.propertySet.oa(h.a.k$b,null)}get assetStoreId(){return this.propertySet.oa(h.a.mnc,null)}get ownerAddinSolutionId(){return this.propertySet.oa(h.a.RAg,
null)}get sharedRuntimeId(){return this.propertySet.oa(e.a.sharedRuntimeId,null)}get settings(){const w={};n.a(this.node,(y,z)=>{l.b(z,w)});return w}get slideId(){return 0===this.KN?u.a.Yq(this.Dx.gb(h.a.sid),this.Dx.gb(h.a.cid)):null}get shapeId(){const w=Object(c.a)(426,this.Dx);return 0===this.KN&&w?w.get_shapeId():0}get ownerAddinStoreType(){return this.propertySet.oa(h.a.ownerAddinStoreType,null)}get xSa(){return this.propertySet.oa(h.a.xSa,-1)}get ZHa(){return this.propertySet.oa(h.a.ZHa,null)}}
Object(x.a)(r,"AppReader",null,[867])},597:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b[b.OK=0]="OK";b[b.sOl=1]="notReady";b[b.z6l=2]="storeDisabled";b[b.lBl=3]="invokeFailure";b[b.P1l=4]="serviceDisabled";b[b.jil=5]="builtinAddinDetails"})(c||(c={}));Object(x.b)("AddinDetailsQueryError",c)},646:function(x,G,a){a.d(G,"a",function(){return z});x=a(0);var c=a(17),b=a(151),f=a(4),e=a(33),h=a(26),u=a(741),m=a(153),n=a(70),l=a(647),r=a(489),w=a(41),y=a(10);class z{constructor(A,
B,H,v,C,F,D,N){this.cFa=(U,W,L,O,M)=>{M&&M.MenuItemId&&(c.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:M.SourceControlId,["AppType"]:r.a[this.M3]}),h.a.jq(M.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};this.Ycc=(U,W,L,O,M)=>{if(M&&M.MenuItemId){const K=f.AFrameworkApplication.ga.getBooleanAppSetting("WacInTabOpenMRUIsEnabledForUiHost"),P=f.AFrameworkApplication.ga.getBooleanAppSetting("UiHostSupportsDocRebootFeatures");c.ULS.sendTraceTag(592237459,
202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",K,P);if(K&&P){c.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:M.SourceControlId,["AppType"]:r.a[this.M3]});U=M.MenuItemId.toString();const V={};V[m.a.mUc]="1";V[m.a.documentUrl]=U;V[m.a.reason]=l.a.open;c.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");f.AFrameworkApplication.k3().execute(Y=>{Y.sendMessage(n.a.gZa,V)})}else this.cFa(U,W,L,O,M)}return 32};this.aac=
()=>{this.j$c();return 32};this.ya=A;this.$m=B;this.xr=H;this.yW=v;this.ze=C;this.Fdb=F;this.xYe=D;this.X3c=N}Yth(){this.YEa.za(y.a.cFa,w.a.frame,this.cFa);this.YEa.za(y.a.Ycc,w.a.frame,this.Ycc);f.AFrameworkApplication.xwa?this.j$c():this.YEa.sa(y.a.aac,w.a.frame,this.aac,96)}m8(A,B,H){H=void 0===H?"":H;if(B&&B.qq){const v=u.a[B.status];B=B.qq.getTime();const C=this.getCurrentTime()-B;c.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:A,["RequestStatus"]:v,["ElapsedMs"]:C,
["StartTime"]:B,["Notes"]:H})}else c.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:A})}j$c(){var A=f.AFrameworkApplication.ga.getBooleanAppSetting("QPGVCI"),B=e.a.NV(document.URL,"wdNewAndOpenCt",A);if(B){B=parseInt(B);var H=e.a.NV(document.URL,"wdPreviousSession",A);A=e.a.NV(document.URL,"wdPreviousCorrelation",A);var v=f.AFrameworkApplication.ga.getBooleanAppSetting("NAOPLP");if(f.AFrameworkApplication.xwa){var C=f.AFrameworkApplication.xwa.getTime();
!B||B>C?c.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:B,["DocumentLoadedTime"]:C,["SessionId"]:H,["Correlation"]:A}):c.ULS.sendTraceTag(5849683,202,v?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:C-B,["ClickTimestamp"]:B,["SessionId"]:H,["Correlation"]:A})}else c.ULS.sendTraceTag(5849681,202,v?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:B,["SessionId"]:H,["Correlation"]:A})}}get YEa(){return this.ya.value}get RBb(){return this.$m.value}get nrh(){return this.xr.value}get M3(){return this.yW.value}get C0b(){return this.ze.value}get getCurrentTime(){return this.Fdb}get f2(){return this.xYe.value}get GUa(){return this.X3c.value}static get instance(){return z.Wa||(z.Wa=z.Bq())}static Bq(){return new z(new b.a(()=>f.AFrameworkApplication.vb),new b.a(()=>f.AFrameworkApplication.ye),new b.a(()=>f.AFrameworkApplication.Ea),
new b.a(()=>f.AFrameworkApplication.Ea.Kb.Im),new b.a(()=>f.AFrameworkApplication.je),()=>(new Date).getTime(),new b.a(()=>f.AFrameworkApplication.Ea.Kb.f2),new b.a(()=>f.AFrameworkApplication.GUa))}}z.Wa=null;Object(x.a)(z,"NewAndOpenCommonHelpers",null,[945])},651:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b){this.type=null;this.type=b}}Object(x.a)(c,"CustomContentProps",null,[])},663:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.Hwa="extId";c.ZLb=
"ComponentType";c.Cma="ComponentId";c.sjh="HostProps";c.$pa="OptionalProps";Object(x.a)(c,"ActionPropertyNames",null,[])},702:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b[b.cOl=0]="myAddins";b[b.Xfl=1]="adminManaged";b[b.ZTl=2]="popular"})(c||(c={}));Object(x.b)("AddinCollectionType",c)},703:function(x,G,a){a.d(G,"a",function(){return f});a.d(G,"b",function(){return e});var c=a(252),b=a(704);const f=(h,u)=>{const m=new c.GraphIterator;m.set(h);let n=m.Bb(21);for(;n;)b.a(n)&&
u(h,n),n=m.xf(21)},e=(h,u)=>{const m=new c.GraphIterator;m.set(h);let n=m.Bb(21);for(;n&&n!==h;)n=b.a(n)&&u(n)?m.UDa(21):m.Fj(21)}},704:function(x,G,a){a.d(G,"b",function(){return b});a.d(G,"a",function(){return f});var c=a(259);const b=(e,h)=>{h[e.gb(c.a.Nfb)]=e.gb(c.a.iKb)},f=e=>1074135139===e.Me},709:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);class c{static REf(){return c._nextEventReceiverId++}}c._nextEventReceiverId=0;Object(x.a)(c,"EventReceiverIdCounter",null,[]);class b{constructor(f,
e){this.$We=f;this._id=c.REf();this.i5e=e}get id(){return this._id}notify(f,e){this.i5e(f,e)}Ci(f,e){return this.$We.IGg(f,e?this:null)}}Object(x.a)(b,"EventReceiver",null,[69])},788:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.aEb={}}g9e(b){this.aEb[b.id.toString()]=b}evg(b){const f=this.aEb;for(const e in f)f[e].notify(b,!1);this.aEb={}}IGg(b,f){f&&this.g9e(f);return this.Qbe(b,f)}gac(b){this.evg(b)}YCd(b,f){b.notify(f,!0)}}Object(x.a)(c,"AEventEmitter",null,
[948])},794:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.additionalDataFields=this.otelEvent=null}}Object(x.a)(c,"OtelTelemetryEvent",null,[])},797:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);a=a(368);class c extends a.a{constructor(){super();this.Value=this.Label=null;this.Underlined=this.ShowIcon=!1;this.OnEscapeCommandId=this.OnChangeCommandId=this.Styles=null}get ControlType(){return 15}}Object(x.a)(c,"SearchBoxProps",a.a,[])},798:function(x,G,a){a.d(G,
"a",function(){return c});x=a(0);a=a(368);class c extends a.a{constructor(){super();this.OnLinkClicked=this.LinkUrl=this.LinkText=this.OnRetryCommandId=this.RetryButtonTitle=this.AriaDescription=this.IconName=this.Label=null}get ControlType(){return 12}}Object(x.a)(c,"ErrorViewProps",a.a,[])},799:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);a=a(368);class c extends a.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionIdMapped=this.ActionId=this.Details=
this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandIdMapped=this.CommandId=null}get ControlType(){return 13}}Object(x.a)(c,"MultiActionButtonProps",a.a,[])},823:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.none=null;c.nym="CoAuth";c.vjh="IdeasPaneClosed";c.qmn="MultiSlidesSelected";c.wVc="Retrigger";c.Nvh="SessionEnded";c.LKn="SessionRehydrated";c.slideNavigation="SlideNavigation";c.ONe="SuggestionPaneClosed";c.jyh="SuggestionsLoadingTimeout";
c.noSuggestion="NoSuggestion";c.Mz="Typing";c.EPe="WebActionId:";c.bFn="Rehydrated";c.Bol="DisallowedRequest";c.nkl="CloseSecondPane";c.ntn="OpenEditorPane";Object(x.a)(c,"DesignerResetReason",null,[])},824:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.invalid="Invalid";c.success="Success";c.error="Error";c.pending="Pending";c.wOc="NoResult";Object(x.a)(c,"ProviderResultStatus",null,[])},828:function(x,G,a){a.d(G,"a",function(){return W});x=a(0);var c=a(17),b=a(40),f=a(231),e=
a(151);G=a(788);var h=a(878),u=a(847);class m extends u.a{constructor(){super();this.n3c=this.p3c=this.o3c=null;this.state=this.b4c=0;this.eic=!1}get rug(){return this.o3c}get drh(){return this.p3c}get qIe(){return this.n3c}get oRk(){return this.b4c}RJd(){return"MruActor Result"}}Object(x.a)(m,"MruResult",u.a,[946,947]);var n=a(646),l=a(39),r=a(174);class w{constructor(L,O,M){this.task=null;this.MRb=L;this.Lsg=O;this.DK=M;this.retryCount=this.pLa=0;this.THb=this.VLa=null}VTf(L,O){return L===r.a.xFd||
20===O||18===O||3===O}uUf(L){return 3===L||5===L||6===L||7===L||9===L||10===L||11===L||12===L||13===L||14===L||15===L||16===L||23===L||26===L||27===L||28===L}get rbb(){return this.THb}reset(){this.pLa=this.retryCount=0;this.THb=this.VLa=null;this.task&&(this.DK.li(this.task),this.task=null)}gOf(L,O,M,K){this.THb=String.format("{0}_{1}",M,K);if(this.retryCount>=this.Lsg)return c.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.VTf(M,K))return c.ULS.sendTraceTag(562656908,202,50,
"Encountered permanent error. Not retrying"),!1;if(this.uUf(K)&&1<=this.pLa)return this.VLa=M,!1;O=Math.max(O,this.MRb*Math.pow(2,this.pLa));if(26===K)O=Math.max(O,3E4);else if(27===K||28===K)O=Math.max(O,6E4);9===K||412===M&&(null==this.VLa||412!==this.VLa)?O=500:this.pLa+=1;this.VLa=M;this.retryCount+=1;this.task&&this.DK.li(this.task);c.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",O);this.task=new l.a(2,1,O,L,107);this.DK.Qb(this.task);return!0}}Object(x.a)(w,"RetryManager",
null,[]);var y=a(4),z=a(42),A=a(44),B=a(51),H=a(20);class v{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(x.a)(v,"WriteOptions",null,[]);var C=a(180),F=a(5),D=a(41),N=a(10),U=a(91);class W extends G.a{constructor(L,O,M,K,P,V,Y){super();this.z6g=ta=>{this.I8c(ta.data)};this.aof=ta=>{if(ta.data.Ze===r.a.m6c)this.I8c(ta.data);else{var fa=ta.data.Ze===r.a.c3b,Ta=A.a.xx();this.L8c(this.M7,ta,this.Znf(),Ta);Ta&&(Ta.set("StatusCode",
ta.data.Ze.toString()),fa||this.xJb(ta.data,Ta));z.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",ta.data.Ze),fa,!1,Object.assign({},{extendedProperties:Ta}))}};this.OEf=ta=>{this.m8c(ta)};this.NEf=ta=>{this.m8c(ta,!0)};this.LEf=ta=>{this.l8c(ta)};this.KEf=ta=>{this.l8c(ta,!0)};this.SGa=L;this.M1e=O;this.J7=new w(y.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),y.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.Yv.C0b);this.M7=new w(y.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),y.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.Yv.C0b);this.y4e=M;this.j4c=K;this.K8e={};this.bJ=new m;this.jYe=P;this.X8a="";this.c9=V;this.M2c=Y;this.B4e=y.AFrameworkApplication.ga.Jc("WordRecentLinksCount",25)}get rcb(){return this.K8e}cuh(){this.Yv.YEa.za(N.a.Duh,D.a.frame,Object(b.a)(this,this.UKg,"renameMruEntry"))}UKg(){return this.m9b("Rename")}Lqh(){this.tbd("File Opened")}Mqh(){this.tbd("IntervalUpdate")}tbd(L){c.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:L});this.m9b(L)}vI(L){(L=F.a.vI(L))&&L.startsWith(".")&&(L=L.substring(1,L.length));return L}gAb(){switch(this.Yv.M3){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}yIf(L){var O=this.jYe();if(!O)return null;const M=new v;M.documentUrl=this.M2c.value?encodeURI(O):O;M.mruItemId=this.X8a;M.app=this.gAb();if(O=this.c9())M.folderName=O.breadcrumbFolderName,O=O.TM,
M.documentName=F.a.r$(O),M.documentExt=this.vI(O);L&&(M.documentName?M.documentName.length?255<=M.documentName.length?L.set("DocumentNameLength","Long"):2084<=M.documentName.length&&L.set("DocumentNameLength","VeryLong"):L.set("DocumentNameLength","0"):L.set("DocumentNameLength","Null"));return JSON.stringify(M)}m9b(L,O){O=void 0===O?!1:O;if(4===this.Yv.M3&&!y.AFrameworkApplication.G6c)return 2;var M=A.a.xx();M&&(M.set("Trigger",L),M.set("IsRetry",O?"true":"false"),M.set("MruIdSent",this.X8a?"true":
"false"),M.set("URLEncoded",this.M2c.value?"true":"false"));z.Health.instance.recordKpiUsage("WriteMru",U.b.FailureBased,"smartfio",M);L=this.yIf(M);if(!L)return O=!y.AFrameworkApplication.B8a,M&&(M.set("WebEditingIsEnabled",y.AFrameworkApplication.B8a?"true":"false"),M.set("ProtectedFile",y.AFrameworkApplication.fD?"true":"false")),z.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",O,!1,Object.assign({},{extendedProperties:M})),2;this.M7&&!O&&this.M7.reset();M=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",
this.Yv.f2,this.yUb);this.j4c?this.rcb["X-FileId"]=y.AFrameworkApplication.ui:M+=String.format("&{0}",y.AFrameworkApplication.ui);y.AFrameworkApplication.Rf&&(this.rcb["X-Office-AudienceGroup"]=Object(f.a)(String,y.AFrameworkApplication.Rf.AudienceGroup)||"");this.rcb["X-Timeout"]=15E3;return this.Yv.RBb.rk(M,2,L,this.rcb,!0,5,this.z6g,this.aof,null,void 0,void 0,void 0,void 0,"4")}I8c(L){const O=A.a.xx();this.M7&&(O&&this.M7.rbb&&(O.set("LastError",this.M7.rbb),O.set("NumRetries",this.M7.retryCount.toString())),
this.M7.reset());const M=h.c(L.responseData);M&&M.diagnostics_data&&(this.X8a=M.diagnostics_data.mru_id);L=+L.zr-+L.qq;O&&O.set("RequestDuration",L.toString());z.Health.instance.recordKpiSuccess("WriteMru",Object.assign({},{extendedProperties:O}))}Znf(){return()=>{this.m9b("Retry",!0)}}Khh(){this.Sab("Polling")}MEf(){this.Sab("Retry",!0)}Jqh(){this.Sab("Open")}Iqh(){this.Sab("Activity")}Sab(L,O){O=void 0===O?!1:O;var M=void 0===M?!1:M;c.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",
{["Trigger"]:L});const K=A.a.xx();K&&(K.set("Trigger",L),K.set("IsRetry",O?"true":"false"),M&&K.set("RecentLinks","true"));z.Health.instance.recordKpiUsage("GetMru",U.b.FailureBased,"smartfio",K);this.J7&&!O&&this.J7.reset();M?this.f6c(this.NEf,this.KEf,!0):this.f6c(this.OEf,this.LEf)}xJb(L,O){L&&L.fk&&(L=L.fk["X-CorrelationId"])&&O.set("ServerCorrelationId",L)}KYf(L,O){L&&(O&&O.set("RequestDuration",(+L.zr-+L.qq).toString()),z.Health.instance.recordKpiSuccess("GetMru",Object.assign({},{extendedProperties:O})))}m8c(L,
O){O=void 0===O?!1:O;var M="";let K=null,P=null,V=null;const Y=h.c(L.data.responseData);Y&&(K=Y.places?Y.places.items:[],P=Y.documents?Y.documents.items:[],(V=h.a(Y,O))&&(M=H.c(V)));y.AFrameworkApplication.Ea&&y.AFrameworkApplication.Ea.Kb.X0a&&B.c()&&!O&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(M,!0)),this.rxe=M);M=A.a.xx();this.J7&&(M&&this.J7.rbb&&(M.set("LastError",this.J7.rbb),M.set("NumRetries",this.J7.retryCount.toString())),this.J7.reset());O&&M&&M.set("RecentLinks","true");
V||K||P?(O?this.Yv.m8("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",L.data,"Success"):this.Yv.m8("MruActor.GetMruV2FromServerSuccessCallback",L.data,"Success"),this.mcb(3,V,K,P),this.KYf(L.data,M)):(O?this.Yv.m8("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",L.data,"Failure: Invalid JSON"):this.Yv.m8("MruActor.GetMruV2FromServerSuccessCallback",L.data,"Failure: Invalid JSON"),M&&this.xJb(L.data,M),z.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign({},
{extendedProperties:M})),this.mcb(3,null,null,null,!0));this.gac(this.bJ)}L8c(L,O,M,K){let P=0,V=0;const Y=h.c(O.data.responseData);Y&&(null!=Y.response_code&&(P=Y.response_code,K&&K.set("MruResponseCode",P.toString()),9===P&&(this.X8a="")),Y.error_data&&null!=Y.error_data.retry_after_ms&&(V=Y.error_data.retry_after_ms,K&&K.set("ExpectedRetryAfter",V.toString())));L&&(O=L.gOf(M,V,O.data.Ze,P),K&&(K.set("CurrentRetryCount",L.retryCount.toString()),K.set("RetryScheduled",O?"true":"false")))}l8c(L,O){O=
void 0===O?!1:O;const M=L.data.Ze===r.a.c3b,K=A.a.xx();K&&(K.set("StatusCode",L.data.Ze.toString()),O&&K.set("RecentLinks","true"),M||this.xJb(L.data,K));O?this.Yv.m8("MruActor.GetMruForRecentLinksFromServerFailureCallback",L.data,"Failure"):this.Yv.m8("MruActor.GetMruFromServerFailureCallback",L.data,"Failure");this.mcb(2);this.L8c(this.J7,L,Object(b.a)(this,this.MEf,"getMruFromServerRetryTask"),K);z.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",L.data.Ze),M,!1,Object.assign({},
{extendedProperties:K}));this.gac(this.bJ);y.AFrameworkApplication.Ea&&y.AFrameworkApplication.Ea.Kb.X0a&&B.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),O||(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),this.rxe=null))}mcb(L,O,M,K,P){if(3!==this.bJ.state||3===L)this.bJ.o3c=void 0===O?null:O,this.bJ.p3c=void 0===M?null:M,this.bJ.n3c=void 0===K?null:K,this.bJ.state=L,this.bJ.eic=void 0===P?!1:P,this.bJ.b4c=this.Yv.getCurrentTime()}Qbe(L,O){c.ULS.sendTraceTag(6029918,
202,50,"MRU result requested {0}",{["Trigger"]:L,["ResultState"]:this.bJ.state});O&&3===this.bJ.state&&this.YCd(O,this.bJ);return this.bJ}f6c(L,O,M){M=void 0===M?!1:M;this.mcb(1);let K;const P={};K=M?String.format(this.Yv.f2+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.B4e,"OfficeSuite",this.yUb,"ClassicMru"):String.format(this.Yv.f2+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.gAb(),this.yUb);this.y4e.value||(K+="&entity=docs");y.AFrameworkApplication.Rf&&
(P["X-Office-AudienceGroup"]=Object(f.a)(String,y.AFrameworkApplication.Rf.AudienceGroup)||"");M&&(P["X-Office-Application"]="147");this.j4c?P["X-FileId"]=y.AFrameworkApplication.ui:K+=String.format("&{0}",y.AFrameworkApplication.ui);this.Yv.RBb.rk(K,1,null,P,!0,5,L,O,null)}get Yv(){return this.SGa.value}get yUb(){return this.M1e.value}static get instance(){return W.Wa||(W.Wa=W.Bq())}static Bq(){return new W(new e.a(()=>n.a.instance),new e.a(()=>C.a.Ne(y.AFrameworkApplication.lcid).name),new e.a(()=>
y.AFrameworkApplication.Ea.Kb.XV),y.AFrameworkApplication.ga.getBooleanAppSetting("MruWriteFileIdInHeader"),()=>y.AFrameworkApplication.Ea.Kb.zjf,()=>y.AFrameworkApplication.Wz,new e.a(()=>y.AFrameworkApplication.ga.getBooleanAppSetting("OICEncodeUrlIsEnabled")))}}W.Wa=null;Object(x.a)(W,"MruActor",G.a,[])},846:function(x,G,a){a.d(G,"b",function(){return b});a.d(G,"a",function(){return f});x=a(0);class c{}c.slideType="slide";c.shapeType="shape";c.chartType="chart";Object(x.a)(c,"ClipserviceDataConstants",
null,[]);const b=e=>e===c.slideType?1:e===c.shapeType?2:e===c.chartType?3:0,f=e=>1===e?c.slideType:2===e?c.shapeType:""},847:function(x,G,a){a.d(G,"a",function(){return f});x=a(0);var c=a(17),b;(function(e){e[e.notStarted=0]="notStarted";e[e.waiting=1]="waiting";e[e.Jed=2]="shouldRetry";e[e.complete=3]="complete"})(b||(b={}));Object(x.b)("EventResultState",b);class f{constructor(){this._state=0}get state(){return this._state}set state(e){c.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",
{["OldState"]:b[this._state],["NewState"]:b[e]},"ResultType",this.RJd());this._state=e}}Object(x.a)(f,"AEventResult",null,[947])},878:function(x,G,a){a.d(G,"c",function(){return h});a.d(G,"b",function(){return u});a.d(G,"a",function(){return m});var c=a(68),b=a(17),f=a(4),e=a(20);const h=n=>{if(!n)return null;let l;try{l=e.b(n)}catch(r){l=null,b.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",r)}return l},u=(n,l)=>{let r=[];if(n.breadcrumbs&&
0<n.breadcrumbs.length)r=n.breadcrumbs;else{const w=n.service_info;w&&w.friendly_service_name&&Array.add(r,w.friendly_service_name);n.display_path&&Array.addRange(r,n.display_path)}return r.join(l?" \u00ab ":" \u200f\u00bb ")},m=(n,l)=>{l=void 0===l?!1:l;if(!n)return[];if(!n.documents)return b.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!n.documents.items)return b.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];n=n.documents.items;const r=new c.a;for(let y=0;y<
n.length;y++){const z=n[y];var w=z.web_url;if(!w){b.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!z.url){b.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}w=String.format("{0}?web=1",z.url)}const A={};A.DocumentUrl=w;A.MruId=z.mru_id;{w=z;let B=w.title;B?(w.extension&&(B=String.format("{0}.{1}",B,w.extension)),w=B):(b.ULS.sendTraceTag(578352837,202,15,"empty file title"),w="")}A.FileName=w;A.IsPinned=z.is_pinned;A.Path=u(z,f.AFrameworkApplication.isRtl);l&&(A.App=z.app,A.TimeStamp=
z.time_stamp);r.add(A)}return r.toArray()}},882:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=null}}Object(x.a)(c,"CalloutParameters",null,[])},883:function(x,G,a){a.d(G,
"a",function(){return c});x=a(0);class c{}Object(x.a)(c,"ICalloutProps",null,[])},888:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(260);class b{constructor(f,e){this.Eqb=!1;this.kFb=this.W3c=-1;this.qt=f;e&&this.start()}start(){this.Eqb=!0;this.kFb=-1;const f=c.a.AA();f&&(this.W3c=f)}stop(){this.Eqb=!1;const f=c.a.AA();f&&0<this.gP&&f>=this.gP&&(this.kFb=f-this.gP)}get operation(){return this.qt}get MCd(){return this.kFb}get gP(){return this.W3c}}Object(x.a)(b,"PPTStopwatch",null,
[])},889:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{static add(b,f,e,h,u){c.A$c[c.H7c(b,f,e,h,u)]=!0}static contains(b,f,e,h,u){return c.H7c(b,f,e,h,u)in c.A$c}static H7c(b,f,e,h,u){return String.format("{0}|{1}|{2}|{3}|{4}",b.toLowerCase(),f,e.toLowerCase(),h.toLowerCase(),u.toLowerCase())}}c.A$c={};Object(x.a)(c,"AppsInsertedStorage",null,[])},890:function(x,G,a){a.d(G,"a",function(){return r});x=a(0);var c=a(21),b=a(231),f=a(258),e=a(259),h=a(252),u=a(288),m=a(399),n=a(256),
l=a(703);class r{static kmf(w,y,z){w=Object(b.a)(u.a,w.createInstance(1074135137));r.z4c(w,y,z);return w}static xva(w,y,z){h.GraphIterator.pb(w).fl(y,z)}static z4c(w,y,z){w.setValue(e.a.onc,0===y.targetType);w.setValue(e.a.Ofb,y.solutionId);w.setValue(e.a.qnc,y.version);w.setValue(e.a.lzb,y.storeType);w.setValue(e.a.pnc,y.storeId);w.setValue(n.a.m$b,z.vAe(y.storeType));y.assetId&&w.setValue(n.a.k$b,y.assetId);w.setValue(n.a.mnc,y.assetStoreId);void 0===y.isAddinCommands?w.setValue(n.a.isAddinCommands,
!1):w.setValue(n.a.isAddinCommands,y.isAddinCommands);y.sharedRuntimeId&&-1!==y.backgroundState&&(w.setValue(n.a.xSa,y.backgroundState),w.setValue(n.a.ZHa,y.sharedRuntimeId));0===y.targetType&&(w.setValue(n.a.ht,!0),z=y.height?y.height:200,w.setValue(f.a.Tv,y.width?y.width:200),w.setValue(f.a.Ez,z))}static xzh(w,y,z){const A=c.a.$Xc(z);l.b(y,H=>{H=H.gb(e.a.Nfb);return!!H&&!(H in A)});l.a(y,(H,v)=>{const C=v.gb(e.a.Nfb);C&&C in A&&(r.j2g(v,A[C],H),delete A[C])});const B=h.GraphIterator.pb(y);c.a.forEach(A,
(H,v)=>{B.fl(r.lmf(w,H,v),21)},null)}static lmf(w,y,z){w=Object(b.a)(u.a,w.createInstance(1074135139));w.setValue(e.a.Nfb,y);w.setValue(e.a.iKb,z);return w}static j2g(w,y,z){w.setValue(e.a.iKb,y);z.oa(e.a.onc,!0)?m.d(z,w,r.PNg):m.d(z,w,r.fOg)}}r.PNg=[n.a.sid,n.a.cid,n.a.shapeId];r.fOg=[e.a.Ofb];Object(x.a)(r,"AppEditor",null,[])},891:function(x,G,a){a.d(G,"a",function(){return m});x=a(0);var c=a(4),b=a(174),f=a(13),e=a(40);G=a(68);var h=a(248),u=a(285);class m{constructor(n,l,r,w,y,z,A,B,H,v,C,F,
D,N){this.wG=this.tj=this.Jr=null;this.u5c=!0;this.iza=n;this.yrg=l;this.N5f=r;this.AMa=w;this.eN=z;this.uc=A;this.ee=B;this.jf=H;this.mbd=v;this.jpb=C;this.jcg=F;this.icg=D;this.hcg=N;this.BF=y}openDialog(){this.Hmf();c.AFrameworkApplication.Ea.mUa();try{this.tj.click()}catch(n){const l=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",n.message,n.stack);h.a.J(509727820,818,10,l);throw n;}}submit(){var n,l,r,w;const y=this.tj.files[0];this.wG=this.N5f();const z=Date.now();
null===(n=this.jf)||void 0===n?void 0:n.Ya("submitTime",z.toString());this.wG.S0b&&(this.wG.S0b(this.eN,this.uc,this.ee,this.jf,this.mbd?y:void 0),n=Date.now(),null===(l=this.jf)||void 0===l?void 0:l.Ya("beforeUploadTime",n.toString()));null===(r=this.jf)||void 0===r?void 0:r.Ya("FileSize",null===(w=null===y||void 0===y?void 0:y.size)||void 0===w?void 0:w.toString());if(this.mbd)this.K4g(y);else{l=new FormData;for(const B of this.wG.XJb)l.append(B.key,B.value);l.append("fileInputId",y,y.name);const A=
new XMLHttpRequest;A.onreadystatechange=()=>{this.ebb(A)};A.open("POST",this.wG.Bcd);A.send(l)}}ebb(n){if(4===n.readyState){const l=n.status;!l||l>=b.a.bC&&l<b.a.s7h?this.wG.vw&&this.wG.vw(n.responseText,this.eN,this.uc,this.ee,this.jf,this.tj):this.wG.SF&&this.wG.SF(n.responseText,this.eN,this.uc,this.ee,this.jf);this.dispose()}}K4g(n){var l;const r=Date.now();null===(l=this.jf)||void 0===l?void 0:l.Ya("UploadStartTime",r.toString());this.jpb().o7(this.AMa,this.BF,n.size,n,this.wG.XJb.ha("MediaToken"),
this.jf,this.jcg,this.icg,this.hcg,w=>{var y;if(this.wG.vw){const z=Date.now();null===(y=this.jf)||void 0===y?void 0:y.Ya("UploadEndTime",z.toString());this.wG.vw(w.result,this.eN,this.uc,this.ee,this.jf,this.tj)}},w=>{var y;if(this.wG.SF){const z=Date.now();null===(y=this.jf)||void 0===y?void 0:y.Ya("failedUploadEndTime",z.toString());this.wG.SF(w.error.Code.toString(),this.eN,this.uc,this.ee,this.jf)}})}dispose(){this.Jr&&(f.a.removeHandler(this.tj,"change",Object(e.a)(this,this.Yzb,"fileInputChange")),
document.body.removeChild(this.Jr),this.tj=this.Jr=null,m.W8b.remove(this))}Hmf(){this.Jr||(this.Jr=document.createElement("form"),this.Jr.id="uploadFormId",this.Jr.style.visibility=u.a.hidden,this.Jr.method="post",this.Jr.encoding="multipart/form-data",this.Jr.action="",this.tj=document.createElement("input"),this.tj.style.visibility=u.a.hidden,this.tj.type="file",this.tj.id="uploadFileInputId",this.tj.name="uploadFileInputId",this.tj.accept=this.iza,this.Jr.appendChild(this.tj),document.body.appendChild(this.Jr),
f.a.addHandler(this.tj,"change",Object(e.a)(this,this.Yzb,"fileInputChange")))}Yzb(){this.tj.value&&this.tj.value.length?(this.u5c=!1,this.yrg(this.tj,this.ee,this.jf,this.AMa).then(()=>{this.submit()}).catch(()=>{this.dispose()})):this.dispose()}static tNe(n,l,r,w,y,z,A,B,H,v,C,F,D,N){for(const U of m.W8b)U.u5c&&U.dispose();n=new m(n,l,r,w,y,z,A,B,H,v,C,F,D,N);m.W8b.add(n);n.openDialog()}}m.W8b=new G.a;Object(x.a)(m,"UploadFileDialog",null,[])},892:function(x,G,a){a.d(G,"a",function(){return h});
x=a(0);var c=a(5),b=a(13),f=a(248),e=a(250);class h{constructor(u){this.xR=null;this.rNa=0;this.AMa=u;switch(this.AMa){case "audio":this.xR=h.vrg;this.rNa=h.G_f;break;case "captions":this.xR=h.wrg;this.rNa=h.w0f;break;case "video":this.xR=h.xrg;this.rNa=h.Frg;break;default:f.a.J(509727835,822,10,"Invalid file type")}}static set P_k(u){h.xrg=u}static set s0k(u){h.Frg=u}sif(u){switch(this.AMa){case "audio":return h.qif(u);case "captions":return h.rif(u);case "video":return e.a("DisableVideoAsFileCheck")?
new Promise(m=>{m(!0)}):h.tif(u);default:return f.a.J(509727834,822,10,"Invalid file type"),new Promise(m=>{m(!1)})}}u5g(u){u=c.a.mj(u);for(let m=0;m<this.xR.length;++m){const n=this.xR[m];if(n&&0<n.length&&u.endsWith(n))return!0}return!1}v5g(u){return u<=1048576*this.rNa}static qif(u){return new Promise((m,n)=>{if(u&&u.size){var l=document.createElement("video"),r=URL.createObjectURL(u);l.setAttribute("src",r);b.a.addHandler(l,"loadedmetadata",()=>{URL.revokeObjectURL(r);const w=l.videoHeight,y=
l.videoWidth;0<l.duration&&!w&&!y?m(!0):(f.a.J(509727832,822,10,"Invalid audio File"),m(!1))});b.a.addHandler(l,"error",()=>{URL.revokeObjectURL(r);f.a.J(509727831,822,10,"Invalid audio File");n(ResourceStrings.L_InvalidAudioFileError)})}else f.a.J(509727833,822,10,"Empty media File"),m(!1)})}static rif(u){return new Promise((m,n)=>{if(u&&u.size){var l=URL.createObjectURL(u),r=document.createElement("video"),w=document.createElement("track");r.appendChild(w);b.a.addHandler(w,"load",()=>{URL.revokeObjectURL(l);
m(!0)});b.a.addHandler(w,"error",()=>{URL.revokeObjectURL(l);f.a.J(509727829,822,10,"Invalid captions File");n(ResourceStrings.l_InvalidCaptionsFileError)});w.setAttribute("src",l);w.setAttribute("default","true")}else f.a.J(509727830,822,10,"Empty captions File"),m(!1)})}static tif(u){return new Promise((m,n)=>{if(u&&u.size){var l=document.createElement("video"),r=URL.createObjectURL(u);l.setAttribute("src",r);b.a.addHandler(l,"loadedmetadata",()=>{URL.revokeObjectURL(r);const w=l.videoHeight,y=
l.videoWidth;0<l.duration&&0<w&&0<y?m(!0):(f.a.J(509727837,822,10,"Invalid video File"),m(!1))});b.a.addHandler(l,"error",()=>{URL.revokeObjectURL(r);f.a.J(509727836,822,10,"Invalid video File");n(ResourceStrings.L_InvalidVideoFileError)})}else f.a.J(509727838,822,10,"Empty media File"),m(!1)})}static vPb(u){if(!u||!u.value)return"Input file name is null";const m=u.value.lastIndexOf(".");return-1===m?"":u.value.substring(m+1,m+5)}}h.G_f=16;h.w0f=16;h.wrg=[".vtt"];h.vrg=[".mp3",".wav",".m4a",".aac",
".oga"];Object(x.a)(h,"MediaValidationHelper",null,[])},894:function(x,G,a){a.d(G,"a",function(){return r});x=a(0);var c=a(17),b=a(180),f=a(4),e=a(47),h=a(7),u=a(5),m=a(380),n=a(284),l=a(250);class r{static UCe(w){const y={};y.appSettings=r.mmf();y.singleSignOnSettings=r.SCe();y.appVersion="16";y.appUILocale=b.a.Ne(f.AFrameworkApplication.lcid).Mib;y.dataLocale=b.a.Ne(f.AFrameworkApplication.lcid).Mib;y.osfOmexBaseUrl=f.AFrameworkApplication.ga.La(n.a.cze);y.firstPartyManifestCDNUrl=f.AFrameworkApplication.ga.La(n.a.lze);
y.sdxCdnUrl=f.AFrameworkApplication.ga.La(n.a.sdxCdnUrl);y.sdx1CdnUrl=f.AFrameworkApplication.ga.La("Sdx1CdnUrl");y.sdxDmsUrl=f.AFrameworkApplication.ga.La(n.a.sdxDmsUrl);y.forceUseSdx1Cdn=f.AFrameworkApplication.ga.getBooleanAppSetting("ForceUseSdx1Cdn");y.sovereignFederationDMSToken=f.AFrameworkApplication.ga.La("SovereignFederationDMSToken");y.sovereignFederationDMSTokenSuffix=f.AFrameworkApplication.ga.La("SovereignFederationDMSTokenSuffix");y.sdxAssetsToPrefetchMapping=f.AFrameworkApplication.ga.La(n.a.sdxAssetsToPrefetchMapping);
y.docUrl=w?w.documentUrl:"";y.pageBaseUrl=e.a.nN;y.lcid=f.AFrameworkApplication.lcid.toString();y.allowExternalMarketplace=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.T4c);y.localizedScriptsUrl=(f.AFrameworkApplication.aua?f.AFrameworkApplication.ga.La("StaticContentHostNonOverriden"):e.a.nN)+f.AFrameworkApplication.ga.La(n.a.zbh);w=w?w.UDe:"";y.localizedImagesUrl=e.a.nN+w;y.localizedStylesUrl=e.a.nN+w;y.localizedResourcesUrl=e.a.ZWh(w);y.enableAddinCommands=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.zmc);
y.enableMyApps=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.Njh);y.enableMyOrg=f.AFrameworkApplication.ga.getBooleanAppSetting("InsertAgaveMyOrgEnabledForHost");y.enableUploadFileDevCatalog=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.zmc)&&!f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.iPe);y.enableDevCatalog=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.Jcd);y.devCatalogUrl=f.AFrameworkApplication.ga.La(n.a.ybh);y.enablePrivateCatalog=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.a5c);
y.showSignOutFromPrivateCatalogMessage=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.showSignOutFromPrivateCatalogMessage);y.enableBlackForestRedirect=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.Cze);y.enableSingleSignOnForAddin=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.mze)&&f.AFrameworkApplication.vfj;y.enableTaskpaneUpgradeToAppCommand=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.eOe);y.hideAppsExtensionUrl=f.AFrameworkApplication.hideAppsExtensionUrl;y.enableAnonymousUseLegacyCatalogService=
f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.bze);y.enableInsertDialogAccessibilityFix=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.CIe);y.enableFirstPartySDXErrorMessages=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.BIe);y.disableAppsForOfficeThirdParty=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.oSc);y.wacSessionId=f.AFrameworkApplication.userSessionId;y.disableLogging=!f.AFrameworkApplication.ga.getBooleanAppSetting("AriaLoggingIsEnabled");y.loggableUserId=f.AFrameworkApplication.ga.La("LoggableUserId");
y.sessionStartInfoJson=f.AFrameworkApplication.ga.La("SessionStartInfoJson");y.wopiHostOriginFromPostMessage=f.AFrameworkApplication.wopiHostOriginFromPostMessage;y.wopiHostOriginFromWacPropBag=f.AFrameworkApplication.ga.La("PostMessageOrigin");y.wacIsEmbedded=f.AFrameworkApplication.ga.getBooleanAppSetting("IsEmbedded");y.accessibilityAllowFocusAddinTaskpane=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.accessibilityAllowFocusAddinTaskpane);y.disableMicrophonePermission=h.a.XX(1)&&f.AFrameworkApplication.ga.getBooleanAppSetting("TranscriberSafariEnabled")&&
f.AFrameworkApplication.ga.getBooleanAppSetting("RehearsalSafariEnabled");y.isHostFrameTrustCheckEnabledForAddIns=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.GDe);y.isHostFrameTrusted=f.AFrameworkApplication.isHostFrameTrusted;y.hostAllowedSdxEmbedding=f.AFrameworkApplication.ga.getBooleanAppSetting("HostAllowedSdxEmbedding");y.hostAllowedOfficeStore=f.AFrameworkApplication.ga.getBooleanAppSetting("HostAllowedOfficeStore");y.hostInstallAddIns=f.AFrameworkApplication.ga.La("HostInstallAddIns");
y.hostInstallAddInsIsEnabled=f.AFrameworkApplication.ga.getBooleanAppSetting("HostInstallAddInsIsEnabled");y.approvedAddIns=f.AFrameworkApplication.ga.La("ApprovedAddIns");y.is3pAddInsDisabled=f.AFrameworkApplication.ga.getBooleanAppSetting("Is3pAddInsDisabled");y.isUpnCheckEnabled=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.isUpnCheckEnabled);y.wacUpn=f.AFrameworkApplication.ga.La("UserPrincipalName");y.isReactRibbonEnabled=!0;y.enableSetFocusOnTaskpaneOnUserAction=!0;y.enableMyOrg&&y.docUrl&&
(w=y.docUrl.split("/"),y.spBaseUrl=2<w.length?w[0]+"//"+w[2]:null,y.spBaseUrl||c.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",y.docUrl)));y.userNameHashCode=u.a.DV(f.AFrameworkApplication.userName);y.envCode=f.AFrameworkApplication.ga.Jc(n.a.Nbd,0).toString();return y}static mmf(){const w={};w.AddinRibbonIdAllowUnknown=f.AFrameworkApplication.ga.getBooleanAppSetting("AddinRibbonIdAllowUnknown");w.AddinRibbonNativeGroupControlIsEnabled=!0;w.AddinRibbonTabAutoFocusIsEnabled=
!0;w.AddinRibbonTabPositionIsEnabled=!0;w.AgaveAddinUploadEnabled=f.AFrameworkApplication.ga.getBooleanAppSetting("AgaveAddinUploadEnabled");w.DevConsoleEnabled=f.AFrameworkApplication.ga.getBooleanAppSetting("AddinDevConsoleLog");w.ManifestParserDevConsoleEnabled=!0;w.flightingTreatmentVariables=f.AFrameworkApplication.ga.uuc;w.DisabledChangeGates=f.AFrameworkApplication.ga.La("DisabledChangeGates");w.DmsSdxListPresentation=f.AFrameworkApplication.Leh;return w}static SCe(){try{const w={};(l.a("FixAddinTeamsBrowserSSO")||
h.a.$$a)&&m.a.ykb&&(w.UiHostSupportsAuthTokenAddinList=r.n7c);w.UiHostSupportsAuthToken=m.a.ykb;return w}catch(w){c.ULS.sendTraceTag(512263001,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",w.message)}return null}}r.n7c="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");Object(x.a)(r,
"AppForOfficeHelper",null,[])},895:function(x,G,a){a.d(G,"a",function(){return e});x=a(0);var c=a(17),b=a(413),f=a(4);class e{static q4l(h){return parseInt(e.A8b(b.a.lbh,h)||"-1")<=(new Date).getTime()}static vIi(h){return parseInt(e.A8b(b.a.P4c,h)||"-1")}static q6i(h){return Boolean.parse(e.A8b(b.a.Gaf,h)||"false")}static A8b(h,u){let m=null;try{const n=e.pwc();if(void 0!==n&&n){const l=b.a.Xuc(h)+u;m=n.getItem(l)}else c.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(n){c.ULS.sendTraceTag(42074646,
220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",h,u)}return m}static s0c(h,u,m){try{const n=e.pwc();if(void 0!==n&&n){const l=b.a.Xuc(h)+m;n.setItem(l,u)}else c.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(n){c.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",h,m)}}static pwc(){if(!e.pEa)return null;let h=null;try{h=localStorage}catch(u){e.pEa=!1,h=null}return h}static Jvl(){switch(f.AFrameworkApplication.Ea.Kb.Im){case 1:return"ExcelOnline";
case 2:return"PowerPointOnline";case 3:return"WordOnline";case 4:return"OneNoteOnline";case 5:return"VisioOnline";default:return"Unknown"}}}e.pEa=!0;Object(x.a)(e,"AddinUtil",null,[])},896:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b[b.notSupported=-1]="notSupported";b[b.OMEX=0]="OMEX";b[b.HRn=1]="spCatalog";b[b.GRn=2]="spApp";b[b.QIm=3]="fileSystem";b[b.exchange=4]="exchange";b[b.oneDrive=5]="oneDrive";b[b.registry=6]="registry";b[b.K0m=7]="inMemory";b[b.RYn=8]="uploadFileDevCatalog";
b[b.cYm=9]="hardCodedPreinstall";b[b.DFg=10]="privateCatalog";b[b.b0n=16]="wopiCatalog"})(c||(c={}));Object(x.b)("AddinProviderType",c)},902:function(x,G,a){a.d(G,"d",function(){return H});a.d(G,"e",function(){return v});a.d(G,"a",function(){return N});a.d(G,"c",function(){return U});a.d(G,"b",function(){return W});var c=a(83),b=a(7),f=a(33),e=a(4),h=a(20),u=a(295),m=a(249),n=a(404),l=a(488),r=a(248),w=a(892);x=a(0);class y{constructor(){this.SF=this.vw=this.S0b=this.XJb=this.Bcd=null}}Object(x.a)(y,
"UploadFileDialogData",null,[]);var z=a(92),A=a(250);const B=new (a(30).a),H=(L,O,M,K,P)=>{const V=String.format("{0}{1}",M,c.a.create().toString());return Object.assign(new y,{XJb:D(V,K),Bcd:F(M,K),S0b:(Y,ta,fa,Ta,ha)=>{switch(M){case "video":ta.blockContent(P,L,!1,ha,Ta);break;default:ta.blockContent(Y,"Insert Media",!1,void 0,void 0)}Y=Date.now();null===Ta||void 0===Ta?void 0:Ta.Ya("loaderTime",Y.toString())},vw:(Y,ta,fa,Ta,ha,qa)=>{O(L,V,ta,fa,ha,qa,P)},SF:(Y,ta,fa,Ta,ha)=>{fa.cN(ta)?r.a.J(509727823,
822,15,"Media::InsertMediaFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+ta.Tea):fa.cN(P)&&r.a.J(509666848,822,15,"Media::InsertMediaFailureAfterUpload:Slide was blocked with loader for {0} milliseconds",+new Date-+P.Tea);A.a("FixHideShimmerIssueOnUploadFailure")&&"video".match(M)?fa.mD(P):fa.mD(ta);ta=null;try{const qa=h.a(Y);ta=qa?qa.Error:null}catch(qa){r.a.J(509727822,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",
Y)}if(!ta){let qa;A.a("FixHideShimmerIssueOnUploadFailure")&&Y&&!isNaN(parseInt(Y))&&(qa=Enum.parse(n.a,n.a[parseInt(Y)],!0));ta=Object.assign(new l.a,{Code:qa?qa:444})}ha&&(ha.finish(),ha=null);r.a.J(509727821,822,10,"Upload media failed");N(M)?U(ResourceStrings.l_FileInsertFailedMessageTitle,ta&&449===ta.Code?ResourceStrings.l_VideoUploadTimeoutMessage:ResourceStrings.l_FileInsertFailedMessage,null):C(Ta,ha,ta.Code,null)}})},v=(L,O,M,K)=>new Promise((P,V)=>{const Y=new w.a(K);r.a.J(509727828,822,
50,"Media File details: Number of media files: {0}, media file extension: {1}",L&&L.value?L.files.length:0,w.a.vPb(L));M&&M.Ya("MediaFileValidationStarts",String.format("Number of media files: {0}, media file extension: {1}",L&&L.value?L.files.length:0,w.a.vPb(L)));if(L&&L.value&&L.value.length)if(Y.u5g(L.value)){var ta=L.files[0];if(Y.v5g(ta.size))Y.sif(ta).then(fa=>{fa?(M&&M.Ya("MediaFileValidationPassedOnUI","true"),P(!0)):(N(K)?U(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,
[Y.xR.join(", ")]):C(O,M,443,[Y.xR.join(", ")]),V(443))},()=>{r.a.J(509727825,822,10,"Invalid media file, fileType:{0}",K);N(K)?U(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[Y.xR.join(", ")]):C(O,M,443,[Y.xR.join(", ")]);V(443)});else{r.a.J(509727826,822,10,"video"===K?"Media::Insert:video: max size error":`Media::Insert:Invalid media file size:${ta.size}`);ta=A.a("FetchMediaSizeLimitFromValidationHelper")?Y.rNa.toString():"16";const fa="video"===K?450:
442;N(K)?U(ResourceStrings.l_MaxFileSizeValidationErrorTitle,ResourceStrings.l_MaxVideoSizeValidationErrorMessage,[ta]):C(O,M,fa,[ta]);V(442)}}else r.a.J(509727827,822,10,"{flow:Insert{0}, fileExt:{1}}",null===K||void 0===K?void 0:K.toString(),w.a.vPb(L)),N(K)?U(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[Y.xR.join(", ")]):C(O,M,441,[Y.xR.join(", ")]),V(441);else N(K)?U(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,
null):C(O,M,440,null),V(440)}),C=(L,O,M,K)=>{O&&(O.Ya("MediaFileValidationPassedOnUI","false"),M&&O.Ya("ErrorCode",M.toString()),O.finish());L.SK(M,P=>{P.zD=1;P.Z9a=K;return!1})},F=(L,O)=>{let M="MediaUpload.ashx";if(m.App.webServiceBase)M=m.App.webServiceBase+M;else if(b.a.zg||b.a.Xsa)M=f.a.XJa(M);let K="";switch(L){case "audio":K="audio";break;case "captions":K="captions";break;case "video":K="video";break;default:r.a.J(509727824,822,10,"Media::GetMediaUploadEndpoint: file type not supported")}M+=
String.format("?MediaType={0}&{1}&{2}&{3}",K,e.AFrameworkApplication.Rjb(),O.Nh.string,e.AFrameworkApplication.Gac());O.podSessionId&&(M+=String.format("&{0}={1}",u.a.A8,O.podSessionId));O.rp&&(M+=String.format("&waccluster={0}",O.rp));return M},D=(L,O)=>{const M=new z.a;M.K("PresentationId",O.Nh.string);M.K(u.a.nka,O.sessionInfo);M.K("Canary",e.AFrameworkApplication.oC);M.K("access_token",e.AFrameworkApplication.accessToken);M.K("MediaToken",L);return M},N=L=>A.a("EnableCalloutNotificationsForVideos")&&
"video".match(L)?!0:!1,U=(L,O,M)=>{const K=new l.a;K.Title=L;K.Message=O;K.ExtraErrorParam=M;B.raiseEvent("videoCalloutNotificationEvent",K)},W=L=>{B.addHandler("videoCalloutNotificationEvent",L)}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.chronos2.js.map