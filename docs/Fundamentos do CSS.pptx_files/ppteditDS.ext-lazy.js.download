'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[17],{1123:function(x,G,a){a.d(G,"a",function(){return h});x=a(0);var c=a(3),b=a(40),f=a(563),e=a(305);class h{constructor(u,m,n,l,r,w,y,z,A,B,H,v){this.Mff=1;this.JMa=m;this.eo=u;this.hCj=n;this.Qi=A;this.UB=B;this.ef=H;this.oLc=z;this.wJc=r;this.xJc=l;this.Iza=w;this.Qi.addCssClass(this.eo,"prControl");this.eo.style.width=this.Qi.Uc(m);this.tO=y.Zml();this.qGc=y.Yml();this.tO.LKb(u);this.qGc.LKb(u,m,m);this.Sad=
v;this.z4b()}dispose(){this.N1g();this.clear();this.tO.dispose();this.qGc.dispose();this.Qi.removeCssClass(this.eo,"prControl")}get hCb(){return e.a.none}clear(){this.E$b();this.cAe();this.ZLe()}setZIndex(u){this.eo.style.zIndex=String(u)}Ssg(){this.Sad.ta.style.zIndex=String(this.Mff+f.a.Ora)}ZLe(){this.Sad.ta.style.zIndex="0"}jwh(u,m,n=null){u=this.oLc.Eni(this.JMa,this.JMa,this.hCj,u,"",n);this.tO.setImage(u,m)}ptd(u,m){this.qGc.add(u,m)}cAe(){this.qGc.clear()}E$b(){this.tO.clear()}onClick(){return!0}z4b(){this.xJc&&
this.UB.Zb(c.a.KP,this.eo,this.xJc);this.wJc&&this.UB.Zb(c.a.AR,this.eo,this.wJc);this.Iza?this.ef.Zb(c.a.click,this.eo,this.Iza):this.ef.Zb(c.a.click,this.eo,Object(b.a)(this,this.onClick,"onClick"));this.ef.Zb(c.a.doubleClick,this.eo,Object(b.a)(this,this.onClick,"onClick"))}N1g(){this.xJc&&this.UB.jc(c.a.KP,this.eo,this.xJc);this.wJc&&this.UB.jc(c.a.AR,this.eo,this.wJc);this.Iza?this.ef.jc(c.a.click,this.eo,this.Iza):this.ef.jc(c.a.click,this.eo,Object(b.a)(this,this.onClick,"onClick"));this.ef.jc(c.a.doubleClick,
this.eo,Object(b.a)(this,this.onClick,"onClick"))}}Object(x.a)(h,"ShapePawn",null,[739])},1124:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.z$d="Listening";c.Ibd="Warning";c.VBb="Error";Object(x.a)(c,"VoiceNotificationResourceStrings",null,[])},1216:function(x,G,a){a.d(G,"a",function(){return c});x=a(251);a=a(254);const c=[a.a.Zfb,a.a.Cvd,a.a.Evd,a.a.acf,a.a.snc,a.a.Rfb,x.a.Gva,x.a.oma,a.a.Jud,a.a.W4h,a.a.isa,a.a.vnc,a.a.wnc,x.a.Bja,x.a.PXa,x.a.Pud,x.a.JZ,x.a.FDa,x.a.GDa,x.a.jsa,
x.a.tSa,x.a.jze,a.a.nT,a.a.LN,a.a.wvd,a.a.Zfb,a.a.yvd,a.a.zvd,a.a.Avd,a.a.backspace,a.a.Mva,a.a.Tnc,a.a.m7h,x.a.$Ha,a.a.bold,x.a.bold,x.a.bringForward,x.a.bringToFront,x.a.c$h,a.a.centerJustify,a.a.P4,a.a.Q4,a.a.yQ,a.a.clearFormatting,a.a.spc,a.a.qIa,a.a.Mxd,x.a.gYa,x.a.bpc,x.a.IDa,x.a.B9a,x.a.C9a,x.a.iG,x.a.clearFormatting,x.a.rIa,x.a.N$b,x.a.r6c,a.a.aJa,a.a.mF,x.a.dJa,x.a.editSlideTitle,a.a.enter,a.a.ytc,x.a.huc,a.a.font,x.a.l$,x.a.Cac,x.a.Juc,a.a.fullJustify,a.a.vfa,a.a.xC,x.a.Dca,a.a.insertHyperlink,
x.a.f9c,a.a.Okb,a.a.kdj,a.a.h9c,x.a.i9c,x.a.j9c,a.a.insertOnlinePicture,x.a.insertOnlinePicture,a.a.insertPicture,x.a.insertPicture,a.a.Yfa,a.a.s5,x.a.MAb,x.a.Ozc,x.a.ZRb,x.a.Rzc,x.a.Vzc,x.a.Wzc,x.a.Xzc,x.a.Yzc,x.a.Zzc,x.a.$zc,x.a.$Rb,x.a.aSb,x.a.Xja,x.a.hbc,x.a.NAb,a.a.M$a,a.a.insertTable,a.a.cDc,a.a.smb,a.a.tmb,a.a.umb,a.a.dDc,a.a.fDc,a.a.gDc,a.a.vmb,a.a.wmb,a.a.xmb,a.a.hDc,a.a.ymb,a.a.zmb,a.a.Amb,a.a.leftJustify,a.a.K5,x.a.mergeTableCells,x.a.O9d,x.a.Ipa,a.a.QA,a.a.Z1b,x.a.pka,x.a.bdc,x.a.cdc,
x.a.ncd,a.a.VU,x.a.b2b,x.a.vRc,x.a.vRc,x.a.qCb,x.a.nW,x.a.mdc,x.a.A2b,x.a.Zee,x.a.ska,x.a.jPa,x.a.WU,x.a.XU,x.a.ndc,a.a.UF,x.a.RCb,x.a.SCb,x.a.$Cb,a.a.$Cb,a.a.bsk,x.a.wMg,x.a.TBa,x.a.Ibb,x.a.Zdd,x.a.sendBackward,x.a.hec,x.a.sendToBack,x.a.FB,x.a.kp,x.a.f6b,a.a.Mo,a.a.setItalic,x.a.Kta,x.a.hk,x.a.oDb,x.a.Vbb,x.a.Ged,a.a.cwb,x.a.ape,x.a.c7b,a.a.subscript,a.a.superscript,x.a.$qe,x.a.t7,x.a.$bb,a.a.sxb,a.a.bG,a.a.hI,a.a.Mz,a.a.underline]},1217:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=
a(19);class b{createAuthProviderAsync(f){c.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").eX();return new Promise(e=>{c.a.instance.Na("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(h=>{h=h.fml(f);e(h)})})}}Object(x.a)(b,"SlideShowAppForOfficeAuthFactory",null,[])},1218:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c extends Sys.EventArgs{constructor(b){super();this.slideId=b.SlideId;this.slideIndex=b.SlideIndex;this.tfd=b.TimeLineMappings}}Object(x.a)(c,
"OnPositionChangedEventArgs",Sys.EventArgs,[])},1219:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.CoachButton="coachButton";c.MicButton="micButton";c.PrevButton="prevButton";c.NextButton="nextButton";c.GridButton="gridButton";c.InkButton="inkButton";c.SubtitlesButton="subButton";c.LiveButton="liveButton";c.MoreButton="moreButton";c.ExitButton="exitButton";c.CameraButton="cameraButton";c.OptionsButton="optionsButton";c.SlideIndex="slideIndex";Object(x.a)(c,"SlideshowToolbarButtonIDs",
null,[])},1220:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b){this.qza=!0;this.MEc=this.WKc=this.vMc=this.RIc=null;this.Ega=b}copy(){return new c(this.Ega.copy())}move(b,f){this.qza=!0;this.Ega.move(b,f)}setOffsets(b){this.qza=!0;this.Ega.setOffsets(b)}ej(){return this.Ega.ej()}get Ic(){this.L0c();return this.RIc}get Xc(){this.L0c();return this.vMc}get Bd(){this.L0c();return this.WKc}get xd(){this.L0c();return this.MEc}L0c(){if(this.qza){var b=this.Ega.points;this.RIc=
this.WKc=b[0].x;this.vMc=this.MEc=b[0].y;for(const f of b)this.RIc=Math.min(this.RIc,f.x),this.vMc=Math.min(this.vMc,f.y),this.WKc=Math.max(this.WKc,f.x),this.MEc=Math.max(this.MEc,f.y);this.qza=!1}}}Object(x.a)(c,"Boundary",null,[])},1226:function(x,G,a){function c(){const Ua=l.a.instance.resolve("Common.AFrameworkApplication").nj;return new se(l.a.instance.resolve("Common.IActionManagerExtended"),l.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),l.a.instance.resolve("PowerPointWebEditor.IFocusManager"),
l.a.instance.resolve("PowerPointWebEditor.IFrameContext").notesPane,l.a.instance.resolve("PowerPointWebEditor.INotesView"),Ua.Pd,l.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),l.a.instance.resolve("PowerPointWebEditor.IFrameContext"),l.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Ua,l.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),l.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),l.a.instance.resolve("PowerPointWebEditor.IApplicationSettings"))}
function b(Ua){return document.getElementById("SlideRootViewElement"+Ua)}a.r(G);var f=a(69),e=a(0),h=a(4),u=a(103),m=a(181),n=a(21),l=a(19),r=a(485),w=a(45),y=a(118),z=a(68),A=a(40),B=a(248),H=a(383),v=a(7),C=a(17);class F{static get OZa(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static requestFullscreen(Ua){Ua.webkitRequestFullscreen?
Ua.webkitRequestFullscreen():Ua.msRequestFullscreen?Ua.msRequestFullscreen():Ua.mozRequestFullScreen?Ua.mozRequestFullScreen():Ua.requestFullscreen?Ua.requestFullscreen():C.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():
C.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get NEe(){return document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.fullscreenEnabled}static get A0a(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(e.a)(F,"FullscreenUtils",null,[]);class D{get OZa(){return F.OZa}requestFullscreen(Ua){F.requestFullscreen(Ua)}exitFullscreen(){F.exitFullscreen()}get NEe(){return F.NEe}get A0a(){return F.A0a}get cjl(){return this.NEe&&
!v.a.eA}}Object(e.a)(D,"FullscreenUtilsProxy",null,[713]);class N{EPm(Ua){return inkButton.InkButtonManagerFactory.createInkButtonManager(Ua)}}Object(e.a)(N,"InkButtonHelper",null,[720]);var U=a(42),W=a(13),L=a(3),O=a(5),M=a(22),K=a(28),P=a(48),V=a(296);class Y{constructor(){this.menuDefinition=null;this.autoOpenMenu=!1;this.menuHostId=null;this.autoOpenMenu=!1;this.menuHostId="SlideshowToolbarCalloutMenuContainer"}}Object(e.a)(Y,"FlyoutMenuExtraProps",null,[]);class ta{}ta.Bvm="_136_16_N_20";ta.Cvm=
"none";Object(e.a)(ta,"InkButtonConstants",null,[]);class fa{constructor(){this.menuDefinition=this.controlInMenuRendererFunction=this.menuHostId=this.selectedColor=this.selectedItem=this.icon=null}static create(){return{}}}Object(e.a)(fa,"InkButtonProps",null,[]);class Ta{constructor(){this.onInkMenuActivity=null}}Object(e.a)(Ta,"IInkButtonSettings",null,[]);class ha extends Ta{constructor(){super()}}Object(e.a)(ha,"InkButtonSettings",Ta,[]);class qa{constructor(){this.color=this.item=null}}Object(e.a)(qa,
"InkManagerActivity",null,[]);var ra=a(119);class I{constructor(){this.OJl=!1;this.cMl=this.mMl=0;this.NHl=""}get e1a(){return this.OJl}set e1a(Ua){this.OJl=Ua}get Xxh(){return this.mMl}set Xxh(Ua){this.mMl=Ua}get slideCount(){return this.cMl}set slideCount(Ua){this.cMl=Ua}get Aol(){return this.NHl}set Aol(Ua){this.NHl=Ua}}Object(e.a)(I,"RehearsalContext",null,[716]);var ba=a(268),Ga=a(250);class Oa extends ra.a{constructor(Ua,Nb,hc){super(!1,!0);this.GKj=50001;this.vd=Ua;this.rf=Nb;this.uG=new I;
this.nb=hc;this.vd.OJb(Object(A.a)(this,this.dCb,"onSlideshowExitHandler"));this.vd.naf(Object(A.a)(this,this.Ncc,"onGetCurrentPositionHandler"));this.vd.getCurrentPosition();this.dIc=!1}dispose(){super.dispose();this.dIc||this.vd.jda()}hL(){super.hL();document.getElementById("WACDialogOverlay").style.zIndex=String(this.GKj);const Ua=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(Ua,"SlideshowSubtitleProactiveDialogContainer")}n7(){super.n7();var Ua=document.getElementById(this.ap("WACDialogPanel"));
Ua.style.minWidth=ba.a.Uc(300);Ua.style.width=ba.a.Uc(300);Ua=document.getElementById(this.ap("WACDialogButtonPanel"));var Nb=document.getElementById(this.ap("WACDialogActionButton"));Ua&&Nb&&Ua.removeChild(Nb);if(Nb=document.getElementById(this.ap("WACDialogCancelButton")))Nb.style.color="#ffffff",Nb.style.font="12pt",Nb.style.background="#A92B1A",Nb.innerText="Got it",Ga.a("SubtitlesPopUpFocusFix")&&(this.DHa(),this.I8(Nb));Ua&&Nb&&h.AFrameworkApplication.isRtl&&Ga.a("UseWACDialogButtonPanelNewStyles")&&
(Ua.style.display="inline-block",Ua.style.padding="0px 14px 14px 0px",Nb.style.margin="10px 0px 0px 10px");if(Ua=document.getElementById(this.ap("WACDialogPanel"))){Nb=ba.a.hg();Nb.style.position="absolute";Nb.style.bottom="20px";Nb.style.left="20px";const hc=ba.a.JYa();hc.setAttribute("href","https://support.office.com/en-ie/article/present-with-real-time-automatic-captions-or-subtitles-in-powerpoint-68d20e49-aec3-456a-939d-34a79e8ddd5f#OfficeVersion=Online");hc.setAttribute("target","_blank");hc.innerText=
"More Tips";Nb.appendChild(hc);Ua.appendChild(Nb)}}open(){B.a.J(512495708,830,50,"SlideshowSubtitleProactiveDialog: Open");var Ua=this.rf.Yp("SubtitleProactive_clearly.png");const Nb=this.rf.Yp("SubtitleProactive_network.png"),hc=this.rf.Yp("SubtitleProactive_noNoise.png");this.Bl="<div id='subtitleDlg'><div id='captions' class='SubtitleProactiveCaptions'><label id='captionID'></label></div><div id='sectiontitle' class='SubtitleProactiveSectionTitle '><span id='sectiontitle1'><label id='str1ID'></label></span></br><span id='sectiontitle2'><label id='str2ID'></label></span></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
Ua+"' style='width: 190px; height: 125px;'/><span id='block1_1' class='SubtitleProactiveBlockTitle'><label id='speakStr1ID'></label></span></br></br><span id='block1_2'><label id='speakStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+hc+"' style='width: 190px; height: 125px;'/><span id='block2_1' class='SubtitleProactiveBlockTitle'><label id='noiseStr1ID'></label></span></br><span id='block2_2'><label id='noiseStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
Nb+"' style='width: 190px; height: 125px;'/><span id='block3_1' class='SubtitleProactiveBlockTitle'><label id='networkStr1ID'></label></span></br></br><span id='block3_2'><label id='networkStr2ID'></label></span></br></br></br></div></div>";Ua={["captionID"]:ResourceStrings.L_SubtitleProactive_Caption,["str1ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle1,["str2ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle2,["speakStr1ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr1,["speakStr2ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr2,
["noiseStr1ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr1,["noiseStr2ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr2,["networkStr1ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr1,["networkStr2ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr2};this.Dq("",Object(A.a)(this,this.ePc,"onClickHandler"),Ua);this.vd.setVisibility(!0)}Yfb(){super.Yfb()}Szb(){super.Szb()}Cje(){}Ncc(){this.vd.Sje(Object(A.a)(this,this.Ncc,"onGetCurrentPositionHandler"));this.open()}dCb(){this.dIc=!0;this.vd.TCb(Object(A.a)(this,
this.dCb,"onSlideshowExitHandler"));this.vd.Sje(Object(A.a)(this,this.Ncc,"onGetCurrentPositionHandler"));this.hide()}ePc(Ua){0===Ua&&(Ua=Date.now(),this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,3,Ua,this.uG))}static REl(Ua,Nb,hc){return new Oa(Ua,Nb,hc)}}Object(e.a)(Oa,"SlideshowSubtitleProactiveDialog",ra.a,[]);var Ja=a(1219);class Qa{constructor(){this.buttonIdDictionary=null}}Object(e.a)(Qa,"SlideshowToolbarSettings",null,[]);var Pa=
a(283);class ja extends Sys.EventArgs{constructor(Ua){super();this.text=Ua}}Object(e.a)(ja,"ReadOutEventArgs",Sys.EventArgs,[]);var va=a(251);class Ha{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee){this.JGe=this.uG=this.qf=this.lBb=this.We=this.Onh=this.YOj=this.Wq=null;this.XNa=this.Yad=this.$ad=this.FGe=this.iad=this.$Fj=0;this.hta=!1;this.WEj=!0;this.toh=this.MEa=this.DQj=this.UBj=!1;this.NMj=void 0;this.wNe=(xe,cg)=>{this.tYn(cg.slideIndex+1)};this.rPl=()=>{B.a.J(509157450,830,50,"ReactSlideshowToolbar.OnCameraToggleHandler");
this.NGe=!this.NGe;this.EWk()};this.qPl=()=>{B.a.J(508121225,830,10,"ReactSlideshowToolbar.onCameraErrorHandler");this.NGe=!1;this.EWk()};this.yon=xe=>{xe=xe.id?xe.id:"";"NoCameraPermission"===xe?this.vd.Til():(B.a.J(508916299,830,50,`ReactSlideshowToolbar.onCameraSelectionChanged - triggered with ${""===xe?"invalid":"valid"} id.`),this.vd.q9l(xe),this.Ezh())};this.Daj=()=>{this.pdn.execute(this.u1m);this.Wq.registerButtonCallback(Ja.a.OptionsButton,this.apl);Ga.a("LogSlideshowToolbarMenuOpen")&&
this.apl(void 0)};this.u1m=xe=>{if(!this.Soh){const cg={onCameraMenuActivity:this.yon,onPPTLiveButtonActivity:this.zQl,onCoachButtonActivity:this.xPl,defaultCameraLabel:this.vd.getDefaultCameraLabel()};this.Soh=xe.ZQm(cg);B.a.J(508916298,830,50,"ReactSlideshowToolbar.initOptionsButton - OptionsButtonManager created.")}this.Ezh()};this.apl=()=>{Ga.a("LogSlideshowToolbarMenuOpen")&&B.a.J(507590088,830,50,"ReactSlideshowToolbar.dummyOnOptionsButtonClickedHandler")};this.xPl=()=>{B.a.J(512495941,830,
50,"ReactSlideshowToolbar.OnCoachClickHandler");32===this.ia.Qa(va.a.tUa,2,{entryPoint:2})?this.Aa.mBa||(this.uG.e1a=!0):B.a.J(512495940,830,10,"ReactSlideshowToolbar.OnCoachClickHandler - Failed to start Rehearsal Session")};this.zQl=()=>{this.Ud&&this.Ud.instance&&(B.a.J(512495937,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Ud.instance.PK),this.Ud.instance.PK||(this.Ud.instance.tWg(3,h.AFrameworkApplication.userSessionId,this.Aa.$l,this.nb.podSessionId,h.AFrameworkApplication.ui),this.Ud.instance.Wzb=
!this.qf.Ks,this.qf.Tvf&&!this.qf.Ks&&(B.a.J(512495936,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.qf.Ks=!0,this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,5,Date.now(),this.uG),this.qf.Ks=!1,this.MEa=!0,this.Czh()),this.hta=!1,this.Wq.setToolbarButtonToggleState(Ja.a.LiveButton,!0)));this.SOe()};this.vd=hc;this.Gf=$d;this.lA=ue;this.nb=cf;this.ia=Ua;this.Aa=Nb;this.wRj=$c;this.Ud=Hd;this.ocn=l.a.instance.Na("PowerPointWebEditor.IInkButtonHelper");
this.UFc=this.Aa.getBooleanAppSetting("SlideShowToolbarEaseOfUseEnabled");if(this.Aa.tX||this.UFc)this.pdn=l.a.instance.Na("PowerPointWebEditor.IOptionsButtonLoader");this.rf=Qc;this.dN=Ee}init(Ua,Nb){B.a.J(512495955,830,50,"ReactSlideshowToolbar.Init");this.FQj=Nb.slideCount;this.WEj=!0;this.UBj=!1;var hc={};hc[Ja.a.MicButton]=this.Aa.mTd;hc[Ja.a.PrevButton]=!0;hc[Ja.a.NextButton]=!0;hc[Ja.a.GridButton]=!0;hc[Ja.a.InkButton]=!0;hc[Ja.a.SubtitlesButton]=!0;hc[Ja.a.LiveButton]=!this.UFc;hc[Ja.a.MoreButton]=
!0;hc[Ja.a.CameraButton]=this.Aa.tX;hc[Ja.a.ExitButton]=!0;hc[Ja.a.OptionsButton]=this.Aa.tX||this.UFc;hc[Ja.a.CoachButton]=this.Aa.URd&&!this.UFc;hc[Ja.a.SlideIndex]=this.UFc;this.YOj=new Qa;this.YOj.buttonIdDictionary=hc;if(!document.getElementById("slideshow-toolbar")){this.We=document.createElement("div");this.We.id="slideshow-toolbar";this.We.className="ReactSlideshowToolbar";this.Aa.nBa&&(this.Onh=document.getElementById("slideshowfooterContainerElement"),this.We.className="ReactSlideshowToolbarWithFooter");
hc=document.createElement("div");hc.id="slideshow-toolbar-accessibility";hc.style.position="absolute";hc.style.left="0px";hc.style.top="auto";hc.style.width="0px";hc.style.height="0px";hc.style.overflow="hidden";hc.setAttribute("aria-label",ResourceStrings.l_SlideShowToolbar);this.Aa.nBa?this.Onh.appendChild(this.We):this.Gf.appendChild(this.We);this.Wq=slideshowToolbar.SlideshowToolbarFactory.createToolbar(this.YOj,this.We);if(!this.Wq){B.a.J(512495954,830,10,"ReactSlideshowToolbar.Init m_slideshowToolbarManager is null.");
const Qc=V.a.wi(359);h.AFrameworkApplication.Xs(Qc);U.Health.instance.recordQosError(V.a.Fja(Qc),["SlideShowACE"],!1,!0,!0,!1,null)}this.Wq.renderToolbar();this.We.appendChild(hc);this.We.tabIndex=0}this.lBb||(this.lBb=document.createElement("div"),this.lBb.id="SlideshowToolbarCalloutMenuContainer",this.lBb.className="SlideshowToolbarCalloutMenuContainer",this.lA()&&(this.lBb.style.direction=Pa.a.Mwb),this.Gf.appendChild(this.lBb));this.qf=Ua;this.uG=Nb;this.Wq.registerButtonCallback(Ja.a.MicButton,
()=>{this.Jqn()});this.Wq.registerButtonCallback(Ja.a.CoachButton,()=>{this.xPl()});this.Aa.tX?(this.Wq.registerButtonCallback(Ja.a.CameraButton,this.rPl),this.Y0m(),this.Wq.registerButtonCallback(Ja.a.OptionsButton,this.Daj),this.Wq.showToolbarButton(Ja.a.OptionsButton)):this.UFc&&(this.Wq.registerButtonCallback(Ja.a.OptionsButton,this.Daj),this.Wq.showToolbarButton(Ja.a.OptionsButton));this.qf.Ks||this.Ud&&this.Ud.instance&&this.Ud.instance.PK?(this.MEa=!0,this.Wq.setToolbarButtonToggleState(Ja.a.MicButton,
this.MEa),this.Wq.showToolbarButton(Ja.a.MicButton)):(this.MEa=!1,this.Wq.setToolbarButtonToggleState(Ja.a.MicButton,this.MEa),this.Wq.hideToolbarButton(Ja.a.MicButton));this.Wq.registerButtonCallback(Ja.a.PrevButton,Qc=>{this.LIe(Qc)});this.Wq.registerButtonCallback(Ja.a.NextButton,Qc=>{this.KIe(Qc)});this.Wq.registerButtonCallback(Ja.a.GridButton,Qc=>{this.JIe(Qc)});this.Wq.showToolbarButton(Ja.a.GridButton);this.qf.Tvf&&!this.uG.e1a&&(this.Wq.registerButtonCallback(Ja.a.SubtitlesButton,Qc=>{this.csh(Qc)}),
this.Wq.setToolbarButtonToggleState(Ja.a.SubtitlesButton,this.qf.Ks),this.Wq.showToolbarButton(Ja.a.SubtitlesButton));this.Wq.registerButtonCallback(Ja.a.ExitButton,Qc=>{this.IIe(Qc)});this.Aa.QEe&&this.Aa.$Sd&&(Ua=fa.create(),Ua.icon=this.UFc?"InkingTool_20":ta.Bvm,Ua.selectedColor=ta.Cvm,this.Wq.updateElementProps(Ja.a.InkButton,Ua),this.Wq.registerButtonCallback(Ja.a.InkButton,()=>{this.j1m()}),this.Wq.showToolbarButton(Ja.a.InkButton));this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&!this.uG.e1a&&
(this.Wq.registerButtonCallback(Ja.a.LiveButton,()=>{this.zQl()}),this.Wq.updateFlyoutButtonCallback(Ja.a.LiveButton,this.Ud.instance.PK),this.Wq.setToolbarButtonToggleState(Ja.a.LiveButton,this.Ud.instance.PK),this.Wq.showToolbarButton(Ja.a.LiveButton),this.Ud.instance.Vel(Object(A.a)(this,this.Zxg,"onLiveSessionStarted")),this.Ud.instance.Uel(Object(A.a)(this,this.Yxg,"onLiveSessionEnded")),this.Ud.instance.Rel(Object(A.a)(this,this.Xxg,"onLiveRelaunchPausedSession")),this.Ud.instance.hqm(Object(A.a)(this,
this.BQl,"onLiveCalloutMenuDefintionChanged")));this.SOe();this.zFd();this.UFc&&this.vd.$9b(this.wNe);this.vd.OJb(Object(A.a)(this,this.Y0b,"onExitHandler"));this.vd.T0h(Object(A.a)(this,this.ywg,"onBrowserEventHandler"));this.vd.oaf(Object(A.a)(this,this.$0b,"onGetCurrentSlideDimensionsHandler"));this.vd.Xah(Object(A.a)(this,this.gcd,"onSpecialKeyHandler"));this.vd.X0h(Object(A.a)(this,this.hPc,"onContextMenuHandler"));this.vd.b1h(Object(A.a)(this,this.OPl,"onEnterEndOfShowHandler"));this.vd.k1h(Object(A.a)(this,
this.wQl,"onLeaveEndOfShowHandler"));this.vd.vel(this.qPl);W.a.addHandler(this.We,L.a.gv,Object(A.a)(this,this.ybe,"onMouseOverHandler"));W.a.addHandler(this.We,L.a.uy,Object(A.a)(this,this.kyg,"onMouseOutHandler"));W.a.addHandler(this.lBb,L.a.click,Object(A.a)(this,this.ePc,"onClickHandler"));W.a.addHandler(this.We,L.a.Lj,Object(A.a)(this,this.f1b,"onKeyDownHandler"))}gQn(){window.clearTimeout(this.$Fj);this.$Fj=window.setTimeout(Object(A.a)(this,this.OYm,"hideMouse"),3E3);this.vd.qwb(!0)}OYm(){this.hta||
(window.clearTimeout(this.$Fj),this.vd.qwb(!1))}l_(Ua,Nb){Nb?this.Wq.showToolbarButton(Ua):this.Wq.hideToolbarButton(Ua)}setToolbarButtonToggleState(Ua,Nb){this.Wq.setToolbarButtonToggleState(Ua,Nb)}show(){if(!this.MKe()){if(this.lA()){const Ua=document.getElementById("slideshow-toolbar");if(Ua){const Nb=(this.$ad+this.XNa-16-this.Wq.getToolbarWidth()).toString()+"px";Ua.style.left=Nb}}this.Wq.showToolbar();this.Wq.enterFocusTrapZone();window.clearTimeout(this.iad);window.clearTimeout(this.FGe);this.WEj?
(this.iad=window.setTimeout(Object(A.a)(this,this.hide,"hide"),2E3),this.WEj=!1,this.UBj=!0):this.iad=window.setTimeout(Object(A.a)(this,this.hide,"hide"),3E3);this.vd.qwb(!0)}}p5l(){if(this.lA()){const Ua=document.getElementById("slideshow-toolbar");if(Ua){const Nb=(this.$ad+this.XNa-16-this.Wq.getToolbarWidth()).toString()+"px";Ua.style.left=Nb}}this.Wq.showToolbar();this.Wq.enterFocusTrapZone();window.clearTimeout(this.iad);window.clearTimeout(this.FGe);this.FGe=window.setTimeout(Object(A.a)(this,
this.hide,"hide"),1E4)}hide(){if(!this.hta){const Ua=document.getElementById("slideshow-toolbar");Ua&&!this.Wq.isAnyToolbarElementFocused()&&document.activeElement===Ua&&this.Ffd(ResourceStrings.l_SlideShowToolbarDismissed);window.clearTimeout(this.iad);window.clearTimeout(this.FGe);this.Wq.hideToolbar();this.vd.qwb(!1);this.We.style.display!==Pa.a.Sf||this.MKe()||this.vd.jda()}}zFd(){this.hta||(this.UBj&&this.Ffd(ResourceStrings.l_SlideShowToolbarDismissed),window.clearTimeout(this.iad),window.clearTimeout(this.FGe),
this.Wq.forceHideToolbar(),this.vd.qwb(!1),this.We.style.display!==Pa.a.Sf||this.MKe()||this.vd.jda())}remove(){B.a.J(507773729,830,50,"ReactSlideshowToolbar::Starting toolbar remove.");this.Wq.closeToolbar();this.lBb.style.visibility=Pa.a.ms;this.toh=!1;this.UFc&&this.vd.OUc(this.wNe);this.vd.TCb(Object(A.a)(this,this.Y0b,"onExitHandler"));this.vd.Iok(Object(A.a)(this,this.ywg,"onBrowserEventHandler"));this.vd.FKg(Object(A.a)(this,this.$0b,"onGetCurrentSlideDimensionsHandler"));this.vd.tuh(Object(A.a)(this,
this.gcd,"onSpecialKeyHandler"));this.vd.Lok(Object(A.a)(this,this.hPc,"onContextMenuHandler"));this.vd.Pok(Object(A.a)(this,this.OPl,"onEnterEndOfShowHandler"));this.vd.Vok(Object(A.a)(this,this.wQl,"onLeaveEndOfShowHandler"));this.vd.LYl(this.qPl);W.a.removeHandler(this.We,L.a.gv,Object(A.a)(this,this.ybe,"onMouseOverHandler"));W.a.removeHandler(this.We,L.a.uy,Object(A.a)(this,this.kyg,"onMouseOutHandler"));W.a.removeHandler(this.lBb,L.a.click,Object(A.a)(this,this.ePc,"onClickHandler"));W.a.removeHandler(this.We,
L.a.Lj,Object(A.a)(this,this.f1b,"onKeyDownHandler"));this.We&&(this.Gf.contains(this.We)||this.Onh&&this.Onh.contains(this.We))&&(this.hta=!1);this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&(this.Ud.instance.eZl(Object(A.a)(this,this.Zxg,"onLiveSessionStarted")),this.Ud.instance.dZl(Object(A.a)(this,this.Yxg,"onLiveSessionEnded")),this.Ud.instance.bZl(Object(A.a)(this,this.Xxg,"onLiveRelaunchPausedSession")),this.Ud.instance.aGn(Object(A.a)(this,this.BQl,"onLiveCalloutMenuDefintionChanged")));B.a.J(507773728,
830,50,"ReactSlideshowToolbar::Toolbar removed.")}Y0b(){this.remove()}Ffd(Ua){O.a.rb(Ua)?B.a.J(512495953,830,15,"ReactSlideshowToolbar::TryRaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.wRj.Dhk(new ja(Ua))}$0b(Ua,Nb){try{this.$ad=Nb.yKk;this.Yad=Nb.oKk;this.XNa=Nb.slideWidth;if("NaN"===this.$ad.toString()||"NaN"===this.Yad.toString()){B.a.J(512495952,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler slide dimension info is null.");const hc=V.a.wi(359);h.AFrameworkApplication.Xs(hc);
U.Health.instance.recordQosError(V.a.Fja(hc),["SlideShowACE"],!1,!0,!0,!1,null)}else{const hc=this.Ud.instance&&this.Ud.instance.PK&&!this.toh?26:0;if(this.Aa.nBa){const Qc=document.getElementById("slideshowfooterContainerElement");if(Qc){let $c;$c=this.lA()?(this.$ad+this.XNa-16-this.Wq.getToolbarWidth()).toString()+"px":(this.$ad+2).toString()+"px";Qc.style.left=$c;if(this.qf.Ks&&"AboveSlide"===this.qf.z2)Qc.style.bottom="0px";else{const $d=M.a.aLd();Ua=0;const ue=document.getElementById("AppHeaderPanel");
ue&&(Ua=ue.clientHeight);Qc.style.bottom=this.dN.A0a?($d-this.Yad-hc).toString()+"px":($d-this.Yad-Ua-hc).toString()+"px"}Qc.style.top="auto";const Hd=document.getElementById("ReactToolbarInnerContainer");Hd&&(Hd.style.position="relative")}}else{const Qc=document.getElementById("slideshow-toolbar");if(Qc){let $c;$c=this.lA()?(this.$ad+this.XNa-16-this.Wq.getToolbarWidth()).toString()+"px":(this.$ad+2).toString()+"px";Qc.style.left=$c;const Hd=this.Ud.instance&&this.Ud.instance.PK?(this.Yad+hc).toString()+
"px":this.Yad.toString()+"px";"AboveSlide"===this.qf.z2?(Qc.style.bottom="0px",Qc.style.top="auto"):(Qc.style.top=Hd,Qc.style.bottom="auto");Qc.style.top=Hd}}}this.show()}catch(hc){B.a.J(512495951,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler: Exception thrown when trying to access the OnGetCurrentSlideDimensionsEventArgs, exception: {0}",hc)}}MKe(){return Ga.a("SubtitlesPopUpFocusFix")?void 0!==this.NMj&&this.NMj.Z0:!1}OPl(){this.toh=!0}wQl(){this.toh=!1}f1b(Ua){this.Wq.isAnyCalloutMenuOpen()||
(this.hta=!1);try{this.We.style.display===Pa.a.Wm&&(Ua.keyCode===K.a.mfc||Ua.keyCode===K.a.CG||Ua.keyCode===K.a.P8?this.ath():Ua.keyCode===K.a.VDb||Ua.keyCode===K.a.BG||Ua.keyCode===K.a.O8?this.p$d():Ua.keyCode===K.a.V3?this.lA()?this.p$d():this.ath():Ua.keyCode===K.a.w_?this.lA()?this.ath():this.p$d():Ua.keyCode===K.a.pcb?(this.DQj=!0,this.zFd()):Ua.shiftKey&&Ua.keyCode===K.a.kDa||Ua.keyCode===K.a.vgd?this.zFd():this.vd.Ivh(Ua))}catch(Nb){B.a.J(512495950,822,10,"ReactSlideshowToolbar.OnKeyDownHandler Exception in KeyDownHandler : {0}.",
Nb)}}gcd(Ua,Nb){var hc;this.Wq.isAnyCalloutMenuOpen()||(this.hta=!1);Nb.key===K.a.vgd||Nb.shiftKey&&Nb.key===K.a.kDa?(Ua="off",this.We.style.display===Pa.a.Sf?(this.p5l(),Ua="on"):this.zFd(),B.a.J(512495949,830,50,"ReactSlideshowToolbar.OnSpecialKeyHandler: T key pressed, turned slideshow toolbar {0}",Ua)):this.Aa.tX&&Nb.altKey&&Nb.key===K.a.nfc?(this.Soh||this.Daj(),null===(hc=this.Soh)||void 0===hc?void 0:hc.selectNextCameraDevice()):this.Aa.tX&&Nb.shiftKey&&Nb.key===K.a.Zve&&this.rPl()}hPc(){if(this.DQj)this.DQj=
!1;else{var Ua="off";this.We.style.display===Pa.a.Sf?(this.p5l(),Ua="on"):this.Wq.isAnyCalloutMenuOpen()||this.zFd();B.a.J(512495948,830,50,"ReactSlideshowToolbar.OnContextMenuHandler: ContextMenu event received, turned slideshow toolbar {0}",Ua)}}ywg(Ua,Nb){this.gQn();Nb.clientY<this.Yad+8+20&&Nb.clientY>this.Yad-20-8&&this.show()}ybe(Ua){(Ua=Ua.target)&&this.We.contains(Ua)&&(this.hta=!0)}kyg(Ua){Ua.target&&(this.Wq.isAnyCalloutMenuOpen()?this.lBb.style.visibility=Pa.a.Cw:(this.hta=!1,this.show()));
this.Wq.isAnyCalloutMenuOpen()||this.MKe()||this.Wq.enterFocusTrapZone()}ePc(Ua){this.hta=!1;window.clearTimeout(this.iad);window.clearTimeout(this.FGe);this.lBb.style.visibility=Pa.a.ms;this.iad=window.setTimeout(Object(A.a)(this,this.hide,"hide"),3E3);"SlideshowToolbarCalloutMenuContainer"===Ua.target.id&&(this.MKe()||this.Wq.enterFocusTrapZone())}LIe(){B.a.J(512495947,830,50,"ReactSlideshowToolbar.OnPrevClickHandler");this.ath()}KIe(){B.a.J(512495946,830,50,"ReactSlideshowToolbar.OnNextClickHandler");
this.p$d()}ath(){this.vd.prev()}p$d(){this.vd.next()}Rch(Ua,Nb){this.Wq.updateElementProps(Ua,{disabled:Nb})}tYn(Ua){this.Wq.updateElementProps(Ja.a.SlideIndex,{innerText:`${Ua.toString().padStart(this.FQj.toString().length,"0")} of ${this.FQj}`});this.Rch(Ja.a.PrevButton,!1);this.Rch(Ja.a.NextButton,!1);1==Ua&&this.Rch(Ja.a.PrevButton,!0);Ua==this.FQj&&this.Rch(Ja.a.NextButton,!0)}IIe(){B.a.J(512495945,830,50,"ReactSlideshowToolbar.OnExitClickHandler");this.Wq.closeToolbar();this.vd.exit()}RRk(Ua){const Nb=
!!this.Ud&&!!this.Ud.instance&&this.Ud.instance.PK;var hc=this.qf.drl&&5!==Ua&&!Nb;5!==Ua&&(this.qf.Ks&&(P.a.n_("PPTCaptionDiscoverabiltyDoNotShowAgain","true",P.a.b_)||B.a.J(512495944,822,10,"ReactSlideshowToolbar::ToggleTranscriber - Failed to set cookie for discoverability opt out to true")),this.qf.Ks=!this.qf.Ks);this.Wq.setToolbarButtonToggleState(Ja.a.SubtitlesButton,this.qf.Ks);B.a.J(512495943,830,50,"ReactSlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.qf.Ks);this.qf.Ks&&hc&&(Ga.a("SubtitlesPopUpFocusFix")&&this.zFd(),this.NMj=Oa.REl(this.vd,this.rf,this.nb));hc||(hc=Date.now(),Nb?this.MEa||this.Ud.instance.MBe()?this.vd.Kyh(null):(this.Ud.instance.tyl(),this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,Ua,hc,this.uG)):this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,Ua,hc,this.uG));this.MEa=this.qf.Ks||Nb;this.Czh();this.SOe()}Czh(){this.Wq.setToolbarButtonToggleState(Ja.a.MicButton,
this.MEa);this.MEa?this.Wq.showToolbarButton(Ja.a.MicButton):this.Wq.hideToolbarButton(Ja.a.MicButton)}SOe(){const Ua=this.qf.Ks,Nb=!!this.Ud&&!!this.Ud.instance&&this.Ud.instance.PK,hc=this.uG.e1a,Qc=32!==this.ia.Cb(va.a.tUa,1);Ua||Nb||hc||Qc?this.Wq.hideToolbarButton(Ja.a.CoachButton):this.Wq.showToolbarButton(Ja.a.CoachButton)}Jqn(){B.a.J(512495942,830,50,"ReactSlideshowToolbar.OnMicToggleHandler");this.MEa=!this.MEa;this.Wq.setToolbarButtonToggleState(Ja.a.MicButton,this.MEa);this.vd.OMe(!this.MEa);
if(this.Ud&&this.Ud.instance&&this.Ud.instance.PK&&this.MEa&&!this.Ud.instance.MBe()){this.Ud.instance.tyl();const Ua=this.qf.Ks;this.Ud.instance.Wzb=!this.qf.Ks;this.qf.Ks=!0;this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,5,Date.now(),this.uG);this.qf.Ks=Ua}}Dsm(){return Object(f.b)(this,void 0,void 0,function*(){try{return navigator.permissions?"denied"!==(yield navigator.permissions.query({name:"camera"})).state:(B.a.J(508908556,830,
10,"ReactSlideshowToolbar.areCameraPermissionsGrantedAsync - insecure context."),!1)}catch(Ua){return B.a.J(508885084,830,10,"ReactSlideshowToolbar.areCameraPermissionsGrantedAsync - exception="+Ua),!1}})}Y0m(){Object(f.b)(this,void 0,void 0,function*(){(this.NGe=yield this.Dsm())||B.a.J(508688463,830,10,"ReactSlideshowToolbar.initCameraToggleAsync - camera permissions denied.");this.EWk();this.Wq.showToolbarButton(Ja.a.CameraButton)})}EWk(){this.Wq.setToolbarButtonToggleState(Ja.a.CameraButton,this.NGe);
this.vd.setCameraState(this.NGe)}Ezh(){Object(f.b)(this,void 0,void 0,function*(){var Ua=!!this.Ud&&!!this.Ud.instance&&this.Ud.instance.PK;Ua=yield this.Soh.getControlsInMenuAsync(Ua,Ua?this.Ud.instance.getCalloutMenuDefinition():{sections:[{controls:[]}]},this.Aa.URd,this.Aa.tX);this.Wq.updateElementProps(Ja.a.OptionsButton,{menuDefinition:Ua,menuHostId:"SlideshowToolbarCalloutMenuContainer"})})}csh(){B.a.J(512495939,830,50,"ReactSlideshowToolbar.OnTranscribeHandler");this.RRk(3)}JIe(){B.a.J(512495938,
830,50,"ReactSlideshowToolbar.OnGridViewClickHandler");let Ua;Ga.a("AddGridViewTelemetryInSS")&&(Ua=performance.now());this.ia.Qa(va.a.Voe,2,null);Ga.a("AddGridViewTelemetryInSS")&&B.a.J(507852185,830,15,JSON.stringify({timeTaken:performance.now()-Ua}))}Zxg(){this.Wq.setToolbarButtonToggleState(Ja.a.LiveButton,!0);this.Bzh(!1,!1);this.MEa=!0;this.Czh();this.SOe();this.bOl();this.Ezh()}Yxg(){this.Ezh();this.Wq.setToolbarButtonToggleState(Ja.a.LiveButton,!1);this.Bzh(!1,!0);this.Ud&&this.Ud.instance&&
this.Ud.instance.Wzb&&!this.qf.Ks&&(B.a.J(512495907,830,50,"Stopping subtitle for stopping live session."),this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,5,Date.now(),this.uG));this.Ud.instance.Wzb=!1;this.qf.Ks||(this.MEa=!1,this.Czh());this.SOe()}Xxg(){this.Ud&&this.Ud.instance&&(this.hta=!0,this.show(),this.lBb.style.visibility=Pa.a.Cw,this.Bzh(!0,!1),this.bOl());this.SOe()}bOl(){this.Aa.BEg&&!this.Ud.instance.MBe()&&(this.MEa=!1,this.Wq.setToolbarButtonToggleState(Ja.a.MicButton,
this.MEa),this.qf.Ks=!1,this.Wq.setToolbarButtonToggleState(Ja.a.SubtitlesButton,this.qf.Ks))}BQl(){this.Bzh(!1,!1)}Bzh(Ua,Nb){if(this.Ud&&this.Ud.instance){const hc=new Y;hc.menuDefinition=Nb?null:this.Ud.instance.getCalloutMenuDefinition();hc.autoOpenMenu=Ua;this.Wq.updateElementProps(Ja.a.LiveButton,hc);this.Wq.updateFlyoutButtonCallback(Ja.a.LiveButton,!Nb)}}j1m(){this.ocn.execute(Object(A.a)(this,this.i1m,"initInkButton"));const Ua=new qa;Ua.item="Init";this.vd.n8j(Ua);this.Wq.registerButtonCallback(Ja.a.InkButton,
()=>{this.$ol()});Ga.a("LogSlideshowToolbarMenuOpen")&&this.$ol()}i1m(Ua){const Nb=new ha;Nb.onInkMenuActivity=hc=>{this.pqn(hc)};this.JGe=Ua.EPm(Nb);Ua=fa.create();Ua.icon=this.JGe.getIcon();Ua.menuDefinition=this.JGe.getControlsInMenu();Ua.menuHostId="SlideshowToolbarCalloutMenuContainer";this.Wq.updateElementProps(Ja.a.InkButton,Ua)}$ol(){Ga.a("LogSlideshowToolbarMenuOpen")&&B.a.J(507590087,830,50,"ReactSlideshowToolbar.dummyOnInkButtonClickedHandler")}pqn(Ua){let Nb;Ga.a("SlideShowInkTelemetry")&&
(Nb=performance.now());this.vd.n8j(Ua);const hc=fa.create();hc.selectedColor=this.JGe.getSelectedColor();hc.icon=this.JGe.getIcon();hc.menuDefinition=this.JGe.getControlsInMenu();this.Wq.updateElementProps(Ja.a.InkButton,hc);Ga.a("FocusLossInSlideShow")&&!this.MKe()&&this.Wq.enterFocusTrapZone();this.zFd();Ga.a("SlideShowInkTelemetry")&&B.a.J(507859203,830,15,JSON.stringify({timeTaken:Math.round(performance.now()-Nb),type:Ua.item,color:Ua.color}))}}Object(e.a)(Ha,"ReactSlideshowToolbar",null,[795,
796]);var gb=a(269);class Gb{constructor(Ua,Nb){this.eo=Ua;this.$4f=document.createElement("div");this.$4f.id="slideshowfooterContainerElement";this.$4f.className="slideshowFooterContainer";this.ia=Nb}init(){B.a.J(507843160,830,50,"SlideShowFooterContainer.Init");this.eo&&this.eo.appendChild(this.$4f)}remove(){this.eo&&this.eo.contains(this.$4f)&&this.eo.removeChild(this.$4f)}Hb(){this.ia.za(va.a.kIk,gb.a.application,Object(A.a)(this,this.OPn,"showFooterElements"));this.ia.za(va.a.e8i,gb.a.application,
Object(A.a)(this,this.MYm,"hideFooterElements"))}OPn(Ua,Nb,hc){2===hc&&(Ua=document.getElementById("slideshowfooterContainerElement"))&&(Ua.style.display="flex");return 32}MYm(Ua,Nb,hc){2===hc&&(Ua=document.getElementById("slideshowfooterContainerElement"))&&(Ua.style.display=Pa.a.Sf);return 32}}Object(e.a)(Gb,"SlideShowFooterContainer",null,[797]);class Mb{constructor(){this.hostElement=null;this.baseZIndex=0}}Object(e.a)(Mb,"IVoiceActorSettings",null,[]);class hb{constructor(){this.Krg=this.eo=
this.I8d=null}init(){B.a.J(595198290,830,50,"SlideShowVoiceNotification.Init");this.I8d=document.createElement("div");this.I8d.id="voiceNotificationContainerElement";this.I8d.className="voiceNotificationContainer";(this.eo=document.getElementById("slideshowfooterContainerElement"))&&this.eo.insertBefore(this.I8d,this.eo.firstChild);const Ua=new Mb;Ua.baseZIndex=50002;Ua.hostElement=this.I8d;this.Krg=voiceUI.VoiceActorFactory.CREATE_VOICE_ACTOR(Ua)}remove(){this.eo&&this.eo.contains(this.I8d)&&this.eo.removeChild(this.I8d)}show(Ua,
Nb){this.Krg&&this.Krg.showNotification(Ua,Nb)}hide(){this.Krg&&this.Krg.hideNotification()}}Object(e.a)(hb,"SlideShowVoiceNotification",null,[721]);var Da=a(85);class Bb extends ra.a{constructor(Ua,Nb){super(!1,!0);this.Rog=null;this.RYd=this.O$c=0;this.GKj=50001;this.UGe=null;this.vd=Ua;this.ldn=Nb;this.vd.OJb(Object(A.a)(this,this.dCb,"onSlideshowExitHandler"));this.vd.naf(Object(A.a)(this,this.Ncc,"onGetCurrentPositionHandler"));this.vd.getCurrentPosition();this.dIc=!1}get Fxh(){if(void 0===this.Rog||
null===this.Rog)this.Rog=document.getElementById("GotoDlgInput");return this.Rog}$Zn(){if(!RegExp("^[0-9]+$").test(this.Fxh.value))return this.Fxh.value=this.O$c.toString(),!1;this.RYd=Number.parseInvariant(this.Fxh.value);this.RYd=Math.min(this.RYd,this.ldn);this.RYd=Math.max(this.RYd,1);return!0}dispose(){super.dispose();this.Rog=null;this.dIc||this.vd.jda()}hL(){super.hL();document.getElementById("WACDialogOverlay").style.zIndex=String(this.GKj);const Ua=document.getElementById("WACDialogOuterContainer");
Sys.UI.DomElement.addCssClass(Ua,"SlideShowGoToDialogContainer")}n7(){super.n7();const Ua=document.getElementById(this.ap("WACDialogPanel"));Ua.style.minWidth=ba.a.Uc(300);Ua.style.width=ba.a.Uc(300)}open(){B.a.J(507843218,830,50,"SlideshowGoToDialog: Open");this.Bl="<div id='GotoDlgLabelHolder'><label id='GotoDlgLabel'></label></div><input id='GotoDlgInput' type='text'/>";const Ua={["GotoDlgLabel"]:ResourceStrings.l_GotoSlideLabel,["GotoDlgInput"]:this.O$c.toString()};this.Dq(ResourceStrings.L_GoTo,
Object(A.a)(this,this.ePc,"onClickHandler"),Ua);this.vd.setVisibility(!0);this.Fxh.focus()}Yfb(){super.Yfb();this.UGe=Object(A.a)(this,this.f1b,"onKeyDownHandler");h.AFrameworkApplication.Ea.gI.PCb(L.a.Lj,window.document,this.UGe,null)}Szb(){super.Szb();void 0!==this.UGe&&null!==this.UGe&&h.AFrameworkApplication.Ea.gI.Nfd(L.a.Lj,window.document,this.UGe);this.UGe=null}Cje(){}Ncc(Ua,Nb){this.vd.Sje(Object(A.a)(this,this.Ncc,"onGetCurrentPositionHandler"));this.O$c=Nb.slideIndex+1;this.open()}dCb(){this.dIc=
!0;this.vd.TCb(Object(A.a)(this,this.dCb,"onSlideshowExitHandler"));this.vd.Sje(Object(A.a)(this,this.Ncc,"onGetCurrentPositionHandler"));this.hide()}f1b(Ua){Ua=Ua.Sb.keyCode;return Ua===K.a.hv?(this.$Zn()&&(this.C8c(this.RYd),this.hide()),!0):Ua===K.a.wgd||Ua===K.a.PUa||Ua===K.a.x$l||Ua===K.a.qPe?!0:!1}ePc(Ua){1===Ua&&this.C8c(this.RYd)}C8c(Ua){this.vd.C8c(Ua-1)}static J8m(Ua,Nb){1>=Nb||void 0!==Da.a.lF&&null!==Da.a.lF||new Bb(Ua,Nb)}}Object(e.a)(Bb,"SlideshowGoToDialog",ra.a,[]);class Za{constructor(Ua,
Nb,hc,Qc,$c,Hd,$d,ue,Fe){this.Cab=this.$=null;this.MGe=!1;this.uab=[];this.V$c=this.Qca=this.k5f=null;this.vd=Ua;this.Ub=Nb;this.ccc=hc;this.ia=Qc;this.Ge=$c;this.Gf=Hd;this.lA=$d;this.dN=ue;this.Ud=Fe}init(){this.$||(this.$=document.createElement("div"),this.$.id="SlideshowContextMenuContainer",this.$.className="SlideshowContextMenuContainer");this.Cab=document.createElement("div");this.Cab.className="SlideshowContextMenu cui-menu";this.Cab.tabIndex=0;const Ua=document.createElement("ul");Ua.className=
"SlideshowContextMenuList cui-menusection-items";const Nb=this.lA();let hc=this.qsa(ResourceStrings.L_Next,Object(A.a)(this,this.KIe,"onNextClickHandler"),Nb);Array.add(this.uab,hc);Ua.appendChild(hc);hc=this.qsa(ResourceStrings.L_Previous,Object(A.a)(this,this.LIe,"onPrevClickHandler"),Nb);Array.add(this.uab,hc);Ua.appendChild(hc);hc=this.qsa(ResourceStrings.l_GotoCell,Object(A.a)(this,this.fqn,"onGoToClickHandler"),Nb);Array.add(this.uab,hc);Ua.appendChild(hc);hc=this.qsa(ResourceStrings.L_GridView_SeeAllSlides,
Object(A.a)(this,this.JIe,"onGridViewClickHandler"),Nb);Array.add(this.uab,hc);Ua.appendChild(hc);this.dN.cjl&&(this.k5f=this.qsa(this.dN.A0a?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen,Object(A.a)(this,this.zPc,"onFullscreenClickHandler"),Nb),Array.add(this.uab,this.k5f),Ua.appendChild(this.k5f),this.dN.OZa&&!this.Qca&&(this.Qca=Object(A.a)(this,this.Dxg,"onFullscreenChangeHandler"),$addHandler(this.Gf,this.dN.OZa,this.Qca)));hc=this.qsa(ResourceStrings.L_EndShow,Object(A.a)(this,
this.IIe,"onExitClickHandler"),Nb);Array.add(this.uab,hc);Ua.appendChild(hc);this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&(this.V$c=this.qsa(ResourceStrings.l_EndLivePresentation,Object(A.a)(this,this.Dpn,"onEndLivePresentationClickHandler"),Nb),Array.add(this.uab,this.V$c));this.Cab.appendChild(Ua);this.$.appendChild(this.Cab);this.Gf.appendChild(this.$);this.ccc.addHandler(this.$,L.a.click,Object(A.a)(this,this.ePc,"onClickHandler"));this.ccc.addHandler(this.$,L.a.contextMenu,Object(A.a)(this,
this.eQl,"onHostContextMenuHandler"));this.ccc.addHandler(this.Cab,L.a.gv,Object(A.a)(this,this.ybe,"onMouseOverHandler"));this.vd.X0h(Object(A.a)(this,this.hPc,"onContextMenuHandler"));this.vd.OJb(Object(A.a)(this,this.Y0b,"onExitHandler"))}show(){if(this.Ud&&this.Ud.instance&&this.Ud.instance.PK&&this.V$c&&!this.V$c.parentNode){const Ua=this.Cab.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===Ua.length&&Ua[0].appendChild(this.V$c)}this.MGe||(this.ccc.addHandler(window.document,
L.a.Lj,Object(A.a)(this,this.f1b,"onKeyDownHandler")),this.ccc.addHandler(window.document,L.a.Iq,Object(A.a)(this,this.vQl,"onKeyUpHandler")),this.MGe=!0);this.$.style.visibility=Pa.a.Cw}hide(){this.ccc.removeHandler(window.document,L.a.Lj,Object(A.a)(this,this.f1b,"onKeyDownHandler"));this.ccc.removeHandler(window.document,L.a.Iq,Object(A.a)(this,this.vQl,"onKeyUpHandler"));this.MGe=!1;this.$.style.visibility=Pa.a.ms;if(this.V$c&&this.V$c.parentNode){const Ua=this.Cab.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");
1===Ua.length&&Ua[0].removeChild(this.V$c)}}remove(){this.$&&(this.ccc.removeHandler(this.$,L.a.click,Object(A.a)(this,this.ePc,"onClickHandler")),this.ccc.removeHandler(this.$,L.a.contextMenu,Object(A.a)(this,this.eQl,"onHostContextMenuHandler")),this.Gf.contains(this.$)&&this.Gf.removeChild(this.$));this.$=null;Array.clear(this.uab)}Y0b(){this.vd.TCb(Object(A.a)(this,this.Y0b,"onExitHandler"));this.vd.Lok(Object(A.a)(this,this.hPc,"onContextMenuHandler"));this.k5f&&($removeHandler(this.Gf,this.dN.OZa,
this.Qca),this.Qca=null);this.remove()}ePc(Ua){"SlideshowContextMenuContainer"===Ua.target.id&&(this.hide(),this.vd.jda())}hPc(Ua,Nb){this.qSl(Nb.clientX,Nb.clientY)}eQl(Ua){this.qSl(Ua.clientX,Ua.clientY)}ybe(Ua){(Ua=Ua.target)&&"li"===Ua.tagName.toLowerCase()&&(this.Zmk(document.activeElement),this.I8(Ua))}f1b(Ua){const Nb=Ua.keyCode,hc=Ua.shiftKey;Nb===K.a.vu||Nb===K.a.U3?this.eOl(!!(1^hc)):Nb===K.a.x_&&this.eOl(!!(0^hc));Ua.preventDefault()}vQl(Ua){var Nb=Ua.keyCode;Nb===K.a.hv||Nb===K.a.C7?(Nb=
document.activeElement,Array.contains(this.uab,Nb)&&Nb.click()):Nb===K.a.Q2&&this.vd.exit();Ua.preventDefault()}qSl(Ua,Nb){this.setPosition(Ua,Nb);this.Gxm();this.show();this.Cab.focus();this.Ge.Chk(new ja(ResourceStrings.L_ControlMenu))}setPosition(Ua,Nb){if(this.Cab){var hc=this.Cab.offsetWidth,Qc=this.Cab.offsetHeight,$c=this.$.clientHeight;Ua+hc>this.$.clientWidth&&(Ua-=hc);Nb+Qc>$c&&(Nb-=Qc);this.Cab.style.top=ba.a.Uc(Nb);this.Cab.style.left=ba.a.Uc(Ua)}}qsa(Ua,Nb,hc){const Qc=document.createElement("li");
Qc.className="SlideshowContextMenuItem cui-ctl-mediumlabel";Qc.innerText=Ua;Qc.style.direction=hc?"rtl":"ltr";Qc.tabIndex=1;this.ccc.addHandler(Qc,L.a.click,Nb);return Qc}LIe(){B.a.J(507843392,830,50,"SlideshowContextMenu.OnPrevClickHandler");this.vd.prev();this.hide();this.vd.jda()}KIe(){B.a.J(507843363,830,50,"SlideshowContextMenu.OnNextClickHandler");this.vd.next();this.hide();this.vd.jda()}fqn(){B.a.J(507843362,830,50,"SlideshowContextMenu.OnGoToClickHandler");this.hide();Bb.J8m(this.vd,this.Ub.hl())}JIe(){B.a.J(507843361,
830,50,"SlideshowContextMenu.OnGridViewClickHandler");this.hide();this.ia.Qa(va.a.Voe,2,null)}zPc(){B.a.J(507843360,830,50,"SlideshowContextMenu.OnFullscreenClickHandler");this.vd.KRk();this.hide();this.vd.jda()}Dxg(){this.k5f.innerText=this.dN.A0a?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen}IIe(){B.a.J(507843359,830,50,"SlideshowContextMenu.OnExitClickHandler");this.hide();this.vd.exit()}Dpn(){B.a.J(507843358,830,50,"SlideshowContextMenu.OnEndLivePresentationClickHandler");
this.hide();this.vd.jda();this.Ud&&this.Ud.instance&&this.Ud.instance.PK&&this.Ud.instance.showEndSessionDialog(()=>{this.Ud.instance.Htf(4)},()=>{})}eOl(Ua){const Nb=document.activeElement,hc=Array.indexOf(this.uab,Nb);Ua=this.uab[((-1===hc?Ua?0:-1:Ua?hc+1:hc-1)+this.uab.length)%this.uab.length];void 0!==Ua&&null!==Ua&&(this.Zmk(Nb),this.I8(Ua))}Gxm(){this.uab.forEach(Ua=>{this.Zmk(Ua)})}I8(Ua){void 0!==Ua&&null!==Ua&&(Sys.UI.DomElement.addCssClass(Ua,"SlideshowContextMenuItemFocus"),Ua.focus(),
this.Ge.Chk(new ja(Ua.innerText)))}Zmk(Ua){void 0!==Ua&&null!==Ua&&Sys.UI.DomElement.removeCssClass(Ua,"SlideshowContextMenuItemFocus")}}Object(e.a)(Za,"SlideshowContextMenu",null,[796]);var mb=a(30),vb=a(483),sb=a(83),bc=a(885),yb=a(342),uc=a(397),vc=a(284);class wc{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee,xe,cg,Gg,Of,ch,vg,jg,sh,Zh,ae){this.ua=new mb.a;this.Qca=null;this.WOj=this.XOj=this.Yph=this.bpg=-1;this.bHl=this.dHl=this.cHl=this.VGe=null;this.ZZf="";this.Aqh=this.bqh=-1;this.fKl=new Date(0);
this.bKl="";this.QHl=null;this.IIl=this.v1d=this.Enh=this.CHj=!1;this.jKc=this.uG=this.qf=null;this.E1f=-1;this.qEj=this.zIl=!1;this.dN=Ua;this.vd=Nb;this.pBb=hc;this.Ub=Fe;this.la=$d;this.mbn=Qc;this.qm=$c;this.$p=Hd;this.lr=ue;this.nb=cf;this.oR=Ee;this.ee=xe;this.SEa=cg;this.od=Gg;this.Gqh=Of;this.ucc=ch;this.kz=this.lr.sP();this.lMl=this.la.gKe;this.BRj=this.la.CNe;this.od.sE(Object(A.a)(this,this.JI,"onSessionEnd"));this.oR.waf(Object(A.a)(this,this.Wbd,"onPodSessionUnavailable"));this.od.VG(Object(A.a)(this,
this.Oq,"onSessionRehydrated"));this.la.KXa&&(this.oR.a$b(Object(A.a)(this,this.$ab,"onPodSessionRefreshed")),this.oR.Zah(Object(A.a)(this,this.Vrh,"onPodSessionRefreshedFromBrowser")));this.ia=vg;this.Ud=jg;this.Xph=sh;this.Su=Zh;this.d_b=ae;Ua=document.createElement("div");Ua.id="HiddenFocusTrapAnchor";h.AFrameworkApplication.ga.getBooleanAppSetting("RegionComposerIsEnabled")||h.AFrameworkApplication.ga.getBooleanAppSetting("Fluent2StyleIsEnabled")?Ua.style.position="absolute":Ua.style.position=
"position: absolute";Ua.style.left="-10000px";Ua.style.top="auto";Ua.style.width="1px";Ua.style.height="1px";Ua.style.overflow="hidden";Ua.tabIndex=-1;this.kz.insertBefore(Ua,this.kz.firstChild)}dispose(){this.od.F8(Object(A.a)(this,this.JI,"onSessionEnd"));this.oR.nZl(Object(A.a)(this,this.Wbd,"onPodSessionUnavailable"));this.od.wka(Object(A.a)(this,this.Oq,"onSessionRehydrated"));this.la.KXa&&(this.oR.PUc(Object(A.a)(this,this.$ab,"onPodSessionRefreshed")),this.oR.fpk(Object(A.a)(this,this.Vrh,
"onPodSessionRefreshedFromBrowser")))}B1m(Ua,Nb){this.QHl=Ua;this.qf=Nb;this.uG=new I}Hpj(){return!O.a.rb(this.ZZf)}get uMf(){return this.v1d}set uMf(Ua){this.v1d=Ua}J2l(){this.qEj=!0}Txh(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee,xe,cg){U.Health.instance.addQosPillar("Present");this.Hpj()&&B.a.J(512495816,830,15,"SlideshowManager:StartFrom starting a new SlideShow while one is already running");h.AFrameworkApplication.ga.getBooleanAppSetting("PptPresenterViewEnabled")&&(this.jKc=l.a.instance.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager"))&&
this.jKc.zBb&&(this.E1f=Nb,this.ia.Cb(va.a.Ued,2,null),this.jKc.Qel(Object(A.a)(this,this.prn,"onPresenterViewSyncMessageReceivedHandler")));const Gg=hc;this.la.mBa&&(hc=!1);this.bpg=cf;this.Yph=Date.now();const Of=document.createElement("div");Of.id="startingSlideshowHiddenDiv";Of.style.position="position: absolute";Of.style.left="-10000px";Of.style.top="auto";Of.style.width="1px";Of.style.height="1px";Of.style.overflow="hidden";Of.tabIndex=-1;Of.setAttribute("aria-live","assertive");this.kz.insertBefore(Of,
this.kz.firstChild);Of.innerText=ResourceStrings.l_StartingSlideShow;const ch=ue+cf.toString();this.ZZf=ch;this.SEa&&this.SEa.rne(!0);this.la.LDl&&this.Gqh&&this.Gqh.rne(!0);this.uG&&(this.uG.e1a=hc,this.uG.Xxh=Nb,this.uG.slideCount=this.Ub.hl(),this.uG.Aol=this.la.gYl);this.la.nBa&&this.Xph&&this.Xph.init();this.la.nBa&&this.Su&&this.Su.execute(jg=>{jg.init()});this.la.tX&&this.d_b&&this.d_b.execute(jg=>{jg.init()});this.pBb.execute(jg=>{jg.init(this.qf,this.uG)});this.cHl=this.kz.style.top;this.kz.style.top=
ba.a.Uc(0);this.la.V0a&&(this.dHl=this.kz.style.width,this.bHl=this.kz.style.height,this.kz.style.width="100%",this.kz.style.height="100%");this.vd.show();this.TEl();this.la.DKk&&vb.a.jcb(!1);h.AFrameworkApplication.ga.getBooleanAppSetting("PptPresenterViewEnabled")&&this.jKc&&this.jKc.zBb&&this.vd.$9b(Object(A.a)(this,this.Ybe,"onSlideChangedHandler"));this.vd.OJb(Object(A.a)(this,this.Y0b,"onExitHandler"));this.vd.Hel(Object(A.a)(this,this.zPc,"onFullscreenClickHandler"));this.vd.Wah(Object(A.a)(this,
this.LRl,"onSlideshowReadyHandler"));this.vd.Bel(Object(A.a)(this,this.HIe,"onErrorHandler"));this.vd.Xah(Object(A.a)(this,this.gcd,"onSpecialKeyHandler"));this.vd.o1h(Object(A.a)(this,this.XQl,"onPodSessionExpiredHandler"));this.vd.Oel(Object(A.a)(this,this.GQl,"onLogEndOfTranscriptionSessionHandler"));this.vd.Mel(Object(A.a)(this,this.DQl,"onLiveSubtitlesDockedViewHandler"));this.vd.mfl(Object(A.a)(this,this.pXl,"recordQosErrorHandler"));this.la.KXa||(this.oR.a$b(Object(A.a)(this,this.$ab,"onPodSessionRefreshed")),
this.oR.Zah(Object(A.a)(this,this.Vrh,"onPodSessionRefreshedFromBrowser")));this.mqm(Object(A.a)(this,this.Orh,"onKeydownHandler"));hc=Date.now();let vg=!this.la.wnj||Ee;vg||(vg=this.qm.$7c().$N());this.zIl=vg;cf=Date.now();B.a.J(512495815,830,50,"SlideshowManager: Outbound decision time in {0} ms, fWaitForForceOutbound is {1}, fFailOverInProgress is {2}.",cf-hc,vg?"True":"False",Ee?"True":"False");this.XOj=Date.now();this.qm.$7c().forceOutbound(()=>{B.a.J(512495814,830,50,"SlideshowManager: Will notify Replication Cache to flush unsaved revisions.");
this.qm.flush(()=>{this.WOj=Date.now();B.a.J(512495813,830,50,"SlideshowManager: Finished flushing in {0} ms.",this.WOj-this.XOj);this.ZZf===ch&&vg&&(Ee&&xe&&(B.a.J(512495812,830,50,"SlideshowManager: Refreshing the pod sessionId."),$c=xe.rp,Hd=xe.podSessionId),this.p6l(Ua,Nb,Qc,$c,Hd,$d,ue,Fe,cg,Gg),B.a.J(512495811,830,50,"SlideshowManager: Launched slideshow after ForceOutbound response."))},jg=>{B.a.J(512495810,830,10,"SlideshowManager: Failed to make Replication Cache flush unsaved revisions. {0}",
jg.ServerError);return!1})},(jg,sh)=>{B.a.J(512495809,830,10,"SlideshowManager: Failed to force outbound. {0}",sh)},null);this.ZZf!==ch||vg||(this.p6l(Ua,Nb,Qc,$c,Hd,$d,ue,Fe,cg,Gg),B.a.J(512495808,830,50,"SlideshowManager: Launched slideshow without waiting for ForceOutbound."))}p6l(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf=!1){const Ee=sb.a.create().toString();this.la.Sjj&&this.Mun(hc,$c,$d,Ee);const xe={};xe.IsFrameNull=this.vd?"false":"true";xe.slideshowClickTimeMs=this.bpg;void 0!==window.performance.timing&&
null!==window.performance.timing&&(xe.slideshowClickTimePerformanceAPI=this.bpg-window.performance.timing.navigationStart);B.a.J(590976135,830,15,"SlideshowManager:startFromInternal - "+JSON.stringify(xe));this.vd.Txh(Ua,Nb,Qc,$c,Hd,$d,ue,Ee,this.bpg);0<this.lMl&&(this.bqh=window.setTimeout(Object(A.a)(this,this.xsn,"onStartSlideshowTimeoutHandler"),this.lMl));this.Ud&&this.Ud.instance&&this.Ud.instance.ash(Ua,Nb,hc,Qc,$c,Hd,$d,h.AFrameworkApplication.ui,Fe);this.qf&&this.qf.iJn();cf&&(this.qf.Ks=
!1)}gcd(Ua,Nb){if(Nb.key===K.a.Q2)B.a.J(512495779,830,50,"SlideshowManager.OnSpecialKeyHandler Esc key"),this.pBb.execute(hc=>{hc.remove()}),B.a.J(507773725,830,50,"SlideshowManager.OnSpecialKeyHandler Toolbar remove invoked."),this.vd.exit(),B.a.J(507773724,830,50,"SlideshowManager.OnSpecialKeyHandler Frame exit invoked.");else if(Nb.key===K.a.tgd)this.ia.Qa(va.a.j_g,2,null);else if(Nb.key===K.a.q9b)this.la.getBooleanAppSetting("SlideShowToolbarEaseOfUseEnabled")&&(B.a.J(507655364,830,50,"SlideShowManager"),
32===this.ia.Qa(va.a.tUa,2,{entryPoint:2})?this.la.mBa||(this.uG.e1a=!0):B.a.J(507655363,830,10,"SlideShowManager - Failed to start Rehearsal Session"));else if(!(Nb.key!==K.a.X6g||Object(Ga.a)("altJTogglesCaptionsMenu")&&Nb.altKey)&&this.la.aBb&&this.qf&&this.qf.Ttc&&this.uG&&this.Ub&&!this.uG.e1a&&this.la.dEl&&this.qf.frl)try{this.qf.Ks&&(P.a.n_("PPTCaptionDiscoverabiltyDoNotShowAgain","true",P.a.b_)||B.a.J(512495778,822,10,"SlideShowManager::OnSpecialKeyHandler - Failed to set cookie for discoverability opt out to true"));
this.qf.Ks=!this.qf.Ks;B.a.J(512495777,830,50,"SlideshowManager.OnSpecialKeyHandler m_subtitleContext FUseSubtitles is changed to: {0}",this.qf.Ks);const hc=document.getElementById("buttonSubtitle");if(hc){const $c=hc.getElementsByTagName("span")[0].getElementsByTagName("img")[0];$c&&($c.className=this.qf.Ks?"prt2_SubtitleSlideShowToggleHover_40x40x32":"prt2_SubtitleSlideShowToggleOff_40x40x32")}const Qc=!!this.Ud&&!!this.Ud.instance&&this.Ud.instance.PK;if(Qc)this.vd.Kyh(null);else{const $c=Date.now();
this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,4,$c,this.uG)}this.pBb.execute($c=>{$c.setToolbarButtonToggleState(Ja.a.SubtitlesButton,this.qf.Ks);$c.l_(Ja.a.CoachButton,!this.qf.Ks&&!Qc)})}catch(hc){B.a.J(512495776,830,10,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the J key: {0}",hc)}else if(Nb.key===K.a.$ve&&this.Ud&&this.Ud.instance&&this.Ud.instance.Ttc&&this.Ud.instance.eIm&&this.uG&&!this.uG.e1a)try{if(this.Ud.instance.PK)this.Ud.instance.showWelcomeScreen();
else{this.Ud.instance.Wzb=!this.qf.Ks;if(this.qf.Tvf&&!this.qf.Ks){this.qf.Ks=!0;const hc=Date.now();this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,5,hc,this.uG);this.qf.Ks=!1}this.Ud.instance.tWg(4,h.AFrameworkApplication.userSessionId,this.la.$l,this.nb.podSessionId,h.AFrameworkApplication.ui)}}catch(hc){B.a.J(512495775,830,10,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the L key: {0}",hc)}}prn(Ua,Nb){Nb&&(Ua=
Nb.slideIndex,Ua!==this.E1f&&(this.E1f=Ua,this.vd.C8c(Ua)))}KQc(){B.a.J(512495774,830,15,"SlideshowManager.OnVisibilityChangeHandler: Full screen exited due to tab visibility change.");this.CHj=!0}Mun(Ua,Nb,hc,Qc){B.a.J(512495773,830,50,"SlideshowManager.PauseResumeMerge. correlationId: {0}",Qc);Ua=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked={2}",Ua,Nb,!0);Nb={WaitForSessionTimeoutMs:"0"};Nb["X-UserSessionId"]=hc;Nb["X-CorrelationID"]=Qc;Nb["X-WacCluster"]=this.QHl;
this.$p.rk(Ua,2,null,Nb,!1,2,()=>{B.a.J(512495772,830,15,"SlideshowManager.PauseResumeMerge: Pause/resume merge succeeded. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,hc,Qc)},()=>{B.a.J(512495771,830,10,"SlideshowManager.PauseResumeMerge: Pause/resume merge failed. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,hc,Qc)},null,void 0,void 0,void 0,void 0,uc.a("14"))}OJb(Ua){this.ua.addHandler("OnExitSlideshow",Ua)}TCb(Ua){this.ua.removeHandler("OnExitSlideshow",Ua)}$9b(Ua){this.ua.addHandler("OnPositionChangeEventId",
Ua)}OUc(Ua){this.ua.removeHandler("OnPositionChangeEventId",Ua)}mqm(Ua){this.VGe||(this.VGe=Ua,W.a.addHandler(window.document.body,"keydown",this.VGe))}Uok(){this.VGe&&(W.a.removeHandler(window.document.body,"keydown",this.VGe),this.VGe=null)}Dxg(){if(this.dN.A0a)B.a.J(512495770,830,50,"SlideshowManager.OnFullscreenChangeHandler still in full screen");else{this.Ojl();this.vd.cpk(Object(A.a)(this,this.KQc,"onVisibilityChangeHandler"));B.a.J(512495769,830,50,"SlideshowManager.OnFullscreenChangeHandler: Leaving full screen mode.");
var Ua=h.AFrameworkApplication.ga.La(h.AFrameworkApplication.QI);Ua=!!Ua&&"teams"===Ua.toLowerCase();var Nb=!this.CHj&&!this.Enh&&document.hasFocus()&&!Ua;B.a.J(507773723,830,50,"SlideshowManager.OnFullscreenChangeHandler: shouldExitSlideShowWhenExitFullscreen: {0}, m_fUserInitiatedFullscreenChange: {1}, isUIHostTeams: {2}, document.hasFocus(): {3} ",Nb,this.Enh,Ua,document.hasFocus());Nb&&(B.a.J(512495768,830,15,"SlideshowManager.OnFullscreenChangeHandler: Exiting SlideshowFrame"),this.pBb.execute(hc=>
{hc.remove()}),B.a.J(507773722,830,50,"SlideshowManager.OnFullscreenChangeHandler: Toolbar Remove invoked"),this.vd.exit(),B.a.J(507773721,830,50,"SlideshowManager.OnFullscreenChangeHandler: Frame exit invoked"));this.CHj=!1}this.Enh=!1}Ybe(Ua,Nb){Nb&&this.E1f!==Nb.slideIndex&&(this.E1f=Nb.slideIndex,this.jKc.L1l(Nb))}Y0b(Ua,Nb){var hc,Qc;B.a.J(512495767,830,15,"SlideshowManager.OnExitHandler Exiting SlideShow.");this.ekl();var $c=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget",
"application_AssertiveNotifier"];for(var Hd of $c)($c=document.getElementById(Hd))&&Sys.UI.DomElement.removeCssClass($c,"SlideShowAXItemNavigationFocusTrap");this.ZZf="";this.SEa&&this.SEa.rne(!1);this.Gqh&&this.Gqh.rne(!1);this.qf&&this.qf.bIn();this.vd.TCb(Object(A.a)(this,this.Y0b,"onExitHandler"));this.vd.SYl(Object(A.a)(this,this.zPc,"onFullscreenClickHandler"));this.vd.suh(Object(A.a)(this,this.LRl,"onSlideshowReadyHandler"));this.vd.PYl(Object(A.a)(this,this.HIe,"onErrorHandler"));this.vd.tuh(Object(A.a)(this,
this.gcd,"onSpecialKeyHandler"));this.vd.cpk(Object(A.a)(this,this.KQc,"onVisibilityChangeHandler"));this.vd.Yok(Object(A.a)(this,this.XQl,"onPodSessionExpiredHandler"));this.vd.$Yl(Object(A.a)(this,this.GQl,"onLogEndOfTranscriptionSessionHandler"));this.vd.YYl(Object(A.a)(this,this.DQl,"onLiveSubtitlesDockedViewHandler"));this.vd.pZl(Object(A.a)(this,this.pXl,"recordQosErrorHandler"));this.Uok(Object(A.a)(this,this.Orh,"onKeydownHandler"));(Hd=document.getElementById("startingSlideshowHiddenDiv"))&&
Hd.parentNode.removeChild(Hd);this.la.KXa||(this.oR.PUc(Object(A.a)(this,this.$ab,"onPodSessionRefreshed")),this.oR.fpk(Object(A.a)(this,this.Vrh,"onPodSessionRefreshedFromBrowser")));this.la.DKk&&(vb.a.jcb(!0),this.dN.A0a||bc.a.Lbb(h.AFrameworkApplication.isRtl));this.Ojl();F.exitFullscreen();this.kz.style.top=this.cHl;this.la.V0a&&(this.kz.style.width=this.dHl,this.kz.style.height=this.bHl);this.lr.ls();this.ua.raiseEvent("OnExitSlideshow",Nb,Ua);this.Ud&&this.Ud.instance&&this.Ud.instance.nsn();
this.uG&&this.uG.e1a&&Nb.summary&&this.ia.Qa(va.a.Eec,2,Nb.summary);h.AFrameworkApplication.ga.getBooleanAppSetting("PptPresenterViewEnabled")&&this.jKc&&this.jKc.zBb&&this.ia.Cb(va.a.O5c,2,null);this.uG&&(this.uG.e1a=!1);this.la.nBa&&this.Su&&this.Su.instance&&this.Su.instance.remove();this.la.tX&&(null===(Qc=null===(hc=this.d_b)||void 0===hc?void 0:hc.instance)||void 0===Qc?void 0:Qc.remove());this.la.nBa&&this.Xph&&this.Xph.remove();this.kVn()}kVn(){h.AFrameworkApplication.ga.getBooleanAppSetting(vc.a.Tsh)&&
l.a.instance.Na("Common.ISystemInitiatedFeedback").execute(Ua=>{window.setTimeout(()=>{B.a.J(512495766,830,15,"SlideshowManager.Trigger NPS after slideshow");Ua.logActivity("AppUsageTimeSatisfiedNPS",null)},1E3)})}zPc(){this.Enh=!0;this.dN.A0a?F.exitFullscreen():this.TEl()}TEl(){let Ua=this.kz;this.la.tX&&(Ua=document.documentElement);Ua&&this.dN.NEe&&(this.dN.OZa&&!this.Qca&&(this.Qca=Object(A.a)(this,this.Dxg,"onFullscreenChangeHandler"),$addHandler(Ua,this.dN.OZa,this.Qca)),this.dN.requestFullscreen(Ua),
this.vd.gfl(Object(A.a)(this,this.KQc,"onVisibilityChangeHandler")))}LRl(){this.ekl();var Ua=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var Nb of Ua)(Ua=document.getElementById(Nb))&&Sys.UI.DomElement.addCssClass(Ua,"SlideShowAXItemNavigationFocusTrap");if(-1===this.Yph)B.a.J(508924039,830,10,"SlideshowManager.onSlideshowReadyHandler returning early since slideshowStartTimeMs is -1");else{Nb=Date.now();B.a.J(23098073,830,15,
"SlideshowManager.slideshow ready in {0} ms",Nb-this.Yph);Ua={};Ua.SlideshowClickTimeMs=this.bpg;Ua.SlideshowStartTimeMs=this.Yph;Ua.SlideshowStartFlushTimeMs=this.XOj;Ua.SlideshowFinishFlushTimeMs=this.WOj;Ua.SlideShowFinishedTimeMs=Nb;Ua.NoBlockingOutBoundSetting=this.la.wnj;Ua.NoBlockingOutBound=!this.zIl;B.a.J(512495765,830,15,"SlideshowManager.onSlideshowReadyHandler"+JSON.stringify(Ua));this.pBb.execute(()=>{this.la.dTf&&this.vd.xCe()});!this.la.Rh||!this.la.Mak&&this.la.dTf||this.mbn.init(this.qf,
this.uG);Nb=!!this.Ud&&!!this.Ud.instance&&this.Ud.instance.XM&&this.Ud.instance.oac;Ua=!!this.Ud&&!!this.Ud.instance&&(this.Ud.instance.Rtc||this.Ud.instance.PK);if((this.la.aBb||this.la.HVf)&&this.qf&&this.uG&&this.Ub&&(this.qf.Ks||this.uG.e1a||Nb||Ua)&&this.qf.frl){const hc=Date.now();let Qc=2;h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.Cx&&(Qc=1);const $c=this.qf.Ks;Nb||Ua?(this.qf.Ks||(Qc=5),this.Ud.instance.Wzb=!this.qf.Ks,this.qf.Ks=!0):this.Ud&&this.Ud.instance&&(this.Ud.instance.Wzb=
!1);this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,Qc,hc,this.uG);this.qf.Ks=$c}Nb&&(this.Ud.instance.oac=!1);this.Uok(Object(A.a)(this,this.Orh,"onKeydownHandler"));this.vd.qwb(!1)}}Orh(Ua){27===Ua.keyCode&&(B.a.J(512495764,830,50,"SlideshowManager.OnKeydownHandler: Esc"),this.Uok(Object(A.a)(this,this.Orh,"onKeydownHandler")),this.pBb.execute(Nb=>{Nb.remove()}),B.a.J(507773720,830,50,"SlideshowManager.OnKeydownHandler: Esc Toolbar remove invoked."),
this.vd.exit(),B.a.J(507773719,830,50,"SlideshowManager.OnKeydownHandler: Esc Frame exit invoked."))}GQl(Ua,Nb){Ua={};try{const hc=n.a.LQ(Nb.q2);for(const Qc of hc)try{Ua[Qc]=Nb.q2[Qc]}catch($c){B.a.J(512495763,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when adding transcription session telemetry value for key: {0}, exception: {1}",Qc,$c)}}catch(hc){B.a.J(512495762,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when logging transcription telemetry. Exception: {0}",
hc)}B.a.J(512495761,830,15,"SlideshowManager.onLogEndOfTranscriptionSessionHandler"+JSON.stringify(Ua));try{!(this.uG&&this.uG.e1a||!this.la.mVl||this.IIl)&&Ua.WebSocketConnectionDurationMS&&6E4<parseInt(Ua.WebSocketConnectionDurationMS.toString())&&(B.a.J(512495760,830,50,"SlideshowManager.Floodgate survey triggered for transcription."),this.IIl=!0,this.ucc.continueWith(()=>{this.ucc.result.logActivity("TranscriptionUsed","PPTTranscriptionFloodgateSurveyEnabled")}))}catch(hc){B.a.J(512495759,830,
10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when trying to trigger floodgate survey. Exception: {0}",hc)}}DQl(Ua,Nb){this.la.dTf||((Ua=document.getElementById("slideshow-toolbar"))?Nb.g4n?"BelowSlide"===Nb.z2?(Ua.style.bottom="15%",Ua.style.left="8%"):"AboveSlide"===Nb.z2?(Ua.style.bottom="6px",Ua.style.left="8%"):(Ua.style.left="0%",Ua.style.bottom="6px",Ua.style.top="auto"):(Ua.style.left="0%",Ua.style.bottom="6px",Ua.style.top="auto"):B.a.J(512495758,830,10,"SlideshowManager.OnLiveSubtitlesDockedViewHandler: Can't find pptViewerAnchor-Met or slideshow-toolbar"))}XQl(Ua,
Nb){B.a.J(512495757,830,15,"SlideshowManager.OnPodSessionExpiredHandler ErrorCode: {0}, Reason: {1}, request PodSessionId: {2}",Nb.code,Nb.reason,Nb.podSessionId);if(Nb.podSessionId!==this.nb.podSessionId)B.a.J(512495756,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Failing request PODS ID and m_sessionInfoOwner PODS ID do not match, so will return. m_sessionInfoOwner has a newer PODS ID: {0}, and this failing request is coming from an old PODS ID: {1}.",this.nb.podSessionId,Nb.podSessionId);
else{if((Ua=this.la.zNe)&&0<Ua.length&&Ua[0]){var hc=new Date(this.fKl.getTime()+1E3*this.la.ANe);const Qc=new Date,$c=Qc>hc;B.a.J(512495755,830,15,"SlideshowManager.OnPodSessionExpiredHandler: currentTime: {0} time after which rehydration is allowed: {1} canTriggerRehydration: {2}",Qc,hc,$c);if($c)for(hc=0;hc<Ua.length;hc++){if(Ua[hc]===Nb.code.toString()&&(B.a.J(512495754,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Error from Slideshow: {0}",Nb.code),this.ee.Zr(Object.assign(new yb.a,{Code:223,
Source:4}),Nb.podSessionId),0<this.BRj)){B.a.J(512495753,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Triggered rehydration and will wait for {0} ms before calling the timeout handler.",this.BRj);this.fKl=new Date;this.bKl=Nb.podSessionId;this.Aqh=window.setTimeout(Object(A.a)(this,this.cFn,"rehydrationTimeout"),this.BRj);return}}else if(this.bKl===Nb.podSessionId){B.a.J(512495752,830,15,"SlideshowManager.OnPodSessionExpiredHandler: A request to rehydrate the session based on the pod session id: {0} has already been sent. Wait for rehydration to complete.",
Nb.podSessionId);return}}h.AFrameworkApplication.Xs(V.a.wi(359));U.Health.instance.recordQosError("SlideShowPodSessionExpiredFailure",["SlideShowACE"],!1,!1,!0,!1,null);this.la.Dde&&(B.a.J(512495751,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Will exit slideshow. Error from Slideshow: {0}",Nb.code),this.pBb.execute(Qc=>{Qc.remove()}),this.vd.exit())}}HIe(Ua,Nb){Ua=String.format("Category: {0}, Code: {1}, SessionId: {2}, CorrelationId: {3}, Message: {4}, ExtraInfo: {5}, IsApiError: {6}",Nb.category,
Nb.code,Nb.sessionId,Nb.correlationId,Nb.message,Nb.XC,Nb.e4n.toString());B.a.J(512495750,830,10,"SlideshowManager.OnErrorHandler: Error from Slideshow: {0}",Ua);h.AFrameworkApplication.Xs(V.a.wi(359));U.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!0,!0,!0,null);this.la.Dde&&(B.a.J(512495749,830,10,"SlideshowManager.OnErrorHandler: Will exit slideshow. Error from Slideshow: {0}",Nb.code),this.pBb.execute(hc=>{hc.remove()}),this.vd.exit())}Ojl(){let Ua=this.kz;this.la.tX&&
(Ua=document.documentElement);Ua&&this.Qca&&(B.a.J(512495748,830,50,"SlideshowManager.CleanupFullscreenChangeHandler"),$removeHandler(Ua,this.dN.OZa,this.Qca),this.Qca=null)}xsn(){B.a.J(512495747,830,15,"SlideshowManager.OnStartSlideshowTimeoutHandler");h.AFrameworkApplication.Xs(V.a.wi(360));U.Health.instance.recordQosError("SlideShowTimeout",["SlideShowACE"],!1,!0,!0,!0,null);this.pBb.execute(Ua=>{Ua.remove()});B.a.J(507773718,830,50,"SlideshowManager.OnStartSlideshowTimeoutHandler: Toolbar remove invoked");
this.vd.exit();B.a.J(507773717,830,50,"SlideshowManager.OnStartSlideshowTimeoutHandler: Frame exit invoked")}cFn(){B.a.J(512495746,830,15,"SlideshowManager.RehydrationTimeout");h.AFrameworkApplication.Xs(V.a.wi(371));U.Health.instance.recordQosError("SlideShowWaitForRehydrationTimedOut",["SlideShowACE"],!1,!0,!0,!0,null);this.pBb.execute(Ua=>{Ua.remove()});this.vd.exit()}pXl(Ua,Nb){U.Health.instance.recordQosError(Nb.errorName,[Nb.vetoName],Nb.isIntentional,Nb.isInternal,Nb.alertOnPillar,Nb.isSessionEndingError,
0<Nb.durationMs?{durationMs:Nb.durationMs}:null)}$ab(Ua,Nb){B.a.J(512495745,830,15,"SlideshowManager.OnPodSessionRefreshed: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.KXa);this.v1d=!1;this.gkl();B.a.J(512495715,830,15,"SlideshowManager.OnPodSessionRefreshed: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",Nb.Wha,this.nb.rp);this.vd.YIg(Nb.Wha,this.nb.rp)}Vrh(Ua,Nb){B.a.J(512495714,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.KXa);this.v1d=!1;this.gkl();B.a.J(512495712,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",Nb.Wha,this.nb.rp);this.vd.YIg(Nb.Wha,this.nb.rp)}Oq(){this.v1d=!1;B.a.J(512495711,830,15,"SlideshowManager.OnSessionRehydrated: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.KXa)}JI(){this.v1d=!0;B.a.J(512495710,830,15,"SlideshowManager.OnSessionEnd: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.KXa)}Wbd(){this.v1d=!0;B.a.J(512495709,830,15,"SlideshowManager.OnPodSessionUnavailable: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.KXa)}ekl(){-1!==this.bqh&&(window.clearTimeout(this.bqh),this.bqh=-1)}gkl(){-1!==this.Aqh&&(window.clearTimeout(this.Aqh),this.Aqh=-1)}}Object(e.a)(wc,"SlideshowManager",null,[722]);var ub=a(135);class aa{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee){this.hcc=this.Y5f=this.M7d=this.yGe=this.pZd=this.X$c=this.jHe=
this.vHe=this.uG=this.qf=this.We=null;this.s6f=0;this.hta=!1;this.Qca=null;this.vd=hc;this.rf=Qc;this.wRj=$c;this.Gf=$d;this.lA=ue;this.nb=cf;this.dN=Ee;this.ia=Ua;this.Aa=Nb;this.kJj=null;this.Gfg=Fe;this.Ud=Hd}init(Ua,Nb){this.We=document.createElement("div");this.We.id="slideshow-toolbar";this.We.className="SlideshowToolbar";this.Gf.appendChild(this.We);this.qf=Ua;this.uG=Nb;this.lA()?(this.vHe=this.L$b("buttonPrevSlide","navigationButton navigationButtonRtl","SlideShowNextServer",ResourceStrings.L_Next),
this.jHe=this.L$b("buttonNextSlide","navigationButton navigationButtonRtl","SlideShowPrevServer",ResourceStrings.L_Previous)):(this.vHe=this.L$b("buttonPrevSlide","navigationButton navigationButtonLtr","SlideShowPrevServer",ResourceStrings.L_Previous),this.jHe=this.L$b("buttonNextSlide","navigationButton navigationButtonLtr","SlideShowNextServer",ResourceStrings.L_Next));this.We.appendChild(this.vHe);this.We.appendChild(this.jHe);W.a.addHandler(this.vHe,L.a.click,Object(A.a)(this,this.LIe,"onPrevClickHandler"));
W.a.addHandler(this.jHe,L.a.click,Object(A.a)(this,this.KIe,"onNextClickHandler"));this.Y5f=this.L$b("buttonEnterGridView","navigationButton navigationButtonLtr","GridView",ResourceStrings.L_GridView_SeeAllSlides);this.We.appendChild(this.Y5f);W.a.addHandler(this.Y5f,L.a.click,Object(A.a)(this,this.JIe,"onGridViewClickHandler"));this.pZd=this.X$c=null;this.dN.cjl&&(this.X$c=this.L$b("buttonEnterFullscreen","navigationButton navigationButtonLtr","SlideShowFullscreen",ResourceStrings.L_EnterFullscreen),
this.pZd=this.L$b("buttonExitFullscreen","navigationButton navigationButtonLtr","SlideShowBackToWindow",ResourceStrings.L_ExitFullscreen),Ua=this.dN.A0a,this.X$c.style.display=Ua?Pa.a.Sf:Pa.a.Wm,this.pZd.style.display=Ua?Pa.a.Wm:Pa.a.Sf,this.We.appendChild(this.X$c),this.We.appendChild(this.pZd),W.a.addHandler(this.X$c,L.a.click,Object(A.a)(this,this.zPc,"onFullscreenClickHandler")),W.a.addHandler(this.pZd,L.a.click,Object(A.a)(this,this.zPc,"onFullscreenClickHandler")),this.dN.OZa&&!this.Qca&&(this.Qca=
Object(A.a)(this,this.Dxg,"onFullscreenChangeHandler"),$addHandler(this.Gf,this.dN.OZa,this.Qca)));this.M7d=null;this.qf.Tvf&&!this.uG.e1a&&(this.M7d=this.L$b("buttonSubtitle","navigationButton navigationButtonLtr","SubtitleSlideShowToggleOff",ResourceStrings.L_UseSubtitles),this.We.appendChild(this.M7d),W.a.addHandler(this.M7d,L.a.click,Object(A.a)(this,this.csh,"onTranscribeHandler")));this.yGe=this.L$b("buttonExitSlideShow","navigationButton navigationButtonLtr","ExitSlideShowServer",ResourceStrings.L_EndShow);
this.We.appendChild(this.yGe);W.a.addHandler(this.yGe,L.a.click,Object(A.a)(this,this.IIe,"onExitClickHandler"));this.hcc=null;this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&!this.uG.e1a&&(this.Ud.instance.Vel(Object(A.a)(this,this.Zxg,"onLiveSessionStarted")),this.Ud.instance.Uel(Object(A.a)(this,this.Yxg,"onLiveSessionEnded")),this.Ud.instance.gqm(Object(A.a)(this,this.AQl,"onLiveCalloutDismissed")),this.Ud.instance.Rel(Object(A.a)(this,this.Xxg,"onLiveRelaunchPausedSession")),this.Ud.instance.gEd?
this.Dml():this.Ud.instance.yqm(Object(A.a)(this,this.CQl,"onLivePresenterResourcesLoaded")));this.hta=!1;this.hide();this.vd.OJb(Object(A.a)(this,this.Y0b,"onExitHandler"));this.vd.T0h(Object(A.a)(this,this.ywg,"onBrowserEventHandler"));W.a.addHandler(this.We,L.a.gv,Object(A.a)(this,this.ybe,"onMouseOverHandler"));W.a.addHandler(this.We,L.a.uy,Object(A.a)(this,this.kyg,"onMouseOutHandler"))}show(){this.We.style.display=Pa.a.Wm;window.clearTimeout(this.s6f);this.s6f=window.setTimeout(Object(A.a)(this,
this.hide,"hide"),3E3);this.vd.qwb(!0)}hide(){this.hta||(window.clearTimeout(this.s6f),this.We.style.display=Pa.a.Sf,this.vd.qwb(!1))}remove(){B.a.J(507773727,830,50,"SlideshowToolbar::Starting Toolbar remove.");this.We&&this.Gf.contains(this.We)&&(this.Gf.removeChild(this.We),this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&(this.Ud.instance.eZl(Object(A.a)(this,this.Zxg,"onLiveSessionStarted")),this.Ud.instance.dZl(Object(A.a)(this,this.Yxg,"onLiveSessionEnded")),this.Ud.instance.$Fn(Object(A.a)(this,
this.AQl,"onLiveCalloutDismissed")),this.Ud.instance.lGn(Object(A.a)(this,this.CQl,"onLivePresenterResourcesLoaded")),this.Ud.instance.bZl(Object(A.a)(this,this.Xxg,"onLiveRelaunchPausedSession"))),this.hta=!1);B.a.J(507773726,830,50,"SlideshowToolbar::Toolbar removed.")}l_(){}setToolbarButtonToggleState(){}Y0b(){this.vd.TCb(Object(A.a)(this,this.Y0b,"onExitHandler"));this.vd.Iok(Object(A.a)(this,this.ywg,"onBrowserEventHandler"));W.a.removeHandler(this.We,L.a.gv,Object(A.a)(this,this.ybe,"onMouseOverHandler"));
W.a.removeHandler(this.We,L.a.uy,Object(A.a)(this,this.kyg,"onMouseOutHandler"));W.a.removeHandler(this.vHe,L.a.click,Object(A.a)(this,this.LIe,"onPrevClickHandler"));W.a.removeHandler(this.jHe,L.a.click,Object(A.a)(this,this.KIe,"onNextClickHandler"));W.a.removeHandler(this.yGe,L.a.click,Object(A.a)(this,this.IIe,"onExitClickHandler"));this.hcc&&W.a.removeHandler(this.hcc,L.a.click,Object(A.a)(this,this.yQl,"onLiveBroadcastHandler"));this.M7d&&W.a.removeHandler(this.M7d,L.a.click,Object(A.a)(this,
this.csh,"onTranscribeHandler"));this.X$c&&(W.a.removeHandler(this.X$c,L.a.click,Object(A.a)(this,this.zPc,"onFullscreenClickHandler")),W.a.removeHandler(this.pZd,L.a.click,Object(A.a)(this,this.zPc,"onFullscreenClickHandler")),$removeHandler(this.Gf,this.dN.OZa,this.Qca),this.Qca=null);this.Y5f&&W.a.removeHandler(this.Y5f,L.a.click,Object(A.a)(this,this.JIe,"onGridViewClickHandler"));this.remove()}ywg(){this.show()}Dxg(){const Ua=this.dN.A0a;this.X$c.style.display=Ua?Pa.a.Sf:Pa.a.Wm;this.pZd.style.display=
Ua?Pa.a.Wm:Pa.a.Sf}ybe(Ua){if(Ua=Ua.target)Ua.className.startsWith("prt2_SubtitleSlideShowToggle")?Ua.className.startsWith("prt2_SubtitleSlideShowToggleOff_40x40x32")&&(Ua.className=Ua.className.replace("Off_40x40x32","Hover_40x40x32")):Ua.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?Ua.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle_40x40x32")&&(Ua.className=Ua.className.replace("_40x40x32","Hover_40x40x32")):Ua.className=Ua.className.replace("_40x40x32","Hvr_40x40x32"),
this.hta=!0}kyg(Ua){if(Ua=Ua.target)Ua.className.startsWith("prt2_SubtitleSlideShowToggle")?!this.qf.Ks&&Ua.className.startsWith("prt2_SubtitleSlideShowToggleHover_40x40x32")&&(Ua.className=Ua.className.replace("Hover_40x40x32","Off_40x40x32")):Ua.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?this.Ud&&!this.Ud.instance.PK&&Ua.className.startsWith("prt2_PresentLiveSlideshowToolbarToggleHover_40x40x32")&&(Ua.className=Ua.className.replace("Hover_40x40x32","_40x40x32")):Ua.className=
Ua.className.replace("Hvr_40x40x32","_40x40x32"),this.WBi()||(this.hta=!1);this.WBi()||this.vd.jda()}LIe(){B.a.J(508692442,830,50,"SlideshowToolbar.OnPrevClickHandler");this.Ffd(this.vHe.title);this.vd.prev();this.vd.jda()}KIe(){B.a.J(508692441,830,50,"SlideshowToolbar.OnNextClickHandler");this.Ffd(this.jHe.title);this.vd.next();this.vd.jda()}IIe(){B.a.J(508692440,830,50,"SlideshowToolbar.OnExitClickHandler");this.Ffd(this.yGe.title);this.vd.exit()}zPc(){B.a.J(508692439,830,50,"SlideshowToolbar.OnFullscreenClickHandler");
this.vd.KRk()}yQl(){this.Ud&&this.Ud.instance&&(this.Ffd(this.hcc.title),B.a.J(508692438,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Ud.instance.PK),this.Ud.instance.PK?this.Ud.instance.showCallout(this.hcc):(this.Ud.instance.tWg(3,h.AFrameworkApplication.userSessionId,this.Gfg,this.nb.podSessionId,h.AFrameworkApplication.ui),this.Ud.instance.Wzb=!this.qf.Ks,this.qf.Tvf&&!this.qf.Ks&&(B.a.J(508692437,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.qf.Ks=
!0,this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,5,Date.now(),this.uG),this.qf.Ks=!1)),this.fYk())}RRk(Ua,Nb){this.Ffd(this.M7d.title);const hc=!!this.Ud&&!!this.Ud.instance&&this.Ud.instance.PK,Qc=this.qf.drl&&5!==Ua&&!hc;5!==Ua&&(this.qf.Ks=!this.qf.Ks);B.a.J(508692436,830,50,"SlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",this.qf.Ks);Nb&&(this.qf.Ks?(Nb.className="prt2_SubtitleSlideShowToggleHover_40x40x32",
Qc&&Oa.REl(this.vd,this.rf,this.nb)):Nb.className="prt2_SubtitleSlideShowToggleOff_40x40x32");Qc||(Nb=Date.now(),hc?this.vd.Kyh(null):this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,Ua,Nb,this.uG))}csh(Ua){this.RRk(3,Ua.target)}JIe(){B.a.J(508692435,830,50,"SlideshowToolbar.OnGridViewClickHandler");this.ia.Qa(va.a.Voe,2,null)}Dml(){this.hcc||(this.hcc=this.L$b("buttonLiveBroadcast","navigationButton navigationButtonLtr","PresentLiveSlideshowToolbarToggle",
ResourceStrings.L_UseLiveBroadcast),this.We.insertBefore(this.hcc,this.yGe),W.a.addHandler(this.hcc,L.a.click,Object(A.a)(this,this.yQl,"onLiveBroadcastHandler")))}L$b(Ua,Nb,hc,Qc){const $c=document.createElement("div");$c.id=Ua;$c.className=Nb;if("buttonSubtitle"===Ua)return Ua=ub.b(40,40,"SubtitleSlideShowToggle"+(this.qf.Ks?"Hover_40x40x32":"Off_40x40x32"),"prt2",this.rf.Yp("prt2.png"),null,null,!0,null),$c.appendChild(Ua),$c.title=Qc,$c;if("buttonLiveBroadcast"===Ua)return Ua=ub.b(40,40,"PresentLiveSlideshowToolbarToggle"+
(this.Ud&&this.Ud.instance&&this.Ud.instance.PK?"Hover_40x40x32":"_40x40x32"),"prt2",this.rf.Yp("prt2.png"),null,null,!0,null),$c.appendChild(Ua),$c.title=Qc,1===Ua.children.length&&(this.kJj=Ua.children[0]),$c;Ua=ub.b(40,40,hc+"_40x40x32","prt2",this.rf.Yp("prt2.png"),null,null,!0,null);$c.appendChild(Ua);$c.title=Qc;return $c}Ffd(Ua){O.a.rb(Ua)?B.a.J(508692434,830,15,"SlideshowToolbar::RaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.wRj.Dhk(new ja(Ua))}WBi(){return!!this.Ud&&
!!this.Ud.instance&&this.Ud.instance.mIm}fYk(){this.Ud&&this.Ud.instance&&this.kJj&&(this.kJj.className="prt2_PresentLiveSlideshowToolbarToggle"+(this.Ud.instance.PK?"Hover_40x40x32":"_40x40x32"))}CQl(){this.Dml()}Zxg(){this.fYk()}Yxg(){this.Ud&&this.Ud.instance&&this.Ud.instance.Wzb&&!this.qf.Ks&&(B.a.J(508692433,830,50,"Stopping subtitle for stopping live session."),this.vd.iRa(h.AFrameworkApplication.userSessionId,this.nb.podSessionId,this.nb.rp,h.AFrameworkApplication.ui,5,Date.now(),this.uG));
this.Ud.instance.Wzb=!1;this.fYk()}Xxg(){this.Ud&&this.Ud.instance&&(this.hta=!0,this.show(),this.Ud.instance.showCallout(this.hcc))}AQl(){this.hta=this.WBi();this.hta||(window.clearTimeout(this.s6f),this.s6f=window.setTimeout(Object(A.a)(this,this.hide,"hide"),3E3))}}Object(e.a)(aa,"SlideshowToolbar",null,[795,796]);var Na=a(180),ia=a(20);class wa{constructor(Ua){this.PGc=this.ota=this.HMc=null;this.rPj="BelowSlide";this.i_d=this.jIl=!1;this.z4f=!0;this.Dnh=-1;this.xIl=this.m4f=this.CEj=!1;this.MMj=
this.vPj=this.xPj=this.wPj=null;this.la=Ua;h.AFrameworkApplication.ga.fg(Object(A.a)(this,this.su,"onFullAppSettingsReady"));Ua=ia.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString());this.LGl=Ua.Ring||"Unknown";this.XGl=h.AFrameworkApplication.buildVersion||"Unknown";this.mKl=this.la.Bsb||"Unknown";this.PMl=Ua.Host||"Unknown";this.OMl=Ua.WACDatacenter||"Unknown";this.iMl=this.UNm();this.Mqg=this.WNm();this.GMl=this.AIf();this.CGe=wa.u_k;switch(this.la.R7l){case "ByUIHostName":Ua=
h.AFrameworkApplication.ga.La(h.AFrameworkApplication.QI);this.i_d=!(!Ua||"teams"!==Ua.toLowerCase());break;case "ByAppIsEmmbeded":this.i_d=h.AFrameworkApplication.h8;break;default:this.i_d=h.AFrameworkApplication.ga.getBooleanAppSetting("IsUIEmbedMode")}B.a.J(508692370,822,50,"Initialized SubtitleContext with cookie: {0}, default position:{1}",this.CGe,this.rPj)}su(){this.HMc=this.getUserId();this.ota=h.AFrameworkApplication.ga.La("TenantId");this.PGc=this.la.hostAuthType||h.AFrameworkApplication.ga.La("HostAuthType")||
"Unknown"}getUserId(){let Ua=h.AFrameworkApplication.ga.La("PptEditingUserId");O.a.rb(Ua)&&(Ua=h.AFrameworkApplication.ga.La("LoggableUserId"),B.a.J(508692369,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",O.a.rb(Ua)));return Ua}get KBe(){return this.jIl}set KBe(Ua){B.a.J(508692368,830,50,"SubtitleContext: Update FEnabledInBaseDoc to {0}",Ua);this.jIl=Ua}get Ks(){return this.la.aBb&&this.KBe&&this.CGe&&!this.i_d}set Ks(Ua){this.CGe!==Ua&&(this.CGe=Ua,wa.u_k=this.CGe)}get Pvf(){return this.la.aBb&&
this.m4f}set Pvf(Ua){this.m4f!==Ua&&(this.m4f=Ua)}get orl(){return this.xIl}get frl(){return!this.i_d}get PBe(){return this.CEj}set PBe(Ua){this.CEj!==Ua&&(this.CEj=Ua)}get Tvf(){return this.la.aBb&&this.KBe&&this.la.cEl&&!this.i_d}get drl(){const Ua=P.a.get("PPTLiveSubtitleEnabled");return this.la.aBb&&this.la.eEl&&O.a.rb(Ua)&&!this.i_d}get lyh(){if(!this.vPj){const Nb=new z.a;var Ua=this.la.K$j;if(!O.a.rb(Ua)){Ua=Ua.split(",");for(const hc of Ua)hc.endsWith("*")||Nb.add(hc)}this.vPj=wa.igl(Nb)}return this.vPj}get kyh(){if(!this.MMj){const Nb=
new z.a;var Ua=this.la.K$j;if(!O.a.rb(Ua)){Ua=Ua.split(",");for(const hc of Ua)hc.endsWith("*")&&Nb.add(hc.replace("*"," ").trim())}this.MMj=wa.igl(Nb)}return this.MMj}get QNe(){this.wPj||(this.wPj=O.a.rb(this.la.L$j)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(this.la.L$j,!0));return this.wPj}get Lxh(){this.xPj||(this.xPj=wa.Orm(this.QNe));return this.xPj}iJn(){this.Dnh=this.CGe?1:0}bIn(){-1!==this.Dnh&&(this.Ks=1===this.Dnh?!0:!1,this.Dnh=-1)}UNm(){try{const Ua=Na.a.Ne(h.AFrameworkApplication.lcid);
if(!Ua)return B.a.J(508692367,822,15,"SubtitleContext::GetDefaultSpeechLanguage Getting the culture info returned null. Language lcid: {0}: ",h.AFrameworkApplication.lcid),"en-us";const Nb=Ua.name.toLowerCase();for(const hc of this.lyh)if(0<=hc.toLowerCase().indexOf(Nb.toLowerCase()))return Nb;for(const hc of this.kyh)if(0<=hc.toLowerCase().indexOf(Nb.toLowerCase()))return Nb;this.m4f=!0;return"en-us"}catch(Ua){B.a.J(508692366,822,10,"SubtitleContext::GetDefaultSpeechLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",
h.AFrameworkApplication.lcid,Ua)}this.m4f=!0;return"en-us"}WNm(){try{const Ua=Na.a.Ne(h.AFrameworkApplication.lcid);if(!Ua||O.a.rb(Ua.name))return B.a.J(508692365,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the culture info or culture info name returned null. Language lcid: {0}: ",h.AFrameworkApplication.lcid),"en";const Nb=Ua.name.toLowerCase();if(!O.a.rb(Nb)&&this.QNe[Nb])return Nb;const hc=Na.a.Ne(Ua.languageId);if(!hc||O.a.rb(hc.name))return B.a.J(508692364,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the two-letter culture info returned null. Language lcid: {0}: ",
h.AFrameworkApplication.lcid),"en";let Qc=hc.name.toLowerCase();this.QNe[Qc]||(B.a.J(508692363,822,15,"SubtitleContext::GetDefaultTranslationLanguage No matching default language was found for the user's locale. Will default to English. User's culture info name: {0} User's culture info two letter name: {1} Language lcid: {2}: ",Nb,Qc,h.AFrameworkApplication.lcid),Qc="en");return Qc}catch(Ua){B.a.J(508692362,822,10,"SubtitleContext::GetDefaultTranslationLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",
h.AFrameworkApplication.lcid,Ua)}return"en"}AIf(){try{if(O.a.rb(this.Mqg))return B.a.J(508692361,822,10,"SubtitleContext::GetValueForTranslationLanguage m_translationLanguages is null. Language lcid: {0}",h.AFrameworkApplication.lcid),"en-us";const Ua=this.QNe[this.Mqg.toLowerCase()];if(!O.a.rb(Ua))return Ua}catch(Ua){B.a.J(508692360,822,10,"SubtitleContext::GetValueForTranslationLanguage Exception thrown when trying to get the value for key: {0} language lcid: {1}, exception: {2}.",this.Mqg,h.AFrameworkApplication.lcid,
Ua)}return"en-us"}KMm(Ua){if(O.a.rb(Ua))return B.a.J(508692359,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var Nb=Ua.split("-");if(!Nb.length)return B.a.J(508692358,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",Ua),null;Nb=Nb[0];const hc=this.QNe;var Qc=this.Lxh;for(const $c of Qc)if(Qc=hc[$c.toLowerCase()],Qc.startsWith(Nb))return Qc;B.a.J(508692357,
822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",Ua);return null}get Ybb(){return this.iMl}set Ybb(Ua){this.iMl=Ua;this.xIl=!0}get userId(){return this.HMc}set userId(Ua){this.HMc=Ua}get locale(){return this.mKl}set locale(Ua){this.mKl=Ua}get audienceGroup(){return this.LGl}set audienceGroup(Ua){this.LGl=Ua}get buildVersion(){return this.XGl}set buildVersion(Ua){this.XGl=Ua}get identityProvider(){return this.PGc}set identityProvider(Ua){this.PGc=
Ua}get wacHost(){return this.PMl}set wacHost(Ua){this.PMl=Ua}get wacDatacenter(){return this.OMl}set wacDatacenter(Ua){this.OMl=Ua}get tenantId(){return this.ota}set tenantId(Ua){this.ota=Ua}get g8a(){return this.Mqg}set g8a(Ua){this.Mqg=Ua}get Sec(){return this.GMl}set Sec(Ua){this.GMl=Ua}get z2(){return this.rPj}set z2(Ua){this.rPj=Ua}get Ttc(){return this.z4f}set Ttc(Ua){this.z4f=Ua}get crl(){return 0<=this.la.iKe.indexOf(this.g8a)}static get u_k(){const Ua=P.a.get("PPTLiveSubtitleEnabled");return Ua?
"true"===Ua.toLowerCase():!1}static set u_k(Ua){P.a.n_("PPTLiveSubtitleEnabled",Ua.toString(),P.a.b_)||B.a.J(508692356,822,10,"Failed to set cookie for use live subtitle to {0}",Ua.toString())}static igl(Ua){const Nb={},hc=new z.a;for(const Qc of Ua)try{const $c=Na.a.Ne(Qc).displayName;hc.add($c);Nb[$c]=Qc}catch($c){B.a.J(508692355,822,10,"SubtitleContext::AlphabetizeSpokenLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",Qc,$c)}hc.Sc((Qc,$c)=>Qc.localeCompare($c));Ua=new z.a;
for(const Qc of hc)Qc&&0<Qc.length&&Ua.add(Nb[Qc]);return Ua}static Orm(Ua){const Nb=n.a.LQ(Ua);Ua={};const hc=new z.a;for(var Qc of Nb)try{const $c=Na.a.Ne(Qc).displayName;O.a.rb($c)?B.a.J(508692354,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Couldn't get display name for language code: {0}, language lcid: {1}.",Qc,h.AFrameworkApplication.lcid):(hc.add($c),Ua[$c]=Qc)}catch($c){B.a.J(508692353,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",
Qc,$c)}hc.Sc(($c,Hd)=>$c.localeCompare(Hd));Qc=new z.a;for(const $c of hc)$c&&0<$c.length&&Qc.add(Ua[$c]);return Qc}}Object(e.a)(wa,"SubtitleContext",null,[715]);var pa=a(695);class Ea{constructor(Ua){this.Np=Ua}Uhl(){return pa.a()}}Object(e.a)(Ea,"WebGLHelperProxy",null,[714]);var La=a(623),Aa=a(1389);class nb{ZQm(Ua){return optionsButton.OptionsButtonManagerFactory.createOptionsButtonManager(Ua)}}Object(e.a)(nb,"OptionsButtonLoader",null,[723]);class Wa{init(){B.a.J(508178882,830,50,"SlideShowCameraNotification.Init");
this.eGe=document.createElement("div");this.eGe.id="cameraNotificationContainerElement";this.eGe.className="cameraNotificationContainer";(this.eo=document.getElementById("slideshowfooterContainerElement"))&&this.eo.insertBefore(this.eGe,this.eo.firstElementChild);this.hHl=cameraUI.CameraActorFactory.CREATE_CAMERA_ACTOR({hostElement:this.eGe})}remove(){var Ua;(null===(Ua=this.eo)||void 0===Ua?0:Ua.contains(this.eGe))&&this.eo.removeChild(this.eGe)}show(Ua,Nb){var hc;null===(hc=this.hHl)||void 0===
hc?void 0:hc.showNotification(Ua,Nb)}hide(){var Ua;null===(Ua=this.hHl)||void 0===Ua?void 0:Ua.hideNotification()}}Object(e.a)(Wa,"SlideShowCameraNotification",null,[724]);var ea=a(139);class Kb{static aql(Ua){Ua.yb("PowerPointWebEditor.ISlideShowCoreHelper")||(Ua.register(763,"PowerPointWebEditor.ISlideShowCoreHelper").ma().na(()=>new Kb(Ua.resolve("PowerPointWebEditor.IApplicationSettings"))),B.a.J(508086165,830,50,"SlideShowCoreHelper - Registered instance in container"))}constructor(Ua){this.tG=
new ea.a;Ua;const Nb={},hc=this.YPf(Nb);this.SGe=pa.a()&&Ua.zCc&&hc&&this.kgj(Ua);this.RGe=this.jgj(Ua);this.pta=!this.SGe&&this.RGe;this.YDc({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:this.SGe||this.RGe,["IsModernWebGLSupportedBrowser"]:this.SGe,["IsModernSupportedBrowser"]:this.RGe,["IsBrowserShapeBuilderCompatible"]:hc,["log"]:Nb,["useSvg"]:this.pta});if(this.SGe||this.RGe)this.GFm(Ua),this.Cwn(Ua)}YDc(Ua){B.a.J(594583632,830,15,"PPTWebEditorSlideShowPackage::logSlideShowSwitcherData "+
JSON.stringify(Ua))}YPf(Ua){return La.a(Ua)}kgj(Ua){const Nb=Ua.La("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";");Ua=JSON.parse(Ua.La("SessionStartInfoJson").toString());B.a.J(512309317,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",Ua.Browser,Ua.BrowserMajorVersion);for(const hc of Nb)if(hc.split(":")[0].toLowerCase()===(Ua.Browser||"").toLowerCase()&&parseInt(Ua.BrowserMajorVersion||"",10)<parseInt(hc.split(":")[1],10))return B.a.J(512309316,
830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Name {0}, Version {1}",Ua.Browser,Ua.BrowserMajorVersion),!1;return!0}jgj(Ua){const Nb=Ua.La("PptModernSlideShowBlockListForBrowserVersion").split(";");Ua=JSON.parse(Ua.La("SessionStartInfoJson").toString());B.a.J(512309315,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",Ua.Browser,Ua.BrowserMajorVersion);for(const hc of Nb)if(hc.split(":")[0].toLowerCase()===(Ua.Browser||"").toLowerCase()&&
parseInt(Ua.BrowserMajorVersion||"",10)<parseInt(hc.split(":")[1],10))return B.a.J(512309314,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Name {0}, Version {1}",Ua.Browser,Ua.BrowserMajorVersion),!1;return!0}GFm(Ua){const Nb={};Nb.loadScriptStart=Date.now();const hc=u.a.create(h.AFrameworkApplication.xh("powerpoint-slideshow-strings",3));m.a.HL(hc);this.DLl=Promise.all([new Promise((Qc,$c)=>{const Hd=document.createElement("script");Hd.async=!1;Hd.src=h.AFrameworkApplication.xh(String.format("slideshowcore{0}.js",
".min"),5);Hd.addEventListener("load",()=>{B.a.J(509636759,830,50,"PPTWebEditorSlideShowPackage::Loaded slideshowcore");Qc(Hd)});Hd.addEventListener("error",()=>{B.a.J(509636758,830,10,"PPTWebEditorSlideShowPackage::Failed to load slideshowcore");$c(Hd)});document.head.appendChild(Hd)}),new Promise((Qc,$c)=>{const Hd=document.createElement("script");Hd.async=!1;Hd.src=h.AFrameworkApplication.xh(String.format("podsproxy{0}.js",".min"),5);Hd.addEventListener("load",()=>{B.a.J(509636757,830,50,"PPTWebEditorSlideShowPackage::Loaded podsproxy");
Qc(Hd)});Hd.addEventListener("error",()=>{B.a.J(509636756,830,10,"PPTWebEditorSlideShowPackage::Failed to load podsproxy");$c(Hd)});document.head.appendChild(Hd)}),new Promise((Qc,$c)=>{const Hd=document.createElement("script");Hd.async=!1;Hd.src=h.AFrameworkApplication.xh(String.format("pptspeechclient{0}.js",".min"),5);Hd.addEventListener("load",()=>{B.a.J(509636755,830,50,"PPTWebEditorSlideShowPackage::Loaded pptspeechclient");Qc(Hd)});Hd.addEventListener("error",()=>{B.a.J(509636754,830,10,"PPTWebEditorSlideShowPackage::Failed to load pptspeechclient");
$c(Hd)});document.head.appendChild(Hd)})]).then(()=>{Nb.loadScriptEnd=Date.now();const Qc={Type:"LoadedJS"};n.a.forEach(Nb,($c,Hd)=>{Qc[$c]=Hd},null);this.YDc(Qc);this.YXc();this.w6b(Ua);SlideShowCore.SlideShowCore.preloadShaders()}).catch(Qc=>{this.YDc({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});B.a.J(512309318,830,10,"PPTWebEditorSlideShowPackage::LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",Qc)})}Cwn(Ua){try{const Nb=JSON.parse(Ua.La("Settings"))||
{};Nb.slideshowcore||(Nb.slideshowcore={});Nb.slideshowcore.forceSvg&&"true"===Nb.slideshowcore.forceSvg.toString().toLowerCase()?this.pta=!0:this.pta&&(Nb.slideshowcore.forceSvg="True");Nb.slideshowcore.enableCameoInPPTOSlideShow=Ua.tX.toString();this.Ex=Nb}catch(Nb){B.a.J(508086164,830,10,"SlideShowCoreHelper - Exception in parsing settings:{0}",Nb),this.Ex={}}}w6b(Ua){try{const Nb=this.Ex;if(Nb.slideshowcore){const hc={};hc.settings=Nb;hc.logger=this.tG;hc.disabledChangeGates=Ua.La("PPTDisabledChangeGates");
window.SlideShowCore.setupGlobals_SlideShowCore(hc)}}catch(Nb){B.a.J(508086163,830,10,"SlideShowCoreHelper - Exception in passing settings to slideshowcore:{0}",Nb)}}YXc(){try{const Ua=this.Ex;if(Ua.podsproxy){const Nb={};Nb.settings=Ua;window.PodsProxy.setupGlobals_PodsProxy(Nb)}}catch(Ua){B.a.J(508086162,830,10,"SlideShowCoreHelper - Exception in passing settings to podsproxy:{0}",Ua)}}getSettings(){return this.Ex}}Object(e.a)(Kb,"SlideShowCoreHelper",null,[763]);var kc=a(1580);class ac{constructor(Ua,
Nb){this.convert=kc.a;if(!Ua)throw Error.argumentNull("presReader");this.Ub=Ua;this.Zad=Nb;this.J3=this.Ub.lB()}w5m(){const Ua=this.Ub.lB();if(Ua.height==this.J3.height&&Ua.width==this.J3.width)return!0;this.wYn(Ua);return!1}wYn(Ua){this.J3.width=Ua.width;this.J3.height=Ua.height}$vl(Ua){const Nb=this.DJ(),hc=this.qPm();var Qc=this.w5m();const $c=Qc?Ua.SlideEmuWidth:this.BMm();Qc=Qc?Ua.SlideEmuHeight:this.CMm();if(Nb&&hc)return{SlideOrder:Nb,HiddenSlideOrder:hc,SlideEmuHeight:$c,SlideEmuWidth:Qc,
ViewScalingFactor:Ua.ViewScalingFactor,SlideShowProperties:Ua.SlideShowProperties,Sections:Ua.Sections}}BMm(){var Ua=this.Ub.l_a();Ua=this.Zad.XGf(Ua);return this.convert.XY(Ua.width,0)}CMm(){var Ua=this.Ub.l_a();Ua=this.Zad.XGf(Ua);return kc.a.XY(Ua.height,1)}DJ(){return this.Ub.DJ().map(Ua=>({sid:Ua.sid,cid:0}))}qPm(){return this.Ub.DJ().filter(Ua=>{var Nb;return null===(Nb=this.Ub.XZ(Ua.sid))||void 0===Nb?void 0:Nb.ol}).map(Ua=>({sid:Ua.sid,cid:0}))}}Object(e.a)(ac,"PresInfoClient",null,[]);var eb=
a(700),Hb=a(481),ua=a(435),Va=a(681),Yb=a(366),Cb=a(134),ca=a(329),Ra=a(249),bb=a(317),wb=a(389);class Fa{constructor(Ua,Nb,hc,Qc){this.$Oj="BottomOverlaid";this.ia=Ua;this.qf=Qc;this.oc=Nb;this.Ad=hc;this.aPj="productionSpokenLanguages_"+this.qf.Ybb;this.bPj="productionSubtitleLanguages_"+this.qf.g8a}Hb(){B.a.J(512500167,822,50,"SubtitleActor::RegisterActions - OptIn: True, FUseSubtitles:{0}",this.qf.Ks);this.ia.sa(va.a.wbb,gb.a.application,Object(A.a)(this,this.wbb,"querySubtitleIsEnabled"),96);
this.ia.za(va.a.hcb,gb.a.application,Object(A.a)(this,this.hcb,"toggleUseSubtitles"));this.ia.sa(va.a.gdd,gb.a.application,Object(A.a)(this,this.TBn,"querySubtitleSettingsIsEnabled"),96);this.ia.sa(va.a.oCb,gb.a.application,Object(A.a)(this,this.oCb,"populateTranscriptionSubtitleLanguage"),96);this.ia.sa(va.a.nCb,gb.a.application,Object(A.a)(this,this.nCb,"populateTranscriptionSpokenLanguage"),96);this.ia.za(va.a.K7l,gb.a.application,Object(A.a)(this,this.MXm,"handleToggleTranscriptionSpokenLanguage"));
this.ia.za(va.a.L7l,gb.a.application,Object(A.a)(this,this.NXm,"handleToggleTranscriptionSubtitleLanguage"));this.ia.sa(va.a.Ath,gb.a.application,Object(A.a)(this,this.Ath,"queryToggleTranscriptionSpokenLanguage"),96);this.ia.sa(va.a.Bth,gb.a.application,Object(A.a)(this,this.Bth,"queryToggleTranscriptionSubtitleLanguage"),96);this.ia.sa(va.a.GCb,gb.a.application,Object(A.a)(this,this.GCb,"querySubtitlesBottomOverlay"),96);this.ia.za(va.a.Oec,gb.a.application,Object(A.a)(this,this.Oec,"toggleSubtitlesBottomOverlay"));
this.ia.sa(va.a.HCb,gb.a.application,Object(A.a)(this,this.HCb,"querySubtitlesTopOverlay"),96);this.ia.za(va.a.Pec,gb.a.application,Object(A.a)(this,this.Pec,"toggleSubtitlesTopOverlay"));this.ia.sa(va.a.FCb,gb.a.application,Object(A.a)(this,this.FCb,"querySubtitlesBelowSlide"),96);this.ia.za(va.a.Nec,gb.a.application,Object(A.a)(this,this.Nec,"toggleSubtitlesBelowSlide"));this.ia.sa(va.a.ECb,gb.a.application,Object(A.a)(this,this.ECb,"querySubtitlesAboveSlide"),96);this.ia.za(va.a.Mec,gb.a.application,
Object(A.a)(this,this.Mec,"toggleSubtitlesAboveSlide"))}ve(){}wbb(Ua,Nb,hc,Qc,$c){if(!$c||!Object(Cb.a)(bb.a,$c))return 8;$c.xg(this.qf.Ks);return 32}TBn(Ua,Nb,hc,Qc,$c){return 1===hc?this.oc.hl()?32:8:$c&&"object"===typeof $c?this.qf&&this.qf.KBe?32:(B.a.J(512500164,822,10,"QuerySubtitleSettingsIsEnabled requires valid subtitleContext"),8):(B.a.J(512500165,822,10,"QuerySubtitleSettingsIsEnabled requires actionData"),8)}GCb(Ua,Nb,hc,Qc,$c){if(!$c||!Object(Cb.a)(bb.a,$c))return B.a.J(512500163,822,
10,"SubtitleActor::QuerySubtitlesBottomOverlay requires actionData"),8;$c.xg("BottomOverlay"===this.qf.z2);B.a.J(512500162,822,50,"SubtitleActor::QuerySubtitlesBottomOverlay: subtitles position is {0}",this.qf.z2);return 32}HCb(Ua,Nb,hc,Qc,$c){if(!$c||!Object(Cb.a)(bb.a,$c))return 8;$c.xg("TopOverlay"===this.qf.z2);B.a.J(512500160,822,50,"SubtitleActor::QuerySubtitlesTopOverlay: subtitles position is {0}",this.qf.z2);return 32}FCb(Ua,Nb,hc,Qc,$c){try{$c&&$c.xg("BelowSlide"===this.qf.z2)}catch(Hd){B.a.J(512500131,
822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",Hd)}return 32}ECb(Ua,Nb,hc,Qc,$c){try{$c&&$c.xg("AboveSlide"===this.qf.z2)}catch(Hd){B.a.J(512500130,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",Hd)}return 32}hcb(Ua,Nb,hc,Qc,$c){if(1===hc)return this.oc.hl()?32:8;if(!$c||"object"!==typeof $c)return 8;this.qf.Ks&&(P.a.n_("PPTCaptionDiscoverabiltyDoNotShowAgain","true",P.a.b_)||B.a.J(512500128,822,10,"SubtitleActor::ToggleUseSubtitles - Failed to set cookie for discoverability opt out to true"));
this.qf.Ks=!this.qf.Ks;B.a.J(512500127,822,50,"SubtitleActor::HandleToggleUseSubtitles: Changed UseSubtitles status to:{0}",this.qf.Ks);Ra.App.Vb.nD({AlwaysUseSubtitles:"SplitButtonModel",UseSubtitles:"CheckboxModel"});return 32}oCb(Ua,Nb,hc,Qc,$c){try{if(1===hc)return 32;if(!$c)return B.a.J(512500126,822,10,"PopulateTranscriptionSubtitleLanguage requires actionData"),8;this.eUl($c,!1)}catch(Hd){B.a.J(512500125,822,10,"Exception in PopulateTranscriptionSubtitleLanguage: {0}.",Hd)}return 32}nCb(Ua,
Nb,hc,Qc,$c){try{if(1===hc)return 32;if(!$c)return B.a.J(512500124,822,10,"PopulateTranscriptionSpokenLanguage requires actionData"),8;this.eUl($c,!0)}catch(Hd){B.a.J(512500123,822,10,"Exception in PopulateTranscriptionSpokenLanguage: {0}.",Hd)}return 32}NXm(Ua,Nb,hc,Qc,$c){try{if($c){this.qf.g8a=$c.MenuItemId;this.qf.Sec=this.qf.AIf();const Hd=$c.SourceControlId;this.bPj!==Hd&&(Ua={},Ua[Hd]="ToggleButtonModel",Ua[this.bPj]="ToggleButtonModel",Ra.App.Vb.nD(Ua),this.bPj=Hd)}}catch(Hd){B.a.J(512500122,
822,10,"Exception in HandleToggleTranscriptionSubtitleLanguage: {0}.",Hd)}return 32}Bth(Ua,Nb,hc,Qc,$c){try{$c&&($c[eb.a.On]=$c.MenuItemId.toLowerCase()===this.qf.g8a.toLowerCase())}catch(Hd){B.a.J(512500121,822,10,"Exception in QueryToggleTranscriptionSubtitleLanguage: {0}.",Hd)}return 32}MXm(Ua,Nb,hc,Qc,$c){try{if($c){this.qf.Ybb=$c.MenuItemId;const Hd=$c.SourceControlId;this.aPj!==Hd&&(Ua={},Ua[Hd]="ToggleButtonModel",Ua[this.aPj]="ToggleButtonModel",Ra.App.Vb.nD(Ua),this.aPj=Hd)}}catch(Hd){B.a.J(512500120,
822,10,"Exception in HandleToggleTranscriptionSpokenLanguage: {0}.",Hd)}return 32}Ath(Ua,Nb,hc,Qc,$c){try{$c&&($c[eb.a.On]=$c.MenuItemId.toLowerCase()===this.qf.Ybb.toLowerCase())}catch(Hd){B.a.J(512500119,822,10,"Exception in QueryToggleTranscriptionSpokenLanguage: {0}.",Hd)}return 32}Oec(Ua,Nb,hc,Qc,$c){if(1===hc)return 32;if(!$c||"object"!==typeof $c)return B.a.J(512500118,822,10,"SubtitleActor::ToggleSubtitlesBottomOverlay requires actionData"),8;$c[eb.a.On]&&(this.qf.z2="BottomOverlay",B.a.J(512500117,
822,50,"SubtitleActor::ToggleSubtitlesBottomOverlay: Bottom overlay is enabled"));this.Kzh($c.SourceControlId);return 32}Pec(Ua,Nb,hc,Qc,$c){if(1===hc)return 32;if(!$c||"object"!==typeof $c)return B.a.J(512500116,822,10,"SubtitleActor::ToggleSubtitlesTopOverlay requires actionData"),8;$c[eb.a.On]&&(this.qf.z2="TopOverlay",B.a.J(512500115,822,50,"SubtitleActor::ToggleSubtitlesTopOverlay: Top overlay is enabled"));this.Kzh($c.SourceControlId);return 32}Nec(Ua,Nb,hc,Qc,$c){if(1===hc)return 32;if(!$c||
"object"!==typeof $c)return B.a.J(512500114,822,10,"SubtitleActor::ToggleSubtitlesBelowSlide requires actionData"),8;$c[eb.a.On]&&(this.qf.z2="BelowSlide",B.a.J(512500113,822,50,"SubtitleActor::ToggleSubtitlesBelowSlide: Below Slide is enabled"));this.Kzh($c.SourceControlId);return 32}Mec(Ua,Nb,hc,Qc,$c){if(1===hc)return 32;if(!$c||"object"!==typeof $c)return B.a.J(512500112,822,10,"SubtitleActor::ToggleSubtitlesAboveSlide requires actionData"),8;$c[eb.a.On]&&(this.qf.z2="AboveSlide",B.a.J(512500111,
822,50,"SubtitleActor::ToggleSubtitlesAboveSlide: Above Slide is enabled"));this.Kzh($c.SourceControlId);return 32}eUl(Ua,Nb){Ua.MenuItems=Object.assign(new Hb.a,{Id:Nb?"SpokenLanguageList":"SubtitleLanguageList",MenuSectionList:[],UpdateDynamically:!0});Nb?((Nb=this.qf.lyh)&&0<Nb.count&&(Nb=Fa.$ml(Nb,"productionSpokenLanguages",""),Array.add(Ua.MenuItems.MenuSectionList,Nb)),(Nb=this.qf.kyh)&&0<Nb.count&&(Nb=Fa.$ml(Nb,"previewSpokenLanguages",ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle),
Array.add(Ua.MenuItems.MenuSectionList,Nb))):(Nb=this.qf.QNe)&&0<n.a.count(Nb)&&(Nb=Fa.wCm(this.qf.Lxh),Array.add(Ua.MenuItems.MenuSectionList,Nb));Ua.PopulationXML=ca.l(Ua.MenuItems)}Kzh(Ua){if(this.$Oj!==Ua){const Nb={};Nb[Ua]="ToggleButtonModel";Nb[this.$Oj]="ToggleButtonModel";Ra.App.Vb.nD(Nb);this.$Oj=Ua;this.Ad.WH(new wb.a(1))}}static $ml(Ua,Nb,hc){hc=Object.assign(new ua.a,{DisplayMode:"Menu",Title:hc,Id:Nb,ControlsId:"ctr"+Nb,ControlList:[]});for(const Qc of Ua)try{const $c=Qc.toLowerCase(),
Hd=Object.assign(new Va.a,{Id:Nb+"_"+$c,ExternalId:Nb+"_"+$c,LabelText:Na.a.Ne(Qc).displayName,Command:"892576938",MenuItemId:$c,QueryCommand:"1887433262",Visible:!0,AriaLabel:Yb.a.lvd});Array.add(hc.ControlList,Hd)}catch($c){B.a.J(512500110,822,10,"SubtitleActor::CreateSpokenLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",Qc,$c)}return hc}static wCm(Ua){const Nb=Object.assign(new ua.a,{DisplayMode:"Menu",Title:"",Id:"productionSubtitleLanguages",ControlsId:"ctrproductionSubtitleLanguages",
ControlList:[]});for(const hc of Ua)try{const Qc=Object.assign(new Va.a,{Id:"productionSubtitleLanguages_"+hc,ExternalId:"productionSubtitleLanguages_"+hc,LabelText:Na.a.Ne(hc).displayName,Command:"2717950896",MenuItemId:hc,QueryCommand:"4282741576",Visible:!0,AriaLabel:Yb.a.lvd});Array.add(Nb.ControlList,Qc)}catch(Qc){B.a.J(512500109,822,10,"SubtitleActor::CreateSubtitleLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",hc,Qc)}return Nb}}Object(e.a)(Fa,"SubtitleActor",null,
[743]);var rb=a(349),$b=a(72),ec=a(1205),pc=a(429),dd=a(39),Ad=a(33),Jb=a(231),Bc=a(10),Mc=a(295),ed=a(1212),Yc=a(257),ab=a(256),jb=a(260),cc=a(267);class Hc{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee,xe,cg,Gg,Of,ch,vg,jg,sh,Zh,ae,Wi,ci,Fi,hh,wf,qg){this.$Fc=this.lcc=this.zi=this.yph=null;this.gHe=0;this.YIl=!1;if(!qg)throw Error.argumentNull("sorterViewActorLazy");this.DY=Qc;this.ia=Ua;this.Ma=Nb;this.pa=hc;this.hf=$c;this.rf=Hd;this.$b=$d;this.va=ue;this.Ub=Fe;this.T_b=cf;this.Fb=Ee;this.la=xe;
this.MF=cg;this.nb=Gg;this.bD=Of;this.MLc=ch;this.MKl=vg;this.ez=jg;this.Tb=sh;this.$p=Zh;this.Q3d=ae;this.IJl=xe.Sjj;this.Ad=Wi;this.es=ci;this.qf=Fi;this.Ud=hh;this.GE=wf;this.Raa=qg;this.cxm()}Hb(){this.ia.za(va.a.kZc,gb.a.application,Object(A.a)(this,this.qSn,"startSlideShowFromBegnning"));this.ia.za(va.a.EKe,gb.a.application,Object(A.a)(this,this.EKe,"present"));this.ia.za(va.a.Tcd,gb.a.application,Object(A.a)(this,this.Tcd,"presentDropDown"));this.ia.za(va.a.rcd,gb.a.application,Object(A.a)(this,
this.rcd,"playFromBeginningTopBar"));Ga.a("DelayRegisterStartSlideShowFromCurrentSlideCommand")&&!this.$b.Qf?(this.zi=l.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.zi.QJb(Object(A.a)(this,this.bYl,"registerStartSlideShowFromCurrentSlideCommand"))):this.ia.za(va.a.EUa,gb.a.application,Object(A.a)(this,this.EUa,"startSlideShowFromCurrentSlide"));this.ia.za(va.a.Aac,gb.a.application,Object(A.a)(this,this.Aac,"forceClose"));this.ia.za(va.a.tUa,gb.a.application,Object(A.a)(this,
this.tUa,"rehearsePresentation"));this.ia.za(va.a.udd,gb.a.application,Object(A.a)(this,this.udd,"rehearsePresentationTopBar"));this.la.mBa&&(this.ia.za(va.a.ttf,gb.a.application,Object(A.a)(this,this.ttf,"enableSubtitlesKeyboardShortcut")),this.ia.za(va.a.ptf,gb.a.application,Object(A.a)(this,this.ptf,"enableLivePresenterKeyboardShortcut")));this.Iom();this.la.lSf&&this.MLc.B1m(this.nb.rp,this.qf)}bYl(){this.zi.S4b(Object(A.a)(this,this.bYl,"registerStartSlideShowFromCurrentSlideCommand"));this.ia.za(va.a.EUa,
gb.a.application,Object(A.a)(this,this.EUa,"startSlideShowFromCurrentSlide"))}ve(){if(this.Fb.getBooleanAppSetting("SlideShowByShortcutEnabled")){const Ua=this.Ma.gd(rb.AFrame.vl);rb.AFrame.kk(Ua,$b.a.eb(K.a.QSe,$b.a.Ke|4),va.a.EUa);rb.AFrame.kk(Ua,$b.a.eb(K.a.QSe,$b.a.Ke),va.a.kZc)}}Iom(){this.ia.za(va.a.otb,gb.a.application,Object(A.a)(this,this.otb,"presentLive"));this.ia.za(va.a.Vcd,gb.a.application,Object(A.a)(this,this.Vcd,"presentLiveTopBar"));this.ia.za(va.a.e3b,gb.a.application,Object(A.a)(this,
this.e3b,"presentLiveSetAccessControlAnyone"));this.ia.za(va.a.Ucd,gb.a.application,Object(A.a)(this,this.Ucd,"presentLiveSetAccessControlOrganization"));this.ia.sa(va.a.ydc,gb.a.application,Object(A.a)(this,this.ydc,"queryPresentLiveAccessControlAnyone"),96);this.ia.sa(va.a.zdc,gb.a.application,Object(A.a)(this,this.zdc,"queryPresentLiveAccessControlOrganization"),96);l.a.instance.Na("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Ua=>{Ua.IV("L_PublicLivePresentations",
!0).then(Nb=>{Nb||(B.a.J(507896729,822,15,"Public Live Presentations is disabled by publiclivepresentations policy"),this.ia.h_(va.a.e3b,Yc.a.application,Object(A.a)(this,this.e3b,"presentLiveSetAccessControlAnyone")),Ra.App.Vb.$ec(va.a.e3b,Object(A.a)(new ed.a,(new ed.a).iAb,"getCommandById")));return null},Nb=>{B.a.J(507896728,822,10,"Could not get publiclivepresentations policy {0}",Nb);return null})})}DCb(Ua,Nb,hc,Qc,$c){Ua=(Ua=this.va.Ga)?Ua.ph+1:0;Ua=(Nb=this.Ub.hl())?String.format(ResourceStrings.l_SlideMenuButtonLabel,
Ua,Nb):ResourceStrings.l_Slide;$c[ec.a.Value]=Ua;$c[pc.a.labelText]=Ua;return 32}EKe(Ua,Nb,hc){return this.$pe(Ua,hc,null)}Tcd(Ua,Nb,hc){return this.$pe(Ua,hc,null)}rcd(Ua,Nb,hc){return this.$pe(Ua,hc,null)}qSn(Ua,Nb,hc){return this.$pe(Ua,hc,null)}EUa(Ua,Nb,hc){return this.$pe(Ua,hc,this.va.Ga?this.va.Ga.Xb:null)}$pe(Ua,Nb,hc,Qc=!1,$c=!1){if(!this.la.lSf)return this.gSn(Ua,Nb,hc);if(this.hf.Cd(this.$b.Qf)||!this.Ub.hl()||this.la.GKe&&this.MLc.Hpj()||this.la.KXa&&this.MLc.uMf)return 16;if(1===Nb)return this.aNe()?
32:8;this.la.Xhj&&!Ga.a("DummyChangeGateForTest")&&B.a.J(507896727,830,100,"StartSlideShow::DummyChangeGateForTest is disabled");this.GE.hasDeferredContent()&&B.a.J(507896726,830,100,"StartSlideShow attemped with deferred content");this.pSn(hc,Qc,$c);return 32}pSn(Ua,Nb,hc){var Qc,$c=(new Date).getTime();const Hd=(null===(Qc=window.performance.timing)||void 0===Qc?void 0:Qc.navigationStart)+window.performance.now();this.gHe=Ga.a("FixNegativeSSEUPL")?$c:Hd;B.a.J(507896725,830,15,"startSlideShow ModeSwitchtime Date.GetTime():{0}, Performance.now():{1}",
$c,Hd);this.pa.Ti();this.Ma.gh(cc.a.tE);this.Ad.Bhk(Sys.EventArgs.Empty);B.a.J(507896724,830,15,"ViewSwitchActor.StartSlideShowFrom Should HideSlideShowButton: {0}",this.MLc.uMf);Qc=Ua?Ua.sid:-1;Ua=(Ua=Ua?Object(Jb.a)(31,this.Ub.XZ(Ua.sid)):null)?Ua.ph+1:-1;$c=!1;this.es.instance?$c=this.es.instance.CJa?!0:!1:B.a.J(507896723,818,15,"StartSlideShowFrom: m_podSeamlessFailoverManager is null.");this.MLc.Txh(Qc,Ua,Nb,this.Fb.La(vc.a.$l),this.nb.rp,this.nb.podSessionId,this.Fb.La(vc.a.lPa),h.AFrameworkApplication.userSessionId,
this.la.eDl,this.gHe,$c,this.nb,hc);this.MLc.OJb(Object(A.a)(this,this.RPl,"onExitSlideshowHandler"));this.bD.A5l()}udd(Ua,Nb,hc,Qc){return this.tUa(Ua,Nb,hc,Qc,{entryPoint:4})}tUa(Ua,Nb,hc,Qc,$c){switch(hc){case 2:if(!this.va.Ga)throw Error.argumentNull("ActiveSlide is null");this.la.mBa&&(Nb=0,$c&&(Nb=$c&&"entryPoint"in $c?$c.entryPoint:1),this.ia.Qa(va.a.GNe,2,Nb),this.qf&&(this.qf.Ttc=!1),this.Ud&&this.Ud.instance&&(this.Ud.instance.Ttc=!1));return this.MLc.Hpj()?(this.qf&&(this.qf.Ks=!1),32):
this.$pe(Ua,hc,this.va.Ga.Xb,!0);case 1:if(0<this.Ub.hl())if(this.la.mBa){if(32===this.ia.Cb(va.a.Eec,1)&&32===this.ia.Cb(va.a.GNe,1)&&this.aNe())return 32;break}else return this.aNe()?this.ia.Cb(va.a.Eec,1):8;else break;default:B.a.J(507896722,822,10,"RehearsePresentation: Unimplemented action behavior")}return 8}ttf(Ua,Nb,hc){switch(hc){case 2:if(this.la.mBa&&this.qf)return this.qf.Ttc=!0,32;break;case 1:return this.la.mBa?32:8;default:B.a.J(507896721,822,10,"EnableSubtitlesKeyboardShortcut: Unimplemented action behavior")}return 8}ptf(Ua,
Nb,hc){switch(hc){case 2:if(this.la.mBa&&this.Ud&&this.Ud.instance)return this.Ud.instance.Ttc=!0,32;break;case 1:return this.la.mBa?32:8;default:B.a.J(507896720,822,10,"EnableLivePresenterKeyboardShortcut: Unimplemented action behavior")}return 8}Vcd(Ua,Nb,hc,Qc,$c){return this.otb(Ua,Nb,hc,Qc,$c)}otb(Ua,Nb,hc){if(this.YIl){try{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0))}catch(Qc){B.a.J(507896719,833,10,"SlideShowLaunchActor::PresentLive unhandled exception: {0}",
Qc)}return 8}if(1===hc)return this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&this.Ud.instance.gEd&&this.aNe()?0<this.Ub.hl()?32:8:8;this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&(this.Ud.instance.oac=!0);if(!this.va.Ga)throw Error.argumentNull("ActiveSlide is null");return this.$pe(Ua,hc,this.va.Ga.Xb,!1,!0)}e3b(Ua,Nb,hc){if(1===hc)return this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&this.Ud.instance.gEd&&this.aNe()?32:8;this.Ud.instance.PK&&0!==this.Ud.instance.accessControl?this.Ud.instance.showEndSessionDialog(()=>
{this.Ud.instance.Htf(5);this.Ud.instance.accessControl=0;this.Ad.WH(new wb.a(1))},()=>{}):(this.Ud.instance.accessControl=0,this.Ad.WH(new wb.a(1)));return 32}Ucd(Ua,Nb,hc){if(1===hc)return this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&this.Ud.instance.gEd&&this.Ud.instance.krl&&this.aNe()?32:8;this.Ud.instance.PK&&1!==this.Ud.instance.accessControl?this.Ud.instance.showEndSessionDialog(()=>{this.Ud.instance.Htf(5);this.Ud.instance.accessControl=1;this.Ad.WH(new wb.a(1))},()=>{}):(this.Ud.instance.accessControl=
1,this.Ad.WH(new wb.a(1)));return 32}ydc(Ua,Nb,hc,Qc,$c){try{const Hd=Object(Jb.a)(bb.a,$c);Hd&&this.Ud.instance&&Hd.xg(0===this.Ud.instance.accessControl)}catch(Hd){B.a.J(507896718,833,10,"SlideShowLaunchActor::QueryPresentLiveAccessControlAnyone unhandled exception: {0}",Hd)}return 32}zdc(Ua,Nb,hc,Qc,$c){try{const Hd=Object(Jb.a)(bb.a,$c);Hd&&this.Ud.instance&&Hd.xg(1===this.Ud.instance.accessControl)}catch(Hd){B.a.J(507896717,833,10,"SlideShowLaunchActor::QueryPresentLiveAccessControlOrganization unhandled exception: {0}",
Hd)}return 32}gSn(Ua,Nb,hc){if(this.hf.Cd(this.$b.Qf))return 16;if(1===Nb)return this.Ub.hl()?32:16;this.gHe=(new Date).getTime();this.pa.Ti();this.Ma.gh(cc.a.tE);this.Ad.Bhk(Sys.EventArgs.Empty);this.MF.show(!0,Ua);this.DY.QJa(!1,!0,!0,()=>{this.M0l(hc,this.gHe)},()=>{B.a.J(507896716,818,10,"StartSlideShowFrom: ForceSave triggered failed.");this.M0l(hc,this.gHe);return!0});return 32}RPl(Ua,Nb){Ua=((new Date).getTime()-this.gHe).toString();B.a.J(507896715,830,15,"SlideShowLaunchActor.OnExitSlideshowHandler: Exit slideshow. Duration: {0}. HasDeferredContentInFile: {1}, HasDeferredContentOnSlide: {2}",
Ua,this.GE.hasDeferredContent(),Nb.slideId?this.GE.zLf(Nb.slideId.toString()):"Missing slideId");this.GE.hasDeferredContent()||Nb.slideId&&this.GE.zLf(Nb.slideId.toString())?this.GE.IHa("DeferredExitSlideshowDuration",Ua):this.GE.IHa("ExitSlideshowDuration",Ua);this.MLc.TCb(Object(A.a)(this,this.RPl,"onExitSlideshowHandler"));(this.lcc=Nb)&&!this.lcc.NBl&&!this.lcc.sCl&&0<this.lcc.slideId&&0<=this.lcc.slideIndex&&this.vmn(this.lcc.slideId,this.lcc.slideIndex);this.Ma.Wd();this.IJl?(this.$Fc=jb.a.Fk("ExitSlideshow"),
this.hf.blockContent(this.$b.Qf,"ExitSlideshow",!1,void 0,void 0),this.MKl.Am(Object(A.a)(this,this.RQl,"onPageManifestNodePropertyChanged")),this.$Fc.Ya("UnlockPodsSessionStartTime",jb.a.Lf(new Date)),this.unlockPodsSession(hc=>{this.$Fc&&(this.$Fc.Ya("UnlockPodsSessionWithMerge",hc.toString()),this.$Fc.Ya("UnlockPodsSessionEndTime",jb.a.Lf(new Date)));hc?this.ez.zsl(null):this.Xsk()})):this.Xsk()}Xsk(Ua=null){Ua&&(this.yph=null);this.lcc&&(this.IJl&&(this.MKl.Pq(Object(A.a)(this,this.RQl,"onPageManifestNodePropertyChanged")),
this.hf.mD(this.$b.Qf),this.$Fc&&(this.$Fc.Ya("InboundPresentationEndTime",jb.a.Lf(new Date)),this.$Fc.finish(),this.$Fc=null)),this.lcc=null,this.bD.K_l())}unlockPodsSession(Ua){const Nb=sb.a.create().toString();B.a.J(507896713,830,50,"SlideShowLaunchActor.UnlockPodsSession: Unlock Pods session, correlation={0}",Nb);const hc=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked=false",h.AFrameworkApplication.ga.appSettings[vc.a.$l],this.nb.podSessionId),Qc={WaitForSessionTimeoutMs:"0"};
Qc["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;Qc["X-CorrelationID"]=Nb;Qc["X-WacCluster"]=this.nb.rp;this.N1l(hc,Qc,0,Ua)}N1l(Ua,Nb,hc,Qc){this.$p.rk(Ua,2,null,Nb,!1,2,$c=>{this.CWn($c,hc,Qc)},$c=>{this.TVk($c,Ua,Nb,hc,Qc)},null,void 0,void 0,void 0,void 0,uc.a("2"))}CWn(Ua,Nb,hc){if(Nb)B.a.J(507896711,830,50,"SlideShowLaunchActor.UnlockPodsSession: Succeed with retry: {0}",Nb);else{Nb=!1;try{Ua.data.responseData&&0<Ua.data.responseData.length&&(Nb=JSON.parse(Ua.data.responseData).FMerged)}catch(Qc){B.a.J(507896712,
830,10,"SlideShowLaunchActor.UnlockPodsSession: Failed to deserialize unlock Pods session response: {0}",Ua.toString())}hc(Nb)}}TVk(Ua,Nb,hc,Qc,$c){Qc||$c(!1);3>Qc?this.N1l(Nb,hc,Qc+1,$c):B.a.J(507896710,830,10,"SlideShowLaunchActor.UnlockPodsSession: Failed with status code: {0}, retry count: {1}",this.Q3d.LV(Ua),Qc)}RQl(Ua,Nb){this.yph||Nb.property!==ab.a.dbc||(this.yph=new dd.a(2,1,0,Object(A.a)(this,this.Xsk,"resumeEditor"),90,"65"),this.Tb.Qb(this.yph))}M0l(Ua,Nb){this.MF.hide();let hc=!0,Qc=
!1,$c=this.rf.BNe;$c||($c=Ad.a.em(window.document.URL,Mc.a.ssh,Mc.a.slideShowView,!0),Qc=!0);$c=Ad.a.removeParameter($c,Mc.a.XSl);$c=Ua?Ad.a.em($c,Mc.a.fRc,Ua.sid.toString(),!0):Ad.a.removeParameter($c,Mc.a.fRc);0<Nb&&($c=Ad.a.em($c,h.AFrameworkApplication.o9d,Nb.toString(),!0));Ua=String.format("menubar=false,fullscreen=yes,scrollbars=yes,resizable=yes,left=0,top=0,width={0},height={1}",window.screen.width,window.screen.height);Nb=null;try{Nb=this.T_b.vAg(4,$c,"SlideShowWindow",Ua,Qc,!1)}catch(Hd){B.a.J(507896709,
818,10,"StartSlideShowFrom: Exception throw trying to open the window. {0}",Hd),hc=!1}Nb||(B.a.J(507896708,818,10,"StartSlideshowFrom:: failed to open slide show window"),hc=!1);jb.a.Xj("Window Opened",hc.toString());jb.a.Xse()}Aac(Ua,Nb,hc){if(2!==hc)return this.ia.Cb(Bc.a.close,hc);Ua=this.ia.Cb(Bc.a.close,2);32!==Ua&&(B.a.J(507896707,801,50,"Close action failed to execute. Response: {0}",Ua),window.location="about:blank");return 32}vmn(Ua,Nb){B.a.J(507896706,830,50,"SlideShowLaunchActor.NavigateAtSlideshowExit: SlideIndex={0}",
Nb);(Ua=this.Ub.XZ(Ua))?this.Raa.value.x8(Ua.ph):(B.a.J(507896705,830,50,"SlideShowLaunchActor.NavigateAtSlideshowExit: SlideId does not exist.  Navigate to slide index {0}.",Nb),Ua=this.Ub.hl()-1,Nb=Nb>Ua?Ua:Nb,0>Nb||this.Raa.value.x8(Nb))}aNe(){return!this.MLc.uMf}cxm(){this.la.nbb&&l.a.instance.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ua=>{Ua.isFeatureEnabled("PowerPointLivePresentations",!1).then(Nb=>{Nb||(B.a.J(507896704,822,15," User doesn't have license for PPTLive, Hiding Present Live button"),
this.YIl=!0);return null})})}}Object(e.a)(Hc,"SlideShowLaunchActor",null,[743]);var Vc=a(1028),Tc=a(55),cd=a(341);class Lb{constructor(){this.type="CaptionDiscoverabilityTaskPaneProps";this.podiumPresentationImageUrl=null;this.enableDoNotShowAgain=!1;this.onLaunchSlideShowButtonClicked=this.onDismissButtonClicked=this.onTurnOnButtonClicked=null}}Object(e.a)(Lb,"CaptionDiscoverabilityTaskPaneProps",null,[]);class Rc{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf){this.QJl=!1;Ua("powerpoint-discoverability-strings").then(()=>
{this.QJl=!0;B.a.J(509138209,801,50,"powerpoint-discoverability-strings is loaded successfully")}).catch(Ee=>{B.a.J(509138208,801,10,"Failed to load powerpoint-discoverability-strings "+Ee.toString())});this.ia=Nb;this.Ad=hc;this.oc=Qc;this.rf=$c;this.eR=Hd;this.qf=$d;this.wen=Fe;this.e1=ue;this.Pcn=cf;this.WLl=P.a.get("PPTCaptionDiscoverabilityLastShownTime")?!0:!1;this.a8f=!1;this.Ad.c$b(Object(A.a)(this,this.V4a,"onRibbonTabSwitched"))}dispose(){this.Ad.Uje(Object(A.a)(this,this.V4a,"onRibbonTabSwitched"))}Hb(){this.ia.za(va.a.kNe,
gb.a.application,Object(A.a)(this,this.kNe,"showCaptionDiscoverabilityPane"))}ve(){}kNe(Ua,Nb,hc){if(Nb.contextId!==gb.a.application||!this.QJl)return 2;if(1===hc)return 32;if(Rc.lkj||Rc.hwi||!this.oIm()||!this.nIm())return 8;this.a8f||this.Zwm(Ua);return 32}Zwm(Ua){cd.a("CaptionDiscoverabilityPaneActor::CheckAudioAndShowPane",Ua,()=>{this.a8f=!0;this.e1.enumerateDevices(Object(A.a)(this,this.mon,"onAudioInputAvailable"),Object(A.a)(this,this.Srb,"onDevicesFailure"),Object(A.a)(this,this.csb,"onUnsupported"));
return 32})}mon(Ua){if(Ua.length){for(const Nb of Ua)if("audioinput"===Nb.kind&&!this.wen.W$a()){Rc.lkj=!0;this.Rn();break}this.a8f=!1}}Srb(Ua){this.a8f=!1;B.a.J(509138207,822,10,"CaptionDiscoverabilityPaneActor::OnDevicesFailure exception: {0}",Ua.toString())}csb(){this.a8f=!1;B.a.J(509138206,822,15,"CaptionDiscoverabilityPaneActor::OnUnsupported mediaDevices API not available for browser: {0}",v.a.Iy)}Rn(){const Ua=this.ML(),Nb=Object.assign(new Vc.a,{title:ResourceStrings.l_CaptionDiscoverabilityPane,
hideHeader:!1,width:320,location:2,contentProps:Ua,onOpen:()=>{B.a.J(509138205,822,50,"CaptionDiscoverabilityPaneActor::ShowPane")},onClose:()=>{B.a.J(509138204,822,50,"CaptionDiscoverabilityPaneActor::ClosePane")},isModernPane:!0});this.eR.pTa(cc.a.Azb,cc.a.vl,null,()=>{},()=>{});Tc.a.Py().then(hc=>{hc.showTaskPane(cc.a.Azb,Nb);return null}).catch(hc=>{B.a.J(509138203,822,10,"CaptionDiscoverabilityPaneActor::ShowPane exception: {0}",hc.toString())})}Tw(){Tc.a.Py().then(Ua=>{Ua.hideTaskPane(cc.a.Azb,
2);return null}).catch(Ua=>{B.a.J(509138202,822,10,"CaptionDiscoverabilityPaneActor::HidePane exception: {0}",Ua.toString())})}ML(){return Object.assign(new Lb,{podiumPresentationImageUrl:this.rf.Yp("CaptionDiscoverabilityPromptViewImage.png"),enableDoNotShowAgain:this.WLl,onTurnOnButtonClicked:Object(A.a)(this,this.onTurnOnButtonClicked,"onTurnOnButtonClicked"),onDismissButtonClicked:Object(A.a)(this,this.onDismissButtonClicked,"onDismissButtonClicked"),onLaunchSlideShowButtonClicked:Object(A.a)(this,
this.onLaunchSlideShowButtonClicked,"onLaunchSlideShowButtonClicked")})}onTurnOnButtonClicked(){cd.a("CaptionDiscoverabilityPaneTurnOn",va.a.hcb,()=>{let Ua=8;this.qf.Ks||(Ua=this.ia.Qa(va.a.hcb,2,{}));this.Pcn&&8!==Ua||this.Tw();return Ua})}onDismissButtonClicked(){this.WLl&&(Rc.hwi=!0,B.a.J(509138201,822,50,"CaptionDiscoverabilityPaneActor::DoNotShowAgain"));this.Tw()}onLaunchSlideShowButtonClicked(){cd.a("CaptionDiscoverabilityPaneLaunchSlideshow",va.a.kZc,()=>{this.Tw();return this.ia.Cb(va.a.kZc,
2)})}V4a(Ua,Nb){2!==Nb.gw&&3!==Nb.gw&&4!==Nb.gw||!Nb.Brb||"SlideShow"!==Nb.Brb||cd.a("OnRibbonTabSwitched",va.a.kNe,()=>this.ia.Cb(va.a.kNe,2))}nIm(){let Ua=0,Nb=!1,hc=!1;for(var Qc of this.oc.ZJa()){if(Qc.ol){Nb=!0;break}if(Qc.Bxa&&(Ua+=Qc.GQ.length,4<=Ua))break;if(Qc.mTa){hc=!0;break}}Qc=hc||Nb||4<=Ua;B.a.J(509138200,822,50,"CaptionDiscoverabilityPaneActor::FMeetsIntentToPresent - Result: {0}; Animation Count: {1}; Hidden slide: {2}, Transition: {3}",Qc.toString(),Ua.toString(),Nb.toString(),hc.toString());
return Qc}oIm(){return!this.qf.Ks&&this.kIm()}kIm(){const Ua=Na.a.Ne(h.AFrameworkApplication.lcid);return!Ua||O.a.rb(Ua.name)?!1:Ua.name.toLowerCase()===this.qf.Ybb}static get lkj(){var Ua=P.a.get("PPTCaptionDiscoverabilityLastShownTime");if(!Ua)return!1;const Nb=new Date;Ua=new Date(decodeURIComponent(Ua));return 14>(+Nb-+Ua)/864E5}static set lkj(Ua){P.a.n_("PPTCaptionDiscoverabilityLastShownTime",(new Date).toUTCString(),P.a.b_)||B.a.J(509138199,822,10,"Failed to set cookie for discoverability last shown time to {0}",
Ua.toString())}static get hwi(){const Ua=P.a.get("PPTCaptionDiscoverabiltyDoNotShowAgain");return Ua?"true"===Ua.toLowerCase():!1}static set hwi(Ua){P.a.n_("PPTCaptionDiscoverabiltyDoNotShowAgain",Ua.toString(),P.a.b_)||B.a.J(509138198,822,10,"Failed to set cookie for discoverability opt out to {0}",Ua.toString())}}Object(e.a)(Rc,"CaptionDiscoverabilityPaneActor",null,[743]);class md{constructor(Ua,Nb,hc){this.ZKl=Date.now();this.FMj=Date.now();this.gPj=this.Zph=0;this.abd=-1;this.gMl=0;this.hMl=
new Set;this.lka=!1;if(!Ua)throw Error.argumentNull("appSettings");if(!Nb)throw Error.argumentNull("clientRequestManager");if(!hc)throw Error.argumentNull("presReader");this.la=Ua;this.$p=Nb;this.Ub=hc;this.gPj=this.la.Jc("SnapUrlUpdateAfterEditMaxCount",1);this.gMl=this.la.Jc("SnapUrlUpdateAfterEditWindowTime",5E3);this.hMl=(this.la.getSetting("SnapUrlUpdateEligibleSlideIndexList")||"").split(",").map(Qc=>parseInt(Qc,10)).filter(Qc=>!isNaN(Qc)).reduce((Qc,$c)=>Qc.add($c),new Set)}get wVl(){return this.ZKl}get Vsh(){return this.FMj}get vVl(){return this.iA}get uMe(){return this.lka}t_l(){this.Zph=
0}zlh(Ua){return Ua<this.FMj}nzh(Ua,Nb){var hc,Qc,$c;if(Ua&&!(this.Zph>=this.gPj)){for(let Hd=0;Hd<Ua.length;Hd++)if(void 0!=(null===(hc=Ua[Hd])||void 0===hc?void 0:hc.sid)){const $d=null===($c=this.Ub.XZ(null===(Qc=Ua[Hd])||void 0===Qc?void 0:Qc.sid))||void 0===$c?void 0:$c.slideIndex;if(void 0!=$d&&this.hMl.has($d)){this.eNn(Nb);return}}this.JOe()}}JOe(){-1!=this.abd&&void 0==this.mpg&&(window.clearTimeout(this.abd),B.a.J(507869148,830,15,"SnapUrlPrefetcher::tryResetSnapUrlUpdateAfterEdit: timeout cleared with TimeoutId:{0}",
this.abd),this.abd=-1)}eNn(Ua){Object(f.b)(this,void 0,void 0,function*(){this.JOe();this.mpg&&(yield this.mpg);this.abd=window.setTimeout(()=>Object(f.b)(this,void 0,void 0,function*(){this.Zph>=this.gPj||(this.mpg=this.oAn(Ua),yield this.mpg,this.mpg=void 0,B.a.J(507871236,830,15,"SnapUrlPrefetcher::setSnapUrlUpdateAfterEdit: prefetched snap url for TimeoutId:{0}",this.abd));this.abd=-1}),this.gMl);B.a.J(507871235,830,15,"SnapUrlPrefetcher::setSnapUrlUpdateAfterEdit: timeout set with TimeoutId:{0}",
this.abd)})}oAn(Ua){return Object(f.b)(this,void 0,void 0,function*(){const Nb=new Date;B.a.J(507871233,830,15,"SnapUrlPrefetcher::prefetchSnapUrlAfterEdit: CurrentPodSessionId:{0}",Ua);let hc=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.$l,Ua);if(Ga.a("AddCallerQueryParam")){const $c=this.la.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");hc+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${$c}`}const Qc={"Content-Type":"application/json; charset=utf-8",
WaitForSessionTimeoutMs:"0"};Qc["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;return new Promise(($c,Hd)=>{this.$p.rk(hc,1,"",Qc,!1,0,$d=>Object(f.b)(this,void 0,void 0,function*(){const ue=new Date;B.a.J(507871232,830,15,"SnapUrlPrefetcher::prefetchSnapUrlAfterEdit: Time-Taken : {0}",+ue-+Nb);const Fe=JSON.parse($d.data.responseData);this.iA=Fe.downloadUrl;void 0!==Fe.sendGetItemsRequestToPFD&&(this.lka=Fe.sendGetItemsRequestToPFD);O.a.rb(this.iA)?B.a.J(507869411,830,10,"SnapUrlPrefetcher::prefetchSnapUrlAfterEdit: downloadUrl is null or empty : {0}",
Fe):(this.ZKl=Nb.getTime(),this.FMj=ue.getTime(),this.Zph++,$c())}),()=>Object(f.b)(this,void 0,void 0,function*(){B.a.J(507869410,830,10,"SnapUrlPrefetcher::prefetchSnapUrlAfterEdit: failed to get downloadUrl");Hd()}),null,null)})})}}Object(e.a)(md,"SnapUrlPrefetcher",null,[]);class Zc{constructor(){this.la=this.Rb=this.$=null}get name(){return"PowerPointWebEditor.SlideShow"}lc(Ua){this.$=Ua;const Nb=this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Rb=Nb.sP();this.la=this.$.resolve("PowerPointWebEditor.IApplicationSettings");
this.$.register(713,"PowerPointWebEditor.IFullscreenHelper").ma().na(()=>new D);this.$.register(714,"PowerPointWebEditor.IWebGLHelper").ma().na(()=>new Ea(this.$.resolve("Common.IBrowserUtils")));this.$.register(715,"PowerPointWebEditor.ISubtitleContext").ma().na(()=>new wa(this.la));this.$.register(716,"PowerPointWebEditor.IRehearsalContext").ma().na(()=>new I);this.la.getBooleanAppSetting("SlideShowGetPresInfoFromClient")&&this.$.register(717,"PowerPointWebEditor.PresInfoClient").ma().na(()=>new ac(this.$.resolve("PowerPointWebEditor.IPresentationReader"),
this.$.resolve("PowerPointWebEditor.ISlideDimensionsHelper")));this.YDc({["Type"]:"CheckBrowserStart"});let hc;if(this.la.isAnimationPreviewEnabled){Kb.aql(this.$);var Qc=this.$.resolve("PowerPointWebEditor.ISlideShowCoreHelper");Ua=Qc.SGe||Qc.RGe;hc=Qc.pta}else{Ua={};Qc=this.YPf(Ua);const Fe=pa.a()&&this.la.zCc&&Qc&&this.kgj(),cf=this.jgj();hc=!Fe&&cf;this.YDc({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:Fe||cf,["IsModernWebGLSupportedBrowser"]:Fe,["IsModernSupportedBrowser"]:cf,["IsBrowserShapeBuilderCompatible"]:Qc,
["log"]:Ua,["useSvg"]:hc});Ua=Fe||cf}if(Ua){var $c=this.la.getBooleanAppSetting("SnapUrlUpdateAfterEditEnabled");$c&&this.$.register(718,"PowerPointWebEditor.SnapUrlPrefetcher").ma().na(()=>new md(this.la,h.AFrameworkApplication.ye,this.$.resolve("PowerPointWebEditor.IPresentationReader")));this.$.register(719,"PowerPointWebEditor.ISlideshowFrame").ma().na(()=>new Aa.a(this.Rb,this.la,this.$.resolve("PowerPointWebEditor.ISubtitleContext"),this.$.resolve("Common.IDynamicScriptLoaderProvider").LW,this.$.Na("PowerPointWebEditor.ISlideShowVoiceNotification"),
this.$.Na("PowerPointLive.ILivePresenter"),this.$.resolve("PowerPointWebEditor.IFullscreenHelper"),this.$.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),hc,this.$.resolve("PowerPoint.IPathManager"),this.$.Na("Common.App.HostNotification.EditNotificationEventSource"),this.$.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.$.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,h.AFrameworkApplication.ye,this.$.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),
this.la.getBooleanAppSetting("SlideShowGetPresInfoFromClient")?this.$.resolve("PowerPointWebEditor.PresInfoClient"):null,this.$.Na("PowerPointWebEditor.ISlideShowCameraNotification"),this.la.isAnimationPreviewEnabled?this.$.resolve("PowerPointWebEditor.ISlideShowCoreHelper"):null,this.la.getBooleanAppSetting("IsSnapUrlFetchedEarlyOnBootEnabled")?this.$.resolve("PowerPointWebEditor.SlideShowSnapUrlGenerator"):void 0,$c?this.$.resolve("PowerPointWebEditor.SnapUrlPrefetcher"):void 0));if(this.la.isAnimationPreviewEnabled)this.$.resolve("PowerPointWebEditor.ISlideShowCoreHelper").DLl.then(()=>
{this.$.resolve("PowerPointWebEditor.ISlideshowManager").qEj||(B.a.J(509636753,830,50,"PPTWebEditorSlideShowPackage::Initializing SlideShowCoreFrame on package registration"),this.$.resolve("PowerPointWebEditor.ISlideshowFrame").init(h.AFrameworkApplication.buildVersion,this.$.resolve("PowerPointWebEditor.ISessionInfoOwner").rp,h.AFrameworkApplication.userSessionId,this.$.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId),this.$.resolve("PowerPointWebEditor.ISlideshowManager").J2l());
return null});else{const Fe={};Fe.loadScriptStart=Date.now();Ua=u.a.create(h.AFrameworkApplication.xh("powerpoint-slideshow-strings",3));m.a.HL(Ua);Promise.all([new Promise((cf,Ee)=>{const xe=document.createElement("script");xe.async=!1;xe.src=h.AFrameworkApplication.xh(String.format("slideshowcore{0}.js",".min"),5);xe.addEventListener("load",()=>{B.a.J(509636759,830,50,"PPTWebEditorSlideShowPackage::Loaded slideshowcore");cf(xe)});xe.addEventListener("error",()=>{B.a.J(509636758,830,10,"PPTWebEditorSlideShowPackage::Failed to load slideshowcore");
Ee(xe)});document.head.appendChild(xe)}),new Promise((cf,Ee)=>{const xe=document.createElement("script");xe.async=!1;xe.src=h.AFrameworkApplication.xh(String.format("podsproxy{0}.js",".min"),5);xe.addEventListener("load",()=>{B.a.J(509636757,830,50,"PPTWebEditorSlideShowPackage::Loaded podsproxy");cf(xe)});xe.addEventListener("error",()=>{B.a.J(509636756,830,10,"PPTWebEditorSlideShowPackage::Failed to load podsproxy");Ee(xe)});document.head.appendChild(xe)}),new Promise((cf,Ee)=>{const xe=document.createElement("script");
xe.async=!1;xe.src=h.AFrameworkApplication.xh(String.format("pptspeechclient{0}.js",".min"),5);xe.addEventListener("load",()=>{B.a.J(509636755,830,50,"PPTWebEditorSlideShowPackage::Loaded pptspeechclient");cf(xe)});xe.addEventListener("error",()=>{B.a.J(509636754,830,10,"PPTWebEditorSlideShowPackage::Failed to load pptspeechclient");Ee(xe)});document.head.appendChild(xe)})]).then(()=>{Fe.loadScriptEnd=Date.now();const cf={Type:"LoadedJS"};n.a.forEach(Fe,(Ee,xe)=>{cf[Ee]=xe},null);this.YDc(cf);this.$.resolve("PowerPointWebEditor.ISlideshowManager").qEj||
(B.a.J(508086156,830,50,"PPTWebEditorSlideShowPackage::Initializing SlideShowCoreFrame on package registration"),this.$.resolve("PowerPointWebEditor.ISlideshowFrame").preloadShaders(),this.$.resolve("PowerPointWebEditor.ISlideshowFrame").init(h.AFrameworkApplication.buildVersion,this.$.resolve("PowerPointWebEditor.ISessionInfoOwner").rp,h.AFrameworkApplication.userSessionId,this.$.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId),this.$.resolve("PowerPointWebEditor.ISlideshowManager").J2l());
return null}).catch(cf=>{this.YDc({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});B.a.J(512309318,830,10,"PPTWebEditorSlideShowPackage::LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",cf)})}this.$.register(Gb,"PowerPointWebEditor.SlideShowFooterContainer").na(()=>new Gb(this.Rb,h.AFrameworkApplication.vb));this.$.resolve("PowerPointWebEditor.SlideShowFooterContainer").Hb();if(!this.la.dTf||this.la.Mak)this.$.register(aa,"PowerPointWebEditor.SlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().na(()=>
new aa(h.AFrameworkApplication.vb,this.la,this.$.resolve("PowerPointWebEditor.ISlideshowFrame"),this.$.resolve("PowerPoint.IPathManager"),this.$.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.$.Na("PowerPointLive.ILivePresenter"),this.Rb,()=>h.AFrameworkApplication.isRtl,this.la.$l,this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.$.resolve("PowerPointWebEditor.IFullscreenHelper"))),this.$.resolve("PowerPointWebEditor.ISlideshowToolbar");else{Ua=H.a(this.$);Qc=new z.a;Qc.add(Ua("slideshowToolbar"));
this.la.eVl&&Qc.add(Ua("uiFabricLazy"));Promise.all(Qc.toArray()).catch(cf=>B.a.J(50907106,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the slideshowToolbar feature: {0}",cf)).then(()=>this.tsn()).catch(cf=>B.a.J(50907136,830,10,"PPTWebEditorSlideShowPackage::Failed to load the React slideshowToolbar: {0}",cf));this.la.$Sd&&(Ua("inkButton").catch(cf=>B.a.J(51218050,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the ink button feature: {0}",cf)).then(()=>
this.qqn()).catch(cf=>B.a.J(51218052,830,10,"PPTWebEditorSlideShowPackage::Failed to load the React ink button: {0}",cf)),this.$.register(720,"PowerPointWebEditor.IInkButtonHelper").ma().na(()=>new N));Qc=this.la.getBooleanAppSetting("SlideShowToolbarEaseOfUseEnabled");(this.la.tX||Qc)&&this.p9m(Ua);if(this.la.nBa){const cf=this;Ua("voiceUI").catch(Ee=>B.a.J(595198419,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the voice UI feature: {0}",Ee)).then(()=>cf.usn()).catch(Ee=>
B.a.J(595198417,830,10,"PPTWebEditorSlideShowPackage::Failed to load the voice UI script: {0}",Ee));this.$.register(721,"PowerPointWebEditor.ISlideShowVoiceNotification").ma().na(()=>new hb)}this.la.tX&&this.c9m(Ua);const Fe=this;this.$.register(Ha,"PowerPointWebEditor.ReactSlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().na(()=>new Ha(h.AFrameworkApplication.vb,Fe.la,Fe.$.resolve("PowerPointWebEditor.ISlideshowFrame"),Fe.$.resolve("PowerPoint.IPathManager"),Fe.$.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
Fe.$.Na("PowerPointLive.ILivePresenter"),Fe.Rb,()=>h.AFrameworkApplication.isRtl,Fe.la.$l,Fe.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),Fe.$.resolve("PowerPointWebEditor.IFullscreenHelper")))}var Hd=this.$.Na("PowerPointWebEditor.ISlideshowToolbar");var $d=this;this.$.register(Za,"PowerPointWebEditor.SlideshowContextMenu").na(()=>new Za($d.$.resolve("PowerPointWebEditor.ISlideshowFrame"),$d.$.resolve("PowerPointWebEditor.IPresentationReader"),$d.$.resolve("PowerPointWebEditor.IInputHandlerManager"),
h.AFrameworkApplication.vb,$d.$.resolve("PowerPointWebEditor.View.IViewEventNotifier"),$d.Rb,()=>h.AFrameworkApplication.isRtl,$d.$.resolve("PowerPointWebEditor.IFullscreenHelper"),$d.$.Na("PowerPointLive.ILivePresenter")));var ue=this;this.$.register(722,"PowerPointWebEditor.ISlideshowManager").ma().na(()=>new wc(ue.$.resolve("PowerPointWebEditor.IFullscreenHelper"),ue.$.resolve("PowerPointWebEditor.ISlideshowFrame"),Hd,ue.$.resolve("PowerPointWebEditor.SlideshowContextMenu"),ue.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
h.AFrameworkApplication.ye,ue.la,Nb,ue.$.resolve("PowerPointWebEditor.IPresentationReader"),ue.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),ue.$.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),ue.$.resolve("PowerPointWebEditor.IErrorHandler"),l.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),ue.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),ue.$.resolve("PowerPointWebEditor.IZoomContentFetcher"),r.a.aG(l.a.instance.Na("Common.ISystemInitiatedFeedback")),h.AFrameworkApplication.vb,
l.a.instance.Na("PowerPointLive.ILivePresenter"),ue.$.resolve("PowerPointWebEditor.SlideShowFooterContainer"),ue.$.Na("PowerPointWebEditor.ISlideShowVoiceNotification"),ue.$.Na("PowerPointWebEditor.ISlideShowCameraNotification")))}else this.YDc({["Type"]:"Error",["Reason"]:"UnSupportedBrowser"}),this.$.resolve("PowerPointWebEditor.ISlideshowManager").uMf=!0}p9m(Ua){Ua("optionsButton").catch(Nb=>B.a.J(508912669,830,10,"Failed to load the resources for the options menu button feature: {0}",Nb)).then(()=>
this.Uqn()).catch(Nb=>B.a.J(508912668,830,10,"Failed to load the React options menu button: {0}",Nb));this.$.register(723,"PowerPointWebEditor.IOptionsButtonLoader").ma().na(()=>new nb)}c9m(Ua){Object(f.b)(this,void 0,void 0,function*(){try{yield Ua("cameraUI"),this.$.register(724,"PowerPointWebEditor.ISlideShowCameraNotification").ma().na(()=>new Wa),this.rsn()}catch(Nb){B.a.J(508178881,830,10,`PPTWebEditorSlideShowPackage::Failed to load the resources for the camera UI feature: ${Nb}`)}})}YDc(Ua){B.a.J(594583632,
830,15,"PPTWebEditorSlideShowPackage::logSlideShowSwitcherData "+JSON.stringify(Ua))}kgj(){const Ua=this.la.La("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";"),Nb=JSON.parse(this.la.La("SessionStartInfoJson").toString());B.a.J(512309317,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",Nb.Browser,Nb.BrowserMajorVersion);for(const hc of Ua)if(hc.split(":")[0].toLowerCase()===(Nb.Browser||"").toLowerCase()&&parseInt(Nb.BrowserMajorVersion||
"",10)<parseInt(hc.split(":")[1],10))return B.a.J(512309316,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Name {0}, Version {1}",Nb.Browser,Nb.BrowserMajorVersion),!1;return!0}jgj(){const Ua=this.la.La("PptModernSlideShowBlockListForBrowserVersion").split(";"),Nb=JSON.parse(this.la.La("SessionStartInfoJson").toString());B.a.J(512309315,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",Nb.Browser,Nb.BrowserMajorVersion);for(const hc of Ua)if(hc.split(":")[0].toLowerCase()===
(Nb.Browser||"").toLowerCase()&&parseInt(Nb.BrowserMajorVersion||"",10)<parseInt(hc.split(":")[1],10))return B.a.J(512309314,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Name {0}, Version {1}",Nb.Browser,Nb.BrowserMajorVersion),!1;return!0}YPf(Ua){return La.a(Ua)}init(){this.$.resolve("Common.IAppSettingsManager").fg(Object(A.a)(this,this.su,"onFullAppSettingsReady"));var Ua=l.a.instance.resolve("PowerPointWebEditor.IApplicationSettings");var Nb=l.a.instance.resolve("Common.AFrameworkApplication");
Nb=new Hc(l.a.instance.resolve("Common.IActionManagerExtended"),l.a.instance.resolve("PowerPointWebEditor.IFocusManager"),l.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),l.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),l.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),l.a.instance.resolve("PowerPoint.IPathManager"),Nb.nj.Pd,l.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),l.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),
l.a.instance.resolve("PowerPointWebEditor.IWindowUtils"),h.AFrameworkApplication.ga,Nb.Om.Md,l.a.instance.resolve("PowerPointWebEditor.ISaveBlockingUI"),Nb.Om.o$a(),l.a.instance.resolve("PowerPointWebEditor.ISessionLifetimeManager"),l.a.instance.resolve("PowerPointWebEditor.ISlideshowManager"),l.a.instance.resolve("Box4.Graph.IGraphInstance").Sd(7),l.a.instance.resolve("PowerPointWebEditor.IInboundHelper"),l.a.instance.resolve("Common.ITaskManager"),h.AFrameworkApplication.ye,l.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager"),
l.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),l.a.instance.Na("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),l.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),l.a.instance.Na("PowerPointLive.ILivePresenter"),l.a.instance.resolve("PowerPointWebEditor.IDeferredContentManager"),l.a.instance.ge("PowerPointWebEditor.ISorterViewActorLazy"));Nb.Hb();Nb.ve();Nb=h.AFrameworkApplication.ga.getBooleanAppSetting("LiveSubtitlesEnabled");Ua.aBb&&Nb&&(Ua=new Fa(l.a.instance.resolve("Common.IActionManagerExtended"),
l.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),l.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),l.a.instance.resolve("PowerPointWebEditor.ISubtitleContext")),Ua.Hb(),Ua.ve());Ua=new Rc(H.a(l.a.instance),l.a.instance.resolve("Common.IActionManagerExtended"),l.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),l.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),l.a.instance.resolve("PowerPoint.IPathManager"),l.a.instance.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),
l.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),l.a.instance.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),l.a.instance.resolve("PowerPointWebEditor.ISlideshowFrame"),l.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").nVl);Ua.Hb();Ua.ve()}su(){w.a.get_instance().$i(10,null).continueWith(()=>{if(!this.la.isCreateNew&&this.la.zak&&this.la.xVl)try{r.a.aG(l.a.instance.Na("Common.ISystemInitiatedFeedback")).continueWith(Ua=>{Ua.result.logActivity("HasPresentButtonSeen",
"PresentTeachingUIEnabled")}),B.a.J(512495957,830,50,"PPTWebEditorSlideShowPackage::Present Teaching UI triggered")}catch(Ua){B.a.J(512495956,830,10,"PPTWebEditorSlideShowPackage::Exception thrown when trying to trigger Present teaching UI. Exception: {0}",Ua)}})}tsn(){this.$.resolve("PowerPointWebEditor.ISlideshowToolbar");return null}qqn(){this.$.resolve("PowerPointWebEditor.IInkButtonHelper");return null}Uqn(){this.$.resolve("PowerPointWebEditor.IOptionsButtonLoader")}usn(){this.$.resolve("PowerPointWebEditor.ISlideShowVoiceNotification");
return null}rsn(){this.$.resolve("PowerPointWebEditor.ISlideShowCameraNotification")}dispose(){}static main(){y.a.instance.Fc(new Zc)}}Object(e.a)(Zc,"PPTWebEditorSlideShowPackage",null,[3,4]);var ld=a(592),fe=a(285);class Ac{constructor(Ua){this.pTd=Ua;this.kGe=this.Gf=this.ef=this.Rb=null;this.ua=new mb.a;this.mc=!1}init(Ua,Nb){this.Gf=Ua;this.ef=Nb;this.hF()}dispose(){this.Rb&&(this.visible=!1,this.ef.jc(L.a.click,this.Rb,Object(A.a)(this,this.YBb,"onBackgroundClick")),this.Gf&&this.Rb&&(this.Gf.removeChild(this.Rb),
this.Rb=null),this.ua&&(this.ua.dispose(),this.ua=null))}hF(){this.Rb=document.createElement("div");this.Rb.className="EditingNotesDefaultView";h.AFrameworkApplication.isRtl&&(this.Rb.style.direction=Pa.a.Mwb);this.Gf.appendChild(this.Rb);this.kGe=document.createElement("p");this.kGe.className="EditingNotesDefaultViewContent";this.pTd?(this.kGe.classList.add("NotesGhostText"),this.kGe.innerText=ResourceStrings.l_NotesPaneGhostText):this.kGe.innerText=ResourceStrings.l_ClickToAddNotes;this.Rb.appendChild(this.kGe);
this.ef.Zb(L.a.click,this.Rb,Object(A.a)(this,this.YBb,"onBackgroundClick"))}YBb(Ua){this.ua.raiseEvent("OnBackgroundClick",Ua);return!0}N0h(Ua){this.ua.addHandler("OnBackgroundClick",Ua)}xo(){}get visible(){return this.mc}set visible(Ua){this.mc=Ua;this.Rb.style.display=Ua?fe.a.block:fe.a.none}get ta(){return this.Rb}}Object(e.a)(Ac,"NotesPromptView",null,[855,856,24]);class R{constructor(Ua){this.mph=this.Gf=this.Rb=null;this.poh=this.mc=!1;this.Hcn=Ua}init(Ua,Nb){Nb.qTd&&(this.Gf=Ua,this.Rb=document.createElement("div"),
this.Rb.className="EditingNotesReadOnlyView",this.Hcn&&(this.Rb.style.direction=Pa.a.Mwb),this.Gf.appendChild(this.Rb),this.mph=document.createElement("div"),this.mph.className="EditingNotesReadOnlyViewContent",Ua={},Ua.inputString=Nb.Hbd,Nb=jSanity.sanitize(Ua),this.mph.appendChild(Nb),this.Rb.appendChild(this.mph),this.poh=!0)}dispose(){this.poh&&(this.visible=!1,this.Gf&&this.Rb&&(this.Gf.removeChild(this.Rb),this.Rb=null),this.poh=!1)}get visible(){return this.mc}set visible(Ua){this.poh&&(this.mc=
Ua,this.Rb.style.display=Ua?fe.a.block:fe.a.none)}get ta(){return this.Rb}}Object(e.a)(R,"NotesReadOnlyView",null,[857,24]);var za=a(686),X=a(294),lb=a(274),oc=a(323),Oc=a(872);class sd extends za.a{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee,xe,cg,Gg,Of,ch,vg,jg,sh,Zh){super(Ua,Nb);this.kHe=this.og=this.$h=this.S4d=null;this.uBb=!1;this.jNa=Ra.App.ep;this.rJc=Object(Jb.a)(583,Nb);this.Rb=this.td.container;this.rc(this.Rb);this.ef=hc;this.Ma=Qc;this.m6d=$c;this.zHe=cf;this.gq=Hd;this.qm=$d;this.$o=
ue;this.kM=Fe;this.ob=Ee;this.Ymb=xe;this.gka=Object(Jb.a)(180,Ua);this.EGc=cg;this.fc=Gg;this.U5d=Of;this.Qza=ch;this.LH=vg;this.rf=jg;this.R5d=sh;this.Xq=Zh;this.Pnh=this.rf.Yp("formatpaintertext.cur");this.Xq&&this.LH.Pye(Object(A.a)(this,this.hcd,"onTextFPActiveChanged"));this.$h||this.hF()}dispose(){this.ef.jc(L.a.click,this.Rb.parentNode,Object(A.a)(this,this.YBb,"onBackgroundClick"));this.Xq&&this.LH.ELe(Object(A.a)(this,this.hcd,"onTextFPActiveChanged"));this.m6d&&(this.m6d.dispose(),this.m6d=
null);this.zHe&&(this.zHe.dispose(),this.zHe=null);super.dispose()}BA(Ua){super.BA(Ua);this.y2g()}wda(Ua){this.xE(this.og,Ua,-1)}T3(){this.qxh()}hF(){this.R5d&&(this.kHe=this.td.createElement("div"),this.kHe.className="NotesResizeHandle",X.c(this.kHe,!0),Sys.UI.DomElement.addCssClass(this.kHe,"NotesResizeHandle"),this.htmlElement.appendChild(this.kHe),this.Jm(this.kHe));this.S4d=this.td.createElement("div");this.S4d.className="NotesContentContainer";this.S4d.id="NotesContentContainer";this.Jm(this.S4d);
this.htmlElement.appendChild(this.S4d);this.$h=this.td.createElement("div");Sys.UI.DomElement.addCssClass(this.$h,"NotesView");Sys.UI.DomElement.addCssClass(this.$h,"NotesEditViewVisible");this.S4d.appendChild(this.$h);this.Jm(this.$h);this.og=this.td.createElement("div");Sys.UI.DomElement.addCssClass(this.og,"NotesViewContent");this.$h.appendChild(this.og);this.Jm(this.og);h.AFrameworkApplication.isRtl&&(this.$h.style.direction=Pa.a.Mwb);this.ef.Zb(L.a.click,this.Rb.parentNode,Object(A.a)(this,this.YBb,
"onBackgroundClick"));this.m6d.init(this.Rb.parentNode,this.ef);this.zHe.init(this.Rb.parentNode,this.rJc);this.qxh();this.m6d.N0h(Object(A.a)(this,this.cpn,"onDefaultViewClick"))}qxh(){if(this.rJc.qTd)this.n7a(!1),this.ZIk(!1),this.uQn();else{var Ua=this.gq.mTf(this.rJc);Ua=this.uBb||!Ua;this.n7a(Ua);this.ZIk(!Ua);this.Xq&&this.KR(sd.Ioa)}}hcd(Ua,Nb){sd.Ioa=Nb.B7c;this.KR(sd.Ioa)}KR(Ua){const Nb=this.Rb.querySelectorAll(".OutlineElement, .EditingSurfaceBody");if(2===Ua)for(this.Rb.style.cursor=ba.a.qX(this.Pnh,
fe.a.zA),this.og.style.cursor=ba.a.qX(this.Pnh,fe.a.zA),Ua=0;Ua<Nb.length;Ua++)if(Nb[Ua].style.cursor!==ba.a.qX(this.Pnh,fe.a.zA))Nb[Ua].style.cursor=ba.a.qX(this.Pnh,fe.a.sda);else break;else for(this.Rb.style.cursor=fe.a.zA,this.og.style.cursor=fe.a.zA,Ua=0;Ua<Nb.length;Ua++)Nb[Ua].style.cursor=fe.a.sda}y2g(){this.htmlElement.style.zIndex="0";const Ua=this.gq.iTa(this.rJc,this.td.yd),Nb=this.gq.Lac(this.rJc,this.td.yd);var hc=Ua.width-Nb[1]-Nb[3];0>hc&&(Nb[1]+=hc/2,Nb[3]+=hc/2);hc=Ua.height-Nb[0]-
Nb[2];0>hc&&(Nb[1]+=hc/2,Nb[3]+=hc/2);sd.tBk(this.$h,Nb);sd.tBk(this.m6d.ta,Nb);sd.tBk(this.zHe.ta,Nb);this.Qza.Rbb(new lb.a(Ua.x,Ua.y),h.AFrameworkApplication.isRtl,this.$h,!0)}gsb(){this.uBb=!0;this.IU();this.startEditing()}hsb(){this.uBb=!1;this.IU();this.endEditing()}UK(){return this.uBb}startEditing(){this.Fcc.qTd?this.ob.Rj():(this.qxh(),this.OCl()||(this.jNa=this.Fcc.FTa,this.kM.ABk(this.rJc,!1),this.kM.gWl(this.rJc)))}endEditing(){if(!this.Fcc.qTd&&(this.Ymb.setVisibility(!1),this.qxh(),!this.OCl())){this.yOl.endEditing(!0,
14);this.EGc.yBe(this.gka);var Ua=this.U5d.$xa(this.Fcc,this.jNa),Nb=!!this.Fcc&&this.Fcc.isConnected;Ua&&(Nb&&this.Fcc.ved(),this.qm.G9a(this.Fcc),this.$o.bAe(),B.a.J(507643671,812,50,"Notes edited"));this.kM.ABk(this.rJc,Nb&&this.Fcc.p9c)}}cpn(Ua,Nb){this.YBb(Nb)}YBb(){this.Ma.lm(oc.a.lsa,!0);this.n7a(!0);this.ZIk(!1);this.yOl.TR();this.cVg();this.jNa=this.Fcc.FTa;return!0}OCl(){return!this.fc.Mp}get ta(){return this.htmlElement}get Fcc(){return this.rJc}get yOl(){return this.Mc}cVg(){this.Xba(!0)}uQn(){this.zHe.visible=
!0}ZIk(Ua){this.m6d.visible=Ua}n7a(Ua){Oc.b(Ua,this.S4d,"NotesContentContainerHidden","NotesContentContainerVisible")}Xba(Ua){Oc.b(Ua,this.$h,"NotesEditViewHidden","NotesEditViewVisible")}static tBk(Ua,Nb){Ua&&(Ua.style.paddingTop=ba.a.Uc(Nb[0]),Ua.style.paddingRight=ba.a.Uc(Nb[1]),Ua.style.paddingBottom=ba.a.Uc(Nb[2]),Ua.style.paddingLeft=ba.a.Uc(Nb[3]))}static u5m(Ua){return Ua?Sys.UI.DomElement.containsCssClass(Ua,"NotesResizeHandle"):!1}}sd.Ioa=0;Object(e.a)(sd,"NotesViewElement",za.a,[858,218]);
var Ld=a(1591),Qd=a(572),Id=a(426),he=a(588),xb=a(856),Sb=a(1178),Cc=a(684),qb=a(254),Ob=a(388),Pb=a(683);class qc extends Pb.a{constructor(Ua,Nb){super(Ua,Nb);this.cta=[];this.Q$c=0}y4b(Ua,...Nb){Array.addRange(this.cta,Nb);this.Q$c=Ua}Idc(){if(this.cta)for(const Ua of this.cta)this.av.Hdc(this.container,Ua,this.Q$c);this.av.NO(this.container,this.Z7)}Wec(){this.av.lL(this.container,this.Z7);for(const Ua of this.cta)this.av.lL(this.container,Ua)}}Object(e.a)(qc,"NotesViewDomManager",Pb.a,[]);var Uc=
a(710);class pd extends Uc.ViewSelectionChangedHandler{constructor(Ua,Nb){super(Ua);this.pa=Nb}Jzb(){return[Object(A.a)(this,this.Tcc,"onSetup"),Object(A.a)(this,this.Lcc,"onEnsurePageViewElementsCreated"),Object(A.a)(this,this.Mcc,"onEnsureSelectedContentViewElementsCreated"),Object(A.a)(this,this.Pcc,"onMainLoop"),Object(A.a)(this,this.Qqn,"onNotesContentSelect"),Object(A.a)(this,this.Kcc,"onCommit"),Object(A.a)(this,this.Vcc,"onTearDown")]}Qqn(Ua,Nb){this.pda(Nb);Ua=Object(Jb.a)(583,this.Bh.Zg);
if(!Ua)return!0;Ua=Object(Jb.a)(858,Ua.tc(this.Bh.Oa));if(!Ua)return!0;this.pa.coa()?Ua.UK()||Ua.gsb():Ua.UK()&&Ua.hsb();return!0}}Object(e.a)(pd,"NotesViewSelectionChangedHandler",Uc.ViewSelectionChangedHandler,[]);var Od=a(587),be=a(308);class te extends Od.DragSelectionDragAdapter{constructor(Ua,Nb,hc,Qc,$c,Hd,$d){super(Ua,Nb,hc);this.Ir=Qc;this.GAj=Hd;this.gq=$c;this.fc=$d}ru(Ua){if(this.GAj){var Nb=this.Uec(Ua);const hc=Nb?Nb.hb:null;if(hc){const Qc=this.gq.S$a(hc)?Object(Jb.a)(583,hc):this.gq.$Pb(hc);
if(Qc&&this.gq.mTf(Qc))return!1}if(Ua.ctrlKey&&Nb&&hc&&(Nb=this.Tf.NUa(Ua.clientPoint,Nb,hc,this.Tf,!1))&&be.HyperlinkReader.$ja(Nb,!0))return!1}Ua=super.ru(Ua);null!==this.Ir&&Ua&&this.Ir.Ita(fe.a.sda);return Ua}Ut(Ua){super.Ut(Ua);null!==this.Ir&&this.Ir.JBa()}Pn(Ua){super.Pn(Ua);null!==this.Ir&&this.Ir.JBa()}LJ(Ua){return!this.Tf.isActive||Ga.a("DisableNotesViewViewingModeSelection")&&!this.fc.Mp?!1:super.LJ(Ua)}static fId(Ua){return new te(Ua,l.a.instance.resolve("Common.IActionManagerExtended"),
l.a.instance.resolve("Common.IActivityManager"),l.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").dFa?l.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,l.a.instance.resolve("PowerPointWebEditor.Graph.INotesReader"),l.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").Lfe,l.a.instance.resolve("PowerPointWebEditor.Core.IUnifiedAppState"))}}Object(e.a)(te,"NotesDragSelectionDragAdapter",Od.DragSelectionDragAdapter,[]);var Le=a(400),
kf=a(279);class fg{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee){this.GKl=this.Iad=this.PHl=this.mKj=this.zab=0;this.tpa=this.Nnb=this.Noh=null;this.n0f=this.fHl=this.Ioh=0;this.JDj=!1;this.gka=Ua;this.SB=Nb;this.ij=hc;this.Db=Qc;this.wO=$c;this.If=Hd;this.oc=$d;this.Lc=ue;this.Mb=Fe;cf.IXa(Object(A.a)(this,this.Ebe,"onOutboundReplication"));this.ia=Ee}vv(Ua){return Ua&&Ua.cD!==Sys.UI.MouseButton.rightButton?sd.u5m(Ua.Dc):!1}ru(Ua){if(!this.vv(Ua))return!1;this.JDj=!0;this.Noh=this.wO.ta;if(!this.Noh)return!1;
this.tpa=this.Lc.Yc;if(this.tpa&&(this.Nnb=this.If.ta))this.PHl=this.Nnb.clientHeight;else return!1;this.Ioh=Math.floor(.75*(this.Noh.clientHeight+this.Nnb.clientHeight));this.mKj=this.Noh.clientHeight;this.Iad=this.zab=Ua.clientPoint.y;this.GKl=this.tpa.WK;this.SB.$k(7);this.gka.endEditing(!0,14);return!0}Bv(Ua){if(!Ua)return!1;this.zab=Ua.clientPoint.y;Ua=this.Qil(this.zab);this.wO.Opa=Ua;this.Db.ls();Object(Ga.a)("FixNotesPaneDragIssue")||(Ua=this.PHl+this.mKj-Ua,this.Nnb.style.height=Ua+"px",
this.tpa.N2l(Ua-1),this.tpa.Awh(this.GKl));return!0}Pn(Ua){this.SB.zS();this.gka.TR();this.n0f=this.Qil(Ua?Ua.clientPoint.y:this.zab);this.ia.Qa(va.a.dRg,2,this.n0f)}Ut(){this.JDj&&(this.JDj=!1,this.Pn(null))}Ebe(){this.n0f!==this.fHl&&2===Ra.App.Vb.mode&&(this.fHl=this.n0f,this.Ntn(this.n0f))}Ntn(Ua){const Nb=this.oc.jn,hc=this.Mb.Fd(4);try{hc.rc(Nb),Nb.UBb=4320,Nb.Opa=this.ewm(Ua)}finally{hc&&hc.dispose()}}Qil(Ua){Ua=this.mKj+this.ij.Nr(this.Iad-Ua);0<this.Ioh&&Ua>this.Ioh?Ua=this.Ioh:Ua<Le.a.mJa&&
Ua>kf.a.RCd?Ua=Le.a.mJa:Ua<kf.a.RCd&&(Ua=kf.a.Yeh);return Ua}ewm(Ua){return this.ij.lJe(Ua,1)}static fId(Ua){return new fg(Ua,l.a.instance.resolve("Common.CursorManager"),l.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),l.a.instance.resolve("Box4.IAppFrame"),l.a.instance.resolve("PowerPointWebEditor.INotesPane"),l.a.instance.resolve("PowerPointWebEditor.ISlidePane"),l.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),l.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
l.a.instance.resolve("Common.Transaction.ITransactionFactory"),l.a.instance.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),l.a.instance.resolve("Common.IActionManagerExtended"))}}Object(e.a)(fg,"NotesResizeDragAdapter",null,[156]);class pe extends Qd.a{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee,xe,cg,Gg){super(oc.a.lsa,Ua,Nb,hc,Qc,$c,$d,ue,xe);this.QHj=!1;this.$qb=Hd;this.fc=Fe;this.Lg=cf;this.sO=Ee;this.GAj=cg;this.Xq=Gg}get wud(){return h.AFrameworkApplication.ga}OB(Ua,Nb=null){this.Xq&&
this.Lg.Zb(L.a.JU,this.container,Object(A.a)(this,this.mIe,"mouseUpHandlerFilter"));super.OB(Ua,Nb);(Ua=Object(Jb.a)(583,Ua))&&Ua.qTd&&this.Pg&&this.Pg.$n&&this.Pg.$n.setAttribute("aria-readonly","true")}detach(){this.Xq&&this.Lp&&this.Lg.jc(L.a.JU,this.container,Object(A.a)(this,this.mIe,"mouseUpHandlerFilter"));super.detach()}z$b(Ua,Nb){return new qc(Ua,Nb)}Osa(Ua){Ua=super.Osa(Ua);Ua.Z7=te.fId(this);Ua.y4b(1,fg.fId(this));return Ua}rta(Ua){this.h3c=Ua.yg;if(!this.Gdc||this.isActive||!this.GAj||
(Ua.Sb.type===L.a.mouseDown||Ua.Sb.type===L.a.v9a)&&Ua.cD!==Sys.UI.MouseButton.leftButton)return!1;var Nb=Ua.Dc;if(Nb&&Sys.UI.DomElement.containsCssClass(Nb,"NotesResizeHandle"))return!1;let hc=!1;Qd.a.S9&&(hc=Qd.a.S9.wsa());Ra.App.gF.lX&&Ra.App.gF.lX.bMe(Qc=>{Qc&&(hc=!0)});Nb=!Ga.a("DeprecateIE.NotesView")&&hc&&v.a.k8;Ua=new xb.a(Ua,this,!0,Nb);this.dBn(Ua);return!1}dBn(Ua){this.CKe();this.Cka(v.a.zg||v.a.vTa);this.Js.raiseEvent(Qd.a.l9c,new Sb.a(Ua.graphNode));this.u7c(Ua.graphNode);this.tPe();
const Nb=[Object(A.a)(this,this.bXj,"noneClickHandler"),Object(A.a)(this,this.gnn,"notesSnapToContentClickHandler"),Object(A.a)(this,this.enn,"notesDefaultClickHandler")];for(const hc of Nb)if(hc(Ua).l3){this.QHj=!0;break}}mIe(){return this.QHj&&this.sO.CTa?(this.ya.Cb(qb.a.uca,2),!0):this.QHj=!1}enn(Ua){const Nb=Qd.a.fd.Ao(qb.a.DLb);Nb.properties.K(Ld.a.source,"DefaultClickHandler");this.A7(Ua.oZ,Ua.Zq,Ua.graphNode,Ua.Mc,Ua.$g.shiftKey,Ua.$g.ctrlKey,Ua.$g.yg);Nb.end();Ua.MOb&&this.Cka(!0);this.editingView.Jmb(Ua.$g.shiftKey,
Ua.oZ,Ua.$g.yg);return Id.a.Xk(!0)}gnn(Ua){if(!Ua.Zq){const Nb=Ua.Zq,hc=Ua.graphNode,Qc=Qd.a.fd.Ao(qb.a.DLb);Qc.properties.K(Ld.a.source,"SnapToContentClickHandler");this.A7(Ua.oZ,Nb,hc,this,Ua.$g.shiftKey,Ua.$g.ctrlKey,Ua.$g.yg);Qc.end();Ua.MOb&&this.Cka(!0);this.editingView.Jmb(Ua.$g.shiftKey,Ua.oZ,Ua.$g.yg);return Id.a.Xk(!0)}return Id.a.notHandled}KOa(){super.KOa();this.Pg&&this.Pg.$n&&(this.wud.getBooleanAppSetting("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.Pg.pec(Yb.a.kvd):this.Pg.CMe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,
"",Yb.a.kvd),this.Pg.$n.setAttribute(Yb.a.yz,ResourceStrings.l_NotesPane))}hfd(){this.hC.Jd===this&&this.suspend()}Qdd(){this.hC.Jd===this&&this.resume()}u8c(){return new pd(this,l.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"))}U7c(){return[Object(A.a)(this,this.bXj,"noneClickHandler"),Object(A.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(A.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(A.a)(this,this.defaultClickHandler,"defaultClickHandler")]}b8c(){return[Object(A.a)(this,
this.bXj,"noneClickHandler"),Object(A.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}bXj(Ua){return this.NBc(Ua)||this.v5m()?Id.a.Xk(!0):Id.a.notHandled}Y7c(){return[Object(A.a)(this,this.noContextMenuHandler,"noContextMenuHandler"),Object(A.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(A.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}rCa(Ua){this.NBc(Ua)||super.rCa(Ua)}noContextMenuHandler(Ua){return this.NBc(Ua)?
he.a.Xk(null):he.a.notHandled}NBc(Ua){return!!Ua&&!!Ua.graphNode&&60===Ua.graphNode.type&&Ua.graphNode.qTd}v5m(){return!this.fc.Mp}r$a(){return Cc.a.gIe}get IJ(){return super.IJ|96}get Aec(){return!0}xDm(Ua){var Nb,hc,Qc;if(Ga.a("LogPasteSlideStepTime")){var $c=null===jb.a||void 0===jb.a?void 0:jb.a.bN("PasteSlideShimmerStage","T2Ended");if(0<(null===$c||void 0===$c?void 0:$c.length)||(null===(Nb=this.ya)||void 0===Nb?0:Nb.Bz(va.a.fE)))Ua.eeh=va.a.fE,(null===(hc=this.wud)||void 0===hc?0:hc.getBooleanAppSetting("EnableFastRenderForPasteSlide"))&&
Ga.a("DelayNotesViewValidateForPasteSlide")&&(Ua.ati=!0)}else Ga.a("LogCutSlideStepTime")&&(null===($c=this.ya)||void 0===$c?0:$c.Bz(va.a.tsa))&&(Ua.eeh=va.a.tsa,(null===(Qc=this.wud)||void 0===Qc?0:Qc.getBooleanAppSetting("EnableFastRenderForCutSlide"))&&Ga.a("DelayNotesViewValidateForCutSlide")&&(Ua.ati=!0))}xda(Ua,Nb,hc=null){if(this.$qb.hN(this)){var Qc={eeh:0,ati:!1};this.xDm(Qc);const $c=(null===Qc||void 0===Qc?0:Qc.eeh)?new Ob.a("NotesView::validateAsynchronous",Qc.eeh):void 0;null===$c||void 0===
$c?void 0:$c.Cf("ST");(null===Qc||void 0===Qc?0:Qc.ati)?(Qc=new dd.a(1,1,0,()=>{super.xda(Ua,Nb,hc)},223),h.AFrameworkApplication.je.Qb(Qc)):super.xda(Ua,Nb,hc);null===$c||void 0===$c?void 0:$c.Cf("ET");null===$c||void 0===$c?void 0:$c.BM()}}}Object(e.a)(pe,"NotesView",Qd.a,[845,853,181,145,24,180,182,183,184,185]);var me=a(685),Ke=a(887),Ie=a(372);class Ef{constructor(Ua,Nb,hc,Qc){this.zKl=null;this.jcc=Ua;this.va=Nb;this.Nq=hc;this.S5f=Qc}h2m(){this.zKl=new me.a(Ie.App.rJb.wOl,"EditingNotesPanel",
"EditingNotesPanel InteractiveView");this.jcc.aIa(this.zKl.$ta);Ke.a.wdh(this.jcc);this.hhl(this.va.Ga);this.Nq.kel(Object(A.a)(this,this.kPl,"onAttachNotesView"))}kPl(Ua,Nb){this.fHm();this.hhl(Nb.zd)}hhl(Ua){this.va.presentation&&Ua&&Ua.isConnected&&(Ua=this.S5f.shh(Ua,27),this.jcc.OB(Ua))}fHm(){this.jcc.Lp&&(this.jcc.editingView.disable(!0,14),this.jcc.detach())}dispose(){this.Nq.BYl(Object(A.a)(this,this.kPl,"onAttachNotesView"))}}Object(e.a)(Ef,"NotesViewHelper",null,[24]);var We=a(1349),Ae=
a(275);class se{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee,xe,cg){var Gg;this.fh=this.VHl=!1;this.zi=null;this.wO=Qc;this.jcc=$c;this.ia=Ua;this.uc=Nb;this.Ma=hc;this.eW=ue;this.$b=Hd;this.va=$d;this.Lc=Fe;this.Db=cf;this.SEa=Ee;this.xb=xe;this.VHl=null!==(Gg=null===cg||void 0===cg?void 0:cg.getBooleanAppSetting("EnableShowHideNotesOptimization"))&&void 0!==Gg?Gg:!1;this.fh=cg.getBooleanAppSetting(Ae.a.tI)}Hb(){Ga.a("DelayRegisterShowHideNotesCommand")&&!this.$b.Qf?(this.zi=l.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.zi.QJb(Object(A.a)(this,this.aYl,"registerShowHideNotesCommand"))):this.ia.za(va.a.zQa,gb.a.application,Object(A.a)(this,this.zQa,"showHideNotes"));this.ia.sa(va.a.ddd,gb.a.application,Object(A.a)(this,this.GBn,"queryNotesPaneState"),96);this.ia.sa(va.a.RJe,gb.a.application,Object(A.a)(this,this.HSl,"pageScrollNotesPane"),64);this.ia.sa(va.a.QJe,gb.a.application,Object(A.a)(this,this.HSl,"pageScrollNotesPane"),64);this.ia.za(va.a.dRg,gb.a.application,Object(A.a)(this,this.fnn,"notesResize"))}ve(){const Ua=
this.Ma.gd(oc.a.lsa);Ua.bindAction($b.a.eb(K.a.CG,0),va.a.RJe);Ua.bindAction($b.a.eb(K.a.BG,0),va.a.QJe)}aYl(){this.zi.S4b(Object(A.a)(this,this.aYl,"registerShowHideNotesCommand"));this.ia.za(va.a.zQa,gb.a.application,Object(A.a)(this,this.zQa,"showHideNotes"))}zQa(Ua,Nb,hc,Qc,$c){if(this.xb&&0!==this.xb.Ri)return 2;Ua=this.$b.Qf;if(!this.va.Ga||!Ua||this.uc.cN(Ua))return 16;if(1===hc)return 32;$c&&Object(Cb.a)(We.a,$c)?$c.Bec?this.wO.qNe():this.wO.izl():(this.wO.$Rl(),this.VHl||(this.wO.Gnc()&&
this.jcc.Lp?this.Ma.lm(oc.a.lsa,!0):this.Ma.lm(oc.a.lsa,!1)));this.eW.gkb();return 32}GBn(Ua,Nb,hc,Qc,$c){if(!$c||!Object(Cb.a)(bb.a,$c))return 8;$c.xg(this.wO.Gnc());return 32}HSl(Ua,Nb,hc){return 1===hc?32:this.wO?(Ua===va.a.QJe?this.wO.ta.scrollTop+=se.Eil:Ua===va.a.RJe&&(this.wO.ta.scrollTop-=se.Eil),32):8}fnn(Ua,Nb,hc,Qc,$c){var Hd;B.a.J(508052502,822,50,"Notes Resize Begin");if(!this.wO||!$c||"number"!==typeof $c)return B.a.J(508052501,822,50,"Notes Resize Fail"),8;this.wO.Opa=$c;null===(Hd=
this.Lc.Yc)||void 0===Hd?void 0:Hd.SMe(1);this.Db.ls();this.fh||this.SEa.Yzh();B.a.J(508052500,822,50,"Notes Resize Success, Notes status:{0}, Notes Height:{1}",this.wO.vOl?"On":"Off",this.wO.Opa);return 32}}se.Eil=80;Object(e.a)(se,"NotesActor",null,[743]);class pf{constructor(){this.$=null}get name(){return"PowerPointWebEditor.Notes"}lc(Ua){this.$=Ua;this.$.register(845,"PowerPointWebEditor.INotesView").ma().na(()=>new pe(this.$.resolve("Box4.IWorkspace"),this.$.resolve("Box4.IInteractiveViewManager"),
()=>this.$.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Box4.IHtmlViewRootFactory"),this.$.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.$.resolve("Box4.IInteractiveEventNotifier"),this.$.Na("Box4.ITextMetricsAdapter"),this.$.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.$.resolve("Common.MouseInputManager"),this.$.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.$.resolve("Box4.IRotatingCoordinateConverter"),
this.$.resolve("PowerPointWebEditor.IApplicationSettings").Lfe,this.$.resolve("PowerPointWebEditor.IApplicationSettings").CR));this.$.register(Ef,"PowerPointWebEditor.Notes.NotesViewHelper").ma().na(()=>new Ef(this.$.resolve("PowerPointWebEditor.INotesView"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.$.resolve("PowerPointWebEditor.Graph.IGraphNodeHelper")))}init(){this.$.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393326,
new ld.a((Nb,hc)=>Object(Cb.a)(845,Nb)?new sd(Nb,hc,this.$.resolve("Common.IClickInputManager"),this.$.resolve("PowerPointWebEditor.IFocusManager"),new Ac(this.$.resolve("PowerPointWebEditor.IApplicationSettings").getBooleanAppSetting(Ae.a.X6c)),this.$.resolve("PowerPointWebEditor.Graph.INotesReader"),this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.$.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.$.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),
new R(h.AFrameworkApplication.isRtl),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("Box4.IGrippersManager"),this.$.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.$.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.$.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),this.$.resolve("PowerPointWebEditor.ViewCore.IPPTPositionEditor"),this.$.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),this.$.resolve("PowerPoint.IPathManager"),
this.$.resolve("PowerPointWebEditor.IApplicationSettings").Lsh,this.$.resolve("PowerPointWebEditor.IApplicationSettings").CR):null));this.$.resolve("Box4.IEditingView");this.$.resolve("PowerPointWebEditor.Notes.NotesViewHelper").h2m();const Ua=c();Ua.Hb();Ua.ve()}dispose(){this.$.resolve("PowerPointWebEditor.Notes.NotesViewHelper").dispose()}static main(){y.a.instance.Fc(new pf)}}Object(e.a)(pf,"PPTWebEditorNotesPackage",null,[3,4]);var eg=a(337);class pg{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf){this.tKl=
new z.a;this.NLl=null;this.$b=Qc;this.va=$c;this.Ma=hc;this.$sa=$d;this.dVb=ue;this.kA=Hd;this.pa=Nb;this.la=Fe;this.Nq=Ua;this.kd=cf;this.la.wDl&&(this.pa&&this.pa.QM(Object(A.a)(this,this.QH,"onSelectionChanged")),ue&&ue.VXl(this),this.Nq.C4c(Object(A.a)(this,this.lW,"onFocusChanged")),this.kd.N1h(Object(A.a)(this,this.vzg,"onShapeViewElementUnlocked")),this.kd.Cfl(Object(A.a)(this,this.WRl,"onThumbnailsSetFakeImage")),this.kd.Dfl(Object(A.a)(this,this.XRl,"onThumbnailsSetFocus")),this.kd.Efl(Object(A.a)(this,
this.YRl,"onThumbnailsSetSelected")),this.la.lSf&&this.Nq.bfl(Object(A.a)(this,this.JRl,"onSlideshowNavigationToolbarClickedHandler")),this.la.Rh&&this.Nq.afl(Object(A.a)(this,this.IRl,"onSlideshowContextMenuFocusedHandler")))}dispose(){this.Nq.Edd(Object(A.a)(this,this.lW,"onFocusChanged"));this.Nq.FYl(Object(A.a)(this,this.epn,"onDesignerClickSuggestion"));this.kd.ppk(Object(A.a)(this,this.vzg,"onShapeViewElementUnlocked"));this.kd.BZl(Object(A.a)(this,this.WRl,"onThumbnailsSetFakeImage"));this.kd.CZl(Object(A.a)(this,
this.XRl,"onThumbnailsSetFocus"));this.kd.DZl(Object(A.a)(this,this.YRl,"onThumbnailsSetSelected"));this.la.lSf&&this.Nq.gZl(Object(A.a)(this,this.JRl,"onSlideshowNavigationToolbarClickedHandler"));this.la.Rh&&this.Nq.fZl(Object(A.a)(this,this.IRl,"onSlideshowContextMenuFocusedHandler"))}QH(Ua,Nb){if(Nb&&Nb.Ok&&this.pa.D5(Nb.Ok))try{this.hXm(Nb.Ok)}catch(hc){Ua=String.format("AriaManager failed to handle the select changed event. Message: {0}. Stack: {1}",hc.message,hc.stack),B.a.J(508694669,822,
10,Ua)}}hXm(Ua){var Nb=this.pa.Ae();if(1===Ua.length||1===Nb.length&&Nb[0].wg){if(Ua=this.pa.lo()){Nb=new z.a;let hc=this.fwl(Ua,Nb,Object(A.a)(this,this.dTm,"getShapeName"));hc||Nb.count||(hc=this.dVb.pVi(Ua,Nb));!hc&&Ua.get_smartArtModelId()?hc=ResourceStrings.l_AccMessageSmartArtSubIcon:O.a.rb(hc)||(hc+=ResourceStrings.L_ShapeSelected);const Qc=this.dVb.ywl(Ua);({bhl:hc,x2k:Nb}=this.Fgl(Qc,hc,Nb));!Ua.xF&&Ua.isUnread&&({bhl:hc,x2k:Nb}=this.Fgl(this.dVb.zwl(Ua,this.NLl),hc,Nb));0<Nb.count?this.fXl(Nb):
this.JCb(hc||"")}}else 1<Ua.length&&(Ua=this.dVb.yvl(this.pa.ud()),this.JCb(Ua||""))}Fgl(Ua,Nb,hc){Ua&&(hc.count?hc.add(document.createTextNode(Ua)):Nb=String.format(ResourceStrings.l_ShapeAndPresenceInfo,Nb,Ua));return{bhl:Nb,x2k:hc}}lW(Ua,Nb){Nb=Nb.SBb;if(Nb===oc.a.rP||Nb===cc.a.kh){Ua=this.va.Ga;let hc=null;Nb===oc.a.rP?hc=(Ua=this.$b.rfd.Ilh)?String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.n8c()+this.dVb.tih(Ua)):String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.n8c()):
Nb!==cc.a.kh||!this.pa.Rt()&&this.pa.v5()||(this.kA&&this.kA.value&&(Nb=this.kA.value.Jd)&&Ua&&Nb.Vo&&eg.e(Ua,Nb.Oa),hc=this.dVb.Fwl());this.JCb(hc||"")}}setAttribute(Ua,Nb,hc){Ua&&Yb.a.Uia(Ua,Nb,hc)}Q3(Ua){this.tKl.add(Ua)}fwl(Ua,Nb,hc=null){try{if(Ua&&this.Ma)for(const Qc of this.tKl)if(Qc){const $c=Qc(Ua,this.Ma.currentScope?this.Ma.currentScope.name:null,Nb,hc);if($c||Nb&&0<Nb.count)return $c}}catch(Qc){Ua=String.format("AriaManager failed to get provider message. Message: {0}. Stack: {1}",Qc.message,
Qc.stack),B.a.J(508694667,822,10,Ua)}return null}fXl(Ua){if(this.$sa&&this.$sa.value){const Nb=this.$sa.value.ivl(!0);if(Nb&&Ua&&0<Ua.count){Nb.firstChild&&Nb.removeChild(Nb.firstChild);const hc=document.createElement("p");for(const Qc of Ua)hc.appendChild(Qc);Nb.appendChild(hc)}}}rik(Ua,Nb){if(Ua){const hc=new z.a;let Qc=this.fwl(Ua,hc);Qc||hc.count||(Qc=this.dVb.pVi(Ua,hc));0<hc.count?(Nb&&hc.add(document.createTextNode(Nb)),this.fXl(hc)):(Nb&&(Qc+=" "+Nb),this.JCb(Qc||""))}}JCb(Ua){this.$sa&&this.$sa.value&&
this.$sa.value.H8(Ua,!0)}vzg(Ua,Nb){Nb.presenceUser&&Nb.xDl&&this.JCb(String.format(ResourceStrings.L_EditorLeavingHint,Nb.presenceUser.userName))}epn(Ua,Nb){this.JCb(this.dVb.tul(Nb.MJn,Nb.fTn))}WRl(Ua,Nb){this.setAttribute(Nb.pxb.image,Yb.a.pi,Yb.a.q9a)}XRl(Ua,Nb){Nb.hasFocus&&Nb.pxb.isSelected&&this.JCb(this.n8c()+this.dVb.tih(Nb.pxb));this.setAttribute(Nb.pxb.Xre,Yb.a.qKb,Nb.hasFocus&&Nb.pxb.isSelected?"true":"false")}YRl(Ua,Nb){Nb.pxb.isSelected&&Nb.hasFocus?this.JCb(this.n8c()+this.dVb.tih(Nb.pxb)):
Nb.pxb.isSelected||this.JCb(this.n8c());this.setAttribute(Nb.pxb.Xre,Yb.a.qKb,Nb.pxb.isSelected?"true":"false")}JRl(Ua,Nb){this.JCb(Nb.text)}dTm(Ua){this.NLl=Ua||ResourceStrings.l_Object}IRl(Ua,Nb){this.JCb(Nb.text)}n8c(){let Ua="";const Nb=this.pa.mg();Nb&&1<Nb.length&&(Nb.sort((hc,Qc)=>hc.ph-Qc.ph),this.pKb(Nb)&&(Ua=this.dVb.n8c(Nb[0].ph+1,Nb[Nb.length-1].ph+1)));return Ua}pKb(Ua){if(!Ua||1>=Ua.length)return!1;const Nb=Ua.length;return Ua[Nb-1].ph-Ua[0].ph+1===Nb?!0:!1}}Object(e.a)(pg,"AriaManager",
null,[746,24]);var ne=a(1350);class sf{constructor(){this.$=null}get name(){return"PowerPointWebEditor.Aria"}lc(Ua){this.$=Ua;this.$.register(745,"PowerPointWebEditor.IAriaMessageHelper").ma().na(()=>new ne.a(this.$.Na("PowerpointPresence.IPresenceUserManager"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("PowerPointWebEditor.Graph.INotesReader"),this.$.Na("PowerPointWebEditor.Graph.ICommentReader"),this.$.Na("PowerPointWebEditor.IAppForOfficeManager"),
this.$.ge("PowerPointWebEditor.IAppforOfficeClassFactory"),this.$.resolve("Box4.IParagraphReader"),this.$.resolve("PowerPointWebEditor.IApplicationSettings")));this.$.register(746,"PowerPointWebEditor.IAriaManager").ma().na(()=>new pg(this.$.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("PowerPointWebEditor.IPPTWorkspace"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.$.ge("Box4.IInteractiveViewManager"),this.$.ge("Common.Utils.IAriaNotifier"),this.$.resolve("PowerPointWebEditor.IAriaMessageHelper"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}init(){this.$.resolve("PowerPointWebEditor.IAriaManager")}dispose(){this.$.resolve("PowerPointWebEditor.IAriaManager").dispose()}static main(){y.a.instance.Fc(new sf)}}Object(e.a)(sf,"PptAriaPackage",null,[3,4]);var Ye=a(1233),
Yd=a(1151),Lg=a(261),Yg=a(298),Ng=a(252);class df{constructor(Ua,Nb,hc){this.aPh=this.Npd=this.YOh=this.Mpd=this.RMh=null;this.IK=Ua;this.ihm=Nb;this.Nc=hc;this.init()}init(){this.ihm.Zb(Object(A.a)(this,this.hWm,"handleEditingViewUpdatesSafe"));this.Mpd=new Ye.a;this.YOh=new Ye.a;this.Npd=new Ye.a;this.aPh=new Yd.a}Y5a(Ua){this.Mpd.add(Ua.key,Ua)}nLe(Ua){this.Npd.add(Ua.key,Ua)}hWm(Ua){try{this.gWm(Ua)}catch(Nb){Ua=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",
Nb.message,Nb.stack),C.ULS.sendTraceTag(5285580,334,10,Ua)}}gWm(Ua){let Nb;({xri:Nb}=df.RVn(this.Nc.Ua.mb)).returnValue&&(Ua=df.gNm(Ua,this.RMh,Nb),this.TAn(Ua,Nb),this.RMh=Nb)}TAn(Ua,Nb){Ua=this.GLm(Ua,Nb);let hc;({notification:hc}=df.PVn(Ua)).returnValue&&this.IK.H8(hc,!1)}GLm(Ua,Nb){const hc=new Ye.a;hc.K(1,new Yd.a);hc.K(0,new Yd.a);Ua.forEach(Qc=>{3===Qc?(Yg.ImageReader.yI(Nb.node)||this.AHn(Nb),this.nRm(hc,Nb)):0===Qc&&this.vNm(hc,Nb);return!0});return hc}AHn(Ua){this.Mpd.forEach((Nb,hc)=>{hc.reset(Ua);
return!0})}vNm(Ua,Nb){let hc=new Ye.a;Yg.ImageReader.yI(Nb.node)||(hc=this.tNm(Nb.Va));this.uNm(Ua,this.YOh,hc,df.x1l(this.RMh,Nb));this.YOh=hc}tNm(Ua){const Nb=new Ye.a;this.Mpd.forEach((hc,Qc)=>{hc=null;({EXa:hc}=Qc.e0c(Ua)).returnValue&&Nb.K(Qc.key,hc);return!0});return Nb}uNm(Ua,Nb,hc,Qc){const $c=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;Nb.forEach((Hd,$d)=>{const ue=this.Mpd.ha(Hd).Eja||$d.title;let Fe;({value:Fe}=hc.Uh(Hd)).returnValue?Qc&&Fe.dS!==$d.dS&&(ue&&Ua.ha(1).add(ue),Hd=
this.Mpd.ha(Hd).Eja,Hd=String.format($c,Fe.title,Hd),Fe.description&&(Hd+=", "+Fe.description),Ua.ha(0).add(Hd)):ue&&Ua.ha(1).add(ue);return!0});hc.forEach((Hd,$d)=>{Nb.Ob(Hd)||(Hd=this.Mpd.ha(Hd).Eja,Hd=String.format($c,$d.title,Hd),$d.description&&(Hd+=", "+$d.description),Ua.ha(0).add(Hd));return!0})}nRm(Ua,Nb){Nb=this.MTm(Nb.node);Nb=this.oym(Nb);this.NTm(Ua,this.aPh,Nb);this.aPh=Nb}MTm(Ua){const Nb=new Ng.GraphIterator;Nb.set(Ua);if(!Nb.pc(1))return null;const hc=new Yd.a;for(;1!==Nb.ki;)this.Npd.forEach((Qc,
$c)=>{let Hd;({Hzb:Hd}=$c.HOe(Nb)).returnValue&&hc.add(Hd);return!0}),Nb.wc();hc.reverse();return hc}oym(Ua){Ua=Ua.toArray();let Nb=0;for(;Nb<Ua.length-1;){var hc=Ua[Nb];if(hc.fda===Ua[Nb+1].fda&&(this.Npd.ha(hc.fda),({pym:hc}={returnValue:!1,pym:null}).returnValue)){Ua.splice(Nb,2,hc);continue}Nb++}return new Yd.a(Ua)}NTm(Ua,Nb,hc){var Qc;for(Qc=0;Qc<Math.min(hc.length,Nb.length)&&hc.ha(Qc).contentId.equals(Nb.ha(Qc).contentId);Qc++){var $c=this.Npd.ha(hc.ha(Qc).fda).VGd(hc.ha(Qc),Nb.ha(Qc));$c&&
(hc.ha(Qc).description&&($c+=", "+hc.ha(Qc).description),Ua.ha(0).add($c))}for($c=Qc;$c<hc.length;$c++){let Hd=this.Npd.ha(hc.ha($c).fda).VGd(hc.ha($c),null);Hd&&(hc.ha($c).description&&(Hd+=", "+hc.ha($c).description),Ua.ha(0).add(Hd))}for(hc=Qc;hc<Nb.length;hc++)(Qc=this.Npd.ha(Nb.ha(hc).fda).Eja)&&Ua.ha(1).add(Qc)}static gNm(Ua,Nb,hc){const Qc=new Yd.a;(Ua=Ua||df.PJn(Nb,hc))?(Qc.add(3),Qc.add(0)):df.x1l(Nb,hc)&&Qc.add(0);return Qc}static PJn(Ua,Nb){return!Ua||!Ua.node.id.equals(Nb.node.id)}static x1l(Ua,
Nb){return!Ua||!Ua.equals(Nb)}static RVn(Ua){let Nb;Nb=null;if(!Ua||!(Lg.SelectionEditor.Bx(Ua)||(Ua=Lg.SelectionEditor.fm(Ua,!0,!1),Lg.SelectionEditor.Bx(Ua)||Ua.Xa&&Yg.ImageReader.yI(Ua.Xa.node))))return{returnValue:!1,xri:Nb};Nb=Ua.Xa;return{returnValue:!!Nb,xri:Nb}}static PVn(Ua){const Nb=new Yd.a;Ua.ha(1).forEach(hc=>{hc=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,hc);Nb.add(hc);return!0});Ua.ha(0).forEach(hc=>{hc=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,
hc);Nb.add(hc);return!0});Ua=Nb.toArray().join(" ");return{returnValue:0<Nb.length,notification:Ua}}}Object(e.a)(df,"AccessibilityContextManager",null,[762]);class Pg{constructor(Ua,Nb){this.q8k=!1;this.J5e=null;this.u$g=this.eah=!1;this.l6k=null;this.kud=(hc,Qc)=>{(Qc.IM||Qc.G8)&&this.lnn(Qc.IM,Qc.G8)};this.ze=Ua;this.Y8=Nb}get qYm(){return!!this.J5e}Zb(Ua){this.q8k||(this.Y8.Qah(this.kud),this.q8k=!0);this.l6k=Ua}lnn(Ua,Nb){this.qYm&&this.ze.li(this.J5e);this.eah=this.eah||Ua;this.u$g=this.u$g||
Nb;this.J5e=new dd.a(4,1,Pg.rHm,()=>{this.l6k(this.eah,this.u$g);this.reset()},126);this.ze.Qb(this.J5e)}reset(){this.J5e=null;this.u$g=this.eah=!1}}Pg.rHm=100;Object(e.a)(Pg,"EditingViewOnAfterValidateEventsConsolidator",null,[761]);var ig=a(276);class ji{constructor(){this.Ha=null}get name(){return"Box4.Accessibility"}init(){Ra.App.Qbh&&this.Ha.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}lc(Ua){this.Ha=Ua;Ua.register(Pg,"Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator").as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ma().na(()=>
new Pg(h.AFrameworkApplication.je,Ua.resolve("Box4.ContentEditableViewEventSource")));Ua.register(df,"Box4.Accessibility.AccessibilityContextManager").as("Box4.Accessibility.IAccessibilityContextManager").ma().na(()=>new df(Ua.resolve("Common.Utils.IAriaNotifier"),Ua.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),ig.a.instance))}static main(){y.a.instance.Fc(new ji)}}Object(e.a)(ji,"Box4AccessibilityPackage",null,[3,4]);var Ca=a(154),cb=a(73),Eb=a(860);class fc{constructor(Ua){this.rf=
Ua}Eni(Ua,Nb,hc,Qc,$c,Hd){const $d=this.rf.Yp(hc+".png");hc=ub.e(hc,Qc);return ub.c(Ua,Nb,hc,$d,32===Ua&&32===Nb?"cui-img-cont-float cui-img-32by32":"cui-img-cont-float cui-img-16by16","",!1,$c,null,Hd)}}Object(e.a)(fc,"ShapeGlyphImageFactory",null,[741]);var Ec=a(1123);class Ya{constructor(Ua,Nb){this.Nnh=this.r2a=null;this.gDj=this.lKl=0;this.Qi=Ua;this.Lc=Nb}dispose(){this.clear();this.r2a.parentNode.removeChild(this.r2a)}add(Ua,Nb){this.$zk(!1);Ua=this.Gom(Ua,Nb);this.B4m()||this.B6m(Ua)?this.Zzk(-1*
(Math.ceil(Ua.offsetWidth)+2)):this.Zzk(this.gDj);this.$zk(!0)}clear(){this.Qi.wx(this.Nnh);this.$zk(!1);this.Zzk(0)}LKb(Ua,Nb,hc){this.lKl=hc;this.gDj=Nb;this.r2a=this.Qi.hg();this.r2a.className="prFlyout UISmallFont";Ua.appendChild(this.r2a);this.Nnh=this.Qi.jrc();this.r2a.appendChild(this.Nnh)}Gom(Ua,Nb){const hc=this.Qi.hoi();hc.style.backgroundColor=Ua;hc.style.lineHeight=this.Qi.Uc(this.lKl);this.Qi.SA(hc,Nb);this.Nnh.appendChild(hc);return hc}B6m(Ua){Ua=this.Qi.Ni(Ua,this.Lc.Yc.rr);const Nb=
this.Qi.Ni(this.Lc.Yc.rr,this.Lc.Yc.rr);return Ua.x+Ua.width+this.gDj>Nb.x+Nb.width}B4m(){return 0>this.Qi.Vn(this.r2a.style.left)}$zk(Ua){this.r2a.style.visibility=Ua?fe.a.visible:fe.a.hidden}Zzk(Ua){this.r2a.style.left=this.Qi.Uc(Ua)}}Object(e.a)(Ya,"ShapePawnFlyout",null,[773]);var Ub=a(1348),rc=a(1536),fd=a(1638),Cd=a(563),Jd=a(305);class Rd{constructor(Ua,Nb,hc,Qc,$c){this.Mff=1;this.Klg=[];this.CYd=null;this.A1f=this.uHe=!1;this.Sad=this.eo=this.rS=null;(this.A3=h.AFrameworkApplication.ga.getBooleanAppSetting(Ae.a.itb))?
(this.eo=Ua,this.Sad=$c,this.HBm()):this.gN=Object(Jb.a)(Ec.a,Qc.Ypi(Ua,Nb,hc,Object(A.a)(this,this.P3,"onPointerOver"),Object(A.a)(this,this.O3,"onPointerOut"),$c))}kTa(){if(this.A3)return this.ORm();const Ua=Array.clone(this.zCb);if(this.NSa){let Nb=!1;for(const hc of this.zCb)if(hc.clientId===this.NSa.clientId){Nb=!0;break}Nb||Array.add(Ua,this.NSa)}return Ua}dispose(){this.A3?this.hFm():(this.Klg=this.CYd=null,this.gN.dispose())}h0(Ua){if(this.A3)this.Hpm(Ua);else if(Ua){for(const Nb of this.zCb)if(Nb.clientId===
Ua.clientId)return;Array.add(this.zCb,Ua);this.refresh()}}Bqa(Ua){if(this.A3)this.SFn(Ua);else if(Ua)for(const Nb of this.zCb)if(Nb.clientId===Ua.clientId){Array.remove(this.zCb,Nb);this.refresh();break}}clear(){this.A3?this.Bxm():(this.Klg=[],this.gN.clear())}get NSa(){return this.CYd}set NSa(Ua){this.CYd!==Ua&&(this.CYd=Ua,this.CYd||(this.A1f=!1),this.A3||this.refresh())}XHk(){this.A3||(this.NSa?(this.A1f=!0,this.lLe()):B.a.J(22675491,828,10,"ShapePresencePawn.ShowEditorFlyout: Trying to show editing flyout when current editor is null"))}d5l(){this.A3?
this.pQn():(this.uHe=!0,this.CYd&&(this.A1f=!0),this.lLe())}lzl(){this.A3?this.QYm():(this.uHe=!1,this.lLe())}setZIndex(Ua){this.A3?this.GNn(Ua):this.gN.setZIndex(Ua)}get hCb(){return this.NSa?this.NSa.color:this.zCb&&this.zCb.length?this.zCb[this.zCb.length-1].color:Jd.a.none}Tih(){return!!this.CYd||0<this.Klg.length}get zCb(){return this.A3?this.rS.DKe:this.Klg}LYm(){this.gN.ZLe();this.gN.cAe()}O3(){this.Tih()&&(this.uHe=!1,this.lLe());return!0}P3(){this.Tih()&&(this.uHe=!0,this.lLe());return!0}GXn(){this.Tih()?
this.gN.jwh(1<this.Klg.length?"MoreUsersGlyph_16x16x32":"SingleCollabUserGlyph_16x16x32",this.hCb):this.gN.E$b()}refresh(){this.GXn();this.lLe()}lLe(){this.LYm();if(this.uHe)if(this.NSa){this.gN.ptd(this.NSa.color,String.format(ResourceStrings.l_TypingHint,this.NSa.userName));for(const Ua of this.zCb)this.NSa.clientId!==Ua.clientId&&this.gN.ptd(Ua.color,Ua.userName)}else for(const Ua of this.zCb)this.gN.ptd(Ua.color,Ua.userName);else this.A1f&&(this.NSa?this.gN.ptd(this.NSa.color,String.format(ResourceStrings.l_TypingHint,
this.NSa.userName)):B.a.J(42472531,828,10,"ShapePresencePawn.RefreshFlyout: Trying to show editing flyout when current editor is null"));(this.uHe||this.A1f)&&this.gN.Ssg()}Dne(Ua,Nb){this.rS&&this.rS.Dne(Ua,Nb)}hFm(){this.rS&&this.rS.dispose()}Ubk(){return ba.a.Ni(document.body)}Hpm(Ua){Ua?this.rS?(B.a.J(42472535,814,50,"ShapePresencePawn:AddUser at PresencePawn for ClientId { presenceUser.ClientId}",Ua.clientId),this.rS.h0(Ua)):B.a.J(42472533,814,10,"ShapePresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {presenceUser.ClientId}"):
B.a.J(50340754,814,10,"ShapePresencePawn:AddUser - user is null, skipping AddUser")}SFn(Ua){Ua?this.rS?(B.a.J(42472539,814,50,"ShapePresencePawn:RemoveUser at PresencePawn for ClientId { presenceUser.ClientId}",Ua.clientId),this.rS.Bqa(Ua.clientId)):B.a.J(42472537,814,15,"ShapePresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser {presenceUser.ClientId}"):B.a.J(50340758,814,15,"ShapePresencePawn:RemoveUser - user is null, skipping RemoveUser")}Bxm(){if(this.rS){B.a.J(42472543,814,
50,"ShapePresencePawn:Clear at PresencePawn ");var Ua=this.kTa();if(Ua)for(const Nb of Ua)this.Bqa(Nb);else B.a.J(42472545,814,50,"ShapePresencePawn:Clear - Pawn has no users")}else B.a.J(42472541,814,15,"ShapePresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}ORm(){return this.rS?this.rS.DKe:null}pQn(){this.rS&&(this.rS.rDb(),this.rS.Cec())}QYm(){this.rS&&this.rS.rDb()}GNn(Ua){this.eo.style.zIndex=String(Ua)}CUm(Ua){const Nb=new rc.a;Nb.add(0,ub.e(h.AFrameworkApplication.iS,
"MoreUsersGlyph_16x16x32"));Nb.add(5,h.AFrameworkApplication.jp);Nb.add(1,ub.e(h.AFrameworkApplication.iS,"DoughboyWhiteGlyph_20x20x32"));Nb.add(4,h.AFrameworkApplication.jp);Nb.add(6,20);Nb.add(8,h.AFrameworkApplication.isRtl);Nb.add(12,Ua);Nb.add(11,!1);Nb.add(16,Object(A.a)(this,this.Ubk,"presenceViewportBoundsCallback"));return new fd.a(Nb)}HBm(){this.rS=this.CUm(this.qvl()).umf(this.eo);Sys.UI.DomElement.addCssClass(this.rS.element,"ShapePawnContainer")}Pxm(){const Ua=this.kTa();if(Ua)for(const Nb of Ua)this.Dne(Nb.clientId,
!1)}qvl(){return this.Mff+Cd.a.Ora+Cd.a.Ora}Ssg(){this.Sad.ta.style.zIndex=String(this.qvl())}}Object(e.a)(Rd,"ShapePresencePawn",null,[771,772,24,739]);var Me=a(1347);class lf{constructor(Ua,Nb,hc,Qc,$c){this.UB=Ua;this.ef=Nb;this.Qi=hc;this.oLc=Qc;this.Lc=$c}WBm(Ua,Nb,hc,Qc){this.Qi.addCssClass(Ua,"ShapeModernCatchupPawnContainer");return new Me.a(Ua,Nb,"pegal",this,hc,Qc)}VBm(Ua,Nb,hc){this.Qi.addCssClass(Ua,"ShapePawnContainer");return new Rd(Ua,Nb,"per",this,hc)}Ypi(Ua,Nb,hc,Qc,$c,Hd){return new Ec.a(Ua,
Nb,hc,Qc,$c,null,this,this.oLc,this.Qi,this.UB,this.ef,Hd)}Yml(){return new Ya(this.Qi,this.Lc)}Zml(){return new Ub.a(this.Qi)}}Object(e.a)(lf,"ShapePawnFactory",null,[740]);var yf=a(719),ff=a(318),jf=a(354),Nf=a(1024),og=a(336),Tg=a(358),Ce=a(365),vf=a(363),Eg=a(1211),hf=a(351);class Qh{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe=16){var cf;this.BJl=!1;this.Dp=null;this.R2d=!1;this.ic=null;this.fh=!1;this.xo=(Ee,xe)=>{var cg,Gg;Ee=null;xe&&xe.yA&&(Ee=xe.yA.zd);Ee&&(null===(cg=Ee.Xb)||void 0===cg?0:cg.equals(null===
(Gg=this.ra)||void 0===Gg?void 0:Gg.slideId))&&this.axi()};this.csg=this.PA=this.OA=0;this.Xe=1;this.u4f=!1;this.mc=this.Y_f=!0;this.BP=!1;this.B3=!0;this.dEj=!1;this.JMa=Fe;this.rLc=new og.a;this.N1a=new Ce.a;this.$Z=new Tg.a;this.aha=new Tg.a;this.fka=new Tg.a;this.NEa=new og.a;this.IE=new vf.a;this.Lw=new vf.a;this.ob=Ua;this.gN=Nb?Nb(this.NEa.ta,this.JMa,$c):null;this.ra=hc;this.h2a=Qc;this.ic=Hd;this.kd=$d;(this.fh=null===ue||void 0===ue?void 0:ue.getBooleanAppSetting(Eg.a.tI))&&this.ic.TSa&&
(null===(cf=this.kd)||void 0===cf?void 0:cf.qSa(this.xo))}dispose(){var Ua;this.h2a();this.rLc&&(this.rLc.ta.parentNode&&this.rLc.fr(),this.N1a&&this.N1a.viewport&&this.N1a.viewport.fr(),this.$Z&&this.$Z.fr(),this.aha&&this.aha.fr(),this.fka&&this.aha.fr());this.fh&&this.ic.TSa&&(null===(Ua=this.kd)||void 0===Ua?void 0:Ua.VCb(this.xo));this.gN&&this.gN.dispose();this.NEa=this.fka=this.aha=this.$Z=this.N1a=this.rLc=null;this.mc=!1}get B3l(){return this.gN}get shape(){return this.ra}get NRd(){return this.BJl}set NRd(Ua){this.JMa=
Ua?20:16;this.BJl=Ua}get LCl(){return this.R2d}set LCl(Ua){this.JMa=16;this.R2d=Ua}xq(Ua){this.rLc.appendChild(this.N1a.viewport);this.rLc.appendChild(this.NEa);this.$Z.mN(Jd.a.none);this.R2d?this.Mw(this.$Z,kf.a.Jwh):this.Mw(this.$Z,kf.a.Kwh);this.aha.mN(Jd.a.none);this.Mw(this.aha,Nf.a.rkf);this.fka.mN(Jd.a.none);this.Mw(this.fka,Nf.a.mdh);this.N1a.appendChild(this.fka);this.N1a.appendChild(this.aha);this.N1a.appendChild(this.$Z);this.setVisibility();this.axi();Ua.appendChild(this.rLc)}KR(){}Qt(){return this.N1a.Qt()}sSb(){return!1}hD(){}setVisibility(){const Ua=
this.mc&&(!this.BP||!this.B3);this.NEa.he(Ua);this.$Z.he(Ua);this.aha.he(Ua);this.fka.he(Ua);this.rLc.he(this.mc)}hG(){}vP(){return null}iL(){return[]}axi(){this.Dp=this.ra.wt.copy();this.Mw(this.$Z,this.dEj?Nf.a.Jhi:this.R2d?kf.a.Jwh:kf.a.Kwh);this.Mw(this.aha,Nf.a.rkf);this.Mw(this.fka,Nf.a.mdh);this.KB();this.setVisibility()}draw(){this.visible=!0;this.axi()}get visible(){return this.mc}set visible(Ua){this.mc!==Ua&&(this.mc=Ua,this.setVisibility(),this.KB())}get Fze(){return this.Y_f}set Fze(Ua){this.Y_f=
Ua;this.$Z.he(this.mc&&this.Y_f);this.aha.he(this.mc&&this.Y_f);this.fka.he(this.mc&&this.Y_f)}setPosition(Ua,Nb){this.OA=Ua;this.PA=Nb;this.KB()}Yi(Ua){this.Xe=Ua;this.KB()}Vu(Ua){this.IE=Ua;this.KB()}Kz(Ua){this.Lw=Ua;this.KB()}setZIndex(Ua){this.csg=Ua;this.rLc.AG(this.csg);this.N1a.AG(this.csg);this.NEa.AG(this.csg);this.gN&&this.gN.setZIndex(this.csg)}LP(Ua,Nb){this.BP=Ua;this.B3=Nb;this.setVisibility()}QOe(Ua=null){this.gN&&this.$Z.GB(Ua||this.gN.hCb);this.$Z&&(this.$Z.Sqa(""),this.$Z.mN(Jd.a.none),
this.R2d?this.Mw(this.$Z,kf.a.Jwh):this.Mw(this.$Z,kf.a.Kwh),this.$Z.Eka(""))}xxm(){this.$Z&&this.aha&&this.fka&&(this.dEj=!1,this.$Z.Eka(""),this.aha.Eka(""),this.$Z.GB(Jd.a.none),this.$Z.mDb(0),this.aha.GB(Jd.a.none),this.aha.mDb(0),this.fka.GB(Jd.a.none),this.fka.mDb(0))}vWk(Ua,Nb=!1){if(this.$Z&&this.aha&&this.fka){this.dEj=!0;var hc=0===Ua;this.Mw(this.$Z,Nf.a.Jhi);this.Mw(this.aha,2===Ua?Nf.a.Lkl:Nf.a.rkf);this.Mw(this.fka,Nf.a.mdh);this.$Z.GB(hc?Jd.a.none:Nf.a.Jkl);this.aha.GB(hc?Jd.a.none:
Nf.a.Fkl);switch(Ua){case 2:this.fka.GB(Nf.a.Ikl);break;case 1:this.fka.GB(Nf.a.Gkl);break;default:this.fka.GB(Nf.a.Hkl)}1===Ua?this.qrl():Nb?this.qrl():(this.$Z.mDb(1),this.aha.mDb(1),this.fka.mDb(1))}}qrl(){this.rrl(0)}rrl(Ua){this.$Z&&this.aha&&this.fka&&!(1<Ua)&&(Ua+=.05,this.$Z.mDb(Ua),this.aha.mDb(Ua),this.fka.mDb(Ua),window.setTimeout(()=>{this.rrl(Ua)},10))}Mw(Ua,Nb){Ua.Mw(Nb/this.ic.RE)}KB(){if(this.Dp){var Ua=this.Dp.copy();this.IE.gl(Ua);this.Lw.gl(Ua);Ua.move(this.OA,this.PA);Ua.scale(this.Xe,
this.Xe);this.mXn(Ua);this.XXn(Ua)}}mXn(Ua){if(this.$Z&&this.aha&&this.fka&&Ua){var Nb=this.Oil(Nf.a.Kkl,Ua),hc=this.Oil(Nf.a.rkf,Nb);this.fka.ox(hc.points);this.N1a.Km();this.fka.he(this.mc&&(!this.BP||!this.B3));this.aha.ox(Nb.points);this.N1a.Km();this.aha.he(this.mc&&(!this.BP||!this.B3));this.$Z.ox(Ua.points);this.N1a.Km();this.$Z.he(this.mc&&(!this.BP||!this.B3));v.a.Dlb&&this.ra&&this.ra.Zc&&this.ob.CEe()&&this.N1a.viewport.mh(this.N1a.viewport.width,0)}}$tg(){if(this.NRd){var Ua=this.NEa.x,
Nb=this.NEa.y,hc=18/this.ic.RE;this.ob.Y0(this.ra)&&!this.u4f&&(hf.a.pj&&Object(Ga.a)("ShiftPawnDivForTableOneClickUI")&&this.ra.Zc?this.NEa.setPosition(Ua+5,Nb-hc):this.NEa.setPosition(Ua,Nb-hc),this.u4f=!0)}}TUj(){if(this.NRd){var Ua=this.NEa.x,Nb=this.NEa.y,hc=18/this.ic.RE;this.u4f&&!this.ob.Y0(this.ra)&&(hf.a.pj&&Object(Ga.a)("ShiftPawnDivForTableOneClickUI")&&this.ra.Zc?this.NEa.setPosition(Ua-5,Nb+hc):this.NEa.setPosition(Ua,Nb+hc),this.u4f=!1)}}Oil(Ua,Nb){var hc=Nb.zj(jf.a.jW),Qc=Nb.zj(jf.a.WB);
hc=yf.a.kN(lb.a.gG(Qc,hc));new lb.a(0,0);new lb.a(0,0);let $c;new lb.a(0,0);new lb.a(0,0);var Hd=Ua/this.ic.RE;Nb.rotate(-hc);const $d=Nb.points;Ua=new lb.a($d[0]._x+Hd,$d[0]._y+Hd);Qc=new lb.a($d[1]._x-Hd,$d[1]._y+Hd);$c=new lb.a($d[2]._x-Hd,$d[2]._y-Hd);Hd=new lb.a($d[3]._x+Hd,$d[3]._y-Hd);Ua=new ff.a(Ua,Qc,$c,Hd);Ua.rotate(hc);Nb.rotate(hc);return Ua}XXn(Ua){if(Ua){var Nb=Ua.zj(jf.a.jW),hc=Ua.zj(jf.a.WB),Qc=yf.a.kN(lb.a.gG(hc,Nb));Nb=Ua.zj(jf.a.jW);hc=Ua.zj(jf.a.WB);90<=Qc&&(Nb=Ua.zj(jf.a.WB),
hc=Ua.zj(jf.a.p_));180<=Qc&&(Nb=Ua.zj(jf.a.p_),hc=Ua.zj(jf.a.ES));270<=Qc&&(Nb=Ua.zj(jf.a.ES),hc=Ua.zj(jf.a.jW));Qc=lb.a.gG(hc,Nb);var $c=this.yRm(Qc);Ua=Math.cos(Qc)*$c;Qc=Math.sin(Qc)*$c;$c=this.NRd?this.JMa/2-1:this.R2d?this.JMa/2:this.JMa;this.NEa.ta.style.transform=`scale(${1/this.ic.RE})`;this.R2d?this.NEa.setPosition(hc.x-$c,hc.y-$c):hf.a.pj&&Object(Ga.a)("ShiftPawnDivForTableOneClickUI")&&this.ra.Zc?this.NEa.setPosition(Nb.x-Ua+10,Nb.y-Qc-$c):this.NEa.setPosition(Nb.x-Ua,Nb.y-Qc-$c);this.NEa.he(this.mc&&
(!this.BP||!this.B3));this.NRd&&(this.u4f=!1,this.$tg())}}yRm(Ua){return(this.NRd?10:15)-yf.a.kN(Ua)/6}}Object(e.a)(Qh,"ShapePawnView",null,[770]);class hi{Zpi(Ua,Nb,hc,Qc,$c,Hd,$d,ue){return new Qh(Ua,Nb,hc,Qc,$c,Hd,$d,ue,16)}}Object(e.a)(hi,"ShapePawnViewFactory",null,[742]);class Vg extends Sys.EventArgs{constructor(Ua){super();this.shape=Ua}}Object(e.a)(Vg,"ShapeViewElementPresenceStateChangedEventArgs",Sys.EventArgs,[]);class uh{constructor(Ua,Nb){this.Yo=Ua;this.ra=this.Yo.shape;this.ra.xF=
!1;this.$Gl=new Vg(this.ra);this.Kw=Object(Jb.a)(Rd,this.Yo.B3l);this.MMl=Nb;(this.fIl=h.AFrameworkApplication.ga.getBooleanAppSetting(Ae.a.itb))&&this.Yo&&(this.Yo.NRd=!0)}xq(Ua){this.Yo.xq(Ua)}KR(Ua){this.Yo.KR(Ua)}Qt(){return this.Yo.Qt()}YZ(Ua){return this.Yo.sSb(Ua)}hD(Ua){this.Yo.hD(Ua)}$tg(){this.Yo.$tg()}TUj(){this.Yo.TUj()}dispose(){this.Yo.dispose()}hG(){this.Yo.hG()}vP(Ua){return this.Yo.vP(Ua)}iL(Ua){return this.Yo.iL(Ua)}draw(Ua,Nb){this.Yo.draw(Ua,Nb)}get visible(){return this.Yo.visible}set visible(Ua){this.Yo.visible=
Ua}setPosition(Ua,Nb){this.Yo.setPosition(Ua,Nb)}Yi(Ua){this.Yo.Yi(Ua)}Vu(Ua){this.Yo.Vu(Ua)}Kz(Ua){this.Yo.Kz(Ua)}setZIndex(Ua){this.Yo.setZIndex(Ua)}LP(Ua,Nb){this.Yo.LP(Ua,Nb)}setSelection(){}GJb(Ua){Ua&&(this.i5c(),this.Kw.h0(Ua),this.Yo.QOe(),this.Yo.setVisibility(),B.a.J(22675524,814,50,"ShapePresenceView::AddPresence; Added User: {0}; Pawn and Border Color: {1}; shape: {2}",Ua.clientId,this.Kw.hCb,this.ra?this.ra.Ql:"null_moniker"))}Cdd(Ua){if(Ua&&this.Kw){this.Kw.Bqa(Ua);this.Yo.QOe();var Nb=
this.Kw.kTa();Nb&&Nb.length?B.a.J(22675528,814,50,"ShapePresenceView::RemovePresence - Remove user from shape presence view; User: {0}, Current Pawn and Border color: {1}; shape: {2}",Ua.clientId,this.Kw.hCb,this.ra?this.ra.Ql:""):B.a.J(22675526,814,50,"ShapePresenceView::RemovePresence - Removed last user, removed pawn and border, User: {0}, shape: {1}",Ua.clientId,this.ra?this.ra.Ql:"null_moniker");this.Yo.setVisibility();this.fnc()}}akl(){this.Kw.clear();this.Yo.QOe();this.fnc()}XHk(){this.Kw.XHk()}nPn(){this.Kw.d5l()}pRb(){this.Kw.lzl()}Izh(Ua){Ua&&
this.i5c();this.Kw&&(this.Kw.NSa=Ua);this.Yo.QOe();this.fIl&&this.Kw&&(this.Kw.NSa?this.Kw.Dne(Ua.clientId,!0):this.Kw.Pxm());Ua||this.fnc()}get yCb(){return this.Kw}get o7i(){return this.Kw.Tih()}get Fze(){return this.Yo.Fze}set Fze(Ua){this.Yo.Fze=Ua}i5c(){this.ra.xF||this.o7i||(this.ra.xF=!0,this.MMl.nhk(this.$Gl))}fnc(){this.ra.xF&&!this.o7i&&(this.ra.xF=!1,this.MMl.nhk(this.$Gl))}}Object(e.a)(uh,"ShapePresenceView",null,[759,760,301,24]);var Eh=a(664);class Bh{get name(){return"PowerPointWebEditor.ShapePresence"}lc(Ua){Ua.register(738,
"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>").ma().na(()=>new Eh.a((Nb,hc)=>{let Qc=null;const $c=Object(Jb.a)(284,Nb.tc(Ua.resolve("Box4.IPageView").Oa));$c&&!$c.isDisposed&&(Nb=Ua.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").Zpi(Ua.resolve("PowerPointWebEditor.IPptSelectionManager"),(Hd,$d,ue)=>Object(Jb.a)(739,Ua.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").VBm(Hd,$d,ue)),Nb,hc,$c.Jqa,Ua.resolve("PowerPointWebEditor.IZoomContext"),
Ua.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),Ua.resolve("PowerPointWebEditor.IApplicationSettings")),Qc=new uh(Nb,Ua.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier")),Qc.xq($c.Jqa),$c.hzb(Qc,1),Qc.visible=$c.TK||$c.Ho);return Qc}));Ua.register(740,"PowerPointWebEditor.ShapePresence.IShapePawnFactory").ma().na(()=>new lf(Ua.resolve("Common.IPointerInputManager"),Ua.resolve("Common.IClickInputManager"),Ua.resolve("PowerPoint.IBrowserHelperManager"),Ua.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),
Ua.resolve("PowerPointWebEditor.IActiveSlideViewManager")));Ua.register(741,"PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory").ma().na(()=>new fc(Ua.resolve("PowerPoint.IPathManager")));Ua.register(742,"PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").ma().na(()=>new hi)}init(){}dispose(){}static main(){y.a.instance.Fc(new Bh)}}Object(e.a)(Bh,"PPTWebEditorShapePresencePackage",null,[3,4]);class ag{constructor(){this.$=null;this.Vca=[new Bh]}get name(){return"PowerPointWebEditor.ExtCommonPackage"}lc(Ua){this.$=
Ua;for(const Nb of this.Vca)Nb.lc(Ua)}init(){for(const Ua of this.Vca)Ua.init();this.$.resolve("PowerPointWebEditor.IAppBootCompletedListener").zkh=!0;cb.a.instance.kc(Eb.a.Efh,(new Date).getTime())}dispose(){}static main(){cb.a.instance.kc(Eb.a.Ffh,(new Date).getTime());y.a.instance.Fc(new ag)}}Object(e.a)(ag,"PptExtCommonPackage",null,[3,4]);var zf=a(894),Df=a(1217);class $f{constructor(Ua){B.a.J(508065505,830,50,"TransitionPreviewResourceProvider: creating new provider ");this.lM=Ua;this.presInfoAndSlideInfo=
new Kg(this.lM.presInfoAndSlideInfo,this.WMl);this.presInfo=this.lM.presInfo;this.slideInfo=new Kg(this.lM.slideInfo,this.WMl);this.slide=this.lM.slide;this.slideViewData=this.lM.slideViewData;this.shapeViewData=this.lM.shapeViewData;this.imageData=this.lM.imageData;this.localizedString=this.lM.localizedString}invalidateSlideAsync(Ua,Nb){return this.lM.invalidateSlideAsync(Ua,Nb)}resetProviders(){this.lM.resetProviders()}updatePodsProxy(Ua){this.lM.updatePodsProxy(Ua)}isSlideCached(Ua){return this.lM.isSlideCached(Ua)}WMl(Ua){Ua.SlideShowInfo&&
0<Ua.SlideShowInfo.sld.length&&Ua.SlideShowInfo.sld[0].animLst&&Ua.SlideShowInfo.sld[0].animLst.anim&&(Ua.SlideShowInfo.sld[0].animLst.anim=[]);return Ua}}Object(e.a)($f,"TransitionPreviewResourceProvider",null,[775]);class Kg{constructor(Ua,Nb){this.Oad=Ua;this.Wcn=Nb;this.events=this.Oad.events;this.policy=this.Oad.policy}load(Ua,Nb){return Object(f.b)(this,void 0,void 0,function*(){const hc=yield this.Oad.load(Ua,Nb);hc.resource&&(B.a.J(508065504,830,50,`TransitionPreviewResourceProvide: mapping result.resource in load method for resourceId ${Ua}`),
hc.resource=this.Wcn(hc.resource));return hc})}add(Ua){return this.Oad.add(Ua)}remove(Ua,Nb){return this.Oad.remove(Ua,Nb)}getAllLoadResultsInCache(){return this.Oad.getAllLoadResultsInCache()}getLoadResultsInCache(Ua){return this.Oad.getLoadResultsInCache(Ua)}getLoadResultInCache(Ua,Nb){return this.Oad.getLoadResultInCache(Ua,Nb)}}Object(e.a)(Kg,"PreviewResourceProvider",null,[776]);var ug=a(1218);class rh extends Sys.EventArgs{constructor(Ua,Nb){super();this.Urm=Ua;this.Sxm=Nb}}Object(e.a)(rh,"OnAnimationTimelineChangedEventArgs",
Sys.EventArgs,[]);class gh{constructor(Ua,Nb,hc,Qc,$c,Hd){this.Oab=this.Gg=null;this.NJl=!1;this.$=this.so=null;this.tG=new ea.a;this.ua=new mb.a;this.dXd=[];this.v$c=null;this.c2i=$d=>{if("Escape"===$d.key||"Esc"===$d.key||27===$d.keyCode)B.a.J(508043427,830,50,"PreviewFrame - Exiting Preview for Esc key [previewId: {0}]",this.xO),this.exit()};this.iom=()=>{document.getElementById("tabbedTaskPaneContainer")&&W.a.addHandler(document.getElementById("tabbedTaskPaneContainer"),L.a.mouseDown,this.FBe);
document.getElementById("tabStripFocusZone")&&W.a.addHandler(document.getElementById("tabStripFocusZone"),L.a.mouseDown,this.FBe)};this.wFn=()=>{document.getElementById("tabbedTaskPaneContainer")&&W.a.removeHandler(document.getElementById("tabbedTaskPaneContainer"),L.a.mouseDown,this.FBe);document.getElementById("tabStripFocusZone")&&W.a.removeHandler(document.getElementById("tabStripFocusZone"),L.a.mouseDown,this.FBe)};this.FBe=()=>{B.a.J(508043417,830,50,"PreviewFrame - Exiting preview on far pane interaction [previewId: {0}]",
this.xO);this.exit()};this.$Be=()=>{B.a.J(508043416,830,50,"PreviewFrame - Focussing on preview container [previewId: {0}]",this.xO);this.$.focus()};if(!Hd)throw Error.argumentNull("slideShowCoreHelper");this.Gf=Ua;this.la=Nb;this.Ex=Qc;this.rf=hc;this.Nab=Hd;this.Dbg=()=>{B.a.J(508043457,830,50,"PreviewFrame - Exiting preview on completion [previewId: {0}]",this.xO);this.exit()};this.v$c=$c}bck(Ua,Nb,hc,Qc){return Object(f.b)(this,void 0,void 0,function*(){this.xO=Qc;B.a.J(508043456,830,50,"PreviewFrame - Beginning Animation Preview [previewId: {0}]",
this.xO);const $c=gh.gS();if(yield this.mql())this.dXd=[],this.dXd.push({["timelineId"]:"0_anim",["step"]:-1,["sid"]:-1}),this.so.addEventListener("keydown",this.c2i),yield this.t6l(Ua,Nb,$c,hc,"ap"),this.v$c.RYc(0,!1,!1),this.Gg.events.on("slideLocationChanging",this.Dbg),this.Gg.events.on("slideLocationChanged",this.Dbg),this.Tnm(),this.QWk(Nb+1),this.H4l(),this.Xbd()})}ick(Ua,Nb,hc,Qc,$c,Hd){return Object(f.b)(this,void 0,void 0,function*(){this.xO=Hd;B.a.J(508043426,830,50,"PreviewFrame - Beginning Transition Preview [previewId: {0}]",
this.xO);var $d=gh.gS();if(yield this.mql()){var ue=new $f($c);this.iom();this.QWk(Qc+1);this.so.addEventListener("keydown",this.c2i);yield this.t6l(Ua,Nb,$d,ue,"tp");this.H4l();$d={["actionContext"]:{["navigationType"]:"next",["bootMetrics"]:{sr:"tp",startFromTime:$d}},["fSkipTransition"]:!1};this.la.getBooleanAppSetting("EnsureNavigationStateConsistency")&&($d.fClearNavigationState=!0);this.Gg.events.on("slideLocationChanged",this.Dbg);B.a.J(508043425,830,50,"PreviewFrame - Initiating gotoSlide to play transition [previewId: {0}]",
this.xO);yield this.Gg.gotoSlide(gh.getSlideLocation(hc,Qc),$d)}})}mql(){return Object(f.b)(this,void 0,void 0,function*(){var Ua=Object(Ga.a)("AddPreviewFlowAdjustments")&&this.NJl;this.Oab&&!Ua&&(Ua=gh.gS(),yield this.Oab,B.a.J(508086161,830,15,"PreviewFrame - awaited SlideShowCore init for: {0} [previewId: {1}]",gh.gS()-Ua,this.xO));if(!this.Gg)return B.a.J(508086160,830,10,"PreviewFrame - SlideShowCore is undefined [previewId: {0}]",this.xO),!1;yield this.Gg.refreshViewControllerSSC();B.a.J(508043424,
830,50,"PreviewFrame - Refreshed ViewController [previewId: {0}]",this.xO);return!0})}t6l(Ua,Nb,hc,Qc,$c){return Object(f.b)(this,void 0,void 0,function*(){B.a.J(508043423,830,50,"PreviewFrame - Starting SSC [previewId: {0}]",this.xO);yield this.Gg.updateResourceProviders(Qc,{shouldRerenderSlide:!0,startSlideIndex:Nb,skipPrefetchSlides:Object(Ga.a)("SkipPrefetchSlidesForUpdatingResourceProviders")});B.a.J(508043422,830,50,"PreviewFrame - Updated Resource Providers in SSC [previewId: {0}]",this.xO);
const Hd={["actionContext"]:{["navigationType"]:"init",["startFromTime"]:hc,["bootMetrics"]:{sr:$c,startFromTime:hc}},["fSkipTransition"]:!0};this.la.getBooleanAppSetting("EnsureNavigationStateConsistency")&&(Hd.fClearNavigationState=!0);this.la.getBooleanAppSetting("EnsureNavigationStateConsistency")||this.Gg.clearNavigationState();yield this.Gg.gotoSlide(gh.getSlideLocation(Ua,Nb),Hd);B.a.J(508043421,830,50,"PreviewFrame - gotoSlide complete [previewId: {0}]",this.xO);this.ua.raiseEvent("PreviewStart");
B.a.J(508086159,830,15,"PreviewFrame - Started slideshow for preview. slideId: {0}, slideIndex: {1} [previewId: {2}]",Ua,Nb,this.xO)})}init(Ua,Nb){return Object(f.b)(this,void 0,void 0,function*(){if(this.so)B.a.J(508086158,830,50,"PreviewFrame - init called again: {0}",this.Oab),yield this.Oab;else{this.so=document.createElement("div");this.so.id="PreviewBackground";this.so.className="PreviewBackground";this.so.style.visibility=Pa.a.ms;this.so.tabIndex=-1;this.$=document.createElement("div");this.$.id=
"PreviewContainer";this.$.className="PreviewContainer";this.$.tabIndex=-1;this.$.style.width="100%";this.$.style.height="100%";this.$.style.top="0px";this.so.appendChild(this.$);this.Gf.appendChild(this.so);var hc=this.la.La("pptSlideShowCoreCssUrl"),Qc=document.createElement("link");Qc.setAttribute("rel","stylesheet");Qc.setAttribute("type","text/css");Qc.setAttribute("href",hc);this.$.appendChild(Qc);Object(Ga.a)("DisablePreviewInSvgMode")&&this.Nab.pta||(yield this.GNd(Ua,Nb))}})}GNd(Ua,Nb){return Object(f.b)(this,
void 0,void 0,function*(){const hc={};hc.initTime=gh.gS();hc.uiHost="Unified App";hc.serverUrl=O.a.Sj(this.la.$l);hc.userSessionId=Ua;hc.jsScriptsBasePath=this.la.La("StaticContentHost")+"pptscripts/ssapp/";hc.fileHost=this.la.La("FileHost");hc.isRtl=h.AFrameworkApplication.isRtl;hc.applicationLcid=h.AFrameworkApplication.lcid;hc.applicationLocaleName=h.AFrameworkApplication.uiCulture;hc.areThirdPartyAddInsAllowed=h.AFrameworkApplication.uSa;hc.theWsaClient=h.AFrameworkApplication.Hl;hc.appForOfficeContextActivationParameters=
zf.a.UCe(this.rf);hc.hubbleVideoEndpoint=this.la.LAb;hc.acceptLanguage=h.AFrameworkApplication.uiCulture;hc.appForOfficeAuthFactory=new Df.a;const Qc={};Qc.settings=this.Ex;Qc.transitionResourceCDNPath=this.la.geh;Qc.transitionDisabledList=this.la.kRa;Qc.clickTargetEnabled=!0;Qc.mediaEnabled=!0;Qc.gifEnabled=!0;Qc.convertGifToVideo=!0;Qc.crossSlideAudioEnabled=!0;Qc.editAudioEnabled=this.la.getBooleanAppSetting("PPTOAudioPlaybackOptionsEnabled");Qc.flipgridVideoEnabled=this.la.getBooleanAppSetting("PptModernSlideShowFlipgridVideoEnabled");
Qc.useNewYoutubePlayer=!0;Qc.useNewVimeoPlayer=!0;Qc.useOnlineVideoPlayer=!0;Qc.tedVideoEnabled=this.la.getBooleanAppSetting("PptModernSlideShowTEDVideoEnabled");Qc.isStream2Enabled=!0;Qc.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;Qc.enableSVGAsWebGLTexture=!v.a.zg&&this.la.getBooleanAppSetting("SlideShowShapeBuilderSVGEnabled");Qc.maxSvgTextureSize=this.la.Jc("ShapeBuilderMaxSvgTextureSize",2048);Qc.enableSlideSizeAdjust=this.la.getBooleanAppSetting("EnableSlideSizeAdjust");Qc.slideSizeMax=
{["x"]:this.la.Jc("SlideShowMaxWidth",1504),["y"]:this.la.Jc("SlideShowMaxHeight",849)};Qc.slideSizeMin={["x"]:this.la.Jc("SlideShowMinWidth",348),["y"]:this.la.Jc("SlideShowMinHeight",261)};Qc.slideSizeDefault={["x"]:this.la.Jc("SlideShowDefaultWidth",1504),["y"]:this.la.Jc("SlideShowDefaultHeight",849)};Qc.streamVideoUseThinEmbed=this.la.getBooleanAppSetting("StreamVideoUseThinEmbed");Qc.slideMetadataEnabled=this.la.getBooleanAppSetting("PptModernSlideShowSlideMetadataEnabled");Qc.disabledChangeGates=
this.la.La("PPTDisabledChangeGates");Qc.isMultiSlideshowcoreEnabled=this.la.getBooleanAppSetting("MultiSlideshowcoreEnabled");Qc.combineBootRequest=!0;Qc.localVideoTelemetryEnabled=this.la.getBooleanAppSetting("IsGFXVideoLocalTelemetryEnabled");Qc.imageSettings={["imageAppendOption"]:"all"};Qc.SlideShowCacheRetentionExperimentEnabled=this.la.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled");const $c={};Object(Ga.a)("addFlightToSSC")&&($c.verifyGlyphAsynchronously=h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.verifyGlyphAsynchronously",
!1));const Hd={["slideShowCoreSettings"]:Qc,["appSettings"]:hc};Object(Ga.a)("addFlightToSSC")&&(Hd.flights=$c);Object(Ga.a)("AddInstanceSourceIdentifier")?this.Gg=new SlideShowCore.SlideShowCore(this.$,Nb,this.tG,Hd,2):this.Gg=new SlideShowCore.SlideShowCore(this.$,Nb,this.tG,Hd);this.Oab=this.Gg.init();this.Gg.events.on("blankSlideStateChanged",$d=>{"EndOfShow"==$d&&this.exit()});this.Gg.events.on("exitFromEndOfShow",()=>this.exit());this.Gg.events.on("animationStateChanged",()=>{this.Xbd()});return new Promise($d=>
Object(f.b)(this,void 0,void 0,function*(){yield this.Oab;new SlideShowCore.InputsAddon(this.Gg,this.$,h.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.Gg,Hd,this.tG);new SlideShowCore.TransitionLoggerAddon(this.Gg,Hd,this.tG);new SlideShowCore.PerfCheckerAddon(this.Gg,Hd,this.tG);B.a.J(508086157,830,15,"PreviewFrame - initSlideShowCore finished");this.NJl=!0;$d()}))})}Xbd(){if(this.Gg&&this.so&&this.so.style.visibility!==Pa.a.ms){const Ua=this.Gg.getSlideLocation();if(Ua){const Nb=
this.Gg.getAnimationState(!0),hc=Nb.timelineStates,Qc=[];for(let $c=0;$c<hc.length;$c+=1){Qc.push({["TimeLineId"]:hc[$c].timelineId,["Step"]:hc[$c].step,["LastClickTime"]:hc[$c].lastClickTime,["StartTimeOffset"]:Nb.startTimeOffset});const Hd=hc[$c];this.dXd[$c]?Hd.step!=this.dXd[$c].step&&(this.dXd[$c].step=Hd.step,this.ua.raiseEvent("AnimationPreview",new rh($c,this.dXd[$c].step))):this.dXd.push(Hd)}this.ua.raiseEvent("OnPositionChangeEventId",new ug.a({["SlideId"]:Ua.slideId.sid,["SlideIndex"]:Ua.slideIndex,
["TimeLineMappings"]:Qc}));B.a.J(508043420,830,50,"PreviewFrame - Handled position change [previewId: {0}]",this.xO)}else B.a.J(508076692,830,10,"PreviewFrame - OnPositionChangedHandler: currentLocation is null [previewId: {0}]",this.xO)}}H4l(){this.so&&(this.so.style.visibility=Pa.a.Cw,this.$Be());B.a.J(508043419,830,50,"PreviewFrame - Preview container visible [previewId: {0}]",this.xO)}NYm(){this.so&&(this.so.style.visibility=Pa.a.ms,this.$.blur());B.a.J(508043418,830,50,"PreviewFrame - Preview container hidden [previewId: {0}]",
this.xO)}Tnm(){document.addEventListener("click",this.$Be);document.getElementById("WACViewPanel").addEventListener("click",this.$Be);document.getElementById("tabStripFocusZone")&&W.a.addHandler(document.getElementById("tabStripFocusZone"),L.a.mouseDown,this.FBe)}rFn(){document.removeEventListener("click",this.$Be);document.getElementById("WACViewPanel").removeEventListener("click",this.$Be);document.getElementById("tabStripFocusZone")&&W.a.removeHandler(document.getElementById("tabStripFocusZone"),
L.a.mouseDown,this.FBe)}exit(){this.Gg&&(this.Gg.endSession(gh.gS()),this.Gg.events.off("slideLocationChanged",this.Dbg),this.Gg.events.off("slideLocationChanging",this.Dbg),this.ua.raiseEvent("PreviewEnd"));this.so.removeEventListener("keypress",this.c2i);this.wFn();this.rFn();this.NYm()}static gS(){return Math.round(window.performance.now())}static getSlideLocation(Ua,Nb){return{["slideId"]:{["sid"]:Ua,["cid"]:0},["slideIndex"]:Nb-1}}QWk(Ua){const Nb=b(Ua).style.display;b(Ua).style.display="block";
const hc=b(Ua).getBoundingClientRect();b(Ua).style.display=Nb;this.$Be();0!=hc.width&&0!=hc.height&&(this.so.style.width=hc.width+"px",this.so.style.height=hc.height+"px",this.so.style.left=hc.left+"px",this.so.style.top=hc.top+"px")}qqm(Ua){this.ua.addHandler("PreviewStart",()=>Ua())}pqm(Ua){this.ua.addHandler("PreviewEnd",()=>Ua())}dqm(Ua){this.ua.addHandler("AnimationPreview",Ua)}}Object(e.a)(gh,"PreviewFrame",null,[734]);class Mh extends Sys.EventArgs{constructor(Ua){super();this.tbc=!1;this.tbc=
Ua}}Object(e.a)(Mh,"PreviewStateEventArgs",Sys.EventArgs,[]);class Rh extends Sys.EventArgs{constructor(Ua,Nb){super();this.ABl=!1;this.ABl=Ua;this.PPl=Nb}}Object(e.a)(Rh,"AnimationPreviewStartedStateEventArgs",Sys.EventArgs,[]);class Ch{constructor(Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee){this.C1f=null;this.woh=this.h3d=!1;this.ILc=-1;this.wUb=this.v$c=null;this.Vyg=()=>{var xe;this.woh=!0;try{null===(xe=this.C1f)||void 0===xe?void 0:xe.Vyg(),B.a.J(508043464,830,50,"PreviewManager - Done handling preview load [previewId: {0}]",
this.xO)}catch(cg){B.a.J(508069957,830,10,"PreviewManager - Exception while handling preview load [previewId: {0}]: {1}",this.xO,cg)}};this.Xrh=()=>{var xe;this.h3d=!0;this.woh=!1;this.NA.qSa(this.Jyl);this.lr.lDb(!0,!0);this.Ge.Ngk(new Mh(!0));this.KYm();window.addEventListener("resize",this.Mql);try{null===(xe=this.C1f)||void 0===xe?void 0:xe.Xrh(),B.a.J(508043463,830,50,"PreviewManager - Done handling preview start [previewId: {0}]",this.xO)}catch(cg){B.a.J(508069956,830,10,"PreviewManager - Exception while handling preview start [previewId: {0}]: {1}",
this.xO,cg)}};this.Wrh=()=>{var xe;this.v$c.RYc(0,!1,!0);this.h3d=!1;this.Ge.Ngk(new Mh(!1));this.NA.VCb(this.Jyl);this.lr.lDb(!1,!0);window.removeEventListener("resize",this.Mql);Object(Ga.a)("ShowCanvasLoadingSpinner")&&this.hideLoadingSpinner();this.BWn();try{null===(xe=this.C1f)||void 0===xe?void 0:xe.Wrh(),B.a.J(508043462,830,50,"PreviewManager - Done handling preview end [previewId: {0}]",this.xO)}catch(cg){B.a.J(508069955,830,10,"PreviewManager - Exception while handling preview end [previewId: {0}]: {1}",
this.xO,cg)}this.xO=void 0};this.Jyl=()=>{!this.ic.mS&&this.h3d?(B.a.J(508043461,830,50,"PreviewManager - Ending preview on slide size change [previewId: {0}]",this.xO),this.ofh()):this.ic.mS&&(B.a.J(508043460,830,50,"PreviewManager - Updating container on slide size change [previewId: {0}]",this.xO),this.vd.QWk(this.ILc))};this.Mql=()=>{Object(Ga.a)("AddPreviewFlowAdjustments")?(B.a.J(508043459,830,50,"PreviewManager - Ending preview on window resize [previewId: {0}]",this.xO),this.ofh()):this.ia.Cb(va.a.mac,
2)};this.vd=Ua;this.vph=Nb;this.ia=Qc;this.ic=Hd;this.Ub=$d;this.Ge=hc;this.NA=$c;this.lr=ue;this.Oan=Fe;this.Pen=cf;this.vd.qqm(this.Xrh);this.vd.pqm(this.Wrh);this.v$c=Ee}v1m(Ua,Nb,hc,Qc){Object(f.b)(this,void 0,void 0,function*(){this.vph.init(Ua,Nb,hc,Qc);const $c=yield this.vph.YTi([]);Object(Ga.a)("ShowCanvasLoadingSpinner")&&this.lBm();yield this.vd.init(Nb,$c)})}lBm(){Object(f.b)(this,void 0,void 0,function*(){this.wUb=document.createElement("div");this.wUb.id="canvas_loading_spinner";this.wUb.className=
"canvas_loading_spinner"})}bck(Ua,Nb,hc){return Object(f.b)(this,void 0,void 0,function*(){this.M2l(hc);if(!this.DVl()){this.ILc=Nb;this.C1f=this.Oan;this.Vyg();yield this.UGm();B.a.J(508043471,830,50,"PreviewManager - Animation Pane now open [previewId: {0}]",hc);yield this.bql();B.a.J(508043470,830,50,"PreviewManager - Slide now zoomed to fit window [previewId: {0}]",hc);Object(Ga.a)("ShowCanvasLoadingSpinner")&&(this.showLoadingSpinner(b(Nb)),B.a.J(507901345,830,50,"PreviewManager - Unhide loading spinner [previewId: {0}]",
hc));var Qc=this.Ub.XZ(Ua);Qc=yield this.vph.YTi([[Qc.sid,Qc.cid]],hc);B.a.J(508043469,830,50,"PreviewManager - Fetched resource providers [previewId: {0}]",hc);yield this.vd.bck(Ua,Nb-1,Qc,hc);B.a.J(508077707,830,50,"PreviewManager - Started animation preview [previewId: {0}]",hc)}})}UGm(){return Object(f.b)(this,void 0,void 0,function*(){return new Promise(Ua=>{this.Ge.nfk(new Rh(!0,Nb=>{B.a.J(508069958,830,50,'PreviewManager - Action "{0}" processed for event [previewId: {1}]',Nb,this.xO);"animationPaneOpened"==
Nb&&Ua()}))})})}bql(){return Object(f.b)(this,void 0,void 0,function*(){if(this.ic.mS)B.a.J(508043468,830,50,"PreviewManager - Already zoomed to fit window [previewId: {0}]",this.xO);else return new Promise(Ua=>{const Nb=()=>{this.ic.mS&&(Ua(),this.NA.VCb(Nb))};this.NA.qSa(Nb);B.a.J(508043467,830,50,"PreviewManager - Zooming to fit window [previewId: {0}]",this.xO);this.ia.Cb(va.a.scb,2)})})}ick(Ua,Nb,hc,Qc,$c){return Object(f.b)(this,void 0,void 0,function*(){this.M2l($c);if(!this.DVl()){this.ILc=
Qc;this.C1f=this.Pen;this.Vyg();yield this.bql();B.a.J(508043466,830,50,"PreviewManager - Slide now zoomed to fit window [previewId: {0}]",$c);Object(Ga.a)("ShowCanvasLoadingSpinner")&&(this.showLoadingSpinner(b(Qc)),B.a.J(507901344,830,50,"PreviewManager - Unhide loading spinner [previewId: {0}]",$c));var Hd=this.Ub.XZ(Ua),$d=this.Ub.XZ(hc);Hd=yield this.vph.YTi([[Hd.sid,Hd.cid],[$d.sid,$d.cid]],$c);B.a.J(508043465,830,50,"PreviewManager - Fetched resource providers [previewId: {0}]",$c);yield this.vd.ick(Ua,
Nb-1,hc,Qc-1,Hd,$c);B.a.J(508086176,830,50,"PreviewManager - Completed transition preview [previewId: {0}]",$c)}})}ofh(){B.a.J(508086175,830,50,"PreviewManager - Ending preview [previewId: {0}]",this.xO);this.vd.exit()}DVl(){const Ua=this.woh||this.h3d;Ua&&B.a.J(508086174,830,50,"PreviewManager - Not starting animation preview as preview is loading: {0} or ongoing: {1}, [previewId: {2}]",this.woh,this.h3d,this.xO);return Ua}BWn(){const Ua=b(this.ILc),Nb=document.getElementById("WACHorizontalRulerContainer"),
hc=document.getElementById("WACVerticalRulerContainer");Ua&&(Ua.style.display="inherit");Nb&&(Nb.style.display="inherit");hc&&(hc.style.display="inherit")}KYm(){const Ua=b(this.ILc),Nb=document.getElementById("WACHorizontalRulerContainer"),hc=document.getElementById("WACVerticalRulerContainer");Ua&&(Ua.style.display="none");Nb&&(Nb.style.display="none");hc&&(hc.style.display="none")}M2l(Ua){this.xO&&B.a.J(508043458,830,15,"PreviewManager - Replacing ongoing preview correlation id with new id : {0}, [previewId: {1}]",
Ua,this.xO);this.xO=Ua}showLoadingSpinner(Ua){if(this.wUb){const Nb=Ua.getBoundingClientRect(),hc=this.wUb.getBoundingClientRect(),Qc=Nb.width/2-hc.width/2;this.wUb.style.top=Nb.height/2-hc.height/2+"px";this.wUb.style.left=Qc+"px";Ua.appendChild(this.wUb);this.wUb.style.display="block"}}hideLoadingSpinner(){this.wUb&&(this.wUb.style.display="none")}}Object(e.a)(Ch,"PreviewManager",null,[737]);var ih=a(1216);class Mi{constructor(Ua,Nb,hc,Qc,$c,Hd){this.lM=null;this.tGe=new Map;this.Bqh=this.dIe=!1;
this.tG=new ea.a;this.ycc=this.LBb="";this.YQl=()=>{B.a.J(508086172,830,100,"ResourceProviderManager - Multiple slides possibly updated");this.dIe=!0};this.oRl=$d=>{B.a.J(508086171,830,100,"ResourceProviderManager - Session updated");this.Bqh=!0;this.pLj=$d};this.la=Ua;this.pLj=hc;this.$p=Qc;$c.Pah(($d,ue)=>this.cyg(ue));Nb&&(Nb.Z9b(this.YQl),Nb.b$b(this.YQl));Hd.a$b(($d,ue)=>this.oRl(ue.Wha));Hd.Zah(($d,ue)=>this.oRl(ue.Wha))}init(Ua,Nb,hc,Qc){this.LBb=Ua;this.ycc=Nb;this.pLj=hc;this.Ex=Qc}cyg(Ua){return Object(f.b)(this,
void 0,void 0,function*(){Ua.actionId!==qb.a.Wja&&(B.a.J(508086173,830,100,"ResourceProviderManager: Slide edit event received for action id : {0}",null===Ua||void 0===Ua?void 0:Ua.actionId),Ua&&Ua.LK&&1==Ua.LK.length&&ih.a.includes(null===Ua||void 0===Ua?void 0:Ua.actionId)&&!this.dIe?Ua.LK.forEach(Nb=>{this.tGe.has(Nb.sid)||this.tGe.set(Nb.sid,new Set);this.tGe.get(Nb.sid).add(Nb.cid)}):this.dIe=!0)})}YTi(Ua,Nb){return Object(f.b)(this,void 0,void 0,function*(){const hc=Math.round(window.performance.now()),
Qc=null==this.lM||this.dIe||this.Bqh||this.S_n(Ua);if(Qc){const $c=yield this.YAm();this.lM&&this.lM.dispose();B.a.J(508086170,830,50,"Updated ResourceProviders. InitCase: {0}, MultipleSlidesEdited: {1}, PodsSessionUpdated: {2}, [previewId: {3}]",null==this.lM,this.dIe,this.Bqh,null!==Nb&&void 0!==Nb?Nb:"");this.lM=$c;this.tGe.clear();this.Bqh=this.dIe=!1}B.a.J(508086169,830,50,"Returning ResourceProviders. Time taken: {0}, Updated: {1}",Math.round(window.performance.now())-hc,Qc);return this.lM})}Kwl(Ua){return Object(f.b)(this,
void 0,void 0,function*(){const Nb=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.$l,this.pLj),hc={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0","X-UserSessionId":h.AFrameworkApplication.userSessionId},Qc=new Date;return new Promise(($c,Hd)=>{this.$p.rk(Nb,1,"",hc,!1,0,$d=>Object(f.b)(this,void 0,void 0,function*(){B.a.J(508086168,830,15,"PreviewFrame - Snap URL fetched successfully. Time taken: {0}, Number of retries: {1}",+new Date-
+Qc,1-Ua);const ue=JSON.parse($d.data.responseData).downloadUrl;O.a.rb(ue)?Hd("Snap URL empty"):$c(ue)}),$d=>Object(f.b)(this,void 0,void 0,function*(){var ue,Fe;const cf=null!==(Fe=null===(ue=$d.data)||void 0===ue?void 0:ue.Ze)&&void 0!==Fe?Fe:-1;0<Ua--?(B.a.J(508086167,830,10,"PreviewFrame - Snap URL fetch failed. Retry count: {0}, HttpStatus: {1}",1-Ua,cf),ue=yield this.Kwl(Ua),$c(ue)):(B.a.J(508086166,830,10,"PreviewFrame - Snap URL fetch failed after {0} retries. HttpStatus: {1}",1,cf),Hd())}),
null,null)})})}Fjb(){const Ua=new Map;Ua.set("X-UserSessionId",this.ycc);Ua.set("X-WacNoAuth","1");Ua.set("X-WacCluster",this.LBb);Ua.set("Client","Unified App");this.la.Ehh&&Ua.set("UseDocCache","True");return Ua}Gjb(){const Ua={};Ua.timeout=this.la.Jc("PptModernSlideShowGetItemsTimeoutMs",3E4);Ua.throwHttpErrors=!1;Ua.enableServerSpecificErrorCode=Ga.a("SSCore.EnableServerSpecificErrorCode");return Ua}zJd(){const Ua={};Ua.settings=this.Ex;Ua.retryCount=this.la.Jc("GetItemsRetryCount",3);Ua.retryOnCategories=
this.la.La("GetItemsRetryCategories").split(";");const Nb={};Nb.Slide=ResourceStrings.l_Slide;Nb.AnimNum=ResourceStrings.l_AccSsAnimNum;Nb.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;Nb.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;Nb.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;Nb.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;Ua.localizedStrings=Nb;return Ua}YAm(){return Object(f.b)(this,void 0,void 0,function*(){const Ua=yield this.Kwl(1);
let Nb=PodsProxy.PodsProxy;if(Ga.a("UseNewPodsProxyConstructor"))try{Nb=new PodsProxy.PodsProxy(this.la.Gsa?this.la.n$a:this.la.$l,{DownloadUrl:Ua,DocID:h.AFrameworkApplication.ui,CustomFontCatalogUrl:this.la.La("CustomFontCatalogURL")},this.la.e_?O.a.vI(this.la.e_).toLowerCase():"",this.tG,this.Fjb(),this.Gjb())}catch(hc){if(hc instanceof TypeError)Nb=new PodsProxy.PodsProxy(this.la.Gsa?this.la.n$a:this.la.$l,{DownloadUrl:Ua,DocID:h.AFrameworkApplication.ui,CustomFontCatalogUrl:this.la.La("CustomFontCatalogURL")},
this.la.e_?O.a.vI(this.la.e_).toLowerCase():"",this.tG,void 0,this.Fjb(),this.Gjb());else throw B.a.J(507811594,830,10,"ResourceProviderManager::Error in PodsProxy initialization:{0}",hc),hc;}else Nb=new PodsProxy.PodsProxy(this.la.Gsa?this.la.n$a:this.la.$l,{DownloadUrl:Ua,DocID:h.AFrameworkApplication.ui,CustomFontCatalogUrl:this.la.La("CustomFontCatalogURL")},this.la.e_?O.a.vI(this.la.e_).toLowerCase():"",this.tG,this.Fjb(),this.Gjb());return new SlideShowCore.DefaultResourceProviders(Nb,this.tG,
this.zJd())})}S_n(Ua){return Ua.some(([Nb,hc])=>this.tGe.has(Nb)&&this.tGe.get(Nb).has(hc))}}Object(e.a)(Mi,"ResourceProviderManager",null,[733]);class Oi{constructor(Ua){this.Ge=Ua}Vyg(){const Ua=[appChrome.actions.updateControlHiddenState("AnimationPreview",!0),appChrome.actions.updateControlHiddenState("ExitAnimationPreview",!1),appChrome.actions.updateControlEnabledDisabledState("ExitAnimationPreview",!0)];appChrome.api.dispatch(Ua)}Xrh(){const Ua=[appChrome.actions.updateControlEnabledDisabledState("ExitAnimationPreview",
!1)];appChrome.api.dispatch(Ua)}Wrh(){this.Ge.nfk(new Rh(!1,()=>{}));const Ua=[appChrome.actions.updateControlHiddenState("AnimationPreview",!1),appChrome.actions.updateControlHiddenState("ExitAnimationPreview",!0)];appChrome.api.dispatch(Ua)}}Object(e.a)(Oi,"AnimationPreviewStateListener",null,[758]);class Ti{Vyg(){const Ua=[appChrome.actions.updateControlHiddenState("TransitionPreview",!0),appChrome.actions.updateControlHiddenState("ExitTransitionPreview",!1),appChrome.actions.updateControlEnabledDisabledState("ExitTransitionPreview",
!0)];appChrome.api.dispatch(Ua)}Xrh(){const Ua=[appChrome.actions.updateControlEnabledDisabledState("ExitTransitionPreview",!1)];appChrome.api.dispatch(Ua)}Wrh(){const Ua=[appChrome.actions.updateControlHiddenState("TransitionPreview",!1),appChrome.actions.updateControlHiddenState("ExitTransitionPreview",!0)];appChrome.api.dispatch(Ua)}}Object(e.a)(Ti,"TransitionPreviewStateListener",null,[758]);class xi{constructor(Ua){this.nj=Ua;this.xbf=this.ybf=null;this.Ykj=this.flag=!1;this.RYc=(Nb=0,hc=!1,
Qc=!1)=>{clearTimeout(this.ogl);Ga.a("StickyToastMessage")?(this.flag&&(this.Ykj?(this.nj.notificationBar.removeEntry(this.xbf),this.Ykj=!1):this.nj.notificationBar.removeEntry(this.ybf),this.flag=!1),Qc||(this.ogl=setTimeout(()=>{this.flag=!0;hc?(this.xbf=this.nj.notificationBar.pX(xi.N2k,!0),this.xbf.image=5,this.xbf.SV=xi.n8b,this.nj.notificationBar.Vh(this.xbf),this.Ykj=!0):(this.ybf=this.nj.notificationBar.pX(xi.wyb,!0),this.ybf.image=5,this.ybf.SV=xi.n8b,this.nj.notificationBar.Vh(this.ybf))},
Nb+3E3))):Qc||(this.ogl=setTimeout(()=>{const $c=this.nj.notificationBar.pX(hc?xi.N2k:xi.wyb,!1);$c.displayTimeoutSeconds=2;$c.image=5;$c.SV=xi.n8b;this.nj.notificationBar.Vh($c)},Nb+3E3))}}}xi.wyb=ResourceStrings.l_AnimationPreviewStartToastString;xi.N2k=ResourceStrings.l_AnimationPreviewExitToastString;xi.n8b="AnimFxEntranceScale_16";Object(e.a)(xi,"AnimationPreviewToast",null,[]);class uj{get name(){return"PowerPointWebEditor.Preview"}lc(Ua){const Nb=Ua.resolve("PowerPointWebEditor.IApplicationSettings");
if(Nb.isAnimationPreviewEnabled){Kb.aql(Ua);const hc=Ua.resolve("PowerPointWebEditor.ISlideShowCoreHelper"),Qc=Ua.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),$c=Qc.sP();Ua.register(732,"PowerPointWebEditor.AnimationPreviewToast").ma().na(()=>new xi(Ua.resolve("Box4.IAppFrame")));if(hc.SGe||hc.RGe)Ua.register(733,"PowerPointWebEditor.IResourceProviderManager").ma().na(()=>new Mi(Nb,Ua.resolve("PowerPointWebEditor.Core.ICoreEventSource"),Ua.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,
h.AFrameworkApplication.ye,Ua.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),Ua.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"))),Ua.register(734,"PowerPointWebEditor.IPreviewFrame").ma().na(()=>new gh($c,Nb,Ua.resolve("PowerPoint.IPathManager"),hc.getSettings(),Ua.resolve("PowerPointWebEditor.AnimationPreviewToast"),Ua.resolve("PowerPointWebEditor.ISlideShowCoreHelper"))),Ua.register(735,"PowerPointWebEditor.AnimationPreviewStateListener").ma().na(()=>new Oi(l.a.instance.resolve("PowerPointWebEditor.View.IViewEventNotifier"))),
Ua.register(736,"PowerPointWebEditor.TransitionPreviewStateListener").ma().na(()=>new Ti),Ua.register(737,"PowerPointWebEditor.IPreviewManager").ma().na(()=>new Ch(Ua.resolve("PowerPointWebEditor.IPreviewFrame"),Ua.resolve("PowerPointWebEditor.IResourceProviderManager"),l.a.instance.resolve("PowerPointWebEditor.View.IViewEventNotifier"),Ua.resolve("Common.IActionManagerExtended"),Ua.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),Ua.resolve("PowerPointWebEditor.IZoomContext"),
Ua.resolve("PowerPointWebEditor.IPresentationReader"),Qc,Ua.resolve("PowerPointWebEditor.AnimationPreviewStateListener"),Ua.resolve("PowerPointWebEditor.TransitionPreviewStateListener"),Ua.resolve("PowerPointWebEditor.AnimationPreviewToast"))),hc.DLl.then(()=>{Ua.resolve("PowerPointWebEditor.IPreviewManager").v1m(Ua.resolve("PowerPointWebEditor.ISessionInfoOwner").rp,h.AFrameworkApplication.userSessionId,Ua.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,hc.getSettings())})}}init(){}dispose(){}static main(){y.a.instance.Fc(new uj)}}
Object(e.a)(uj,"PreviewPackage",null,[3,4]);class Ma{constructor(Ua,Nb,hc,Qc,$c,Hd,$d){this.Bab=new z.a;this.i1f=this.j1f=null;this.SHl=this.R$c=0;this.hka=this.gHj=this.fHj=!1;this.x1d=kc.a.gE(2,0,!1);this.LMc=kc.a.gE(2,1,!1);this.fh=!1;this.ipg=Ua;this.zGc=hc;this.qA=Qc;this.ty=Nb;this.qKl=$d;this.ic=$c;this.fh=Hd.getBooleanAppSetting(Ae.a.tI);if(this.hka=Hd.BEe)Ua=Hd.Jxh,this.x1d=kc.a.gE(Ua,0,!1),this.LMc=kc.a.gE(Ua,1,!1)}get Yc(){return this.zGc.Yc}bcd(Ua,Nb,hc,Qc){if(!Nb)return!1;this.fHj||(this.R$c=
Date.now(),this.fHj=!0);Nb=!1;try{if(this.qA.Ygl(hc.shapeNode)){this.Bab.clear();this.fwm();const $c=this.YMm(hc);if(Ua){const $d=this.qA.xTm(this.qA.Bna(hc,Ua),this.X7c($c),this.Yc,this.x1d,this.LMc);if($d.top||$d.bottom||$d.left||$d.right)Nb=!0,this.qA.QVg(hc,$d);if(this.qKl){const ue=this.qA.GOm(this.qA.Bna(hc,Ua),$c,this.x1d,this.LMc,Qc);if(ue.top||ue.bottom||ue.left||ue.right)Nb=!0,this.qA.QVg(hc,ue);const Fe=this.qA.HOm(this.qA.Bna(hc,Ua),$c,this.Yc,this.LMc,Qc,Ua);if(Fe.top||Fe.bottom||Fe.left||
Fe.right)Nb=!0,this.qA.QVg(hc,Fe);const cf=this.qA.qQm(this.qA.Bna(hc,Ua),$c,this.Yc,this.LMc,Qc,Ua);if(cf.top||cf.bottom||cf.left||cf.right)Nb=!0,this.qA.QVg(hc,cf)}}else Nb=this.qA.vRn(hc,this.qA.Bna(hc,Ua),this.X7c($c),this.Yc,this.x1d,this.LMc);this.Bab.addRange(this.qA.Zvm(this.qA.Bna(hc,Ua),this.X7c($c),this.Yc));const Hd=this.qA.Rze(this.qA.Bna(hc,Ua),this.X7c($c));if(Hd.count)this.Bab.addRange(Hd);else if(!Nb){let $d;$d=Ua?this.qA.uRn(this.qA.Bna(hc,!0),this.X7c($c),hc):this.qA.tRn(this.qA.Bna(hc,
!1),this.X7c($c),hc,this.LMc,this.x1d);this.Bab.addRange($d);Nb=!!$d&&0<$d.count}if(this.qKl)if(Ua)this.Bab.addRange(this.qA.gbi(this.qA.Bna(hc,Ua),this.qA.O7c($c),this.Yc,Qc,Ua)),this.Bab.addRange(this.qA.Owd(this.qA.Bna(hc,Ua),this.qA.O7c($c),this.Yc,Qc,Ua)),this.Bab.addRange(this.qA.bwm(this.qA.Bna(hc,Ua),this.qA.O7c($c),Qc));else{const $d=this.qA.Owd(this.qA.Bna(hc,Ua),this.qA.O7c($c),this.Yc,Qc,Ua);if($d.count)this.Bab.addRange($d);else if(!Nb){const Fe=this.qA.U5l(this.qA.Bna(hc,!1),this.X7c($c),
hc,this.Yc,this.LMc,this.x1d);this.Bab.addRange(this.qA.Owd(this.qA.Bna(hc,Ua),this.qA.O7c($c),this.Yc,Qc,Ua));Nb=Fe}const ue=this.qA.gbi(this.qA.Bna(hc,Ua),this.qA.O7c($c),this.Yc,Qc,Ua);if(ue.count)this.Bab.addRange(ue);else if(!Nb){const Fe=this.qA.U5l(this.qA.Bna(hc,!1),this.X7c($c),hc,this.Yc,this.LMc,this.x1d);this.Bab.addRange(this.qA.gbi(this.qA.Bna(hc,Ua),this.qA.O7c($c),this.Yc,Qc,Ua));Nb=Fe}}this.ipg.fxi(this.Bab.toArray());this.ipg.visible=!0}}catch($c){this.gHj||(B.a.J(507799757,815,
10,"SmartGuide - moving error {0}",$c.toString()),this.gHj=!0)}return Nb}Zrh(Ua){Ua&&(this.ipg.visible=!1,this.i1f=this.j1f=null,this.Bab.clear(),this.ipg.fxi([]),this.SHl=Date.now(),this.gHj=this.fHj=!1,B.a.J(507799756,815,50,"SmartGuide - moving timespan {0}",(this.SHl-this.R$c).toString()))}Qjl(){this.ipg.fxi([]);this.Bab.clear()}get DA(){var Ua,Nb;return this.fh?null!==(Nb=null===(Ua=this.ic)||void 0===Ua?void 0:Ua.DA)&&void 0!==Nb?Nb:1:1}fwm(){this.qA.LOl=this.ty.Nr(this.Yc.yM.offsetLeft-this.Yc.Mc.scrollLeft/
this.DA);this.qA.MOl=this.ty.Nr(this.Yc.yM.offsetTop-this.Yc.Mc.scrollTop/this.DA)}YMm(Ua){return this.j1f?this.j1f:this.j1f=this.qA.XMm(this.qA.fTm(this.Yc,this.Yc.Oa),Ua)}X7c(Ua){return this.i1f?this.i1f:this.i1f=this.qA.O7c(Ua)}}Object(e.a)(Ma,"SmartGuideManager",null,[729]);var jc=a(371);class Lc{constructor(){this.bnh=this.$Q=null;this.Znh=0;this.mZd=this.w7d=null;this.d8k=!1}get color(){return this.$Q}set color(Ua){this.$Q=Ua}get dashStyle(){return this.bnh}set dashStyle(Ua){this.bnh=Ua}get zJf(){return this.Znh}set zJf(Ua){this.Znh=
Ua}get Vm(){return this.w7d}set Vm(Ua){this.w7d=Ua}get kn(){return this.mZd}set kn(Ua){this.mZd=Ua}get Zja(){return this.d8k}set Zja(Ua){this.d8k=Ua}length(){let Ua=-1;this.w7d&&this.mZd&&(Ua=Math.sqrt(Math.pow(this.mZd._x-this.w7d._x,2)+Math.pow(this.mZd._y-this.w7d._y,2)));return Ua}reset(){const Ua=new Lc;this.$Q=Ua.$Q;this.bnh=Ua.bnh;this.Znh=Ua.Znh;this.w7d=Ua.w7d;this.mZd=Ua.mZd}}Object(e.a)(Lc,"SmartGuideLine",null,[777]);class gd{constructor(Ua,Nb,hc,Qc){this.distance=Ua;this.R7h=Nb;this.Myi=
hc;this.direction=Qc}}Object(e.a)(gd,"DistancePair",null,[]);class Md{constructor(Ua,Nb){this.shape=Ua;this.Wy=Nb}}Object(e.a)(Md,"LightSet",null,[]);class Kd{constructor(Ua,Nb,hc,Qc){this.begin=Ua;this.end=Nb;this.shape=hc;this.distance=Qc}}Object(e.a)(Kd,"LightSetItem",null,[]);class ye{constructor(){this.PVb={};this.UJl=[]}ha(Ua){return this.PVb[Ua]}K(Ua,Nb){Ua in this.PVb||this.UJl.push(Ua);return this.PVb[Ua]=Nb}get keys(){return this.UJl}}Object(e.a)(ye,"NumberDictionary",null,[]);class Se{constructor(Ua,
Nb){this.first=Ua;this.second=Nb}}Object(e.a)(Se,"NumberPair",null,[]);var Pe=a(1220);class Qf{constructor(Ua,Nb){this.lOj=[];this.Lo=5;this.lab=this.MY=2;this.Bza=4;this.r8=3;this.Roh=this.Qoh=0;this.ty=Ua;this.RHe=Nb}fTm(Ua,Nb){Ua=Ng.GraphIterator.pb(Ua.hb);const hc=[];for(var Qc=Ua.Bb(1);Qc;Qc=Ua.xf(1))Qc=eg.a(Qc,Nb),hc.push(Qc);return hc}Bna(Ua,Nb){for(const hc of this.lOj)if(hc.NI(Ua))return hc.Bna(Ua,Nb);return null}addHandler(Ua){this.lOj.push(Ua)}tRn(Ua,Nb,hc,Qc,$c){Qc=this.Rxh(Qc,Qf.ych);
$c=this.Rxh($c,Qf.ych);for(var Hd of Qc){Qc=Ua.copy();Qc.move(0,0-Hd);Qc=this.Rze(Qc,Nb);if(Qc.count)return this.YYc(hc,0,-Hd),Qc;Qc=Ua.copy();Qc.move(0,Hd);Qc=this.Rze(Qc,Nb);if(Qc.count)return this.YYc(hc,0,Hd),Qc}for(const $d of $c){Hd=Ua.copy();Hd.move(0-$d,0);Hd=this.Rze(Hd,Nb);if(Hd.count)return this.YYc(hc,-1*$d,0),Hd;Hd=Ua.copy();Hd.move($d,0);Hd=this.Rze(Hd,Nb);if(Hd.count)return this.YYc(hc,$d,0),Hd}return new z.a}Rxh(Ua,Nb){const hc=new z.a;Ua/=Nb;let Qc=0;for(let $c=0;$c<Nb;++$c)Qc+=Ua,
hc.add(Qc);return hc}uRn(Ua,Nb,hc){var Qc=[];for(const $c of Qc)if(Qc=Ua.copy(),Qc.setOffsets($c),Qc=this.Rze(Qc,Nb),Qc.count)return this.QVg(hc,$c),Qc;return new z.a}O7c(Ua){const Nb=[];for(const hc of Ua)Nb.push(new Pe.a(hc.Zt()));return Nb}vRn(Ua,Nb,hc,Qc,$c,Hd){const $d=new lb.a(Number.MAX_VALUE,Number.MAX_VALUE);let ue=Number.MAX_VALUE;var Fe=Number.MAX_VALUE;let cf=[];for(const Ee of hc)cf.push(Ee);this.RHe&&(cf=this.spm(cf,Qc));for(const Ee of cf)hc=this.xQm(Nb,Ee,ue),Math.abs($d.y)>Math.abs(hc)&&
($d.y=hc),ue=Math.abs(hc),hc=this.wQm(Nb,Ee,Fe),Math.abs($d.x)>Math.abs(hc)&&($d.x=hc),Fe=Math.abs(hc);Fe=this.uOm(Nb,ue,Qc);Math.abs($d.y)>Math.abs(Fe)&&($d.y=Fe);Fe=this.tOm(Nb,ue,Qc);Math.abs($d.x)>Math.abs(Fe)&&($d.x=Fe);Math.abs($d.x)>$c&&($d.x=0);Math.abs($d.y)>Hd&&($d.y=0);return $d.x||$d.y?(this.YYc(Ua,$d.x,$d.y),!0):!1}spm(Ua,Nb){var hc=this.ty.Nr(Nb.Yd.width);Nb=this.ty.Nr(Nb.Yd.height);var Qc=new Pe.a(new ff.a(new lb.a(0,0),new lb.a(hc,0),new lb.a(hc,Nb),new lb.a(0,Nb)));Ua.push(Qc);Qc=
new Pe.a(new ff.a(new lb.a(0,0),new lb.a(hc,0),new lb.a(hc,Nb/2),new lb.a(0,Nb/2)));Ua.push(Qc);hc=new Pe.a(new ff.a(new lb.a(0,0),new lb.a(hc/2,0),new lb.a(hc/2,Nb),new lb.a(0,Nb)));Ua.push(hc);return Ua}QVg(Ua,Nb){this.pDe(Ua,hc=>{hc.setOffsets(Ua,Nb)})}YYc(Ua,Nb,hc){this.pDe(Ua,Qc=>{Qc.setPosition(Ua,Nb,hc)})}pDe(Ua,Nb){for(const hc of this.lOj)if(hc.NI(Ua)){Nb(hc);break}}xTm(Ua,Nb,hc,Qc,$c){let Hd=Number.MAX_VALUE,$d=Number.MAX_VALUE,ue=Number.MAX_VALUE,Fe=Number.MAX_VALUE;var cf=[];for(var Ee of Nb)cf.push(Ee.copy());
Nb=this.ty.Nr(hc.Yd.width);hc=this.ty.Nr(hc.Yd.height);Ee=new Pe.a(new ff.a(new lb.a(0,0),new lb.a(Nb,0),new lb.a(Nb,hc),new lb.a(0,hc)));cf.push(Ee);this.RHe&&(Ee=new Pe.a(new ff.a(new lb.a(0,0),new lb.a(Nb,0),new lb.a(Nb,hc/2),new lb.a(0,hc/2))),cf.push(Ee),Nb=new Pe.a(new ff.a(new lb.a(0,0),new lb.a(Nb/2,0),new lb.a(Nb/2,hc),new lb.a(0,hc))),cf.push(Nb));for(const xe of cf)cf=this.yvh([xe.xd-Ua.Xc,xe.Xc-Ua.Xc,xe.ej().y-Ua.Xc],$c),this.SLa(cf,$c)&&Math.abs(cf)<Math.abs(Hd)&&(Hd=cf),cf=this.yvh([xe.xd-
Ua.xd,xe.Xc-Ua.xd,xe.ej().y-Ua.xd],$c),this.SLa(cf,$c)&&Math.abs(cf)<Math.abs($d)&&($d=cf),cf=this.yvh([xe.Ic-Ua.Ic,xe.Bd-Ua.Ic,xe.ej().x-Ua.Ic],Qc),this.SLa(cf,Qc)&&Math.abs(cf)<Math.abs(ue)&&(ue=cf),cf=this.yvh([xe.Ic-Ua.Bd,xe.Bd-Ua.Bd,xe.ej().x-Ua.Bd],Qc),this.SLa(cf,Qc)&&Math.abs(cf)<Math.abs(Fe)&&(Fe=cf);Ua=new jc.a;Ua.top=Hd===Number.MAX_VALUE?Ua.top:Hd;Ua.bottom=$d===Number.MAX_VALUE?Ua.bottom:$d;Ua.left=ue===Number.MAX_VALUE?Ua.left:ue;Ua.right=Fe===Number.MAX_VALUE?Ua.right:Fe;return Ua}Ygl(Ua){let Nb=
!1;Ga.a("EnableSmartGuideForTableAndVideo")&&(Nb=Ua.Zc||Ua.rq);return Ua.Vsa||Ua.Kg||Ua.pl||Ua.om||Ua.rg||Nb}getDistance(Ua,Nb){return Math.abs(Ua-Nb)}xQm(Ua,Nb,hc){Ua=[new Se(Ua.Xc,Nb.Xc),new Se(Ua.Xc,Nb.xd),new Se(Ua.Xc,Nb.ej().y),new Se(Ua.xd,Nb.Xc),new Se(Ua.xd,Nb.xd),new Se(Ua.xd,Nb.ej().y),new Se(Ua.ej().y,Nb.Xc),new Se(Ua.ej().y,Nb.xd),new Se(Ua.ej().y,Nb.ej().y)];return this.Jhh(Ua,hc)}wQm(Ua,Nb,hc){Ua=[new Se(Ua.Ic,Nb.Ic),new Se(Ua.Ic,Nb.Bd),new Se(Ua.Ic,Nb.ej().x),new Se(Ua.Bd,Nb.Ic),new Se(Ua.Bd,
Nb.Bd),new Se(Ua.Bd,Nb.ej().x),new Se(Ua.ej().x,Nb.Ic),new Se(Ua.ej().x,Nb.Bd),new Se(Ua.ej().x,Nb.ej().x)];return this.Jhh(Ua,hc)}uOm(Ua,Nb,hc){hc=this.ty.Nr(hc.Yd.height);Ua=[new Se(Ua.Xc,0),new Se(Ua.Xc,hc),new Se(Ua.xd,0),new Se(Ua.xd,hc),new Se(Ua.ej().y,0),new Se(Ua.ej().y,hc)];return this.Jhh(Ua,Nb)}tOm(Ua,Nb,hc){hc=this.ty.Nr(hc.Yd.width);Ua=[new Se(Ua.Ic,0),new Se(Ua.Ic,hc),new Se(Ua.Bd,0),new Se(Ua.Bd,hc),new Se(Ua.ej().x,0),new Se(Ua.ej().x,hc)];return this.Jhh(Ua,Nb)}Jhh(Ua,Nb){let hc=
Number.MAX_VALUE;for(const Qc of Ua)Ua=this.getDistance(Qc.first,Qc.second),Ua<Nb&&(Nb=Ua,hc=Qc.second-Qc.first);return hc}SLa(Ua,Nb){Ua=Math.abs(Ua);return.2<Ua&&Ua<Nb}yvh(Ua,Nb){let hc=Number.MAX_VALUE;for(const Qc of Ua)this.SLa(Qc,Nb)&&Math.abs(hc)>Math.abs(Qc)&&(hc=Qc);return hc}XMm(Ua,Nb){const hc=new z.a;for(const Qc of Ua)this.Ygl(Qc.shapeNode)&&Qc.hb!==Nb.hb&&hc.add(Qc);return hc.toArray()}Rze(Ua,Nb){var hc=new z.a;hc.add(Ua);var Qc=new z.a;Qc.add(Ua);var $c=new z.a;$c.add(Ua);var Hd=new z.a;
Hd.add(Ua);for(const $d of Nb)$d.xd<Ua.Xc||$d.Xc>Ua.xd||($d.Ic<Ua.Ic&&this.uah(hc,$d,2),$d.Bd>Ua.Bd&&this.uah(Qc,$d,3)),$d.Bd<Ua.Ic||$d.Ic>Ua.Bd||($d.Xc<Ua.Xc&&this.uah($c,$d,0),$d.xd>Ua.xd&&this.uah(Hd,$d,1));Ua=this.Lhh(hc,2);Qc=this.Lhh(Qc,3);Nb=this.Lhh($c,0);hc=this.Lhh(Hd,1);Hd=new ye;this.Udh(Hd,Ua[0]);this.Udh(Hd,Qc[0]);$c=new ye;this.Udh($c,Nb[0]);this.Udh($c,hc[0]);this.$fh(Hd,Ua,2);this.$fh(Hd,Qc,3);this.$fh($c,Nb,0);this.$fh($c,hc,1);Ua=new z.a;Qc=new z.a;this.Cml(Hd,Ua,Qc);this.Cml($c,
Ua,Qc);this.afd(Ua,1);this.afd(Qc,2);Ua.addRange(Qc);for(const $d of Ua)this.kW($d);return Ua}Lhh(Ua,Nb){const hc=new z.a;for(let $c=0;$c<Ua.count;++$c){var Qc=new Kd(this.MNm(Ua,$c,Nb),this.XNm(Ua,$c,Nb),null,-1);Qc=new Md(Ua.ha($c),[Qc]);for(let Hd=$c+1;Hd<Ua.count;++Hd){const $d=Qc.Wy.length;let ue=$d;for(let Fe=0;Fe<$d;++Fe)if(!Qc.Wy[Fe].shape&&-1===Qc.Wy[Fe].distance&&Qc.Wy[Fe].end>Qc.Wy[Fe].begin){const cf=this.lOm(Ua,$c,Hd,Nb);ue+=this.WAn(Ua,Hd,Fe,ue,$c,cf,Qc,Nb);ue+=this.YAn(Ua,Hd,Fe,ue,
$c,cf,Qc,Nb);ue+=this.qBn(Ua,Hd,Fe,ue,$c,cf,Qc,Nb);ue+=this.XAn(Ua,Hd,Fe,$c,cf,Qc,Nb)}}hc.add(Qc)}return hc.toArray()}Cml(Ua,Nb,hc){for(const $c of Ua.keys){var Qc=Ua.ha($c);if(1<Qc.count){const Hd=new z.a;for(const $d of Qc){Qc=!1;for(const ue of Hd)if(this.Esm($d,ue)){Qc=!0;Hd.remove(ue);break}Qc||Hd.add($d)}for(const $d of Hd)this.jBm($d,Nb,hc)}}}Esm(Ua,Nb){return this.Xgl(Ua.R7h,Nb.R7h)&&this.Xgl(Ua.Myi,Nb.Myi)}Xgl(Ua,Nb){return Ua.Ic===Nb.Ic&&Ua.Bd===Nb.Bd&&Ua.Xc===Nb.Xc&&Ua.xd===Nb.xd}uah(Ua,
Nb,hc){const Qc=Ua.count;for(let $c=0;$c<Qc;$c++){const Hd=Ua.ha($c);if(3===hc&&(Nb.Ic<Ua.ha(0).Bd?Nb.Bd:Nb.Ic)<(Hd.Ic<Ua.ha(0).Bd?Hd.Bd:Hd.Ic)||2===hc&&(Nb.Bd>Ua.ha(0).Ic?Nb.Ic:Nb.Bd)>(Hd.Bd>Ua.ha(0).Ic?Hd.Ic:Hd.Bd)||0===hc&&(Nb.xd>Ua.ha(0).Xc?Nb.Xc:Nb.xd)>(Hd.xd>Ua.ha(0).Xc?Hd.Xc:Hd.xd)||1===hc&&(Nb.Xc<Ua.ha(0).xd?Nb.xd:Nb.Xc)<(Hd.Xc<Ua.ha(0).xd?Hd.xd:Hd.Xc)){Ua.insert($c,Nb);return}}Ua.add(Nb)}Udh(Ua,Nb){for(const hc of Nb.Wy)0<hc.distance&&Ua.K(Math.round(100*hc.distance)/100,new z.a)}$fh(Ua,
Nb,hc){const Qc=new ye;for(const $c of Nb){for(const Hd of Ua.keys)Qc.K(Hd,0);for(const Hd of $c.Wy)if(0<Hd.distance&&Hd.shape)for(const $d of Ua.keys)if(Nb=$d,this.PT(Hd.distance,Nb)){const ue=Qc.ha($d);1>ue&&(Ua.ha($d).add(new gd(Nb,$c.shape,Hd.shape,hc)),Qc.K($d,ue+1));break}}}MNm(Ua,Nb,hc){Nb=Ua.ha(Nb);Ua=Ua.ha(0);switch(hc){case 2:case 3:return Math.max(Nb.Xc,Ua.Xc);case 0:case 1:return Math.max(Nb.Ic,Ua.Ic);default:return-1}}XNm(Ua,Nb,hc){Nb=Ua.ha(Nb);Ua=Ua.ha(0);switch(hc){case 2:case 3:return Math.min(Nb.xd,
Ua.xd);case 0:case 1:return Math.min(Nb.Bd,Ua.Bd);default:return-1}}WAn(Ua,Nb,hc,Qc,$c,Hd,$d,ue){const Fe=Ua.ha(Nb);$c=Ua.ha($c);switch(ue){case 3:case 2:if(Fe.xd>=$d.Wy[hc].begin&&Fe.xd<=$d.Wy[hc].end&&Fe.Xc<=$d.Wy[hc].begin)return Ua=new Kd($d.Wy[hc].begin,Fe.xd,Ua.ha(Nb),3===ue?Hd-$c.Bd:$c.Ic-Hd),$d.Wy[Qc]=Ua,$d.Wy[hc].begin=Fe.xd,1;break;case 0:case 1:if(Fe.Bd>=$d.Wy[hc].begin&&Fe.Bd<=$d.Wy[hc].end&&Fe.Ic<=$d.Wy[hc].begin)return Ua=new Kd($d.Wy[hc].begin,Fe.Bd,Ua.ha(Nb),0===ue?$c.Xc-Hd:Hd-$c.xd),
$d.Wy[Qc]=Ua,$d.Wy[hc].begin=Fe.Bd,1}return 0}YAn(Ua,Nb,hc,Qc,$c,Hd,$d,ue){const Fe=Ua.ha(Nb);$c=Ua.ha($c);switch(ue){case 3:case 2:if(Fe.Xc>=$d.Wy[hc].begin&&Fe.Xc<=$d.Wy[hc].end&&Fe.xd>=$d.Wy[hc].end)return Ua=new Kd(Fe.Xc,$d.Wy[hc].end,Ua.ha(Nb),3===ue?Hd-$c.Bd:$c.Ic-Hd),$d.Wy[Qc]=Ua,$d.Wy[hc].end=Fe.Xc,1;break;case 0:case 1:if(Fe.Ic>=$d.Wy[hc].begin&&Fe.Ic<=$d.Wy[hc].end&&Fe.Bd>=$d.Wy[hc].end)return Ua=new Kd(Fe.Ic,$d.Wy[hc].end,Ua.ha(Nb),0===ue?$c.Xc-Hd:Hd-$c.xd),$d.Wy[Qc]=Ua,$d.Wy[hc].end=Fe.Ic,
1}return 0}qBn(Ua,Nb,hc,Qc,$c,Hd,$d,ue){const Fe=Ua.ha(Nb);$c=Ua.ha($c);switch(ue){case 3:case 2:if(Fe.Xc>$d.Wy[hc].begin&&Fe.Xc<$d.Wy[hc].end&&Fe.xd>$d.Wy[hc].begin&&Fe.xd<$d.Wy[hc].end)return Ua=new Kd(Fe.Xc,Fe.xd,Ua.ha(Nb),3===ue?Hd-$c.Bd:$c.Ic-Hd),$d.Wy[Qc]=Ua,Ua=new Kd(Fe.xd,$d.Wy[hc].end,null,-1),$d.Wy[++Qc]=Ua,$d.Wy[hc].end=Fe.Xc,2;break;case 0:case 1:if(Fe.Ic>$d.Wy[hc].begin&&Fe.Ic<$d.Wy[hc].end&&Fe.Bd>$d.Wy[hc].begin&&Fe.Bd<$d.Wy[hc].end)return Ua=new Kd(Fe.Ic,Fe.Bd,Ua.ha(Nb),0===ue?$c.Xc-
Hd:Hd-$c.xd),$d.Wy[Qc]=Ua,Ua=new Kd(Fe.Bd,$d.Wy[hc].end,null,-1),$d.Wy[++Qc]=Ua,$d.Wy[hc].end=Fe.Ic,2}return 0}XAn(Ua,Nb,hc,Qc,$c,Hd,$d){const ue=Ua.ha(Nb);Qc=Ua.ha(Qc);switch($d){case 3:case 2:ue.Xc<Hd.Wy[hc].begin&&ue.xd>Hd.Wy[hc].end&&(Hd.Wy[hc].shape=Ua.ha(Nb),Hd.Wy[hc].distance=3===$d?$c-Qc.Bd:Qc.Ic-$c);break;case 0:case 1:ue.Ic<Hd.Wy[hc].begin&&ue.Bd>Hd.Wy[hc].end&&(Hd.Wy[hc].shape=Ua.ha(Nb),Hd.Wy[hc].distance=0===$d?Qc.Xc-$c:$c-Qc.xd)}return 0}lOm(Ua,Nb,hc,Qc){let $c=-1;hc=Ua.ha(hc);Ua=Ua.ha(Nb);
switch(Qc){case 3:hc.Ic<Ua.Bd&&hc.Bd>=Ua.Bd&&($c=hc.Bd);hc.Ic>=Ua.Bd&&($c=hc.Ic);break;case 2:hc.Bd>Ua.Ic&&hc.Ic<=Ua.Ic&&($c=hc.Ic);hc.Bd<=Ua.Ic&&($c=hc.Bd);break;case 0:hc.xd>Ua.Xc&&hc.Xc<=Ua.Xc&&($c=hc.Xc);hc.xd<=Ua.Xc&&($c=hc.xd);break;case 1:hc.Xc<Ua.xd&&hc.xd>=Ua.xd&&($c=hc.xd),hc.Xc>=Ua.xd&&($c=hc.Xc)}return $c}jBm(Ua,Nb,hc){const Qc=Ua.R7h;var $c=Ua.Myi;switch(Ua.direction){case 3:var Hd=Math.max(Qc.xd,$c.xd),$d=new Lc;$d.Vm=new lb.a(Qc.Bd-this.r8,Qc.Xc);$d.kn=new lb.a(Qc.Bd-this.r8,Hd+this.Lo);
Nb.add($d);$d=new Lc;$d.Vm=new lb.a(Qc.Bd+Ua.distance-this.r8,$c.Xc);$d.kn=new lb.a(Qc.Bd+Ua.distance-this.r8,Hd+this.Lo);Nb.add($d);Nb=new Lc;Nb.Vm=new lb.a(Qc.Bd-this.r8,Hd+this.Lo);Nb.kn=new lb.a(Qc.Bd+Ua.distance-this.r8,Hd+this.Lo);hc.add(Nb);break;case 2:Hd=Math.max(Qc.xd,$c.xd);$d=new Lc;$d.Vm=new lb.a(Qc.Ic-Ua.distance-this.r8,$c.Xc);$d.kn=new lb.a(Qc.Ic-Ua.distance-this.r8,Hd+this.Lo);Nb.add($d);$c=new Lc;$c.Vm=new lb.a(Qc.Ic-this.r8,Qc.Xc);$c.kn=new lb.a(Qc.Ic-this.r8,Hd+this.Lo);Nb.add($c);
Nb=new Lc;Nb.Vm=new lb.a(Qc.Ic-Ua.distance-this.r8,Hd+this.Lo);Nb.kn=new lb.a(Qc.Ic-this.r8,Hd+this.Lo);hc.add(Nb);break;case 0:Hd=Math.max(Qc.Bd,$c.Bd);$d=new Lc;$d.Vm=new lb.a(Qc.Ic,Qc.Xc-this.MY);$d.kn=new lb.a(Hd+this.Lo,Qc.Xc-this.MY);Nb.add($d);$d=new Lc;$d.Vm=new lb.a($c.Ic,Qc.Xc-Ua.distance-this.MY);$d.kn=new lb.a(Hd+this.Lo,Qc.Xc-Ua.distance-this.MY);Nb.add($d);Nb=new Lc;Nb.Vm=new lb.a(Hd+this.Lo,Qc.Xc-this.MY);Nb.kn=new lb.a(Hd+this.Lo,Qc.Xc-Ua.distance-this.MY);hc.add(Nb);break;case 1:Hd=
Math.max(Qc.Bd,$c.Bd),$d=new Lc,$d.Vm=new lb.a(Qc.Ic,Qc.xd-this.MY),$d.kn=new lb.a(Hd+this.Lo,Qc.xd-this.MY),Nb.add($d),$d=new Lc,$d.Vm=new lb.a($c.Ic,Qc.xd+Ua.distance-this.MY),$d.kn=new lb.a(Hd+this.Lo,Qc.xd+Ua.distance-this.MY),Nb.add($d),Nb=new Lc,Nb.Vm=new lb.a(Hd+this.Lo,Qc.xd-this.MY),Nb.kn=new lb.a(Hd+this.Lo,Qc.xd+Ua.distance-this.MY),hc.add(Nb)}}bwm(Ua,Nb,hc){const Qc=new z.a;if(!hc)return Qc;let $c=!1;var Hd=!1;const $d=hc.equals(jf.a.west)||hc.equals(jf.a.WB)||hc.equals(jf.a.p_),ue=hc.equals(jf.a.east)||
hc.equals(jf.a.jW)||hc.equals(jf.a.ES),Fe=hc.equals(jf.a.north)||hc.equals(jf.a.WB)||hc.equals(jf.a.jW);hc=hc.equals(jf.a.south)||hc.equals(jf.a.p_)||hc.equals(jf.a.ES);for(const Ee of Nb){if(this.KDl(Ua,Ee,!0,Nb)&&($d||ue)){$c=!0;var cf=new Lc;cf.Vm=new lb.a(Ee.Ic,Ee.ej()._y);cf.kn=new lb.a(Ee.Bd-this.r8,Ee.ej()._y);cf.Zja=!0;Qc.add(this.kW(cf))}this.KDl(Ua,Ee,!1,Nb)&&(Fe||hc)&&(Hd=!0,cf=new Lc,cf.Vm=new lb.a(Ee.ej()._x,Ee.Xc),cf.kn=new lb.a(Ee.ej()._x,Ee.xd-this.lab),cf.Zja=!1,Qc.add(this.kW(cf)))}$c&&
(Nb=new Lc,Nb.Vm=new lb.a(Ua.Ic,Ua.ej()._y),Nb.kn=new lb.a(Ua.Bd-this.r8,Ua.ej()._y),Nb.Zja=!0,Qc.add(this.kW(Nb)));Hd&&(Hd=new Lc,Hd.Vm=new lb.a(Ua.ej()._x,Ua.Xc),Hd.kn=new lb.a(Ua.ej()._x,Ua.xd-this.lab),Hd.Zja=!1,Qc.add(this.kW(Hd)));this.afd(Qc,2);return Qc}Vab(Ua,Nb,hc){var Qc=this.JAb(Ua,Nb,!1),$c=this.JAb(Ua,Nb,!0);if(!Qc&&!$c)return!1;let Hd=[];if(Qc){if(Ua.Bd<=Nb.Ic||Ua.Bd<=Nb.Bd){Qc=Nb.Xc>Ua.Xc?Nb.Xc:Ua.Xc;var $d=Nb.xd<Ua.xd?Nb.xd:Ua.xd,ue,Fe=ue=Nb.Ic;Ua.Bd>Nb.Ic&&(Fe=ue=Nb.Bd);Qc=new Pe.a(new ff.a(new lb.a(Fe,
Qc),new lb.a(ue,Qc),new lb.a(ue,$d),new lb.a(Fe,$d)));Array.add(Hd,Qc)}if(Ua.Ic>=Nb.Bd||Ua.Ic>=Nb.Ic)Qc=Nb.Xc>Ua.Xc?Nb.Xc:Ua.Xc,$d=Nb.xd<Ua.xd?Nb.xd:Ua.xd,Fe=ue=Nb.Bd,Ua.Ic<Nb.Bd&&(Fe=ue=Nb.Ic),Qc=new Pe.a(new ff.a(new lb.a(Fe,Qc),new lb.a(ue,Qc),new lb.a(ue,$d),new lb.a(Fe,$d))),Array.add(Hd,Qc)}if($c){if(Ua.xd<=Nb.Xc||Ua.xd<=Nb.xd)$c=Nb.Ic>Ua.Ic?Nb.Ic:Ua.Ic,Qc=Nb.Bd<Ua.Bd?Nb.Bd:Ua.Bd,ue=$d=Nb.Xc,Ua.xd>Nb.Xc&&(ue=$d=Nb.xd),$c=new Pe.a(new ff.a(new lb.a($c,ue),new lb.a(Qc,ue),new lb.a(Qc,$d),new lb.a($c,
$d))),Hd.push($c);if(Ua.Xc>=Nb.xd||Ua.Xc>=Nb.Xc)$c=Nb.Ic>Ua.Ic?Nb.Ic:Ua.Ic,Qc=Nb.Bd<Ua.Bd?Nb.Bd:Ua.Bd,ue=$d=Nb.xd,Ua.Xc<Nb.xd&&(ue=$d=Nb.Xc),$c=new Pe.a(new ff.a(new lb.a($c,ue),new lb.a(Qc,ue),new lb.a(Qc,$d),new lb.a($c,$d))),Array.add(Hd,$c)}for(const cf of hc)this.Zyl(cf,Ua)||this.Zyl(cf,Nb)||(Hd=this.OXn(Ua,cf,Hd));return 0<Hd.length?!0:!1}OXn(Ua,Nb,hc){let Qc=[];for(const $c of hc)hc=!0,$c.Ic===$c.Bd?(this.JAb($c,Nb,!1)||(hc=!1),Ua.Bd<=$c.Ic&&Nb.Bd<=Ua.Bd&&(hc=!1),Ua.Bd<=$c.Ic&&Nb.Ic>=$c.Bd&&
(hc=!1),Ua.Ic>=$c.Bd&&Nb.Ic>=Ua.Ic&&(hc=!1),Ua.Ic>=$c.Bd&&Nb.Bd<=$c.Ic&&(hc=!1),hc?Nb.Xc<=$c.Xc&&Nb.xd<$c.xd?Qc=this.bPe(Qc,!0,!0,!1,$c,Nb):Nb.xd>=$c.xd&&Nb.Xc>$c.Xc?Qc=this.bPe(Qc,!0,!1,!1,$c,Nb):Nb.Xc>$c.Xc&&Nb.xd<$c.xd&&(Qc=this.bPe(Qc,!0,!1,!0,$c,Nb)):Array.add(Qc,$c)):$c.Xc===$c.xd&&(this.JAb($c,Nb,!0)||(hc=!1),Ua.xd<=$c.Xc&&Nb.xd<=Ua.xd&&(hc=!1),Ua.xd<=$c.Xc&&Nb.Xc>=$c.xd&&(hc=!1),Ua.Xc>=$c.xd&&Nb.Xc>=Ua.Xc&&(hc=!1),Ua.Xc>=$c.xd&&Nb.xd<=$c.Xc&&(hc=!1),hc?Nb.Ic<=$c.Ic&&Nb.Bd<$c.Bd?Qc=this.bPe(Qc,
!1,!0,!1,$c,Nb):Nb.Bd>=$c.Bd&&Nb.Ic>$c.Ic?Qc=this.bPe(Qc,!1,!1,!1,$c,Nb):Nb.Ic>$c.Ic&&Nb.Bd<$c.Bd&&(Qc=this.bPe(Qc,!1,!1,!0,$c,Nb)):Array.add(Qc,$c));return Qc}bPe(Ua,Nb,hc,Qc,$c,Hd){let $d,ue,Fe,cf,Ee,xe,cg;if(hc)Nb?(hc=ue=$c.Ic,$d=Hd.xd,Fe=$c.xd):($d=Fe=$c.Xc,hc=Hd.Bd,ue=$c.Bd);else if(hc||Qc){if(Nb?(hc=ue=cf=xe=$c.Ic,$d=$c.Xc,Fe=Hd.Xc,Ee=Hd.xd,cg=$c.xd):($d=Fe=Ee=cg=$c.Xc,hc=$c.Ic,ue=Hd.Ic,cf=Hd.Bd,xe=$c.Bd),Qc&&Nb&&!this.PT(Ee,cg)||Qc&&!Nb&&!this.PT(cf,xe))Qc=new Pe.a(new ff.a(new lb.a(cf,Ee),
new lb.a(xe,Ee),new lb.a(xe,cg),new lb.a(cf,cg))),Array.add(Ua,Qc)}else Nb?(hc=ue=$c.Ic,$d=$c.Xc,Fe=Hd.Xc):($d=Fe=$c.Xc,hc=$c.Ic,ue=Hd.Ic);if(Nb&&!this.PT($d,Fe)||!Nb&&!this.PT(hc,ue))Nb=new Pe.a(new ff.a(new lb.a(hc,$d),new lb.a(ue,$d),new lb.a(ue,Fe),new lb.a(hc,Fe))),Array.add(Ua,Nb);return Ua}Zyl(Ua,Nb){return Ua.Bd!==Nb.Bd||Ua.Ic!==Nb.Ic||Ua.Xc!==Nb.Xc||Ua.xd!==Nb.xd?!1:!0}KDl(Ua,Nb,hc,Qc){if(hc)return hc=this.PT(Ua.Ic,Nb.Ic)&&this.PT(Ua.Bd,Nb.Bd),this.PT(Ua.Bd-Ua.Ic,Nb.Bd-Nb.Ic)&&!hc&&this.Vab(Ua,
Nb,Qc);hc=this.PT(Ua.Xc,Nb.Xc)&&this.PT(Ua.xd,Nb.xd);return this.PT(Ua.xd-Ua.Xc,Nb.xd-Nb.Xc)&&!hc&&this.Vab(Ua,Nb,Qc)}GOm(Ua,Nb,hc,Qc,$c){const Hd=new jc.a;if(!$c)return Hd;let $d=Number.MAX_VALUE,ue=Number.MAX_VALUE,Fe=Number.MAX_VALUE,cf=Number.MAX_VALUE;const Ee=$c.equals(jf.a.west)||$c.equals(jf.a.WB)||$c.equals(jf.a.p_),xe=$c.equals(jf.a.east)||$c.equals(jf.a.jW)||$c.equals(jf.a.ES),cg=$c.equals(jf.a.north)||$c.equals(jf.a.WB)||$c.equals(jf.a.jW);$c=$c.equals(jf.a.south)||$c.equals(jf.a.p_)||
$c.equals(jf.a.ES);const Gg=[];for(const Of of Nb)Gg.push(new Pe.a(Of.Zt()));for(const Of of Gg)Nb=Of.xd-Of.Xc-(Ua.xd-Ua.Xc),this.SLa(Nb,Qc)&&Math.abs(Nb)<Math.abs($d)&&this.Vab(Ua,Of,Gg)&&cg&&($d=-1*Nb),this.SLa(Nb,Qc)&&Math.abs(Nb)<Math.abs(ue)&&this.Vab(Ua,Of,Gg)&&$c&&(ue=Nb),Nb=Of.Bd-Of.Ic-(Ua.Bd-Ua.Ic),this.SLa(Nb,hc)&&Math.abs(Nb)<Math.abs(Fe)&&this.Vab(Ua,Of,Gg)&&Ee&&(Fe=-1*Nb),this.SLa(Nb,hc)&&Math.abs(Nb)<Math.abs(cf)&&this.Vab(Ua,Of,Gg)&&xe&&(cf=Nb);Hd.top=$d===Number.MAX_VALUE?Hd.top:$d;
Hd.bottom=ue===Number.MAX_VALUE?Hd.bottom:ue;Hd.left=Fe===Number.MAX_VALUE?Hd.left:Fe;Hd.right=cf===Number.MAX_VALUE?Hd.right:cf;return Hd}HOm(Ua,Nb,hc,Qc,$c,Hd){let $d=Number.MAX_VALUE,ue=Number.MAX_VALUE,Fe=Number.MAX_VALUE,cf=Number.MAX_VALUE,Ee=!0,xe=!0,cg=!0,Gg=!0;Hd&&$c&&(Ee=$c.equals(jf.a.west)||$c.equals(jf.a.WB)||$c.equals(jf.a.p_),xe=$c.equals(jf.a.east)||$c.equals(jf.a.jW)||$c.equals(jf.a.ES),cg=$c.equals(jf.a.north)||$c.equals(jf.a.WB)||$c.equals(jf.a.jW),Gg=$c.equals(jf.a.south)||$c.equals(jf.a.p_)||
$c.equals(jf.a.ES));$c=[];for(var Of of Nb)$c.push(new Pe.a(Of.Zt()));Nb=this.ty.Nr(hc.Yd.width);hc=this.ty.Nr(hc.Yd.height);for(const ch of $c)ch.Ic>Nb/2&&ch.Ic<3*Nb/4&&Ua.Bd<Nb/2&&xe&&(Of=Nb/2-Ua.Bd-(ch.Ic-Nb/2),this.SLa(Of,Qc)&&Math.abs(Of)<Math.abs(cf)&&this.Vab(Ua,ch,$c)&&(cf=Of)),ch.Bd<Nb/2&&ch.Bd>Nb/4&&Ua.Ic>Nb/2&&Ee&&(Of=Nb/2-ch.Bd-(Ua.Ic-Nb/2),this.SLa(Of,Qc)&&Math.abs(Of)<Math.abs(Fe)&&this.Vab(Ua,ch,$c)&&(Fe=Of)),ch.Xc>hc/2&&ch.Xc<3*hc/4&&Ua.xd<hc/2&&Gg&&(Of=hc/2-Ua.xd-(ch.Xc-hc/2),this.SLa(Of,
Qc)&&Math.abs(Of)<Math.abs(ue)&&this.Vab(Ua,ch,$c)&&(ue=Of)),ch.xd<hc/2&&ch.xd>hc/4&&Ua.Xc>hc/2&&cg&&(Of=hc/2-ch.xd-(Ua.Xc-hc/2),this.SLa(Of,Qc)&&Math.abs(Of)<Math.abs($d)&&this.Vab(Ua,ch,$c)&&($d=Of));Ua=new jc.a;Ua.top=$d===Number.MAX_VALUE?Ua.top:$d;Ua.bottom=ue===Number.MAX_VALUE?Ua.bottom:ue;Ua.left=Fe===Number.MAX_VALUE?Ua.left:Fe;Ua.right=cf===Number.MAX_VALUE?Ua.right:cf;return Ua}U5l(Ua,Nb,hc,Qc,$c,Hd){$c=this.Rxh($c,Qf.ych);Hd=this.Rxh(Hd,Qf.ych);for(var $d of $c){$c=Ua.copy();$c.move(0,
0-$d);if(this.Owd($c,Nb,Qc,null,!1).count)return this.YYc(hc,0,-$d),!0;$c=Ua.copy();$c.move(0,$d);if(this.Owd($c,Nb,Qc,null,!1).count)return this.YYc(hc,0,$d),!0}for(const ue of Hd){$d=Ua.copy();$d.move(0-ue,0);if(this.Owd($d,Nb,Qc,null,!1).count)return this.YYc(hc,-1*ue,0),!0;$d=Ua.copy();$d.move(ue,0);if(this.Owd($d,Nb,Qc,null,!1).count)return this.YYc(hc,ue,0),!0}return!1}JAb(Ua,Nb,hc){return hc?Ua.Ic>=Nb.Ic&&Ua.Ic<=Nb.Bd||Ua.Bd>=Nb.Ic&&Ua.Bd<=Nb.Bd||Nb.Ic>=Ua.Ic&&Nb.Ic<=Ua.Bd||Nb.Bd>=Ua.Ic&&Nb.Bd<=
Ua.Bd:Ua.Xc>=Nb.Xc&&Ua.Xc<=Nb.xd||Ua.xd>=Nb.Xc&&Ua.xd<=Nb.xd||Nb.Xc>=Ua.Xc&&Nb.Xc<=Ua.xd||Nb.xd>=Ua.Xc&&Nb.xd<=Ua.xd}gbi(Ua,Nb,hc,Qc,$c){const Hd=new z.a,$d=new z.a,ue=new z.a;let Fe=!1,cf=!1,Ee=!1,xe=!1,cg=!0,Gg=!0,Of=!0,ch=!0;$c&&Qc&&(cg=Qc.equals(jf.a.west)||Qc.equals(jf.a.WB)||Qc.equals(jf.a.p_),Gg=Qc.equals(jf.a.east)||Qc.equals(jf.a.jW)||Qc.equals(jf.a.ES),Of=Qc.equals(jf.a.north)||Qc.equals(jf.a.WB)||Qc.equals(jf.a.jW),ch=Qc.equals(jf.a.south)||Qc.equals(jf.a.p_)||Qc.equals(jf.a.ES));Qc=this.ty.Nr(hc.Yd.width);
hc=this.ty.Nr(hc.Yd.height);$c=new Lc;$c.Vm=new lb.a(Qc/2-this.Bza,0-this.MY);$c.kn=new lb.a(Qc/2-this.Bza,hc-this.MY);const vg=new Lc;vg.Vm=new lb.a(0-this.Bza,hc/2-this.MY);vg.kn=new lb.a(Qc-this.Bza,hc/2-this.MY);vg.Zja=!0;for(const jg of Nb)jg.Ic>Qc/2&&jg.Ic<3*Qc/4&&Ua.Bd<Qc/2&&this.Vab(Ua,jg,Nb)&&Gg&&this.PT(Qc/2-Ua.Bd,jg.Ic-Qc/2)&&(Fe=!0,0>jg.Xc&&($c.Vm=new lb.a(Qc/2,jg.Xc)),jg.xd>hc&&($c.kn=new lb.a(Qc/2,jg.xd+this.Lo)),Hd.add(this.w4c(jg,!1,!1)),$d.add(this.t4c(jg,!1,!1,Qc,hc))),jg.Bd<Qc/
2&&jg.Bd>Qc/4&&Ua.Ic>Qc/2&&this.Vab(Ua,jg,Nb)&&cg&&this.PT(Ua.Ic-Qc/2,Qc/2-jg.Bd)&&(cf=!0,0>jg.Xc&&($c.Vm=new lb.a(Qc/2,jg.Xc)),jg.xd>hc&&($c.kn=new lb.a(Qc/2,jg.xd+this.Lo)),Hd.add(this.w4c(jg,!1,!0)),$d.add(this.t4c(jg,!1,!0,Qc,hc))),jg.Xc>hc/2&&jg.Xc<3*hc/4&&Ua.xd<hc/2&&this.Vab(Ua,jg,Nb)&&ch&&this.PT(hc/2-Ua.xd,jg.Xc-hc/2)&&(Ee=!0,0>jg.Ic&&(vg.Vm=new lb.a(jg.Ic,hc/2)),jg.Bd>Qc&&(vg.kn=new lb.a(jg.Bd+this.Lo,hc/2)),Hd.add(this.w4c(jg,!0,!1)),$d.add(this.t4c(jg,!0,!1,Qc,hc))),jg.xd<hc/2&&jg.xd>
hc/4&&Ua.Xc>hc/2&&this.Vab(Ua,jg,Nb)&&Of&&this.PT(Ua.Xc-hc/2,hc/2-jg.xd)&&(xe=!0,0>jg.Ic&&(vg.Vm=new lb.a(jg.Ic,hc/2)),jg.Bd>Qc&&(vg.kn=new lb.a(jg.Bd+this.Lo,hc/2)),Hd.add(this.w4c(jg,!0,!0)),$d.add(this.t4c(jg,!0,!0,Qc,hc)));(Fe||cf)&&Hd.add(this.kW($c));(Ee||xe)&&Hd.add(this.kW(vg));Ee&&(Ua.Ic<vg.Vm._x&&(vg.Vm=new lb.a(Ua.Ic,hc/2)),Ua.Bd>vg.kn._x&&(vg.kn=new lb.a(Ua.Bd,hc/2+this.Lo)),Hd.add(this.w4c(Ua,!0,!0)),$d.add(this.t4c(Ua,!0,!0,Qc,hc)));xe&&(Ua.Ic<vg.Vm._x&&(vg.Vm=new lb.a(Ua.Ic,hc/2)),
Ua.Bd>vg.kn._x&&(vg.kn=new lb.a(Ua.Bd,hc/2+this.Lo)),Hd.add(this.w4c(Ua,!0,!1)),$d.add(this.t4c(Ua,!0,!1,Qc,hc)));Fe&&(Ua.Xc<$c.Vm._y&&($c.Vm=new lb.a(Qc/2,Ua.Xc)),Ua.xd>$c.kn._y&&($c.kn=new lb.a(Qc/2,Ua.xd+this.Lo)),Hd.add(this.w4c(Ua,!1,!0)),$d.add(this.t4c(Ua,!1,!0,Qc,hc)));cf&&(Ua.Xc<$c.Vm._y&&($c.Vm=new lb.a(Qc/2,Ua.Xc)),Ua.xd>$c.kn._y&&($c.kn=new lb.a(Qc/2,Ua.xd+this.Lo)),Hd.add(this.w4c(Ua,!1,!1)),$d.add(this.t4c(Ua,!1,!1,Qc,hc)));this.afd(Hd,1);this.afd($d,2);for(const jg of Hd)ue.add(jg);
for(const jg of $d)ue.add(jg);return ue}w4c(Ua,Nb,hc){const Qc=Nb&&hc,$c=Nb&&!hc,Hd=!Nb&&!hc;return!Nb&&hc?(Nb=new Lc,Nb.Vm=new lb.a(Ua.Bd-this.r8,Ua.xd),Nb.kn=new lb.a(Ua.Bd-this.r8,Ua.xd+this.Lo),this.kW(Nb)):Hd?(Nb=new Lc,Nb.Vm=new lb.a(Ua.Ic-this.Bza,Ua.xd),Nb.kn=new lb.a(Ua.Ic-this.Bza,Ua.xd+this.Lo),this.kW(Nb)):Qc?(Nb=new Lc,Nb.Vm=new lb.a(Ua.Bd,Ua.xd-this.lab),Nb.kn=new lb.a(Ua.Bd+this.Lo,Ua.xd-this.lab),this.kW(Nb)):$c?(Nb=new Lc,Nb.Vm=new lb.a(Ua.Bd,Ua.Xc-this.MY),Nb.kn=new lb.a(Ua.Bd+this.Lo,
Ua.Xc-this.MY),this.kW(Nb)):null}t4c(Ua,Nb,hc,Qc,$c){const Hd=Nb&&hc,$d=Nb&&!hc,ue=!Nb&&!hc;return!Nb&&hc?($c=new Lc,$c.Zja=!0,$c.Vm=new lb.a(Qc/2-this.Bza,Ua.xd+this.Lo),$c.kn=new lb.a(Ua.Bd-this.r8,Ua.xd+this.Lo),this.kW($c)):ue?($c=new Lc,$c.Zja=!0,$c.Vm=new lb.a(Qc/2-this.Bza,Ua.xd+this.Lo),$c.kn=new lb.a(Ua.Ic-this.Bza,Ua.xd+this.Lo),this.kW($c)):Hd?(Qc=new Lc,Qc.Zja=!0,Qc.Vm=new lb.a(Ua.Bd+this.Lo,$c/2-this.MY),Qc.kn=new lb.a(Ua.Bd+this.Lo,Ua.xd-this.lab),this.kW(Qc)):$d?(Qc=new Lc,Qc.Zja=!0,
Qc.Vm=new lb.a(Ua.Bd+this.Lo,$c/2-this.MY),Qc.kn=new lb.a(Ua.Bd+this.Lo,Ua.Xc-this.MY),this.kW(Qc)):null}qQm(Ua,Nb,hc,Qc,$c,Hd){let $d=Number.MAX_VALUE,ue=Number.MAX_VALUE,Fe=Number.MAX_VALUE,cf=Number.MAX_VALUE,Ee=!0,xe=!0,cg=!0,Gg=!0;Hd&&$c&&(Ee=$c.equals(jf.a.west)||$c.equals(jf.a.WB)||$c.equals(jf.a.p_),xe=$c.equals(jf.a.east)||$c.equals(jf.a.jW)||$c.equals(jf.a.ES),cg=$c.equals(jf.a.north)||$c.equals(jf.a.WB)||$c.equals(jf.a.jW),Gg=$c.equals(jf.a.south)||$c.equals(jf.a.p_)||$c.equals(jf.a.ES));
$c=[];for(const Of of Nb)$c.push(new Pe.a(Of.Zt()));Nb=this.ty.Nr(hc.Yd.width);hc=this.ty.Nr(hc.Yd.height);for(const Of of $c)Of.Bd>3*Nb/4&&Of.Bd<Nb&&Ua.Ic<Nb/4&&0<Ua.Ic&&this.JAb(Ua,Of,!1)&&Ee&&($c=Nb-Of.Bd-Ua.Ic,this.SLa($c,Qc)&&Math.abs($c)<Math.abs(Fe)&&(Fe=$c)),Of.Ic<Nb/4&&0<Of.Ic&&Ua.Bd>3*Nb/4&&Ua.Bd<Nb&&this.JAb(Ua,Of,!1)&&xe&&($c=Nb-Ua.Bd-Of.Ic,this.SLa($c,Qc)&&Math.abs($c)<Math.abs(cf)&&(cf=$c)),Of.xd>3*hc/4&&Of.xd<hc&&Ua.Xc<hc/4&&0<Ua.Xc&&this.JAb(Ua,Of,!0)&&cg&&($c=hc-Of.xd-Ua.Xc,this.SLa($c,
Qc)&&Math.abs($c)<Math.abs($d)&&($d=$c)),Of.Xc<hc/4&&0<Of.Xc&&Ua.xd>3*hc/4&&Ua.xd<hc&&this.JAb(Ua,Of,!0)&&Gg&&($c=hc-Ua.xd-Of.Xc,this.SLa($c,Qc)&&Math.abs($c)<Math.abs(ue)&&(ue=$c));Ua=new jc.a;Ua.top=$d===Number.MAX_VALUE?Ua.top:$d;Ua.bottom=ue===Number.MAX_VALUE?Ua.bottom:ue;Ua.left=Fe===Number.MAX_VALUE?Ua.left:Fe;Ua.right=cf===Number.MAX_VALUE?Ua.right:cf;return Ua}Owd(Ua,Nb,hc,Qc,$c){const Hd=new z.a,$d=new z.a,ue=new z.a;var Fe=!1,cf=!1,Ee=!1,xe=!1,cg=!0;let Gg=!0,Of=!0,ch=!0;$c&&Qc&&(cg=Qc.equals(jf.a.west)||
Qc.equals(jf.a.WB)||Qc.equals(jf.a.p_),Gg=Qc.equals(jf.a.east)||Qc.equals(jf.a.jW)||Qc.equals(jf.a.ES),Of=Qc.equals(jf.a.north)||Qc.equals(jf.a.WB)||Qc.equals(jf.a.jW),ch=Qc.equals(jf.a.south)||Qc.equals(jf.a.p_)||Qc.equals(jf.a.ES));Qc=this.ty.Nr(hc.Yd.width);hc=this.ty.Nr(hc.Yd.height);for(const vg of Nb)vg.Bd>3*Qc/4&&vg.Bd<Qc&&Ua.Ic<Qc/4&&0<Ua.Ic&&this.JAb(Ua,vg,!1)&&cg&&this.PT(Ua.Ic,Qc-vg.Bd)&&(Fe=!0,Nb=new Lc,Nb.Vm=new lb.a(vg.Bd-this.r8,vg.xd),Nb.kn=new lb.a(vg.Bd-this.r8,vg.xd+this.Lo),Hd.add(this.kW(Nb)),
Nb=new Lc,Nb.Zja=!0,Nb.Vm=new lb.a(Qc-this.r8,vg.xd+this.Lo),Nb.kn=new lb.a(vg.Bd-this.r8,vg.xd+this.Lo),$d.add(this.kW(Nb))),vg.Ic<Qc/4&&0<vg.Ic&&Ua.Bd>3*Qc/4&&Ua.Ic<Qc&&this.JAb(Ua,vg,!1)&&Gg&&this.PT(Qc-Ua.Bd,vg.Ic)&&(cf=!0,Nb=new Lc,Nb.Vm=new lb.a(vg.Ic-this.Bza,vg.xd),Nb.kn=new lb.a(vg.Ic-this.Bza,vg.xd+this.Lo),Hd.add(this.kW(Nb)),Nb=new Lc,Nb.Zja=!0,Nb.Vm=new lb.a(0-this.Bza,vg.xd+this.Lo),Nb.kn=new lb.a(vg.Ic-this.Bza,vg.xd+this.Lo),$d.add(this.kW(Nb))),vg.xd>3*hc/4&&vg.xd<hc&&Ua.Xc<hc/4&&
0<Ua.Xc&&this.JAb(Ua,vg,!0)&&Of&&this.PT(Ua.Xc,hc-vg.xd)&&(Ee=!0,Nb=new Lc,Nb.Vm=new lb.a(vg.Bd,vg.xd-this.lab),Nb.kn=new lb.a(vg.Bd+this.Lo,vg.xd-this.lab),Hd.add(this.kW(Nb)),$c=new Lc,Nb.Zja=!0,$c.Vm=new lb.a(vg.Bd+this.Lo,vg.xd-this.lab),$c.kn=new lb.a(vg.Bd+this.Lo,hc-this.lab),$d.add(this.kW($c))),vg.Xc<hc/4&&0<vg.Xc&&Ua.xd>3*hc/4&&Ua.xd<hc&&this.JAb(Ua,vg,!0)&&ch&&this.PT(hc-Ua.xd,vg.Xc)&&(xe=!0,Nb=new Lc,Nb.Vm=new lb.a(vg.Bd,vg.Xc-this.MY),Nb.kn=new lb.a(vg.Bd+this.Lo,vg.Xc-this.MY),Hd.add(this.kW(Nb)),
$c=new Lc,Nb.Zja=!0,$c.Vm=new lb.a(vg.Bd+this.Lo,0-this.MY),$c.kn=new lb.a(vg.Bd+this.Lo,vg.Xc-this.MY),$d.add(this.kW($c)));Ee&&(Ee=new Lc,Ee.Vm=new lb.a(Ua.Bd,Ua.Xc-this.MY),Ee.kn=new lb.a(Ua.Bd+this.Lo,Ua.Xc-this.MY),Hd.add(this.kW(Ee)),cg=new Lc,Ee.Zja=!0,cg.Vm=new lb.a(Ua.Bd+this.Lo,0-this.MY),cg.kn=new lb.a(Ua.Bd+this.Lo,Ua.Xc-this.MY),$d.add(this.kW(cg)));xe&&(xe=new Lc,xe.Vm=new lb.a(Ua.Bd,Ua.xd-this.lab),xe.kn=new lb.a(Ua.Bd+this.Lo,Ua.xd-this.lab),Hd.add(this.kW(xe)),Ee=new Lc,xe.Zja=!0,
Ee.Vm=new lb.a(Ua.Bd+this.Lo,hc-this.lab),Ee.kn=new lb.a(Ua.Bd+this.Lo,Ua.xd-this.lab),$d.add(this.kW(Ee)));Fe&&(Fe=new Lc,Fe.Vm=new lb.a(Ua.Ic-this.Bza,Ua.xd),Fe.kn=new lb.a(Ua.Ic-this.Bza,Ua.xd+this.Lo),Hd.add(this.kW(Fe)),Fe=new Lc,Fe.Zja=!0,Fe.Vm=new lb.a(0-this.Bza,Ua.xd+this.Lo),Fe.kn=new lb.a(Ua.Ic-this.Bza,Ua.xd+this.Lo),$d.add(this.kW(Fe)));cf&&(cf=new Lc,cf.Vm=new lb.a(Ua.Bd-this.r8,Ua.xd),cf.kn=new lb.a(Ua.Bd-this.r8,Ua.xd+this.Lo),Hd.add(this.kW(cf)),cf=new Lc,cf.Zja=!0,cf.Vm=new lb.a(Qc-
this.r8,Ua.xd+this.Lo),cf.kn=new lb.a(Ua.Bd-this.r8,Ua.xd+this.Lo),$d.add(this.kW(cf)));this.afd(Hd,1);this.afd($d,2);for(const vg of Hd)ue.add(vg);for(const vg of $d)ue.add(vg);return ue}Zvm(Ua,Nb,hc){var Qc=new Lc;const $c=new Lc,Hd=new Lc,$d=new Lc,ue=new Lc,Fe=new Lc,cf=new z.a;cf.add(Qc);cf.add($c);cf.add(Hd);cf.add($d);cf.add(ue);cf.add(Fe);this.afd(cf,0);this.v2m(Qc,$c,Hd,$d,ue,Fe,Ua);for(const Ee of Nb)this.R9a(Ua.Xc,Ee.Xc,Ee.xd,Qc,Ee),this.R9a(Ua.xd,Ee.Xc,Ee.xd,$c,Ee),this.R9a(Ua.Ic,Ee.Ic,
Ee.Bd,Hd,Ee),this.R9a(Ua.Bd,Ee.Ic,Ee.Bd,$d,Ee),this.RHe&&(this.R9a(Ua.Xc,Ee.ej()._y,null,Qc,Ee),this.R9a(Ua.xd,Ee.ej()._y,null,$c,Ee),this.R9a(Ua.Ic,Ee.ej()._x,null,Hd,Ee),this.R9a(Ua.Bd,Ee.ej()._x,null,$d,Ee),this.R9a(Ua.ej()._y,Ee.Xc,null,ue,Ee),this.R9a(Ua.ej()._y,Ee.xd,null,ue,Ee),this.R9a(Ua.ej()._x,Ee.Ic,null,Fe,Ee),this.R9a(Ua.ej()._x,Ee.Bd,null,Fe,Ee)),this.R9a(Ua.ej()._y,Ee.ej()._y,null,ue,Ee),this.R9a(Ua.ej()._x,Ee.ej()._x,null,Fe,Ee);0<Qc.length()&&0<$c.length()&&(this.RHe?(ue.Vm=new lb.a(Ua.Ic-
this.Lo,Ua.ej()._y),ue.kn=ue.Vm.copy()):ue.reset());0<Hd.length()&&0<$d.length()&&(this.RHe?(Fe.Vm=new lb.a(Ua.ej()._x,Ua.Ic-this.Bza),Fe.kn=Fe.Vm.copy()):Fe.reset());if(this.RHe&&hc){Nb=this.ty.Nr(hc.Yd.width);hc=this.ty.Nr(hc.Yd.height);if(this.PT(Ua.Xc,hc/2)||Math.abs(Ua.Xc)<=Qf.vwd||this.PT(Ua.Xc,hc))Qc.Vm._x=Math.min(Qc.Vm._x,-1*this.Lo),Qc.kn._x=Math.max(Qc.kn._x,Nb+this.Lo);if(this.PT(Ua.xd,hc/2)||Math.abs(Ua.xd)<=Qf.vwd||this.PT(Ua.xd,hc))$c.Vm._x=Math.min($c.Vm._x,-1*this.Lo),$c.kn._x=Math.max($c.kn._x,
Nb+this.Lo);if(this.PT(Ua.ej()._y,hc/2)||Math.abs(Ua.ej()._y)<=Qf.vwd||this.PT(Ua.ej()._y,hc))ue.Vm._x=Math.min(ue.Vm._x,-1*this.Lo),ue.kn._x=Math.max(ue.kn._x,Nb+this.Lo);if(this.PT(Ua.Bd,Nb/2)||Math.abs(Ua.Bd)<=Qf.vwd||this.PT(Ua.Bd,Nb))$d.Vm._y=Math.min($d.Vm._y,-1*this.Lo),$d.kn._y=Math.max($d.kn._y,hc+this.Lo);if(this.PT(Ua.Ic,Nb/2)||Math.abs(Ua.Ic)<=Qf.vwd||this.PT(Ua.Ic,Nb))Hd.Vm._y=Math.min(Hd.Vm._y,-1*this.Lo),Hd.kn._y=Math.max(Hd.kn._y,hc+this.Lo);if(this.PT(Ua.ej()._x,Nb/2)||Math.abs(Ua.ej()._x)<=
Qf.vwd||this.PT(Ua.ej()._x,Nb))Fe.Vm._y=Math.min(Fe.Vm._y,-1*this.Lo),Fe.kn._y=Math.max(Fe.kn._y,hc+this.Lo)}Qc=new z.a;for(const Ee of cf)Ee.Vm&&0<Ee.length()&&(this.Pql(Ee,Ua),Qc.add(this.kW(Ee)));return Qc}R9a(Ua,Nb,hc,Qc,$c){(this.PT(Ua,Nb)||this.PT(Ua,hc))&&this.Pql(Qc,$c)}Pql(Ua,Nb){Ua.Zja?(Ua.Vm._x=Math.min(Ua.Vm._x,Nb.Ic-this.Lo),Ua.kn._x=Math.max(Ua.kn._x,Nb.Bd+this.Lo)):(Ua.Vm._y=Math.min(Ua.Vm._y,Nb.Xc-this.Lo),Ua.kn._y=Math.max(Ua.kn._y,Nb.xd+this.Lo))}kW(Ua){let Nb;(Nb=Ua.Vm).x=Nb.x+
this.Qoh;let hc;(hc=Ua.Vm).y=hc.y+this.Roh;let Qc;(Qc=Ua.kn).x=Qc.x+this.Qoh;let $c;($c=Ua.kn).y=$c.y+this.Roh;return Ua}PT(Ua,Nb){var hc=Qf.vwd;return!!Ua&&!!Nb&&Math.abs(Ua-Nb)<=hc}v2m(Ua,Nb,hc,Qc,$c,Hd,$d){Ua.Vm=new lb.a($d.Ic-this.Lo,$d.Xc-this.MY);Ua.kn=Ua.Vm.copy();Ua.Zja=!0;Nb.Vm=new lb.a($d.Ic-this.Lo,$d.xd-this.lab);Nb.kn=Nb.Vm.copy();Nb.Zja=!0;hc.Vm=new lb.a($d.Ic-this.Bza,$d.Xc-this.Lo);hc.kn=hc.Vm.copy();Qc.Vm=new lb.a($d.Bd-this.r8,$d.Xc-this.Lo);Qc.kn=Qc.Vm.copy();Nb=$d.ej();$c.Vm=new lb.a(Ua.Vm._x-
this.Lo,Nb._y-this.MY);$c.kn=$c.Vm.copy();$c.Zja=!0;Hd.Vm=new lb.a(Nb._x-this.Lo,hc.Vm._y-this.Lo);Hd.kn=Hd.Vm.copy()}afd(Ua,Nb){for(const hc of Ua)0===Nb?(hc.color=Pa.a.Akl,hc.dashStyle="4,4",hc.zJf=0):1===Nb?(hc.color=Pa.a.zkl,hc.dashStyle="4,4",hc.zJf=1):2===Nb&&(hc.color=Pa.a.ghi,hc.dashStyle="4,4",hc.zJf=2)}get LOl(){return this.Qoh}set LOl(Ua){this.Qoh=Ua}get MOl(){return this.Roh}set MOl(Ua){this.Roh=Ua}}Qf.vwd=.4;Qf.ych=5;Object(e.a)(Qf,"SmartGuideUtility",null,[731]);var sg=a(71),Bf=a(375),
Wf=a(385);class Xf{constructor(Ua,Nb,hc,Qc,$c,Hd){this.SHe=this.THe=this.Eb=null;this.oNa=new Sys.UI.Bounds(0,0,0,0);this.Rab=1;this.fh=this.mc=!1;this.If=Ua;this.Uj=Nb;this.kd=Qc;this.Lc=hc;this.ic=$c;this.fh=Hd.getBooleanAppSetting(Ae.a.tI);this.kd.qSa(Object(A.a)(this,this.xo,"onResize"));this.kd.g9a(Object(A.a)(this,this.z8,"onActiveSlideDomDisplayed"));this.xq()}get visible(){return!!this.Eb&&this.mc}set visible(Ua){this.Eb||this.xq();this.mc!==Ua&&(this.Eb.he(Ua),this.mc=Ua)}fxi(Ua){this.SHe&&
this.THe.ta.removeChild(this.SHe.ta);this.SHe=new Bf.a;let Nb=0;for(;Nb<Ua.length;Nb++){const hc=Ua[Nb],Qc=new Tg.a,$c=Xf.W8m(Xf.aXl(lb.a.scale(hc.Vm,this.Rab,this.Rab)),Xf.aXl(lb.a.scale(hc.kn,this.Rab,this.Rab)));Qc.ox($c);Qc.GB(this.xtl(hc.color));Qc.Sqa(hc.dashStyle);Qc.Mw(1/this.DA);this.SHe.appendChild(Qc);2===hc.zJf&&this.KFm($c[0],$c[1])}this.THe.appendChild(this.SHe)}KFm(Ua,Nb){Ua._y===Nb._y?Ua._x<Nb._x?this.dml(Ua,Nb):this.dml(Nb,Ua):Ua._y>Nb._y?this.eml(Ua,Nb):this.eml(Nb,Ua)}dml(Ua,Nb){const hc=
this.Pil(Nb._x-Ua._x);this.Ldh([new lb.a(Ua._x,Ua._y),new lb.a(Ua._x+hc,Ua._y-hc/2),new lb.a(Ua._x+hc,Ua._y+hc/2)]);this.Ldh([new lb.a(Nb._x,Nb._y),new lb.a(Nb._x-hc,Nb._y-hc/2),new lb.a(Nb._x-hc,Nb._y+hc/2)])}eml(Ua,Nb){const hc=this.Pil(Ua._y-Nb._y);this.Ldh([new lb.a(Ua._x,Ua._y),new lb.a(Ua._x-hc/2,Ua._y-hc),new lb.a(Ua._x+hc/2,Ua._y-hc)]);this.Ldh([new lb.a(Nb._x,Nb._y),new lb.a(Nb._x-hc/2,Nb._y+hc),new lb.a(Nb._x+hc/2,Nb._y+hc)])}Pil(Ua){return Math.min(Ua,10)/2}Ldh(Ua){const Nb=new Tg.a,hc=
this.xtl(Pa.a.ghi);Nb.ox(Ua);Nb.GB(hc);Nb.Mw(1/this.DA);Nb.mN(hc);Nb.he(!0);this.SHe.appendChild(Nb)}xtl(Ua){return this.Uj&&this.Uj.highContrastColors?this.Uj.highContrastColors.foregroundTextColor:Ua}xq(){this.Eb=new og.a;this.Eb.Zv("SmartGuideView");this.Eb.gk(0);this.Eb.he(!1);this.If.ta.appendChild(this.Eb.ta);this.THe=new Wf.a;this.THe.ta.style.overflow="visible";this.Eb.appendChild(this.THe);this.KB(this.Lc.Yc)}xo(Ua,Nb){Nb&&this.KB(Nb.yA)}z8(Ua,Nb){Nb&&this.KB(Nb.yA)}get DA(){var Ua,Nb;return this.fh?
null!==(Nb=null===(Ua=this.ic)||void 0===Ua?void 0:Ua.DA)&&void 0!==Nb?Nb:1:1}KB(Ua){this.Eb&&Ua&&Ua.Yd&&Ua===this.Lc.Yc&&(this.fh&&sg.a.Rqa(this.Eb.ta,this.ic.RE),this.oNa.x!==Ua.Yd.x||this.oNa.y!==Ua.Yd.y||this.oNa.width!==Ua.Yd.width||this.oNa.height!==Ua.Yd.height)&&(this.oNa=new Sys.UI.Bounds(Ua.Yd.x,Ua.Yd.y,Ua.Yd.width,Ua.Yd.height),this.Eb.setPosition(Ua.Yd.x,Ua.Yd.y),this.THe.mh(Ua.Yd.width,Ua.Yd.height),this.Eb.mh(Ua.Yd.width,Ua.Yd.height))}static W8m(Ua,Nb){Nb._y===Ua._y||Math.abs(Nb._y-
Ua._y)%2||(Nb._y+=1);Nb._x===Ua._x||Math.abs(Nb._x-Ua._x)%2||(Nb._x+=1);return[Ua,Nb]}static aXl(Ua){return new lb.a(Math.floor(Ua.x)+.5,Math.floor(Ua.y)+.5)}}Object(e.a)(Xf,"SmartGuideView",null,[730]);class Xa{setPosition(Ua,Nb,hc){Ua.setPosition(Ua.x+Nb,Ua.y+hc,!0)}setOffsets(Ua,Nb){Ua.setOffsets(jc.a.add(Ua.gUa,Nb),!0)}Bna(Ua){return new Pe.a(Ua.Zt())}NI(Ua){return!Ua.shapeNode.Ww}}Object(e.a)(Xa,"DefaultShapeMoveResizeHandler",null,[757]);class T{constructor(){this.$=null}get name(){return"PowerPointWebEditor.SmartGuide"}lc(Ua){this.$=
Ua;this.$.register(729,"PowerPointWebEditor.ISmartGuideManager").ma().na(()=>new Ma(this.$.resolve("PowerPointWebEditor.ISmartGuideView"),this.$.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.$.resolve("PowerPointWebEditor.ISmartGuideUtility"),this.$.resolve("PowerPointWebEditor.IZoomContext"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").AKe));this.$.register(730,
"PowerPointWebEditor.ISmartGuideView").ma().na(()=>new Xf(this.$.resolve("PowerPointWebEditor.ISlidePane"),this.$.resolve("Common.Utils.IHighContrastDetector"),this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.$.resolve("PowerPointWebEditor.IZoomContext"),this.$.resolve("PowerPointWebEditor.IApplicationSettings")));this.$.register(731,"PowerPointWebEditor.ISmartGuideUtility").ma().na(()=>new Qf(this.$.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.$.resolve("PowerPointWebEditor.IApplicationSettings").zKe))}init(){this.$.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new Xa);this.$.resolve("PowerPointWebEditor.ISmartGuideManager")}dispose(){}static main(){y.a.instance.Fc(new T)}}Object(e.a)(T,"PPTWebEditorSmartGuidePackage",null,[3,4]);var Ba;(function(Ua){Ua[Ua.notLoaded=1]="notLoaded";Ua[Ua.loaded=2]="loaded";Ua[Ua.failed=3]="failed"})(Ba||(Ba={}));Object(e.b)("WebSocketCompressionHelperLoadState",Ba);var kb=a(91),Ab=a(580),
ic=a(121),zc=a(1202),Fc=a(1203);class lc{constructor(Ua,Nb,hc,Qc,$c,Hd=!1){this.Kad=this.Lr=this.nbd=null;this.Hab=-1;this.WXb=this.qMa=0;this.I$c=-1;this.XGe=0;this.YGe=null;this.K$c=0;this.fY=!1;if(!Ua)throw Error.argumentNull("webSocketClient");this.iW=Ua;this.nb=Nb;this.OF=hc;this.od=Qc;this.fY=Hd;Ua=document.createElement("a");Ua.href=this.iW.W_n;Ua.protocol="http:"===Ua.protocol?"ws":"wss";Ga.a("PodsWebSocketFrontDoor.UseQueryString")?(Ua=new ic.QueryStringBuilder(Ua.href),Ga.a("PodsWebSocketFrontDoor.UseWacClusterQueryString")&&
Ua.Zi(Mc.a.tsh,Nb.rp),Ga.a("PodsWebSocketFrontDoor.UseUsidQueryString")&&Ua.Zi(Mc.a.$Sl,h.AFrameworkApplication.userSessionId),Ua.Zi(Mc.a.mcd,$c.toString()),this.nbd=Ua.toString()):this.nbd=Ua.href;this.v4d=Ad.a.aN(this.nbd);this.U5c(2);this.JNa=this.iW.N_l;this.V0f=this.iW.hym;this.GSg();this.od.i9a(Object(A.a)(this,this.Scc,"onSessionEnding"));this.od.VG(Object(A.a)(this,this.Oq,"onSessionRehydrated"))}dispose(){this.od.Vje(Object(A.a)(this,this.Scc,"onSessionEnding"));this.od.wka(Object(A.a)(this,
this.Oq,"onSessionRehydrated"))}U5c(Ua){this.fY||(this.Lr&&this.Lr.close(),this.Lr=zc.a(this.nbd,[]),this.Lr.onopen=Object(A.a)(this,this.onOpen,"onOpen"),this.Lr.onerror=Object(A.a)(this,this.onError,"onError"),this.Lr.onclose=Object(A.a)(this,this.onClose,"onClose"),this.Lr.onmessage=Object(A.a)(this,this.onMessage,"onMessage"),this.K$c=Ua,B.a.J(508077727,this.iW.CEa,50,"WebSocketFetcher::ConnectWebSocket - WebSocket connected WebSocketDomain:{0}, WacCluster:{1}, ConnectionReason:{2}",this.v4d,
this.nb.rp,this.K$c))}ping(){if(this.Lr)if(1===this.Lr.readyState){const Ua=this.iW.CBm();this.Lr.send(Ua)}else B.a.J(508077725,this.iW.CEa,10,"WebSocketFetcher::Ping. Wrong WebSocket state {0}",this.Lr.readyState),this.r6a(4);else B.a.J(508077726,this.iW.CEa,50,"WebSocketFetcher::Ping Websocket is unavailable.")}kym(){this.Lr.close()}onOpen(){B.a.J(508077724,this.iW.CEa,50,"WebSocketFetcher::OnOpen WebSocketDomain:{0}, WacCluster:{1}",this.v4d,this.nb.rp);this.Ndd();this.XGe=0;this.YGe=null;this.iW.Ron()}onError(Ua){B.a.J(508077723,
this.iW.CEa,10,"WebSocketFetcher::OnError {0}, WebSocketDomain:{1}, WacCluster:{2}",JSON.stringify(Ua),this.v4d,this.nb.rp)}onClose(Ua){B.a.J(508077722,this.iW.CEa,50,"WebSocketFetcher::OnClose WebSocketDomain:{0}, WacCluster:{1}, EventInfo:{2}, CloseEventCode:{3}, CloseEventReason:{4}",this.v4d,this.nb.rp,JSON.stringify(Ua),Ua.code,Ua.reason);this.XGe=Ua.code;this.YGe=Ua.reason}onMessage(Ua){try{Ua&&Ua.data&&this.iW.fyg(Ua)}catch(Nb){B.a.J(508077721,this.iW.CEa,10,"WebSocketFetcher::OnMessage",Nb.toString())}}GSg(){this.Kad=
()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.I$c),this.Lr||(B.a.J(508077720,this.iW.CEa,50,"WebSocketFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.r6a(1))):this.I$c=window.setTimeout(()=>{this.Lr&&(B.a.J(508077719,this.iW.CEa,50,"WebSocketFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.XGe=1E3,this.YGe="Lost visibility",this.Lr.close(this.XGe,this.YGe),this.Lr=null,window.clearTimeout(this.Hab))},this.V0f)};
window.self.addEventListener("visibilitychange",this.Kad)}Ndd(){this.qMa=0}nbf(){0<this.iW.Zqh&&(new Date).getTime()-this.WXb>this.iW.Zqh&&(this.Ndd(),B.a.J(508077718,this.iW.CEa,50,"WebSocketFetcher::Retry connect to server after long pause."))}thf(){const Ua=!!this.OF&&!!this.OF.instance&&!this.OF.instance.q3,Nb=(new Date).getTime()-this.WXb>this.JNa,hc=this.qMa<this.iW.tNl,Qc=!this.Lr||3===this.Lr.readyState||2===this.Lr.readyState,$c=Ua&&Nb&&hc&&Qc;B.a.J(508077717,this.iW.CEa,50,"WebSocketFetcher::CanRetry: canRetry:{0}, isPodsSessionAlive:{1}, retryTimeReached:{2}, retryAttemptsAvailable:{3}, noWebSocket:{4}",
$c,Ua,Nb,hc,Qc);return $c}HRg(){this.WXb=(new Date).getTime();this.JNa=Math.pow(2,this.qMa)*this.iW.N_l;0<this.iW.Zqh&&(this.JNa=Math.min(this.JNa,this.iW.Zqh));window.setTimeout(()=>{this.r6a(3)},this.JNa)}r6a(Ua){this.nbf();this.thf()&&(this.U5c(Ua),this.HRg(),this.qMa++,Ua!==this.K$c&&B.a.J(508077716,this.iW.CEa,10,"WebSocketFetcher::ReconnectionReasonMismatch ReconnectionReason:{0}, m_reconnectionReason{1}",Ua,this.K$c),B.a.J(508077715,this.iW.CEa,50,"WebSocketFetcher::Retry connect to server. ReconnectionReason:{0}",
this.K$c),this.qMa===this.iW.tNl&&B.a.J(508077714,this.iW.CEa,50,"WebSocketFetcher::Max retries reached. ReconnectionReason:{0}",this.K$c))}sendMessage(Ua,Nb){if(!this.Lr)return B.a.J(508077713,this.iW.CEa,50,"WebSocketFetcher::SendMessage Websocket is unavailable. RequestType:{0}, LastCloseCode:{1}, LastCloseReason:{2}",Nb,this.XGe,this.YGe),1;B.a.J(508077712,this.iW.CEa,50,"WebSocketFetcher::SendMessage. WebSocket state {0}, RequestType:{1}, LastCloseCode:{2}, LastCloseReason:{3}",Fc.a[this.Lr.readyState],
Nb,this.XGe,this.YGe);if(1===this.Lr.readyState)return this.Lr.send(Ua),0;this.r6a(5);return 2}BNn(){this.Lr.binaryType="arraybuffer"}Vbd(){-1!==this.Hab&&window.clearTimeout(this.Hab);this.Hab=window.setTimeout(()=>{this.ping()},this.iW.pvn)}Dxm(){this.K$c=0}Scc(){this.Lr&&(B.a.J(508077711,this.iW.CEa,50,"WebSocketFetcher::OnSessionEnding: closing due to session ending."),this.Lr.close(),this.Lr=null)}Oq(){this.Lr||(B.a.J(508077710,this.iW.CEa,50,"WebSocketFetcher::OnSessionRehydrated: reconnecting after session rehydrated."),
this.r6a(6))}}Object(e.a)(lc,"WebSocketFetcher",null,[769,24]);var nd;(function(Ua){Ua[Ua.none=0]="none";Ua[Ua.visibilityRegainedReconnection=1]="visibilityRegainedReconnection";Ua[Ua.initialConnection=2]="initialConnection";Ua[Ua.timeoutReconnection=3]="timeoutReconnection";Ua[Ua.webSocketNotOpenOnPingReconnection=4]="webSocketNotOpenOnPingReconnection";Ua[Ua.webSocketNotOpenedReconnection=5]="webSocketNotOpenedReconnection";Ua[Ua.sessionRehydrationReconnection=6]="sessionRehydrationReconnection"})(nd||
(nd={}));Object(e.b)("ConnectionReason",nd);var vd;(function(Ua){Ua[Ua.success=0]="success";Ua[Ua.nullWebSocket=1]="nullWebSocket";Ua[Ua.webSocketNotOpened=2]="webSocketNotOpened"})(vd||(vd={}));Object(e.b)("SendMessageStatusCode",vd);class od extends Sys.EventArgs{constructor(Ua,Nb,hc){super();this.response=Ua;this.C_l=Nb;this.YBl=hc}}Object(e.a)(od,"WebSocketFrontDoorEventArgs",Sys.EventArgs,[]);var Bd=a(859);class Wd{constructor(Ua,Nb,hc,Qc,$c){this.$j=window.performance.now();this.ENj=new mb.a;
this.nEj=this.aad=!0;this.sGe=null;this.cIe=1;this.nb=Nb;this.A4d=Ua.W$l;this.Wdg=Ua.X$l;this.ddn=Ua.U$l;this.Udn=Ua.V$l;this.fbn=Ua.S$l;this.yHe=Ua.bgd;this.A8d=Ua.q$l;this.FRj=Ua.T$l;this.v4d=Ad.a.aN(this.FRj);this.zcc=new lc(this,Nb,hc,Qc,new Ab.a(Ua.tia),Ua.getBooleanAppSetting("blockWebsocketConnectionForPAS"));if($c)this.sGe=$c;else throw Error.argumentNull("dynamicScriptLoader");}dispose(){this.zcc.dispose()}ping(){this.zcc.ping()}XF(Ua){const Nb=new Map,hc=this.gVm(Ua);Ua.smartArtEditOpRequest&&
(Nb.set("requestType",hc),Nb.set("correlationId",Ua.smartArtEditOpRequest.commonData?Ua.smartArtEditOpRequest.commonData.correlationId:null),U.Health.instance.recordKpiUsage("DeltaEdit",kb.b.SuccessBased,"gc2smartart",Nb));this.yHe?(Ua=this.zcc.sendMessage(JSON.stringify(Ua),hc),0!==Ua&&(Nb.set("SendMessageStatusCode",vd[Ua]),U.Health.instance.recordKpiFailure("DeltaEdit","SendRequestFailure",!1,!0,{extendedProperties:Nb}))):U.Health.instance.recordKpiFailure("DeltaEdit","WebSocketProtobufBRSDisabled",
!0,!0,{extendedProperties:Nb})}nfl(Ua){this.ENj.addHandler("ResponseReceivedEventId",Ua)}qZl(Ua){this.ENj.removeHandler("ResponseReceivedEventId",Ua)}Ron(){if(this.yHe){var Ua=jb.a.Ab?jb.a.Ab.actionId:sb.a.create().toString(),Nb=h.AFrameworkApplication.userSessionId,hc=this.nb.rp;this.nEj=!0;Nb=Bd.p(Ua,Nb,this.nb.podSessionId,hc);Nb=this.zcc.sendMessage(JSON.stringify(Nb),"validateSession");B.a.J(508368854,839,0===Nb?50:10,"PodsFrontDoorWebSocket::OnConnectionOpened ValidateSessionRequest correlationId:{0}, SendMessageStatusCode:{1}, WebSocketDomain:{2}, WacCluster:{3}",
Ua,vd[Nb],this.v4d,hc)}}fyg(Ua){if(this.yHe)try{const Nb=this.$Hm(Ua);if(Nb.pong)this.Vbd(Nb.pong.pingTimestamp);else if(Nb.validateSessionResponse)this.Qsn(Nb.validateSessionResponse);else if(Nb.compressionHandshakeResponse)this.Oon(Nb.compressionHandshakeResponse);else{const hc=Object.getType(Ua.data)!==String;this.ENj.raiseEvent("ResponseReceivedEventId",new od(Nb,this.oSm(Ua,hc),hc))}}catch(Nb){B.a.J(508368853,839,10,"PodsFrontDoorWebSocket Failed to parse WebSocketFrontDoorServiceResponse")}else this.Vbd(Ua.data)}$Hm(Ua){let Nb=
Object.getType(Ua.data)===String?Ua.data:null;if(Nb)return JSON.parse(Nb);if(2===this.cIe)return Ua=new Uint8Array(Ua.data),Nb=WebSocketCompressionHelper.WebSocketCompressionHelper.decompressTextWithDeflateRaw(Ua),JSON.parse(Nb);B.a.J(508368852,839,10,"PodsFrontDoorWebSocket: ExtractMessageReceive could not decompress data because WebSocketCompressionHelper is not loaded");return JSON.parse("")}oSm(Ua,Nb){return Nb?(new Uint8Array(Ua.data)).byteLength:Ua.data.length}Qsn(Ua){if(Ua.isValid){Ua=jb.a.Ab?
jb.a.Ab.actionId:sb.a.create().toString();var Nb=h.AFrameworkApplication.userSessionId,hc=this.nb.podSessionId,Qc=this.nb.rp;B.a.J(508368850,839,50,"PodsWebSocketFrontDoor::OnValidateSessionResponse - WebSocketCompressionHelperLoadState:{0}",Ba[this.cIe]);1===this.cIe?this.v9m(Ua,Nb,hc,Qc):2===this.cIe&&this.D1l(Ua,Nb,hc,Qc);this.ping()}else B.a.J(508368851,839,10,"PodsWebSocketFrontDoor::OnMessageReceived - Closing WebSocket because session not valid. WebSocketDomain:{0}, WacCluster:{1}",this.v4d,
this.nb.rp),this.zcc.kym()}v9m(Ua,Nb,hc,Qc){this.sGe.loadScript("WebSocketCompressionHelper").then(()=>{this.cIe=2;this.D1l(Ua,Nb,hc,Qc)}).catch(()=>{B.a.J(508368849,839,10,"PodsFrontDoorWebSocket WebSocketCompressionHelper failed to load");this.cIe=3})}D1l(Ua,Nb,hc,Qc){Ua=Bd.a(Ua,Nb,hc,!0,Qc);Ua=this.zcc.sendMessage(JSON.stringify(Ua),"compressionHandshake");B.a.J(508368848,839,50,"PodsFrontDoorWebSocket WebSocketCompressionHelper loaded and sent compression handshake with status code {0}",Ua)}Oon(Ua){Ua=
Ua.clientReadyForCompression;B.a.J(508368847,839,50,"PodsFrontDoorWebSocket WebSocket compression handshake received with value {0}",Ua);Ua&&this.zcc.BNn()}gVm(Ua){return Ua.ping?"ping":Ua.validateSessionRequest?"validateSession":Ua.compressionHandshakeRequest?"compressionHandshake":Ua.smartArtEditOpRequest&&Ua.smartArtEditOpRequest.editOps&&Ua.smartArtEditOpRequest.editOps[0].resizeEditOp?"resizeEditOp":"unknown"}Vbd(Ua){this.zcc.Vbd(Ua);O.a.rb(Ua)?B.a.J(508368846,839,10,"PodsFrontDoorWebSocket::OnPingReply Invalid pingTimestampStr"):
(Ua=parseFloat(Ua),isNaN(Ua)?B.a.J(508368845,839,10,"PodsFrontDoorPing::OnMessage Ping response not a number. m_protobufEnabled:{0}",this.yHe):(Ua={["PingTime"]:window.performance.now()-this.$j-Ua,MeasurementType:"Performance.Now"},Ua.First=this.aad?1:0,Ua.WebSocketFrontDoorProtobufEnabled=this.yHe,Ua.PostConnectionPing=this.nEj,Ua.ConnectionReason=nd[this.zcc.K$c],this.zcc.Dxm(),this.nEj=this.aad=!1,B.a.J(508368844,839,50,n.a.toJSON(Ua))))}CBm(){var Ua=(window.performance.now()-this.$j).toString();
if(!this.yHe)return Ua;Ua=Bd.q(Bd.l(Ua),null,null,null,this.nb.rp);return JSON.stringify(Ua)}get W_n(){return this.A8d&&!O.a.rb(this.FRj)?this.FRj:h.AFrameworkApplication.ga.appSettings.WebServiceBase+"WebSocketFrontDoorServiceHandler.ashx"}get CEa(){return 839}get pvn(){return this.Wdg}get tNl(){return this.A4d}get N_l(){return this.Udn}get Zqh(){return this.ddn}get hym(){return this.fbn}}Object(e.a)(Wd,"PodsWebSocketFrontDoor",null,[727,24,756]);class ce{constructor(){this.$=null}get name(){return"PowerPointWebEditor.WebSocketFrontDoor"}lc(Ua){if(!Ua)throw Error.create("PPTWebEditorWebSocketFrontDoorPackage : container is null");
this.$=Ua;Ua.register(727,"PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").ma().na(()=>{try{return new Wd(Ua.resolve("PowerPointWebEditor.IApplicationSettings"),Ua.resolve("PowerPointWebEditor.ISessionInfoOwner"),Ua.Na("PowerPointWebEditor.ISessionLifetimeManager"),Ua.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),Ua.resolve("Common.IDynamicScriptLoaderProvider").LW)}catch(Nb){return B.a.J(507835866,839,10,"exception creating PodsWebSocketFrontDoor: "+Nb),null}})}init(){this.$.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor")}dispose(){this.$.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").dispose()}static main(){y.a.instance.Fc(new ce)}}
Object(e.a)(ce,"PPTWebEditorWebSocketFrontDoorPackage",null,[3,4]);var db=a(650);class gc{Ogh(){return null}Wtl(){return ia.c(window.PPTCampaignsObj_FromAppPackage)}vIf(Ua){return db.a.vIf(Ua,"PPTUserInitiatedSurveysDictionary_FromAppPackage")}}Object(e.a)(gc,"PowerPointFeedbackAppData",null,[728]);class Dc{constructor(){this.Ha=null}lc(Ua){this.Ha=Ua;Ua.register(728,"Common.App.IAppSpecificFeedbackData").ma().na(()=>new gc)}init(){this.Ha.yb("Common.App.IAppSpecificFeedbackData")}dispose(){}get name(){return"PPTWebEditor.Feedback"}static main(){y.a.instance.Fc(new Dc)}}
Object(e.a)(Dc,"PPTWebEditorFeedbackPackage",null,[3,4]);Type.registerNamespace("PowerPointWebEditor.Notes");Type.registerNamespace("PowerPointWebEditor.Preview");Type.registerNamespace("PowerPointWebEditor.ShapePresence");Type.registerNamespace("PowerPointWebEditor.SlideShow");Type.registerNamespace("PowerPointWebEditor.SmartGuide");Type.registerNamespace("PowerPointWebEditor.WebSocketFrontDoor");Object(Ca.c)("ext-lazy");h.AFrameworkApplication.ga.isChangeGateEnabled("ExtCommonPackageOrderChange")&&
ag.main();pf.main();Zc.main();uj.main();Bh.main();h.AFrameworkApplication.ga.isChangeGateEnabled("ExtCommonPackageOrderChange")||ag.main();sf.main();ji.main();T.main();ce.main();Dc.main();Object(Ca.b)("ext-lazy")},1347:function(x,G,a){a.d(G,"a",function(){return n});x=a(0);var c=a(231),b=a(40),f=a(61),e=a(10),h=a(248),u=a(1123),m=a(305);class n{constructor(l,r,w,y,z,A){this.fpd=this.DFc=null;this.gN=Object(c.a)(u.a,y.Ypi(l,r,w,Object(b.a)(this,this.P3,"onPointerOver"),Object(b.a)(this,this.O3,"onPointerOut"),
z));this.KJc=0;this.od=A;this.od.sE(Object(b.a)(this,this.JI,"onSessionEnd"));this.clear()}dispose(){this.gN.dispose();this.DFc=null}get hCb(){return this.fpd}setZIndex(l){this.gN.setZIndex(l)}$dl(l,r,w){this.fpd=l;this.DFc=r;this.gN.jwh("UnreadNotification_16x16x32",this.hCb,w)}clear(){this.gN.clear();this.fpd=m.a.none}Toe(){this.pRb();this.gN.ptd(this.hCb,this.prf);this.gN.Ssg()}pRb(){this.gN.cAe();this.gN.ZLe()}JI(){h.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.KJc);
0<this.KJc&&f.c(e.a.Oci)}get prf(){return this.DFc?this.DFc():""}P3(){this.Toe();h.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.KJc+=1;return!0}O3(){this.pRb();return!0}}Object(x.a)(n,"ShapeRevisionTrackingPawn",null,[739])},1348:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(285);class b{constructor(f){this.bob=this.CWb=null;this.Qi=f}dispose(){this.clear();this.CWb.parentNode.removeChild(this.CWb)}LKb(f){this.CWb=this.rmf(f,"prContainerHr");this.bob=this.rmf(this.CWb,
"prGlyph")}clear(){this.N4b()}setImage(f,e){f&&(this.N4b(),this.bob.appendChild(f),this.bob.style.backgroundColor=e,this.CWb.style.visibility=c.a.visible)}rmf(f,e){const h=this.Qi.hg();this.Qi.addCssClass(h,e);f.appendChild(h);return h}N4b(){this.bob.firstChild&&this.bob.removeChild(this.bob.firstChild)}}Object(x.a)(b,"ShapePawnGlyph",null,[])},1349:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b){this.COj=b}get Bec(){return this.COj}}Object(x.a)(c,"ShowHideNotesData",
null,[])},1350:function(x,G,a){a.d(G,"a",function(){return n});x=a(0);var c=a(17),b=a(1233),f=a(231),e=a(40),h=a(68),u=a(258),m=a(250);class n{constructor(l,r,w,y,z,A,B,H,v){this.AM=new b.a;this.tQ=C=>C.isDecorative?ResourceStrings.L_AccMessageDecorative:C.get_altTitle();this.Jlg=l;this.Ub=r;this.t3=z;this.Ia=w;this.Hd=A;this.AEc=B;this.gq=y;this.Cj=H;this.la=v;this.Faj()}get Tc(){return this.Hd.instance}get k0(){return this.AEc.value}Faj(){var l;this.AM.K(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);
this.AM.K(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.AM.K(2,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.AM.K(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.AM.K(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);this.AM.K(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.AM.K(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.AM.K(11,[ResourceStrings.l_PhTypeClipArt,
ResourceStrings.l_InsertContent]);this.AM.K(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);this.AM.K(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);this.AM.K(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.AM.K(6,[ResourceStrings.l_PhTypeFooter,ResourceStrings.l_ClickToAddFooter]);this.AM.K(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber]);(null===(l=this.la)||void 0===l?0:l.tTa)&&this.AM.K(16,
[ResourceStrings.l_PhTypeCameo,ResourceStrings.l_ClickToAddCameo])}pVi(l,r){l&&(this.Kfa(l,r),l.Vsa?r.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.vJd(l,null,r));return null}ywl(l){if(!this.Jlg.instance||!l)return null;l=this.Jlg.instance.BVi(l);if(!l||!l.length)return null;const r=l.length;return 1===r?String.format(ResourceStrings.l_ShapePresenceForOneUser,l[0].userName):2===r?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,l[0].userName,l[1].userName):3===r?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,
l[0].userName,l[1].userName,l[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,r)}tih(l){let r="";l&&l.TT&&l.image.title&&0<l.image.title.length&&(r=l.image.title);l&&(r=String.format(ResourceStrings.l_ThumbnailInfoNew,l.slideIndex+1,this.Ub.hl(),r),l=this.mYi(l),0<l.length&&(r+=l));return r}mYi(l){const r=new Sys.StringBuilder;l.isSelected&&r.append(ResourceStrings.L_SlideIsSelected);l.ol&&r.append(ResourceStrings.l_SlideIsHidden);const w=Object(f.a)(32,l.zd);if(w){var y=
w.pKa();y&&!this.gq.mTf(y)&&r.append(ResourceStrings.l_SlideHasNotes);(y=w.JV())&&this.t3.instance&&this.t3.instance.Wih(y)&&(y=this.t3.instance.uCe(y),r.append(1===y?ResourceStrings.l_SlideHasOneComment:String.format(ResourceStrings.l_SlideHasCommentsWithCount,y)))}l.GX&&r.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(l.yCb&&(l=l.yCb.kTa())&&0<l.length)if(1===l.length)r.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,l[0].userName));else{y="";for(const z of l)y+=z.userName+
",";r.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,y))}w&&w.isUnread&&r.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);return r.toString()}n8c(l,r){return String.format(ResourceStrings.l_MultipleSlidesSelected,l,r)}tul(l,r){return String.format(ResourceStrings.l_DesignerSuggestionSelected,l+1,r)}Fwl(){return ResourceStrings.l_SlidePanel}yvl(){return ResourceStrings.l_MultipleShapes}VXl(l){l&&(this.la.jIa&&l.Q3(Object(e.a)(this,this.LJi,"getCameoAccMessage")),
l.Q3(Object(e.a)(this,this.rXi,"getTableAccMessage")),l.Q3(Object(e.a)(this,this.OOi,"getImageAccMessage")),l.Q3(Object(e.a)(this,this.BQi,"getMediaAccMessage")),l.Q3(Object(e.a)(this,this.ZJi,"getChartAccMessage")),this.rYc?(l.Q3(Object(e.a)(this,this.eHf,"getSmartArtAccMessage")),l.Q3(Object(e.a)(this,this.vJd,"getPlaceHolderAccMessage"))):(l.Q3(Object(e.a)(this,this.vJd,"getPlaceHolderAccMessage")),l.Q3(Object(e.a)(this,this.eHf,"getSmartArtAccMessage"))),l.Q3(Object(e.a)(this,this.eYi,"getTextboxAccMessage")),
l.Q3(Object(e.a)(this,this.sVi,"getShapeGroupAccMessage")),l.Q3(Object(e.a)(this,this.oVi,"getShapeAccMessage")),l.Q3(Object(e.a)(this,this.uIi,"getAddinAccMessage")),l.Q3(Object(e.a)(this,this.iIi,"get3DAccMessage")))}vJd(l,r,w,y=null){if(l&&w&&l.pl&&(this.Bxc(l,w),this.AM.Ob(l.placeholderType))){y&&y(String.format("{0} {1}",this.AM.ha(l.placeholderType)[0],ResourceStrings.l_Placeholder));if(l.nS||!w.count){w=this.AM.ha(l.placeholderType)[0];r="";if(!this.rYc||l.nS)r=this.AM.ha(l.placeholderType)[1];
return String.format(l.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,w,this.tQ(l),r,l.get_alt())}l=String.format(l.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,this.AM.ha(l.placeholderType)[0],this.tQ(l),l.get_alt());w.insert(0,document.createTextNode(l))}return null}eYi(l,r,w,y=null){if(l&&w&&l.Uq)if(this.Bxc(l,w),y&&y(ResourceStrings.L_TextBox),0<w.count)l=String.format(l.get_alt()?
ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,this.tQ(l),l.get_alt()),w.insert(0,document.createTextNode(l));else return String.format(l.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,this.tQ(l),l.get_alt());return null}eHf(l,r,w,y=null){if(l&&w&&l.rg)if(this.Bxc(l,w),y&&y(ResourceStrings.L_SmartArt),0<w.count)l=String.format(l.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,
this.gHf(l)||"",this.tQ(l),l.get_alt()),w.insert(0,document.createTextNode(l));else return String.format(l.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.gHf(l)||"",this.tQ(l),l.get_alt());return null}Kfa(l,r){l&&r&&this.Ia.VH(l,w=>{w.Ra(u.a.tq)&&this.UDf(w,r)})}Bxc(l,r){if(l&&r){const w=this.rYc?new h.a:r;let y=!1;this.Ia.VH(l,z=>{const A=this.Cj.WV(z),B=this.Cj.P1b(z);A&&w.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,
B)));y=this.UDf(z,w)||y});this.rYc&&y&&r.addRange(w);r.count||(l=l.Dre)&&r.add(document.createTextNode(l))}}get rYc(){return m.a("AriaMessageHelper.FixAccMessageForEmptyList")}UDf(l,r){let w;const y=l.oa(u.a.W7b,null),z=l.oa(u.a.tq,"");if(z&&r){if(y){let A=0,B=null,H;for(let v=0;v<y.length+1;v++)H=this.Ia.kwc(l,v),B&&B!==H&&(w=document.createElement("span"),w.setAttribute("lang",B),w.innerText=z.substring(A,y[v-1]),A=y[v-1],r.add(w)),B=H;w=document.createElement("span");B&&w.setAttribute("lang",B);
w.innerText=z.substring(A,z.length)}else w=document.createElement("span"),(l=this.Ia.kwc(l,0))&&w.setAttribute("lang",l),w.innerText=z;r.add(w)}return!!z&&0<z.length}rXi(l,r,w,y=null){return l&&l.Zc?(y&&y(ResourceStrings.L_Table),String.format(l.get_alt()?ResourceStrings.l_AccMessageTableAlt:ResourceStrings.l_AccMessageTable,this.tQ(l),l.get_alt())):null}OOi(l,r,w,y=null){return l&&l.Kg?(y&&y(ResourceStrings.l_Image),String.format(l.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,
this.tQ(l),l.get_alt())):null}LJi(l,r,w,y=null){if(!l||!l.HA)return null;y&&y(ResourceStrings.l_Cameo);return l.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,this.tQ(l),l.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):String.format(ResourceStrings.l_AccMessageCameo,this.tQ(l),ResourceStrings.l_CameoLearnMoreMessage)}BQi(l,r,w,y=null){if(l){if(0===l.mediaType)return null;if(1===l.mediaType)return y&&y(ResourceStrings.l_Audio),this.la.NN?String.format(ResourceStrings.l_AccMessageCanvasAudio,
l.shapeName):String.format(l.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,this.tQ(l),l.get_alt());if(2===l.mediaType)return y&&y(ResourceStrings.l_Video),String.format(l.get_alt()?ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,this.tQ(l),l.get_alt())}return null}ZJi(l,r,w,y=null){return l&&l.om?(y&&y(ResourceStrings.l_Chart),String.format(l.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.$Ji(l)||"",this.tQ(l),
l.get_alt())):null}sVi(l,r,w,y=null){return l&&l.Ce?(y&&y(ResourceStrings.L_GroupObjects),m.a("GroupShapeAltTitleFixEnabled")?String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,l.$t().length,l.get_alt()):String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,this.tQ(l),l.get_alt())):null}oVi(l,r,w,y=null){if(l&&w&&l.Vsa&&!l.Uq)if(this.Bxc(l,w),r=this.Ia.OGf(l),l.Qsa&&(r=ResourceStrings.l_DecorativeLabel),
y&&y(r||ResourceStrings.l_TextShape),0<w.count)l=String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,r||ResourceStrings.l_TextShape,this.tQ(l),l.get_alt()),w.insert(0,document.createTextNode(l));else return String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,r||ResourceStrings.l_TextShape,this.tQ(l),l.get_alt());return null}uIi(l,r,w,y=null){return l&&l.ht&&this.Tc&&this.k0?(l=this.k0.FIa(l),
l=this.Tc.mGd(l.id),y&&y(l?l.o9a:null),l?l.o9a:null):null}iIi(l,r,w,y=null){return l&&l.n3?(y&&y(ResourceStrings.l_3DModel),String.format(l.get_alt()?ResourceStrings.l_AccMessage3DAlt:ResourceStrings.l_AccMessage3D,this.tQ(l),l.get_alt())):null}gHf(l){return l.smartArtInfo?n.fKd(l.smartArtInfo.SmartArtLayout,1,177,"L_SAType"):(c.ULS.sendTraceTag(509092052,815,10,"SmartArt {0}#{1} has no SmartArtInfo",l.slideId?l.slideId.toString():"",l.get_shapeId()),null)}$Ji(l){return n.fKd(l.chartType,0,102,"L_ChartType")}zwl(l,
r){return(l=this.Ia.s8c(l))&&r?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,r,l):null}static exl(l){return n.fKd(l,1,177,"L_SAType")}static fKd(l,r,w,y){return l>=r&&l<=w&&(l=ResourceStrings[y+l])?l:null}}Object(x.a)(n,"AriaMessageHelper",null,[745])},1389:function(x,G,a){a.d(G,"a",function(){return Mb});var c=a(69);x=a(0);var b=a(139),f=a(30),e=a(43),h=a(4),u=a(13),m=a(3),n=a(460),l=a(5),r=a(7),w=a(19),y=a(83),z=a(42),A=a(8),B=a(20),H=a(248),v=a(250),C=a(296),F=a(894);class D extends Sys.EventArgs{constructor(hb){super();
this.clientX=hb.ClientX;this.clientY=hb.ClientY}}Object(x.a)(D,"OnBrowserEventArgs",Sys.EventArgs,[]);class N extends Sys.EventArgs{constructor(hb){super();this.slideId=hb.SlideId;this.slideIndex=hb.SlideIndex;this.NBl=hb.IsBeforeReady;this.sCl=hb.IsFromEndOfSlideshow;this.summary=hb.Summary}}Object(x.a)(N,"OnExitSlideshowEventArgs",Sys.EventArgs,[]);class U extends Sys.EventArgs{constructor(hb){super();this.slideId=hb.SlideId;this.slideIndex=hb.SlideIndex;this.tfd=hb.TimeLineMappings}}Object(x.a)(U,
"OnGetCurrentPositionEventArgs",Sys.EventArgs,[]);class W extends Sys.EventArgs{constructor(hb){super();this.slideHeight=hb.SlideHeight;this.slideWidth=hb.SlideWidth;this.yKk=hb.SlideLeftBound;this.oKk=hb.SlideBottomBound}}Object(x.a)(W,"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[]);class L extends Sys.EventArgs{constructor(hb){super();this.code=hb.Code;this.reason=hb.Reason;this.podSessionId=hb.PodSessionId}}Object(x.a)(L,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[]);var O=a(1218);class M extends Sys.EventArgs{constructor(hb){super();
this.clientX=hb.ClientX;this.clientY=hb.ClientY}}Object(x.a)(M,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[]);class K extends Sys.EventArgs{constructor(hb){super();this.key=hb.Key;this.shiftKey=hb.ShiftKey;this.altKey=hb.AltKey}}Object(x.a)(K,"OnSpecialKeyEventArgs",Sys.EventArgs,[]);var P=a(231);class V extends Sys.EventArgs{constructor(hb){super();this.Uyh=null;this.Uyh="string"===typeof hb?Object(P.a)(String,hb):hb.TranscriberSessionId}}Object(x.a)(V,"OnTranscriberStartedEventArgs",Sys.EventArgs,
[]);class Y extends Sys.EventArgs{constructor(hb){super();this.isVisible=hb.IsVisible}}Object(x.a)(Y,"OnVisibilityChangeEventArgs",Sys.EventArgs,[]);var ta=a(1217),fa=a(40);class Ta{}Ta.speechMode="Subtitles";Ta.Mof=[Ta.speechMode];Ta.sourceLanguage=null;Ta.targetLanguages=null;Ta.speechFDBase=null;Ta.podSessionId=null;Ta.a6g=null;Ta.docId=null;Ta.webServiceBase=null;Ta.userSessionId=h.AFrameworkApplication.userSessionId;Object(x.a)(Ta,"PPTSpeechClientConfig",null,[]);class ha{constructor(){this.ua=
new f.a}onFinalRecognitionText(hb){this.ua.raiseEvent("OnFinalRecognitionText",hb)}onPartialRecognitionText(hb){this.ua.raiseEvent("OnPartialRecognitionText",hb)}onError(hb){this.ua.raiseEvent("OnError",hb)}onSpeechRecognitionStarted(hb){this.ua.raiseEvent("OnSpeechRecognitionStarted",hb)}onEventUpdate(hb){this.ua.raiseEvent("OnEventUpdate",hb)}o0h(hb){this.ua.addHandler("OnFinalRecognitionText",hb)}nok(hb){this.ua.removeHandler("OnFinalRecognitionText",hb)}z1h(hb){this.ua.addHandler("OnPartialRecognitionText",
hb)}dpk(hb){this.ua.removeHandler("OnPartialRecognitionText",hb)}k0h(hb){this.ua.addHandler("OnError",hb)}jok(hb){this.ua.removeHandler("OnError",hb)}Z1h(hb){this.ua.addHandler("OnSpeechRecognitionStarted",hb)}ypk(hb){this.ua.removeHandler("OnSpeechRecognitionStarted",hb)}l0h(hb){this.ua.addHandler("OnEventUpdate",hb)}lok(hb){this.ua.removeHandler("OnEventUpdate",hb)}}Object(x.a)(ha,"PPTSpeechClientObserverController",null,[]);var qa=a(17);class ra{constructor(){this.accessToken=null}}Object(x.a)(ra,
"IAuthenticationProvider",null,[]);class I{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(x.a)(I,"IDocumentDownloadConfig",null,[]);class ba{constructor(){this.documentDownloadConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=
null}}Object(x.a)(ba,"ISpeechConfig",null,[]);class Ga{constructor(hb){this.T1=hb}onFinalText(){}onFragmentText(){}onFinalRecognitionText(hb,Da){this.T1.onFinalRecognitionText(hb,Da)}onPartialRecognitionText(hb,Da){this.T1.onPartialRecognitionText(hb,Da)}onError(hb){if("ErrorNone"!==hb)switch(hb){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.T1.onError("AccessDenied");break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.T1.onError("FailedToConnect");
break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.T1.onError("Timeout");break;case "ErrorInitialSilenceTimeout":this.T1.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.T1.onError("UnknownError");break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.T1.onError("MicrophoneError");
break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.T1.onError("NotAllowedError");break;case "ErrorAudioNotFoundError":this.T1.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.T1.onError("NotReadableError");break;default:this.T1.onError("CustomError-"+hb)}}onSpeechRecognitionStarted(hb){qa.ULS.sendTraceTag(507843283,830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",hb);this.T1.onSpeechRecognitionStarted(hb)}onEventUpdate(hb){this.T1.onEventUpdate(hb)}}
Object(x.a)(Ga,"PPTSpeechClientObserver",null,[792]);class Oa{constructor(hb){this.u6=null;this.kAa=0;this.microphoneDeviceId="";this.iPj=new Ga(hb)}Npj(){return 2===this.kAa}icj(){const hb=this.vmf(),Da=Object.assign(new ra,{accessToken:""});this.u6&&0!==this.kAa&&(this.u6.stopSpeechRecognition(),this.kAa=0);this.u6=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(hb,this.iPj,Da,null,new b.a);return this.u6?!0:(qa.ULS.sendTraceTag(507843219,830,10,"Speech client was not successfully created"),
!1)}DWg(){this.u6&&(0===this.kAa?(this.u6.startSpeechRecognition(),this.kAa=2):1===this.kAa&&(this.u6.resumeSpeechRecognition(),this.kAa=2))}HMk(){this.u6&&(this.u6.stopSpeechRecognition(),this.kAa=0)}c6j(){this.u6&&(this.u6.pauseSpeechRecognition(),this.kAa=1)}setCustomSetting(hb,Da){this.u6&&this.u6.setCustomSetting(hb,Da)}vmf(){return Object.assign(new ba,{speechMode:Ta.speechMode,sourceLanguage:Ta.sourceLanguage,targetLanguages:Ta.targetLanguages,speechFDBase:Ta.speechFDBase,captureAudioPauseResumeRecordingState:!0,
clientApp:0,documentDownloadConfig:Object.assign(new I,{docId:Ta.docId,podsSessionId:Ta.podSessionId,userDataCenterClusterId:Ta.a6g,webServiceBase:Ta.webServiceBase}),userSessionId:Ta.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(x.a)(Oa,"PPTSpeechClientProxy",null,[]);var Ja;(function(hb){hb[hb.none=0]="none";hb[hb.singleLineRibbon=1]="singleLineRibbon";hb[hb.multipleLineRibbon=2]="multipleLineRibbon";hb[hb.slideShowToolbar=3]="slideShowToolbar";hb[hb.slideShowKeyboardShortcut=
4]="slideShowKeyboardShortcut";hb[hb.liveBroadcast=5]="liveBroadcast"})(Ja||(Ja={}));Object(x.b)("TranscriptionEntryPoint",Ja);var Qa=a(1124),Pa=a(283),ja=a(284);class va{constructor(){this.Gf=this.v6=this.vB=this.R3a=this.Mq=this.vd=this.la=this.Ud=this.qf=null;this.Dob=!1;this.Su=null;this.Z3a=this.kbd=0;this.g9f=!1;this.nAa=this.mAa="";this.hGc=!1;this.N7d="";this.FYd=0;this.PGc=this.ota=this.HMc="";this.e1=null;this.xpa={};this.xha=new ha;this.o6=new Oa(this.xha);va.lcj()}init(hb,Da,Bb,Za,mb,
vb,sb){H.a.J(512495707,830,50,"SlideshowSubtitles.Init");this.Gf=Da;this.la=hb;this.qf=Bb;this.vd=Za;this.Su=mb;this.Ud=vb;this.e1=sb;this.Mq=document.createElement("div");this.Mq.id="SubtitleContainer";this.Mq.className="SubtitleContainer";this.Mq.style.display=Pa.a.Sf;this.Mq.style.visibility=Pa.a.ms;this.R3a=document.createElement("div");this.R3a.id="SubtitleResultDiv";this.R3a.className="SubtitleResultDiv";this.qf.crl&&(this.R3a.style.direction="rtl");this.vB=document.createElement("span");this.vB.id=
"SubtitleResultSpan";this.vB.className="SubtitleResultSpan";this.vB.setAttribute("aria-hidden","true");this.v6=document.createElement("span");this.v6.id="SubtitleAccessibilitySpan";this.v6.className="SubtitleAccessibilitySpan";this.v6.innerText="";this.v6.setAttribute("lang",this.qf.g8a);this.v6.setAttribute("aria-live","assertive");this.v6.setAttribute("aria-label",ResourceStrings.L_SubtitleAccessibilityWindow);this.v6.setAttribute("aria-atomic","true");this.R3a.appendChild(this.vB);this.R3a.appendChild(this.v6);
this.Mq.appendChild(this.R3a);this.Gf.appendChild(this.Mq);n.a.instance.Zb(this.vB,()=>!1);h.AFrameworkApplication.ga.p3?this.su():h.AFrameworkApplication.ga.fg(Object(fa.a)(this,this.su,"onFullAppSettingsReady"))}su(){this.HMc=this.getUserId();this.ota=h.AFrameworkApplication.ga.La("TenantId");this.PGc=this.la.hostAuthType||h.AFrameworkApplication.ga.La("HostAuthType")||"Unknown"}getUserId(){let hb=h.AFrameworkApplication.ga.La("PptEditingUserId");l.a.rb(hb)&&(hb=h.AFrameworkApplication.ga.La("LoggableUserId"),
H.a.J(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",l.a.rb(hb)));return hb}Unk(){this.Mq.style.display=Pa.a.Sf;this.Mq.style.visibility=Pa.a.ms}iRa(hb,Da,Bb,Za,mb,vb){this.kmb()&&(this.Su.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,Qa.a.z$d),this.kbd=window.setTimeout(Object(fa.a)(this,this.vMf,"hideSoundReminderNotification"),3E3));this.uYk(Da,Bb,Za,this.qf);this.o6&&(this.o6.microphoneDeviceId=this.e1.microphoneDeviceId);this.qf.Ks&&
this.o6.icj()?(this.xpa.StartTime=vb,this.xpa.LastError="ErrorNone",this.xpa.EntryPoint=Ja[mb],this.xha.o0h(Object(fa.a)(this,this.xxg,"onFinalRecognitionTextHandler")),this.xha.z1h(Object(fa.a)(this,this.Byg,"onPartialRecognitionTextHandler")),this.xha.k0h(Object(fa.a)(this,this.Izg,"onSpeechProxyErrorHandler")),this.xha.l0h(Object(fa.a)(this,this.Jzg,"onSpeechProxyEventUpdateHandler")),this.xha.Z1h(Object(fa.a)(this,this.Kzg,"onSpeechRecognitionStartedHandler")),this.o6.DWg(),this.o6.setCustomSetting("clientMetadata",
JSON.stringify(this.RBf())),this.vB.innerText="["+ResourceStrings.L_SubtitleInitMessage+"]",this.vB.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==mb),this.iud(),this.vd.oaf(Object(fa.a)(this,this.$0b,"onGetCurrentSlideDimensionsHandler")),this.vd.$9b(Object(fa.a)(this,this.Ybe,"onSlideChangedHandler"))):this.WWg()}RBf(hb=""){const Da=B.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString()),Bb={};Bb.userID=this.HMc;Bb.tenantId=this.ota;Bb.identityProvider=this.PGc;
Bb.audienceChannel="";Bb.audienceGroup=Da.Ring||"Unknown";Bb.buildVersion=h.AFrameworkApplication.buildVersion||"Unknown";Bb.locale=this.la.Bsb||"Unknown";Bb.wacHost=Da.Host||"Unknown";Bb.wacDatacenter=Da.WACDatacenter||"Unknown";Bb.livePragueSessionInfo=hb;return Bb}WWg(){this.Mq?(this.Mq.style.display=Pa.a.Sf,this.Mq.style.visibility=Pa.a.ms,this.o6.HMk(),this.xha.nok(Object(fa.a)(this,this.xxg,"onFinalRecognitionTextHandler")),this.xha.dpk(Object(fa.a)(this,this.Byg,"onPartialRecognitionTextHandler")),
this.xha.jok(Object(fa.a)(this,this.Izg,"onSpeechProxyErrorHandler")),this.xha.lok(Object(fa.a)(this,this.Jzg,"onSpeechProxyEventUpdateHandler")),this.xha.ypk(Object(fa.a)(this,this.Kzg,"onSpeechRecognitionStartedHandler")),this.vd.FKg(Object(fa.a)(this,this.$0b,"onGetCurrentSlideDimensionsHandler")),this.vd.OUc(Object(fa.a)(this,this.Ybe,"onSlideChangedHandler")),this.kmb()&&this.Su.instance.hide(),this.xpa.EndTime=Date.now(),H.a.J(512495705,817,15,JSON.stringify(this.xpa,va.AVk)),this.xpa={},this.qf.PBe=
!1):H.a.J(508063889,817,50,"SlideshowSubtitles::stopTranscribe SubtitleContainer is null")}iud(){let hb=3;this.xpa.LastPosition=this.qf.z2;"AboveSlide"===this.qf.z2&&this.Mq.style.visibility===Pa.a.Cw?(this.Mq.style.display=Pa.a.r_,this.Mq.style.backgroundColor="black",this.Mq.style.bottom="auto"):"BelowSlide"===this.qf.z2&&this.Mq.style.visibility===Pa.a.Cw?(this.Mq.style.display=Pa.a.r_,this.Mq.style.backgroundColor="black",this.Mq.style.bottom="3%",hb=-1):"TopOverlay"===this.qf.z2?(this.Mq.style.display=
Pa.a.r_,this.Mq.style.backgroundColor="transparent",this.Mq.style.bottom="auto",hb=5):"BottomOverlay"===this.qf.z2&&(this.Mq.style.display=Pa.a.r_,this.Mq.style.backgroundColor="transparent",this.Mq.style.bottom="5%",hb=-1);this.Dob&&document.getElementById("LiveURLBarLayerHost")?this.Mq.style.top=-1<hb?String.format("calc({0}% + {1})",hb.toString(),"26px"):"auto":(this.Mq.style.top=-1<hb?hb.toString()+"%":"auto",this.bbf())}isVisible(){return this.Mq.style.visibility===Pa.a.Cw}LRk(hb,Da=""){Ta.Mof=
hb?["Live","Subtitles"]:["Subtitles"];this.Dob=hb;this.setVisibility(this.Mq.style.visibility===Pa.a.Cw);this.iud();this.o6.setCustomSetting("clientMetadata",JSON.stringify(this.RBf(Da)));this.o6.setCustomSetting("slideIndex",this.FYd);this.o6.setCustomSetting("currentSpeechModes",JSON.stringify(Ta.Mof))}qwb(hb){this.Mq.style.cursor=hb?"default":"none"}bbf(){this.vB.style.fontSize=Math.floor(this.Mq.clientHeight/2/1.5).toString()+"px";this.N7d=Math.floor(this.Mq.clientHeight/12-2)+"px";this.vB.style.display=
"inline"}setVisibility(hb){this.Mq?(null===hb&&(hb=this.Mq.style.visibility===Pa.a.ms),this.Mq.style.visibility=hb?Pa.a.Cw:Pa.a.ms):H.a.J(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}$0b(){this.bbf()}Ybe(hb,Da){this.FYd=Da.slideIndex;this.o6.Npj()&&this.Dob&&(this.o6.setCustomSetting("currentSlideIndex",this.FYd),H.a.J(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}OMe(hb){hb?(this.o6.c6j(),this.k5b(),this.hGc=
!0,this.Ud&&this.Ud.instance&&this.Ud.instance.C2l()):(this.o6.DWg(),this.Ud&&this.Ud.instance&&this.Ud.instance.D2l())}vMf(){this.kmb()&&(window.clearTimeout(this.kbd),this.Su.instance.hide())}uYk(hb,Da,Bb,Za){Ta.sourceLanguage=Za.Ybb;Ta.targetLanguages=Za.Sec;Ta.podSessionId=hb;Ta.a6g=Da;Ta.docId=Bb;Ta.webServiceBase=this.la.$l;Ta.speechFDBase=h.AFrameworkApplication.ga.La(ja.a.wCb);hb=!!this.Ud&&!!this.Ud.instance&&(this.Ud.instance.Rtc||this.Ud.instance.PK);Ta.speechMode=this.Ud&&this.Ud.instance&&
this.Ud.instance.XM&&this.Ud.instance.oac||hb?"Live":"Subtitles"}qrf(hb,Da){this.g9f||(this.vB.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.Z3a),this.vB.innerText=this.EYi(hb,Da),this.vB.scrollTop=this.vB.scrollHeight,this.Z3a=window.setTimeout(Object(fa.a)(this,this.k5b,"resetSubtitlesToEmpty"),1E4),Da&&(this.v6.innerText=hb,this.v6.focus()),this.vB.style.padding=l.a.rb(hb)?"0px":this.N7d)}PB(hb){this.g9f||(this.vB.style.color="rgba( 255, 255, 0, 1 )",l.a.rb(hb)&&(hb=ResourceStrings.L_SubtitleGenericErrorMessage),
window.clearTimeout(this.Z3a),this.vB.innerText="["+hb+"]",this.vB.scrollTop=this.vB.scrollHeight,this.Z3a=window.setTimeout(Object(fa.a)(this,this.k5b,"resetSubtitlesToEmpty"),1E4),this.vB.style.padding=this.N7d,this.v6.innerText="",this.v6.focus())}K5i(hb){if(null!==hb)switch(hb){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.PB(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.xpa.LastError="MicrophoneError";break;case "FailedToConnect":this.PB(ResourceStrings.L_SubtitleRetryErrorMessage);
this.xpa.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.PB(ResourceStrings.L_SubtitleGenericErrorMessage);this.xpa.LastError="FailedToCreateSpeechSession";break;default:H.a.J(512495703,830,15,"HandleSpeechProxyError {0}",hb)}}xxg(hb,Da){this.Mq.style.visibility!==Pa.a.ms&&this.qrf(Da[this.qf.Sec],!0)}Byg(hb,Da){this.Mq.style.visibility!==Pa.a.ms&&this.qrf(Da[this.qf.Sec],!1)}Izg(hb,Da){H.a.J(512495702,830,10,"OnSpeechProxyErrorHandler {0}",Da);(hb=Da.toString())&&
(-1<hb.indexOf("NotAllowedError")||-1<hb.indexOf("NotFoundError")||-1<hb.indexOf("NotReadableError")||-1<hb.indexOf("MicrophoneError"))&&this.kmb()&&this.Su.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,Qa.a.VBb);this.K5i(hb)}Kzg(hb,Da){H.a.J(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",Da.toString());this.vd.n2j(Da.toString());this.k5b();this.kmb()&&this.Su.instance.hide()}Jzg(hb,Da){if(this.kmb())switch(hb=Da.eventName,hb){case "MediaEvent":"AudioDeviceConnected"===
Da.mediaStatus&&this.Su.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,Qa.a.z$d);break;case "ConnectionRetry":this.Su.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,Qa.a.VBb);this.PB(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const Bb=Da.shortCode;hb=Da.longCode;const Za=Da.shortString,mb=Da.longString;switch(Da.severity){case 0:this.Su.instance.hide();break;case 1:(Da=0<Bb?va.uba[Bb]:Za)&&this.Su.instance.show(Da,Qa.a.Ibd);break;case 2:(Da=
0<Bb?va.uba[Bb]:Za)&&this.Su.instance.show(Da,Qa.a.VBb),Da=null===hb?mb:va.uba[hb],l.a.rb(Da)||(window.clearTimeout(this.Z3a),this.PB(Da),this.Z3a=window.setTimeout(Object(fa.a)(this,this.k5b,"resetSubtitlesToEmpty"),3E4))}break;default:H.a.J(512495700,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",hb)}}kmb(){return this.la.nBa&&!!this.Su&&!!this.Su.instance}k5b(){this.vB.style.color="rgba( 255, 255, 255, 1 )";this.vB.innerText="";this.vB.scrollTop=this.vB.scrollHeight;this.nAa=this.mAa="";this.hGc=
!1;this.Z3a=0;this.vB.style.padding="0px"}EYi(hb,Da){this.hGc?this.U3h(hb):this.vqk(hb);this.hGc=Da;return l.a.rb(this.mAa)||l.a.rb(this.nAa)?l.a.rb(this.mAa)?this.nAa:this.mAa:this.mAa+"\n"+this.nAa}U3h(hb){this.mAa=l.a.rb(this.nAa)?this.mAa:this.nAa;this.nAa=hb}vqk(hb){l.a.rb(this.mAa)||l.a.rb(this.nAa)?this.mAa=hb:this.nAa=hb}static get instance(){return va.St}static lcj(){va.uba[1]=ResourceStrings.L_SubtitleDetection_Listening;va.uba[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;
va.uba[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;va.uba[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;va.uba[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static AVk(hb,Da){return"undefined"===typeof Da?null:Da}}va.uba=Array(20);va.St=new va;Object(x.a)(va,"SlideshowSubtitles",null,[778]);var Ha=a(1216),gb=a(254),Gb=a(278);class Mb{constructor(hb,Da,Bb,Za,mb,vb,sb,bc,yb,uc,vc,wc,ub,aa,Na,ia,wa,pa,Ea,La,Aa){this.Gg=this.lM=this.Ipb=null;this.tG=new b.a;this.ua=
new f.a;this.ycc="";this.so=null;this.LBb="";this.Oab=this.c7f=this.e_b=this.iA=this.t6=this.s6=this.IWb=this.$=null;this.f_b=!0;this.rY=Date.now();this.uU=Date.now();this.Xga=this.V6d=this.spg=0;this.JWd=this.Dob=!1;this.Naa=new Set;this.g3d=this.d6=!1;this.sJc=0;this.Nab=null;this.b4a=void 0;this.v7d=0;this.n7d={};this.N4d=0;this.iAa=this.tVb=this.rVb=!1;this.kog={};this.lka=!1;this.cyg=(nb,Wa)=>{this.f0j(Wa)};this.IZj=()=>{H.a.J(512309270,830,50,`SlideShowCoreFrame::OnEditHappened,, Edit time elapsed between two edits:${Date.now()-
this.uU} `);this.uU=Date.now();this.sJc++};this.X_j=(nb,Wa)=>{var ea;H.a.J(512309269,830,50,"SlideShowCoreFrame::OnLastMergeEditUTCChangedHandler");this.uU=Date.now();this.rVb=!0;this.iAa&&this.Qaa.JOe();this.la.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&(this.la.getBooleanAppSetting("CoauthEditSlideInfoEnabled")?(null===Wa||void 0===Wa?0:Wa.isPresentationChange)?this.g3d=!0:0<(null===(ea=null===Wa||void 0===Wa?void 0:Wa.LK)||void 0===ea?void 0:ea.length)&&Wa.LK.forEach(Kb=>
{Kb=JSON.stringify({Sid:Kb.Sid,Cid:Kb.Cid});this.Naa.has(Kb)||this.Naa.add(Kb)}):this.d6=!0)};this.a1j=(nb,Wa)=>{var ea;H.a.J(512309268,830,50,"SlideShowCoreFrame::OnRealTimeEditHandler");this.uU=Date.now();this.tVb=!0;this.iAa&&this.Qaa.JOe();this.la.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&(this.la.getBooleanAppSetting("CoauthEditSlideInfoEnabled")?0<(null===(ea=null===Wa||void 0===Wa?void 0:Wa.LK)||void 0===ea?void 0:ea.length)&&Wa.LK.forEach(Kb=>{Kb=JSON.stringify({Sid:Kb.Sid,
Cid:Kb.Cid});this.Naa.has(Kb)||this.Naa.add(Kb)}):this.d6=!0)};this.Q1j=(nb,Wa)=>{var ea;this.V6d=Date.now();H.a.J(507799770,830,50,"SlideShowCoreFrame::onSlideEditHandler");this.iAa&&this.Qaa.nzh(Wa.LK.map(Kb=>new Gb.a(Kb)),this.eL);this.d6||((null===Wa||void 0===Wa?0:Wa.isPresentationChange)?(H.a.J(507799769,830,15,"SlideShowCoreFrame::onSlideEditHandler SlideShow cache flushed by this edit"),this.d6=!0):0<(null===(ea=null===Wa||void 0===Wa?void 0:Wa.LK)||void 0===ea?void 0:ea.length)&&Wa.LK.forEach(Kb=>
{Kb=JSON.stringify({Sid:Kb.Sid,Cid:Kb.Cid});this.Naa.has(Kb)||this.Naa.add(Kb)}))};this.fhf=(nb,Wa)=>{var ea,Kb;"Error"==Wa&&this.ua.raiseEvent("OnCameraErrorEventId");this.M3a&&(window.clearTimeout(this.M3a),this.M3a=void 0);nb=this.mui(nb);null===(Kb=null===(ea=this.d_b)||void 0===ea?void 0:ea.instance)||void 0===Kb?void 0:Kb.show(nb,Wa);this.M3a=window.setTimeout(()=>{var kc,ac;null===(ac=null===(kc=this.d_b)||void 0===kc?void 0:kc.instance)||void 0===ac?void 0:ac.hide();this.M3a=void 0},3E3)};
this.Ckk=nb=>{Object(c.b)(this,void 0,void 0,function*(){if(this.B$c){var Wa=(new Date).getTime();try{const ea=yield this.B$c.qN("Hubble",nb);ea.IsSuccess?this.Gg.setAadToken(ea.Token):this.Gg.setAadToken("");H.a.J(508949124,830,50,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: ${ea.IsSuccess} time: ${(new Date).getTime()-Wa}`)}catch(ea){H.a.J(508949123,830,10,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: false time: ${(new Date).getTime()-
Wa} error: ${ea}`),this.Gg.setAadToken("")}}else H.a.J(508949125,830,10,"SlideShowCoreFrame::Refresh token requested without IOAuthManager. Setting AAD token as empty for SlideShow."),this.Gg.setAadToken("")})};this.Gf=hb;this.la=Da;this.qf=Bb;this.sGe=Za;this.Su=mb;this.d_b=pa;this.Ud=vb;this.e1=bc;this.dN=sb;this.pta=yb;this.rf=uc;this.mU=vc;this.Dh=wc;this.eL=ub;this.$p=aa;this.xcc=Na;this.Ub=ia;this.Qaa=Aa;if(this.la.getBooleanAppSetting("SlideShowGetPresInfoFromClient")){if(!wa)throw"PresInfo client not present";
this.Dlg=wa}this.lpg=La;this.iAa=this.la.getBooleanAppSetting("SnapUrlUpdateAfterEditEnabled");Ea&&(this.Nab=Ea);this.$Pj=e.a.getInstance();this.mU&&this.mU.execute(nb=>{nb.Dva(this.IZj)});if(!this.Ub)throw Error.argumentNull("presReader");this.xcc.Pah(this.cyg);this.Dh&&(this.Dh.Z9b(this.X_j),this.Dh.b$b(this.a1j),this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",!1)&&this.Dh.V1h(this.Q1j));if(this.la.isAnimationPreviewEnabled)this.Ex=this.Nab.getSettings(),
this.pta=this.Nab.pta;else try{const nb=this.Ex=JSON.parse(this.la.La("Settings"))||{};nb.slideshowcore||(nb.slideshowcore={});nb.slideshowcore&&nb.slideshowcore.forceSvg&&"true"===nb.slideshowcore.forceSvg.toString().toLowerCase()?this.pta=!0:this.pta&&(nb.slideshowcore.forceSvg="True");nb.slideshowcore.enableCameoInPPTOSlideShow=this.la.tX.toString()}catch(nb){H.a.J(512495906,830,10,"SlideShowCoreFrame::Exception in parsing settings:{0}",nb),this.Ex={}}this.kog=B.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString())}tpj(hb){return null==
hb||v.a("CacheRetentionExperimentReversedCommands")&&-1<(this.la.La("CacheRetentionExperimentReversedCommands")||"").indexOf(hb+";")?!1:Ha.a.includes(hb)?!0:v.a("CacheRetentionExpCommandsFromBRS")?-1<(this.la.La("CacheRetentionExperimentCommands")||"").indexOf(hb.toString()+";"):!1}f0j(hb){var Da;Object(c.b)(this,void 0,void 0,function*(){if(!this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",!1)&&hb.actionId!==gb.a.Wja&&(this.iAa&&this.Qaa.nzh(null===hb||
void 0===hb?void 0:hb.LK,this.eL),this.la.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled"))){var Bb=this.Ub.XZ(null===(Da=null===hb||void 0===hb?void 0:hb.LK[0])||void 0===Da?void 0:Da.sid);Bb=null===Bb||void 0===Bb?void 0:Bb.slideIndex;H.a.J(508297357,830,50,`SlideShow:: Edit Command triggered  ::${hb.actionId}, SlideIndex Edited:: ${Bb},Edit time elaplsed between two edits:${Date.now()-this.uU}`);hb&&hb.LK&&1==hb.LK.length&&this.tpj(null===hb||void 0===hb?void 0:hb.actionId)&&!this.d6?
(Bb=JSON.stringify({Sid:hb.LK[0].sid,Cid:hb.LK[0].cid}),this.Naa.has(Bb)||(this.Naa.add(Bb),this.n7d[this.$Gf(hb.LK[0].sid,hb.LK[0].cid)]=hb.actionId)):!this.d6&&v.a("TelemetryForSSCacheFlushCommand")&&(H.a.J(508063836,830,15,`SlideShowCoreFrame::onMarkedUndoWithSlidesAsync SlideShow cache flushed by this edit. Command triggered::${hb.actionId}, SlideIndex Edited:: ${Bb}`),this.d6=!0,this.N4d=hb.actionId)}})}preloadShaders(){this.YXc();this.w6b();SlideShowCore.SlideShowCore.preloadShaders()}init(hb,
Da,Bb,Za){return Object(c.b)(this,void 0,void 0,function*(){this.ycc=Bb;this.eL=Za;this.LBb=Da;if(this.so)H.a.J(509636752,830,50,"SlideShowCoreFrame::init - initPromise {0}",this.LMa),yield this.LMa;else{this.IWb=document.getElementById("HiddenFocusTrapAnchor");this.so=document.createElement("div");this.so.id="SlideShowBackground";this.so.className="SlideShowBackground";this.so.style.visibility=Pa.a.ms;this.so.tabIndex=-1;this.$=document.createElement("div");this.$.id="SlideShowContainer";this.$.className=
"SlideShowContainer";this.$.tabIndex=-1;this.$.style.width=window.screen.width+"px";this.$.style.height=window.screen.height+"px";u.a.addHandler(this.so,m.a.XEa,sb=>{this.q0j(sb)});n.a.instance.Zb(this.so,sb=>this.hPc(sb));this.so.appendChild(this.$);this.IWb?this.Gf.insertBefore(this.so,this.IWb):this.Gf.appendChild(this.so);var mb=this.la.La("pptSlideShowCoreCssUrl"),vb=document.createElement("link");vb.setAttribute("rel","stylesheet");vb.setAttribute("type","text/css");vb.setAttribute("href",mb);
this.$.appendChild(vb);va.instance.init(this.la,this.so,this.qf,this,this.Su,this.Ud,this.e1);this.s6=document.getElementById("slideshowBeginningFocusTrap");this.t6=document.getElementById("slideshowEndFocusTrap");this.s6||this.t6||(this.s6=document.createElement("div"),this.s6.id="slideshowBeginningFocusTrap",this.s6.className="FocusTrap",this.s6.tabIndex=0,u.a.addHandler(this.s6,m.a.focus,()=>{this.Bzg()}),this.t6=document.createElement("div"),this.t6.id="slideshowEndFocusTrap",this.t6.className=
"FocusTrap",this.t6.tabIndex=0,u.a.addHandler(this.t6,m.a.focus,()=>{this.Bzg()}),this.IWb?(this.Gf.insertBefore(this.s6,this.Gf.firstChild),this.Gf.insertBefore(this.t6,this.IWb.nextSibling)):(mb=document.getElementById("slideshow-toolbar"),this.Gf.insertBefore(this.s6,this.so),this.Gf.insertBefore(this.t6,mb)));this.la.getBooleanAppSetting("IsSnapUrlFetchedEarlyOnBootEnabled")&&this.lpg?(mb=yield this.lpg.sWi())&&!l.a.rb(mb.fsf)?(this.iA=mb.fsf,this.lka=mb.uMe,this.rY=Date.now(),yield this.GNd()):
(this.LMa=this.sKd(1),yield this.LMa):(this.LMa=this.sKd(1),yield this.LMa)}})}Ogj(){return this.rVb||this.tVb}sKd(hb){return Object(c.b)(this,void 0,void 0,function*(){let Da=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.$l,this.eL);if(v.a("AddCallerQueryParam")){const mb=this.la.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");Da+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${mb}`}const Bb={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};
Bb["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;const Za=new Date;return new Promise((mb,vb)=>{this.$p.rk(Da,1,"",Bb,!1,0,sb=>Object(c.b)(this,void 0,void 0,function*(){yield this.b1b(sb,Za);H.a.J(509636751,830,15,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlSucceeded");mb()}),sb=>Object(c.b)(this,void 0,void 0,function*(){yield this.a1b(sb,hb);H.a.J(509636750,830,10,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlFailed");vb()}),null,null)})})}b1b(hb,Da){return Object(c.b)(this,
void 0,void 0,function*(){H.a.J(512309283,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+Da);const Bb=JSON.parse(hb.data.responseData);this.iA=Bb.downloadUrl;void 0!==Bb.sendGetItemsRequestToPFD&&(this.lka=Bb.sendGetItemsRequestToPFD);l.a.rb(this.iA)?H.a.J(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",Bb):(this.rY=Date.now(),yield this.GNd())})}zJd(){const hb={};hb.settings=this.Ex;hb.retryCount=
this.la.Jc("GetItemsRetryCount",3);hb.retryOnCategories=this.la.La("GetItemsRetryCategories").split(";");const Da={};Da.Slide=ResourceStrings.l_Slide;Da.AnimNum=ResourceStrings.l_AccSsAnimNum;Da.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;Da.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;Da.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;Da.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;hb.localizedStrings=Da;return hb}GNd(){return Object(c.b)(this,
void 0,void 0,function*(){this.YXc();this.w6b();v.a("UseNewPodsProxyConstructor")?this.XNf():this.Ipb=new PodsProxy.PodsProxy(this.la.Gsa?this.la.n$a:this.la.$l,{DownloadUrl:this.iA,DocID:h.AFrameworkApplication.ui,CustomFontCatalogUrl:this.la.La("CustomFontCatalogURL")},this.la.e_?l.a.vI(this.la.e_).toLowerCase():"",this.tG,this.Fjb(),this.Gjb());this.lM=new SlideShowCore.DefaultResourceProviders(this.Ipb,this.tG,this.zJd());const hb={};hb.initTime=Mb.gS();hb.uiHost="Unified App";hb.serverUrl=l.a.Sj(this.la.$l);
hb.userSessionId=this.ycc;hb.jsScriptsBasePath=this.la.La("StaticContentHost")+"pptscripts/ssapp/";hb.fileHost=this.la.La("FileHost");hb.isRtl=h.AFrameworkApplication.isRtl;hb.applicationLcid=h.AFrameworkApplication.lcid;hb.applicationLocaleName=h.AFrameworkApplication.uiCulture;hb.areThirdPartyAddInsAllowed=h.AFrameworkApplication.uSa;hb.theWsaClient=h.AFrameworkApplication.Hl;hb.appForOfficeContextActivationParameters=F.a.UCe(this.rf);hb.hubbleVideoEndpoint=this.la.LAb;hb.acceptLanguage=h.AFrameworkApplication.uiCulture;
hb.appForOfficeAuthFactory=new ta.a;const Da={};Da.settings=this.Ex;Da.transitionResourceCDNPath=this.la.geh;Da.transitionDisabledList=this.la.kRa;Da.clickTargetEnabled=!0;Da.mediaEnabled=!0;Da.gifEnabled=!0;Da.convertGifToVideo=!0;Da.crossSlideAudioEnabled=!0;Da.editAudioEnabled=this.la.getBooleanAppSetting("PPTOAudioPlaybackOptionsEnabled");Da.flipgridVideoEnabled=this.la.getBooleanAppSetting("PptModernSlideShowFlipgridVideoEnabled");Da.useNewYoutubePlayer=!0;Da.useNewVimeoPlayer=!0;Da.useOnlineVideoPlayer=
!0;Da.tedVideoEnabled=this.la.getBooleanAppSetting("PptModernSlideShowTEDVideoEnabled");Da.isStream2Enabled=!0;Da.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;Da.enableSVGAsWebGLTexture=!r.a.zg&&this.la.getBooleanAppSetting("SlideShowShapeBuilderSVGEnabled");Da.maxSvgTextureSize=this.la.Jc("ShapeBuilderMaxSvgTextureSize",2048);Da.enableSlideSizeAdjust=this.la.getBooleanAppSetting("EnableSlideSizeAdjust");Da.slideSizeMax={["x"]:this.la.Jc("SlideShowMaxWidth",1504),["y"]:this.la.Jc("SlideShowMaxHeight",
849)};Da.slideSizeMin={["x"]:this.la.Jc("SlideShowMinWidth",348),["y"]:this.la.Jc("SlideShowMinHeight",261)};Da.slideSizeDefault={["x"]:this.la.Jc("SlideShowDefaultWidth",1504),["y"]:this.la.Jc("SlideShowDefaultHeight",849)};Da.streamVideoUseThinEmbed=this.la.getBooleanAppSetting("StreamVideoUseThinEmbed");Da.slideMetadataEnabled=this.la.getBooleanAppSetting("PptModernSlideShowSlideMetadataEnabled");Da.disabledChangeGates=this.la.La("PPTDisabledChangeGates");Da.isMultiSlideshowcoreEnabled=this.la.getBooleanAppSetting("MultiSlideshowcoreEnabled");
Da.combineBootRequest=!0;Da.localVideoTelemetryEnabled=this.la.getBooleanAppSetting("IsGFXVideoLocalTelemetryEnabled");Da.imageSettings={["imageAppendOption"]:"all"};Da.SlideShowCacheRetentionExperimentEnabled=this.la.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled");Da.usePresInfoFromClient=this.la.getBooleanAppSetting("SlideShowGetPresInfoFromClient");const Bb={};v.a("addFlightToSSC")&&(Bb.verifyGlyphAsynchronously=h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.verifyGlyphAsynchronously",
!1));const Za={["slideShowCoreSettings"]:Da,["appSettings"]:hb};v.a("addFlightToSSC")&&(Za.flights=Bb);v.a("AddInstanceSourceIdentifier")?this.Gg=new SlideShowCore.SlideShowCore(this.$,this.lM,this.tG,Za,1):this.Gg=new SlideShowCore.SlideShowCore(this.$,this.lM,this.tG,Za);new SlideShowCore.PrefetchAddon(this.Gg,this.tG,{["forwardPrefechCount"]:this.la.Jc("PptModernSlideShowForwardPrefetchCount",10),["backwardPrefechCount"]:this.la.Jc("PptModernSlideShowBackwardPrefetchCount",5),["forwardPrerenderCount"]:this.la.Jc("PptModernSlideShowForwardPrerenderCount",
2),["backwardPrerenderCount"]:this.la.Jc("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.Gg,this.tG);this.spg=Date.now();this.Oab=this.Gg.init();this.Gg.events.on("slideLocationChanged",()=>{this.Xbd()});this.Gg.events.on("animationStateChanged",()=>{this.Xbd()});this.Gg.events.on("slideDimensionsChanged",()=>{this.xCe()});this.Gg.events.on("exitFromEndOfShow",()=>{this.kxg(!0)});this.Gg.events.on("blankSlideStateChanged",mb=>{this.SYj(mb)});this.Gg.events.on("slideshowError",
mb=>{this.HIe(mb)});this.la.getBooleanAppSetting("IsStream2VideoEnabled")&&(this.B$c=w.a.instance.resolve("Common.App.OAuth.IOAuthManager"),this.Gg.events.on("aadTokenRequest",mb=>{this.Ckk(mb)}));return new Promise(mb=>Object(c.b)(this,void 0,void 0,function*(){yield this.Oab;this.f_b=!1;this.c7f=new SlideShowCore.InputsAddon(this.Gg,this.$,h.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.Gg,Za,this.tG);new SlideShowCore.TransitionLoggerAddon(this.Gg,Za,this.tG);new SlideShowCore.PerfCheckerAddon(this.Gg,
Za,this.tG);this.e_b=new SlideShowCore.SlideShowInkAddon(this.Gg,this.tG,this.$,()=>this.sGe.loadScript("slideshowink"),{["telemetryLogger"]:this.$Pj});this.la.tX&&(this.c_b=new SlideShowCore.CameoWebcamAddon(this.Gg,{notificationCallback:this.fhf}));this.c7f.events.on("keydown",vb=>{this.f1b(vb)});H.a.J(509636749,830,15,"SlideShowCoreFrame - initSlideShowCore Finshed Initializing");mb()}))})}Gjb(){const hb={};hb.timeout=this.la.Jc("PptModernSlideShowGetItemsTimeoutMs",3E4);hb.throwHttpErrors=!1;
hb.enableServerSpecificErrorCode=v.a("SSCore.EnableServerSpecificErrorCode");hb.pptoPresentFrontDoorEnabled=this.PSd();return hb}w6b(){try{const hb=this.Ex;if(hb.slideshowcore){const Da={};Da.settings=hb;Da.logger=this.tG;Da.disabledChangeGates=this.la.La("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(Da)}}catch(hb){H.a.J(509703488,830,10,"SlideShowCoreFrame::Exception in passing settings to slideshowcore:{0}",hb)}}YXc(){try{const hb=this.Ex;if(hb.podsproxy){const Da={};
Da.settings=hb;window.PodsProxy.setupGlobals_PodsProxy(Da)}}catch(hb){H.a.J(512309267,830,10,"SlideShowCoreFrame::Exception in passing settings to podsproxy:{0}",hb)}}Aue(hb,Da,Bb){return Object(c.b)(this,void 0,void 0,function*(){this.YXc();this.w6b();if(this.Gg){v.a("UseNewPodsProxyConstructor")?this.XNf():this.Ipb=new PodsProxy.PodsProxy(this.la.Gsa?this.la.n$a:this.la.$l,{DownloadUrl:this.iA,DocID:h.AFrameworkApplication.ui,CustomFontCatalogUrl:this.la.La("CustomFontCatalogURL")},this.la.e_?l.a.vI(this.la.e_).toLowerCase():
"",this.tG,this.Fjb(),this.Gjb());var Za=this.lM;this.lM=new SlideShowCore.DefaultResourceProviders(this.Ipb,this.tG,this.zJd());var mb=this.x7d;v.a("RockyV2NavigationFix")&&Bb&&mb<this.Ub.hl()-1&&mb++;if(v.a("UpdateSlideShowCoreRefractoringEnabled")){let vb=!1;if(this.la.getBooleanAppSetting("SlideShowGetPresInfoFromClient")&&Za&&(!v.a("DisabledPresInfoClientInCoauth")||!this.Ogj())){const sb=Za.presInfo.getLoadResultInCache("");(null===sb||void 0===sb?0:sb.resource)&&this.Dlg&&(sb.resource=this.Dlg.$vl(sb.resource),
null===sb||void 0===sb?0:sb.resource)&&(this.lM.presInfo.add(sb),vb=!0)}mb={shouldRerenderSlide:!0,startSlideIndex:this.E5()?mb:this.x7d,isCacheRetentionEnabled:this.E5(),updateSlideShowCoreAfterLaunch:this.E5()&&Bb,isPresInfoFromClient:vb};yield this.Gg.updateResourceProviders(this.lM,mb)}else this.E5()?yield this.Gg.updateResourceProviders(this.lM,{shouldRerenderSlide:!0,updateSlideShowCoreAfterLaunch:Bb,startSlideIndex:mb,isCacheRetentionEnabled:this.E5()}):yield this.Gg.updateResourceProviders(this.lM,
{shouldRerenderSlide:!0,startSlideIndex:this.x7d,isCacheRetentionEnabled:this.E5()});Za&&Za.dispose();H.a.J(508162582,830,50,`SlideShowCoreFrame::Number of edits happened::${this.sJc}`);v.a("RockyV2Telemetry")?this.Jrk():(this.Naa.clear(),this.d6=!1,this.sJc=0);H.a.J(593827098,830,15,"SlideShowCoreFrame::Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",hb,Da,Date.now(),this.W$a())}else H.a.J(508908737,830,10,"SlideShowCoreFrame - updateSlideShowCore: m_slideshowCore is null")})}XNf(){try{this.Ipb=
new PodsProxy.PodsProxy(this.la.Gsa?this.la.n$a:this.la.$l,{DownloadUrl:this.iA,DocID:h.AFrameworkApplication.ui,CustomFontCatalogUrl:this.la.La("CustomFontCatalogURL")},this.la.e_?l.a.vI(this.la.e_).toLowerCase():"",this.tG,this.Fjb(),this.Gjb())}catch(hb){if(hb instanceof TypeError)this.Ipb=new PodsProxy.PodsProxy(this.la.Gsa?this.la.n$a:this.la.$l,{DownloadUrl:this.iA,DocID:h.AFrameworkApplication.ui,CustomFontCatalogUrl:this.la.La("CustomFontCatalogURL")},this.la.e_?l.a.vI(this.la.e_).toLowerCase():
"",this.tG,this.PSd()?this.la.La("PresentUrlEndpoint"):void 0,this.Fjb(),this.Gjb());else throw H.a.J(507811592,830,10,"SlideShowCoreFrame::Error in PodsProxy initialization:{0}",hb),hb;}}Jrk(){this.Naa.clear();this.d6=!1;this.sJc=this.N4d=0;this.tVb=this.rVb=!1;this.n7d={};this.g3d=!1}a1b(hb,Da){return Object(c.b)(this,void 0,void 0,function*(){const Bb=hb.data?hb.data.Ze:-1;0<Da--?(H.a.J(512309281,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
Bb),yield this.sKd(Da)):H.a.J(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : HttpStatus: {0}",Bb)})}E5(){return this.la.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&v.a("SlideCacheExperimentV2")}Txh(hb,Da,Bb,Za,mb,vb,sb,bc,yb){Object(c.b)(this,void 0,void 0,function*(){var uc=0;this.x7d=0>=Da?0:Da-1;var vc={};v.a("SSLaunchRefactoredLaunchLogs")&&(vc.id=y.a.create().toString(),vc.additionalMetrics={});const wc={};v.a("CoauthEditSlideInfoEnabledTelemetryEnabled")&&
(wc.CoauthEditSlideInfoEnabled=this.la.getBooleanAppSetting("CoauthEditSlideInfoEnabled"));if(v.a("SSNetworkInfo")&&"connection"in navigator){var ub=navigator.connection,aa={};"effectiveType"in ub&&(aa.type=ub.effectiveType);"downlink"in ub&&(aa.downlink=ub.downlink);"rtt"in ub&&(aa.rtt=ub.rtt);wc.network=aa}this.LMa&&(H.a.J(509617947,830,15,"SlideShowCoreFrame::StartFrom - initPromise {0}",this.LMa),ub=Mb.gS(),yield this.LMa,uc=Mb.gS()-ub,this.W$a()||this.show());if(l.a.rb(this.iA))H.a.J(508924042,
830,10,"SlideShowCoreFrame::StartFrom DownloadUrl is null or empty - {0}",this.iA),this.W$a()&&(vc=C.a.wi(410),h.AFrameworkApplication.Xs(vc),z.Health.instance.recordQosError(C.a.Fja(vc),["SlideShowACE"],!1,!0,!0,!0,null),this.Gg&&this.Gg.recordSessionStats({["errorName"]:"ErrorSlideShowGetItemsFailedDownloadFile"}),this.exit());else if(this.Gg){ub={sr:"ss"};v.a("SSLaunchUnifiedTelemetry")&&(wc.initPromiseTimeMs=uc);this.uU>this.rY||this.f_b?(this.Ex.slideshowcore.vetoBootDurationMs=this.la.Jc("PptModernSlideShowEditVetoBootDurationMs",
8E3),ub.BootScenario=this.uU>this.rY?"AfterEdit":"Init",H.a.J(509703459,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.Jc("PptModernSlideShowEditVetoBootDurationMs",8E3),this.uU,this.rY,this.f_b)):(this.Ex.slideshowcore.vetoBootDurationMs=this.la.Jc("PptModernSlideShowCachedVetoBootDurationMs",2E3),ub.BootScenario="Relaunch",H.a.J(509703458,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",
this.la.Jc("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.uU,this.rY,this.f_b));this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",!1)&&this.xvj();this.w6b();aa=0;uc=this.E5()&&!this.RUf(hb)&&this.uU>this.rY;const Na=this.E5()?this.RUf(hb)&&this.uU>this.rY:this.uU>this.rY;v.a("RockyV2Telemetry")&&this.E5()&&(wc.updateSlideShowCoreBeforeLaunch=Na,wc.updateSlideShowCoreAfterLaunch=uc,Na&&(wc.slideEditSource=this.aWi(hb),wc.slideFirstEditCommand=this.bWi(hb)),
v.a("PPTOPresentFrontDoorTelemetry")&&(wc.pptoPresentFrontDoorEnabled=this.la.getBooleanAppSetting("PPTOPresentFrontDoorEnabled"),wc.isGetItemsRequestRoutedtoPFD=this.PSd()));Na&&(aa=Mb.gS(),this.Gg.showLoadingSpinner(),this.iAa&&this.Qaa.zlh(this.uU)?yield this.n4g(uc,vc):yield this.Bue(1,uc),aa=Mb.gS()-aa,v.a("SSLaunchRefactoredLaunchLogs")&&(vc.additionalMetrics.isUpdateResourceProviderCalled=!0));v.a("SSLaunchUnifiedTelemetry")&&(ub.SSCoreUpdateAfterEditMs=aa);ub.startFromTime=yb-window.performance.timing.navigationStart;
ub.SSCoreFrameStartTime=Mb.gS();v.a("SSLaunchRefactoredLaunchLogs")&&(wc.CacheRetentionExpEnabled=this.E5());v.a("SSSnapUrlUpdateAfterEditEnabled")&&(wc.SnapUrlUpdateAfterEditEnabled=this.iAa);v.a("SSRockySlideEditEnhancementEnabled")&&(wc.RockySlideEditEnhancement=this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",!1));v.a("IsGetPresInfoClientEnabled")&&(wc.IsGetPresInfoClientEnabled=this.la.getBooleanAppSetting("SlideShowGetPresInfoFromClient"));v.a("IsSnapUrlonBootEnabled")&&
(wc.IsSnapUrlonBootEnabled=this.la.getBooleanAppSetting("IsSnapUrlFetchedEarlyOnBootEnabled"));v.a("SSEUPLBugTelemetry")&&(wc.SlideShowClickTime=yb);va.instance.Unk();this.$.style.top="0";this.s6&&this.t6&&(this.s6.tabIndex=0,this.t6.tabIndex=0);aa={["slideId"]:{["sid"]:hb,["cid"]:0}};aa.slideIndex=Da-1;this.v7d+=1;v.a("SSLaunchNumberInSession")&&(wc.SlideShowLaunchNumber=this.v7d);v.a("SSLaunchSlideIndexTelemetry")&&(wc.SlideShowIndex=Da-1);v.a("SSLaunchRefactoredLaunchLogs")&&(wc.id=vc.id,H.a.J(508072012,
830,15,JSON.stringify(wc)));h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SSRemoveCheckFullScreenChecker",!1)||!this.dN.NEe||this.dN.A0a?this.Dxf(aa,ub,uc,vc):this.Xdi(aa,ub,uc,vc);this.iAa&&this.Qaa.t_l()}else H.a.J(512495901,830,10,"SlideShowCoreFrame::SlideshowCore is undefined")})}n4g(hb,Da){return Object(c.b)(this,void 0,void 0,function*(){this.rY=this.Qaa.Vsh;this.iA=this.Qaa.vVl;this.lka=this.Qaa.uMe;yield this.Aue(new Date(this.Qaa.wVl),new Date(this.Qaa.Vsh),
hb);H.a.J(507884896,830,15,"SlideShowCoreFrame::updateSlideShowCoreWithPrefetchedSnapUrl served prefethed snap url with updateSlideShowCoreAfterLaunch:{0}, actionId:{1}",hb,Da.id)})}PSd(){return v.a("SimplifyChecksAndReturnValueInSnapResponse")?this.lka:this.la.getBooleanAppSetting("PPTOPresentFrontDoorEnabled")&&v.a("AddCallerQueryParam")&&this.kog.FileSizeBytes<=this.la.Jc("PresentFrontdoorMaxAllowedFileSizeInBytes",1E8)&&!h.AFrameworkApplication.RA}RUf(hb){hb=-1==hb?this.Ub.fw(0):this.Ub.XZ(hb);
hb=JSON.stringify({Sid:hb.sid,Cid:hb.cid});return this.d6||this.Naa.has(hb)||this.la.getBooleanAppSetting("CoauthEditSlideInfoEnabled")&&this.g3d}xvj(){this.V6d<this.uU&&(H.a.J(507793607,830,15,"SlideShowCoreFrame: User launched before server response. ServerResponseTime:{0}, LastEditTime:{1}",this.V6d,this.uU),v.a("ToggleMultiSlideEditOnServerResponseTime")||(this.d6=!0))}aWi(hb){if(this.rVb)return 2;if(this.tVb)return 3;if(this.d6)return 1;hb=-1==hb?this.Ub.fw(0):this.Ub.XZ(hb);hb=JSON.stringify({Sid:hb.sid,
Cid:hb.cid});return this.Naa.has(hb)?0:4}$Gf(hb,Da){return hb+"_"+Da}bWi(hb){if(this.tVb||this.rVb)return-2;if(this.d6)return this.N4d;hb=-1==hb?this.Ub.fw(0):this.Ub.XZ(hb);return this.n7d[this.$Gf(hb.sid,hb.cid)]}prev(){return Object(c.b)(this,void 0,void 0,function*(){this.Gg&&(this.E5()&&this.b4a&&(this.Gg.showLoadingSpinner(),yield this.b4a,this.Gg.hideLoadingSpinner()),yield this.Gg.prevStep("0_anim"))})}next(){return Object(c.b)(this,void 0,void 0,function*(){this.Gg&&(this.E5()&&this.b4a&&
(this.Gg.showLoadingSpinner(),yield this.b4a,this.Gg.hideLoadingSpinner()),yield this.Gg.nextStep("0_anim",3))})}show(){this.xfd(!0)}W$a(){return this.so&&this.so.style.visibility===Pa.a.Cw?!0:!1}xfd(hb){va.instance.setVisibility(hb&&this.qf.Ks);this.so&&(hb?(this.so.style.visibility=Pa.a.Cw,$addHandler(window,"visibilitychange",Da=>{this.KQc(Da)})):(this.so.style.visibility=Pa.a.ms,$removeHandler(window,"visibilitychange",Da=>{this.KQc(Da)})))}exit(){this.kxg(!1)}iRa(hb,Da,Bb,Za,mb,vb,sb){const bc=
!!this.Ud&&!!this.Ud.instance&&(this.Ud.instance.Rtc||this.Ud.instance.PK);(this.Ud&&this.Ud.instance&&this.Ud.instance.XM&&this.Ud.instance.oac||bc)&&!this.Ud.instance.MBe()?H.a.J(512495900,830,10,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):(va.instance.iRa(hb,Da,Bb,Za,mb,vb,sb),this.qf.Ks&&this.Gg.recordSessionStats({["metadata"]:"subtitles"}),this.qCd())}Dxf(hb,Da,Bb,Za){Object(c.b)(this,void 0,void 0,function*(){this.la.isAnimationPreviewEnabled&&(yield this.Gg.refreshViewControllerSSC());
this.la.getBooleanAppSetting("EnsureNavigationStateConsistency")||this.Gg.clearNavigationState();Za.navigationType="init";Za.startFromTime=Da.startFromTime;Da.waitedForInit=this.f_b;Da.startInitTime=this.spg;Da.beforeInitPromise=Mb.gS();yield this.Oab;Da.afterInitPromise=Mb.gS();Za.bootMetrics=Da;if(0>hb.slideIndex){var mb=this.la.getBooleanAppSetting("EnsureNavigationStateConsistency")?yield this.Gg.gotoFirstSlideOptions(!0,{Kd:Za,gIm:!0}):yield this.Gg.gotoFirstSlide(!0,Za);v.a("AddLogsForGotoFirstSlideFailure")&&
mb&&!mb.fSucceeded&&H.a.J(507799685,830,10,"SlideShowCoreFrame::finishStartFrom: slide show core gotoSlide failed with error {0}",null===mb||void 0===mb?void 0:mb.error);this.$.style.height="100%";this.$.style.width="100%";H.a.J(508924041,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {0}",JSON.stringify(hb))}else mb={},mb.actionContext=Za,mb.fSkipTransition=!0,this.la.getBooleanAppSetting("EnsureNavigationStateConsistency")&&(mb.fClearNavigationState=!0),
v.a("FixForGotoSlideTelemetryMinify"),mb=yield this.Gg.gotoSlide(hb,mb),!v.a("AddLogsForGotoSlideFailure")||(null===mb||void 0===mb?0:mb.fSucceeded)||H.a.J(507863835,830,10,"SlideShowCoreFrame::finishStartFrom: slide show core gotoSlide failed with error {0}",null===mb||void 0===mb?void 0:mb.error),this.$.style.height="100%",this.$.style.width="100%",H.a.J(508924040,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {0}",JSON.stringify(hb));this.E5()&&Bb&&(this.b4a=
this.iAa&&this.Qaa.zlh(this.uU)?this.n4g(Bb,Za):this.Bue(1,Bb),yield this.b4a,this.b4a=void 0);this.ua.raiseEvent("OnSlideshowReady",new Sys.EventArgs)})}Xdi(hb,Da,Bb,Za){const mb=this.la.Jc("PptModernSlideShowCheckFullscreenCounter",10),vb=Mb.gS();let sb=mb,bc=4;v.a("fixEUPLBugEnabled")&&0!=this.Xga&&(H.a.J(508411976,830,15,"Clearing check full screen interval if it is already running:{0}.",this.Xga),this.la.getBooleanAppSetting("FixSlideShowEUPLBugEnabled")&&(window.clearInterval(this.Xga),this.Xga=
0));this.Xga=window.setInterval(()=>{if(this.la.getBooleanAppSetting("FixSlideShowEUPLBugEnabled")&&this.JWd)H.a.J(508404055,830,15,"SlideShowCoreFrame::checkFullscreenBeforeFinishStartFrom - Already CheckingFullScreen, exiting this iteration. checkFullscreenCounter: {0}.",sb);else{this.JWd=!0;sb--;H.a.J(512495899,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",sb);var yb=Mb.gS();if(this.dN.A0a||0>=sb){const vc=Mb.gS();window.clearInterval(this.Xga);this.Xga=0;if(v.a("fixEUPLBugEnabled")&&
0==sb%5&&0<=bc){bc--;var uc=A.a.Ot();H.a.J(508409102,830,15,"CallStack before checkFullscreenBeforeFinishStartFrom : {0}",uc)}uc=20*(mb-sb);v.a("SSLaunchUnifiedTelemetry")||(Da.checkFullscreenMs=uc);H.a.J(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms. Time taken in FullScreen API: {1}ms",uc,(vc-yb).toString());v.a("SSLaunchUnifiedTelemetry")&&!Da.checkFullscreenMs&&(Da.checkFullscreenMs=Mb.gS()-vb);this.Dxf(hb,Da,Bb,Za)}this.JWd=!1}},20)}qCd(){let hb=0,Da=100;
this.qf.Ks&&va.instance.isVisible()&&("AboveSlide"===this.qf.z2?(hb=15,Da=85):"BelowSlide"===this.qf.z2&&(Da=85));const Bb=document.getElementById("LiveURLBarLayerHost");this.Dob&&Bb?(this.$.style.top=String.format("calc({0}% + {1})",hb.toString(),"26px"),this.$.style.height=String.format("calc({0}% - {1})",Da.toString(),"26px")):(this.$.style.top=hb.toString()+"%",this.$.style.height=Da.toString()+"%")}OMe(hb){va.instance.OMe(hb)}Til(){this.fhf("NotAllowedError","Error")}mui(hb){return hb&&"string"===
typeof hb&&-1===hb.indexOf("unknown")?-1!==hb.indexOf("CameraStarted")?ResourceStrings.l_CameraReady:-1!==hb.indexOf("NotAllowedError")||-1!==hb.indexOf("SecurityError")||-1!==hb.indexOf("TypeError")?ResourceStrings.l_CameraPermissionError:-1!==hb.indexOf("NotFoundError")||-1!==hb.indexOf("OverconstrainedError")||-1!==hb.indexOf("ErrorStreamStartFailure")||-1!==hb.indexOf("ErrorNoVideoTracks")?ResourceStrings.l_CameraDetectionError:-1!==hb.indexOf("NotReadableError")?ResourceStrings.l_CameraInUseByAnotherAppError:
ResourceStrings.l_CameraError:ResourceStrings.l_CameraUnknownError}setCameraState(hb){var Da;null===(Da=this.c_b)||void 0===Da?void 0:Da.setCameraState(hb)}q9l(hb){this.c_b&&hb&&this.c_b.updateWebcamDevice(hb)}getDefaultCameraLabel(){var hb,Da;return null!==(Da=null===(hb=this.c_b)||void 0===hb?void 0:hb.getDefaultCameraLabel())&&void 0!==Da?Da:""}sOe(hb,Da=""){this.Dob=hb;va.instance.LRk(hb,Da);this.qCd()}Kyh(hb){va.instance.setVisibility(hb);va.instance.iud();this.qCd()}KRk(){this.ua.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}jda(){this.so&&this.so.style.visibility!==Pa.a.ms&&!this.kij()&&this.$.focus()}getCurrentPosition(){if(this.Gg){const hb=this.Gg.getSlideLocation();hb?this.ua.raiseEvent("OnGetCurrentPosition",new U({["SlideId"]:hb.slideId.sid,["SlideIndex"]:hb.slideIndex})):H.a.J(512495897,830,10,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}pul(){if(this.Gg){const hb=this.Gg.getSlideLocation();if(hb){const Da=this.Gg.getAnimationState(!0),Bb=Da.timelineStates,Za=[];for(let mb=
0;mb<Bb.length;mb+=1)Za.push({["TimeLineId"]:Bb[mb].timelineId,["Step"]:Bb[mb].step,["LastClickTime"]:Bb[mb].lastClickTime,["StartTimeOffset"]:Da.startTimeOffset});this.ua.raiseEvent("OnGetCurrentPosition",new U({["SlideId"]:hb.slideId.sid,["SlideIndex"]:hb.slideIndex,["TimeLineMappings"]:Za}))}else H.a.J(512495896,830,10,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}xCe(){if(this.Gg&&this.so&&this.so.style.visibility!==Pa.a.ms){const hb=document.getElementById(this.pta?
"svg-canvas":"webgl-canvas");hb&&this.ua.raiseEvent("OnGetCurrentSlideDimensions",new W({["SlideHeight"]:hb.offsetHeight,["SlideWidth"]:hb.offsetWidth,["SlideLeftBound"]:hb.offsetLeft,["SlideBottomBound"]:hb.offsetTop+hb.offsetHeight}))}}C8c(hb){Object(c.b)(this,void 0,void 0,function*(){if(this.Gg){let Da;v.a("FixForGotoSlideTelemetryMinify");Da=yield this.Gg.gotoSlide({["slideIndex"]:hb},{actionContext:{navigationType:"goto"},fSkipTransition:!1});!v.a("AddLogsForGotoSlideFailure")||(null===Da||
void 0===Da?0:Da.fSucceeded)||H.a.J(507863834,830,10,"SlideShowCoreFrame::goToSlide: slide show core gotoSlide failed with error {0}",null===Da||void 0===Da?void 0:Da.error)}})}Oxl(hb,Da){Object(c.b)(this,void 0,void 0,function*(){if(this.Gg){var Bb={},Za=[];let mb=0;for(let vb=0;vb<Da.length;vb+=1){const sb={};sb.timelineId=Da[vb].TimeLineId;sb.step=Da[vb].Step;sb.lastClickTime=Da[vb].LastClickTime;mb=Da[vb].StartTimeOffset;Za.push(sb)}Bb.timelineStates=Za;Bb.startTimeOffset=mb;Za={actionContext:{navigationType:"goto"}};
Za.animationState=Bb;Za.fSkipTransition=!1;v.a("FixForGotoSlideTelemetryMinify");Bb=yield this.Gg.gotoSlide({["slideIndex"]:hb},Za);!v.a("AddLogsForGotoSlideFailure")||(null===Bb||void 0===Bb?0:Bb.fSucceeded)||H.a.J(507863833,830,10,"SlideShowCoreFrame::GoToSlideWithTimeLines: slide show core gotoSlide failed with error {0}",null===Bb||void 0===Bb?void 0:Bb.error)}})}Bue(hb,Da){return Object(c.b)(this,void 0,void 0,function*(){H.a.J(512309260,830,15,"SlideShowCoreFrame::updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",
this.eL);let Bb=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.$l,this.eL);if(v.a("AddCallerQueryParam")){const vb=this.la.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");Bb+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${vb}`}const Za={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};Za["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;const mb=new Date;return new Promise((vb,sb)=>{this.$p.rk(Bb,1,"",Za,!1,0,bc=>Object(c.b)(this,
void 0,void 0,function*(){yield this.A_j(bc,mb,Da);H.a.J(509636748,830,15,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlSucceededAfterEdit");vb()}),bc=>Object(c.b)(this,void 0,void 0,function*(){yield this.y_j(bc,hb,Da);H.a.J(509636747,830,10,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlFailedAfterEdit");sb()}),null,null)})})}A_j(hb,Da,Bb){return Object(c.b)(this,void 0,void 0,function*(){const Za=new Date;H.a.J(512309279,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit. Time-Taken : {0}",
+Za-+Da);const mb=JSON.parse(hb.data.responseData);this.iA=mb.downloadUrl;void 0!==mb.sendGetItemsRequestToPFD&&(this.lka=mb.sendGetItemsRequestToPFD);l.a.rb(this.iA)?H.a.J(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",mb):(this.rY=Date.now(),yield this.Aue(Da,Za,Bb))})}y_j(hb,Da,Bb){return Object(c.b)(this,void 0,void 0,function*(){const Za=hb.data?hb.data.Ze:-1;0<Da--?(H.a.J(512309277,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
Za),yield this.Bue(Da,Bb)):H.a.J(512309276,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : HttpStatus: {0}",Za)})}YIg(hb,Da,Bb=1){return Object(c.b)(this,void 0,void 0,function*(){H.a.J(512309259,830,15,"SlideShowCoreFrame::RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",this.eL,hb);this.eL=hb;this.LBb=Da;let Za=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.$l,this.eL);if(v.a("AddCallerQueryParam")){const sb=this.la.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");
Za+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${sb}`}const mb={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};mb["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;const vb=new Date;return new Promise((sb,bc)=>{this.$p.rk(Za,1,"",mb,!1,0,yb=>Object(c.b)(this,void 0,void 0,function*(){yield this.B_j(yb,vb);sb()}),yb=>Object(c.b)(this,void 0,void 0,function*(){yield this.z_j(yb,Bb);bc()}),null,null)})})}B_j(hb,Da){return Object(c.b)(this,void 0,void 0,function*(){var Bb=
new Date;H.a.J(512309275,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession. Time-Taken : {0}",+Bb-+Da);const Za=JSON.parse(hb.data.responseData);this.iA=Za.downloadUrl;void 0!==Za.sendGetItemsRequestToPFD&&(this.lka=Za.sendGetItemsRequestToPFD);l.a.rb(this.iA)?(H.a.J(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",Za),this.W$a()&&(Bb=C.a.wi(413),h.AFrameworkApplication.Xs(Bb),z.Health.instance.recordQosError(C.a.Fja(Bb),
["SlideShowACE"],!1,!0,!0,!0,null),this.Gg&&this.Gg.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.rY=Date.now(),yield this.Aue(Da,Bb),v.a("prefetchOnPodSessionRefreshEnabled")&&this.Gg.prefetchOnPodSessionRefresh())})}z_j(hb,Da){return Object(c.b)(this,void 0,void 0,function*(){const Bb=hb.data?hb.data.Ze:-1;0<Da--?(H.a.J(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
Bb),yield this.YIg(this.eL,this.LBb,Da)):(H.a.J(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : HttpStatus: {0}",Bb),this.W$a()&&this.exit())})}setVisibility(hb){this.xfd(hb)}qwb(hb){this.so&&(this.so.style.cursor=hb?"default":"none");va.instance.qwb(hb)}n8j(hb){if(this.e_b)this.e_b.onInkManagerActivity(hb)}f1b(hb){this.Ivh(hb)}Ivh(hb){this.ua.raiseEvent("OnSpecialKey",new K({["Key"]:hb.keyCode,["ShiftKey"]:hb.shiftKey,["AltKey"]:hb.altKey}))}Bzg(){this.so&&this.jda()}Fjb(){const hb=
new Map;hb.set("X-UserSessionId",this.ycc);hb.set("X-WacNoAuth","1");hb.set("X-WacCluster",this.LBb);hb.set("Client","Unified App");v.a("AddHostInfoTelemetry")&&hb.set("HostName",h.AFrameworkApplication.Rf.Host);this.la.Ehh&&hb.set("UseDocCache","True");return hb}kxg(hb=!1){var Da,Bb,Za;H.a.J(507773716,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler");this.Xga&&(H.a.J(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",this.Xga),window.clearInterval(this.Xga),
this.Xga=0);this.e_b&&this.e_b.resetInkCanvas();null===(Da=this.c_b)||void 0===Da?void 0:Da.setCameraState(!1);this.M3a&&(null===(Za=null===(Bb=this.d_b)||void 0===Bb?void 0:Bb.instance)||void 0===Za?void 0:Za.hide(),window.clearTimeout(this.M3a),this.M3a=void 0);this.s6&&this.t6&&(this.s6.tabIndex=-1,this.t6.tabIndex=-1);this.Gg?(Da=this.Gg.getSlideLocation(),this.Gg.endSession(Mb.gS()),v.a("ssExitTelemetryEnabled")&&H.a.J(508071949,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: Exiting the SlideShow"),
Da?this.ua.raiseEvent("OnExit",new N({["SlideId"]:Da.slideId.sid,["IsBeforeReady"]:!1,["SlideIndex"]:Da.slideIndex,["IsFromEndOfSlideshow"]:hb})):(this.ua.raiseEvent("OnExit",new N({["IsFromEndOfSlideshow"]:hb})),H.a.J(512495889,830,10,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null")),H.a.J(507773715,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler: Exit event raised")):v.a("SendExitEventOnSlideShowTimeout")&&(this.ua.raiseEvent("OnExit",new N({["IsFromEndOfSlideshow"]:hb})),
H.a.J(507605470,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: m_slideshowCore is null, sending exit event"));this.$&&(this.$.style.width=window.screen.width+"px",this.$.style.height=window.screen.height+"px");this.xfd(!1);va.instance.WWg()}Xbd(){if(this.Gg&&this.so&&this.so.style.visibility!==Pa.a.ms){const hb=this.Gg.getSlideLocation();if(hb){const Da=this.Gg.getAnimationState(!0),Bb=Da.timelineStates,Za=[];for(let mb=0;mb<Bb.length;mb+=1)Za.push({["TimeLineId"]:Bb[mb].timelineId,["Step"]:Bb[mb].step,
["LastClickTime"]:Bb[mb].lastClickTime,["StartTimeOffset"]:Da.startTimeOffset});this.ua.raiseEvent("OnPositionChangeEventId",new O.a({["SlideId"]:hb.slideId.sid,["SlideIndex"]:hb.slideIndex,["TimeLineMappings"]:Za}))}else H.a.J(512495888,830,10,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}SYj(hb){if(this.Gg&&this.so&&this.so.style.visibility!==Pa.a.ms)switch(hb){case "Hidden":this.ua.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty);break;case "EndOfShow":this.ua.raiseEvent("OnEnterEndOfShowEventId",
Sys.EventArgs.Empty);break;default:H.a.J(512495887,830,15,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",hb)}}HIe(hb){if(this.Gg){H.a.J(512495886,830,10,"SlideshowCoreFrame.OnErrorHandler {0}",hb);let Da;hb.startsWith("Server")&&(hb="GetItemsRequestFailed");switch(hb){case "GetItemsFailedDownloadFile":H.a.J(512495885,830,10,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",this.eL);this.ua.raiseEvent("OnPodSessionExpired",new L({["Code"]:5341407,["Reason"]:"Failed To Download File",
["PodSessionId"]:this.eL}));return;case "LoadFailed":Da=407;break;case "GetItemsFailedInvalidResponse":Da=408;break;case "GetItemsRequestFailed":Da=409;break;case "GetItemsTimeout":Da=411;break;case "EnsureSlideFailed":Da=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":Da=414;break;default:Da=359}if(0!==Da)if(this.W$a()){const Bb=C.a.wi(Da);h.AFrameworkApplication.Xs(Bb);hb=409===Da?hb:C.a.Fja(Bb);z.Health.instance.recordQosError(hb,["SlideShowACE"],!1,!0,!0,!0,null);this.Gg.recordSessionStats({["errorName"]:hb})}else H.a.J(512495884,
830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",hb)}}n2j(hb){H.a.J(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.Gg&&this.so&&this.so.style.visibility!==Pa.a.ms&&this.ua.raiseEvent("OnTranscriberStartedEventId",new V({["TranscriberSessionId"]:hb}));this.qf.PBe=!0}KQc(){H.a.J(512495882,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");window.document.hidden&&this.ua.raiseEvent("OnVisibilityChangeEventId",new Y(!1))}kij(){return!!this.Ud&&
!!this.Ud.instance&&this.Ud.instance.hrl}Wah(hb){this.ua.addHandler("OnSlideshowReady",hb)}suh(hb){this.ua.removeHandler("OnSlideshowReady",hb)}T0h(hb){this.ua.addHandler("OnBrowserEvent",hb)}Iok(hb){this.ua.removeHandler("OnBrowserEvent",hb)}Hel(hb){this.ua.addHandler("OnFullscreenClick",hb)}SYl(hb){this.ua.removeHandler("OnFullscreenClick",hb)}X0h(hb){this.ua.addHandler("OnSlideshowContextMenu",hb)}Lok(hb){this.ua.removeHandler("OnSlideshowContextMenu",hb)}OJb(hb){this.ua.addHandler("OnExit",hb)}TCb(hb){this.ua.removeHandler("OnExit",
hb)}Bel(hb){this.ua.addHandler("OnSlideshowError",hb)}PYl(hb){this.ua.removeHandler("OnSlideshowError",hb)}oaf(hb){this.ua.addHandler("OnGetCurrentSlideDimensions",hb)}FKg(hb){this.ua.removeHandler("OnGetCurrentSlideDimensions",hb)}naf(hb){this.ua.addHandler("OnGetCurrentPosition",hb)}Sje(hb){this.ua.removeHandler("OnGetCurrentPosition",hb)}Xah(hb){this.ua.addHandler("OnSpecialKey",hb)}tuh(hb){this.ua.removeHandler("OnSpecialKey",hb)}gfl(hb){this.ua.addHandler("OnVisibilityChangeEventId",hb)}cpk(hb){this.ua.removeHandler("OnVisibilityChangeEventId",
hb)}o1h(hb){this.ua.addHandler("OnPodSessionExpired",hb)}Yok(hb){this.ua.removeHandler("OnPodSessionExpired",hb)}Oel(hb){this.ua.addHandler("OnLogEndOfTranscriptionSession",hb)}$Yl(hb){this.ua.removeHandler("OnLogEndOfTranscriptionSession",hb)}$9b(hb){this.ua.addHandler("OnPositionChangeEventId",hb)}OUc(hb){this.ua.removeHandler("OnPositionChangeEventId",hb)}Mel(hb){this.ua.addHandler("OnLiveSubtitlesDockedViewEventId",hb)}YYl(hb){this.ua.removeHandler("OnLiveSubtitlesDockedViewEventId",hb)}b1h(hb){this.ua.addHandler("OnEnterEndOfShowEventId",
hb)}Pok(hb){this.ua.removeHandler("OnEnterEndOfShowEventId",hb)}k1h(hb){this.ua.addHandler("OnLeaveEndOfShowEventId",hb)}Vok(hb){this.ua.removeHandler("OnLeaveEndOfShowEventId",hb)}cfl(hb){this.ua.addHandler("OnSubtitleUpdatedEventId",hb)}hZl(hb){this.ua.removeHandler("OnSubtitleUpdatedEventId",hb)}dfl(hb){this.ua.addHandler("OnTranscriberStartedEventId",hb)}iZl(hb){this.ua.removeHandler("OnTranscriberStartedEventId",hb)}mfl(hb){this.ua.addHandler("RecordQosErrorEventId",hb)}pZl(hb){this.ua.addHandler("RecordQosErrorEventId",
hb)}vel(hb){this.ua.addHandler("OnCameraErrorEventId",hb)}LYl(hb){this.ua.removeHandler("OnCameraErrorEventId",hb)}q0j(hb){this.ua.raiseEvent("OnBrowserEvent",new D({["ClientX"]:hb.clientX,["ClientY"]:hb.clientY}))}hPc(hb){this.ua.raiseEvent("OnSlideshowContextMenu",new M({["ClientX"]:hb.clientPoint.x,["ClientY"]:hb.clientPoint.y}));return!0}static gS(){return Math.round(window.performance.now())}}Object(x.a)(Mb,"SlideShowCoreFrame",null,[719])},1536:function(x,G,a){a.d(G,"a",function(){return b});
x=a(0);var c;(function(f){f[f.aOl=0]="multipleBrowsersImageClassName";f[f.yTl=1]="peopleImageClassName";f[f.zTl=4]="peopleImageClusterPath";f[f.$Nl=5]="multipleBrowserImageClusterPath";f[f.oTa=6]="imageDimension";f[f.rtl=8]="rtl";f[f.kCb=9]="pointerInputManager";f[f.BSa=10]="clickInputManager";f[f.vertical=11]="vertical";f[f.zIndex=12]="zIndex";f[f.W5c=13]="contextMenuInputManager";f[f.uAl=14]="imageDomElement";f[f.n$l=15]="useIdleTooltip";f[f.G$l=16]="viewportBoundsCallback";f[f.usl=17]="flipHorizontalDirection";
f[f.qsl=18]="fixRemoveFadeOutElementCrash";f[f.sAl=19]="ignoreEventOnExpandedTooltip";f[f.qBl=20]="ipWidthAdjustForFlyout"})(c||(c={}));Object(x.b)("PresenceTooltipSettingKeys",c);class b{constructor(){this.kP={}}get(f,e=null){f=c[f];return"number"===typeof e?(e=this.kP[f])?Number.parseInvariant(e.toString()):0:this.kP[f]}add(f,e){this.kP[c[f]]=e}eca(f,e){c[f]in this.kP||(this.kP[c[f]]=e)}remove(f){delete this.kP[c[f]]}}Object(x.a)(b,"PresenceTooltipSettings",null,[])},1638:function(x,G,a){a.d(G,
"a",function(){return K});x=a(0);var c=a(17),b=a(530),f=a(531),e=a(40);class h{static $Li(P,V,Y){return h.aMi(P,V,Y,!0)}static aMi(P,V,Y,ta){const fa=document.createElementNS(h.Mve,"svg");fa.setAttribute("viewBox",String.format(h.Tri,h.Q5g,h.P5g));fa.appendChild(h.lXi(P,V,Y,ta));return fa}static lXi(P,V,Y,ta){const fa=h.Q5g/P,Ta=V/2*fa,ha=h.P5g/2;let qa=0;ta&&(qa=(P-3*V-4*Y)*fa/2);P=document.createElementNS(h.Mve,"g");Sys.UI.DomElement.addCssClass(P,h.Sri);for(ta=1;3>=ta;ta++)P.appendChild(h.iKi(ta,
Ta,qa+(ta*(V+Y)-V/2)*fa,ha));return P}static iKi(P,V,Y,ta){const fa=document.createElementNS(h.Mve,"circle");Sys.UI.DomElement.addCssClass(fa,String.format("{0}-{1}",h.cfi,P));fa.setAttribute("cx",String.format("{0}",Y));fa.setAttribute("cy",String.format("{0}",ta));fa.setAttribute("r",String.format("{0}",V));return fa}}h.Mve="http://www.w3.org/2000/svg";h.Sri="prDancingDots";h.cfi="prAnimateCircle";h.Tri="0 0 {0} {1}";h.P5g=40;h.Q5g=120;Object(x.a)(h,"ModernPresenceTooltipDancingDots",null,[]);var u=
a(4),m=a(47),n=a(135),l=a(3),r=a(366),w=a(71),y=a(22),z=a(5),A=a(46);class B extends b.a{constructor(P,V){super(P);this.g8e=this.gGa=this.nid=this.Lua=this.uua=this.nI=this.wu=null;this.Qla=V.get(8,!1);this.bGa=V.get(6,0);this.kWh=V.get(15,!1);this.$d=V;this.iXe=0;this.element=P;this.element.className=B.jFd;this.mQ=document.createElement("span");this.element.appendChild(this.mQ);this.WHh=h.$Li(V.get(6,0),4,2);this.OO(V);this._state=5}nSa(P){this.addHandler(f.a.xI,P)}d6a(P){this.removeHandler(f.a.xI,
P)}get user(){return this.g8e}get state(){return this._state}dispose(){this.element&&(this.wu.jc(l.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.wu.jc(l.a.doubleClick,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")),this.nI.jc(l.a.TH,this.element,Object(e.a)(this,this.rta,"onPointerDown")),this.nI.jc(l.a.AR,this.element,Object(e.a)(this,this.O3,"onPointerOut")),this.nI.jc(l.a.KP,this.element,Object(e.a)(this,this.P3,"onPointerOver")),this.uua.jc(this.element,
Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}OO(P){this.wu=P.get(10);this.wu.Zb(l.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.wu.Zb(l.a.doubleClick,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior"));this.nI=P.get(9);this.nI.Zb(l.a.KP,this.element,Object(e.a)(this,this.P3,"onPointerOver"));this.nI.Zb(l.a.AR,this.element,Object(e.a)(this,this.O3,"onPointerOut"));this.nI.Zb(l.a.TH,this.element,Object(e.a)(this,
this.rta,"onPointerDown"));this.uua=P.get(13);this.uua.Zb(this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior"))}hide(P=null,V=0,Y=0){this.kWh&&P?this.vIk(P,V,Y):(3===this.state&&this.VJg(),this.visible=!1,this._state=5)}vIk(P,V,Y=0){this.show(P,V,15,4,void 0,Y)}sUg(P,V,Y,ta=!1,fa=!1,Ta=!1,ha=0){this.show(P,V,Y+20,ta?2:fa?1:0,Ta,ha)}aIk(P,V,Y,ta=!1,fa=0){this.show(P,V,Y+20,3,ta,fa)}show(P,V,Y,ta=3,fa=!1,Ta=0){!P||ta===this.state&&this.r7i(V,Y)||(this.TXh(ta,fa,Ta),this.h0(P,
ta,Ta),this._state=ta,4===Ta||0===Ta&&!this.Qla?this.element.style.left=V+"px":this.element.style.right=V+"px",this.element.style.top=Y+"px",this.visible=!0)}h0(P,V,Y){this.g8e=P;y.a.wx(this.mQ);w.a.fkl(this.mQ);this.mQ.id="fly_"+P.clientId;this.mQ.style.backgroundColor=P.color;4!==V?(this.mQ.style.height=this.bGa+"px",this.mQ.style.lineHeight=this.bGa+"px",w.a.Eka(this.mQ,"border-radius",this.bGa+"px")):4===Y||0===Y&&!this.Qla?this.mQ.style.left="0px":this.mQ.style.right="0px";2!==V&&(4===V?y.a.SA(this.mQ,
""):1===V?this.mQ.appendChild(this.WHh):(this.mQ.setAttribute("dir","auto"),Y=z.a.Chh(P.userName,!1),(!P.isAnonymous||u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&Y||0!==V?(P=P.userName,0===V&&(P=Y,w.a.Eka(this.mQ,"text-align","center")),y.a.SA(this.mQ,P)):(this.Lua||(this.Lua=this.wmi()),this.mQ.appendChild(this.Lua),w.a.Eka(this.mQ,"text-align","start"))))}onClick(P){if(0===this.state)return this.raiseEvent(f.a.xI,new f.a(1,
P)),!0;3===this.state&&c.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}O3(P){3===this.state&&this.raiseEvent(f.a.xI,new f.a(3,P));return!1}P3(P){3!==P.yg&&this.raiseEvent(f.a.xI,new f.a(2,P));return!1}rta(P){if(3!==P.yg)return!0;this.raiseEvent(f.a.xI,new f.a(4,P));return!1}wmi(){const P=document.createElement("img");P.src=m.a.mX("doughperson_white_glyph.svg");P.setAttribute("Unselectable","on");r.a.Uia(P,r.a.pi,r.a.KZ);return n.c(this.bGa,this.bGa,null,null,B.WFi,"",
!1,"",this.element.ownerDocument,P)}TXh(P,V=!1,Y=0){if(!this.zSb(this.state)||!this.zSb(P))switch(Sys.UI.DomElement.removeCssClass(this.element,this.nid),this.state){case 4:3===P?this.yva(B.kFd,B.qyf):this.zSb(P)&&this.yva(B.iFd,B.qyf);break;case 3:4===P?this.yva(B.mFd,B.pyf):this.zSb(P)&&(V&&this.VJg(),this.yva(B.iFd,B.pyf,V?B.VFi:""));break;case 0:case 1:case 2:4===P?this.yva(B.mFd,B.lFd):3===P&&(V&&this.NYh(),this.yva(B.kFd,B.lFd,V?B.ryf:"",3===Y?B.YFi:B.XFi));break;default:4===P?this.yva(B.mFd):
3===P?this.yva(B.kFd):this.zSb(P)&&this.yva(B.iFd)}}yva(...P){this.nid=P.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.nid)}NYh(){this.iXe=window.setTimeout(()=>{this.element&&(this.gGa=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.gGa),this.element.style.zIndex="2",this.gGa.style.zIndex="1")},300)}VJg(){window.clearTimeout(this.iXe);this.gGa&&(Sys.UI.DomElement.removeCssClass(this.gGa,B.lFd+" "+B.ryf),Sys.UI.DomElement.addCssClass(this.gGa,B.UFi),A.Task.delay(300).continueWith(()=>
{this.element&&this.element.parentNode===this.gGa.parentNode&&this.element.parentNode.removeChild(this.gGa)}),w.a.tLe(this.element,"z-index"))}zSb(P){return 0===P||1===P||2===P}r7i(P,V){const Y=w.a.oka(this.element.style.top);return w.a.oka(this.element.style.left)===P&&Y===V}zke(P){3===P&&w.a.Uva(this.element,"left")?(P=w.a.oka(this.element.style.left),w.a.tLe(this.element,"left"),this.element.style.right=-1*P+"px"):4===P&&w.a.Uva(this.element,"right")&&(P=w.a.oka(this.element.style.right),w.a.tLe(this.element,
"right"),this.element.style.left=-1*P+"px")}}B.jFd="prModernFlyout UIFont";B.mFd="flyoutIdle";B.kFd="flyoutExpanded";B.iFd="flyoutCollapsed";B.qyf="flyoutFromIdle";B.pyf="flyoutFromExpanded";B.lFd="flyoutFromCollapsed";B.ryf="flyoutStacked";B.VFi="flyoutFromStacked";B.UFi="flyoutFadeOut";B.WFi="cui-img-cont-float cui-img-20by20";B.XFi="flyoutLtrDir";B.YFi="flyoutRtlDir";Object(x.a)(B,"ModernPresenceTooltipFlyoutControl",b.a,[]);class H{constructor(P,V,Y=2,ta=4){this.offsetTop=P;this.offsetLeft=V;
this.G5g=Y;this.CMf=ta}}Object(x.a)(H,"FlyoutsPositioningInfo",null,[]);var v=a(26);class C{constructor(P=!1,V=!1){this.Ooe=!1;this.Ym=P;this.lkd=V;this.Ooe=u.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO:9192023_CalculateFlyoutDirectionsToHandleRTLScenarios")}GPi(P,V,Y,ta,fa,Ta,ha){const qa=ha.y,ra=ha.height;var I=this.xJi(Ta);const ba=I+V;fa=P*Y+(P-1)*fa;Y=null;1===P||this.$bi(I,fa,qa,ra)?P=new H(0,0,2):(P=this.VEi(ba,fa,qa,ra),P.offsetTop-=I);
this.lkd?Y=new H(0,0,void 0,this.Ym?4:3):(Ta=this.wJi(Ta,ha),I=Math.max(0,ha.x),ha=ha.width,V=Ta+V,this.Ooe?Y=this.eci(Ta,ta,I,ha):this.aci(Ta,ta,I,ha)?Y=new H(0,0,void 0,this.Ym?3:4):this.bci(V,ta,I)&&(Y=new H(0,0,void 0,this.Ym?4:3)),Y||(Y=this.UEi(Ta,V,I,ha)));return new H(P.offsetTop,Y.offsetLeft,P.G5g,Y.CMf)}xJi(P){return v.a.jAf(P)}wJi(P,V){return this.Ym?this.Ooe?v.a.Sgh(P)-v.a.Ptl(P):V.width-v.a.Sgh(P):v.a.iAf(P)}$bi(P,V,Y,ta){return P+V<=Y+ta}VEi(P,V,Y,ta){let fa=1,Ta=Math.max(Y,P-V);V>P-
Y&&(fa=2,Ta=V<ta?ta-V:Y);return new H(Ta,0,fa)}eci(P,V,Y,ta){const fa=this.cci(P,V,Y);P=this.dci(P,V,Y,ta);if(fa||P)return new H(0,0,void 0,this.Ym?fa?3:4:P?4:3)}aci(P,V,Y,ta){return P+V<=Y+ta}bci(P,V,Y){return V<=P-Y}dci(P,V,Y,ta){return P+V<=Y+ta}cci(P,V,Y){return Y<=P-V}UEi(P,V,Y,ta){ta-V>=P-Y?P=4:(V=P,P=3);return new H(0,V,void 0,P)}}Object(x.a)(C,"ModernPresenceTooltipPositioner",null,[]);class F{constructor(P,V,Y,ta,fa,Ta,ha){this.MW=P;this._parent=V;this.aVe=Y;this.$Fh=ta;this.hKh=fa;this.nfb=
Ta;this.Qla=ha;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(P,V){if(3!==P)if(5!==P&&this.MW&&this.MW.length){if(4===P){var Y=this.hKh;var ta=(this.nfb-Y)/2;this.element.style.height=this.nfb+"px";this.element.style.width=this.nfb+"px";P=w.a.oka(this.MW[0].element.style.top);V=w.a.oka(this.Qla?this.MW[0].element.style.right:this.MW[0].element.style.left)}else Y=this.aVe,ta=(this.nfb-Y)/2,this.element.style.height=this.nfb+
"px",this.element.style.width=this.CKi()+2*ta+"px",P=w.a.oka(this.MW[this.MW.length-1].element.style.top),V=this.ubi(this.MW[this.MW.length-1].element,Y,V);w.a.Eka(this.element,"border-radius",this.nfb+"px");this.element.style.top=P-ta-Y+"px";this.Qla?this.element.style.right=V-ta+"px":this.element.style.left=V-ta+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}ubi(P,V,Y){return this.Qla&&
!Y?w.a.oka(P.style.right):this.Qla||Y?this.Qla&&Y?-w.a.oka(P.style.left)-V:-w.a.oka(P.style.right)-V:w.a.oka(P.style.left)}CKi(){return this.MW&&this.MW.length?this.aVe+Math.min(this.MW.length-1,2)*this.$Fh:0}}Object(x.a)(F,"ModernPresenceTooltipTarget",null,[]);var D=a(51),N=a(53),U=a(94);class W extends b.a{constructor(P,V,Y){super(P);this.Geb=this.tla=this.FZe=this.KVa=!1;this.Fm=[];this.iia=(ta,fa)=>{ta=this.fRa;this.s8h()||2!==fa.type&&(4!==fa.type||3===ta)?4===fa.type&&3===ta?(this.tla&&(this.tla=
!1),this.hyd()):3!==fa.type||3!==ta||this.KVa||(1<this.Lwa?(this.tla=!0,A.Task.delay(250).continueWith(()=>{this.tYa(!0);this.tla=!1})):this.hyd()):(this.tla&&(this.tla=!1),3!==ta&&(this.svf(),3===fa.$g.yg&&this.hyd(2E3)));this.raiseEvent(f.a.xI,fa)};this.Vrb=ta=>{3===ta.yg?this.iia(this,new f.a(4,ta)):ta.eventName===l.a.KP?this.iia(this,new f.a(2,ta)):ta.eventName===l.a.AR&&this.iia(this,new f.a(3,ta));return!1};this.$hc={};this.$d=Y;this.Ym=Y.get(8,!1);this.XYe=Y.get(15,!1);this.bHh=Y.get(12,0);
this.fIa=Y.get(6,0);this.$kc=V;this.w8e=Y.get(16);this.lkd=Y.get(17,!1);this.jKh=Y.get(19,!1);this.qQh=Y.get(20,!1);this.Oic=0;this.pQh=new C(this.Ym,this.lkd);this.bEb=this.TBf();this.gpd=!1;this.hua=[];this.eGb=[];this.element.id=W.XFd();this.element.className=b.a.GAe("prControl",this.Ym);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Ym;this.Dme(V);this.Qda=this.createElement("div");this.Qda.className="prFlyoutContainer";this.element.appendChild(this.Qda);this.MW=[];this.oGa=
new F(this.JQ,this.element,this.fIa,4,6,32,this.Ym);this.nI=Y.get(9);this.nI.Zb(l.a.TH,this.oGa.element,this.Vrb);this.nI.Zb(l.a.KP,this.oGa.element,this.Vrb);this.nI.Zb(l.a.AR,this.oGa.element,this.Vrb)}get DKe(){return U.a.clone(this.Fm)}get JQ(){return this.MW}get defaultZIndex(){return this.bHh}get Lwa(){return this.JQ?this.JQ.length:0}get fRa(){return 0<this.Lwa?this.JQ[0].state:5}get zSd(){return 3===this.fRa&&!this.KVa}nSa(P){this.addHandler(f.a.xI,P)}d6a(P){this.removeHandler(f.a.xI,P)}dispose(){if(this.zSd)this.gpd=
!0;else{if(this.JQ)for(const P of this.JQ)P.d6a(this.iia),N.a.lE(P);this.MW=null;this.nI.jc(l.a.TH,this.oGa.element,this.Vrb);this.nI.jc(l.a.KP,this.oGa.element,this.Vrb);this.nI.jc(l.a.AR,this.oGa.element,this.Vrb);super.dispose()}}rDb(){this.tYa();this.visible=!0}Zoe(){this.visible=!0;this.svf();this.KVa=!0}Cec(){this.Zoe()}hide(){this.lKg();this.Ixa();this.oGa.update(this.fRa,this.Geb)}h0(P){const V=this.fRa,Y=this.KVa;P.clientId||(P.clientId=(W.kGb++).toString());if(P.clientId in this.$hc){var ta=
this.JJa(P.clientId);if(0<=ta){ta=this.Fm[ta];if(ta.color===P.color&&ta.userName===P.userName)return;this.Bqa(P.clientId)}}this.hide();ta=new B(this.createElement("div"),this.$d);ta.nSa(this.iia);this.Qda.insertBefore(ta.element,this.Qda.firstChild);this.$hc[P.clientId]=ta;Array.add(this.Fm,P);Array.add(this.JQ,ta);this.v4g(V,Y);this.visible=!0}Bqa(P){if(this.zSd)Array.add(this.eGb,P);else{var V=this.fRa,Y=this.KVa;this.hide();this.P4b(P);this.v4g(V,Y)}}V9d(P){const V=this.JJa(P);if(!(0>=V)){var Y=
this.Fm[V];P=this.$hc[P];Array.removeAt(this.Fm,V);Array.insert(this.Fm,0,Y);Array.removeAt(this.JQ,V);Array.insert(this.JQ,0,P);this.Qda.removeChild(P.element);this.Qda.appendChild(P.element);this.tYa()}}v4g(P,V){0>=this.Fm.length?this.hide():3===P&&V?this.Zoe():this.rDb()}Dne(P,V){V?this.BXh(P):this.LJg(P)}Xuf(P){if(this.zSd&&this.jKh)return!1;P=W.JJd(P);if(this.Qda!==P&&y.a.RAb(this.Qda,P))return!0;for(const V of this.JQ)if(y.a.RAb(V.element,P))return!0;return!1}position(P,V){this.element.style.top=
V+"px";this.element.style.left=P+"px"}tYa(P=!1){if(!P||this.tla){this.FZe&&this.SRg(!0);var V=Math.min(3,this.Lwa)-1;P=0;var Y=1,ta=0;this.Geb&&(P=this.bEb,Y=-1,ta=-this.fIa);for(let fa=this.Lwa-1;fa>V;fa--)this.JQ[fa].sUg(this.Fm[fa],-4*V*Y+ta,0,!0,!1,!0,P);for(;0<=V;V--)this.JQ[V].sUg(this.Fm[V],-4*V*Y+ta,0,0<V,Array.contains(this.hua,this.Fm[V].clientId),V!==this.Oic,P);this.Oic=0;this.oGa.update(0,this.Geb);this.zIndex=this.defaultZIndex;this.KVa=!1;this.lKg(0);this.gpd&&this.dispose()}}svf(){this.FZe&&
this.SRg(!1);this.zIndex=this.defaultZIndex+1;const {offsetX:P,offsetY:V,BMf:Y}=this.MAk();for(let ta=0;ta<this.Lwa;ta++)this.JQ[ta].aIk(this.Fm[ta],P,V+(this.fIa+2)*ta,ta!==this.Oic,Y)}Ixa(){let P=0,V=0;this.Geb&&(P=this.bEb,V=-6);for(let Y=0;Y<this.Lwa;Y++)this.JQ[Y].hide(this.Fm[Y],V,P);this.zIndex=this.defaultZIndex;this.visible=this.KVa=!1;this.gpd&&this.dispose()}hyd(P=0){P?(this.tla=!0,A.Task.delay(P).continueWith(()=>{this.XYe?this.u8i():this.tYa(!0);this.tla=!1})):this.XYe?this.hide():this.tYa()}u8i(){this.tla&&
this.hide()}s8h(){if(u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.lga&&D.c()){const P=appChrome.selectors.getShyState();return P.isActive&&0!==P.state}return!1}Dme(P){this.element.style.width=P+"px";this.element.style.height=this.fIa+"px"}P4b(P){this.LJg(P);P=this.JJa(P);if(!(0>P)){var V=this.Fm[P];Array.removeAt(this.Fm,P);delete this.$hc[V.clientId];V=this.JQ[P];this.Qda.removeChild(V.element);this.$d.get(18,!1)&&V.d6a(this.iia);Array.removeAt(this.JQ,P);V.dispose()}}lKg(P=5){if(this.eGb.length){this.visible&&
this.Ixa();for(let V=0;V<this.eGb.length;V++)this.P4b(this.eGb[V]);Array.clear(this.eGb);0>=this.Fm.length||5===P?this.hide():0===P&&this.rDb()}}JJa(P){for(let V=0;V<this.Fm.length;V++)if(this.Fm[V].clientId===P)return V;return-1}BXh(P){if(-1===this.JJa(P))c.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.hua,P)){if(this.Fm[0].clientId===P)return;Array.remove(this.hua,P)}Array.add(this.hua,P);this.V9d(P);1!==this.fRa&&this.tYa()}}LJg(P){-1===
this.JJa(P)?c.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.hua,P)&&(Array.remove(this.hua,P),this.Fm[0].clientId===P&&0<this.hua.length&&this.V9d(this.hua[this.hua.length-1]),this.Fm[0].clientId===P&&1===this.fRa&&this.tYa())}SRg(P){P?Sys.UI.DomElement.addCssClass(this.Qda,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.Qda,"prBackgroundSelection")}MAk(){let P,V;V=P=0;var Y=this.bEb;if(this.w8e){const ta=this.w8e(this);
if(!ta)return{offsetX:P,offsetY:V,BMf:Y};const fa=4===this.fRa;Y=this.pQh.GPi(this.Lwa,fa?6:this.fIa,this.fIa,150,2,this.element,ta);V=Y.offsetTop;this.Oic=this.ePi(Y.G5g,Y.offsetTop);Y=Y.CMf;Y!==this.bEb&&(this.zke(Y),this.element.dir=3===Y?"rtl":"ltr",this.bEb=Y);Y!==this.TBf()?(P=this.qQh?-2:fa?-6:-this.fIa,this.Geb=!0):this.Geb=!1}return{offsetX:P,offsetY:V,BMf:Y}}ePi(P,V){if(1===P)return this.Lwa-1;P=Math.abs(V);return 0<P?P/(this.fIa+2):0}zke(P){for(let V=0;V<this.Lwa;V++)this.JQ[V].zke(P)}TBf(){return this.Ym?
3:4}static XFd(){return String.format("{0}-{1}","presencetooltip",W.kGb++)}static JJd(P){return P.Sb.rawEvent.relatedTarget}}W.kGb=0;Object(x.a)(W,"ModernPresenceTooltipControl",b.a,[344,24]);var L=a(391),O=a(460),M=a(457);class K{constructor(P){this.$d=P;this.$d.eca(10,L.a.instance);this.$d.eca(9,M.a.instance);this.$d.eca(6,20);this.$d.eca(13,O.a.instance);this.$d.eca(17,!1)}Qdh(P,V){this.$d.eca(15,!1);return new W(P,V,this.$d)}umf(P){this.$d.eca(15,!1);return new W(P,20,this.$d)}}Object(x.a)(K,
"ModernPresenceTooltipFactory",null,[343])},530:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);a=a(30);class c extends a.a{constructor(b){super();this._element=null;this.element=b}get element(){return this._element}set element(b){this._element=b}get visible(){return"visible"===this.element.style.visibility}set visible(b){this.element.style.visibility=b?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(b){this.element.dir=b?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(b){this.element.style.zIndex=
String(b)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(b){return this.element.ownerDocument.createElement(b)}q_(){return!0}static GAe(b,f){return b+(f?"Rtl":"")}}Object(x.a)(c,"BasePresenceControl",a.a,[24,62])},531:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c extends Sys.EventArgs{constructor(b,f){super();this.type=b;this.$g=f}}c.xI="InteractivityChanged";Object(x.a)(c,"InteractivityChangedEventArgs",
Sys.EventArgs,[])},664:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(1233);class b{constructor(f){this.Bm=new c.a;this.rbd=f}w$(f){const e=f.id;let h=null;this.Bm.Ob(e)?h=this.Bm.ha(e):(this.rbd&&(h=this.rbd(f,()=>{this.QJg(e)})),h&&this.Bm.K(e,h));return h}k5(f){f=f.id;return this.Bm.Ob(f)?this.Bm.ha(f):null}QJg(f){this.Bm.remove(f)}}Object(x.a)(b,"ShapeComponentViewManager",null,[738])},894:function(x,G,a){a.d(G,"a",function(){return r});x=a(0);var c=a(17),b=a(180),f=a(4),e=a(47),
h=a(7),u=a(5),m=a(380),n=a(284),l=a(250);class r{static UCe(w){const y={};y.appSettings=r.mmf();y.singleSignOnSettings=r.SCe();y.appVersion="16";y.appUILocale=b.a.Ne(f.AFrameworkApplication.lcid).Mib;y.dataLocale=b.a.Ne(f.AFrameworkApplication.lcid).Mib;y.osfOmexBaseUrl=f.AFrameworkApplication.ga.La(n.a.cze);y.firstPartyManifestCDNUrl=f.AFrameworkApplication.ga.La(n.a.lze);y.sdxCdnUrl=f.AFrameworkApplication.ga.La(n.a.sdxCdnUrl);y.sdx1CdnUrl=f.AFrameworkApplication.ga.La("Sdx1CdnUrl");y.sdxDmsUrl=
f.AFrameworkApplication.ga.La(n.a.sdxDmsUrl);y.forceUseSdx1Cdn=f.AFrameworkApplication.ga.getBooleanAppSetting("ForceUseSdx1Cdn");y.sovereignFederationDMSToken=f.AFrameworkApplication.ga.La("SovereignFederationDMSToken");y.sovereignFederationDMSTokenSuffix=f.AFrameworkApplication.ga.La("SovereignFederationDMSTokenSuffix");y.sdxAssetsToPrefetchMapping=f.AFrameworkApplication.ga.La(n.a.sdxAssetsToPrefetchMapping);y.docUrl=w?w.documentUrl:"";y.pageBaseUrl=e.a.nN;y.lcid=f.AFrameworkApplication.lcid.toString();
y.allowExternalMarketplace=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.T4c);y.localizedScriptsUrl=(f.AFrameworkApplication.aua?f.AFrameworkApplication.ga.La("StaticContentHostNonOverriden"):e.a.nN)+f.AFrameworkApplication.ga.La(n.a.zbh);w=w?w.UDe:"";y.localizedImagesUrl=e.a.nN+w;y.localizedStylesUrl=e.a.nN+w;y.localizedResourcesUrl=e.a.ZWh(w);y.enableAddinCommands=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.zmc);y.enableMyApps=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.Njh);
y.enableMyOrg=f.AFrameworkApplication.ga.getBooleanAppSetting("InsertAgaveMyOrgEnabledForHost");y.enableUploadFileDevCatalog=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.zmc)&&!f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.iPe);y.enableDevCatalog=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.Jcd);y.devCatalogUrl=f.AFrameworkApplication.ga.La(n.a.ybh);y.enablePrivateCatalog=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.a5c);y.showSignOutFromPrivateCatalogMessage=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.showSignOutFromPrivateCatalogMessage);
y.enableBlackForestRedirect=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.Cze);y.enableSingleSignOnForAddin=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.mze)&&f.AFrameworkApplication.vfj;y.enableTaskpaneUpgradeToAppCommand=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.eOe);y.hideAppsExtensionUrl=f.AFrameworkApplication.hideAppsExtensionUrl;y.enableAnonymousUseLegacyCatalogService=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.bze);y.enableInsertDialogAccessibilityFix=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.CIe);
y.enableFirstPartySDXErrorMessages=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.BIe);y.disableAppsForOfficeThirdParty=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.oSc);y.wacSessionId=f.AFrameworkApplication.userSessionId;y.disableLogging=!f.AFrameworkApplication.ga.getBooleanAppSetting("AriaLoggingIsEnabled");y.loggableUserId=f.AFrameworkApplication.ga.La("LoggableUserId");y.sessionStartInfoJson=f.AFrameworkApplication.ga.La("SessionStartInfoJson");y.wopiHostOriginFromPostMessage=f.AFrameworkApplication.wopiHostOriginFromPostMessage;
y.wopiHostOriginFromWacPropBag=f.AFrameworkApplication.ga.La("PostMessageOrigin");y.wacIsEmbedded=f.AFrameworkApplication.ga.getBooleanAppSetting("IsEmbedded");y.accessibilityAllowFocusAddinTaskpane=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.accessibilityAllowFocusAddinTaskpane);y.disableMicrophonePermission=h.a.XX(1)&&f.AFrameworkApplication.ga.getBooleanAppSetting("TranscriberSafariEnabled")&&f.AFrameworkApplication.ga.getBooleanAppSetting("RehearsalSafariEnabled");y.isHostFrameTrustCheckEnabledForAddIns=
f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.GDe);y.isHostFrameTrusted=f.AFrameworkApplication.isHostFrameTrusted;y.hostAllowedSdxEmbedding=f.AFrameworkApplication.ga.getBooleanAppSetting("HostAllowedSdxEmbedding");y.hostAllowedOfficeStore=f.AFrameworkApplication.ga.getBooleanAppSetting("HostAllowedOfficeStore");y.hostInstallAddIns=f.AFrameworkApplication.ga.La("HostInstallAddIns");y.hostInstallAddInsIsEnabled=f.AFrameworkApplication.ga.getBooleanAppSetting("HostInstallAddInsIsEnabled");y.approvedAddIns=
f.AFrameworkApplication.ga.La("ApprovedAddIns");y.is3pAddInsDisabled=f.AFrameworkApplication.ga.getBooleanAppSetting("Is3pAddInsDisabled");y.isUpnCheckEnabled=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.isUpnCheckEnabled);y.wacUpn=f.AFrameworkApplication.ga.La("UserPrincipalName");y.isReactRibbonEnabled=!0;y.enableSetFocusOnTaskpaneOnUserAction=!0;y.enableMyOrg&&y.docUrl&&(w=y.docUrl.split("/"),y.spBaseUrl=2<w.length?w[0]+"//"+w[2]:null,y.spBaseUrl||c.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",
y.docUrl)));y.userNameHashCode=u.a.DV(f.AFrameworkApplication.userName);y.envCode=f.AFrameworkApplication.ga.Jc(n.a.Nbd,0).toString();return y}static mmf(){const w={};w.AddinRibbonIdAllowUnknown=f.AFrameworkApplication.ga.getBooleanAppSetting("AddinRibbonIdAllowUnknown");w.AddinRibbonNativeGroupControlIsEnabled=!0;w.AddinRibbonTabAutoFocusIsEnabled=!0;w.AddinRibbonTabPositionIsEnabled=!0;w.AgaveAddinUploadEnabled=f.AFrameworkApplication.ga.getBooleanAppSetting("AgaveAddinUploadEnabled");w.DevConsoleEnabled=
f.AFrameworkApplication.ga.getBooleanAppSetting("AddinDevConsoleLog");w.ManifestParserDevConsoleEnabled=!0;w.flightingTreatmentVariables=f.AFrameworkApplication.ga.uuc;w.DisabledChangeGates=f.AFrameworkApplication.ga.La("DisabledChangeGates");w.DmsSdxListPresentation=f.AFrameworkApplication.Leh;return w}static SCe(){try{const w={};(l.a("FixAddinTeamsBrowserSSO")||h.a.$$a)&&m.a.ykb&&(w.UiHostSupportsAuthTokenAddinList=r.n7c);w.UiHostSupportsAuthToken=m.a.ykb;return w}catch(w){c.ULS.sendTraceTag(512263001,
344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",w.message)}return null}}r.n7c="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");Object(x.a)(r,"AppForOfficeHelper",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.ext-lazy.js.map