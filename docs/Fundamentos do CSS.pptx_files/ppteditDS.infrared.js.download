'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[24],{1684:function(x,G,a){a.r(G);x=a(0);var c=a(118),b=a(248),f=a(49),e=a(269),h=a(284),u=a(251);class m{constructor(qa,ra){this.ia=qa;this.ia.sa(u.a.lAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.mAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.nAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.oAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.pAl,e.a.application,f.ActionManager.sI,
4);this.ia.sa(u.a.qAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.rAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.Yzl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.Zzl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.$zl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.aAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.bAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.cAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.dAl,e.a.application,f.ActionManager.sI,
4);this.ia.sa(u.a.Xzl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.eAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.fAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.gAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.hAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.iAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.jAl,e.a.application,f.ActionManager.sI,4);this.ia.sa(u.a.kAl,e.a.application,f.ActionManager.sI,4);this.EHl=JSON.parse(ra.La(h.a.KJe));for(const I of this.EHl)I.regex=
new RegExp(I.pattern)}trackAction(qa){for(const ra of this.EHl)ra.regex.test(qa)&&this.ia.Cb(ra.actionId,2)}}Object(x.a)(m,"IdeasActionTracker",null,[1401]);class n{constructor(){this.E1d=this.pQj=this.ROj=null;this.Q4m=this.i6n}addSlideSuggestionsListener(qa){this.ROj=qa}addTextToSmartArtSuggestionListener(qa){this.pQj=qa}kZh(qa){this.E1d=qa}notifySlideSuggestion(qa,ra){this.ROj&&(this.ROj(qa,ra),b.a.J(512496328,829,50,"data: count: {0}, correlation: {1}",ra?ra.suggestions.length:0,ra?ra.correlationId:
"0"))}notifyTextToSmartArtSuggestion(qa,ra){this.pQj&&(this.pQj(qa,ra),b.a.J(512496327,829,50,"data: count: {0}, correlation: {1}",ra?ra.suggestions.length:0,ra?ra.correlationId:"0"))}xrh(qa){this.E1d&&this.E1d(qa)}}Object(x.a)(n,"InfraredDesignerServiceProvider",null,[1400]);class l{constructor(){this.E1d=null}kZh(qa){this.E1d=qa}xrh(qa){this.E1d&&this.E1d(qa)}}Object(x.a)(l,"InfraredTelemetryListener",null,[1399]);var r=a(94),w=a(1233),y=a(5),z=a(40),A=a(20);class B{}Object(x.a)(B,"EntityGroup",
null,[]);class H extends B{}Object(x.a)(H,"Idea",B,[]);var v=a(1224);class C{}Object(x.a)(C,"ProviderResult",null,[]);var F=a(824),D=a(699),N=a(698),U=a(823),W=a(1223),L=a(4),O=a(180);class M{}M.Qwn="PowerPoint";M.M_n="WAC";Object(x.a)(M,"ApplicationPropertiesConstants",null,[]);class K{}Object(x.a)(K,"EnterpriseUserInfo",null,[]);class P{}Object(x.a)(P,"Message",null,[]);class V extends P{}V.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";Object(x.a)(V,"PowerPointTextTileChangedMessage",
P,[]);class Y{}Object(x.a)(Y,"RankerConfiguration",null,[]);class ta{constructor(qa){this.TMl=qa}pLm(qa,ra){return new Promise((I,ba)=>{this.TMl&&qa&&ra||ba("wopiIdentityManager or tokenParameter or clientWoipId is null");this.TMl.getAccessToken(qa,ra).then(Ga=>{Ga?I(Ga.accessToken):ba("auth token is null")},Ga=>{ba(Ga)})})}}Object(x.a)(ta,"AuthenticationProvider",null,[1446]);class fa{constructor(qa,ra,I,ba,Ga=""){this.resource=qa;this.scope=ra;this.silentLogin=I;this.options=ba;this.correlationId=
Ga}}Object(x.a)(fa,"InfraredTokenParameters",null,[789]);class Ta{constructor(qa,ra,I,ba,Ga,Oa,Ja,Qa,Pa){this.rJl=this.DBj=this.C7k=null;this.lJl=!1;this.QIj=null;this.AOj=!1;b.a.J(512262852,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.NHe=qa;this.gcn=Ja;this.qGj=Pa;this.Vcn=qa.getBooleanAppSetting(h.a.Ecd);this.Wad=qa.La(h.a.uNe);Ja=window.location.hostname;Pa=qa.La(h.a.cEe);Ja&&0<Ja.length&&Pa&&0<Pa.length&&0<=Pa.toLowerCase().indexOf(Ja.toLowerCase())&&(this.Wad="");this.lad=
ra;this.B3f=Oa;if(this.ffn=qa.getBooleanAppSetting(h.a.SJe))this.rJl=qa.La(h.a.TJe),this.DBj=new ta(Qa);this.lad.addSlideSuggestionsListener(Object(z.a)(this,this.psn,"onSlideSuggestion"));this.lad.addTextToSmartArtSuggestionListener(Object(z.a)(this,this.Dsn,"onTextToSmartArtSuggestion"));this.lad.kZh(Object(z.a)(this,this.iQl,"onIdeasSessionTelemetry"));I.kZh(Object(z.a)(this,this.iQl,"onIdeasSessionTelemetry"));this.B3f&&this.B3f.execute(ja=>{ja.Ael(Object(z.a)(this,this.LZj,"onEditorCritiques"))});
this.ia=ba;(this.Mya=Ga)&&this.Mya.execute(ja=>{ja.registerSimpleLocalWorkflow("InfraredSlideTextTileWorkflow",Object.assign(new N.a,{name:"InfraredSlideTextTileLambda",inputSchema:D.a.Yed,outputSchema:D.a.Yed,func:(va,Ha,gb)=>{this.qsn(va);gb(null)}}))});this.ONn()}get QDe(){return this.C7k}ONn(){var qa=JSON.parse(this.NHe.La(h.a.Xee));qa=Object.assign(new Y,{rankingOrder:qa});var ra=IdeasInfraredConnector,I=ra.setup,ba=b.a.J,Ga=Object(z.a)(this,this.z0m,"ideasPaneVisibilityStatusCallback"),Oa=this.NHe;
const Ja={};Ja.appName=2===L.AFrameworkApplication.Ea.Kb.Im?M.Qwn:"unknown";Ja.appVersion=L.AFrameworkApplication.buildVersion;Ja.appPlatform=M.M_n;Ja.lcid=L.AFrameworkApplication.lcid;var Qa=O.a.Ne(L.AFrameworkApplication.lcid);Qa=Qa?Qa.name:null;const Pa=Qa.split("-");Ja.market=Pa[Pa.length-1];Ja.uiLanguage=Qa;Ja.sessionId=L.AFrameworkApplication.userSessionId;Ja.tenantRoot=Oa.La(h.a.$Me);Ja.shredderServiceEndpoint=Oa.La(h.a.shredderServiceEndpoint);this.C7k=I.call(ra,qa,ba,Ga,Ja,this.gcn,Object(z.a)(this,
this.Bwl,"getShredderServiceAuthTokenPromise"))}z0m(qa){this.lJl=qa;(this.lad.Q4m=qa)?(this.ia.Cb(u.a.pEd,2),this.$Vl()):this.ia.Qa(u.a.Fbb,2,new W.a(!0,U.a.vjh))}psn(qa,ra){const I=[];I.push(Object.assign(new H,{providerId:v.a.G5l,groupTypeId:v.a.F5l,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:ra}));try{this.QDe.pushProviderResult(Object.assign(new C,{providerId:v.a.G5l,resultStatus:qa,entityGroups:I}))}catch(ba){b.a.J(512262851,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",
ba)}"Success"===qa&&(r.a.rb(ra.suggestions)||this.qGj.Ryh(0))}Dsn(qa,ra){const I=[];I.push(Object.assign(new H,{providerId:v.a.N5l,groupTypeId:v.a.M5l,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:ra}));try{this.QDe.pushProviderResult(Object.assign(new C,{providerId:v.a.N5l,resultStatus:qa,entityGroups:I}))}catch(ba){b.a.J(512262850,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",ba)}}iQl(qa){try{this.QDe.trackIdeasProviderAction(qa.cardId,
qa.actionType,qa.actionEngagement)}catch(ra){b.a.J(512262849,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",ra)}}qsn(qa){if(this.Vcn)if(qa)if(qa){try{const ra=A.a(qa.Content);this.ktm(this.QIj,ra)&&(this.QIj=ra,this.AOj=!0)}catch(ra){b.a.J(512262818,811,10,"Deserializing tile response failed");return}this.lJl&&this.$Vl()}else b.a.J(512262819,811,50,"ProcessSlideTextTileChange,TileNull");else b.a.J(512262848,811,50,"ProcessSlideTextTileChange,InputNull")}ktm(qa,
ra){if(!qa&&ra||qa&&!ra)return!0;if(!qa&&!ra)return!1;if(!qa.drawingElems&&ra.drawingElems||qa.drawingElems&&!ra.drawingElems)return!0;const I=new w.a;for(const ba of qa.drawingElems)if(qa=ba.text)for(const Ga of qa.paragraphs)Ga&&(y.a.rb(Ga.id)||y.a.rb(Ga.chars)||I.K(Ga.id,Ga.chars));for(const ba of ra.drawingElems)if(ra=ba.text)for(const Ga of ra.paragraphs)if(Ga&&!(y.a.rb(Ga.id)||y.a.rb(Ga.chars)||I.Ob(Ga.id)&&I.ha(Ga.id)===Ga.chars))return!0;return!1}$Vl(){if(this.AOj){try{this.QDe.postMessage(Object.assign(new V,
{messageType:V.PowerPointTextTileChangedMessageType,data:this.QIj}))}catch(qa){b.a.J(512262817,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",qa)}this.qGj.Ryh(1);this.AOj=!1}}LZj(qa,ra){try{qa=[],qa.push(Object.assign(new H,{groupTypeId:v.a.npl,providerId:v.a.spl,notificationConfidence:ra.IRb?ra.IRb.notificationConfidence:0,shouldRaiseNotification:ra.IRb?ra.IRb.shouldRaiseNotification:!1,confidence:ra.IRb?ra.IRb.confidence:0,data:ra.dtf})),this.QDe.pushProviderResult(Object.assign(new C,
{providerId:v.a.spl,resultStatus:ra.IRb?ra.IRb.resultStatus:F.a.invalid,entityGroups:qa}))}catch(I){b.a.J(512262816,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",I)}ra.IRb&&"Success"===ra.IRb.resultStatus&&ra.dtf&&!r.a.rb(ra.dtf.critiques)&&this.qGj.Ryh(2)}Bwl(){if(!this.DBj)return b.a.J(512262815,811,50,"authenticationProvider is null"),null;try{if(this.Wad&&0<this.Wad.length)return this.DBj.pLm(new fa(this.Wad,"user_impersonation",!0,{}),
this.rJl);b.a.J(512262814,811,50,"ShredderServiceResourceId is null or empty");return null}catch(qa){return b.a.J(512262813,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",qa),null}}FOm(){return new Promise(qa=>{const ra=this.NHe.La(h.a.shredderServiceEndpoint),I=this.Bwl();ra&&ra.length&&I?I.then(ba=>{ba&&ba.length?(ba=new K,ba.CountryCode="US",ba.IsEnabled=!1,ba.IsEnterpriseEnabled=!0,ba.IsGoLocal=!1,ba.ServiceEndpoint=ra,ba.TenantRoot="",qa(ba)):qa(null)},
()=>{qa(null)}):qa(null)})}}Object(x.a)(Ta,"PPTWebEditorInfraredRuntimeManager",null,[1398]);class ha{constructor(){this.$=null}get name(){return"PowerPointWebEditor.Infrared"}lc(qa){this.$=qa;this.$.register(n,"PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider").as("PowerPointWebEditor.IDesignerServiceProvider").ma().na(()=>new n);this.$.register(l,"PowerPointWebEditor.Infrared.InfraredTelemetryListener").as("PowerPointWebEditor.IInfraredTelemetryListener").ma().na(()=>new l);this.$.register(m,
"PowerPointWebEditor.Infrared.IdeasActionTracker").as("PowerPointWebEditor.Infrared.IIdeasActionTracker").ma().na(()=>new m(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Common.IAppSettingsManager")));b.a.J(512262812,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");this.$.register(Ta,"PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager").as("PowerPointWebEditor.Infrared.IInfraredRuntimeManager").ma().na(()=>new Ta(this.$.resolve("Common.IAppSettingsManager"),
this.$.resolve("PowerPointWebEditor.IDesignerServiceProvider"),this.$.resolve("PowerPointWebEditor.IInfraredTelemetryListener"),this.$.resolve("Common.IActionManager"),this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.$.Na("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.$.resolve("PowerPointWebEditor.Infrared.IIdeasActionTracker"),this.$.resolve("Common.App.WopiIdentity.WopiIdentityManager"),this.$.resolve("PowerPointWebEditor.Infrared.IIdeasContext")))}init(){const qa=
this.$.resolve("Common.IAppSettingsManager");qa.fg(()=>{qa.getBooleanAppSetting(h.a.fPa)&&(b.a.J(512262811,809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),this.$.resolve("PowerPointWebEditor.Infrared.IInfraredRuntimeManager"))})}dispose(){}static main(){c.a.instance.Fc(new ha)}}Object(x.a)(ha,"PPTWebEditorInfraredRuntimePackage",null,[3,4]);Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PowerPointWebEditor.Infrared");ha.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.infrared.js.map