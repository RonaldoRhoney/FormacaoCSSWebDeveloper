'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[20],{1125:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b,f,e,h){this._id=b;this.mUh=f;this.cye=e;this.Ecb=h}getId(){return this._id}getStoreId(){return this.mUh}getStoreType(){return this.cye}}Object(x.a)(c,"ExtensionIdentity",null,[314])},1126:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b,f,e){this.L1e=e}}Object(x.a)(c,"HostProperties",null,[])},1127:function(x,
G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.optionalProperties={};this.TDa={}}}Object(x.a)(c,"ExtensionLaunchProperties",null,[])},1128:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.taskpane="Taskpane";c.action="Action";c.SOg="SDXDialog";Object(x.a)(c,"ComponentTypeNames",null,[])},1221:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b[b.notSupported=0]="notSupported";b[b.A8m=1]="launchByLocalCacheInitializer";b[b.w8m=2]="launchByAnonymousApiInitializer";
b[b.y8m=3]="launchByInsertion";b[b.B8m=4]="launchByRefresh";b[b.z8m=5]="launchByLastUpdateInitializer";b[b.x8m=6]="launchByDynamicCall"})(c||(c={}));Object(x.b)("AddinCommandsLaunchOperationType",c)},1355:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.Id=null;this.Enabled=!1;this.DisplayName=this.Name=null;this.Order=0;this.Tooltip=null;this.IsEndpointProtectionEnabled=!1;this.ParentId=null;this.RequiredDowngradeJustification=!1;this.Color=this.AutoLabelingSensitiveTypeIds=
this.LabelActions=null;this.HasUserDefinedPermissions=!1;this.DefaultSublabelId=null;this.UDPVerifyUserPermissionConfigurable=this.UDPVerifyUserPermissionDefaultState=this.UDPRequestPermissionsConfigurable=this.UDPRequestPermissionsDefaultState=this.UDPAccessProgrammaticConfigurable=this.UDPAccessProgrammaticDefaultState=this.UDPDocumentExpirationConfigurable=this.UDPDocumentExpirationDefaultState=!1;this.HasExtractForUser=!0;this.ParentName="";this.AppliesDynamicWatermarking=!1;this.Id=this.DynamicWatermarkResolvedString=
this.DynamicWatermarkFormatString="";this.Enabled=!1;this.DisplayName=this.Name="";this.Order=0;this.Tooltip="";this.IsEndpointProtectionEnabled=!1;this.ParentId="";this.RequiredDowngradeJustification=!1;this.LabelActions=[];this.AutoLabelingSensitiveTypeIds=[];this.Color="";this.HasUserDefinedPermissions=!1;this.DefaultSublabelId="";this.UDPVerifyUserPermissionConfigurable=this.UDPVerifyUserPermissionDefaultState=this.UDPRequestPermissionsConfigurable=this.UDPRequestPermissionsDefaultState=this.UDPAccessProgrammaticConfigurable=
this.UDPAccessProgrammaticDefaultState=this.UDPDocumentExpirationConfigurable=this.UDPDocumentExpirationDefaultState=!1;this.HasExtractForUser=!0;this.ParentName="";this.AppliesDynamicWatermarking=!1;this.DynamicWatermarkResolvedString=this.DynamicWatermarkFormatString=""}}Object(x.a)(c,"SensitivityLabel",null,[])},1356:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(68);class b{static SXl(f){b.DMf.add(f)}static G1l(f){for(const e of b.DMf)e(f)}static $Xl(f){b.Lle.add(f);if(0<b.QTc.count){for(const e of b.QTc)f(e);
b.QTc=new c.a}}static K1l(f){if(0<b.Lle.count)for(const e of b.Lle)e(f);else b.QTc.add(f)}}b.QTc=new c.a;b.Lle=new c.a;b.DMf=new c.a;Object(x.a)(b,"AugLoopEventUtils",null,[])},1505:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);a=a(429);class c{}c.LabelText=a.a.labelText;c.Alt=a.a.alt;c.Image16by16Class=a.a.DAb;c.Image32by32Class=a.a.Jxa;c.Image48by48Class=a.a.jzc;c.Visible=a.a.visible;c.HasPopup="HasPopup";Object(x.a)(c,"ButtonCommandProperties",null,[])},1517:function(x,G,a){a.d(G,"a",
function(){return c});x=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static Ktl(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(x.a)(c,"WopiAuthContext",null,[500])},1532:function(x,G,a){a.d(G,"a",function(){return l});
x=a(0);var c=a(1117),b=a(663),f=a(4),e=a(10);class h{static Eje(r){delete h.instances[r]}}h.nhc=null;h.instances={};Object(x.a)(h,"ExtensionLifeCycleManagerStatic",null,[]);class u{constructor(r,w,y,z){this.Ecb=this.HS=null;this._id=r;this.FKh=z;this.ya=f.AFrameworkApplication.vb?f.AFrameworkApplication.vb:null}get appVersion(){return this.Ecb}Dyk(r){this.HS=r}stop(){const r=this.ya.Qa(e.a.Jjf,2,this.HS);h.Eje(this.FKh);return 32===r}Gbb(){this.ya.Qa(e.a.KMg,2,this.HS)}setTitle(r){this.HS[b.a.$pa].optionalProperties[c.a.JB]=
r;return 32===this.ya.Qa(e.a.hSg,2,this.HS)}}Object(x.a)(u,"ExtensionComponentInstance",null,[333]);a(1125);a(1127);var m=a(1128);a(1126);var n=a(495);class l{constructor(){this.ya=f.AFrameworkApplication.vb}Hsj(r,w,y,z,A){this.Isj(r,w,y,z,A)}Isj(r,w,y,z,A){const B={};B[b.a.Hwa]=r;B[b.a.ZLb]=w;B[b.a.Cma]=y;B[b.a.sjh]=z;B[b.a.$pa]=A;z=8;if(f.AFrameworkApplication.bUd(r.getId()))switch(w){case m.a.action:z=this.ya.Qa(e.a.Bql,2,B);break;case m.a.taskpane:z=this.ya.Qa(e.a.EUg,2,B);break;case m.a.SOg:z=
this.ya.Qa(e.a.hXf,2,B);break;default:z=16}32===z?(z=n.a.create().toString(),A.optionalProperties.InstanceToken&&(z=A.optionalProperties.InstanceToken),r=new u(r,w,y,z),h.instances[z]=r):r=new u(r,w,y,null);r.Dyk(B)}getInstance(r){return h.instances[r]}Eje(r){return h.Eje(r)}static get instance(){l.nhc||(l.nhc=new l);return l.nhc}}l.nhc=null;Object(x.a)(l,"ExtensionLifeCycleManager",null,[313])},1678:function(x,G,a){a.r(G);var c=a(0),b=a(68),f=a(17),e=a(435);class h{constructor(){this.bgm=new b.a}get Hch(){return this.bgm}XQm(ma){f.ULS.sendTraceTag(17306645,
220,50,"Context menu id: {0}",ma);const Sa=new b.a;for(const Zb of this.Hch)for(const Wc of Zb.Hvg)Wc.id===ma&&Sa.add(Wc);return Sa}yum(){var ma=this.XQm("ContextMenuText");if(ma&&0<ma.count){const Sa=Object.assign(new e.a,{ControlList:[]});for(const Zb of ma)ma=Zb.c_g(),0<ma.length&&Array.addRange(Sa.ControlList,ma);return Sa}return null}Rdl(ma){this.Hch.add(ma)}tFn(ma){for(const Sa of this.Hch)if(Sa.Yfl===ma.Yfl){this.Hch.remove(Sa);break}}static PEm(ma,Sa,Zb=null){ma=h.fNm(ma);0<ma.length&&(h.dwh(ma,
!1),Zb&&Zb(Sa,ma))}static fNm(ma){const Sa=[];if(ma&&ma.Hvg&&0<ma.Hvg.count)for(const Zb of ma.Hvg)if(Zb.controls&&0<Zb.controls.count)for(const Wc of Zb.controls)if(Wc.menuItems&&0<Wc.menuItems.count)for(const rd of Wc.menuItems)Array.add(Sa,rd.id);return Sa}static dwh(ma,Sa){if(ma.length){var Zb=[];for(const Wc of ma)Zb.push(appChrome.actions.updateControlEnabledDisabledState(Wc,Sa));appChrome.api.dispatch(Zb)}}}Object(c.a)(h,"ContextMenuExtensibilityCache",null,[490,491]);var u=a(4),m=a(508),n=
a(63),l=a(118),r=a(40);class w{constructor(ma,Sa,Zb){this._id=ma;this.mfm=Sa;this.pgm=Zb;this.oBl=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get kbh(){return this.mfm}get uym(){return this.pgm}execute(ma,Sa,Zb){Zb=Zb||{};Zb.commandMode=this.oBl;Sa.invokeAppCommand(this.kbh,this.uym,Zb,(Wc,rd)=>{ma.JQl(this.id,this.kbh,Wc,rd)})}}Object(c.a)(w,"AddinNativeActionBase",null,[285]);class y extends w{constructor(ma,Sa){super(1,ma,Sa);this.oBl=OfficeExt.CommandInvokeMode.ExclusiveForNew}}
Object(c.a)(y,"AddinTakeSnapshotAction",w,[]);class z{Xll(ma,Sa){let Zb=null;switch(ma){case 1:Zb=new y(Sa,this.wIi().getNativeActionName(ma));break;case 2:Zb=new w(2,Sa,this.wIi().getNativeActionName(ma));break;case 3:Zb=new w(3,Sa,this.wIi().getNativeActionName(ma))}return Zb}wIi(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(z,"AddinNativeActionManager",null,[261]);class A{invokeAppCommand(ma,Sa,Zb,Wc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(ma,Sa,
Zb,Wc)}static getInstance(){A.Wa||(A.Wa=new A);return A.Wa}}A.Wa=null;Object(c.a)(A,"OSFAddinCommandsRuntimeManager",null,[262]);var B=a(30);class H{constructor(){this.epl=this.displayName=this.ilf=this.yka=this.wta=null;this.isUpgraded=!1}tDl(ma,Sa){return this.wta.getStoreType().toLowerCase()===ma.toLowerCase()&&this.wta.getSolutionId().toLowerCase()===Sa.toLowerCase()}}Object(c.a)(H,"AddinCommandsResourceItem",null,[]);var v=a(6);class C{constructor(){this.YDh=null;this.KJh=0;this.iLh=!1;this.kb=
new B.a;this.Dim=new b.a}Npm(ma){this.kb.addHandler("AddinCommandsLoadingMessageChanged",ma)}get Haf(){return this.YDh}XMe(ma){ma!==this.YDh&&(this.YDh=ma,this.kb.raiseEvent("AddinCommandsLoadingMessageChanged"))}cLn(){this.KJh++;this.Haf||this.XMe(Object(v.a)("LoadingAddInsTitle"))}Ozk(){this.KJh--;this.Vlh()&&(this.iLh?this.Haf!==Object(v.a)("ErrorLoadingAddInsTitle")&&this.XMe(Object(v.a)("ErrorLoadingAddInsTitle")):this.XMe(null))}PLn(){this.iLh=!0;this.XMe(Object(v.a)("ErrorLoadingAddInsTitle"))}Ljl(){this.iLh=
!1;this.Vlh()?this.XMe(null):this.XMe(Object(v.a)("LoadingAddInsTitle"))}Vlh(){return 0>=this.KJh}get wEe(){return this.Dim}JEd(ma,Sa,Zb=0){for(const Wc of this.wEe)if(Wc.tDl(ma,Sa)&&(!Wc.yka||Wc.yka.iLm===Zb))return Wc;return null}Xdl(ma,Sa,Zb,Wc){const rd=new H;rd.wta=ma;rd.yka=Sa;rd.ilf=Zb;rd.displayName=Wc;this.wEe.add(rd)}Oom(ma,Sa,Zb,Wc){const rd=new H;rd.wta=ma;rd.yka=Sa;rd.ilf=null;rd.epl=Zb;rd.displayName=Wc;this.wEe.add(rd)}iFn(ma,Sa){let Zb=0;for(const Wc of this.wEe)Wc.wta.getStoreType()===
ma&&Wc.wta.getSolutionId()===Sa?this.wEe.removeAt(Zb):Zb++}static getInstance(){C.Wa||(C.Wa=new C);return C.Wa}}C.Wa=null;Object(c.a)(C,"AddinCommandsResourceManager",null,[]);var F=a(413),D=a(895),N=a(24),U=a(43);class W extends Sys.EventArgs{constructor(){super();this.yka=this.NX=null}}Object(c.a)(W,"InsertionParamEventArgs",Sys.EventArgs,[]);class L{constructor(ma,Sa,Zb,Wc,rd,ee){this.r3=ma;this.NX=Sa;this.aDb=Zb;this.displayName=rd;this.DEl=ee}}Object(c.a)(L,"PostLaunchAddinCommandsParameters",
null,[]);var O=a(75),M=a(126),K=a(1342),P=a(20),V=a(5);class Y{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(c.a)(Y,"AddinAbstract",null,[]);var ta=a(231);class fa{constructor(ma,Sa,Zb,Wc=null){this.iQb=rd=>{let ee=!1,De=null;try{if(0<rd.data.responseData.length){const Af=Object(ta.a)(Object,P.a(rd.data.responseData)),mg=Af?Af[this.appName]:null;mg&&(De=Object(ta.a)(Object,P.a(mg.toString())))}ee=!0}catch(Af){this.q$a(null)}ee&&this.Y2c&&this.Y2c(De)};this.q$a=rd=>
{this.X2c&&this.X2c(rd?rd.data:null)};this.Msb=rd=>{this.F3c&&this.F3c(rd?rd.data:null)};this.jle=u.AFrameworkApplication.ga.La("RoamingServiceHandlerWebServiceBase");this.appName=ma;this.Y2c=Sa;this.X2c=Zb;this.F3c=Wc}fvf(ma){this.EHm(ma,this.iQb,this.q$a)}EHm(ma,Sa,Zb){const Wc=new Sys.StringBuilder(this.jle);Wc.append("RoamingServiceHandler.ashx?action=");Wc.append("getAddinTeachingCalloutSettings");Wc.append("&");Wc.append(this.OFf(ma));Wc.append("&");Wc.append(u.AFrameworkApplication.ui);u.AFrameworkApplication.ye.rk(Wc.toString(),
1,null,null,!0,2,Sa,Zb,null)}DBe(ma){this.HHm(ma)}HHm(ma){var Sa=new Sys.StringBuilder(this.jle);Sa.append("RoamingServiceHandler.ashx?action=");Sa.append("saveAddinTeachingCalloutSettings");Sa.append("&");Sa.append(u.AFrameworkApplication.ui);Sa=Sa.toString();ma=P.c(ma);u.AFrameworkApplication.ye.rk(Sa,2,ma,null,!0,4,null,this.Msb,null)}OFf(ma){const Sa=new Sys.StringBuilder("requestedsettings=");for(let Zb=0;Zb<ma.count;Zb++)Sa.append(ma.ha(Zb)),Zb<ma.count-1&&Sa.append(";");return Sa.toString()}}
Object(c.a)(fa,"AddinTeachingUIRoamingRequestHandler",null,[]);class Ta extends Sys.EventArgs{constructor(ma){super();this.solutionId=ma.solutionId;this.assetId=ma.assetId;this.storeType=ma.storeType;this.storeId=ma.storeId;this.assetStoreId=ma.assetStoreId;this.targetType=ma.targetType;this.width=ma.width;this.height=ma.height;this.displayName=ma.displayName;this.version=ma.version}}Object(c.a)(Ta,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var ha=a(332),qa=a(93);class ra{constructor(ma){this.Vye=
this.NX=null;this.f0l=!1;this.z2c=this.j7g=this.Ddc=this.nq=this.$Dh=this.fMe=null;this.Cqn=()=>{const Sa=new O.ScriptSharpLegacyMap;this.Vye&&this.Vye.tabs&&!this.Vye.tabs[0].isOfficeTab&&Sa.K("SDX.FeatureFlags","NonOfficeTab");this.KFe(ra.Jsa(this.NX),"ClickOnLaunch",Sa);this.Nqh();this.Vye?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Vye,()=>{const Zb=new W;Zb.NX=this.NX;this.Js.raiseEvent(F.a.Asj,Zb)}):f.ULS.sendTraceTag(508625355,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};
this.Fon=()=>{this.KFe(ra.Jsa(this.NX),"ClickOnClose");this.Nqh()};this.vpn=()=>{this.KFe(ra.Jsa(this.NX),"ClickOnDismiss");this.Nqh()};this.sPl=Sa=>{if(Sa&&(Sa=Sa.detail)&&Sa.id&&this.J3m(Sa.id)){const Zb=(Sa.action||"").toLowerCase();if(Sa.success&&"opened"===Zb)this.KFe(ra.Jsa(this.NX),"CampaignLaunched"),f.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.Nqh(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",this.sPl,
!0);else{let Wc;try{Wc=JSON.stringify(Sa),f.ULS.sendTraceTag(508625353,220,15,"Campaign launch failure. Event:"+Wc)}catch(rd){Wc="id : "+Sa.id+" telemetryEventName: "+Sa.telemetryEventName,f.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+Wc+" Error: "+(rd?rd.toString():""))}}}};this.iQb=Sa=>{Sa?this.SOn(Sa)?(f.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.fMe="AddinHasShown"in Sa&&Sa.AddinHasShown?Sa.AddinHasShown.toString():null,this.Wkl()):(f.ULS.sendTraceTag(508625347,
220,50,"Not Show TeachingUI this time"),this.Ddc(this.M4c,null)):(f.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),this.fMe=null,this.Wkl())};this.q$a=Sa=>{f.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",Sa?Sa.Ze:-1);this.Ddc(this.M4c,null)};this.Msb=Sa=>{f.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",Sa?Sa.Ze:-1)};this.Js=ma}get appName(){return u.AFrameworkApplication.ga.La("WebAppShortName")}get Ofl(){this.$Dh||
(this.$Dh=new fa(this.appName,this.iQb,this.q$a,this.Msb));return this.$Dh}get M4c(){this.j7g||(this.j7g=new b.a);return this.j7g}set M4c(ma){this.j7g=ma}get Syd(){this.z2c||(this.z2c=new b.a);return this.z2c}set Syd(ma){this.z2c=ma}gom(ma,Sa){window.addEventListener?(this.NX=ma,this.Vye=Sa,window.addEventListener("LaunchAddinTaskpane",this.Cqn,!0),window.addEventListener("DismissCallout",this.vpn,!0),window.addEventListener("CloseCallout",this.Fon,!0),window.addEventListener("FGWebSurfaceEvent",
this.sPl,!0)):f.ULS.sendTraceTag(508625357,220,15,"AddEventListenerForTeachingCallout failed to get Window")}EVn(ma,Sa,Zb,Wc){this.nq=ma;this.M4c=Sa;this.Syd=Zb;this.Ddc=Wc;f.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",Sa?Sa.count.toString():"null",Zb?Zb.count.toString():"null");0<this.M4c.count||0<this.Syd.count?(ma=new b.a,ma.add(this.appName),this.Ofl.fvf(ma)):this.Ddc(new b.a,null)}J3m(ma){ma=V.a.mj(ma);
return-1!==ma.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==ma.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==ma.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==ma.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==ma.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==ma.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}qvh(ma){if(this.appName){const Sa={},Zb={};Zb.LastTeachingUIShowTime=(new Date).toUTCString();Zb.AddinHasShown=ma;Sa[this.appName]=P.c(Zb);this.Ofl.DBe(Sa);
f.ULS.sendTraceTag(508625351,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else f.ULS.sendTraceTag(508625350,220,10,"Fail to save roaming service since AppName is null")}Nqh(){if(!this.f0l){const ma=window.g_roamingAddinList;ma&&(this.qvh(ma),this.f0l=!0)}}Wkl(){const ma=this.dEm();0===ma.targetType?(ma.solutionId?this.yBn(ma):this.KFe(null,"NoSolutionId"),this.Y9l(ma),this.Ddc(this.M4c,null)):this.Ddc(this.M4c,ma);f.ULS.sendTraceTag(508625344,
220,50,"Show teaching callout for: {0}",ma.addinId)}yBn(ma){const Sa=new K.a;Sa.callbackFunc=Zb=>{if(Zb.errorCode){this.KFe(ma.solutionId,"FailToGetAppDetails");var Wc=window.g_roamingAddinList;Wc&&this.qvh(Wc)}else if(Zb.value)for(Wc of Zb.value)if(Zb=Wc[1],Zb===ma.solutionId){const rd={};rd.solutionId=Zb;rd.assetId=Wc[5];rd.storeType=Wc[12];rd.storeId=Wc[11];rd.assetStoreId=Wc[6];rd.targetType=Wc[3];rd.width=Wc[7];rd.height=Wc[8];rd.displayName=Wc[0];rd.version=Wc[4];f.ULS.sendTraceTag(508625315,
220,50,"Raise a teaching callout event for content addin: {0}.",ma.solutionId);Wc=new Ta(rd);this.Js.raiseEvent(F.a.GHk,Wc);break}};Sa.storeType=OSF.StoreTypeEnum.PrivateCatalog;Sa.fromInsertDialog=!1;Sa.refresh=!1;this.nq.queryEntitlementDetails(Sa)}SOn(ma){if("LastTeachingUIShowTime"in ma){if(ma=+new Date-+new Date(ma.LastTeachingUIShowTime.toString()),ma<u.AFrameworkApplication.ga.axa("AddinShowTeachingUIIntervalInMS",864E5))return f.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",
ma),!1}else f.ULS.sendTraceTag(508625313,220,50,"userSetting has no date key");return!0}dEm(){let ma=new M.a(new Y,0),Sa=new M.a(new Y,0),Zb=0,Wc=0,rd=0;var ee=new b.a;for(var De of this.M4c)ee.add(De);for(const Af of this.Syd)ee.add(Af);for(const Af of ee)if(!("excatalog"!==Af.storeType||ha.b(Af.installTimeInMS)||!Af.installTimeInMS||Af.installTimeInMS<=u.AFrameworkApplication.ga.axa("DateTimeInMSForNewAddin",16409952E5))){ee=ra.wtl(Af);if(this.fMe&&(De=this.fMe.split(","),0<De.length&&Array.contains(De,
ee))){rd++;f.ULS.sendTraceTag(508625312,220,50,"This addin has shown teaching UI before");continue}ee.startsWith("private_")?(ma=ra.fvl(Af,ma),Wc++):(Sa=ra.fvl(Af,Sa),Zb++)}f.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",Wc,Zb,rd);return 0<Sa.value?Sa.key:0<ma.value?ma.key:Object.assign(new Y,{addinId:null,targetType:-1,solutionId:null})}KFe(ma,Sa,Zb=null){ma={["AppTeachingUICalloutAction"]:Sa,["SDX.Id"]:ma,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};if(Zb)for(const Wc of Zb.keys)ma[Wc]=Zb.ha(Wc);U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:N.a.Gw(ma)}))}Y9l(ma){ma&&(window.g_roamingAddinList=this.fMe?this.fMe+","+ma.addinId:ma.addinId)}static Jsa(ma){return Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.storeType,ma.assetId,null,null,ma.storeId)}static fvl(ma,Sa){return Sa.value<ma.installTimeInMS?new M.a(Object.assign(new Y,
{addinId:ra.wtl(ma),targetType:ma.targetType,solutionId:ma.solutionId}),ma.installTimeInMS):Sa}static wtl(ma){return Telemetry.PrivacyRules.IsPrivateAddin(ma.storeType,ma.assetId,null,null,ma.storeId)?"private_"+ma.installTimeInMS:ma.solutionId}}Object(c.a)(ra,"PrivateCatalogTeachingCalloutHandler",null,[]);class I{constructor(ma){this.IMh=null;this.M7k=ma}get oVd(){return this.IMh}Cye(ma,Sa=null){this.M7k.Cye(ma,Sa);this.IMh=ma}Onk(ma){this.M7k.Onk(ma)}A2l(ma){this.IMh=ma}}Object(c.a)(I,"RibbonExtensibilityManagerWithChangeDetection",
null,[518]);var ba=a(33);const Ga=()=>{const ma=ba.a.MCe(window.location.href.toLowerCase(),"wdomexsrctype");return!!ma&&"4"===ma},Oa=()=>ba.a.MCe(window.location.href.toLowerCase(),"wdtpl"),Ja=()=>{const ma=ba.a.MCe(window.location.href.toLowerCase(),"wdomexsrctype");return!!ma&&"1"===ma},Qa=ma=>{let Sa=null;switch(ma){case 0:Sa="omex";break;case 1:Sa="spcatalog";break;case 2:Sa="spapp";break;case 3:Sa="filesystem";break;case 4:Sa="exchange";break;case 6:Sa="registry";break;case 7:Sa="inmemory";
break;case 8:Sa="uploadfiledevcatalog";break;case 9:Sa="hardcodedpreinstall";break;case 10:Sa="excatalog";break;case 16:Sa="wopicatalog"}return Sa},Pa=ma=>{let Sa=-1;switch(ma.toLowerCase()){case "omex":Sa=0;break;case "spcatalog":Sa=1;break;case "spapp":Sa=2;break;case "filesystem":Sa=3;break;case "exchange":Sa=4;break;case "registry":Sa=6;break;case "inmemory":Sa=7;break;case "uploadfiledevcatalog":Sa=8;break;case "hardcodedpreinstall":Sa=9;break;case "excatalog":Sa=10;break;case "wopicatalog":Sa=
16}return Sa};class ja{constructor(){this.title=this.id=this.tabs=null}}Object(c.a)(ja,"AddInDataTransferObject",null,[]);class va{constructor(ma,Sa,Zb){this.h7g=ma;this.ifm=Sa;this.jfm=Zb}get Cea(){return this.h7g}get wom(){return this.ifm}get xom(){return this.jfm}static xzf(ma){return(ma=ma.dsb)?Object.assign(new ja,{tabs:ma.Cea.toArray(),id:ma.wom,title:ma.xom}):null}}Object(c.a)(va,"OneLineRibbonExtensibility",null,[]);class Ha{Cye(ma,Sa=null){if(ma=va.xzf(ma)){appChrome.addInApi.dispatchActionsToInstallAddIn(ma,
Sa);for(const Zb of ma.tabs)if(Zb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(ma,()=>{});break}}}Onk(ma){(ma=va.xzf(ma))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(ma)}A2l(){}static TEm(ma,Sa,Zb=null){ma=Ha.rSm(ma);0<ma.length&&(Ha.dwh(ma,!1),Zb&&Zb(Sa,ma))}static rSm(ma){const Sa=[];if(ma&&(ma=ma.dsb,ma.Cea&&0<ma.Cea.count))for(const Zb of ma.Cea)if(Zb.groups&&0<Zb.groups.length)for(const Wc of Zb.groups)if(Wc.controls&&0<Wc.controls.length)for(const rd of Wc.controls)Array.add(Sa,
rd.id);return Sa}static dwh(ma){if(ma.length){var Sa=[];for(const Zb of ma)Sa.push(appChrome.actions.updateControlEnabledDisabledState(Zb,!0));appChrome.api.dispatch(Sa)}}}Object(c.a)(Ha,"OneLineRibbonExtensibilityManager",null,[518]);var gb=a(1458),Gb=a(1221),Mb=a(92);class hb{static Sul(ma){const Sa=new b.a;if(hb.Pkl)for(var Zb of hb.Pkl)Sa.add(Zb);Zb=null;switch(ma){case "Workbook":Zb=hb.k0n;break;case "Document":Zb=hb.qFm;break;case "Presentation":Zb=hb.AAn}if(Zb)for(const Wc of Zb)Sa.add(Wc);
return Sa}}hb.Pkl=["PrimaryCommandSurface","ContextMenu"];hb.k0n=null;hb.qFm=null;hb.AAn=null;Object(c.a)(hb,"ExtensionPointType",null,[]);class Da{constructor(ma){this.E$k=null;if(ha.b(ma))throw f.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.tfm=ma}get Hvg(){return this.E$k||(this.E$k=new b.a)}get Yfl(){return this.tfm}}Object(c.a)(Da,"ContextMenuExtensibility",null,[492]);class Bb{constructor(ma,
Sa=null,Zb=0){if(ha.b(ma))throw f.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.okm=ma;this.mmm=Sa;this.Uhm=Zb}get dsb(){return this.okm}get startedNode(){return this.mmm}get iLm(){return this.Uhm}}Object(c.a)(Bb,"RibbonExtensibility",null,[577]);class Za{constructor(ma){this.uhm=ma.entitlement}get entitlement(){return this.uhm}createActionContext(ma,Sa){ma=
{};ma.ownerAddinInfo=this.entitlement;ma.action=Sa;return ma}}Object(c.a)(Za,"AddInCommandsContextProvider",null,[]);class mb{constructor(ma,Sa,Zb){this.h4k=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=ma;this.eventBuilder=Sa;this.contextMenuBuilder=Zb}get addinInfo(){return this.h4k}yAm(ma){return new Za(ma)}createActionBuilder(ma,Sa){return OfficeExt.DefaultControlActionBinder.createActionBuilder(ma,Sa.entitlement,Sa.manifest)}startApplyAddin(ma){this.h4k=
ma;const Sa=this.yAm(ma);this.actionBuilder=this.createActionBuilder(Sa,ma)}endApplyAddin(){}YHi(ma,Sa,Zb=0){return this.ribbonBuilder.Cea&&0<this.ribbonBuilder.Cea.count?new Bb(this.YKm(ma,Sa),this.addinInfo.startedNode,Zb):null}ctl(){var ma=null;if(this.contextMenuBuilder.Wqh&&0<this.contextMenuBuilder.Wqh.count){ma||(ma=this.addinInfo.entitlement.solutionId);ma=new Da(ma);for(const Sa of this.contextMenuBuilder.Wqh)ma.Hvg.add(Sa);return ma}return null}YKm(ma,Sa){return this.ribbonBuilder.Cea&&
0<this.ribbonBuilder.Cea.count?new va(this.ribbonBuilder.Cea,ma,Sa):null}}Object(c.a)(mb,"AddinCommandsBuilder",null,[]);class vb{constructor(ma,Sa,Zb,Wc,rd,ee,De){this.hqe=new Mb.a;this.r3=ma;this.nq=Sa;this.MHa=Zb;this.dMe=Wc;this.Tki=rd;this.rVc=ee;this.Tye=De;this.sFa=u.AFrameworkApplication.Ea.Rba}Jlh(ma,Sa,Zb,Wc,rd,ee,De){const Af=(mg,dg,Zg,Gh)=>{rd(mg,dg,Zg,Gh);mg=Gb.a[this.r3]+dg.assetId;({value:dg}=this.hqe.Uh(mg)).returnValue&&(dg.stop(),this.hqe.remove(mg))};if(0!==this.r3&&ma){f.ULS.sendTraceTag(17326351,
220,50,"Addin count {0}.",ma.count);4===this.r3&&(f.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",Wc)),this.wxm(ma,Wc),ee());for(const mg of ma)if(ma=mg,f.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.MHa.aLa,Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.ownerAddinStoreType||ma.storeType,ma.assetId,null,null,ma.storeId))),this.D$l(ma))if(De&&ma.requireConsent)De(ma,dg=>{try{if(this.sFa){const Gh=Gb.a[this.r3]+
dg.solutionId,wh=this.sFa.wl("ComponentAttach",Gh);this.hqe.K(Gh,wh)}const Zg=this.rVc.JEd(dg.storeType,dg.solutionId);6!==this.r3&&(Zg&&(this.adh(Zg),Zg.wta.purge(!1)),this.nq.insertOsfControl(this.eFg(dg,Sa,Zb,Af)),Zg&&this.nq.ownerAddinControlRecreated(dg.solutionId,dg.storeType))}catch(Zg){f.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.MHa.aLa,Telemetry.PrivacyRules.GetPrivacyCompliantId(dg.solutionId,
dg.ownerAddinStoreType||dg.storeType,dg.assetId,null,null,dg.storeId),dg.version,dg.storeType,dg.storeId,Zg.message)),Af(!1,dg,null,null)}});else try{if(this.sFa){const Zg=Gb.a[this.r3]+ma.solutionId,Gh=this.sFa.wl("ComponentAttach",Zg);this.hqe.K(Zg,Gh)}const dg=this.rVc.JEd(ma.storeType,ma.solutionId);!u.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:8475191_OSFAddinLaunchRefactor")||3!==u.AFrameworkApplication.Ea.Kb.Im&&1!==u.AFrameworkApplication.Ea.Kb.Im&&2!==u.AFrameworkApplication.Ea.Kb.Im||
3!==this.r3||"excatalog"===ma.storeType||!dg||dg.isUpgraded?6!==this.r3&&(dg&&(this.adh(dg),dg.wta.purge(!1)),this.nq.insertOsfControl(this.eFg(ma,Sa,Zb,Af)),dg&&this.nq.ownerAddinControlRecreated(ma.solutionId,ma.storeType)):(this.dMe.A2l(dg.yka),Af(!0,ma,null,dg.displayName))}catch(dg){f.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.MHa.aLa,Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,
ma.ownerAddinStoreType||ma.storeType,ma.assetId,null,null,ma.storeId),ma.version,ma.storeType,ma.storeId,dg.message)),Af(!1,ma,null,null)}else Af(!1,ma,null,null)}}C8m(ma,Sa,Zb,Wc,rd,ee){const De=(Af,mg,dg,Zg)=>{ee(Af,mg,dg,Zg);Af=Gb.a[this.r3]+mg.solutionId;({value:mg}=this.hqe.Uh(Af)).returnValue&&(mg.stop(),this.hqe.remove(Af))};if(6===this.r3&&ma)if(f.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.MHa.aLa,Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,
ma.ownerAddinStoreType||ma.storeType,ma.assetId,null,null,ma.storeId))),this.D$l(ma))try{if(this.sFa){const mg=Gb.a[this.r3]+ma.solutionId,dg=this.sFa.wl("ComponentAttach",mg);this.hqe.K(mg,dg)}const Af=this.rVc.JEd(ma.storeType,ma.solutionId);Af||De(!1,ma,null,null);u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.Cnl?this.ntl(ma,Sa,Wc,rd,Zb,mg=>{De(mg,ma,Zb,Af.displayName)}):(this.ntl(ma,Sa,Wc,rd,Zb),De(!0,ma,Zb,Af.displayName))}catch(Af){f.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.MHa.aLa,Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.ownerAddinStoreType||ma.storeType,ma.assetId,null,null,ma.storeId),ma.version,ma.storeType,ma.storeId,Af.message)),De(!1,ma,null,null)}else De(!1,ma,null,null)}Pnn(ma,Sa,Zb,Wc,rd,ee){if(ee)if(ee._isAddinCommandsManifest(this.MHa.aLa))try{u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.Cnl?this.mtl(ma,Sa,Zb,rd,ee,De=>{Wc(De,ma,ee,ee.getDefaultDisplayName())}):(this.mtl(ma,Sa,Zb,rd,ee),Wc(!0,ma,ee,ee.getDefaultDisplayName()))}catch(De){f.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.MHa.aLa,Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.ownerAddinStoreType||ma.storeType,ma.assetId,null,null,ma.storeId),ma.version,ma.storeType,ma.storeId,De.message)),Wc(!1,ma,ee,ee.getDefaultDisplayName())}else f.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.MHa.aLa,Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.ownerAddinStoreType||ma.storeType,ma.assetId,null,null,ma.storeId),ma.version,ma.storeType,ma.storeId)),Wc(!1,ma,null,null);else f.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.MHa.aLa,Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.ownerAddinStoreType||ma.storeType,ma.assetId,null,null,ma.storeId),ma.version,
ma.storeType,ma.storeId)),Wc(!1,ma,null,null)}eFg(ma,Sa,Zb,Wc){const rd={},ee=document.createElement("div");ee.setAttribute("visible","false");rd.div=ee;rd.id=ma.solutionId;rd.solutionId=ma.solutionId;rd.version=ma.version;rd.storeType=ma.storeType;rd.storeId=ma.storeId;rd.assetId=ma.assetId;rd.assetStoreId=ma.assetStoreId;rd.isvirtualOsfControl=!0;rd.virtualOsfControlActivationCallback=(De,Af)=>{const mg=this.rVc.JEd(ma.storeType,ma.solutionId);mg&&(mg.isUpgraded&&(ma.isUpgraded=!0),this.adh(mg));
this.Pnn(ma,Sa,Zb,Wc,De,Af)};rd.reason=3===this.r3?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return rd}mtl(ma,Sa,Zb,Wc,rd,ee=null){const De={};De.solutionId=Wc.getSolutionId();De.version=Wc.getVersion();De.storeType=Wc.getStoreType();De.storeId=Wc.getStoreId();De.assetId=Wc.getAssetId();De.assetStoreId=Wc.getAssetStoreId();De.targetType=Wc.getOsfControlType();let Af=null,mg=null;if(u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))Af=(new OfficeExt.Parser.AddinCommandsManifestParser(this.MHa.aLa,this.MHa.formFactor)).parseExtensions(De,rd,this.Tye),mg=hb.Sul(this.MHa.aLa);else try{Af=(new OfficeExt.Parser.AddinCommandsManifestParser(this.MHa.aLa,this.MHa.formFactor)).parseExtensions(De,rd,this.Tye),mg=hb.Sul(this.MHa.aLa)}catch(Zg){throw f.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Zg.message),Zg;}if(mg&&0<mg.count){if(u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var dg=Sa(ma);Sa=Zb(ma);Zb=!!u.AFrameworkApplication.ga&&u.AFrameworkApplication.ga.getBooleanAppSetting("AddinCommandsMultipleCustomTabsEnabled");dg=new mb(dg,null,Sa);for(const Zg of mg)dg.commandSurface=Zg,Af.apply(dg,this.Tye,Zb)}else try{const Zg=Sa(ma),Gh=Zb(ma),wh=!!u.AFrameworkApplication.ga&&u.AFrameworkApplication.ga.getBooleanAppSetting("AddinCommandsMultipleCustomTabsEnabled");dg=new mb(Zg,null,Gh);for(const Ji of mg)dg.commandSurface=Ji,Af.apply(dg,this.Tye,wh)}catch(Zg){throw f.ULS.sendTraceTag(538752132,
220,10,"Exception encounter while building ribbon. Exception: "+Zg.message),Zg;}if(OSF.OUtil.checkFlight(14))try{const Zg=dg.YHi(ma.solutionId,rd.getDefaultDisplayName()),Gh=dg.ctl();Zg&&this.dMe.Cye(Zg,ee);Gh&&this.Tki.Rdl(Gh);this.rVc.Xdl(Wc,Zg,Gh,rd.getDefaultDisplayName());f.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",rd.getDefaultDisplayName())}catch(Zg){throw OfficeExt.DevConsole.log(Zg),f.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Zg.message),
Zg;}else try{const Zg=dg.YHi(ma.solutionId,rd.getDefaultDisplayName()),Gh=dg.ctl();Zg&&this.dMe.Cye(Zg);Gh&&this.Tki.Rdl(Gh);this.rVc.Xdl(Wc,Zg,Gh,rd.getDefaultDisplayName());f.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",rd.getDefaultDisplayName())}catch(Zg){throw f.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Zg.message),Zg;}}}ntl(ma,Sa,Zb,Wc,rd,ee=null){const De={};De.solutionId=ma.solutionId;De.version=ma.version;De.storeType=ma.storeType;De.storeId=
ma.storeId;De.assetId=ma.assetId;De.assetStoreId=ma.assetStoreId;De.targetType=ma.targetType;const Af=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.MHa.aLa,this.MHa.formFactor);try{const mg=Sa.getManifest(),dg=Af.parse(De,mg,rd,this.Tye,Sa.getSharedRuntimeId(),Sa),Zg=Zb(ma),Gh=Wc(ma),wh=new mb(Zg,null,Gh);wh.commandSurface="PrimaryCommandSurface";dg.apply(wh,this.Tye,!0);if(wh.ribbonBuilder.Cea&&0<wh.ribbonBuilder.Cea.count){const Ji=wh.YHi(ma.solutionId,Sa.getManifest().getDefaultDisplayName(),
1);u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.dMe.Cye(Ji,ee):Ji&&this.dMe.Cye(Ji,ee);this.rVc.Oom(Sa,Ji,rd,Sa.getManifest().getDefaultDisplayName());f.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Sa.getManifest().getDefaultDisplayName())}}catch(mg){f.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Sa.getManifest().getDefaultDisplayName(),mg.toString()),
OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(mg)}}adh(ma){ma.yka&&this.dMe.Onk(ma.yka);ma.ilf&&this.Tki.tFn(ma.ilf);this.rVc.iFn(ma.wta.getStoreType(),ma.wta.getSolutionId())}wxm(ma,Sa){Sa=Qa(Sa);for(const Zb of this.rVc.wEe){if(Zb.wta.getStoreType()!==Sa)continue;let Wc=!0;for(const rd of ma){const ee=rd;if(ee&&Zb.tDl(ee.storeType,ee.solutionId)){Wc=!1;break}}Wc&&(this.adh(Zb),Zb.wta.purge(!1))}}D$l(ma){return!!ma&&!!ma.solutionId&&!!ma.version&&!!ma.storeType&&!!ma.storeId}}Object(c.a)(vb,
"AddInCommandsIntegration",null,[]);var sb=a(1531),bc=a(12),yb=a(882),uc=a(855),vc=a(182),wc=a(883),ub=a(55),aa=a(22),Na=a(26),ia=a(19);class wa{static get jca(){return wa.IK||(wa.IK=ia.a.instance.yb("Common.Utils.IAriaNotifier"))}static $ll(ma,Sa,Zb,Wc){wa.cSa&&wa.cSa.lS&&wa.cSa.dismiss();wa.cSa=sb.a.Ymf(Sa,ma,ma,3);wa.cSa.content=Zb;ha.a(Wc)||(wa.cSa.title=Wc,wa.cSa.Vac=!0);ma=new Sys.UI.Bounds(0,0,aa.a.dDe(),aa.a.aLd());wa.cSa.p0=wa.KJi(ma,Sa,wa.cSa.$ba,1);wa.cSa.show();wa.jca&&wa.jca.H8(Zb.innerText,
!0)}static rmi(ma,Sa,Zb,Wc=null){ub.a.fS().then(rd=>{let ee=null;wa.v4e&&(rd.removeNotification(wa.v4e),wa.v4e=null);const De=rd.callout(Object.assign(new yb.a,{target:ma,title:Sa,content:Zb,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new wc.a,{onDismiss:()=>{rd.removeNotification(ee)},directionalHint:null!=Wc?Wc:null})})),Af=Object.assign(new vc.a,{expirationOptions:Object.assign(new uc.a,{displayTimeoutSeconds:7,onExpire:()=>{rd.removeNotification(wa.v4e)}})});
ee=wa.v4e=rd.addNotification(De,Af);return null},rd=>{f.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",rd);return null})}static zHk(ma){wa.cSa&&wa.cSa.lS&&wa.cSa.dismiss();const Sa=new n.a;Sa.QYc=!1;Sa.gf=0;Sa.ZF(bc.a.u8m,Object(v.a)("DialogError"),ha.a(ma)?wa.uul():ma,null)}static kPn(ma){wa.cSa&&wa.cSa.lS&&wa.cSa.dismiss();f.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",ma.errorCode));const Sa=ha.a(ma.description)?wa.uul():
ma.description,Zb=new n.a;let Wc=null;ma.yff?(Zb.gf=1,Zb.Fg(1,ma.buttonText),Zb.uvb(1)):Zb.gf=0;Wc=rd=>{1===rd?ma.yff():ma.crf&&ma.crf()};Zb.QYc=!1;0===ma.jaj?Zb.ZF(ma.errorCode,ma.title?ma.title:Object(v.a)("DialogError"),Sa,Wc):1===ma.jaj?Zb.m7(ma.title?ma.title:Object(v.a)("DialogWarning"),Sa,Wc):Zb.OYc(ma.title?ma.title:Object(v.a)("DialogInfo"),Sa,Wc)}static KJi(ma,Sa,Zb,Wc){let rd=0===Wc?0:4;const ee=ma.x+ma.width-Sa.x-Sa.width;Sa.x-ma.x+Sa.width/2<=Zb/2?rd=0===Wc?2:5:ee+Sa.width/2<=Zb/2&&(rd=
0===Wc?3:6);return rd}static rPn(ma,Sa,Zb,Wc=!1){(Sa=va.xzf(Sa))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Sa,rd=>{rd&&(Wc||wa.rmi(rd,Zb,ma,5))})}static sPn(ma,Sa,Zb=!1){wa.rPn(Sa.startedNode?Sa.startedNode.description:String.format(Object(v.a)("NewAddInLoadedContent"),ma),Sa,Sa.startedNode?Sa.startedNode.title:String.format(Object(v.a)("NewAddInLoadedTitle"),ma),Zb)}static qPn(ma,Sa,Zb,Wc){if(wa.o$l)ma=String.format(Object(v.a)("ErrorLoadingAddInsContentOuterString"),
String.format(Object(v.a)("ErrorLoadingAddInsContentInnerString"),Zb,Wc,Object(v.a)("InsertionDialogRefresh"))),wa.rmi(Sa,ma,Object(v.a)("ErrorLoadingAddInsTitle"),1);else{Sa=Na.a.Ni(Sa);var rd=Object(v.a)("ErrorLoadingAddInsContentOuterString").split("{0}"),ee=document.createElement("span");ee.innerText=rd[0];var De=document.createElement("span");De.innerText=String.format(Object(v.a)("ErrorLoadingAddInsContentInnerString"),Zb,Wc,Object(v.a)("InsertionDialogRefresh"));De.className="UIFontBold";Zb=
document.createElement("span");Zb.innerText=rd[1];Wc=document.createElement("div");Sys.UI.DomElement.addCssClass(Wc,"ModalCalloutControl");Wc.appendChild(ee);Wc.appendChild(De);Wc.appendChild(Zb);wa.$ll(ma,Sa,Wc,Object(v.a)("ErrorLoadingAddInsTitle"))}}static dQn(ma,Sa,Zb,Wc){wa.o$l?wa.rmi(Sa,Zb,Wc):(Sa=Na.a.Ni(Sa),wa.$ll(ma,Sa,wa.ovm(Wc),Zb))}static ovm(ma){const Sa=document.createElement("div");Sys.UI.DomElement.addCssClass(Sa,"ModalCalloutControl");Sa.innerText=ma;return Sa}static uul(){return Object(v.a)("InternalError")+
" "+Object(v.a)("InternalError_Directive")}static get o$l(){return u.AFrameworkApplication.Ea.Kb.JD&&u.AFrameworkApplication.Ea.Kb.U$a}}wa.cSa=null;wa.v4e=null;wa.IK=null;Object(c.a)(wa,"AddInCommandsNotificationFactory",null,[]);class pa{constructor(ma,Sa,Zb,Wc,rd,ee,De,Af=null){this.kb=new B.a;this.ZDh=ma;this.Cgm=Sa;this.G7=Zb;this.Lcl=Wc;this.Hxe=rd;this.kfm=ee;this.k7g=De;this.hkm=Af}Mpm(ma){this.kb.addHandler(F.a.k2h,ma)}bqm(ma){this.kb.addHandler(F.a.Asj,ma)}Pqm(ma){this.kb.addHandler(F.a.JHk,
ma)}Qpm(ma){this.kb.addHandler(F.a.Wbh,ma)}K8m(ma,Sa,Zb){const Wc=Zb[F.a.aud],rd=void 0===Zb[F.a.k9a]?0:Zb[F.a.k9a];if(Wc&&0!==rd)if(0>=Wc.count&&4!==rd)this.kUl(new L(rd,null,null,Sa,null,!0));else{var ee=Wc.count,De=new I(new Ha),Af=void 0===Zb[F.a.izb]?-1:Zb[F.a.izb],mg=new vb(rd,this.G7,this.ZDh,De,this.Cgm,this.Hxe,this.k7g),dg=bi=>this.Lcl.Yum(bi.solutionId,this.k7g,this.ZDh,ma),Zg=bi=>this.Lcl.xum(bi.solutionId),Gh=(bi,ni,eh)=>{ee--;eh=new L(rd,ni,De,Sa,eh,0>=ee);if(bi&&ni)this.kUl(eh);else{if(3===
rd||ni&&ni.isUpgraded)bi="",ni&&(bi=Telemetry.PrivacyRules.GetPrivacyCompliantId(ni.solutionId,ni.ownerAddinStoreType||ni.storeType,ni.assetId,null,null,ni.storeId)),ni={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:bi},U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:N.a.Gw(ni)}));this.jUl(eh)}ee||u.AFrameworkApplication.Ea.Zf()},wh=(bi,ni,eh,nj)=>{Gh(bi,ni,nj)},Ji=()=>{this.DXj();0>=Wc.count&&
4===rd&&this.Hxe.Ozk()};6===rd?(Af=Zb[F.a.bpl],Zb=Zb[F.a.cpl],mg.C8m(Wc.ha(0),Af,Zb,dg,Zg,(bi,ni,eh,nj)=>{Gh(bi,ni,nj)})):mg.Jlh(Wc,dg,Zg,Af,wh,Ji,this.hkm)}else U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:N.a.Gw({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),f.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",
this.ZDh.aLa)),this.jUl(new L(rd,null,null,Sa,null,!0))}jUl(ma){this.DXj(ma);this.b5l(!1,ma)}kUl(ma){const Sa=ma.NX;let Zb=null;null!==Sa&&(Zb=Sa.storeType,Zb=Zb.toLowerCase());if(ma&&"omex"===Zb&&(3===ma.r3||Sa.isUpgraded)){var Wc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa.solutionId,Sa.ownerAddinStoreType||Sa.storeType,Sa.assetId,null,null,Sa.storeId)};U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:N.a.Gw(Wc)}))}this.DXj(ma);Wc=Ja()&&"omex"===Zb&&!!ma.aDb&&!!Sa.solutionId&&2===ma.r3&&Sa.solutionId.toLowerCase()===Oa().toLowerCase();var rd="excatalog"===Zb&&3===ma.r3;if("omex"===Zb&&ma.aDb&&(3===ma.r3&&"hardcodedpreinstall"!==Zb||Sa.isUpgraded)||Wc||rd)Wc=new W,Wc.NX=Sa,Wc.yka=ma.aDb.oVd,this.kb.raiseEvent(F.a.Wbh,Wc);Wc=Ga();rd=Oa();Wc&&Sa&&"excatalog"===Sa.storeType&&ma.aDb&&5===ma.r3&&rd&&(Sa.storeId&&Sa.storeId.toLowerCase()===rd.toLowerCase()||Sa.assetId&&Sa.assetId.toLowerCase()===
rd.toLowerCase())&&(Wc=new W,Wc.NX=Sa,Wc.yka=ma.aDb.oVd,this.kb.raiseEvent(F.a.Wbh,Wc),f.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));Sa&&(gb.a.instance.Svh(Pa(Zb),!0),"uploadfiledevcatalog"===Zb&&(Wc=this.kfm.createAddinDataProvider(Zb,this.G7))&&Wc.localCacheAddinCommands(this.G7.$cc,Sa.solutionId,Sa.version,Sa.storeId),D.a.s0c(F.a.Gaf,"true",Pa(Zb)));this.b5l(!0,ma)}b5l(ma,Sa){ma?Sa.aDb&&5===Sa.r3&&Sa.aDb.oVd&&void 0!==Sa.NX.showCallout&&null!==Sa.NX.showCallout&&
Sa.NX.showCallout?((new ra(this.kb)).gom(Sa.NX,va.xzf(Sa.aDb.oVd)),ma=new W,ma.yka=Sa.aDb.oVd,ma.NX=Sa.NX,this.kb.raiseEvent(F.a.JHk,ma)):3!==Sa.r3?Sa.DEl&&this.Hxe.Ozk():Sa.aDb&&Sa.aDb.oVd&&"hardcodedpreinstall"!==Sa.NX.storeType&&wa.sPn(Sa.displayName,Sa.aDb.oVd,Sa.NX.isAutoLaunched):3===Sa.r3?Sa.NX&&"uploadfiledevcatalog"===Sa.NX.storeType.toLowerCase()?(Sa=this.k7g.KOm(Sa.NX.solutionId),wa.zHk(Sa?Sa:Object(v.a)("InternalError")+" "+Object(v.a)("InternalError_Directive"))):this.Hxe.PLn():Sa.DEl&&
this.Hxe.Ozk()}DXj(ma=null){var Sa=ma?ma.NX:null;const Zb=new W;if(Zb.NX=Sa){var Wc=this.Hxe.JEd(Sa.storeType,Sa.solutionId,6===ma.r3?1:0);if(Wc&&Wc.yka){Zb.yka=Wc.yka;var rd=Oa();rd=Ja()&&!!Sa.solutionId&&!!rd&&Sa.solutionId.toLowerCase()===rd.toLowerCase()&&2===ma.r3;if(3===ma.r3&&"hardcodedpreinstall"!==Sa.storeType||rd)ma="",Wc.yka.dsb&&Wc.yka.dsb.Cea&&(Wc=Wc.yka.dsb.Cea.ha(0))&&(ma=Wc.id),Sa={["SDX_CommandPlacement"]:ma,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa.solutionId,
Sa.ownerAddinStoreType||Sa.storeType,Sa.assetId,null,null,Sa.storeId)},U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:N.a.Gw(Sa)}))}}this.kb.raiseEvent(F.a.k2h,Zb)}}Object(c.a)(pa,"LaunchAddinCommandsHandler",null,[487]);class Ea{constructor(ma){this.ykm=ma}get $cc(){return this.ykm}insertOsfControl(ma){return this.$cc.insertOsfControl(ma)}getManifestInvaildErrorString(){return this.$cc.getManifestInvaildErrorString()}isAddinCommandsAsync(ma,
Sa){this.$cc.isAddinCommandsAsync(ma,Sa)}isAddinCommandsExAsync(ma,Sa){this.$cc.isAddinCommandsExAsync(ma,Sa)}ownerAddinControlRecreated(ma,Sa){this.$cc.ownerAddinControlRecreated(ma,Sa)}queryEntitlementDetails(ma){this.$cc.queryEntitlementDetails(ma)}}Object(c.a)(Ea,"ContextActivationMgrWrapper",null,[488]);class La{}La.Sve="Alt";La.Tve="Command";La.id="Id";La.igd="Image16by16";La.Vve="LabelText";La.button="Button";La.pgh="FlyoutAnchor";Object(c.a)(La,"AddinDataNodeConstants",null,[]);var Aa=a(387),
nb=a(524),Wa=a(481),ea=a(51);class Kb{constructor(ma,Sa){this.x9g=this.r5k=null;if(ha.b(ma)||ha.b(Sa))throw f.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.AGh=Sa;this._id=ma;this.awa[La.id]=this._id}get id(){return this._id||""}get awa(){return this.r5k||(this.r5k={})}get controlType(){return this.AGh||""}get menuItems(){return this.x9g||(this.x9g=new b.a)}c_g(){let ma=
null;this.AGh===La.pgh?ma=Object.assign(new nb.a,{Menu:this.jgn()}):this.AGh===La.button&&(ma=Object.assign(new Aa.a,{}));ma&&(this.awa[La.id]&&(ma.ExternalId=this.awa[La.id]),this.awa[La.Tve]&&(ma.Command=this.awa[La.Tve].toString()),this.awa[La.Vve]&&(ma.LabelText=this.awa[La.Vve]),this.awa[La.Sve]&&(ma.Alt=this.awa[La.Sve]),this.awa[La.igd]&&(ea.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.awa[La.igd]),ma.ExternalImageId=this._id));return ma}jgn(){const ma=
Object.assign(new Wa.a,{UpdateDynamically:!0,MenuSectionList:[]});if(this.x9g){const Sa=Object.assign(new e.a,{ControlList:[]});for(const Zb of this.x9g)Array.add(Sa.ControlList,Zb.c_g());Array.add(ma.MenuSectionList,Sa)}return ma}}Object(c.a)(Kb,"ControlDefinition",null,[486]);class kc{constructor(ma){this.Oyb=null;if(ha.b(ma))throw f.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=
ma;this.atg[La.id]=this._id}get atg(){return this.Oyb||(this.Oyb={})}get id(){return this._id||""}c_g(){const ma=Object.assign(new Aa.a,{});this.Oyb[La.id]&&(ma.ExternalId=this.Oyb[La.id]);this.Oyb[La.Tve]&&(ma.Command=this.Oyb[La.Tve].toString());this.Oyb[La.Vve]&&(ma.LabelText=this.Oyb[La.Vve]);this.Oyb[La.Sve]&&(ma.Alt=this.Oyb[La.Sve]);this.Oyb[La.igd]&&(ea.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.Oyb[La.igd]),ma.ExternalImageId=this._id);return ma}}
Object(c.a)(kc,"MenuItemDefinition",null,[559]);class ac{constructor(ma){this.N7g=null;if(ha.b(ma))throw f.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=ma}get id(){return this._id}get controls(){return this.N7g||(this.N7g=new b.a)}c_g(){const ma=[];if(this.N7g)for(const Sa of this.N7g){const Zb=Sa.c_g();Zb&&ma.push(Zb)}return ma}}Object(c.a)(ac,"OfficeMenuDefinition",null,
[484]);var eb=a(10);class Hb{constructor(ma,Sa,Zb){this.ZRa=this.xwe=null;this.tOh=ma;this.pwe=Sa;this.dwe=Zb;this.Tjm=new b.a}get krh(){return this.tOh}get dkf(){return this.pwe}get gXh(){return this.dwe}addButton(ma){f.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",ma.actionType);this.ZRa=new Kb(this.l5c(ma.id),La.button);this.ZRa.awa[La.Vve]=ma.label;this.ZRa.awa[La.Sve]=ma.label;this.ZRa.awa[La.igd]=ma.icon["16"];this.bef(this.ZRa.awa[La.id],ma.action);this.htd(this.ZRa.awa);
this.xwe.controls.add(this.ZRa);this.ZRa=null}startBuildMenu(ma){if(ha.b(this.xwe))this.xwe=new ac(ma.id);else{const Sa=this.l5c(ma.id);this.ZRa=new Kb(Sa,La.pgh);this.Hze(this.ZRa.awa,ma);this.ZRa.awa[La.igd]=ma.icon["16"];this.ZRa.awa[La.Tve]=eb.a.ZW}}addMenuItem(ma){f.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",ma.actionType);const Sa=new kc(this.l5c(ma.id));this.Hze(Sa.atg,ma);ma.icon&&(Sa.atg[La.igd]=ma.icon["16"]);this.bef(Sa.atg[La.id],ma.action);this.htd(Sa.atg);
this.ZRa.menuItems.add(Sa)}endBuildMenu(){ha.b(this.ZRa)?(this.Wqh.add(this.xwe),this.xwe=null):(this.xwe.controls.add(this.ZRa),this.ZRa=null)}get Wqh(){return this.Tjm}bef(ma,Sa){this.gXh.bindAction(ma,Sa)}htd(ma){this.dkf.htd(ma)}l5c(ma){return this.krh.qPb(ma)}Hze(ma,Sa){ma[La.Vve]=Sa.label;ma[La.Sve]=Sa.label}}Object(c.a)(Hb,"ContextMenuExtensibilityCreator",null,[517,513]);class ua{constructor(ma){this.z2e=ma}get wug(){return this.z2e}qPb(ma){return this.wug+ma}}Object(c.a)(ua,"DefaultContextMenuNamingProvider",
null,[516]);class Va{constructor(ma,Sa,Zb,Wc){this.z2e=ma;u.AFrameworkApplication.ga.getBooleanAppSetting("AddInCommandsMissingTabIsEnabled")&&Zb.uQm();this.bcl=Sa;this.Tlm=Wc}get wug(){return this.z2e}get solutionId(){return this.bcl}get cGk(){return this.Tlm}qPb(ma){ma=this.wug+this.solutionId+ma;return this.cGk?(ma in Va.ibh||(Va.ibh[ma]="AddinControl"+Va.$qm++),Va.ibh[ma]):ma}knl(ma){if(this.cGk){const Zb=Va.ibh;for(const Wc in Zb){var Sa=Wc;if(ma===Zb[Wc])return Sa.substr(this.wug.length+this.solutionId.length)}}return ma}$Tm(ma){ma=
this.wug+this.solutionId+ma;return this.cGk?(ma in Va.r2h||(Va.r2h[ma]="AddinTab"+Va.hrm++),Va.r2h[ma]):ma}}Va.ibh={};Va.r2h={};Va.hrm=0;Va.$qm=0;Object(c.a)(Va,"DefaultRibbonNamingProvider",null,[485]);class Yb{bindAction(ma,Sa){OfficeExt.DefaultControlActionBinder.bindAction(ma,Sa)}}Object(c.a)(Yb,"DefaultUIControlActionBinder",null,[515]);class Cb{constructor(ma){this.ogm=ma}get command(){return this.ogm}htd(ma){ma[La.Tve]=this.command}}Object(c.a)(Cb,"DefaultUIControlCommandBinder",null,[514]);
var ca=a(653);class Ra{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(c.a)(Ra,"AddInControl",null,[]);class bb{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(c.a)(bb,"AddInGroup",null,[]);class wb{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(c.a)(wb,"AddInMenuItem",null,[]);class Fa{constructor(){this.groups=
this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(c.a)(Fa,"AddInTab",null,[]);class rb{constructor(ma,Sa,Zb,Wc,rd,ee){this.h7g=new b.a;this.xVe=this.ygc=this.ywe=null;this.tOh=ma;this.dwe=Sa;this.pwe=Zb;this.bcl=Wc;this.k7g=rd;this.D6k=ee}get krh(){return this.tOh}get Cea(){return this.h7g}get gXh(){return this.dwe}get dkf(){return this.pwe}startBuildTab(ma){const Sa=ma.isOfficeTab?ma.id:this.krh.$Tm(ma.id),
Zb=ma.isOfficeTab?null:ma.label;this.ywe=Object.assign(new Fa,{id:Sa,title:Zb,isOfficeTab:ma.isOfficeTab,visible:ma.visible,groups:[],tabType:ma.tabType,insertBefore:ma.insertBefore,insertAfter:ma.insertAfter,autoFocus:ma.autoFocus})}startBuildGroup(ma){const Sa=this.l5c(ma.id);this.ygc=Object.assign(new bb,{id:Sa,mlrId:ma.mlrId,title:ma.label,controls:[],groupType:0})}addNativeGroup(ma){this.ygc=Object.assign(new bb,{id:ma.id,mlrId:ma.mlrId,title:ma.label,controls:[],groupType:1});this.ywe.groups.push(this.ygc)}addButton(ma){const Sa=
this.l5c(ma.id);Sa&&(this.bef(Sa,ma.action),f.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",ma.actionType),ma=Object.assign(new Ra,{id:Sa,title:ma.label,iconLocation:this.LOi(ma),enabled:ma.enabled,controlType:0,attributes:this.Hze()}),this.D6k.CXh(new ca.a(Sa,this.dkf.command.toString())),this.ygc.controls.push(ma))}addNativeControl(ma){ma.id&&(f.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",ma.actionType),ma=Object.assign(new Ra,
{id:ma.id,title:"",iconLocation:"",enabled:ma.enabled,controlType:2,attributes:this.Hze()}),this.ygc.controls.push(ma))}startBuildMenu(ma){const Sa=this.l5c(ma.id);Sa&&(this.xVe=Object.assign(new Ra,{id:Sa,title:ma.label,iconLocation:this.LOi(ma),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(ma){const Sa=this.l5c(ma.id);Sa&&(this.bef(Sa,ma.action),f.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",ma.actionType),ma=Object.assign(new wb,{id:Sa,title:ma.label,
iconLocation:this.LOi(ma),enabled:ma.enabled,attributes:this.Hze()}),this.D6k.CXh(new ca.a(Sa,this.dkf.command.toString())),this.xVe.menuItems.push(ma))}endBuildMenu(){ha.b(this.xVe.id)||this.ygc.controls.push(this.xVe);this.xVe=null}endBuildGroup(){ha.b(this.ygc.id)||this.ywe.groups.push(this.ygc);this.ygc=null}endBuildTab(){ha.b(this.ywe.id)||this.h7g.add(this.ywe);this.ywe=null}Hze(){const ma={};this.htd(ma);return ma}LOi(ma){return ma.icon["80"]?ma.icon["80"]:ma.icon["32"]}htd(ma){this.dkf.htd(ma)}l5c(ma){return this.krh.qPb(ma)}bef(ma,
Sa){this.gXh.bindAction(ma,Sa)}}Object(c.a)(rb,"OneLineRibbonExtensibilityCreator",null,[512,513]);class $b{constructor(ma,Sa){this.z2e=ma;this.dwe=new Yb;this.pwe=new Cb(Sa)}xum(ma){ma=new ua(ma);return new Hb(ma,this.pwe,this.dwe)}Yum(ma,Sa,Zb,Wc){Zb=new Va(this.z2e,ma,Zb,!0);return new rb(Zb,this.dwe,this.pwe,ma,Sa,Wc)}}Object(c.a)($b,"UIExtensibilityFactory",null,[483]);class ec{createAddinDataProvider(ma,Sa){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(ma,Sa.$cc)}static get instance(){ec.Wa||
(ec.Wa=new ec);return ec.Wa}}ec.Wa=null;Object(c.a)(ec,"OSFAddinDataProviderFactory",null,[482]);class pc{constructor(){this.Uye=null}setErrorMessageForAddin(ma,Sa){this.Uye||(this.Uye={});this.Uye[ma]=Sa}KOm(ma){return this.Uye&&ma in this.Uye?this.Uye[ma]:null}}Object(c.a)(pc,"AddinCommandsErrorManager",null,[]);class dd{constructor(){this.jaj=0;this.yff=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.ozl=!1;this.B0m=this.crf=null}}Object(c.a)(dd,"AddInCommandsNotificationParameters",
null,[]);class Ad{constructor(){this.z4k=this.JDh=null;this.NAl=(ma,Sa)=>{let Zb=null;Zb=()=>{ma.getIsUpgrading()?window.setTimeout(Zb,1E3):ma.getUpgradingFailed()?Ha.dwh(Sa,!0):u.AFrameworkApplication.Ea.Zf()};window.setTimeout(Zb,1E3)}}get iXh(){return this.JDh||(this.JDh=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set iXh(ma){this.JDh=ma}get wtm(){return this.z4k||(this.z4k=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(ma,
Sa){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(ma,Sa)}DJf(ma,Sa,Zb,Wc,rd){var ee;f.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",ma);u.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:8642303_FixedTelemetryForAddinCommandsActionEnabled")&&(ma={["solutionId"]:null===(ee=globalThis.Telemetry)||void 0===ee?void 0:ee.PrivacyRules.GetPrivacyCompliantId(rd.ownerAddinInfo.solutionId,rd.ownerAddinInfo.storeType,rd.ownerAddinInfo.assetId,null,null,
rd.ownerAddinInfo.storeId)},ee=new qa.a,ee.name="Office.Extensibility.Host.HandleAddinCommandsAction",ee.dataFields=N.a.Gw(ma),U.a.sendTelemetryEvent(ee));if((Sa=Sa.JEd(rd.ownerAddinInfo.storeType,rd.ownerAddinInfo.solutionId))&&Sa.wta&&!Sa.wta.getIsUpgrading())if(ee=null,0<Sa.wta.getNotificationParams().length&&(ee=this.bil(Sa.wta.getNotificationParams()[0]))&&2147758681===ee.errorCode&&(Sa.isUpgraded=!0),2!==Sa.wta.getStatus()&&(1!==Sa.wta.getStatus()||ee&&2147758681===ee.errorCode))ee&&this.z4l(Sa,
ee,null);else try{Zb.setOwnerAddinEToken(Sa.wta.getEToken()),rd.action(Zb,Wc.$cc)}catch(De){f.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",u.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?De.stack:De.message)),wa.zHk(Object(v.a)("InternalError")+" "+Object(v.a)("InternalError_Directive"))}}z4l(ma,Sa,Zb=null){const Wc=ma.wta;if(1===Wc.getNotificationParams().length||Sa.ozl){const rd=Sa.yff,ee=Sa.crf;
Sa.yff=()=>{Wc.removeFirstNotification();if(0<Wc.getNotificationParams().length){const De=this.bil(Wc.getNotificationParams()[0]);this.z4l(ma,De)}2147758681===Sa.errorCode&&(Ha.TEm(ma.yka,Wc,this.NAl),h.PEm(ma.ilf,Wc,this.NAl));rd&&rd()};Sa.crf=()=>{ee&&ee();Zb&&Zb()};wa.kPn(Sa)}}bil(ma){const Sa=new dd;Sa.jaj=ma.infoType;Sa.id=ma.id;Sa.title=ma.title;Sa.description=ma.description;Sa.buttonText=ma.buttonTxt;Sa.yff=ma.buttonCallback;Sa.ozl=ma.highPriority;Sa.crf=ma.dismissCallback;Sa.errorCode=ma.errorCode;
Sa.B0m=ma.iframeNotificationUrl;return Sa}}Object(c.a)(Ad,"AddinCommandsActionHandler",null,[496]);class Jb{constructor(){this.labelText=null;this.visible=!1}}Object(c.a)(Jb,"AddinStatusCommandValues",null,[]);class Bc{static FBn(ma){const Sa=new Jb;Sa.labelText=ma.Haf;Sa.visible=Sa.labelText?!0:!1;return Sa}static EIk(){const ma=document.getElementById(void 0);ma?Bc.Y4l(void 0,void 0,ma,void 0,void 0):f.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",void 0))}static Y4l(ma,
Sa,Zb,Wc,rd){Zb?ma.Haf===Object(v.a)("ErrorLoadingAddInsTitle")?wa.qPn(Sa,Zb,Wc,rd):ma.Haf===Object(v.a)("InstallingCustomFunctionsErrorStatusBarMsg")&&wa.dQn(Sa,Zb,Object(v.a)("InstallingCustomFunctionsErrorCalloutMsg"),Object(v.a)("InstallingCustomFunctionsErrorStatusBarMsg")):f.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(c.a)(Bc,"AddinCommandsStatusHandler",null,[]);class Mc{constructor(){this.r3=this.$Sc=0;this.m2h=null;this.cth=this.Nyh=
0;this.z2c=this.gJh=this.XDh=null}get hbh(){this.XDh||(this.XDh=new b.a);return this.XDh}get iHi(){this.gJh||(this.gJh=new b.a);return this.gJh}get Syd(){this.z2c||(this.z2c=new b.a);return this.z2c}}Object(c.a)(Mc,"AddinCommandsListLoaderContext",null,[]);class ed{constructor(ma,Sa){this.entitlement=ma;this.metadata=Sa}wRk(){var ma=this.entitlement;const Sa={};Sa.solutionId=ma.solutionId;Sa.version=ma.version;Sa.storeType=ma.storeType;Sa.storeId=ma.storeId;Sa.assetId=ma.assetId;Sa.assetStoreId=ma.assetStoreId;
Sa.targetType=ma.targetType;Sa.requireConsent=ma.requireConsent||!1;Sa.isAddinCommands=!0;Sa.addinCommandsActionType=0;Sa.targetType=this.targetType;return Sa}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==this.entitlement.targetType?
this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(c.a)(ed,"AddinEntitlementEx",null,[]);class Yc extends Sys.EventArgs{constructor(ma){super();this.properties=ma}}Object(c.a)(Yc,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class ab{constructor(ma,Sa,Zb){this.Js=new B.a;this.context=new Mc;this.PUh=null;this.sqn=
(Wc,rd,ee,De)=>{Wc?(Wc=new ed(ee.targetData,De),rd&&this.context.hbh.add(Wc),10===this.context.$Sc&&(this.context.iHi.add(Wc),0===Wc.targetType&&this.context.Syd.add(Wc))):(rd=ee.targetData,f.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(rd.solutionId,rd.storeType,rd.assetId,null,null,rd.storeId),rd.storeType));this.rYj()};this.contextActivationMgr=ma;this.arm=Sa;this.Faf=Zb;this.appName=u.AFrameworkApplication.ga.La("WebAppShortName")}get c7l(){this.PUh||
(this.PUh=new ra(this.Js));return this.PUh}Lpm(ma){this.Js.addHandler(F.a.j2h,ma)}Rqm(ma){this.Js.addHandler(F.a.GHk,ma)}dWn(ma){null!==ma&&(this.context.$Sc=ma[F.a.izb],this.context.r3=ma[F.a.k9a],this.context.Nyh=this.context.cth=0,ma=F.a.P4c in ma?ma[F.a.P4c]:0,-1!==this.context.$Sc&&0!==this.context.r3&&(this.context.m2h=this.arm.createAddinDataProvider(Qa(this.context.$Sc),this.contextActivationMgr),this.context.m2h?this.context.m2h.getEntitlementsAsync(this.contextActivationMgr.$cc,!0,ma,Sa=>
{this.Fqn(Sa)}):f.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.$Sc)))}Fqn(ma){if(ma&&0<ma.length){this.context.Nyh=ma.length;const Zb=Oa();for(let Wc=0;Wc<ma.length;Wc++){const rd=ma[Wc];if(Ja()&&rd&&rd.storeType&&"omex"===rd.storeType.toLowerCase()&&rd.assetId&&Zb&&rd.assetId.toLowerCase()===Zb.toLowerCase()){var Sa={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:ab.Jsa(rd)};U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:N.a.Gw(Sa)}))}!rd||1!==rd.targetType&&-1!==rd.targetType?this.rYj():(Sa={},u.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Sa.solutionId=rd.solutionId,Sa.version=rd.version):(Sa.marketplaceId=rd.solutionId,Sa.marketplaceVersion=rd.version),Sa.storeType=rd.storeType,Sa.storeId=rd.storeId,Sa.targetData=rd,this.contextActivationMgr.isAddinCommandsExAsync(Sa,this.sqn))}}else this.rYj()}rYj(){var ma;(ma=
this.context).cth=ma.cth+1;this.context.cth>=this.context.Nyh&&(this.Faf.Svh(this.context.$Sc,!1),0<this.context.Nyh&&10===this.context.$Sc&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(ma=!1,Ga()&&(ma=this.$9m(this.context.iHi)),this.I9m(this.context.iHi),ma?this.Ddc(this.Vkl(this.context.hbh)):this.c7l.EVn(this.contextActivationMgr,this.context.hbh,this.context.Syd,(Sa,Zb)=>{const Wc=new b.a;for(const rd of Sa)Sa=rd.wRk(),Zb&&Zb.solutionId===rd.solutionId&&(Sa.showCallout=
!0,this.c7l.Y9l(Zb)),Wc.add(Sa);this.Ddc(Wc)})):this.Ddc(this.Vkl(this.context.hbh)))}Vkl(ma){const Sa=new b.a;if(ma)for(const Zb of ma)Sa.add(Zb.wRk());return Sa}Ddc(ma){ma&&ma.count||D.a.s0c(F.a.Gaf,"false",this.context.$Sc);ma={["ack2"]:ma};ma[F.a.izb]=this.context.$Sc;ma[F.a.k9a]=this.context.r3;this.Js.raiseEvent(F.a.j2h,new Yc(ma),this)}$9m(ma){let Sa=!1;if(ma&&1>ma.count)return Sa;const Zb=Oa();if(!Zb)return Sa;for(const Wc of ma)if(Wc.storeId&&Wc.storeId.toLowerCase()===Zb.toLowerCase()||
Wc.assetId&&Wc.assetId.toLowerCase()===Zb.toLowerCase())ma={["SDX_Id"]:ab.dwl(Wc),["SDX_TargetType"]:ha.b(Wc.targetType)?"":Wc.targetType.toString()},U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:N.a.Gw(ma)})),Sa=!0;return Sa}I9m(ma){if(!(ma&&1>ma.count))if(this.Faf.qlj()){var Sa=this.Faf.YSi();Sa?(ma=this.mul(ma,Sa),f.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(ma=this.mul(ma,null),f.ULS.sendTraceTag(527523847,
306,50,"no data from cache"));this.Faf.JBk(ma)}else f.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}mul(ma,Sa){const Zb={};let Wc=!1;const rd=new Set;for(const ee of ma)if(ma=ab.dwl(ee))!Sa||ma in Sa||(rd.add(ee.solutionId),this.XQ(ee,ma),f.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===ma.toLowerCase()?Wc||(Wc=!0,Zb[ma]=null):Zb[ma]=null;this.Faf.hBk(rd);return Zb}XQ(ma,Sa){var Zb=ma.installTimeInMS?(new Date(ma.installTimeInMS)).toISOString():
"";Zb={["SDX.Id"]:Sa,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:ha.b(ma.targetType)?"":ma.targetType.toString(),["SDX.AdminDeploymentTime"]:Zb};U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:N.a.Gw(Zb)}));1===ma.targetType&&(ma={["SDX.Id"]:Sa,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:N.a.Gw(ma)})))}static Jsa(ma){return Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,
ma.storeType,ma.assetId,null,null,ma.storeId)}static dwl(ma){return Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.storeType,ma.assetId,null,null,ma.storeId)}}Object(c.a)(ab,"AddInCommandsListLoader",null,[]);var jb=a(1340),cc=a(45),Hc=a(1505),Vc=a(249),Tc=a(279),cd=a(250),Lb=a(36);class Rc{get BDa(){return this.Fb.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&this.Fb.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}constructor(ma,Sa,
Zb){this.YWd=this.zEc=this.tBb=this.H6d=null;this.mNj=this.qph=-1;this.Kga=null;this.yLl=!1;this.a2j=(Wc,rd)=>{Wc="Insert";cd.a("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.BDa&&(Wc="Home");rd.Brb===Wc&&(this.Ad.Uje(this.a2j),this.Eei(rd.nYj,rd.Brb,this.rGl,!0))};this.mGl=ma;this.Fb=Sa;this.rGl=this.Fb.Jc("AddinMaxTabSwitchDetectionTimesForTeachingUI",3);this.Lan=this.Fb.Jc("AddinMaxDOMElementDetectionTimesForTeachingUI",10);this.x$c=this.Fb.La("WebAppShortName");this.Ad=
Zb;V.a.rb(this.x$c)&&(this.x$c="PowerPoint")}Jsa(ma){return Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.storeType,ma.assetId,null,null,ma.storeId)}UEn(ma){this.Kga=ma;window.addEventListener("LaunchContentAddin",Object(r.a)(this,this.Ksn,"onTryItButtonClicked_ContentAddin"),!0);window.addEventListener("DismissCallout",Object(r.a)(this,this.wpn,"onDismissButtonClicked_ContentAddin"),!0);window.addEventListener("CloseCallout",Object(r.a)(this,this.Gon,"onCloseButtonClicked_ContentAddin"),
!0);cd.a("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.BDa?this.ZPa?(ma=appChrome.selectors.getSelectedTabId())&&Lb.a(ma,"Home")?this.j5l():this.Ad.c$b(this.a2j):f.ULS.sendTraceTag(508564946,802,50,"selector is not ready"):this.Ad.c$b(this.a2j)}Aqn(){this.tBb&&this.YWd&&(this.mGl.DJf({["SourceControlId"]:this.YWd}),f.ULS.sendTraceTag(512499854,220,50,"Launch addin command has been triggered"))}uPn(ma,Sa){Sa?(this.tBb=Sa.NX,(this.H6d=Sa.yka)&&this.H6d.dsb&&this.H6d.dsb.Cea&&
(this.zEc=this.H6d.dsb.Cea.ha(0)),this.zEc?(this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",!1)&&this.B2l(),this.zEc.isOfficeTab?(this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",!1)||this.B2l(),this.YWd?0<this.zEc.id.indexOf(Tc.a.ICb)?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(va.xzf(this.H6d),()=>{this.k5l(this.Thh(this.YWd))}):this.Ad.c$b(Object(r.a)(this,this.RRl,"onTabSwitched")):(this.k$c("NoEnabledButtonFound",
this.tBb),f.ULS.sendTraceTag(512499851,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.iNc())):this.m5l(this.Thh(this.zEc.id),0)):(this.k$c("NoTabFound",this.tBb),f.ULS.sendTraceTag(512499853,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.iNc())):this.iNc()}B2l(){const ma=this.tBb.solutionId,Sa=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();ma in Sa?this.YWd=Sa[ma]:(f.ULS.sendTraceTag(512499852,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",
this.Jsa(this.tBb)),this.YWd=this.ALm(this.H6d))}RRl(ma,Sa){!this.zEc||void 0===this.zEc.id||null===this.zEc.id||0>V.a.mj(this.zEc.id).indexOf(V.a.mj(Sa.Brb))||(this.Ad.Uje(Object(r.a)(this,this.RRl,"onTabSwitched")),this.Eei(Sa.nYj,Sa.Brb,this.rGl,!1))}Eei(ma,Sa,Zb,Wc){if(0>Zb)cd.a("OfficeVSO:8180233_AddNullCheck")&&Wc?this.xWd("TabSwitchTimeOut",this.Kga):this.k$c("TabSwitchTimeOut",this.tBb);else{var rd=document.querySelector("button"+this.Thh(Sa));rd.hasAttribute("aria-selected")&&"false"!==rd.getAttribute("aria-selected")?
(0<this.mNj&&window.clearTimeout(this.mNj),Wc?this.j5l():this.k5l(this.Thh(this.YWd))):this.mNj=window.setTimeout(()=>{this.Eei(ma,Sa,Zb-1,Wc)},1E3)}}Thh(ma){return"[id="+ma+"]"}j5l(){var ma="button[data-unique-id = 'Ribbon-InsertAddIns']";cd.a("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&(ma=this.BDa?"button[data-unique-id = 'Ribbon-InsertAddInFlyout']":ma);var Sa=(ma=document.querySelector(ma))?window.getComputedStyle(ma,null):null;if(!ma||Sa&&"none"===Sa.display)if(ma=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']"))f.ULS.sendTraceTag(512499849,
220,15,"Callout show on Overflow button");else{this.xWd("NoAnchor",this.Kga);f.ULS.sendTraceTag(512499850,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}else f.ULS.sendTraceTag(512499848,220,15,"Callout show on OfficeAddin Button");(Sa=ia.a.instance.Na("Common.ISystemInitiatedFeedback"))&&ma?(Sa.execute(Zb=>{Zb.logActivity("ShowTeachingUIForContentAddin",null)}),this.xWd("Show",this.Kga),f.ULS.sendTraceTag(512499846,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity")):
(this.xWd("NoSifFutureObject",this.Kga),f.ULS.sendTraceTag(512499847,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"))}Ksn(){this.xWd("ClickOnLaunch",this.Kga);this.iNc();const ma={};ma.solutionId=this.Kga.solutionId;ma.assetId=this.Kga.assetId;ma.assetStoreId=this.Kga.assetStoreId;ma.height=this.Kga.height?this.Kga.height:600;ma.storeId=this.Kga.storeId;ma.targetType=this.Kga.targetType;ma.width=this.Kga.width?this.Kga.width:600;ma.displayName=this.Kga.displayName;ma.version=
this.Kga.version;ma.storeType=this.Kga.storeType;ma.isAddinCommands=!1;this.mGl.Tc.DFe("0",3,ma)}Gon(){this.xWd("ClickOnClose",this.Kga);this.iNc()}wpn(){this.xWd("ClickOnDismiss",this.Kga);this.iNc()}m5l(ma,Sa){if(Sa>this.Lan)window.clearTimeout(this.qph),this.l5l("[data-unique-id='pivotOverflowButton']"),f.ULS.sendTraceTag(512499845,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time");else{var Zb=document.querySelector("button"+ma);!Zb||Zb.hasAttribute("tabIndex")&&"-1"===Zb.getAttribute("tabIndex")?
this.qph=window.setTimeout(()=>{this.m5l(ma,Sa+1)},1E3):(0<this.qph&&window.clearTimeout(this.qph),this.l5l(ma))}}k5l(ma){let Sa=document.querySelector("button[data-unique-id='RightPaddle']");if(Sa)this.k$c("RightPaddlePresent",this.tBb);else if(ma=(Sa=document.querySelector("button"+ma))?window.getComputedStyle(Sa,null):null,!Sa||ma&&"none"===ma.display)if(Sa=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Sa){this.k$c("NoAnchor",this.tBb);f.ULS.sendTraceTag(512499844,220,15,
"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.iNc();return}this.d8l(Sa,"ShowTeachingUIForAddinButton")}l5l(ma){let Sa=document.querySelector("button"+ma);if(!Sa&&("[data-unique-id='pivotOverflowButton']"!==ma&&(Sa=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!Sa)){this.k$c("NoAnchor",this.tBb);f.ULS.sendTraceTag(512499843,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.iNc();return}this.d8l(Sa,"ShowTeachingUIForAddinTab")}d8l(ma,
Sa){ma.setAttribute("lpp-id","latestAddin");const Zb=ia.a.instance.Na("Common.ISystemInitiatedFeedback");Zb&&ma?(this.k$c("Show",this.tBb),Zb.execute(Wc=>{Wc.logActivity(Sa,null)}),f.ULS.sendTraceTag(512499841,220,50,"TriggerLPPActivity triggered an LPP activity")):(this.k$c("NoSifFutureObject",this.tBb),f.ULS.sendTraceTag(512499842,220,15,"TriggerLPPActivity failed to get a sifFuture"),this.iNc())}ALm(ma){if(!ma||!ma.dsb||!ma.dsb.Cea)return null;for(const Sa of ma.dsb.Cea)if(Sa)for(const Zb of Sa.groups)if(Zb)for(const Wc of Zb.controls){if(Wc&&
Wc.attributes&&0===Wc.controlType&&Wc.enabled)return Wc.id;if(Wc.menuItems)for(const rd of Wc.menuItems)if(rd.attributes&&rd.enabled)return Wc.id}}k$c(ma,Sa){Rc.XQ(ma,this.Jsa(Sa))}xWd(ma,Sa){Sa=Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa.solutionId,Sa.storeType,Sa.assetId,null,null,Sa.storeId);Rc.XQ(ma,Sa)}qvh(ma){const Sa={};Sa[this.x$c]=P.c({["LastTeachingUIShowTime"]:(new Date).toUTCString(),["AddinHasShown"]:ma});(new fa(this.x$c,null,null,Object(r.a)(this,this.Msb,"postRequestFailureCallback"))).DBe(Sa);
f.ULS.sendTraceTag(512499840,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}Msb(ma){f.ULS.sendTraceTag(512499811,306,15,"failed to POST data to Roaming Settings Service with status: {0}",ma?ma.Ze:-1)}iNc(){if(!this.yLl){const ma=window.g_roamingAddinList;ma&&(this.qvh(ma),this.yLl=!0)}}static XQ(ma,Sa){ma={["AppTeachingUICalloutAction"]:ma,["SDX.Id"]:Sa,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:N.a.Gw(ma)}))}get ZPa(){return!!window.appChrome&&!!appChrome.selectors}}Object(c.a)(Rc,"AddinTeachingCalloutHandler",null,[]);class md{}Object(c.a)(md,"AddinCommandsHost",null,[]);var Zc=a(119),ld=a(366);class fe extends Zc.a{constructor(){super(void 0,void 0,void 0,!0);this.$Ve="AddinCommandsUILessDialog";this.oVh="WACDialogTitleText";this.Eyb="0";this.lDa=380;this.Cua=190;this.uk=this.$Ve;
this.gf=5;this.Agm=String.format("{0}px",this.lDa);this.Dyb=String.format("{0}px",this.Cua);this.w6i=this.zz=!1;this.hL()}hL(){super.hL();this.LB.style.width=this.Agm;this.LB.style.height=this.Dyb;this.LB.style.padding=this.Eyb}oec(ma){this.n7();document.getElementById(this.ap(this.oVh)).innerText=ma}n7(){super.n7();this.Ed.style.width=String.format("{0}px",this.lDa);this.Ed.style.height=String.format("{0}px",this.Cua);this.Ed.removeAttribute(ld.a.pi);this.Ed.removeAttribute(ld.a.rma)}hide(){this.ejh()}get kNb(){return this.LB}initializeAndShowWithTitle(){this.Dq(Object(v.a)("NotificationUITitle"),
null,null)}}Object(c.a)(fe,"AddinCommandsUILessDialog",Zc.a,[489]);var Ac=a(259),R=a(345),za=a(256),X=a(568);class lb extends md{constructor(ma,Sa,Zb,Wc){super();this.vpb=ma;this.Hd=Sa;this.X1d=Zb;this.q8d=Wc}setOwnerAddinEToken(ma){this.vpb.eToken=ma}showTaskpane(ma,Sa,Zb){f.ULS.sendTraceTag(509699670,220,50,String.format("ShowTaskpane action called."));this.ZAl(ma,Sa,Zb,!0)||f.ULS.sendTraceTag(509699669,806,10,String.format("ShowTaskpane : instance id is null."))}showDialog(){}createUILessSandbox(ma,
Sa,Zb){f.ULS.sendTraceTag(509699668,220,50,String.format("UILess action called."));this.ZAl(ma,Sa,Zb,!1,this.X1d)||f.ULS.sendTraceTag(509699667,806,10,String.format("UILess : instance id is null."))}disposeHost(){}ZAl(ma,Sa,Zb,Wc,rd=!1){var ee=this.Hd.xT(ma.solutionId);ee||(ee=this.Hd.oJm(ma,Sa,this.vpb.solutionId,rd));if(ee&&this.Hd.SAb(ee.Kp))return this.Hd.uUa(ee.Kp),Zb(ee.Kp,0),rd||this.Hd.TWc(ee.Kp,Wc),!0;let De=null;if(!ee)if(ee=this.Hd.pum(ma,Sa,Wc,this.vpb.solutionId,rd),ee.setValue(za.a.ownerAddinStoreType,
this.vpb.storeType),De=ee.oa(R.a.sharedRuntimeId,null),this.OFl(!!De,!0),rd&&(rd=rd&&!De),Sa=rd?new fe:null,rd?this.Hd.owb(ee,Sa.kNb):(ee.setValue(Ac.a.n$b,Wc||!!De),this.Hd.KZl(ee)),ee=this.Hd.xT(ma.solutionId))if(rd&&this.q8d.K(ee.Kp,Sa),ma=this.Hd.Cib(this.vpb.solutionId)){if(ma=new X.a(ma),this.Hd.o9l(ma.id,ee.Kp),De&&!this.Hd.hxf(ma.oub)&&(ma=this.Hd.RIi(ma.oub)))ma.oJ||ma.Pnm(De),this.Hd.Cah(this.vpb.solutionId,ma)}else{ma=this.Hd.oum(this.vpb,De);if(!ma)return Zb(null,5001),!1;this.Hd.Cah(this.vpb.solutionId,
ma);this.G9m(!!De)}else return Zb(null,5001),!1;Zb(ee.Kp,0);Zb=this.Hd.SAb(ee.Kp);this.Hd.TWc(ee.Kp,Zb?Wc:!0);this.OFl(!!De,!1);return!0}OFl(ma,Sa){ma&&window.performance&&window.performance.memory&&f.ULS.sendTraceTag(509699666,802,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",Sa,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)}G9m(ma){f.ULS.sendTraceTag(509699665,
802,50,"PPT WAC add-in created: SolutionId: {0}, StoreType: {1}, IsShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.vpb.solutionId,this.vpb.storeType,this.vpb.assetId,null,null,this.vpb.storeId),this.vpb.storeType,ma)}}Object(c.a)(lb,"WACPowerPointAddInCommandsHost",md,[]);var oc=a(389),Oc=a(284),sd=a(388);class Ld{constructor(ma,Sa,Zb,Wc,rd,ee,De,Af,mg,dg,Zg){this.Kga=this.yMl=null;if(!ma)throw Error.argumentNull("app");this.SUb=new C;this.uHl=Zb;this.Db=ma.nj;this.Ge=De;this.Hd=
Sa;this.TUb=ee;this.Hd.lqm(Object(r.a)(this,this.Ixm,"clearLoadingAddinMessage"));this.SUb.Npm(Object(r.a)(this,this.OVm,"handleAddinCommandsLoadingMessageChanged"));this.Aa=Wc;this.Fb=rd;jb.a.Uyc=jb.a.m9j;this.q8d=new Mb.a;this.n2a=mg;this.Hm=dg;this.ubn=new b.a;this.oGe=new b.a;this.Ad=Zg}get Tc(){return this.Hd}Jlh(ma){f.ULS.sendTraceTag(512499869,220,50,"LaunchOperationType {0}.",ma[F.a.k9a]);if(this.Aa.y9c||!this.Aa.uSa){var Sa=ma[F.a.aud];if(Sa&&0<Sa.count){const Wc=Sa.count;for(let rd=Wc-1;0<=
rd;rd--){const ee=Sa.ha(rd);OSF.OsfControl.isFirstPartyStoreString(ee.storeType)||Sa.remove(Sa.ha(rd))}Sa.count<Wc&&(this.Aa.y9c&&!this.Hm.v0a(22)&&this.Hm.Z$b(22),this.Aa.uSa||this.Hm.v0a(36)||this.Hm.Z$b(36));if(!Sa.count)return}}let Zb=null;Zb=u.AFrameworkApplication.ga.getBooleanAppSetting("HostInstallAddInsIsEnabled")?new pa(this.TUb,this.uHl,new Ea(this.Hd.nq),new $b("",eb.a.y4c),this.SUb,ec.instance,new pc,(Wc,rd)=>{const ee={};ee.solutionId=Wc.solutionId;ee.version=Wc.version;ee.storeType=
Wc.storeType;ee.storeId=Wc.storeId;ee.assetId=Wc.assetId;ee.assetStoreId=Wc.assetStoreId;this.Hd.KQn(ee,()=>{rd(Wc)})}):new pa(this.TUb,this.uHl,new Ea(this.Hd.nq),new $b("",eb.a.y4c),this.SUb,ec.instance,new pc);Zb.Qpm(Object(r.a)(this,this.pon,"onAutoLaunchAddin"));Zb.Mpm(Object(r.a)(this,this.Bqn,"onLaunchAddinCommandsCompleted"));Sa=new Rc(this,this.Fb,this.Ad);Zb.bqm(Object(r.a)(Sa,Sa.Aqn,"onLaunchAddinButtonClicked"));Zb.Pqm(Object(r.a)(Sa,Sa.uPn,"showCalloutOnAddin"));try{cc.a.get_instance().$i(5,
null).continueWith(()=>{Zb.K8m(this.n2a,Vc.App.Vb.sP(),ma)},11)}catch(Wc){f.ULS.sendTraceTag(512499868,220,10,String.format("LaunchAddinCommands error message : {0}.",Wc.message))}}NVm(ma){ma=ma[this.TUb.Y5c];ma=(new Ad).iXh(ma);return u.AFrameworkApplication.uSa||OSF.OsfControl.isFirstPartyStoreString(ma.ownerAddinInfo.storeType)}DJf(ma){const Sa=new Ad;this.m0i(Sa,ma[this.TUb.Y5c])}m0i(ma,Sa){const Zb=ma.iXh(Sa),Wc=new lb(Zb.ownerAddinInfo,this.Hd,this.Aa.OAb,this.q8d);ma.DJf(Sa,this.SUb,Wc,new Ea(this.Hd.nq),
Zb)}kWl(ma){const Sa=Bc.FBn(this.SUb);ma[Hc.a.LabelText]=Sa.labelText;ma[Hc.a.Visible]=Sa.visible}mPn(){this.EIk()}jNe(ma){ma&&F.a.jbh in ma&&ma[F.a.jbh]&&wa.zHk(ma[F.a.jbh].toString())}KDn(){if(this.SUb.Vlh()){this.SUb.Ljl();const ma=this.cJi();if(ma&&0<ma.count)for(const Sa of ma)this.$Le({["ack1"]:Sa,["ack0"]:4,["ak0"]:(new Date).getTime()})}else this.Fb.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(f.ULS.sendTraceTag(509669719,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",
this.SUb.Vlh()),this.tka(10,!0),this.tka(0,!0))}OVm(){this.Ge.WH(new oc.a(2));this.EIk()}get jna(){return this.Fb.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.Fb.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}wBn(ma){if(ma&&F.a.izb in ma)if(this.Hd){var Sa=ma[F.a.izb];this.jna?F.a.Naf in ma&&(ma=ma[F.a.Naf],this.Hd.hje(Sa,ma),1===ma&&this.tka(Sa,!0)):this.tka(Sa,!0)}else f.ULS.sendTraceTag(508598483,220,10,"queryAddinDetailsWithActionData: abort because m_appForOfficeManager is null.");
else f.ULS.sendTraceTag(509669718,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}tka(ma,Sa=!1){this.Hd?(f.ULS.sendTraceTag(509669716,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",ma,Sa),this.Hd.tka(ma,Sa)):f.ULS.sendTraceTag(509669717,220,10,"QueryAddinDetails: abort because m_appForOfficeManager is null.")}$Le(ma){f.ULS.sendTraceTag(512499867,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",ma[F.a.k9a],ma[F.a.izb]);
this.SUb.cLn();const Sa=new sd.a("AddinCommandsManager::retrieveAddInCommandsEntitlementsList",0);window.setTimeout(()=>{Sa.Cf("ST");const Zb=new ab(new Ea(this.Hd.nq),ec.instance,gb.a.instance);Sa.Cf("TA_loaderInitialization");Zb&&(Zb.Lpm((Wc,rd)=>{this.Fb.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.tka(ma[F.a.izb]);this.Jlh(rd.properties)}),Sa.Cf("TA_Add_AddinCommandsEntitlementsRetrieved"),Zb.Rqm((Wc,rd)=>{this.Kga=rd;this.yMl=new Rc(this,this.Fb,this.Ad);this.yMl.UEn(this.Kga)}),
Sa.Cf("TA_Add_ShowTeachingCalloutOnContentAddin"),Zb.dWn(ma),Sa.Cf("TA_TryRetrieveAddinCommandsEntitlementsList"));Sa.Cf("ET");Sa.BM()},0)}Ixm(){this.SUb.Ljl()}ntm(ma){var Sa=this.Hd.xT(ma);if(Sa&&Sa.oJ&&Sa.oJ.Jbb&&!(0>=Sa.oJ.state)){var Zb=new Ad,Wc=Zb.getTaskPaneControlIdFromSolutionIdRuntimeId(ma,Sa.oJ.Jbb);Wc&&(this.Hd.Cah(ma,Sa),this.m0i(Zb,Wc),this.Hd.mkl(ma),(Sa=this.Hd.xT(ma+Wc))?this.Hd.setInitialDisplayMode(Sa.Kp,1):f.ULS.sendTraceTag(512499866,802,10,"Failed to find auto-loaded shared runtime pane for "+
ma))}}vtm(ma){if(ma&&ma.solutionId){var Sa=new Ad,Zb=Sa.wtm;if(Zb=ma.solutionId in Zb?Zb[ma.solutionId]:null){let Wc=this.Hd.xT(ma.solutionId);if(!Wc){Wc=this.Hd.RIi(ma.solutionId);if(!Wc){f.ULS.sendTraceTag(512499864,220,15,String.format("AutoShowTaskPane appForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.storeType,ma.assetId,null,null,ma.storeId)));return}this.Hd.Cah(ma.solutionId,Wc)}ma=Wc.settings;(ma=F.a.i2h in ma?ma[F.a.i2h]:null)&&"true"===ma.toLowerCase()&&
this.m0i(Sa,Zb)}}else f.ULS.sendTraceTag(512499865,220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid solution id.")}jOn(ma){if(void 0===ma||null===ma||void 0===ma[this.TUb.Y5c]||null===ma[this.TUb.Y5c])return!1;ma=ma[this.TUb.Y5c];return V.a.rb(ma)?!1:this.oGe.contains(ma)}KMn(ma){ma=ma.dsb;if(!ma)f.ULS.sendTraceTag(512499863,220,15,"Ribbon Extensibility for React ribbons should not be null.");else if(ma.Cea)for(const Sa of ma.Cea)if(Sa.groups)for(const Zb of Sa.groups)if(Zb.controls)for(const Wc of Zb.controls)if(this.KNk(Wc.id,
Wc.enabled),1===Wc.controlType&&Wc.menuItems)for(const rd of Wc.menuItems)this.KNk(rd.id,rd.enabled)}KNk(ma,Sa){if(ma&&ma.length){var Zb=this.oGe.contains(ma);Zb&&Sa&&this.oGe.remove(ma);Zb||Sa||this.oGe.add(ma)}}vXn(ma){let Sa=null,Zb=null,Wc=!0;void 0!==ma[F.a.Weh]&&null!==ma[F.a.Weh]&&void 0!==ma[this.TUb.Y5c]&&null!==ma[this.TUb.Y5c]&&void 0!==ma[F.a.Ueh]&&null!==ma[F.a.Ueh]&&(Sa=ma[F.a.Weh],Zb=ma[this.TUb.Y5c],Wc=ma[F.a.Ueh]);V.a.rb(Sa)||V.a.rb(Zb)||(ma=(new Va("",Sa,this.TUb,!0)).qPb(Zb),this.KNk(ma,
Wc),this.Db.Zf())}dvf(ma){if(void 0!==ma&&null!==ma&&void 0!==ma[F.a.Veh]&&null!==ma[F.a.Veh])switch(ma[F.a.Veh]){case 1:this.vXn(ma);break;case 4:this.oGe.clear(),this.oGe.addRange(this.ubn)}}pon(ma,Sa){if(Sa)if(Sa)if(ma=Sa.NX,Sa=Sa.yka,!Ja()&&!Ga()||this.Hd.RIi(ma.solutionId)){var Zb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();(Sa=ma.solutionId in Zb?Zb[ma.solutionId]:this.hNm(Sa))?(this.DJf({["SourceControlId"]:Sa}),ma.isAutoLaunched=!0):f.ULS.sendTraceTag(512499860,
220,15,"addinCommandControlId is null")}else f.ULS.sendTraceTag(512259016,220,15,String.format("AppForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.storeType,ma.assetId,null,null,ma.storeId)));else f.ULS.sendTraceTag(512499861,220,15,"agaveParams is null");else f.ULS.sendTraceTag(512499862,220,15,"No args for OnAutoLaunchAddin event")}hNm(ma){if(!ma)return f.ULS.sendTraceTag(512499859,220,10,"Failed to get button id for addin"),null;ma=ma.dsb;if(!ma||!ma.Cea||
!ma.Cea.count)return f.ULS.sendTraceTag(512499858,220,15,"It has 0 or multiple tabs"),null;ma=ma.Cea.ha(0);if(!ma.groups||1!==ma.groups.length)return f.ULS.sendTraceTag(512499857,220,15,"It has 0 or multiple groups"),null;ma=ma.groups[0];if(!ma.controls||1!==ma.controls.length)return f.ULS.sendTraceTag(512499856,220,15,"It has 0 or multiple buttons"),null;ma=ma.controls[0];return ma.attributes&&0===ma.controlType&&ma.enabled?ma.id:null}Bqn(ma,Sa){let Zb=null;Sa&&(Zb=Sa);Zb&&Zb.yka&&this.KMn(Zb.yka);
Zb?(Zb.NX&&this.ntm(Zb.NX.solutionId),this.Aa.vBl&&window.setTimeout(()=>{Zb.NX&&this.vtm(Zb.NX)},0)):f.ULS.sendTraceTag(512499855,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null."))}cJi(){const ma=new b.a;this.Aa.m0a&&(this.Aa.cfj&&ma.add(0),this.Fb.getBooleanAppSetting(Oc.a.Tcj)&&ma.add(1),this.Fb.getBooleanAppSetting(Oc.a.a5c)&&ma.add(10),ma.add(8));return ma}EIk(){const ma=this.Fb.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout"),Sa=document.querySelector("[data-unique-id='ShowAddInCommandsLoadStatusCallout']");
Bc.Y4l(this.SUb,this.Db.sP(),Sa,ma?ResourceStrings.L_TabHome:ResourceStrings.L_Insert,CommonUIStrings.L_ButtonOfficeAddins)}eVg(ma){ma&&this.q8d.Ob(ma)&&this.q8d.ha(ma).initializeAndShowWithTitle()}xMf(ma){ma&&this.q8d.Ob(ma)&&this.q8d.ha(ma).hide()}}Object(c.a)(Ld,"AddinCommandsManager",null,[914]);class Qd{constructor(){this.rMl={["tabhome"]:"PptRibbon.Home",["tabinsert"]:"PptRibbon.InsertTab",["tabdesign"]:"PptRibbon.Design",["tabtransitions"]:"PptRibbon.Transition",["tabanimations"]:"PptRibbon.Animation",
["tabview"]:"PptRibbon.View"};this.wKl={["tabslideshow"]:["PptRibbon.SlideShow",ResourceStrings.l_SlideShowTab,CommonUIStrings.l_SlideShowTabKeytip],["tabreview"]:["PptRibbon.Review",ResourceStrings.L_ReviewTab,CommonUIStrings.l_ReviewTabKeytip],["tabdeveloper"]:["PptRibbon.Developer",ResourceStrings.l_DeveloperTab,CommonUIStrings.l_DeveloperTabKeytip],["tabaddins"]:["PptRibbon.AddIns",ResourceStrings.l_AddInsTab,CommonUIStrings.l_AddInsTabKeytip]};this.Joh=null}get Y5c(){return"SourceControlId"}get aLa(){return"Presentation"}get formFactor(){return"DesktopFormFactor"}uQm(){if(!this.Joh){this.Joh=
{};for(const ma of Object.keys(this.rMl))this.Joh[ma]=this.rMl[ma];for(const ma of Object.keys(this.wKl))this.Joh[ma]=this.wKl[ma][0]}}}Object(c.a)(Qd,"AddinCommandsStringProvider",null,[913]);class Id{constructor(ma){this.xzm=ma}etl(){return this.xzm.yum()}}Object(c.a)(Id,"ContextMenuExtensibilityHandler",null,[912]);var he=a(39);class xb{constructor(ma,Sa,Zb,Wc){this.PIj=null;this.Hd=ma;this.vMl=Sa;this.pa=Zb;this.ih=Wc}get VWf(){return this.PIj}set VWf(ma){this.PIj=ma}register(){this.pa.QM(Object(r.a)(this,
this.Cvh,"selectionChangeEventHandler"));cd.a("ExtensibilitySlideSelectionChangedEventFix")&&this.ih.RJb(Object(r.a)(this,this.Cvh,"selectionChangeEventHandler"))}dispose(){this.pa.Bbb(Object(r.a)(this,this.Cvh,"selectionChangeEventHandler"));cd.a("ExtensibilitySlideSelectionChangedEventFix")&&this.ih.DLe(Object(r.a)(this,this.Cvh,"selectionChangeEventHandler"))}Cvh(){try{this.VWf&&this.vMl.li(this.VWf),this.PIj=new he.a(4,1,0,()=>{this.VWf=null;this.qVn()},90,"50"),this.vMl.Qb(this.VWf)}catch(ma){f.ULS.sendTraceTag(507843907,
802,10,ma.toString())}}qVn(){try{this.Hd.FWl(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),null);const Sa=this.pa.ys();if(Sa){var ma=Sa.xj();if(ma)for(const Zb of ma)if(Zb.ht){const Wc=new X.a(Zb);this.Hd.idd(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),Wc.id,null)}}}catch(Sa){f.ULS.sendTraceTag(507843906,802,10,Sa.toString())}}}Object(c.a)(xb,"AppForOfficeApiSelectionChangeEventListener",null,[900,24]);class Sb{constructor(){this.startTime=0;this.callback=
null}}Object(c.a)(Sb,"SSOCallbackInfo",null,[]);class Cc{constructor(){this.accessToken=null}}Object(c.a)(Cc,"AccessTokenInformation",null,[316]);class qb{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.Onc=this.tse=this.IOi=this.wYi=this.eIf=this.sPk=null}}Object(c.a)(qb,"AppsForOfficeOauthResult",null,[]);class Ob{constructor(){this.token=null;this.expiresOn=0;this.Onc=this.wSa=null}}Object(c.a)(Ob,"CachedTokenInfo",null,[]);class Pb{constructor(){this.z7g=new b.a;this.j$b=this.i$b=
!1;this.K_c=this.wSa=null;this.startTime=this.retryCount=0;this.Pfl=null}get callbacks(){return this.z7g}}Object(c.a)(Pb,"SSORequestInfo",null,[]);class qc extends Pb{constructor(){super();this.errorCode=0}}Object(c.a)(qc,"SSOFailedRequestInfo",Pb,[]);class Uc{static HUb(ma,Sa,Zb,Wc){var rd=ma.startTime;let ee=0;0<rd&&(ee=Uc.getCurrentTime()-rd);rd={["callInstanceId"]:rd.toString(),["callDuration"]:ee.toString(),["errorCode"]:Sa.toString()};if(Wc)for(const De in Wc)rd[De]=Wc[De];f.ULS.sendTraceTag(51401116,
344,50,"{0}",rd);U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:N.a.Gw(rd)}));ma.callback(Sa,Zb)}static getCurrentTime(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(ma){}return Date.now()}}Object(c.a)(Uc,"AppsForOfficeSingleSignOnManagerStatic",null,[]);class pd{constructor(ma,Sa,Zb,Wc){this.Leb=new b.a;this.hGa=new b.a;this.x2c=null;this.C4e=new b.a;this.a9k=Promise.resolve(null);this.Wbl=
!1;this.slm=Sa;this.vua=ma;this.cye=Zb;this.nfm=Wc}DOn(ma){if(this.x2c&&this.x2c.wSa===ma.wSa){if(Date.now()/1E3+pd.Xfn>this.x2c.expiresOn)return this.x2c=null,!1;ma=new qb;ma.token=this.x2c.token;ma.expiresOn=this.x2c.expiresOn;ma.Onc=this.x2c.Onc;ma.tse=!0;ma.eIf=0;this.cLf(ma);return!0}return!1}iOn(ma){for(let Sa=0;Sa<this.hGa.count;Sa++)if(this.hGa.ha(Sa).wSa===ma.wSa&&this.hGa.ha(Sa).K_c===ma.K_c){let Zb;(Zb=this.hGa.ha(Sa)).retryCount=Zb.retryCount+1;ma.retryCount=this.hGa.ha(Sa).retryCount;
if(this.hGa.ha(Sa).retryCount<pd.v4a||!this.hGa.ha(Sa).i$b&&ma.i$b||!this.hGa.ha(Sa).j$b&&ma.j$b){if(!this.hGa.ha(Sa).i$b&&ma.i$b||!this.hGa.ha(Sa).j$b&&ma.j$b)ma.retryCount=0;this.hGa.removeAt(Sa);break}ma=new qb;ma.errorCode=this.hGa.ha(Sa).errorCode;this.cLf(ma);return!0}return!1}Cpm(ma,Sa){for(let Zb=0;Zb<this.hGa.count;Zb++)if(this.hGa.ha(Zb).K_c===ma.K_c&&this.hGa.ha(Zb).wSa===ma.wSa)return;this.hGa.add(Object.assign(new qc,{i$b:ma.i$b,j$b:ma.j$b,wSa:ma.wSa,K_c:ma.K_c,errorCode:Sa,retryCount:ma.retryCount}))}get resource(){return this.slm}kIi(ma,
Sa,Zb,Wc,rd,ee){""===Zb&&(Zb=null);if(this.Wbl)Uc.HUb(ee,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var De=null;for(const Af of this.Leb)if(Af.i$b===ma&&Af.j$b===Sa&&Af.wSa===Zb&&Af.K_c===rd){De=Af;break}De||(De=Object.assign(new Pb,{i$b:ma,j$b:Sa,wSa:Zb,Pfl:Wc,K_c:rd,retryCount:0,startTime:Uc.getCurrentTime()}),this.Leb.add(De));De.retryCount=0;De.callbacks.add(ee);this.a9k=this.a9k.then(()=>{if(0<this.Leb.count){var Af=this.Leb.ha(0);if(this.DOn(Af)||this.iOn(Af))return null;
for(var mg=0;mg<this.C4e.count;)this.C4e.ha(mg)+pd.jUn<Uc.getCurrentTime()?this.C4e.removeAt(mg):mg++;if(this.C4e.count>=pd.ggn||this.Leb.count>=pd.Ufn)return Af=new qb,Af.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.cLf(Af),null;let dg=null;u.AFrameworkApplication.Ea&&(mg=u.AFrameworkApplication.Ea.Rba)&&(dg=mg.wl("ComponentAttach",this.vua+pd.omm));return Af.K_c.Anm(this.resource,Af.i$b,Af.j$b,Af.wSa,this.nfm,Af.Pfl).then(Zg=>{dg&&dg.stop();this.cLf(Zg)},()=>{dg&&dg.stop();
const Zg=new qb;Zg.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.cLf(Zg)})}return null})}}cLf(ma){try{if(this.Leb.count){var Sa=this.Leb.ha(0);this.Leb.removeAt(0);var Zb=null;ma.errorCode||(Zb=new Cc,Zb.accessToken=ma.token);ma.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&ma.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&ma.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&ma.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||
this.Cpm(Sa,ma.errorCode);var Wc={};null!=ma.eIf&&(Wc.getTokenSilentTime=ma.eIf.toString());null!=ma.wYi&&(Wc.getTokenPopupTime=ma.wYi.toString());null!=ma.IOi&&(Wc.getIDTokenTime=ma.IOi.toString());null!=ma.tse&&(Wc.tokenCached=ma.tse.toString());ma.sPk&&(Wc.detailedError=ma.sPk);ma.Onc&&(Wc.authLibrary=ma.Onc);Sa.retryCount&&(Wc.retryCount=Sa.retryCount);for(var rd of Sa.callbacks)Uc.HUb(rd,ma.errorCode,Zb,Wc);null!=ma.tse&&ma.tse||this.C4e.add(Sa.startTime);if(!ma.errorCode)for(null!=ma.expiresOn&&
(this.x2c=Object.assign(new Ob,{token:ma.token,expiresOn:ma.expiresOn,wSa:Sa.wSa,Onc:ma.Onc})),this.hGa.clear(),rd=0;rd<this.Leb.count;)if(this.Leb.ha(rd).wSa===Sa.wSa){for(const ee of this.Leb.ha(rd).callbacks)Uc.HUb(ee,ma.errorCode,Zb,Wc);this.Leb.removeAt(rd)}else rd++}}catch(ee){f.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",ee.message)}}shutdown(){this.Wbl=!0;this.Leb.clear()}}pd.jUn=6E4;pd.ggn=6;pd.Ufn=6;pd.v4a=3;pd.Xfn=300;pd.omm="GetAccessToken";Object(c.a)(pd,
"SSOCallbackManager",null,[]);var Od=a(380),be=a(7);class te{constructor(ma,Sa,Zb=null){this.gwe=new Mb.a;const Wc=new b.a;Sa&&Wc.add(Sa.Oen);Zb&&Wc.addRange(Zb);this.G7=ma;this.Pmm=Wc}removeCallbackForAddin(ma){this.gwe.Ob(ma)&&(this.gwe.ha(ma).shutdown(),this.gwe.remove(ma))}lIi(ma,Sa,Zb,Wc,rd,ee,De,Af,mg,dg){dg=Object.assign(new Sb,{startTime:Uc.getCurrentTime(),callback:dg});try{const wh=!!Zb&&""!==Zb;var Zg=dg.startTime;const Ji=this.getOsfControl(ma);let bi=Ji.getStoreType()||"",ni=Ji.getOwnerAddinStoreType()||
"",eh=Ji.getSolutionId()||"";const nj=Ji.getVersion()||"";bi=bi.toLowerCase();ni=ni.toLowerCase();eh=eh.toLowerCase();var Gh=ba.a.FCe(Sa)||"";const Al=ba.a.FCe(Ji.getIframeUrl())||"",dl=Gh.toLowerCase()===Al.toLowerCase();Gh=bi;"inmemory"===bi&&(Gh=ni);const Zi=Telemetry.PrivacyRules.GetPrivacyCompliantId(eh,Gh,Ji.getAssetId(),null,null,Ji.getStoreId()),Sj={["callInstanceId"]:Zg.toString(),["controlSolutionId"]:Zi,["controlVersion"]:nj,["storeType"]:bi,["ownerStoreType"]:ni,["allowConsentPrompt"]:Wc.toString(),
["forMSGraphAccess"]:rd.toString(),["allowSignInPrompt"]:ee.toString(),["hasAddinAuthChallenge"]:wh.toString(),["securityOriginEqualsSourceLocation"]:dl.toString(),["singleSignOnEnabled"]:De.toString(),["accountTypeFilter"]:Af||""};f.ULS.sendTraceTag(51401115,344,50,"{0}",Sj);U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:N.a.Gw(Sj)}));Zg=!0;const Ei=u.AFrameworkApplication.ga.La("HostAuthType");switch(Af){case "aad":Zg="aad"===
Ei;break;case "msa":Zg="msa"===Ei;break;default:Zg=!Af||"noFilter"===Af}if(Zg){Af=null;if(De)for(const oj of this.Pmm)if(oj.s4m(eh)){Af=oj;break}Af?this.isSSOAddin(ma)?(De=!0,"omex"===Gh&&(De=!1),"spapp"===Gh||"spcatalog"===Gh?(f.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),Uc.HUb(dg,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):rd&&!De?(f.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),
Uc.HUb(dg,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(rd&&"exchange"===Gh&&(Wc=!1),this.kIi(ma,Sa,Zb,Gh,Wc,ee,mg,Af,dg))):(f.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),Uc.HUb(dg,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):Uc.HUb(dg,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else Uc.HUb(dg,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(wh){this.Ylh(),
f.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",wh.message),Uc.HUb(dg,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(ma,Sa,Zb,Wc){this.lIi(ma,Zb[F.a.Maf]||null,Zb[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,Zb[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,Zb[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,Zb[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||
!1,Sa,Zb[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,Zb[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,Wc)}kIi(ma,Sa,Zb,Wc,rd,ee,De,Af,mg){this.gwe.Ob(ma)?Wc=this.gwe.ha(ma):(Wc=new pd(ma,this.getWebApplicationResource(ma).split(",")[0],Wc,this.getDefaultDisplayName(ma)),this.gwe.add(ma,Wc));const dg=Wc.resource;ma=te.nSm(dg,this.getWebApplicationId(ma));const Zg=OfficeExt.WACUtils.getHostSecure(Sa);ma&&Zg?ma.toLowerCase()===Zg.toLowerCase()?
Wc.kIi(rd,ee,Zb,De,Af,mg):(te.BWd('SSO Resource "'+dg+'" cannot be used from "'+Sa+'" origin due to domain mismatch.'),f.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),Uc.HUb(mg,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(ma||f.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Zg||f.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),Uc.HUb(mg,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,
null,null))}Ylh(){f.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(ma){return this.G7.getOsfControl(ma)}isSSOAddin(ma){return this.getOsfControl(ma).getManifest().isSSOAddin()}getWebApplicationId(ma){return this.getOsfControl(ma).getManifest().getWebApplicationId()}getWebApplicationResource(ma){return this.getOsfControl(ma).getManifest().getWebApplicationResource()}getDefaultDisplayName(ma){return this.getOsfControl(ma).getManifest().getDefaultDisplayName()}static SCe(){try{const ma=
{};be.a.$$a&&Od.a.ykb&&(ma.UiHostSupportsAuthTokenAddinList=te.n7c);ma.UiHostSupportsAuthToken=Od.a.ykb;return ma}catch(ma){f.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",ma.message)}return null}static getInstance(ma,Sa,Zb=null){te.Wa||(te.Wa=new te(ma,Zb));return te.Wa}static Xwm(ma){te.Wa&&te.Wa.removeCallbackForAddin(ma)}static BWd(ma){window.console.warn&&window.console.warn(ma)}static nSm(ma,Sa){if(!ma)return"";Sa||(Sa="");let Zb=ma.toLowerCase();
var Wc=Sa.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(Wc)||(te.BWd('SSO App Id "'+Sa+'" is not a valid format. It will be rejected from store submission.'),f.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));Zb.endsWith(Wc)||(te.BWd('SSO Resource "'+ma+'" does not end with App Id "'+Sa+'". It will be rejected from store submission.'),f.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!Zb.startsWith("https://")&&
!Zb.startsWith("api://"))return te.BWd('SSO Resource "'+ma+'" must be https:// or api:// protocol.'),f.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(Sa=0;Sa<ma.length;Sa++){Wc=ma.charAt(Sa);const rd=V.a.charCodeAt(ma,Sa);if(33>rd||126<rd||"&"===Wc||"?"===Wc||"#"===Wc||"%"===Wc||"\\"===Wc)return te.BWd('SSO Resource "'+ma+'" contains an invalid character "'+Wc+'".'),f.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+Wc+"' in resource URI."),""}if(0<=ma.indexOf("::"))return te.BWd('SSO Resource "'+
ma+'" contains an invalid string "::".'),f.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<ma.length)return te.BWd('SSO Resource "'+ma+'" is '+ma.length+" characters and exceeds the max length of 120 characters."),f.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+ma.length+"."),"";Zb.startsWith("api://")&&(Zb="https://"+Zb.substring(6,Zb.length));return 8===Zb.length?"":OfficeExt.WACUtils.getHostSecure(Zb)||""}}te.n7c="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");
te.Wa=null;Object(c.a)(te,"AppsForOfficeSingleSignOnManager",null,[260]);var Le=a(1154);class kf{}kf.GKm="generalException";kf.invalidArgument="invalidArgument";kf.cnn="notAllowed";kf.Xrm="apiNotAvailable";kf.QWn="unresolvedPendingRequest";kf.timeout="timeout";kf.yXh="adalTimeout";kf.zZn="userNotSignedIn";kf.Vzh="userAborted";kf.t5l="silentSignInFailed";kf.Xjh="invalidResourceUrl";kf.jBl="invalidGrant";kf.cll="connectionLost";kf.igi="clientError";kf.Kqa="serverError";Object(c.a)(kf,"WopiHostErrorCodes",
null,[]);class fg{}Object(c.a)(fg,"OAuthCallerMetadata",null,[]);class pe{constructor(ma){this.jta=ma;this.qhm=u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}Anm(ma,Sa,Zb,Wc,rd,ee){if(!this.jta)return Wc=new qb,Wc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(Wc);const De=new fg;De.AddinName=rd;De.AddinTrustId=ee;let Af=-1;ee=null;if(Wc&&this.DCl())ee=this.jta.kUk(F.a.iOe,ma,Wc,pe.ewl(rd),De);else{const mg=
Date.now();ee=this.jta.qN(F.a.iOe,ma,De).then(dg=>{Af=Date.now()-mg;const Zg=(Sa||Zb)&&("login_required"===dg.ErrorCode||"Cookies Disabled"===dg.ErrorCode);return(Sa&&("interaction_required"===dg.ErrorCode||"consent_required"===dg.ErrorCode||"invalid_grant"===dg.ErrorCode||"UserInteractionRequired"===dg.ErrorCode)||Zg)&&this.DCl()?this.jta.kUk(F.a.iOe,ma,null,pe.ewl(rd),De):Promise.resolve(dg)})}return ee.then(mg=>{const dg=new qb;mg.IsSuccess?(dg.token=mg.Token,mg.Telemetry&&(dg.tse=mg.Telemetry.fromCache,
dg.expiresOn=mg.Telemetry.expiresOn)):(dg.errorCode=this.yfn(mg),dg.sPk=this.cun(mg));return dg}).catch(()=>{const mg=new qb;mg.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(mg)}).then(mg=>{mg.Onc="OauthManager";0<=Af&&(mg.eIf=Af);return mg})}s4m(ma){const Sa=(u.AFrameworkApplication.ga.La(u.AFrameworkApplication.QI)||"").toLowerCase();return(u.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.Enable3rdPartySsoApiForTeams")||
!(be.a.$$a||"teams"===Sa&&Od.a.ykb)||pe.o4m(ma))&&this.jta&&this.jta.LBl()?!0:!1}DCl(){return this.qhm||1!==Le.a.pGd()}yfn(ma){switch(ma.ErrorCode){case "UserCancelled":case "interaction_required":ma=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "UserInteractionRequired":case "consent_required":case "invalid_grant":ma=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":ma=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":ma=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":ma=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":ma=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:ma=ma.ErrorCode===kf.Vzh?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:ma.ErrorCode===kf.t5l?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:ma.ErrorCode===kf.Xjh?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:ma.ErrorCode===
kf.jBl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:ma.ErrorCode===kf.cll?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return ma}cun(ma){let Sa="";(ma=RegExp("AADSTS(\\d+)").exec(ma.ErrorMessage))&&1<ma.length&&(Sa=ma[1]);return Sa}static ewl(ma){return String.format(Object(v.a)("SSOSignInNeededNotification_Description_Text_Addins"),ma)}static o4m(ma){if(!ma)return!1;ma=ma.toLowerCase();for(const Sa of te.n7c)if(Sa===ma)return!0;
return!1}}Object(c.a)(pe,"AppsforOfficeTokenFromOauthManager",null,[243]);class me{constructor(ma){this.Oen=ma}static M0g(){if(u.AFrameworkApplication.ga.getBooleanAppSetting("AppForOfficeSSOV2IsEnabled")){var ma=null;try{ma=ia.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Sa){f.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Sa)}ma=new pe(ma);me.Wa=new me(ma)}}static getInstance(){me.I7k||(me.M0g(),me.I7k=!0);return me.Wa}}me.Wa=null;me.I7k=!1;Object(c.a)(me,"AppsForOfficeOauthManagerFactory",
null,[60]);class Ke{constructor(ma){const Sa=me.getInstance();this.Zbl=new te(ma,Sa)}getAccessTokenAsync(ma,Sa){return new Promise(Zb=>{const Wc=u.AFrameworkApplication.ga.getBooleanAppSetting(Oc.a.mze);this.Zbl.getAccessToken(ma,Wc,Sa,(rd,ee)=>{const De={};De.errorCode=rd;De.accessToken=ee?ee.accessToken:"";Zb(De)})})}removeCallbackForAddin(ma){this.Zbl.removeCallbackForAddin(ma)}}Object(c.a)(Ke,"AppForOfficeAuthProvider",null,[929]);class Ie{fml(ma){return new Ke(ma)}}Object(c.a)(Ie,"AppForOfficeAuthFactory",
null,[878]);var Ef=a(400),We=a(278),Ae=a(268),se=a(858);class pf{constructor(ma,Sa,Zb,Wc,rd,ee,De){this.UOj=this.TOj=this.KKj=this.JKj=0;this.IKl=.5;this.WGe=null;this.pFj=0;this.Tan={};this.wdg=document.createElement("div");this.wdg.className="OsfAddinOverlay";Sa.appendChild(this.wdg);Zb.q2l(this.wdg,!0);this.hfn=ma;this.LH=De;this.LH.X9b(Object(r.a)(this,this.LQc,"onZoomed"));this.va=Wc;this.Lc=rd;this.Nq=ee;this.Nq.Fea(Object(r.a)(this,this.Zlk,"registerSlideViewElementEvents"))}dispose(){this.LH.Qdc(Object(r.a)(this,
this.LQc,"onZoomed"));this.Nq.b6a(Object(r.a)(this,this.Zlk,"registerSlideViewElementEvents"))}initialize(){if(this.va.Ga){this.Zlk(null,null);const ma=this.Lc.Yc;ma&&(this.JKj=parseFloat(ma.yM.style.left),this.KKj=parseFloat(ma.yM.style.top),this.TOj=parseFloat(ma.Yd.ta.style.left),this.UOj=parseFloat(ma.Yd.ta.style.top))}this.rYk();this.LQc(null,new se.a(this.hfn.zoom))}Zlk(ma,Sa){(ma=this.Lc.Yc)&&ma!==this.WGe&&(ma.yfl(Object(r.a)(this,this.P9l,"updateOffsetFromSlideView")),ma.hfl(Object(r.a)(this,
this.O9l,"updateOffsetFromPageContentContainer")),this.WGe&&(this.WGe.zZl(Object(r.a)(this,this.P9l,"updateOffsetFromSlideView")),this.WGe.lZl(Object(r.a)(this,this.O9l,"updateOffsetFromPageContentContainer")),this.BNk(this.WGe,!1)),Sa&&Sa.O9c&&1!==this.pFj&&this.BNk(ma,!0),this.WGe=ma)}BNk(ma,Sa){if(ma&&(ma=ma.zd)&&ma.isConnected){var Zb=ma.xj();if(Zb&&Zb.length)for(const rd of Zb)if(rd.ht){Zb=rd.oa(za.a.I4,null);var Wc=We.a.Yq(ma.gb(za.a.sid),ma.gb(za.a.cid)).toString();const ee=rd.get_shapeId().toString();
Zb=Zb+ee+Wc;cd.a("Microsoft.Office.SharedOnline.FixBug6808089")?(Wc=rd.Qg(0),(null===Wc||void 0===Wc?0:Wc.ta)?this.mec(Zb,Sa,Wc.ta.We):this.mec(Zb,Sa,null)):this.mec(Zb,Sa,null)}}}Hka(ma){this.pFj=ma;const Sa=this.Lc.Yc;Sa?(f.ULS.sendTraceTag(512369926,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: Hide the addin container on active slide('{0}#{1}').",Sa.zd.sid,Sa.zd.cid),this.BNk(Sa,2===ma)):f.ULS.sendTraceTag(512369925,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: SlideViewElement is null.")}O9l(ma,
Sa){this.JKj=Sa.x;this.KKj=Sa.y;this.rYk()}P9l(ma,Sa){this.TOj=Sa.x;this.UOj=Sa.y;this.rYk()}rYk(){this.wdg.style.left=Ae.a.Uc(this.JKj+this.TOj+Ef.a.eI-this.IKl);this.wdg.style.top=Ae.a.Uc(this.KKj+this.UOj+Ef.a.eI-this.IKl)}C3m(ma){return ma in this.l$b}VIn(ma,Sa){this.l$b[ma]=Sa}mec(ma,Sa,Zb){1===this.pFj&&Sa||ma in this.l$b&&this.l$b[ma].mec(Sa,Zb)}nYl(ma){ma in this.l$b&&(this.l$b[ma].dispose(),delete this.l$b[ma])}Vvh(ma,Sa){ma in this.l$b&&this.l$b[ma].Vvh(Sa)}LQc(){}get l$b(){return this.Tan}}
Object(c.a)(pf,"AppForOfficeContentAppsContainer",null,[909,24]);var eg=a(98);class pg extends n.a{constructor(ma,Sa){super();this.jgm=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.zhm=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.Ahm=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.Vgm=ma;this.Pgc=Sa}showDialog(ma,Sa){const Zb=new Zc.a(void 0,void 0,!1);Zb.gf=0;Zb.uk=eg.a.Kth(Number.MAX_VALUE).toString();Zb.Bl=String.format("<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",
Sa,this.Ahm,this.zhm,this.jgm);Zb.Dq(ma,Object(r.a)(this,this.Bon,"onCheckboxExecute$4"),{optInCheckbox:!1})}Bon(ma,Sa){1===ma&&Sa.optInCheckbox&&(m.a.instance.getItem("optedIntoAddinDeveloperMode")?m.a.instance.removeItem("optedIntoAddinDeveloperMode"):(m.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.e7b()))}e7b(){const ma=new n.a;ma.gf=4;const Sa=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,
this.Vgm)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;ma.m7(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,Sa,this.Pgc)}}Object(c.a)(pg,"AppForOfficeDeveloperModeOptInDialog",n.a,[]);const ne=ma=>{const Sa=[];if(!ma)return Sa;Sa[OSF.DDA.Marshaling.ThemingKeys.Accent1]=sf(ma.Accent1);Sa[OSF.DDA.Marshaling.ThemingKeys.Accent2]=sf(ma.Accent2);Sa[OSF.DDA.Marshaling.ThemingKeys.Accent3]=sf(ma.Accent3);Sa[OSF.DDA.Marshaling.ThemingKeys.Accent4]=sf(ma.Accent4);Sa[OSF.DDA.Marshaling.ThemingKeys.Accent5]=
sf(ma.Accent5);Sa[OSF.DDA.Marshaling.ThemingKeys.Accent6]=sf(ma.Accent6);Sa[OSF.DDA.Marshaling.ThemingKeys.Background1]=sf(ma.OsfColorScheme?ma.OsfColorScheme.Background1:null);Sa[OSF.DDA.Marshaling.ThemingKeys.Background2]=sf(ma.OsfColorScheme?ma.OsfColorScheme.Background2:null);Sa[OSF.DDA.Marshaling.ThemingKeys.Text1]=sf(ma.OsfColorScheme?ma.OsfColorScheme.Text1:null);Sa[OSF.DDA.Marshaling.ThemingKeys.Text2]=sf(ma.OsfColorScheme?ma.OsfColorScheme.Text2:null);Sa[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=
sf(ma.Hyperlink);Sa[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=sf(ma.FollowedHyperlink);const Zb=ma.OsfFontScheme;Zb&&(Sa[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=Zb.HdEaFt,Sa[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=Zb.HdLtnFt,Sa[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=Zb.HdLclFt,Sa[OSF.DDA.Marshaling.ThemingKeys.HdScript]=Zb.HdSptFt,Sa[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=Zb.BdEaFt,Sa[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=Zb.BdLtnFt,Sa[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=
Zb.BdLclFt,Sa[OSF.DDA.Marshaling.ThemingKeys.BdScript]=Zb.BdSptFt);Sa[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=sf(ma.Background);return Sa},sf=ma=>{if(!ma)return null;let Sa;Sa=ma.b;Sa+=ma.g<<8;return Sa+=ma.r<<16};class Ye{constructor(ma,Sa,Zb){this.LKl=ma;this.Jya=Sa;this.Rbn=Zb}register(){this.LKl.Am(Object(r.a)(this,this.B7l,"themeChangedCallback"))}dispose(){this.LKl.Pq(Object(r.a)(this,this.B7l,"themeChangedCallback"))}B7l(ma,Sa){if(Sa.node.Ra(za.a.Oe)&&(Sa.property===za.a.Oe||Sa.property===
za.a.yda)){ma=Sa.node;try{var Zb=ne(ma?ma.Oe:null)}catch(Wc){return}if(ma){ma=ma.xj();for(const Wc of ma)Wc.ht&&(ma=this.Rbn.FIa(Wc),this.Jya.idd(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),ma.id,Zb))}this.Jya.FWl(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),Zb)}}}Object(c.a)(Ye,"AppForOfficeDocumentThemeListener",null,[900,24]);var Yd=a(85);class Lg extends Zc.a{constructor(ma,Sa,Zb){super();this.O9b=null;this.oVh="WACDialogTitleText";this.Eyb="0";this.w9b="15px";
this.zgm="0px";this.Dyb="calc(100% - 30px)";this.ygm="100%";this.Qal=0;this.kb=new B.a;this.ofm=new z;this.gf=5;this.uk=this.$Ve=Zb;this.AHh=ma;this.K5k=Sa;this.dIh=!!u.AFrameworkApplication.ga&&u.AFrameworkApplication.ga.getBooleanAppSetting("OfficeAddinEnableInsertDialogAccessibilityFix")}jqm(ma){this.kb.addHandler("OnDialogClosedEventKey",ma)}pMn(){this.Pyb=null}hL(){super.hL();this.LB.style.width="100%";this.LB.style.height=this.XLf?this.Dyb:this.ygm;this.LB.style.marginTop=this.XLf?this.w9b:
this.zgm;this.LB.style.padding=this.Eyb}n7(){super.n7();this.Ed.style.width=String.format("{0}px",this.AHh*window.innerWidth/100);this.Ed.style.height=String.format("{0}px",this.K5k*window.innerHeight/100);this.Ed.style.minWidth="0px";this.dIh&&u.AFrameworkApplication.isRtl&&100===this.AHh&&(this.Ed.style.right="0px",this.Ed.style.marginRight="0px");this.O9b=document.getElementById(this.ap(this.oVh));this.O9b.style.position="absolute";this.O9b.style.whiteSpace="nowrap";this.O9b.style.textOverflow=
"ellipsis";u.AFrameworkApplication.isRtl?(this.O9b.style.right="14px",this.O9b.style.left="44px"):(this.O9b.style.right="44px",this.O9b.style.left="14px")}oec(ma){super.oec(ma);this.O9b&&this.O9b.setAttribute("title",ma)}get kNb(){return this.LB}zrk(){this.Ed.style.width=String.format("{0}px",this.AHh*window.innerWidth/100);this.Ed.style.height=String.format("{0}px",this.K5k*window.innerHeight/100);this.Ed.style.overflowY="hidden";this.Ed.style.overflowX="hidden";this.Ed.style.marginTop="";this.Ed.style.top=
"";be.a.WSb&&u.AFrameworkApplication.isRtl?(this.Ed.style.right="",this.Ed.style.marginRight=""):(this.Ed.style.left="",this.Ed.style.marginLeft="")}hide(){this.ofm.Xll(3,this.$Ve).execute(this,A.getInstance(),{});this.Qal=window.setTimeout(()=>{this.kb.raiseEvent("OnDialogClosedEventKey",this.$Ve);Yd.a.prototype.hide.call(this)},500)}JQl(ma){3===ma&&(window.clearTimeout(this.Qal),this.kb.raiseEvent("OnDialogClosedEventKey",this.$Ve),super.hide())}}Object(c.a)(Lg,"AppsForOfficeDialog",Zc.a,[244,245]);
class Yg{constructor(){this.dialog=this.uk=null}}Object(c.a)(Yg,"DialogInfo",null,[]);class Ng{}Ng.url="url";Ng.height="height";Ng.width="width";Ng.zvi="displayInIframe";Ng.ijh="hideTitle";Object(c.a)(Ng,"DialogSettings",null,[]);class df{constructor(){this.height=this.width=0;this.uk=this.controlId=this.pageUrl=null;this.ijh=this.zvi=!1}}Object(c.a)(df,"DisplayDialogParams",null,[]);class Pg extends Sys.EventArgs{constructor(ma,Sa,Zb=null,Wc="",rd=""){super();this.controlId=ma;this.messageType=Sa;
this.messageContent=Zb;this.gUj=Wc;this.acb=rd}}Object(c.a)(Pg,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class ig extends Sys.EventArgs{constructor(ma,Sa,Zb=null,Wc="",rd=""){super();this.controlId=ma;this.messageType=Sa;this.messageContent=Zb;this.gUj=Wc;this.acb=rd}}Object(c.a)(ig,"OnMessageParentEventArgs",Sys.EventArgs,[]);var ji=a(83);class Ca{constructor(ma){this.kb=new B.a;this.gpn=(Sa,Zb)=>{if(Sa=this.qPb(Zb))this.G7.purgeDialogControl(Zb),Ca.r9b.remove(Sa),this.kb.raiseEvent("OnMessageParentEventKey",
new ig(Sa,OSF.DialogMessageType.DialogClosed,null,null,"*"))};this.G7=ma}oqm(ma){this.kb.addHandler("OnMessageParentEventKey",ma)}aZl(ma){this.kb.removeHandler("OnMessageParentEventKey",ma)}nqm(ma){this.kb.addHandler("OnMessageDialogEventKey",ma)}dGn(ma){this.kb.removeHandler("OnMessageDialogEventKey",ma)}showDialog(ma,Sa,Zb,Wc){if(Ca.r9b.Ob(Sa))f.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Zb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{const Zg=P.b(ma),Gh=Zg[Ng.url];if(this.G7.getOsfControl(Sa).checkAppDomains(Gh)){var rd=new df;rd.width=Zg[Ng.width];rd.height=Zg[Ng.height];rd.pageUrl=Gh;rd.zvi=Zg[Ng.zvi];rd.ijh=Zg[Ng.ijh];rd.controlId=Sa;rd.uk=ji.a.create().toString();var ee=new Yg;ee.uk=rd.uk;var De=this.G7.getOsfControl(rd.controlId).getManifest().getDefaultDisplayName(),Af=this.G7.getOsfControl(rd.controlId).getStoreType().toLowerCase();ma=null;ma=(4===u.AFrameworkApplication.Ea.Kb.Im&&"hardcodedpreinstall"===Af||"sdxcatalog"===
Af)&&rd.ijh?this.createAndShowAppsForOfficeDialog(rd.width,rd.height,rd.uk,!0,De):this.createAndShowAppsForOfficeDialog(rd.width,rd.height,rd.uk,!1,De);var mg=this.G7.getOsfControl(rd.controlId),dg=mg.getManifest();Sa={};Sa.id=rd.uk;Sa.solutionId=mg.getSolutionId();Sa.version=mg.getVersion();Sa.storeType=Af;Sa.storeId=mg.getStoreId();Sa.assetId=mg.getAssetId();Sa.assetStoreId=mg.getAssetStoreId();Sa.ownerAddinSolutionId=mg.getOwnerAddinSolutionId();Sa.ownerAddinStoreType=mg.getOwnerAddinStoreType();
Sa.appDomains=dg.getAppDomains();Sa.dialogUrl=Gh;Sa.osfControlType=1;Sa.agaveName=De;Sa.div=ma.kNb;f.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa.solutionId,Sa.ownerAddinStoreType||Sa.storeType,Sa.assetId,null,null,Sa.storeId),V.a.DV(rd.pageUrl));this.G7.insertDialogControl(Sa);ma.jqm(this.gpn);ee.dialog=ma;Ca.r9b.K(rd.controlId,ee);Wc&&Wc(Sa);Zb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else f.ULS.sendTraceTag(19940611,
344,10,"ShowDialog: dialog url not in app domains list."),Zb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Zg){f.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Zg.message),Zb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}pgn(ma,Sa,Zb,Wc){u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Wc&&(Wc=Zb);try{const rd=this.qPb(ma);rd&&this.kb.raiseEvent("OnMessageParentEventKey",
new ig(rd,OSF.DialogMessageType.DialogMessageReceived,Sa,Zb,Wc))}catch(rd){return f.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",rd.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}fym(ma,Sa){if(Ca.r9b.Ob(ma))try{const Zb=Ca.r9b.ha(ma);Zb.dialog&&Zb.dialog.hide();this.G7.purgeDialogControl(Zb.uk);Ca.r9b.remove(ma);Sa(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Zb){f.ULS.sendTraceTag(18371106,
344,10,"CloseDialog: action failed. Exception message: {0}",Zb.message),Sa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else f.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Sa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gKn(ma,Sa,Zb,Wc){u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Wc&&(Wc=Zb);if(Ca.r9b.Ob(ma)&&(ma=Ca.r9b.ha(ma),ma.dialog))try{this.kb.raiseEvent("OnMessageDialogEventKey",
new Pg(ma.uk,OSF.DialogMessageType.DialogParentMessageReceived,Sa,Zb,Wc))}catch(rd){f.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",rd.message)}}qPb(ma){let Sa=null;for(const Zb of Ca.r9b)if(Zb.value.uk===ma){Sa=Zb.key;break}return Sa}createAndShowAppsForOfficeDialog(ma,Sa,Zb,Wc,rd){ma=new Lg(ma,Sa,Zb);rd=Wc?"":String.format(Object(v.a)("ShowDialogApiInlineDialogTitle"),rd);Wc&&(ma.XLf=!1,ma.zz=!1);ma.Dq(rd,null,null);ma.pMn();return ma}static Fxl(){return Ca.r9b}static getInstance(ma){Ca.Wa||
(Ca.Wa=new Ca(ma));return Ca.Wa}}Ca.Wa=null;Ca.r9b=new Mb.a;Object(c.a)(Ca,"AppsForOfficeDialogManager",null,[58]);var cb=a(898),Eb=a(3),fc=a(349),Ec=a(62),Ya=a(28),Ub=a(323);class rc extends Sys.EventArgs{constructor(ma){super();this.o9a=ma}}Object(c.a)(rc,"AppForOfficeFocusOnAddinPaneEventArgs",Sys.EventArgs,[]);var fd=a(267);class Cd{constructor(ma,Sa,Zb,Wc,rd,ee){this.FEa=[];this.xRj=new cb.a;this.Ma=Sa;this.jA=Zb;this.ob=Wc;this.Hd=rd;this.Ge=ee}get l9a(){return this.FEa}get Tc(){return this.Hd.value}pLf(){return 0<
this.qvg}F9(ma){ma&&(this.l9a.push(ma),1===this.qvg&&this.Ma.lm(Ub.a.sch,!0),ma.isVisible&&this.jA.addHandler(ma.ta,Eb.a.Lj,Object(r.a)(this,this.Hyl,"handleShortCutsOnAddinPane")))}Cnk(ma){ma&&(Array.remove(this.FEa,ma),this.jA.removeHandler(ma.ta,Eb.a.Lj,Object(r.a)(this,this.Hyl,"handleShortCutsOnAddinPane")),this.qvg||this.Ma.lm(Ub.a.sch,!1))}Hka(ma){if(1===ma||2===ma){if(1===ma){this.xRj=new cb.a;for(const Sa of this.l9a)Sa.isVisible&&this.xRj.add(Sa.id.toLowerCase())}ma=2===ma;for(const Sa of this.l9a)this.xRj.contains(Sa.id.toLowerCase())&&
(Sa.wA(ma),(ma&&1===this.qvg||!ma&&!this.qvg)&&this.Ma.lm(Ub.a.sch,ma))}}CWm(ma,Sa){for(const Zb of this.FEa)ma=Zb.layout(ma,Sa)}fia(ma,Sa){if(ma){ma=null;if(Sa===fd.a.kh)for(Sa=this.FEa.length-1;0<=Sa;Sa--){if(this.FEa[Sa].isVisible){ma=this.FEa[Sa];break}}else if(Sa===Ub.a.tch||Sa===Ub.a.til||Sa===fc.AFrame.Z2||Sa===fc.AFrame.r7c||Sa===Ub.a.lsa||Sa===Ub.a.uil||Sa===fd.a.LI||Sa===fd.a.VK||Sa===fd.a.TZ)for(Sa=0;Sa<this.FEa.length;Sa++)if(this.FEa[Sa].isVisible){ma=this.FEa[Sa];break}this.aGi(ma)}}aGi(ma){if(ma){var Sa=
this.Tc.VBe(ma.id);Sa&&this.Ge.AWl(new rc(Sa.o9a));this.Tc.notifyAgave(ma.id,11)}else f.ULS.sendTraceTag(508891138,806,10,"Focus could not be put on the null addin pane!")}QJm(ma,Sa){var Zb;for(Zb=0;Zb<this.FEa.length&&this.FEa[Zb].id!==ma;Zb++);if(Zb===this.FEa.length)f.ULS.sendTraceTag(508891137,806,10,String.format("Failed to find the taskpane with instance id: {0}",ma)),this.YSk(Sa);else{ma=null;if(5===Sa)for(--Zb;0<=Zb;Zb--){if(this.FEa[Zb].isVisible){ma=this.FEa[Zb];break}}else if(6===Sa)for(Zb+=
1;Zb<this.FEa.length;Zb++)if(this.FEa[Zb].isVisible){ma=this.FEa[Zb];break}ma?this.aGi(ma):this.YSk(Sa)}}wsl(ma){for(const Sa of this.FEa)if(Sa.id===ma){Ec.FocusManager.UA(Sa.iym);return}f.ULS.sendTraceTag(508891136,806,10,String.format("Failed to focus on addinpane's the close button with instance id: {0}",ma))}SVn(ma){for(const Sa of Ca.Fxl())if(Sa.value.uk.toLowerCase()===ma.toLowerCase())return Sa.value.dialog.hide(),Sa.key;return null}YSk(ma){5===ma?this.Ma.xAb(!1):6===ma&&this.Ma.xAb(!0)}Lql(){const ma=
this.ob.ud();ma&&1===ma.length&&(this.ob.selectShape(ma[0],!0),this.Ma.Wd())}get qvg(){let ma=0;for(const Sa of this.l9a)Sa.isVisible&&ma++;return ma}Hyl(ma){if(ma.keyCode===Ya.a.zda&&ma.ctrlKey)for(var Sa=0;Sa<this.l9a.length;Sa++){var Zb=this.l9a[Sa];if(Zb.isVisible&&Zb.ta.contains(ma.target)){Zb=null;if(ma.shiftKey)for(Sa+=1;Sa<this.l9a.length;Sa++){if(this.l9a[Sa].isVisible){Zb=this.l9a[Sa];break}}else for(--Sa;0<=Sa;Sa--)if(this.l9a[Sa].isVisible){Zb=this.l9a[Sa];break}Zb&&(this.aGi(Zb),ma.preventDefault(),
ma.stopPropagation());break}}}gh(ma){this.Ma.gh(ma)}}Object(c.a)(Cd,"AppForOfficeFocusManager",null,[908]);var Jd=a(894);class Rd{wAm(ma,Sa,Zb){ma=Jd.a.UCe(ma.gCb);ma.appName=OSF.AppName.PowerpointWebApp;ma.clientMode=1;ma.formFactor="DefaultSettings";ma.hostControl=Sa;Sa=ia.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager");ma.allowExternalMarketplace&&(ma.allowExternalMarketplace=Sa.plf);ma.enableUploadFileDevCatalog&&(ma.enableUploadFileDevCatalog=Sa.h_k);Zb.register(ma);Zb=new OSF.ContextActivationManager(ma);
Zb.setWSA(u.AFrameworkApplication.Hl);return Zb}}Object(c.a)(Rd,"AppForOfficeImportedClassFactory",null,[907]);class Me{constructor(ma){this.DGl=ma}cJg(){for(const ma of this.DGl)ma.register()}dispose(){for(const ma of this.DGl)ma.dispose()}}Object(c.a)(Me,"AppForOfficeListenerManager",null,[906,24]);var lf=a(1584),yf=a(233),ff=a(175),jf=a(702);class Nf{constructor(){this.releaseDate=this.diffAUP=this.AUP=this.priority=0}}Object(c.a)(Nf,"AddinDetailInfo",null,[]);class og{constructor(ma){this.solutionIds=
null;this.errorCode=0;this.failure=null;this.Wgb=ma}}Object(c.a)(og,"AddinCollection",null,[]);class Tg extends Sys.EventArgs{constructor(ma,Sa,Zb,Wc=null){super();this.IZ=ma;this.errorCode=Sa;this.qp=Zb;this.failure=Wc}}Object(c.a)(Tg,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class Ce{constructor(ma){this.errorCode=ma;this.qp=[];this.failure=null}}Object(c.a)(Ce,"GetAddinDetailsResult",null,[]);var vf=a(896);class Eg{}Object(c.a)(Eg,"GetEntitlementDetailsParameters",null,[]);var hf=a(176),
Qh=a(52);class hi{constructor(ma,Sa,Zb=null){this.kb=new B.a;this.qE=new lf.a(yf.a.Wn());this.pE=new ff.a;this.Wra=0;this.lpd=null;this.Zbd=(Wc,rd,ee)=>{if(ee)if(this.fZf(Wc,ee,window.performance.now()-rd),0===ee.errorCode){let Af;if(ee.value){let mg=0;Af=Array(ee.value.length);ee.value.forEach(dg=>{Af[mg++]=dg})}else Af=[];this.y8(Wc,Af)}else if(-1===ee.errorCode||10===ee.errorCode)this.y8(Wc,[]);else{var De={};De.collectionType=jf.a[Wc];De.invokeResultCode=ee.errorCode;De["queryResult.Value"]=ee.value?
String.format("Length: {0}",ee.value.length):"null";De.queryStart=rd;De.queryDuration=window.performance.now()-rd;this.pE.K(Wc,Object.assign(new og(Wc),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",De)}));f.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",jf.a[Wc],this.pE.ha(Wc).failure.toString(),JSON.stringify(this.pE.ha(Wc).failure))}else De={},De.collectionType=
jf.a[Wc],De.queryResult=ee?"not null":"null",De.queryStart=rd,De.queryDuration=window.performance.now()-rd,this.pE.K(Wc,Object.assign(new og(Wc),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",De)})),f.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",jf.a[Wc],this.pE.ha(Wc).failure.toString(),JSON.stringify(this.pE.ha(Wc).failure))};this.cia=(Wc,rd)=>{Wc=Object.assign(new og(rd.IZ),
{solutionIds:new b.a});var ee=rd.qp;for(const De of ee)ee=De.solutionId,this.qE.Ob(ee)?this.qE.K(ee,this.ctg(this.qE.ha(ee),rd.IZ,De)):this.qE.add(ee,De),Wc.solutionIds.add(ee);this.pE.K(rd.IZ,Wc)};this.cfb=new hf.a;this.cfb.add(OSF.StoreTypeEnum.MarketPlace,0);this.cfb.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ba=ma;this.G7=Sa;this.U2=Zb;this.BZe=hi.ADf(ma,"https://store-images.s-microsoft.com");this.A4c(this.cia)}get hZf(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get ORf(){return this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get nq(){return this.G7.value}sC(ma){if(!this.mSb(ma))return ma=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:jf.a[ma]}),Object.assign(new Ce(1),{failure:ma});if(this.pE.ha(ma).failure)return Object.assign(new Ce(this.pE.ha(ma).errorCode),{failure:this.pE.ha(ma).failure});f.ULS.shipAssertTag(509870082,220,!!this.pE.ha(ma).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",ma);const Sa=new Ce(0);for(const Zb of this.pE.ha(ma).solutionIds)this.qE.Ob(Zb)&&
Array.add(Sa.qp,this.qE.ha(Zb));return Sa}getUpgradedAddinsOfOmex(){return this.nq.getUpgradedAddinsOfOmex()}D0(ma){return this.qE.Ob(ma)?this.qE.ha(ma):null}ybb(ma){if(ma){this.A4c(ma);for(const Zb of this.pE.keys)if(this.mSb(Zb)&&!this.pE.ha(Zb).failure){f.ULS.shipAssertTag(509870081,220,!!this.pE.ha(Zb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Zb);var Sa=[];for(const Wc of this.pE.ha(Zb).solutionIds)Array.add(Sa,this.qE.ha(Wc));Sa=new Tg(Zb,
this.pE.ha(Zb).errorCode,Sa);ma(null,Sa)}}}get name(){return"AddinDetailsManager"}hje(){}tka(ma,Sa=!1){0!==ma&&10!==ma?f.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",vf.a[ma]):this.zGg(ma,this.Zbd,Sa)}A4c(ma){this.kb.addHandler(F.a.bud,ma)}N5i(ma){const Sa={};Sa.collectionType=jf.a[ma];this.pE.K(ma,Object.assign(new og(ma),{errorCode:2,failure:Error.create("The store is disabled.",Sa)}));f.ULS.sendTraceTag(510253056,220,50,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",
jf.a[ma],this.pE.ha(ma).failure.toString(),JSON.stringify(this.pE.ha(ma).failure))}oGk(){return this.mSb(2)?this.Ba.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.pE.ha(2).failure:!1:!0}zGg(ma,Sa,Zb=!1){f.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",ma);ma!==OSF.StoreTypeEnum.MarketPlace&&ma!==OSF.StoreTypeEnum.PrivateCatalog?f.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",ma):(this.oGk()&&this.queryStoreDisabled(0,
(Wc,rd)=>{rd?this.N5i(2):(Wc=window.performance.now(),Sa(2,Wc,this.FRm()))}),this.queryStoreDisabled(ma,(Wc,rd)=>{if(Wc===OSF.StoreTypeEnum.MarketPlace&&rd)this.N5i(0);else if(Wc===OSF.StoreTypeEnum.PrivateCatalog&&rd)this.N5i(1);else{var ee=window.performance.now();this.nq.getEntitlementDetails(Object.assign(new Eg,{storeType:Wc,refresh:Zb}),De=>{Sa(this.cfb.ha(Wc),ee,De)})}}))}y8(ma,Sa){ma=new Tg(ma,0,Sa);this.kb.raiseEvent(F.a.bud,ma)}mSb(ma){return this.pE.Ob(ma)?!!this.qE:!1}get pze(){return this.U2?
!this.U2.AreThirdPartyAddInsAllowed||this.U2.AppsForOfficeThirdPartyIsDisabled:!this.Ba.getBooleanAppSetting("AreThirdPartyAddInsAllowed")||this.Ba.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")}get WEe(){return this.U2?!this.U2.AppsForOfficeAllowExternalMarketplace:!this.Ba.getBooleanAppSetting("AppsForOfficeAllowExternalMarketplace")}get ycd(){return this.U2?this.U2.PopularAddinDetailsJsonString:this.Ba.La("PopularAddinDetailsJsonString")}queryStoreDisabled(ma,Sa){if(this.pze)Sa(ma,!0);
else if(ma===OSF.StoreTypeEnum.MarketPlace&&this.WEe)Sa(ma,!0);else{const Zb=hi.rOe(ma);if(Zb){const Wc=window.performance.now();this.nq.queryStoreDisabled(Zb,rd=>{f.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",ma,rd,Wc,window.performance.now()-Wc);Sa(ma,rd)})}else Sa(ma,!1)}}ctg(ma,Sa,Zb){return ma?Zb?2===Sa?hi.zbd(Zb,ma):hi.zbd(ma,Zb):ma:Zb}FRm(){if(!this.lpd){const ma=JSON.parse(this.ycd);this.Vxf(ma);this.lpd=ma}return hi.Kze(0,
this.lpd)}Vxf(ma){hi.fcf(ma);this.ize(ma);this.Wxf(ma)}ize(ma){const Sa=this.fff();for(var Zb=0;Zb<ma.length&&0<Sa.count;Zb++){const Wc=ma[Zb];if(Sa.Ob(Wc.solutionId)){let rd=String.format("Found an override, solutionId: {0}",Wc.solutionId);const ee=Sa.ha(Wc.solutionId);ee&&(isNaN(ee.addinInfo.priority)||(rd=String.format("{0}; AddinInfo.Priority: update {1} to {2}",rd,Wc.addinInfo.priority,ee.addinInfo.priority),Wc.addinInfo.priority=ee.addinInfo.priority),isNaN(ee.addinInfo.AUP)||(rd=String.format("{0}; AddinInfo.AUP: update {1} to {2}",
rd,Wc.addinInfo.AUP,ee.addinInfo.AUP),Wc.addinInfo.AUP=ee.addinInfo.AUP),ee.displayName&&(rd=String.format("{0}; DisplayName: update {1} to {2}",rd,Wc.displayName,ee.displayName),Wc.displayName=ee.displayName),ee.iconUrl&&(rd=String.format("{0}; IconUrl: update {1} to {2}",rd,Wc.iconUrl,ee.iconUrl),Wc.iconUrl=ee.iconUrl),ee.description&&(rd=String.format("{0}; Description: update {1} to {2}",rd,Wc.description,ee.description),Wc.description=ee.description));Sa.remove(Wc.solutionId);this.ORf&&f.ULS.sendTraceTag(509379136,
220,50,"ApplyOverridesToPopularAddinDetails: {0}.",rd)}}for(const Wc of Sa.keys)Zb=Sa.ha(Wc),Zb.displayName&&Zb.iconUrl&&Zb.addinInfo&&(ma.push(Zb),this.ORf&&f.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Zb)))}fff(){const ma=new lf.a(yf.a.Wn());let Sa=this.Ba.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Sa)return ma;Sa=Sa.trim();if(12>=Sa.length)return 0<Sa.length&&f.ULS.sendTraceTag(509379106,
220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Sa),ma;this.ORf&&f.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Sa);try{const Zb=[],Wc=Sa.split("|");for(let rd=Wc.length-1;0<=rd;rd--){const ee=Wc[rd],De=ee.split("\\");if(2>De.length){Zb.push(ee);continue}const Af=hi.FBg(De);Af?ma.Ob(Af.solutionId)||ma.add(Af.solutionId,Af):Zb.push(ee)}this.ORf&&0<Zb.length&&f.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",
Zb.join("|"));this.ORf&&0<ma.count&&f.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",ma.count,JSON.stringify(Qh.toArray(ma.values)));return ma}catch(Zb){f.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",Sa,Zb.toString())}return ma}Wxf(ma){for(let Sa=0;Sa<ma.length;Sa++)Lb.c(ma[Sa].iconUrl.toLowerCase(),"http",0)||(ma[Sa].iconUrl=String.format("{0}/image/apps.{1}",this.BZe,
ma[Sa].iconUrl))}gZf(ma,Sa,Zb){const Wc={};Wc.AddinCollectionType=jf.a[ma];Wc.ErrorCode=Sa.errorCode;Wc.AddinCount=Sa.value?Sa.value.length:0;ma=window.performance.now();Sa=Date.now()-u.AFrameworkApplication.S7;f.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",Zb,ma,Sa,JSON.stringify(Wc))}fZf(ma,Sa,Zb){this.hZf?(Zb={["AddinCollectionType"]:jf.a[ma],["ErrorCode"]:Sa.errorCode,["QueryDuration"]:Zb,
["FlyoutDataReadySinceBoot"]:Date.now()-u.AFrameworkApplication.S7},this.PRf(ma)&&f.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(Zb)),Zb.AddinCount=Sa.value?Sa.value.length:0,f.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(Zb))):this.gZf(ma,Sa,Zb)}PRf(ma){0===ma?this.Wra|=1:1===ma&&(this.Wra|=2);ma=this.Wra&131;if(ma=1===ma||2===ma)this.Wra=255;return ma}static Kze(ma,Sa){const Zb={};Zb.errorCode=ma;Zb.value=Sa;return Zb}static rOe(ma){return ma===OSF.StoreTypeEnum.MarketPlace?
"omex":ma===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static zbd(ma,Sa){Sa.solutionId=Sa.solutionId||ma.solutionId;Sa.version=Sa.version||ma.version;Sa.storeType=Sa.storeType||ma.storeType;Sa.storeId=Sa.storeId||ma.storeId;Sa.assetId=Sa.assetId||ma.assetId;Sa.assetStoreId=Sa.assetStoreId||ma.assetStoreId;Sa.displayName=Sa.displayName||ma.displayName;Sa.provider=Sa.provider||ma.provider;Sa.description=Sa.description||ma.description;Sa.iconUrl=Sa.iconUrl||ma.iconUrl;Sa.webApplicationId=Sa.webApplicationId||
ma.webApplicationId;Sa.highResolutionIconUrl=Sa.highResolutionIconUrl||ma.highResolutionIconUrl;Sa.licenseUrl=Sa.licenseUrl||ma.licenseUrl;Sa.privacyUrl=Sa.privacyUrl||ma.privacyUrl;Sa.addinInfo=Sa.addinInfo||ma.addinInfo;isNaN(Sa.targetType)&&(Sa.targetType=ma.targetType);isNaN(Sa.height)&&(Sa.height=ma.height);isNaN(Sa.width)&&(Sa.width=ma.width);return Sa}static fcf(ma){for(const Sa of ma)isNaN(Sa.targetType)&&(Sa.targetType=1),Sa.assetId=Sa.assetId||Sa.solutionId,Sa.storeId=Sa.storeId||"en-US",
Sa.storeType=Sa.storeType||"omex",Sa.assetStoreId=Sa.assetStoreId||"omex",isNaN(Sa.width)&&(Sa.width=0),isNaN(Sa.height)&&(Sa.height=0)}static FBg(ma){const Sa={};let Zb=0;Zb<ma.length&&0<ma[Zb].trim().length&&ma[Zb].trim().toLowerCase().startsWith("wa")&&(Sa.solutionId=ma[Zb].trim(),Sa.addinInfo=Object.assign(new Nf,{priority:Number.NaN,AUP:Number.NaN}),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.addinInfo.priority=parseInt(ma[Zb].trim())),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.addinInfo.AUP=
parseInt(ma[Zb].trim())),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.displayName=ma[Zb].trim()),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.iconUrl=ma[Zb].trim()),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.description=ma[Zb].trim()));return Sa.solutionId?Sa:null}static ADf(ma,Sa){ma=ma.La("AddinImageStoreServiceUrl");if(!ma)return Sa;ma=ma.toLowerCase();return ma.startsWith("http://")||ma.startsWith("https://")?ma:Sa}}Object(c.a)(hi,"AddinDetailsManager",null,[373,374]);class Vg{constructor(ma,Sa=
0){this.failure=null;this.Wgb=ma;this.errorCode=Sa}}Object(c.a)(Vg,"AddinQueryResult",null,[]);class uh extends Vg{constructor(ma,Sa=0){super(ma,Sa);this.solutionIds=null}}Object(c.a)(uh,"AddinCollection",Vg,[]);var Eh;(function(ma){ma[ma.stop=-1]="stop";ma[ma.skip=0]="skip";ma[ma.query=1]="query"})(Eh||(Eh={}));Object(c.b)("QueryStrategy",Eh);var Bh=a(597);class ag{constructor(ma){this.K4k=432E5;ma&&(this.K4k=36E5*ma.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutCacheExpiration",12))}GTm(ma){const Sa=
new Date;let Zb=new Date(-1);try{const Wc=ag.t8l(`${ma}_ExpirationTime`);Wc&&(Zb=new Date(parseInt(Wc,10)))}catch(Wc){f.ULS.sendTraceTag(508063829,220,50,`Failed to parse expiration time for add-in ${ma}: ${Wc}`)}if(Sa.getTime()<Zb.getTime()&&(ma=ag.t8l(`${ma}_StoreDisabled`)))return"true"===ma}fNn(ma,Sa){void 0!==Sa&&null!==Sa&&(ag.D8l(Sa.toString(),`${ma}_StoreDisabled`),ag.D8l(((new Date).getTime()+this.K4k).toString(),`${ma}_ExpirationTime`))}static t8l(ma){let Sa=null;try{const Zb=ag.BZg;if(void 0!==
Zb&&Zb){const Wc=F.a.Xuc("Flyout")+"_"+ma;Sa=Zb.getItem(Wc)}else f.ULS.sendTraceTag(508063828,220,50,"tryGetCache: Storage.Local null")}catch(Zb){f.ULS.sendTraceTag(508063827,220,10,"tryGetCache: Failed to get data Cache {0} for suffix {1}.","Flyout",ma)}return Sa}static D8l(ma,Sa){try{const Zb=ag.BZg;if(void 0!==Zb&&Zb){const Wc=F.a.Xuc("Flyout")+"_"+Sa;Zb.setItem(Wc,ma)}else f.ULS.sendTraceTag(508063826,220,50,"trySetCache: Storage.Local null")}catch(Zb){f.ULS.sendTraceTag(508063825,220,10,"trySetCache: Failed to set AddinCommands Cache {0} for suffix {1}.",
"Flyout",Sa)}}static get BZg(){if(!ag.pEa)return null;let ma=null;try{ma=localStorage}catch(Sa){ag.pEa=!1,ma=null,f.ULS.sendTraceTag(508063824,220,50,`Failed to use localStorage: error name: ${Sa.name}; message: ${Sa.message}; stack: ${Sa.stack}`)}return ma}}ag.pEa=!0;Object(c.a)(ag,"StoreDisabledCache",null,[]);class zf{constructor(ma,Sa,Zb=null){var Wc;this.kb=new B.a;this.qE=new lf.a(yf.a.Wn());this.pE=new ff.a;this.Wra=0;this.XWa=new ff.a;this.lpd=null;this.Zbd=(rd,ee,De)=>{if(De)if(this.fZf(rd,
De,window.performance.now()-ee),0===De.errorCode){let Af;if(De.value){let mg=0;Af=Array(De.value.length);De.value.forEach(dg=>{Af[mg++]=dg})}else Af=[];this.y8(new Vg(rd),Af)}else-1===De.errorCode||10===De.errorCode?this.y8(new Vg(rd),[]):(rd=this.K9h(rd,ee,De),this.y8(rd));else rd=zf.L9h(rd,ee),this.y8(rd)};this.cia=(rd,ee)=>{if(0!==ee.errorCode)this.pE.K(ee.IZ,Object.assign(new uh(ee.IZ,ee.errorCode),{failure:ee.failure})),this.ugn&&this.MCb(ee.IZ,1);else{rd=Object.assign(new uh(ee.IZ),{solutionIds:new b.a});
var De=ee.qp;for(const Af of De)De=Af.solutionId,this.qE.Ob(De)?this.qE.K(De,this.ctg(this.qE.ha(De),ee.IZ,Af)):this.qE.add(De,Af),rd.solutionIds.add(De);this.pE.K(ee.IZ,rd);this.MCb(rd.Wgb,1)}};this.cfb=new hf.a;this.cfb.add(OSF.StoreTypeEnum.MarketPlace,0);this.cfb.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ba=ma;this.G7=Sa;this.U2=Zb;this.BZe=zf.ADf(ma,"https://store-images.s-microsoft.com");this.A4c(this.cia);this.mcl=null!==(Wc=Zb.StoreDisabledCache)&&void 0!==Wc?Wc:new ag(ma)}get ugn(){return!!this.Ba&&
this.Ba.isChangeGateEnabled("MissRegisterCollectionTypeFixEnabled")}get jna(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get hZf(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get XJk(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8350408_SingleStoreDisabledQueryEnabled")}get OSn(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8352847_StoreDisabledCacheEnabled")}get isAnonymousUser(){return!!this.Ba&&
this.Ba.getBooleanAppSetting("IsAnonymousUser")}get ZFi(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get ZBe(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get EOb(){return this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get nq(){return this.G7.value}sC(ma){if(this.jna&&!this.uAc(ma))return new Ce(0);if(!this.mSb(ma))return ma=Error.create("AddinDetails is not ready yet",
{["errorCode"]:1,["collectionType"]:jf.a[ma]}),Object.assign(new Ce(1),{failure:ma});if(this.pE.ha(ma).failure)return Object.assign(new Ce(this.pE.ha(ma).errorCode),{failure:this.pE.ha(ma).failure});f.ULS.shipAssertTag(509870082,220,!!this.pE.ha(ma).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",ma);const Sa=new Ce(0);for(const Zb of this.pE.ha(ma).solutionIds)this.qE.Ob(Zb)&&Array.add(Sa.qp,this.qE.ha(Zb));return Sa}getUpgradedAddinsOfOmex(){return this.nq.getUpgradedAddinsOfOmex()}D0(ma){return this.qE.Ob(ma)?
this.qE.ha(ma):null}ybb(ma){if(ma){this.A4c(ma);for(const Sa of this.pE.keys){if(this.jna&&!this.uAc(Sa))continue;if(!this.mSb(Sa)||this.pE.ha(Sa).failure)continue;f.ULS.shipAssertTag(509870081,220,!!this.pE.ha(Sa).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Sa);const Zb=[],Wc=this.pE.ha(Sa);for(const rd of Wc.solutionIds)Array.add(Zb,this.qE.ha(rd));ma(null,new Tg(Sa,Wc.errorCode,Zb,Wc.failure))}}}get name(){return"AddinDetailsManager1"}hje(ma,
Sa){if(this.jna&&zf.yUd(ma)){var Zb=rd=>{this.y8(zf.gwd(rd,4,"The connected service is disabled."));this.MCb(rd,-1)},Wc=rd=>{this.y8(zf.gwd(rd,0,"The user doesn't have any addin installed."),[]);this.MCb(rd,0)};0===ma?(this.SNf(0,Sa,Zb,Wc),this.SNf(2,Sa,Zb,()=>{this.Qhe(this.Zbd)})):10===ma&&this.MCb(1,1)}}tka(ma,Sa=!1){zf.yUd(ma)?this.zGg(ma,this.Zbd,Sa):f.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",vf.a[ma])}A4c(ma){this.kb.addHandler(F.a.bud,ma)}SNf(ma,Sa,
Zb,Wc){this.uAc(ma)||(3===Sa&&Zb?Zb(ma):2===Sa&&Wc?Wc(ma):this.MCb(ma,1))}uAc(ma){return this.XWa.Ob(ma)}MCb(ma,Sa){if(this.jna){var Zb=this.uAc(ma);if(!Zb||-1!==this.XWa.ha(ma)&&this.XWa.ha(ma)!==Sa)f.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",jf.a[ma],Zb?Eh[this.XWa.ha(ma)]:"undefined",Eh[Sa]),this.XWa.K(ma,Sa)}}K9h(ma,Sa,Zb){const Wc={};Wc.collectionType=jf.a[ma];Wc.invokeResultCode=Zb.errorCode;Wc["queryResult.Value"]=Zb.value?String.format("Length: {0}",
Zb.value.length):"null";Wc.queryStart=Sa;Wc.queryDuration=window.performance.now()-Sa;return Object.assign(new Vg(ma,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Wc)})}zOn(){return this.mSb(2)?this.Ba.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.pE.ha(2).errorCode:!1:!0}dNe(ma){return this.jna&&this.XWa.Ob(ma)?1===this.XWa.ha(ma):!0}zGg(ma,Sa,Zb=!1){f.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",ma);
if(ma!==OSF.StoreTypeEnum.MarketPlace&&ma!==OSF.StoreTypeEnum.PrivateCatalog)f.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",ma);else{var Wc=this.cfb.ha(ma);(!this.XJk||this.ZBe&&this.isAnonymousUser)&&ma===OSF.StoreTypeEnum.MarketPlace&&this.dNe(2)&&this.Qhe(Sa);this.dNe(Wc)&&(this.ZBe&&this.isAnonymousUser?(ma=zf.f9h(Wc),this.y8(ma)):this.eek(ma,Sa,Zb))}}eek(ma,Sa,Zb){this.vWl(ma,(Wc,rd)=>{if(Wc===OSF.StoreTypeEnum.MarketPlace&&rd)rd=zf.n5c(0),this.y8(rd),this.XJk&&this.y8(zf.n5c(2));
else if(Wc===OSF.StoreTypeEnum.PrivateCatalog&&rd)rd=zf.n5c(1),this.y8(rd);else{this.XJk&&Wc===OSF.StoreTypeEnum.MarketPlace&&this.dNe(2)&&Sa(2,window.performance.now(),this.M_l());var ee=window.performance.now();this.nq.getEntitlementDetails(Object.assign(new Eg,{storeType:Wc,refresh:Zb}),De=>{Sa(this.cfb.ha(Wc),ee,De)})}})}Qhe(ma){this.zOn()&&this.vWl(0,(Sa,Zb)=>{Zb?(Sa=zf.n5c(2),this.y8(Sa)):(Sa=window.performance.now(),ma(2,Sa,this.M_l()))})}y8(ma,Sa=null){0!==ma.errorCode?(f.ULS.shipAssertTag(509116673,
220,!Sa,"The parameter addinDetails must be null for any failed queries"),f.ULS.shipAssertTag(509116672,220,!!ma.failure,"The result.Failure must not be available for any failed queries"),this.ZFk(ma)?f.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",jf.a[ma.Wgb],Bh.a[ma.errorCode],ma.failure?ma.failure.toString():"null",JSON.stringify(ma.failure)):f.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"(downgraded error)",jf.a[ma.Wgb],Bh.a[ma.errorCode],ma.failure?ma.failure.toString():"null",JSON.stringify(ma.failure))):(f.ULS.shipAssertTag(509116643,220,!!Sa,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",jf.a[ma.Wgb]),f.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",jf.a[ma.Wgb],Sa?Sa.length:-1));ma=new Tg(ma.Wgb,ma.errorCode,Sa,ma.failure);this.kb.raiseEvent(F.a.bud,ma)}ZFk(ma){return 3===
ma.errorCode&&(this.ZBe&&-2147208619===zf.NDf(ma)||this.ZFi&&-2===zf.NDf(ma))||4===ma.errorCode?!1:2!==ma.errorCode}mSb(ma){return this.pE.Ob(ma)?!!this.qE:!1}get pze(){return this.U2?!this.U2.AreThirdPartyAddInsAllowed||this.U2.AppsForOfficeThirdPartyIsDisabled:!this.Ba.getBooleanAppSetting("AreThirdPartyAddInsAllowed")||this.Ba.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")}get WEe(){return this.U2?!this.U2.AppsForOfficeAllowExternalMarketplace:!this.Ba.getBooleanAppSetting("AppsForOfficeAllowExternalMarketplace")}get ycd(){return this.U2?
this.U2.PopularAddinDetailsJsonString:this.Ba.La("PopularAddinDetailsJsonString")}queryStoreDisabled(ma,Sa){if(this.pze)Sa(ma,!0);else if(ma===OSF.StoreTypeEnum.MarketPlace&&this.WEe)Sa(ma,!0);else{const Zb=zf.rOe(ma);if(Zb){const Wc=window.performance.now();this.nq.queryStoreDisabled(Zb,rd=>{f.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",ma,rd,Wc,window.performance.now()-Wc);Sa(ma,rd)})}else Sa(ma,!1)}}vWl(ma,Sa){if(this.OSn)if(this.pze)Sa(ma,
!0);else if(ma===OSF.StoreTypeEnum.MarketPlace&&this.WEe)Sa(ma,!0);else{const Zb=zf.rOe(ma),Wc=this.mcl.GTm(ma);if(void 0===Wc)if(Zb){const rd=window.performance.now();this.nq.queryStoreDisabled(Zb,ee=>{this.mcl.fNn(ma,ee);f.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",ma,ee,rd,window.performance.now()-rd);Sa(ma,void 0!==ee?ee:!0)})}else Sa(ma,!1);else Sa(ma,Wc)}else this.queryStoreDisabled(ma,Sa)}ctg(ma,Sa,Zb){return ma?
Zb?2===Sa?zf.zbd(Zb,ma):zf.zbd(ma,Zb):ma:Zb}M_l(){if(!this.lpd){const ma=JSON.parse(this.ycd);this.Vxf(ma);this.lpd=ma}return zf.Kze(0,this.lpd)}Vxf(ma){zf.fcf(ma);this.ize(ma);this.Wxf(ma)}ize(ma){const Sa=this.fff();for(var Zb=0;Zb<ma.length&&0<Sa.count;Zb++){const Wc=ma[Zb];if(Sa.Ob(Wc.solutionId)){let rd=String.format("Found an override, solutionId: {0}",Wc.solutionId);const ee=Sa.ha(Wc.solutionId);ee&&(isNaN(ee.addinInfo.priority)||(rd=String.format("{0}; AddinInfo.Priority: update {1} to {2}",
rd,Wc.addinInfo.priority,ee.addinInfo.priority),Wc.addinInfo.priority=ee.addinInfo.priority),isNaN(ee.addinInfo.AUP)||(rd=String.format("{0}; AddinInfo.AUP: update {1} to {2}",rd,Wc.addinInfo.AUP,ee.addinInfo.AUP),Wc.addinInfo.AUP=ee.addinInfo.AUP),ee.displayName&&(rd=String.format("{0}; DisplayName: update {1} to {2}",rd,Wc.displayName,ee.displayName),Wc.displayName=ee.displayName),ee.iconUrl&&(rd=String.format("{0}; IconUrl: update {1} to {2}",rd,Wc.iconUrl,ee.iconUrl),Wc.iconUrl=ee.iconUrl),ee.description&&
(rd=String.format("{0}; Description: update {1} to {2}",rd,Wc.description,ee.description),Wc.description=ee.description));Sa.remove(Wc.solutionId);this.EOb&&f.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",rd)}}for(const Wc of Sa.keys)Zb=Sa.ha(Wc),Zb.displayName&&Zb.iconUrl&&Zb.addinInfo&&(ma.push(Zb),this.EOb&&f.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Zb)))}fff(){const ma=new lf.a(yf.a.Wn());
let Sa=this.Ba.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Sa)return ma;Sa=Sa.trim();if(12>=Sa.length)return 0<Sa.length&&f.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Sa),ma;this.EOb&&f.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Sa);try{const Zb=[],Wc=Sa.split("|");for(let rd=Wc.length-1;0<=rd;rd--){const ee=Wc[rd],De=ee.split("\\");if(2>De.length){Zb.push(ee);
continue}const Af=zf.FBg(De);Af?ma.Ob(Af.solutionId)||ma.add(Af.solutionId,Af):Zb.push(ee)}this.EOb&&0<Zb.length&&f.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Zb.join("|"));this.EOb&&0<ma.count&&f.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",ma.count,JSON.stringify(Qh.toArray(ma.values)));return ma}catch(Zb){f.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
Sa,Zb.toString())}return ma}Wxf(ma){for(let Sa=0;Sa<ma.length;Sa++)Lb.c(ma[Sa].iconUrl.toLowerCase(),"http",0)||(ma[Sa].iconUrl=String.format("{0}/image/apps.{1}",this.BZe,ma[Sa].iconUrl))}static yUd(ma){return 0===ma||10===ma}static L9h(ma,Sa){const Zb={};Zb.collectionType=jf.a[ma];Zb.queryResult="null";Zb.queryStart=Sa;Zb.queryDuration=window.performance.now()-Sa;return Object.assign(new Vg(ma,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Zb)})}static gwd(ma,Sa,Zb){const Wc=
{};Wc.collectionType=jf.a[ma];ma=new Vg(ma,Sa);0!==Sa&&(ma.failure=Error.create(Zb,Wc));return ma}static n5c(ma){return zf.gwd(ma,2,"The store is disabled.")}static f9h(ma){const Sa={};Sa.collectionType=jf.a[ma];Sa.invokeResultCode=-2147208619;Sa.queryDuration=0;return Object.assign(new Vg(ma,3),{failure:Error.create("Anonymous users do not have installed add-ins.",Sa)})}static NDf(ma){return ma.failure?ma.failure.invokeResultCode:-1E3}gZf(ma,Sa,Zb){const Wc={};Wc.AddinCollectionType=jf.a[ma];Wc.ErrorCode=
Sa.errorCode;Wc.AddinCount=Sa.value?Sa.value.length:0;ma=window.performance.now();Sa=Date.now()-u.AFrameworkApplication.S7;f.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",Zb,ma,Sa,JSON.stringify(Wc))}fZf(ma,Sa,Zb){this.hZf?(Zb={["AddinCollectionType"]:jf.a[ma],["ErrorCode"]:Sa.errorCode,["QueryDuration"]:Zb,["FlyoutDataReadySinceBoot"]:Date.now()-u.AFrameworkApplication.S7},this.PRf(ma)&&f.ULS.sendTraceTag(508069333,
220,50,"{0}",JSON.stringify(Zb)),Zb.AddinCount=Sa.value?Sa.value.length:0,f.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(Zb))):this.gZf(ma,Sa,Zb)}PRf(ma){0===ma?this.Wra|=1:1===ma&&(this.Wra|=2);ma=this.Wra&131;if(ma=1===ma||2===ma)this.Wra=255;return ma}static Kze(ma,Sa){const Zb={};Zb.errorCode=ma;Zb.value=Sa;return Zb}static rOe(ma){return ma===OSF.StoreTypeEnum.MarketPlace?"omex":ma===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static zbd(ma,Sa){Sa.solutionId=
Sa.solutionId||ma.solutionId;Sa.version=Sa.version||ma.version;Sa.storeType=Sa.storeType||ma.storeType;Sa.storeId=Sa.storeId||ma.storeId;Sa.assetId=Sa.assetId||ma.assetId;Sa.assetStoreId=Sa.assetStoreId||ma.assetStoreId;Sa.displayName=Sa.displayName||ma.displayName;Sa.provider=Sa.provider||ma.provider;Sa.description=Sa.description||ma.description;Sa.iconUrl=Sa.iconUrl||ma.iconUrl;Sa.webApplicationId=Sa.webApplicationId||ma.webApplicationId;Sa.highResolutionIconUrl=Sa.highResolutionIconUrl||ma.highResolutionIconUrl;
Sa.licenseUrl=Sa.licenseUrl||ma.licenseUrl;Sa.privacyUrl=Sa.privacyUrl||ma.privacyUrl;Sa.addinInfo=Sa.addinInfo||ma.addinInfo;isNaN(Sa.targetType)&&(Sa.targetType=ma.targetType);isNaN(Sa.height)&&(Sa.height=ma.height);isNaN(Sa.width)&&(Sa.width=ma.width);return Sa}static fcf(ma){for(const Sa of ma)isNaN(Sa.targetType)&&(Sa.targetType=1),Sa.assetId=Sa.assetId||Sa.solutionId,Sa.storeId=Sa.storeId||"en-US",Sa.storeType=Sa.storeType||"omex",Sa.assetStoreId=Sa.assetStoreId||"omex",isNaN(Sa.width)&&(Sa.width=
0),isNaN(Sa.height)&&(Sa.height=0)}static FBg(ma){const Sa={};let Zb=0;Zb<ma.length&&0<ma[Zb].trim().length&&ma[Zb].trim().toLowerCase().startsWith("wa")&&(Sa.solutionId=ma[Zb].trim(),Sa.addinInfo=Object.assign(new Nf,{priority:Number.NaN,AUP:Number.NaN}),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.addinInfo.priority=parseInt(ma[Zb].trim())),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.addinInfo.AUP=parseInt(ma[Zb].trim())),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.displayName=ma[Zb].trim()),++Zb<
ma.length&&0<ma[Zb].trim().length&&(Sa.iconUrl=ma[Zb].trim()),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.description=ma[Zb].trim()));return Sa.solutionId?Sa:null}static ADf(ma,Sa){ma=ma.La("AddinImageStoreServiceUrl");if(!ma)return Sa;ma=ma.toLowerCase();return ma.startsWith("http://")||ma.startsWith("https://")?ma:Sa}}Object(c.a)(zf,"AddinDetailsManager1",null,[373,374]);class Df{constructor(ma,Sa=null){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=
this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=ma.solutionId;this.version=ma.version;this.storeType=ma.storeType;this.storeId=ma.storeId;this.assetId=ma.assetId;this.assetStoreId=ma.assetStoreId;this.displayName=ma.displayName;this.provider=ma.provider;this.description=ma.description;this.targetType=ma.targetType;this.height=ma.height;
this.width=ma.width;this.iconUrl=ma.iconUrl;this.webApplicationId=ma.webApplicationId;this.highResolutionIconUrl=ma.highResolutionIconUrl;this.licenseUrl=ma.licenseUrl;this.privacyUrl=ma.privacyUrl;this.addinInfo=Sa}wRk(){const ma={};ma.solutionId=this.solutionId;ma.version=this.version;ma.storeType=this.storeType;ma.storeId=this.storeId;ma.assetId=this.assetId;ma.assetStoreId=this.assetStoreId;ma.targetType=this.targetType;ma.displayName=this.displayName;ma.width=this.width;ma.height=this.height;
return ma}}Object(c.a)(Df,"AddinDetail",null,[]);class $f{constructor(ma,Sa,Zb,Wc,rd){this.H$g=null;this.Ba=ma;this.G7=Sa;this.mpd=Zb;this.Xkm=Wc;this.vVe=rd}tka(ma,Sa){this.nq.queryAppDetails(this.Xkm,this.vVe,this.solutionIds,ma,(Zb,Wc)=>{let rd=null;if(Wc){rd=Array(Wc.length);for(let ee=0;ee<Wc.length;ee++)rd[ee]=new Df(Wc[ee],this.uan(Wc[ee].solutionId))}Sa(Zb,rd||[])})}get H4m(){return!!this.nq.queryAppDetails}uan(ma){return this.mpd.ha(ma)}get solutionIds(){if(!this.H$g){this.H$g=new b.a;for(const ma of this.mpd.keys)this.H$g.add(Lb.d(ma))}return this.H$g.toArray()}get nq(){return this.G7.value}}
Object(c.a)($f,"AddinDetailsLoader",null,[]);class Kg{constructor(ma,Sa=0){this.failure=null;this.Wgb=ma;this.errorCode=Sa}}Object(c.a)(Kg,"AddinQueryResult",null,[]);class ug extends Kg{constructor(ma,Sa=0){super(ma,Sa);this.KMk=this.solutionIds=null}}Object(c.a)(ug,"AddinCollection",Kg,[]);var rh=a(247);class gh extends rh.a{constructor(){super(yf.a.Wn())}}Object(c.a)(gh,"AddinDetailTable",rh.a,[]);var Mh;(function(ma){ma[ma.stop=-1]="stop";ma[ma.skip=0]="skip";ma[ma.query=1]="query"})(Mh||(Mh=
{}));Object(c.b)("QueryStrategy",Mh);class Rh{constructor(ma,Sa,Zb=null){this.kb=new B.a;this.qE=new lf.a(yf.a.Wn());this.pE=new ff.a;this.Wra=0;this.XWa=new ff.a;this.mpd=this.cFh=null;this.Zbd=(Wc,rd,ee)=>{ee?(this.fZf(Wc,ee,window.performance.now()-rd),0===ee.errorCode?(rd=ee.value?Rh.Zrm(ee.value):[],this.y8(new Kg(Wc),rd)):-1===ee.errorCode||10===ee.errorCode?this.y8(new Kg(Wc),[]):(Wc=this.K9h(Wc,rd,ee),this.y8(Wc))):(Wc=Rh.L9h(Wc,rd),this.y8(Wc))};this.cia=(Wc,rd)=>{if(0!==rd.errorCode&&5!==
rd.errorCode)this.k9l(rd.IZ,Object.assign(new ug(rd.IZ,rd.errorCode),{failure:rd.failure}));else{Wc=Object.assign(new ug(rd.IZ,rd.errorCode),{solutionIds:new b.a,KMk:new b.a});var ee=rd.qp;for(const Af of ee){ee=Af.solutionId;const mg=Af.storeId;if(this.qE.Ob(ee)){var De=this.qE.ha(ee);De.Ob(mg)?De.K(mg,this.ctg(De.ha(mg),rd.IZ,Af)):De.add(mg,Af)}else De=new gh,De.add(mg,Af),this.qE.add(ee,De);Wc.solutionIds.add(ee);Wc.KMk.add(mg)}this.k9l(rd.IZ,Wc)}};this.cfb=new hf.a;this.cfb.add(OSF.StoreTypeEnum.MarketPlace,
0);this.cfb.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ba=ma;this.G7=Sa;this.U2=Zb;this.BZe=Rh.ADf(ma,"https://store-images.s-microsoft.com");this.oQh=null;this.A4c(this.cia)}get lch(){this.cFh||(this.cFh=this.Qtl());return this.cFh}Qtl(){const ma=JSON.parse(this.ycd);this.Vxf(ma);return ma.map(Sa=>new Df(Sa,Sa.addinInfo))}get jna(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get hZf(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get isAnonymousUser(){return!!this.Ba&&
this.Ba.getBooleanAppSetting("IsAnonymousUser")}get ZFi(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get ZBe(){return!!this.Ba&&this.Ba.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get EOb(){return this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get nq(){return this.G7.value}get x7j(){this.oQh||(this.oQh=new $f(this.Ba,this.G7,this.lwn,0,this.nq.getAppUILocale()));return this.oQh}sC(ma){if(this.jna&&
!this.uAc(ma))return new Ce(0);if(!this.mSb(ma))return ma=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:jf.a[ma]}),Object.assign(new Ce(1),{failure:ma});const Sa=this.pE.ha(ma);if(Sa.failure)return Object.assign(new Ce(Sa.errorCode),{failure:Sa.failure});f.ULS.shipAssertTag(509870082,220,!!Sa.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",ma);const Zb=new Ce(Sa.errorCode);for(let Wc=0;Wc<Sa.solutionIds.count;Wc++){const rd=
Sa.solutionIds.ha(Wc),ee=Sa.KMk.ha(Wc);if(this.qE.Ob(rd)){const De=this.qE.ha(rd);De.Ob(ee)?Array.add(Zb.qp,De.ha(ee)):f.ULS.sendTraceTag(508610437,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",rd,ma,ee)}else f.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",rd,ma)}return Zb}getUpgradedAddinsOfOmex(){return this.nq.getUpgradedAddinsOfOmex()}D0(ma,Sa=null){if(ma=this.BLm(ma))if(Sa||
(Sa=this.uiCulture),ma.Ob(Sa))return ma.ha(Sa);return null}BLm(ma){return this.qE.Ob(ma)?this.qE.ha(ma):null}ybb(ma){if(ma){this.A4c(ma);for(const Sa of this.pE.keys){if(this.jna&&!this.uAc(Sa))continue;if(!this.mSb(Sa)||this.pE.ha(Sa).failure)continue;f.ULS.shipAssertTag(509870081,220,!!this.pE.ha(Sa).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Sa);const Zb=[],Wc=this.pE.ha(Sa);for(const rd of Wc.solutionIds)Array.add(Zb,this.qE.ha(rd));ma(null,
new Tg(Sa,Wc.errorCode,Zb,Wc.failure))}}}get name(){return"AddinDetailsManager2"}hje(ma,Sa){if(this.jna&&Rh.yUd(ma)){var Zb=rd=>{this.y8(Rh.gwd(rd,4,"The connected service is disabled."));this.MCb(rd,-1)},Wc=rd=>{this.y8(Rh.gwd(rd,0,"The user doesn't have any addin installed."),[]);this.MCb(rd,0)};0===ma?(this.SNf(0,Sa,Zb,Wc),this.SNf(2,Sa,Zb,()=>{this.Qhe(this.Zbd,this.lch)})):10===ma&&this.MCb(1,1)}}tka(ma,Sa=!1){Rh.yUd(ma)?this.zGg(ma,this.Zbd,Sa):f.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",
vf.a[ma])}A4c(ma){this.kb.addHandler(F.a.bud,ma)}SNf(ma,Sa,Zb,Wc){this.uAc(ma)||(3===Sa&&Zb?Zb(ma):2===Sa&&Wc?Wc(ma):this.MCb(ma,1))}uAc(ma){return this.XWa.Ob(ma)}MCb(ma,Sa){if(this.jna){var Zb=this.uAc(ma);if(!Zb||-1!==this.XWa.ha(ma)&&this.XWa.ha(ma)!==Sa)f.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",jf.a[ma],Zb?Mh[this.XWa.ha(ma)]:"undefined",Mh[Sa]),this.XWa.K(ma,Sa)}}K9h(ma,Sa,Zb){const Wc={};Wc.collectionType=jf.a[ma];Wc.invokeResultCode=
Zb.errorCode;Wc["queryResult.Value"]=Zb.value?String.format("Length: {0}",Zb.value.length):"null";Wc.queryStart=Sa;Wc.queryDuration=window.performance.now()-Sa;return Object.assign(new Kg(ma,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Wc)})}oGk(ma){if(ma!==OSF.StoreTypeEnum.MarketPlace)return!1;if(this.dNe(2)){if(!this.mSb(2))return!0;if(this.Ba.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins"))return 3===this.pE.ha(2).errorCode}return!1}dNe(ma){return this.jna&&
this.XWa.Ob(ma)?1===this.XWa.ha(ma):!0}zGg(ma,Sa,Zb=!1){f.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",ma);if(ma!==OSF.StoreTypeEnum.MarketPlace&&ma!==OSF.StoreTypeEnum.PrivateCatalog)f.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",ma);else{var Wc=this.cfb.ha(ma);this.oGk(ma)&&this.Qhe(Sa,this.hAn);this.dNe(Wc)&&(this.ZBe&&this.isAnonymousUser?(ma=Rh.f9h(Wc),this.y8(ma)):this.eek(ma,Sa,Zb))}}get hAn(){return this.pE.Ob(2)?null:this.lch}eek(ma,Sa,
Zb){this.queryStoreDisabled(ma,(Wc,rd)=>{if(Wc===OSF.StoreTypeEnum.MarketPlace&&rd)rd=Rh.n5c(0),this.y8(rd);else if(Wc===OSF.StoreTypeEnum.PrivateCatalog&&rd)rd=Rh.n5c(1),this.y8(rd);else{var ee=window.performance.now();this.nq.getEntitlementDetails(Object.assign(new Eg,{storeType:Wc,refresh:Zb}),De=>{Sa(this.cfb.ha(Wc),ee,De)})}})}Qhe(ma=null,Sa=null){null===ma&&(ma=this.Zbd);this.queryStoreDisabled(0,(Zb,Wc)=>{Wc?(Zb=Rh.n5c(2),this.y8(Zb)):null!=Sa?this.y8(new Kg(2,5),Sa):this.KBn(ma)})}y8(ma,Sa=
null){0!==ma.errorCode&&5!==ma.errorCode?(f.ULS.shipAssertTag(509116673,220,!Sa,"The parameter addinDetails must be null for any failed queries"),f.ULS.shipAssertTag(509116672,220,!!ma.failure,"The result.Failure must not be available for any failed queries"),this.ZFk(ma)?f.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",jf.a[ma.Wgb],Bh.a[ma.errorCode],ma.failure?ma.failure.toString():"null",JSON.stringify(ma.failure)):
f.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",jf.a[ma.Wgb],Bh.a[ma.errorCode],ma.failure?ma.failure.toString():"null",JSON.stringify(ma.failure))):(f.ULS.shipAssertTag(509116643,220,!!Sa,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",jf.a[ma.Wgb]),f.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails, errorCode: {2}",
jf.a[ma.Wgb],Sa?Sa.length:-1,Bh.a[ma.errorCode]));ma=new Tg(ma.Wgb,ma.errorCode,Sa,ma.failure);this.kb.raiseEvent(F.a.bud,ma)}ZFk(ma){return 3===ma.errorCode&&(this.ZBe&&-2147208619===Rh.NDf(ma)||this.ZFi&&-2===Rh.NDf(ma))||4===ma.errorCode?!1:2!==ma.errorCode}k9l(ma,Sa){this.pE.K(ma,Sa);this.MCb(ma,1)}mSb(ma){return this.pE.Ob(ma)?!!this.qE:!1}get uiCulture(){return this.U2&&this.U2.UICulture?this.U2.UICulture:u.AFrameworkApplication.uiCulture}get pze(){return this.U2?!this.U2.AreThirdPartyAddInsAllowed||
this.U2.AppsForOfficeThirdPartyIsDisabled:!this.Ba.getBooleanAppSetting("AreThirdPartyAddInsAllowed")||this.Ba.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")}get WEe(){return this.U2?!this.U2.AppsForOfficeAllowExternalMarketplace:!this.Ba.getBooleanAppSetting("AppsForOfficeAllowExternalMarketplace")}get lwn(){if(!this.mpd){this.mpd=new lf.a(yf.a.Wn());const ma=JSON.parse(this.ycd);for(const Sa of ma)this.mpd.add(Sa.solutionId,Sa.addinInfo)}return this.mpd}get ycd(){return this.U2?this.U2.PopularAddinDetailsJsonString:
this.Ba.La("PopularAddinDetailsJsonString")}queryStoreDisabled(ma,Sa){if(this.pze)Sa(ma,!0);else if(ma===OSF.StoreTypeEnum.MarketPlace&&this.WEe)Sa(ma,!0);else{const Zb=Rh.rOe(ma);if(Zb){const Wc=window.performance.now();this.nq.queryStoreDisabled(Zb,rd=>{f.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",ma,rd,Wc,window.performance.now()-Wc);Sa(ma,rd)})}else Sa(ma,!1)}}ctg(ma,Sa,Zb){return ma?Zb?2===Sa?Rh.zbd(Zb,ma):Rh.zbd(ma,
Zb):ma:Zb}KBn(ma){const Sa=(Wc,rd,ee)=>{ma(2,ee,Rh.Kze(Wc,rd))},Zb=window.performance.now();this.x7j&&this.x7j.H4m?this.x7j.tka(!1,(Wc,rd)=>{this.ize(rd);ma(2,Zb,Rh.Kze(Wc,rd))}):Sa(0,this.Qtl(),Zb)}Vxf(ma){Rh.fcf(ma);this.ize(ma);this.Wxf(ma)}ize(ma){const Sa=this.fff();for(var Zb=0;Zb<ma.length&&0<Sa.count;Zb++){const Wc=ma[Zb];if(Sa.Ob(Wc.solutionId)){let rd=String.format("Found an override, solutionId: {0}",Wc.solutionId);const ee=Sa.ha(Wc.solutionId);ee&&(isNaN(ee.addinInfo.priority)||(rd=String.format("{0}; AddinInfo.Priority: update {1} to {2}",
rd,Wc.addinInfo.priority,ee.addinInfo.priority),Wc.addinInfo.priority=ee.addinInfo.priority),isNaN(ee.addinInfo.AUP)||(rd=String.format("{0}; AddinInfo.AUP: update {1} to {2}",rd,Wc.addinInfo.AUP,ee.addinInfo.AUP),Wc.addinInfo.AUP=ee.addinInfo.AUP),ee.displayName&&(rd=String.format("{0}; DisplayName: update {1} to {2}",rd,Wc.displayName,ee.displayName),Wc.displayName=ee.displayName),ee.iconUrl&&(rd=String.format("{0}; IconUrl: update {1} to {2}",rd,Wc.iconUrl,ee.iconUrl),Wc.iconUrl=ee.iconUrl),ee.description&&
(rd=String.format("{0}; Description: update {1} to {2}",rd,Wc.description,ee.description),Wc.description=ee.description));Sa.remove(Wc.solutionId);this.EOb&&f.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",rd)}}for(const Wc of Sa.keys)Zb=Sa.ha(Wc),Zb.displayName&&Zb.iconUrl&&Zb.addinInfo&&(ma.push(Zb),this.EOb&&f.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Zb)))}fff(){const ma=new lf.a(yf.a.Wn());
let Sa=this.Ba.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Sa)return ma;Sa=Sa.trim();if(12>=Sa.length)return 0<Sa.length&&f.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Sa),ma;this.EOb&&f.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Sa);try{const Zb=[],Wc=Sa.split("|");for(let rd=Wc.length-1;0<=rd;rd--){const ee=Wc[rd],De=ee.split("\\");if(2>De.length){Zb.push(ee);
continue}const Af=Rh.FBg(De);Af?ma.Ob(Af.solutionId)||ma.add(Af.solutionId,Af):Zb.push(ee)}this.EOb&&0<Zb.length&&f.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Zb.join("|"));this.EOb&&0<ma.count&&f.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",ma.count,JSON.stringify(Qh.toArray(ma.values)));return ma}catch(Zb){f.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
Sa,Zb.toString())}return ma}Wxf(ma){for(let Sa=0;Sa<ma.length;Sa++)Lb.c(ma[Sa].iconUrl.toLowerCase(),"http",0)||(ma[Sa].iconUrl=String.format("{0}/image/apps.{1}",this.BZe,ma[Sa].iconUrl))}static yUd(ma){return 0===ma||10===ma}static L9h(ma,Sa){const Zb={};Zb.collectionType=jf.a[ma];Zb.queryResult="null";Zb.queryStart=Sa;Zb.queryDuration=window.performance.now()-Sa;return Object.assign(new Kg(ma,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Zb)})}static gwd(ma,Sa,Zb){const Wc=
{};Wc.collectionType=jf.a[ma];ma=new Kg(ma,Sa);0!==Sa&&(ma.failure=Error.create(Zb,Wc));return ma}static n5c(ma){return Rh.gwd(ma,2,"The store is disabled.")}static f9h(ma){const Sa={};Sa.collectionType=jf.a[ma];Sa.invokeResultCode=-2147208619;Sa.queryDuration=0;return Object.assign(new Kg(ma,3),{failure:Error.create("Anonymous users do not have installed add-ins.",Sa)})}static NDf(ma){return ma.failure?ma.failure.invokeResultCode:-1E3}gZf(ma,Sa,Zb){const Wc={};Wc.AddinCollectionType=jf.a[ma];Wc.ErrorCode=
Sa.errorCode;Wc.AddinCount=Sa.value?Sa.value.length:0;ma=window.performance.now();Sa=Date.now()-u.AFrameworkApplication.S7;f.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",Zb,ma,Sa,JSON.stringify(Wc))}fZf(ma,Sa,Zb){this.hZf?(Zb={["AddinCollectionType"]:jf.a[ma],["ErrorCode"]:Sa.errorCode,["QueryDuration"]:Zb,["FlyoutDataReadySinceBoot"]:Date.now()-u.AFrameworkApplication.S7},this.PRf(ma)&&f.ULS.sendTraceTag(508069333,
220,50,"{0}",JSON.stringify(Zb)),Zb.AddinCount=Sa.value?Sa.value.length:0,f.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(Zb))):this.gZf(ma,Sa,Zb)}PRf(ma){0===ma?this.Wra|=1:1===ma&&(this.Wra|=2);ma=this.Wra&131;if(ma=1===ma||2===ma)this.Wra=255;return ma}static Kze(ma,Sa){const Zb={};Zb.errorCode=ma;Zb.value=Sa;return Zb}static rOe(ma){return ma===OSF.StoreTypeEnum.MarketPlace?"omex":ma===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static zbd(ma,Sa){Sa.solutionId=
Sa.solutionId||ma.solutionId;Sa.version=Sa.version||ma.version;Sa.storeType=Sa.storeType||ma.storeType;Sa.storeId=Sa.storeId||ma.storeId;Sa.assetId=Sa.assetId||ma.assetId;Sa.assetStoreId=Sa.assetStoreId||ma.assetStoreId;Sa.displayName=Sa.displayName||ma.displayName;Sa.provider=Sa.provider||ma.provider;Sa.description=Sa.description||ma.description;Sa.iconUrl=Sa.iconUrl||ma.iconUrl;Sa.webApplicationId=Sa.webApplicationId||ma.webApplicationId;Sa.highResolutionIconUrl=Sa.highResolutionIconUrl||ma.highResolutionIconUrl;
Sa.licenseUrl=Sa.licenseUrl||ma.licenseUrl;Sa.privacyUrl=Sa.privacyUrl||ma.privacyUrl;Sa.addinInfo=Sa.addinInfo||ma.addinInfo;isNaN(Sa.targetType)&&(Sa.targetType=ma.targetType);isNaN(Sa.height)&&(Sa.height=ma.height);isNaN(Sa.width)&&(Sa.width=ma.width);return Sa}static Zrm(ma){const Sa=Array(ma.length);for(let Zb=0;Zb<Sa.length;Zb++)Sa[Zb]=new Df(ma[Zb],ma[Zb].addinInfo);return Sa}static fcf(ma){for(const Sa of ma)isNaN(Sa.targetType)&&(Sa.targetType=1),Sa.assetId=Sa.assetId||Sa.solutionId,Sa.storeId=
Sa.storeId||"en-US",Sa.storeType=Sa.storeType||"omex",Sa.assetStoreId=Sa.assetStoreId||"omex",isNaN(Sa.width)&&(Sa.width=0),isNaN(Sa.height)&&(Sa.height=0)}static FBg(ma){const Sa={};let Zb=0;Zb<ma.length&&0<ma[Zb].trim().length&&ma[Zb].trim().toLowerCase().startsWith("wa")&&(Sa.solutionId=ma[Zb].trim(),Sa.addinInfo=Object.assign(new Nf,{priority:Number.NaN,AUP:Number.NaN}),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.addinInfo.priority=parseInt(ma[Zb].trim())),++Zb<ma.length&&0<ma[Zb].trim().length&&
(Sa.addinInfo.AUP=parseInt(ma[Zb].trim())),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.displayName=ma[Zb].trim()),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.iconUrl=ma[Zb].trim()),++Zb<ma.length&&0<ma[Zb].trim().length&&(Sa.description=ma[Zb].trim()));return Sa.solutionId?Sa:null}static ADf(ma,Sa){ma=ma.La("AddinImageStoreServiceUrl");if(!ma)return Sa;ma=ma.toLowerCase();return ma.startsWith("http://")||ma.startsWith("https://")?ma:Sa}}Object(c.a)(Rh,"AddinDetailsManager2",null,[372]);class Ch{constructor(ma,
Sa){this.vJe="popular";this.Kfl="addinDetails";this.Mil="cache-lastUpdate";this.kil="builtin-lastUpdate";this.$Tl=144E5;this.Ba=this.zyb=null;this.Qnn=(Zb,Wc)=>{2===Wc.IZ&&0===Wc.errorCode&&(this.Tai=Wc.qp,this.Ich=this.now,f.ULS.sendTraceTag(508352221,220,50,"AddinDetailsCacheManager.onAddinDetailsUpdated: cached popular addins were refreshed."))};this.zyb=Sa;this.Ba=ma;this.zyb.ybb(this.Qnn);this.$Tl=this.Ba.getIntFeatureGate("Microsoft.Office.SharedOnline.PopularCacheExpirationTime",144E5)}get G5m(){return this.Ich?
this.now.getTime()-this.Ich.getTime()>=this.$Tl:!0}sC(ma){var Sa=this.zyb.sC(ma);2===ma&&this.F5m(Sa.errorCode)&&(ma=this.Tai,null!=ma?(this.G5m&&this.zyb.Qhe(null,null),Sa=this.toDateString(this.now),Sa=this.toDateString(this.b$h)===Sa?this.e9h(5,this.zyb.lch):this.e9h(0,ma)):(Ch.pEa&&(Sa=this.e9h(5,this.zyb.lch)),this.b$h=this.now,this.zyb.Qhe(null,null)));return Sa}e9h(ma,Sa){return Object.assign(new Ce(ma),{qp:Sa,failure:null})}toDateString(ma){return ma.toISOString().substring(2,16)}get b$h(){const ma=
Ch.A8b(this.vJe,this.kil);return null!==ma?new Date(ma):new Date(0)}set b$h(ma){Ch.s0c(this.vJe,ma.toISOString(),this.kil)}get Ich(){const ma=Ch.A8b(this.vJe,this.Mil);return null!==ma?new Date(ma):new Date(0)}set Ich(ma){Ch.s0c(this.vJe,ma.toISOString(),this.Mil)}get Tai(){const ma=Ch.A8b(this.vJe,this.Kfl);let Sa=null;ma&&(Sa=JSON.parse(ma));return Sa}set Tai(ma){ma=JSON.stringify(ma);Ch.s0c(this.vJe,ma,this.Kfl)}get now(){return new Date}F5m(ma){return 2!==ma&&4!==ma}D0(ma,Sa=null){return this.zyb.D0(ma,
Sa)}getUpgradedAddinsOfOmex(){return this.zyb.getUpgradedAddinsOfOmex()}ybb(ma){this.zyb.ybb(ma)}get name(){return"AddinDetailsCacheManager"}hje(ma,Sa){this.zyb.hje(ma,Sa)}tka(ma,Sa=!1){this.zyb.tka(ma,Sa)}static A8b(ma,Sa){let Zb=null;try{const Wc=Ch.BZg;if(void 0!==Wc&&Wc){const rd=F.a.Xuc(ma)+"_"+Sa;Zb=Wc.getItem(rd)}else f.ULS.sendTraceTag(508352219,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(Wc){f.ULS.sendTraceTag(508352218,220,10,"Failed to get AddinCommands Cache {0} for suffix {1}.",
ma,Sa)}return Zb}static s0c(ma,Sa,Zb){try{const Wc=Ch.BZg;if(void 0!==Wc&&Wc){const rd=F.a.Xuc(ma)+"_"+Zb;Wc.setItem(rd,Sa)}else f.ULS.sendTraceTag(508352217,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(Wc){f.ULS.sendTraceTag(508352216,220,10,"Failed to set AddinCommands Cache {0} for suffix {1}.",ma,Zb)}}static get BZg(){if(!Ch.pEa)return null;let ma=null;try{ma=localStorage}catch(Sa){Ch.pEa=!1,ma=null,f.ULS.sendTraceTag(508352215,220,10,`Failed to use localStorage: error name: ${Sa.name}; message: ${Sa.message}; stack: ${Sa.stack}`)}return ma}}
Ch.pEa=!0;Object(c.a)(Ch,"AddinDetailsCacheManager",null,[373]);class ih{static createInstance(ma,Sa,Zb=null){ma=ih.xTa(ma)?ih.brm(ma)?new Ch(ma,new Rh(ma,Sa,Zb)):new zf(ma,Sa,Zb):new hi(ma,Sa,Zb);f.ULS.sendTraceTag(508352212,220,50,`AddinDetailsManagerFactory.CreateInstance: Creating an instance of ${ma.name}`);return ma}static xTa(ma){return(ma||u.AFrameworkApplication.ga).isChangeGateEnabled("OfficeVSO:8332954_FlyoutNotifyObserverFailuresEnabled")}static brm(ma){return(ma||u.AFrameworkApplication.ga).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",
!1)}}Object(c.a)(ih,"AddinDetailsManagerFactory",null,[]);var Mi=a(94),Oi=a(495),Ti=a(151);class xi extends Zc.a{constructor(){super();this.Dyb="calc(100% - 46px)";this.w9b="15px";this.Eyb="0";this.mWe="WACDialogPanel";this.lDa=695;this.nWe=462;this.Cua="80%";this.WTe=350;this.u2c="100%";this.gf=5;this.uk="AppsForOfficeInsertionDialog";this.dIh=!!u.AFrameworkApplication.ga&&u.AFrameworkApplication.ga.getBooleanAppSetting("OfficeAddinEnableInsertDialogAccessibilityFix")}hL(){var ma;super.hL();this.LB.style.width=
this.u2c;this.LB.style.height=this.Dyb;this.LB.style.marginTop=this.w9b;this.LB.style.padding=this.Eyb;if(null===(ma=u.AFrameworkApplication.ga)||void 0===ma?0:ma.isChangeGateEnabled("AddInDialogBugFix"))this.P8a.classList.add("AddInDialog"),this.LB.classList.add("AddInDialog")}kub(){this.LB.style.width=this.u2c;this.LB.style.height=this.Dyb;this.LB.style.marginTop=this.w9b;this.LB.style.padding=this.Eyb;this.lDa>Yd.a.ada?(this.Ed.style.width=String.format("{0}px",Yd.a.ada),this.Ed.style.overflowX=
"scroll",u.AFrameworkApplication.isRtl?this.Ed.style.right="0":this.Ed.style.left="0"):(this.Ed.style.width=String.format("{0}px",this.lDa),this.Ed.style.overflowX="hidden");this.Ed.offsetHeight>Yd.a.$ca||this.nWe+50>Yd.a.$ca?(this.Ed.style.height=String.format("{0}px",Yd.a.$ca),this.Ed.style.overflowY="scroll",this.Ed.style.top="0",u.AFrameworkApplication.isRtl?this.Ed.style.right="0":this.Ed.style.left="0",this.dIh||(this.Ed.style.marginTop="-48px"),this.LB.style.minHeight=String.format("{0}px",
this.WTe)):(this.Ed.style.overflowY="hidden",this.Ed.style.top="10%",this.Ed.style.height=this.Cua);this.Zoc()}Zoc(){if(this.Ed){var ma=this.Ed.style.zIndex;this.Ed.style.zIndex="-9999";if(this.lDa>Yd.a.ada)u.AFrameworkApplication.isRtl?this.Ed.style.marginRight="0":this.Ed.style.marginLeft="0";else{const Sa=String.format("{0}px",Math.floor(-this.Ed.offsetWidth/2));u.AFrameworkApplication.isRtl?this.Ed.style.marginRight=Sa:this.Ed.style.marginLeft=Sa;u.AFrameworkApplication.isRtl?this.Ed.style.right=
"50%":this.Ed.style.left="50%"}this.Ed.style.zIndex=String(ma)}else f.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}n7(){super.n7();const ma=document.getElementById(this.ap(this.mWe));ma.style.width=String.format("{0}px",this.lDa);ma.style.height=this.Cua}get kNb(){return this.LB}}Object(c.a)(xi,"AppsForOfficeInsertionDialog",Zc.a,[363]);class uj extends Zc.a{constructor(ma=!0,Sa=!0,Zb=null){super();this.Dyb="calc(100% - 46px)";this.w9b="15px";this.Eyb="0";this.mWe=
"WACDialogPanel";this.lDa=695;this.nWe=462;this.Cua="80%";this.WTe=350;this.u2c="100%";this.Q5k=this.I5k=this.N8g=null;this.Z5k="auto";this.$5k="5px";this.a6k="auto";this.Y5k="40px";this.d8g="100px";this.oWe="200px";this.gf=5;this.uk="SDXDialog";this.V8g=ma;this.XLf=Sa;this.$7g=Zb}hL(){super.hL();this.LB.style.width=this.u2c;this.LB.style.height=this.Dyb;this.LB.style.marginTop=this.w9b;this.LB.style.padding=this.Eyb}kub(){this.LB.style.width=this.u2c;this.LB.style.height=this.V8g?this.Dyb:"100%";
this.LB.style.marginTop=this.V8g?this.w9b:"0px";this.LB.style.padding=this.Eyb;if(this.V8g){this.d8g&&this.oWe&&(this.lDa=parseInt(this.oWe.substring(0,this.oWe.length-2)),this.Cua=this.d8g);this.lDa>Yd.a.ada?(this.Ed.style.width=String.format("{0}px",Yd.a.ada),this.Ed.style.overflowX="scroll",u.AFrameworkApplication.isRtl?this.Ed.style.right="0":this.Ed.style.left="0"):(this.Ed.style.width=String.format("{0}px",this.lDa),this.Ed.style.overflowX="hidden");if(this.Ed.offsetHeight>Yd.a.$ca||this.nWe+
50>Yd.a.$ca)this.Ed.style.height=String.format("{0}px",Yd.a.$ca),this.Ed.style.overflowY="scroll",this.Ed.style.top="0",u.AFrameworkApplication.isRtl?this.Ed.style.right="0":this.Ed.style.left="0",this.LB.style.minHeight=String.format("{0}px",this.WTe);else{this.Ed.style.overflowY="hidden";const ma="%"===this.Cua.substring(this.Cua.length-1,this.Cua.length),Sa=ma?parseInt(this.Cua.substring(0,this.Cua.length-1)):parseInt(this.Cua.substring(0,this.Cua.length-2));this.Ed.style.top=ma?(100-Sa)/2+"%":
100*(Yd.a.$ca-Sa)/Yd.a.$ca/2+"%";this.Ed.style.height=this.Cua}this.Zoc()}else this.Ed.style.left=this.Z5k,this.Ed.style.right=this.$5k,this.Ed.style.top=this.a6k,this.Ed.style.bottom=this.Y5k,this.Ed.style.width=this.oWe,this.Ed.style.height=this.d8g,this.Ed.style.overflowX="hidden",this.Ed.style.overflowY="hidden"}Zoc(){if(this.Ed){var ma=this.Ed.style.zIndex;this.Ed.style.zIndex="-9999";if(this.lDa>Yd.a.ada)u.AFrameworkApplication.isRtl?this.Ed.style.marginRight="0":this.Ed.style.marginLeft="0";
else{const Sa=String.format("{0}px",Math.floor(-this.Ed.offsetWidth/2));u.AFrameworkApplication.isRtl?this.Ed.style.marginRight=Sa:this.Ed.style.marginLeft=Sa;u.AFrameworkApplication.isRtl?this.Ed.style.right="50%":this.Ed.style.left="50%"}this.Ed.style.zIndex=String(ma)}else f.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}n7(){super.n7();const ma=document.getElementById(this.ap(this.mWe));ma.style.width=String.format("{0}px",this.lDa);ma.style.height=this.Cua}get nTd(){return this.V8g}get kNb(){return this.LB}get Kp(){return this.N8g}set Kp(ma){this.N8g=
ma}get msc(){return this.I5k}set msc(ma){this.I5k=ma}get nsc(){return this.Q5k}set nsc(ma){this.Q5k=ma}zLn(ma,Sa,Zb,Wc){this.Z5k=ma;this.$5k=Sa;this.a6k=Zb;this.Y5k=Wc}ALn(ma,Sa){this.d8g=ma;this.oWe=Sa}}Object(c.a)(uj,"SDXDialog",Zc.a,[]);class Ma extends Zc.a{constructor(ma,Sa,Zb,Wc){super();this.Dyb="calc(100% - 46px)";this.w9b="15px";this.Eyb="0";this.mWe="WACDialogPanel";this.lDa=695;this.nWe=462;this.Cua="80%";this.WTe=350;this.u2c="100%";this.U2c=null;this.gf=5;this.uk="AddinInstallDialog";
this.xEh=ma;this.Jyb=Sa;this.Tmm=Zb;this.lkm=Wc}hL(){super.hL();this.LB.style.width=this.u2c;this.LB.style.height=this.Dyb;this.LB.style.marginTop=this.w9b;this.LB.style.padding=this.Eyb;document.getElementById(this.ap("WACDialogButtonPanel")).style.display="none";this.M5c.setAttribute("tabindex","0");$addHandler(this.M5c,"keyup",Object(r.a)(this,this.yqn,"onKeyUp"));const ma=document.createElement("iframe");ma.setAttribute("id","InstallAddinDialog");ma.setAttribute("src","about:blank");ma.setAttribute("width",
"100%");ma.setAttribute("height","100%");ma.setAttribute("marginHeight","0");ma.setAttribute("marginWidth","0");ma.setAttribute("frameBorder","0");ma.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const Sa=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.xEh,this.Jyb,this.Tmm);ma.setAttribute("src",Sa);this.U2c=ma;$addHandler(ma,"load",Object(r.a)(this,this.onLoad,"onLoad"));$addHandler(window,
"message",Object(r.a)(this,this.onMessage,"onMessage"));this.LB.appendChild(ma);this.LB.appendChild(this.VAm())}VAm(){const ma=document.createElement("div");ma.setAttribute("tabindex","0");$addHandler(ma,"focus",Object(r.a)(this,this.Gqn,"onLoopPivotFocus"));return ma}yqn(ma){13!==ma.keyCode&&32!==ma.keyCode||this.hide()}Gqn(){this.M5c.focus()}onLoad(){this.U2c.focus()}onMessage(ma){ma=ma.rawEvent;if(ma.source===this.U2c.contentWindow&&(ma=(ma=ma.data)?ma.split("|"):null)&&0<ma.length&&("REFRESH_REQUIRED"===
ma[0]||"PRELOAD_MANIFEST"===ma[0])){m.a.instance.setItem("refreshRequired","true");const Sa={};Sa.solutionId=ma[1];Sa.version=Ma.Zmn(ma[3]);Sa.storeType=ma[4];Sa.storeId=ma[5];Sa.assetId=ma[6];Sa.targetType=Ma.yun(ma[2]);Sa.assetStoreId=ma[7];Sa.width=parseInt(ma[8]);Sa.height=parseInt(ma[9]);this.lkm(Sa)}}kub(){this.LB.style.width=this.u2c;this.LB.style.height=this.Dyb;this.LB.style.marginTop=this.w9b;this.LB.style.padding=this.Eyb;this.lDa>Yd.a.ada?(this.Ed.style.width=String.format("{0}px",Yd.a.ada),
this.Ed.style.overflowX="scroll",u.AFrameworkApplication.isRtl?this.Ed.style.right="0":this.Ed.style.left="0"):(this.Ed.style.width=String.format("{0}px",this.lDa),this.Ed.style.overflowX="hidden");this.Ed.offsetHeight>Yd.a.$ca||this.nWe+50>Yd.a.$ca?(this.Ed.style.height=String.format("{0}px",Yd.a.$ca),this.Ed.style.overflowY="scroll",this.Ed.style.top="0",u.AFrameworkApplication.isRtl?this.Ed.style.right="0":this.Ed.style.left="0",this.LB.style.minHeight=String.format("{0}px",this.WTe)):(this.Ed.style.overflowY=
"hidden",this.Ed.style.top="10%",this.Ed.style.height=this.Cua);this.Zoc()}Zoc(){if(this.Ed){var ma=this.Ed.style.zIndex;this.Ed.style.zIndex="-9999";if(this.lDa>Yd.a.ada)u.AFrameworkApplication.isRtl?this.Ed.style.marginRight="0":this.Ed.style.marginLeft="0";else{const Sa=String.format("{0}px",Math.floor(-this.Ed.offsetWidth/2));u.AFrameworkApplication.isRtl?this.Ed.style.marginRight=Sa:this.Ed.style.marginLeft=Sa;u.AFrameworkApplication.isRtl?this.Ed.style.right="50%":this.Ed.style.left="50%"}this.Ed.style.zIndex=
String(ma)}else f.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}n7(){super.n7();const ma=document.getElementById(this.ap(this.mWe));ma.style.width=String.format("{0}px",this.lDa);ma.style.height=this.Cua}get kNb(){return this.LB}dispose(){super.dispose();$removeHandler(window,"message",Object(r.a)(this,this.onMessage,"onMessage"))}static yun(ma){switch(ma){case "1":return 0;case "2":return 1;default:return 0}}static Zmn(ma){const Sa=ma.split(".");for(let Zb=0;Zb<4-
Sa.length;Zb++)ma+=".0";return ma}}Object(c.a)(Ma,"AddinInstallDialog",Zc.a,[]);var jc=a(174);class Lc{constructor(ma,Sa,Zb){this.oDe=Wc=>{try{if(Wc&&Wc.rawEvent&&Wc.rawEvent.origin&&this.RDe&&this.RDe.id){var rd=this.bTl(Wc.rawEvent.origin);const ee=this.bTl(document.domain);if(yf.a.Wn().equals(ee,rd))if(Wc.rawEvent.source&&Wc.rawEvent.source.frameElement&&Wc.rawEvent.source.frameElement.id&&yf.a.Wn().equals(Wc.rawEvent.source.frameElement.id,this.RDe.id)){rd=null;try{rd=JSON.parse(Wc.rawEvent.data)}catch(De){f.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",De.message)}rd?(rd.statusCode!==jc.a.bC||void 0!==rd.error&&rd.error?(f.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",rd.statusCode,rd.error),this.onError()):(f.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.vw(rd.authorizationCode?rd.authorizationCode:
rd.signInUrl)),$removeHandler(window,"message",this.oDe),this.RDe?document.body.contains(this.RDe)?document.body.removeChild(this.RDe):f.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):f.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):f.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else f.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else f.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else f.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(ee){f.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",ee.message)}};this.RDe=ma;this.vw=Sa;this.onError=Zb;$addHandler(window,"message",this.oDe)}bTl(ma){let Sa="";try{ma&&(Sa=-1<ma.indexOf("//")?ma.split("/")[2]:
ma.split("/")[0])&&(Sa=Sa.split(":")[0],Sa=Sa.split("?")[0])}catch(Zb){f.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Zb.message)}return Sa}static OB(ma,Sa,Zb){new Lc(ma,Sa,Zb)}}Object(c.a)(Lc,"ResponseHandler",null,[]);var gd=a(121);class Md{constructor(ma){this.bzb=ma}tryAuthenticate(ma,Sa){this.Dsh(Md.uim,()=>{ma()},Sa)}tryAuthorize(ma,Sa){this.Dsh(Md.Rfm,ma,Sa)}getSignInUrl(ma,Sa){this.Dsh(Md.Xbl,ma,Sa)}signOut(ma,Sa){this.Dsh(Md.bmm,ma,Sa)}Dsh(ma,Sa,Zb){var Wc=new gd.QueryStringBuilder("AuthenticationProxyHandler.aspx");
Wc.Zi("responseType",ma);u.AFrameworkApplication.dzb(Wc);Wc=String.format("{0}{1}&{2}",this.bzb,Wc.toString(),u.AFrameworkApplication.ui);const rd=document.createElement("iframe");rd.setAttribute("id","privateCatalogIframe");rd.setAttribute("name","privateCatalogIframe");rd.setAttribute("style","display: none");yf.a.Wn().equals(ma,Md.Xbl)||rd.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Lc.OB(rd,Sa,Zb);rd.setAttribute("src",Wc);document.body.appendChild(rd)}}
Md.Rfm="authcode";Md.uim="identitytoken";Md.Xbl="signinurl";Md.bmm="signout";Object(c.a)(Md,"AuthenticationProxy",null,[]);class Kd{}Kd.getUserId="getUserId";Kd.getLastStoreUpdate="laststoreupdate";Kd.getEntitlement="getEntitlements";Kd.getEToken="getEToken";Kd.getManifest="getManifest";Kd.getAppState="getAppState";Kd.getKilledApps="getRemovedAddins";Kd.getAppDetails="getAppDetails";Kd.removeApps="removeAddin";Kd.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Kd.getPrivateCatalogAddIns=
"getAddIns";Kd.getPrivateCatalogManifests="getAppManifests";Kd.isStoreDisabled="isStoreDisabled";Object(c.a)(Kd,"S2SWebRequestActions",null,[]);var ye=a(489);class Se{getUserId(ma,Sa){const Zb=new b.a;Zb.add(new M.a("corr",ma));this.XF(Kd.getUserId,Zb,1,Sa)}getLastStoreUpdate(ma,Sa,Zb){const Wc=new b.a;Wc.add(new M.a("lc",ma));Wc.add(new M.a("corr",Sa));this.XF(Kd.getLastStoreUpdate,Wc,1,Zb)}getEntitlement(ma,Sa,Zb,Wc){ma=new b.a;ma.add(new M.a("av",Sa));ma.add(new M.a("corr",Zb));this.XF(Kd.getEntitlement,
ma,1,Wc)}getEToken(ma,Sa,Zb,Wc,rd,ee){const De=new b.a;De.add(new M.a("cmu",ma));De.add(new M.a("cmf",Sa));De.add(new M.a("assetid",Zb));De.add(new M.a("expver",Wc));De.add(new M.a("corr",rd));this.XF(Kd.getEToken,De,1,ee)}getManifest(ma,Sa,Zb,Wc){const rd=new b.a;rd.add(new M.a("cmu",ma));rd.add(new M.a("assetid",Sa));rd.add(new M.a("corr",Zb));this.XF(Kd.getManifest,rd,1,Wc)}getAppState(ma,Sa,Zb){const Wc=new b.a;Wc.add(new M.a("ma",ma));Wc.add(new M.a("corr",Sa));this.XF(Kd.getAppState,Wc,1,Zb)}getKilledApps(ma,
Sa){const Zb=new b.a;Zb.add(new M.a("corr",ma));this.XF(Kd.getKilledApps,Zb,1,Sa)}getAppDetails(ma,Sa,Zb,Wc){const rd=new b.a;rd.add(new M.a("cmo",ma));rd.add(new M.a("corr",Zb));this.sendWithBody(Kd.getAppDetails,rd,Sa,2,Wc,!1)}removeApps(ma,Sa,Zb){const Wc=new b.a;Wc.add(new M.a("corr",Sa));this.sendWithBody(Kd.removeApps,Wc,ma,2,Zb,!1)}getLastPrivateCatalogUpdate(ma,Sa,Zb,Wc,rd,ee){const De=new b.a;De.add(new M.a("catalog","privatecatalog"));De.add(new M.a("clientCode",ma));De.add(new M.a("clientVersion",
Sa));De.add(new M.a("corr",rd));ma=String.format("authorizationCode={0}&refreshToken={1}",Zb?V.a.Sj(Zb):"",Wc?V.a.Sj(Wc):"");this.sendWithBody(Kd.getLastPrivateCatalogUpdate,De,ma,2,ee,!0)}getPrivateCatalogAddIns(ma,Sa,Zb,Wc,rd,ee){const De=new b.a;De.add(new M.a("catalog","privatecatalog"));De.add(new M.a("clientCode",ma));De.add(new M.a("clientVersion",Sa));De.add(new M.a("corr",rd));ma=String.format("authorizationCode={0}&refreshToken={1}",Zb?V.a.Sj(Zb):"",Wc?V.a.Sj(Wc):"");this.sendWithBody(Kd.getPrivateCatalogAddIns,
De,ma,2,ee,!0)}getPrivateCatalogManifests(ma,Sa,Zb,Wc,rd){const ee=new b.a;ee.add(new M.a("catalog","privatecatalog"));ee.add(new M.a("corr",Wc));ma=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",V.a.Sj(ma),Sa?V.a.Sj(Sa):"",Zb?V.a.Sj(Zb):"");this.sendWithBody(Kd.getPrivateCatalogManifests,ee,ma,2,rd,!0)}isStoreDisabled(ma,Sa){const Zb=new b.a;Zb.add(new M.a("corr",ma));this.XF(Kd.isStoreDisabled,Zb,2,Sa)}XF(ma,Sa,Zb,Wc){this.sendWithBody(ma,Sa,null,Zb,Wc,!1)}sendWithBody(ma,
Sa,Zb,Wc,rd,ee){const De=new gd.QueryStringBuilder("AddinServiceHandler.ashx");De.Zi("action",ma);De.Zi("app",ye.a[u.AFrameworkApplication.Ea.Kb.Im]);for(const Af of Sa)De.Zi(Af.key,Af.value);Sa=String.format("{0}{1}&{2}",u.AFrameworkApplication.Ea.Kb.f2,De.toString(),u.AFrameworkApplication.ui);u.AFrameworkApplication.ye.rk(Sa,Wc,Zb,null,!1,2,Af=>{let mg=null,dg=null;Af&&Af.data&&(Af.data.fk["X-BlockedForMinor"]&&"1"===Af.data.fk["X-BlockedForMinor"].toString()&&(Af.data.Ze=451),mg=Af.data.responseData,
dg=Af.data.fk);rd(Af.data.Ze,mg,dg)},Af=>{var mg=null;let dg=null;ee&&Af&&Af.data&&Af.data.responseData&&(mg=Af.data.responseData,dg=Af.data.fk);rd(Af.data.Ze,mg,dg);if(u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){mg={message:"AddinServiceHandler request failed"};mg.code=Af.data.Ze;mg.action=ma;if(Af.data.request||Af.data.request.get_headers())mg["X-UserSessionId"]=Af.data.request.get_headers()["X-UserSessionId"];408===Af.data.Ze||
503===Af.data.Ze?f.ULS.sendTraceTag(538784582,220,50,JSON.stringify(mg)):f.ULS.sendTraceTag(18392345,220,50,JSON.stringify(mg))}else f.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Af.data.Ze)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+ma,void 0,void 0,void 0,["X-UserKey"])}}Object(c.a)(Se,"S2SWebRequestManager",null,[]);var Pe=a(252),Qf=a(288);class sg{constructor(ma,Sa){this.state=ma;this.Jbb=Sa}}Object(c.a)(sg,"BackgroundAppData",null,[925]);class Bf{constructor(ma,
Sa,Zb,Wc,rd,ee,De,Af){this.o9a=null;this.San=ma;this.Gen=Wc;this.w3=Sa;this.ZD=Zb;this.fLc=rd;this.settings=ee;this.Uan=De;this.oJ=Af}get Mx(){return this.San}get taskpane(){return this.Gen}get Kp(){return this.w3}get shape(){return this.ZD}get SOg(){return this.fLc}get KN(){return this.Uan}Pnm(ma){this.oJ=new sg(0,ma)}}Object(c.a)(Bf,"AppForOffice",null,[902]);var Wf=a(8);class Xf{}Xf.c_Error="Error";Object(c.a)(Xf,"ApiResponseKeyStrings",null,[]);class Xa{constructor(ma,Sa,Zb,Wc,rd){this.EventDispId=
ma;this.ControlId=Sa;this.TargetId=Zb;this.Handler=Wc;this.Callback=rd}}Object(c.a)(Xa,"EventRegistrationParams",null,[]);var T=a(248);class Ba{constructor(ma,Sa){this.invokeDdaMethod=this.InvokeDdaMethod;this.registerDdaEventAsync=this.RegisterDdaEventAsync;this.Tb=u.AFrameworkApplication.je;this.MJj=ma;this.$Hl=Sa}InvokeDdaMethod(ma,Sa,Zb){const Wc=ma.DdaMethod.DispatchId,rd=this.MJj.ZLm(Wc);rd?(rd.parameters=ma,rd.callback=Sa,rd.krm=Zb,rd.controlId=ma.DdaMethod.ControlId,this.Tb.Qb(new he.a(2,
1,0,Object(r.a)(rd,rd.go,"go"),90,"51"))):(ma="API Call for method ID "+Wc+" does not exist:"+Wf.a.Ot(),T.a.J(507843913,802,10,ma),this.Mbi(Sa))}RegisterDdaEventAsync(ma,Sa,Zb,Wc,rd){const ee=new he.a(2,1,0,Object(r.a)(this,this.oEn,"registerEventTaskProcess"),90,"52");ee.customData=new Xa(ma,Sa,Zb,Wc,rd);this.Tb.Qb(ee)}UnregisterDdaEventAsync(ma,Sa,Zb,Wc,rd){const ee=new he.a(2,1,0,Object(r.a)(this,this.GWn,"unregisterEventTaskProcess"),90,"53");ee.customData=new Xa(ma,Sa,Zb,Wc,rd);this.Tb.Qb(ee)}oEn(ma){ma=
ma.customData;var Sa=this.$Hl.OIi(ma.EventDispId);Sa?Sa.addHandler(ma.ControlId,ma.Handler,ma.Callback,ma.TargetId):(Sa="Event for dispatch ID "+ma.EventDispId+" does not exist:"+Wf.a.Ot(),T.a.J(507843912,802,10,Sa),this.Mbi(ma.Callback))}GWn(ma){ma=ma.customData;var Sa=this.$Hl.OIi(ma.EventDispId);Sa?Sa.removeHandler(ma.ControlId,ma.Handler,ma.Callback,ma.TargetId):(Sa="Event for dispatch ID "+ma.EventDispId+" does not exist:"+Wf.a.Ot(),T.a.J(507843911,802,10,Sa),this.Mbi(ma.Callback))}Mbi(ma){if(ma){var Sa=
{};Sa[Xf.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;ma(Sa)}}}Object(c.a)(Ba,"AppForOfficeApiAdapter",null,[931]);class kb{constructor(ma,Sa,Zb,Wc){this.menuItemId=ma;this.Bw=Sa;this.SSn=Zb;this.PIm=Wc}}Object(c.a)(kb,"NewDocumentParameters",null,[]);var Ab=a(719),ic=a(315),zc=a(321),Fc=a(261),lc=a(265),nd=a(286),vd=a(253),od=a(258),Bd=a(264),Wd=a(257),ce=a(254),db=a(274);class gc{constructor(ma,Sa,Zb){this.S6d=[];this.vnh=this.AGe=!1;this.ra=ma;this.Lga=Sa;this.C3=Zb}build(){const ma=
this.ra.wI();if(!ma)return this.S6d;for(const Sa of ma)if(this.bBn(Sa),this.vnh)break;return this.S6d}bBn(ma){const Sa=vd.ParagraphReader.textLength(ma);this.cBn(ma,Sa);this.vnh||this.VAn(ma)}cBn(ma,Sa){this.AGe||(this.Lga>=Sa?this.Lga-=Sa:(this.AGe=!0,this.C3||this.S6d.push(Bd.a.yj(Object(ta.a)(Qf.a,ma),this.Lga))));this.AGe&&(this.C3>Sa-this.Lga?0<Sa&&(this.S6d.push(Bd.a.createTextRange(Object(ta.a)(Qf.a,ma),this.Lga,Sa)),this.C3-=Sa-this.Lga,this.Lga=0):0<this.C3&&(this.S6d.push(Bd.a.createTextRange(Object(ta.a)(Qf.a,
ma),this.Lga,this.Lga+this.C3)),this.C3=0));0>=this.C3&&(this.vnh=!0)}VAn(ma){this.AGe||(0<this.Lga?--this.Lga:(this.AGe=!0,this.C3||this.S6d.push(Bd.a.PDa(Object(ta.a)(Qf.a,ma)))));this.AGe&&0<this.C3&&(this.S6d.push(Bd.a.nca(Object(ta.a)(Qf.a,ma))),--this.C3);0>=this.C3&&(this.vnh=!0)}}Object(c.a)(gc,"TextSelectionBuilder",null,[]);var Dc=a(890),Ua=a(251);class Nb{constructor(ma,Sa,Zb,Wc,rd,ee,De,Af,mg,dg,Zg,Gh,wh,Ji,bi,ni,eh,nj,Al,dl,Zi,Sj,Ei,oj){this.Aa=ma;this.Fb=Sa;this.eW=Zb;this.spb=Wc;this.pa=
rd;this.xH=ee;this.Bad=De;this.Mb=Af;this.ia=mg;this.va=Zg;this.Tb=Gh;this.$b=dg;this.Ub=wh;this.nc=Ji;this.Qan=bi;this.ob=ni;this.xb=eh;this.Qk=nj;this.Ia=Al;this.Pb=dl;this.Jza=Zi;this.Cj=Sj;this.yv=Ei;this.jdn=oj}LSm(){let ma;ma="";if(this.ob.pG()){if(1<this.ob.iDb())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,mPg:ma};const Sa=this.ob.lo();if(this.V6m(Sa)){const Zb=[];this.Ia.VH(Sa,Wc=>{Wc&&Zb.push(Wc.characterData)});ma=Zb.join(Nb.Gil);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
mPg:ma}}}else if(this.ob.oy())return this.getSelectedTextRange();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,mPg:ma}}ISm(){let ma;ma="";return{returnValue:({slideInfo:ma}=this.getSelectedSlides()).returnValue,LJn:ma}}Kac(){return this.eW.gCb.documentUrl}BVm(ma){if(!ma)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;var Sa=this.Ub.hl();if(!this.va.Ga)throw Error.argumentNull("ActiveSlide is null");const Zb=this.va.Ga.ph;switch(ma){case "previous":ma=
Zb-1;break;case "next":ma=Zb+1;break;case "first":ma=0;break;case "last":ma=Sa-1;break;default:if(ma=parseInt(ma),isNaN(ma))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo}if(0>ma||ma>Sa-1)return OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound;Sa=this.Ub.fw(ma);if(!Sa)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;this.$b.Ga=Sa;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}CVm(ma){if(!ma)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;ma=parseInt(ma);if(isNaN(ma))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;
ma=this.iih(ma);if(!ma)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.$b.Ga=ma;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}UMn(ma){var Sa=this.ob.ud();if(!Sa.length){if(Sa=Object(ta.a)(32,this.ob.ys()||this.va.Ga)){var Zb=Sa.Xb;ma=this.Qk.EAe(Zb.cid,Zb.sid,0,Sa.Ju()+1,ma,"");Zb=this.Mb.Fd(7);Zb.rc(Sa);Sa.pI(ma);this.ob.selectShape(ma,!0);Zb.dispose();this.yv.zI=ma;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}else if(1===Sa.length){if(this.ob.pG())return this.lNn(ma);
if(this.ob.oy())return this.mNn(ma)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}vwh(ma,Sa,Zb,Wc,rd,ee,De,Af){if(this.Kfh(rd,0,Nb.Wve)||this.Kfh(ee,0,Nb.Wve)||this.Kfh(Zb,-Nb.Wve,Nb.Wve)||this.Kfh(Wc,-Nb.Wve,Nb.Wve)||0!==De&&1!==De)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(ma.length>this.Aa.eKe)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge;var mg=this.ob.ud().length;if(Sa||rd||ee||!mg){mg=this.va.Ga;if(!mg)throw Error.argumentNull("ActiveSlide is null");
const Zg=mg.Xb,Gh=mg.Ju();let wh=!0,Ji=new db.a(0,0);Sa?Ji=new db.a(Zb,Wc):!this.Aa.qUl||rd&&ee?Ji=this.Ub.Nja(rd,ee):wh=!1;const bi=this.Qk.MSa(!1,Zg.cid,Zg.sid,0,Ab.a.UH(Ji.x),Ab.a.UH(Ji.y),Ab.a.UH(rd),Ab.a.UH(ee),Gh+1,!0);wh||(bi.Qn(od.a.hx),bi.Qn(od.a.ix));bi.Kg=!0;bi.Ted=!0;bi.Ty=De;bi.Tja=0===De?this.jml(ma):ma;const ni=(ma=this.N3m(Af)&&this.Aa.getBooleanAppSetting("ChatPPTImgShowDesigner"))&&this.Aa.getBooleanAppSetting("ChatPPTHideImg");bi.nSb=!0;De=this.Mb.Fd(7,void 0,()=>{ni&&(this.ob.Rw(),
this.ob.Ti())},()=>{ni&&(this.ob.Rw(),this.ob.Ti())});try{if(ma&&(De.sc=Ua.a.Aye,ni)){var dg=this.Aa.Jc("ChatPPTHideImgMs",3E3);bi.ofd=Date.now()+dg;this.Tb.Qb(new he.a(2,1,dg+this.Aa.Jc("ChatPPTUnhideUpdateMs",2E3),()=>{if(0!=bi.ofd){bi.ofd=0;const eh=Object(ta.a)(284,bi.tc(this.xb.Oa));null===eh||void 0===eh?void 0:eh.Nka()}},void 0,"ShowAddInImg"))}De.rc(mg);mg.pI(bi);this.ob.selectShape(bi,!0)}catch(eh){T.a.J(509112541,802,10,"setSelectedImageData got exception "+eh)}finally{De&&De.dispose()}this.yv.zI=
bi;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}if(1===mg&&(dg=this.ob.lo())&&dg.v5c){mg=this.va.Ga;if(!mg)throw Error.argumentNull("ActiveSlide is null");Sa=this.ixc(mg,dg);Sa.Kg=!0;Sa.Ty=De;Sa.Tja=0===De?this.jml(ma):ma;Sa.nSb=!0;ma=this.Mb.Fd(7);try{ma.rc(mg),mg.i_([dg]),mg.pI(Sa),this.ob.selectShape(Sa,!0)}finally{ma&&ma.dispose()}this.yv.zI=Sa;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}T.a.J(512263113,802,10,"No placehoder seleted or multi-shape seleted.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}N3m(ma){return this.Aa.La("ChatPPTOrigin")===
ma}OAb(){return this.Aa.OAb}E3m(){return this.Fb.getBooleanAppSetting(Oc.a.mze)}pOm(ma){if(!ma)return null;ma=this.Qan.FIa(ma);ma=0===ma.KN?ma.node:this.va.Ga;if(!ma)return null;ma=Object(ta.a)(31,this.nc.Cg(ma));return ne(ma.Oe)}rvk(ma,Sa){if(ma&&Sa)if(cd.a("UseUndoTransactionForSaveSettingToApp")){var Zb=this.Mb.Fd(15,void 0,void 0,void 0,!0);try{Zb.rc(ma),Zb.sc=Ua.a.rEa,Dc.a.xzh(this.Bad.value,ma,Sa)}finally{Zb&&Zb.dispose()}}else{Zb=this.Mb.Fd(4);try{Zb.rc(ma),Dc.a.xzh(this.Bad.value,ma,Sa),this.$b.gj.kda()}finally{Zb&&
Zb.dispose()}}}Uzd(ma,Sa,Zb){const Wc=new n.a;Wc.gf=4;Wc.xG(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,rd=>{2===rd||0===rd?Zb(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled):(rd=new kb("blank","agave",ma?Nb.Kmn:Nb.Lmn,ma),this.jdn.create(Sa,Zb,rd).Uzd())})}mg(){return this.ob.mg()}ud(){return this.ob.ud()}OSm(){var ma=this.ob.ud();if(!(ma.length&&this.ob.oy()&&this.pa.value&&this.pa.value.Ua.length))return[];const Sa=this.pa.value.Ua.ha(0);
return(ma=Nb.bSm(ma[0],Sa))&&2===ma.length?ma:[]}fWn(ma){if(!ma)return!1;this.ob.fJa();if(!ma.length)return!0;ma[0]!==this.va.Ga&&(this.$b.Ga=ma[0]);for(const Sa of ma)Sa&&this.ob.mSa(Sa);return!0}eWn(ma){if(!ma)return!1;if(!ma.length)return this.ob.Ti(),!0;this.ob.zka(ma,!0);return!0}gWn(ma,Sa,Zb){if(!Nb.RDl(ma))return!1;if(0>Sa)return!0;ma=(new gc(ma,Sa,Zb)).build();ma=[new ic.Selection(ma,!0)];ma=new zc.SelectionCollection(ma,0);this.ob.YB(ma);return!0}getSelectedSlides(){let ma;ma="";var Sa=null;
if(!Sa||!Sa.length){var Zb=this.ob.ys()||this.va.Ga;Sa||(Sa=[]);Zb&&Sa.push(Zb)}if(!Sa.length)return T.a.J(512263111,802,10,"Unexpected error: cannot get current slide."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,slideInfo:ma};Zb=[];for(const Wc of Sa){Sa=Wc.ph+1;if(!Sa)return T.a.J(512263110,802,10,"Returned slide index is invalid."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,slideInfo:ma};Array.add(Zb,[Wc.sid.toString(),Wc.title||"",Sa.toString()])}ma=
P.c(Zb);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,slideInfo:ma}}getSelectedTextRange(){var ma=[];for(let Sa=0;Sa<this.pa.value.Ua.length;Sa++){const Zb=this.pa.value.Ua.ha(Sa);Array.add(ma,this.Qac(Zb))}ma=ma.join(Nb.Gil);if(ma===nd.AParagraphNode.SZ)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,mPg:ma};ma=nd.AParagraphNode.Pdc(ma);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,mPg:ma}}V6m(ma){if(!ma)return!1;let Sa=
ma.Vsa||ma.Uq||ma.rg||ma.Zc;if(!Sa&&ma.pl)switch(ma.placeholderType){case 0:case 2:case 1:case 3:case 10:case 8:Sa=!0}return Sa}W6m(ma){if(!ma)return!1;let Sa=ma.Vsa||ma.Uq;if(!Sa&&ma.pl)switch(ma.placeholderType){case 0:case 2:case 1:case 3:case 8:Sa=!0}return Sa}Qac(ma){let Sa="";if(ma)for(let Zb=0;Zb<ma.length;Zb++){const Wc=ma.ha(Zb),rd=Wc.Va,ee=Wc.Ib-rd;let De="";vd.ParagraphReader.me(Wc.node)&&(De=Wc.node.characterData);switch(Wc.contextId){case Wd.a.paragraph:Sa+=De+"\r";break;case Wd.a.textRange:0<
ee&&(Sa+=De.substr(rd,ee));break;case Wd.a.endOfParagraph:Sa+="\r"}}return Sa}iih(ma){var Sa=this.va.presentation;if(!Sa)throw Error.argumentNull("Presentation is null");Sa=Sa.slides||[];for(let Zb=0;Zb<Sa.length;Zb++)if(Sa[Zb].Xb.sid===ma)return Object(ta.a)(32,Sa[Zb]);return null}mNn(ma){if(!this.pa.value||!this.xH.value||!this.spb.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(1===this.pa.value.Ua.length){if(!Fc.SelectionEditor.Bx(this.pa.value.Ua.mb)&&32!==this.ia.Cb(ce.a.bJa,
2))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var Sa=this.pa.value.Ua.mb.Xa;const Zb=Sa.node,Wc=Sa.Va;Sa=Sa.Ib;const rd=this.Mb.Fd(7);try{rd.rc(Zb);let ee=null;ee=Wc===Sa?Bd.a.yj(Zb,Wc):Bd.a.createTextRange(Zb,Wc,Sa);this.xH.value.replaceTextRange(ee,ma)}finally{rd.dispose()}Sa=Wc+ma.length;this.pa.value.setSelection(lc.SelectionFactory.Y7(Zb,Wc,Sa));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}T.a.J(512263107,802,10,"SetTextForSelectedTextRange is called when there are more than one shape selected.");
return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}lNn(ma){if(!this.pa.value||!this.xH.value||!this.spb.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const Sa=this.ob.lo();if(!Sa)return ma="Fail to get shape while setting selected shape's text: shape returned as null: "+Wf.a.Ot(),T.a.J(512263106,802,10,ma),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.W6m(Sa)){const Zb=this.Pb.Hc(Sa),Wc=this.Mb.Fd(7);try{Wc.rc(Zb);Sa.deleteParagraph();this.spb.value.mT(Zb,
!0);this.Jza.ii(Zb);const rd=Zb.currentNode,ee=this.Cj.textLength(rd),De=Bd.a.createTextRange(rd,0,ee);this.xH.value.replaceTextRange(De,ma)}finally{Wc.dispose()}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}T.a.J(512263105,802,10,"Shape is not supported by SetDataAsync");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Kfh(ma,Sa,Zb){return ma<Sa||Zb<ma}jml(ma){return"data:image/png;base64,"+ma}ixc(ma,Sa){if(!ma)return null;var Zb=ma.Xb;ma=ma.Ju();let Wc;const rd=Tc.a.c2,
ee=Tc.a.F6;Wc=Sa?Sa.SPb(Tc.a.c2,Tc.a.F6):this.Ub.Nja(Tc.a.c2,Tc.a.F6);Zb=this.Qk.MSa(!0,Zb.cid,Zb.sid,0,Wc.x,Wc.y,rd,ee,ma+1,!0);Sa&&(Zb.msa=Sa.id);return Zb}static RDl(ma){if(!ma)return!1;let Sa=ma.Vsa||ma.Uq;if(!Sa&&ma.pl)switch(ma.placeholderType){case 0:case 2:case 1:case 3:case 5:case 6:case 8:Sa=!0}return Sa}static oUm(ma,Sa){ma=ma.wI();if(!ma||!Sa)return 0;let Zb=0;for(const Wc of ma){if(Wc===Sa)break;Zb+=vd.ParagraphReader.textLength(Object(ta.a)(Qf.a,Wc))+1}return Zb}static bSm(ma,Sa){if(!Nb.RDl(ma)||
!Sa)return[];var Zb=-1;let Wc=0;for(const rd of Sa){Sa=vd.ParagraphReader.me(rd.node)?vd.ParagraphReader.textLength(rd.node):0;if(-1===Zb)switch(Zb=vd.ParagraphReader.me(rd.node)?Nb.oUm(ma,Object(ta.a)(427,rd.node)):0,rd.contextId){case Wd.a.paragraph:break;case Wd.a.textRange:case Wd.a.ng:Zb+=rd.Va;break;case Wd.a.endOfParagraph:Zb+=Sa;break;default:return[]}switch(rd.contextId){case Wd.a.paragraph:Wc+=Sa+1;break;case Wd.a.textRange:Wc+=Math.max(0,rd.Ib-rd.Va);break;case Wd.a.endOfParagraph:Wc+=
1}}return[Zb,Wc]}}Nb.Gil=" ";Nb.Wve=169056;Nb.Lmn="streamEmpty";Nb.Kmn="streamBase64";Object(c.a)(Nb,"AppForOfficeApiFacadeEditorImpl",null,[930]);class hc{xyl(ma,Sa,Zb){if(Zb.Cib(ma))f.ULS.sendTraceTag(512360733,806,10,"[HandlePersistedOwnerApp]This method should not be invoked when OwnerApp already exists.");else if(ma=Zb.hxf(ma)){const Wc={};Wc.solutionId=ma.Mx.id;Wc.version=ma.Mx.version;Wc.storeType=ma.Mx.storeType;Wc.storeId=ma.Mx.store;Wc.assetId=ma.Mx.assetId;Wc.assetStoreId=ma.Mx.assetStoreId;
Wc.targetType=1;Wc.isAddinCommands=!0;Wc.addinCommandsActionType=1;Wc.sharedRuntimeId=ma.oJ?ma.oJ.Jbb:null;Wc.backgroundState=ma.oJ?ma.oJ.state:-1;ma.settings=Sa;Zb.W3h.eS().Qa(Ua.a.c9c,2,Wc);return!0}return!1}D3m(ma,Sa){if(!ma&&!Sa)return!0;if(!ma||!Sa||Object.keys(ma).length!==Object.keys(Sa).length)return!1;for(const rd in ma){var Zb=rd,Wc=ma[rd];if(!(Zb in Sa)||Sa[Zb]!==Wc)return!1}return!0}}Object(c.a)(hc,"AppForOfficeAppSettingProxy",null,[]);class Qc{constructor(ma,Sa,Zb,Wc,rd,ee){this._id=
ma;this.Bsd=Sa;this.x9=Zb;this.cye=Wc;this.xEh=rd;this.Lfm=ee}get id(){return this._id}get version(){return this.Bsd}get store(){return this.x9}get storeType(){return this.cye}get assetId(){return this.xEh}get assetStoreId(){return this.Lfm}}Object(c.a)(Qc,"AppForOfficeReference",null,[928]);class $c{constructor(ma,Sa){this._id=ma;this.hmm=Sa}get id(){return this._id}get slideId(){return this.hmm}}Object(c.a)($c,"AppForOfficeShape",null,[927]);class Hd{constructor(ma,Sa,Zb,Wc,rd,ee=null,De=!1){this.chm=
ma;this.mnm=Sa;this.R9b=Zb;this.xlm=Wc;this.APh=rd;this.isForUILessAction=De;this.zkm=ee}get Neh(){return this.chm}get visibility(){return this.mnm}get width(){return this.R9b}get row(){return this.xlm}get ownerAddinSolutionId(){return this.APh}get ownerAddinStoreType(){return this.zkm}}Object(c.a)(Hd,"AppForOfficeTaskpane",null,[926]);class $d{constructor(ma,Sa,Zb,Wc=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=ma;this.controlId=Sa;this.ddaBinding=Zb;this.ArrayData=
Wc}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(c.a)($d,"DdaEventArgs",null,[]);class ue{constructor(ma,Sa){this.xGe=null;this.Hd=ma;this.ia=Sa}OIi(ma){this.xGe||this.pwn();if(!ma||!this.xGe[ma])return null;ma=this.xGe[ma];ma.Tc=this.Hd;ma.Gs=this.ia;return ma}Vjl(ma){const Sa=this.xGe;for(const Zb in Sa)Sa[Zb].removeHandler(ma)}set(ma,Sa){this.xGe[ma]=Sa}}Object(c.a)(ue,"ApiEventStore",null,[]);class Fe{constructor(){this.nA=this.ia=this.Hd=null;this.uo={}}get handlers(){return this.uo}get Gs(){return this.ia}set Gs(ma){this.ia=
ma}get Tc(){return this.Hd}set Tc(ma){this.Hd=ma}raiseEvent(ma,Sa=null){ma=this.Pac(ma);if(Sa){var Zb=this.uo[Sa];Zb&&Zb(ma)}else for(Zb in Sa=this.uo,Sa){const Wc=Sa[Zb];Wc&&Wc(ma)}}addHandler(ma,Sa,Zb=null){this.uo[ma]=Sa;this.Goc(Zb)}removeHandler(ma,Sa,Zb=null){delete this.uo[ma];this.Goc(Zb)}get result(){return this.nA}Goc(ma){this.O9(ma,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}O9(ma,Sa){ma&&(this.nA={},this.nA[Xf.c_Error]=Sa,ma(this.nA))}}Object(c.a)(Fe,"ApiEvent",null,[941]);class cf extends Fe{constructor(){super()}Pac(ma){return ma}static get instance(){cf.St||
(cf.St=new cf);return cf.St}}cf.St=null;Object(c.a)(cf,"ActivationStatusChangedEvent",Fe,[]);class Ee extends Fe{constructor(){super()}Pac(){return"view"}static get instance(){Ee.St||(Ee.St=new Ee);return Ee.St}}Ee.St=null;Object(c.a)(Ee,"ActiveViewChangedEvent",Fe,[]);var xe=a(21);class cg extends Fe{constructor(){super();this.tBj=null}Pac(){return null}get V$b(){!this.tBj&&this.Tc&&(this.tBj=Ca.getInstance(this.Tc.nq));return this.tBj}addHandler(ma,Sa,Zb=null,Wc=null){this.Tc?this.Tc.pP.OAb()?ma in
this.handlers?this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(f.ULS.sendTraceTag(508360601,802,50,"AddHandler was called."),this.showDialog(ma,Wc,rd=>{rd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(xe.a.count(this.handlers)||this.V$b.oqm(Object(r.a)(this,this.l0j,"onMessageParentEvent")),this.handlers[ma]=Sa,this.Tc.nq?({value:rd}=Ca.Fxl().Uh(ma),rd?(this.Tc.nq.setActivationCompletedStatus(rd.uk,!0),this.Tc.idd(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),
rd.uk,!0)):f.ULS.sendTraceTag(508360600,806,15,"Show dialog successed but get dialogInfo failed")):f.ULS.sendTraceTag(508360599,806,15,"Show dialog successed but ContextActivationManager is null"),this.Goc(Zb)):(f.ULS.sendTraceTag(508360598,806,10,"Show dialog failed. Error code: {0}",rd.toString()),this.O9(Zb,rd))})):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(ma,Sa,Zb=null){this.Tc?this.Tc.pP.OAb()?
ma in this.handlers?(f.ULS.sendTraceTag(508360597,802,50,"RemoveHandler was called."),this.V$b.fym(ma,Wc=>{delete this.handlers[ma];xe.a.count(this.handlers)||this.V$b.aZl(Object(r.a)(this,this.l0j,"onMessageParentEvent"));Wc!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&f.ULS.sendTraceTag(508360596,806,10,"Close dialog failed. Error code: {0}",Wc.toString());this.O9(Zb,Wc)})):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):
this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}showDialog(ma,Sa,Zb){try{this.V$b.showDialog(Sa,ma,Zb,null)}catch(Wc){f.ULS.sendTraceTag(508360595,806,10,"DialogMessageReceivedEvent: Show dialog failed. Exception message: {0}",Wc.message),Zb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}l0j(ma,Sa){if(Sa.controlId in this.uo){ma={};ma[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=Sa.messageType;ma[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=
Sa.messageContent;ma[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=Sa.gUj;ma[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=Sa.acb;const Zb=this.uo[Sa.controlId];Zb&&Zb(ma);Sa.messageType===OSF.DialogMessageType.DialogClosed&&(delete this.uo[Sa.controlId],xe.a.count(this.uo)||this.V$b.aZl(Object(r.a)(this,this.l0j,"onMessageParentEvent")))}}static get instance(){cg.St||(cg.St=new cg);return cg.St}}cg.St=null;Object(c.a)(cg,"DialogMessageReceivedEvent",
Fe,[]);class Gg extends Fe{constructor(){super()}Pac(){return null}addHandler(ma,Sa,Zb=null){this.Tc?this.Tc.pP.OAb()?(Sa=this.Tc.mGd(ma))&&Sa.taskpane&&Sa.taskpane.isForUILessAction?(this.Gs.Qa(eb.a.eVg,2,ma),this.Goc(Zb)):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(ma,Sa,Zb=null){this.Tc?this.Tc.pP.OAb()?(Sa=this.Tc.mGd(ma))&&
Sa.taskpane?Sa.taskpane.isForUILessAction?(this.Gs.Qa(eb.a.xMf,2,ma),this.Goc(Zb)):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Object(c.a)(Gg,"DialogNotificationShownInAddinEvent",Fe,[]);class Of extends Fe{constructor(){super();this.nq=this.B5h=null}Pac(){return null}get V$b(){this.B5h||
(this.B5h=Ca.getInstance(this.contextActivationMgr));return this.B5h}get contextActivationMgr(){!this.nq&&this.Tc&&(this.nq=this.Tc.nq);return this.nq}addHandler(ma,Sa,Zb=null){this.Tc&&!this.Tc.pP.OAb()?this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):ma in this.uo?this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(xe.a.count(this.uo)||this.V$b.nqm(Object(r.a)(this,this.IQl,"onMessageDialogEvent")),this.uo[ma]=Sa,this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess))}removeHandler(ma,
Sa,Zb=null){this.Tc&&!this.Tc.pP.OAb()?this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):ma in this.uo?(delete this.uo[ma],xe.a.count(this.uo)||this.V$b.dGn(Object(r.a)(this,this.IQl,"onMessageDialogEvent")),this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}IQl(ma,Sa){Sa.controlId in this.uo&&(ma={},ma[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=Sa.messageType,ma[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=
Sa.messageContent,ma[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=Sa.gUj,ma[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=Sa.acb,(Sa=this.uo[Sa.controlId])&&Sa(ma))}static get instance(){Of.St||(Of.St=new Of);return Of.St}}Of.St=null;Object(c.a)(Of,"DialogParentMessageReceivedEvent",Fe,[]);class ch extends Fe{constructor(){super()}Pac(){return{}}static get instance(){ch.St||(ch.St=new ch);return ch.St}}ch.St=null;Object(c.a)(ch,"DocumentSelectionChangedEvent",
Fe,[]);class vg extends Fe{constructor(){super()}Pac(){return null}raiseEvent(ma,Sa){try{const Zb=this.uo[Sa];Zb&&(Sa={},Sa[OSF.DDA.Marshaling.ThemingKeys.DocumentTheme.toString()]=ma,Zb(Sa))}catch(Zb){T.a.J(507843914,802,10,"DocumentThemeChanged Event failed, message: "+Zb.message)}}static get instance(){vg.St||(vg.St=new vg);return vg.St}}vg.St=null;Object(c.a)(vg,"DocumentThemeChangedEvent",Fe,[]);class jg extends Fe{constructor(){super();this.Sqn=ma=>{for(const Sa of Object.values(jg.St.uo))Sa&&
Sa(ma)}}Pac(){return null}addHandler(ma,Sa,Zb=null){this.uo.count||this.Tc.nq.setOfficeThemeChangedHandler(this.Sqn);this.uo[ma]=Sa;this.Goc(Zb)}removeHandler(ma,Sa,Zb=null){this.uo.hasOwnProperty(ma)?(delete this.uo[ma],this.Goc(Zb)):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}static get instance(){jg.St||(jg.St=new jg);return jg.St}}jg.St=null;Object(c.a)(jg,"OfficeThemeChangedEvent",Fe,[]);class sh{constructor(ma){this.vlm=ma}onRegisterRichApiEvent(){}onUnregisterRichApiEvent(){}sendRichApiMessageEventEntriesToControl(ma,
Sa){this.vlm.executeHandlers(ma,Sa)}}Object(c.a)(sh,"RichApiEventManagerHost",null,[942]);class Zh extends Fe{constructor(){super();this.XRh=null}Pac(ma){return ma}addHandler(ma,Sa,Zb=null,Wc=null){this.Tc&&ha.a(Wc)?(this.XRh||(this.XRh=new sh(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.XRh)),this.uo[ma]=Sa,this.Goc(Zb)):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(ma,Sa,Zb=null,Wc=null){this.Tc&&ha.a(Wc)&&ma in this.uo?(delete this.uo[ma],
this.Goc(Zb)):this.O9(Zb,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}executeHandlers(ma,Sa){const Zb={};Zb[OSF.DDA.WAC.UniqueArguments.ArrayData]=Sa;(ma=this.uo[ma])&&ma(Zb)}static get instance(){return Zh.Wa||(Zh.Wa=new Zh)}}Zh.Wa=null;Object(c.a)(Zh,"RichApiMessageEvent",Fe,[]);class ae extends Fe{constructor(){super()}Pac(ma){return ma}static get instance(){ae.St||(ae.St=new ae);return ae.St}}ae.St=null;Object(c.a)(ae,"SettingsChangedEvent",Fe,[]);class Wi extends ue{constructor(ma,Sa){super(ma,
Sa)}pwn(){this.xGe={};this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,ae.instance);this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,Ee.instance);this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,cf.instance);this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,vg.instance);this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,jg.instance);this.set(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,ch.instance);this.set(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,
cg.instance);this.set(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Of.instance);this.set(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,new Gg);this.set(OSF.DDA.EventDispId.dispidRichApiMessageEvent,Zh.instance)}}Object(c.a)(Wi,"EditorEventStore",ue,[]);class ci{constructor(ma){this.lcg=null;this.Hd=ma}ZLm(ma){this.lcg||this.xwn();if(!ma||!this.lcg[ma])return null;if(ma=this.lcg[ma]())ma.Tc=this.Hd;return ma}set(ma,Sa){this.lcg[ma]=Sa}}Object(c.a)(ci,"ApiMethodFactory",
null,[]);class Fi{constructor(ma,Sa,Zb,Wc){this.Kp=ma.toLowerCase();this.fileSize=Sa;this.ZCi=Wc;this.K5l=Zb}}Object(c.a)(Fi,"DocumentCopy",null,[]);var hh=a(671),wf=a(470);class qg extends hh.a{constructor(ma,Sa,Zb,Wc,rd,ee,De){super();this.fK=ma.string;this.w3=Sa;this.vab=Zb;this.JBb=rd;this.nen=Wc;this.LZf=ee;this.p$c=De;this.Urb=Object(r.a)(this,this.Spn,"onGetDocumentCopyChunkFinished");this.onError=Object(r.a)(this,this.Rpn,"onGetDocumentCopyChunkError")}start(){this.eNe=!1;wf.a.CMi(this.fK,
this.w3,this.vab,this.nen,this.JBb,Object(r.a)(this,this.Axa,"handleWebserviceResponse"),Object(r.a)(this,this.zxa,"handleWebserviceError"))}Spn(ma){if(ma.nfa){const Sa={};ma=ma.result;Sa.value=ma.FileData;Sa.errorCode=ma.ErrorCode;this.LZf(this.w3,Sa)}else this.handleError(ma)}Rpn(ma){this.handleError(ma)}handleError(ma){this.p$c&&(ma=ma.error,this.p$c(this.w3,!!ma&&2===ma.type))}}Object(c.a)(qg,"GetDocumentCopyChunkTask",hh.a,[]);class Lh extends hh.a{constructor(ma,Sa,Zb,Wc,rd,ee){super();this.fK=
ma.string;this.w3=Sa;this.vab=Zb;this.JBb=Wc;this.LZf=rd;this.p$c=ee;this.Urb=Object(r.a)(this,this.Vpn,"onGetDocumentCopyFinished");this.onError=Object(r.a)(this,this.Tpn,"onGetDocumentCopyError")}start(){this.eNe=!1;wf.a.yul(this.fK,this.w3,this.vab,Object(r.a)(this,this.Axa,"handleWebserviceResponse"),Object(r.a)(this,this.zxa,"handleWebserviceError"))}Vpn(ma){if(ma.nfa){const Sa={};ma=ma.result;Sa.fileSize=ma.FileSize;Sa.errorCode=ma.ErrorCode;Sa.format=this.vab;Sa.sliceSize=this.JBb;this.LZf(this.w3,
Sa)}else this.handleError(ma)}Tpn(ma){this.handleError(ma)}handleError(ma){this.p$c&&(ma=ma.error,this.p$c(this.w3,!!ma&&2===ma.type))}}Object(c.a)(Lh,"GetDocumentCopyTask",hh.a,[]);class dh extends hh.a{constructor(ma,Sa,Zb,Wc,rd,ee,De){super();this.fK=ma.string;this.w3=Sa;this.vab=Zb;this.Jcn=Wc;this.Icn=rd;this.LZf=ee;this.p$c=De;this.Urb=Object(r.a)(this,this.Ern,"onReleaseDocumentCopyFinished");this.onError=Object(r.a)(this,this.Drn,"onReleaseDocumentCopyError")}start(){this.eNe=!1;wf.a.uje(this.fK,
this.w3,this.vab,this.Jcn,this.Icn,Object(r.a)(this,this.Axa,"handleWebserviceResponse"),Object(r.a)(this,this.zxa,"handleWebserviceError"))}Ern(ma){if(ma.nfa){const Sa={};Sa.errorCode=ma.result.ErrorCode;this.LZf(this.w3,Sa)}else this.handleError(ma)}Drn(ma){this.handleError(ma)}handleError(ma){this.p$c&&(ma=ma.error,this.p$c(this.w3,!!ma&&2===ma.type))}}Object(c.a)(dh,"ReleaseGetDocumentCopyTask",hh.a,[]);class wg{constructor(){this.gqh=null}start(){this.gqh.start()}static aBm(ma,Sa,Zb,Wc,rd,ee){const De=
new wg;De.gqh=new Lh(ma,Sa,Zb,Wc,rd,ee);return De}static $Am(ma,Sa,Zb,Wc,rd,ee,De){const Af=new wg;Af.gqh=new qg(ma,Sa,Zb,Wc,rd,ee,De);return Af}static Sml(ma,Sa,Zb,Wc,rd,ee,De){const Af=new wg;Af.gqh=new dh(ma,Sa,Zb,Wc,rd,ee,De);return Af}}Object(c.a)(wg,"AppForOfficeTask",null,[]);class bg{constructor(){this.UCj=1;this.I6k=new Mb.a}get wac(){return this.I6k}Vvm(ma,Sa,Zb,Wc){const rd=this.Cvl();ma=new Fi(ma,Sa,Zb,Wc);this.wac.K(rd.toString(),ma);return rd}fCl(ma,Sa){for(const Zb of this.wac){const Wc=
Zb.value;if(Wc.Kp===ma.toLowerCase()&&Wc.ZCi===Sa)return!0}return!1}Ttl(ma){return this.wac.ha(ma.toString())}pFn(ma){this.wac.remove(ma.toString())}uje(ma,Sa,Zb,Wc){(Wc&&this.qFn(Sa)||Zb&&this.jFn())&&wg.Sml(ma,Sa,4,Zb,Wc,()=>{},()=>{}).start()}jFn(){let ma=!1;0<this.wac.count&&(this.I6k=new Mb.a,ma=!0);return ma}qFn(ma){if(!ma)return!1;const Sa=[];for(const Zb of this.wac)Zb.value.Kp===ma.toLowerCase()&&Sa.push(Zb.key);for(ma=0;ma<Sa.length;ma++)this.wac.remove(Sa[ma]);return 0<Sa.length}Cvl(){return this.UCj++}}
Object(c.a)(bg,"GetDocumentCopyHelper",null,[896]);class vh{constructor(ma,Sa){this.DIl=Sa.length;this.JBb=ma;this.men=Math.ceil(this.DIl/ma);this.Qzm(Sa)}Qzm(ma){for(let Sa=0;Sa<this.men;Sa++){const Zb=Sa*this.JBb;ma.slice(Zb,Math.min(Zb+this.JBb,this.DIl))}}}Object(c.a)(vh,"DocumentCopyCache",null,[]);class fi{constructor(){this.SKj=this.BMj=null;this.TKj=this.CMj=0}add(ma,Sa,Zb,Wc){4===Sa?(this.CMj=ma,this.BMj=new vh(Zb,Wc)):3===Sa&&(this.TKj=ma,this.SKj=new vh(Zb,Wc))}remove(ma){this.CMj===ma?
(this.CMj=0,this.BMj=null):this.TKj===ma&&(this.TKj=0,this.SKj=null)}contains(ma){return 4===ma&&!!this.BMj||3===ma&&!!this.SKj}}Object(c.a)(fi,"PerAppCache",null,[]);class Jg{get cache(){return Jg.oi}get $Ci(){return Jg.Sbn}fCl(ma,Sa){return ma in this.cache&&this.cache[ma].contains(Sa)}CMi(){}uje(ma){if(ma.toString()in this.$Ci){const Sa=this.$Ci[ma.toString()];delete this.$Ci[ma.toString()];this.cache[Sa].remove(ma)}}Cvl(){return Jg.UCj++}}Jg.oi={};Jg.Sbn={};Jg.UCj=1;Object(c.a)(Jg,"GetFileApiProxy",
null,[944]);class Dg{constructor(ma,Sa,Zb){this.Pp=0;this.controlId=this.Idb=this.DY=this.$Fe=this.Hd=this.nA=null;this.parameters=ma;this.callback=Sa;this.krm=Zb;new Jg;this.iXd=new hc;this.bcc=new bg}get xbh(){this.iXd||(this.iXd=new hc);return this.iXd}get hTa(){return this.bcc}get UIn(){this.DY||(this.DY=ia.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"));return this.DY}get p0m(){return this.Idb||(this.Idb=ia.a.instance.Na("Postmessage.IHostPostmessenger"))}get errorCode(){return this.Pp}set errorCode(ma){this.Pp=
ma}get result(){return this.nA}set result(ma){this.nA=ma}get pP(){return this.$Fe}get Tc(){return this.Hd}set Tc(ma){(this.Hd=ma)?(this.$Fe=this.Hd.pP,this.bcc=this.Hd.hTa):this.bcc=this.$Fe=null}go(){this.nA={};try{this.dw()}catch(ma){this.H9m(ma)}this.Aka()}H9m(ma){this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;T.a.J(18396573,802,10,"Error when executing API: {0}",ma.toString())}Aka(){this.Pp!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&T.a.J(18985232,802,10,"Error when API method failed. m_errorCode = {0}",
this.Pp);this.nA[Xf.c_Error]=this.Pp;this.callback(this.nA)}QIi(){return this.controlId?this.Tc?this.Tc.rTa.$Ja(this.controlId):null:null}bMm(){if(!this.controlId)return null;let ma=null;this.Tc&&(ma=this.Tc.rTa.$Ja(this.controlId));return ma?0===ma.KN?this.Tc.Vrl(ma.shape.slideId,ma.shape.id):1===ma.KN?this.Tc.Cib(ma.Mx.id):null:null}MXi(ma){return ma?this.Tc?this.Tc.MXi(ma):null:null}}Object(c.a)(Dg,"ApiMethod",null,[]);class fj extends Dg{constructor(){super()}dw(){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[F.a.Jfl][F.a.Ifl],
this.parameters);this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Run AddinCommandsRuntimeManager InvocationCompleted."}}Object(c.a)(fj,"AppCommandInvocationCompletedMethod",Dg,[]);class kj extends Dg{constructor(){super()}go(){this.nA={};this.dw()}dw(){if(this.pP)try{const ma=this.parameters[OSF.DDA.Marshaling.CreateDocument.Base64].toString();ma&&ma.length>this.Tc.W3h.Md.dKe?(f.ULS.sendTraceTag(507843919,802,15,"Too large base64 stream size:{0}",ma.length),this.Pp=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.Aka()):this.pP.Uzd(ma,Object(r.a)(this,this.LAm,"createDocumentSuccessCallback"),Object(r.a)(this,this.KAm,"createDocumentFailCallback"))}catch(ma){T.a.J(507843918,802,10,"Exception thrown at CreateDocumentMethod: "+ma.toString()),this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.Aka()}else this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.Aka()}LAm(ma){const Sa=new n.a;Sa.gf=4;Sa.xG(CommonUIStrings.l_GeneralAddInMessageDialogTitle,
CommonUIStrings.l_OpenWindowConsentMessage,1,Zb=>{1===Zb&&window.open(ma);this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.Aka()})}KAm(ma){this.Pp=ma?ma:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.Aka()}get description(){return"Create a new ppt document in the user's default folder."}}Object(c.a)(kj,"CreateDocumentMethod",Dg,[]);var ng=a(42),Oh=a(91);class Tf{static vDn(ma){const Sa=new Map;Sa.set("ApiId",ma.toString());ng.Health.instance.recordKpiUsage(Tf.z0l,Oh.b.SuccessBased,
Tf.y0l,Sa)}static uDn(ma,Sa,Zb){const Wc=new Map;Wc.set("ApiId",ma.toString());ng.Health.instance.recordKpiSuccess(Tf.z0l,{extendedProperties:Wc,durationMs:Tf.Aul(Sa,Zb)})}static rXl(ma){const Sa=new Map;Sa.set("fWacPartition",ma.toString());ng.Health.instance.recordKpiUsage(Tf.A0l,Oh.b.SuccessBased,Tf.y0l,Sa)}static Ijk(ma,Sa){ng.Health.instance.recordKpiSuccess(Tf.A0l,{durationMs:Tf.Aul(ma,Sa)})}static Aul(ma,Sa){let Zb=null;ma&&Sa&&(Zb=Sa-ma);return Zb}}Tf.z0l="PptApiCall";Tf.A0l="PptApiRequest";
Tf.y0l="pptom";Object(c.a)(Tf,"PptWacApiTelemetry",null,[]);class Kh{constructor(){this.ver=0;this.exec=this.sel=null}}Object(c.a)(Kh,"ApiRequest",null,[]);class wi{constructor(){this.txRn=this.shpLst=this.sldLst=null}}Object(c.a)(wi,"SelectionData",null,[]);const Uf=(ma,Sa)=>{var Zb=Object,Wc=Zb.assign,rd=new Kh,ee=Object,De=ee.assign,Af=new wi,mg=ma.pP.mg();const dg=[];if(mg){dg.length=mg.length;for(var Zg=0;Zg<mg.length;Zg++)dg[Zg]=mg[Zg].Xb.toString()}mg=ma.pP.ud();Zg=[];if(mg){Zg.length=mg.length;
for(let Gh=0;Gh<mg.length;Gh++)Zg[Gh]=mg[Gh].get_shapeId().toString()}ma=Wc.call(Zb,rd,{ver:1,exec:Sa,sel:De.call(ee,Af,{sldLst:dg,shpLst:Zg,txRn:ma.pP.OSm()})});return Sys.Serialization.JavaScriptSerializer.serialize(ma)},Ci=ma=>{if(u.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.PowerPointOnline.IncludeWacApiHostTypeRegister")){var Sa=ma.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Zb=Sa.addMethod("AreShortcutsInUse",
3,"Object[]",1,0,"AreShortcutsInUse",0);Zb.addParameter("shortcuts","String[]",1,null,0);Sa.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Zb=Sa.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Zb.addParameter("shortcuts","Object",1,null,0);Sa=ma.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Zb=Sa.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Zb.addParameter("pickerCustomizationJsonString",
"String",1,null,0);Sa=ma.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);Zb=Sa.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);Zb.addParameter("appName","String",1,null,0);Zb.addParameter("target","String",1,null,0);Sa=ma.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);Sa.addProperty("Data",
4,"String",1,!1,null,0);Sa=ma.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);Zb=Sa.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);Zb.addParameter("data","String",1,null,0);Sa.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);Sa.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);Sa=ma.addType("Microsoft.Office.CopilotOperationStartedEventArgs",
"{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);Sa.addProperty("BatchId",6,"String",1,!1,null,0);Sa=ma.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);Zb=Sa.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);Zb.addParameter("batchId","String",1,null,0);Zb=Sa.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);Zb.addParameter("batchId","String",
1,null,0);Sa.addMethod("Undo",1,"Boolean",1,0,"Undo",4);Sa.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);Sa.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);Sa=ma.addEnumType("Microsoft.Office.UserFeedbackType");Sa.addEnumField("Like",0);Sa.addEnumField("Dislike",1);Sa.addEnumField("Idea",2);Sa.addEnumField("Unclassified",3);Sa=ma.addEnumType("Microsoft.Office.UserFeedbackUIType");Sa.addEnumField("ModalDialog",
0);Sa.addEnumField("Taskpane",1);Sa=ma.addType("Microsoft.Office.UserFeedbackService","{92a3da31-eaf9-4225-b909-6c696483a7fb}","{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",3,2);Sa.addMethod("CanCollectUserFeedback",27,"Boolean",1,1,"CanCollectUserFeedback",4);Zb=Sa.addMethod("CollectUserFeedback",1,"Void",0,1,"CollectUserFeedback",4);Zb.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);Zb.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);Zb.addParameter("featureArea",
"String",1,null,0);Zb.addParameter("options","Object",1,null,0);Sa.addMethod("_RegisterUserFeedbackResponseEvent",28,"Void",0,1,"_RegisterUserFeedbackResponseEvent",4);Sa.addMethod("_RegisterUserFeedbackUIDismissedEvent",18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);Sa.addMethod("_UnregisterUserFeedbackResponseEvent",29,"Void",0,1,"_UnregisterUserFeedbackResponseEvent",4);Sa.addMethod("_UnregisterUserFeedbackUIDismissedEvent",19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4);Sa=
ma.addType("Microsoft.Office.NotificationService","{d9d9f329-4dbd-46fd-937d-8534fca075f2}","{f665e4ed-18e6-496d-9693-4622a232c1bc}",3,2);Zb=Sa.addMethod("AddNotification",1,"String",1,0,"AddNotification",4);Zb.addParameter("props","String",1,null,0);Zb.addParameter("options","String",1,null,0);Zb=Sa.addMethod("RemoveNotification",3,"Void",0,0,"RemoveNotification",4);Zb.addParameter("id","String",1,null,0);Zb=Sa.addMethod("UpdateNotification",2,"Void",0,0,"UpdateNotification",4);Zb.addParameter("id",
"String",1,null,0);Zb.addParameter("props","String",1,null,0);Sa=ma.addType("Microsoft.Office.SensitivityLabelInfo","{9c48b796-11fa-4374-9910-4495541ed32f}","{57df5dd1-1d5c-49c2-954e-54cdce9d6082}",2,0);Sa.addProperty("Color",15,"String",1,!1,null,0);Sa.addProperty("Description",13,"String",1,!1,null,0);Sa.addProperty("DisplayName",12,"String",1,!1,null,0);Sa.addProperty("EncryptionType",8,"Microsoft.Office.EncryptionType",1,!1,null,0);Sa.addProperty("HasExtractForUser",10,"Boolean",1,!1,null,0);
Sa.addProperty("IsDke",9,"Boolean",1,!1,null,0);Sa.addProperty("IsEnabled",7,"Boolean",1,!1,null,0);Sa.addProperty("LabelId",5,"String",1,!1,null,0);Sa.addProperty("Order",11,"Int32",1,!1,null,0);Sa.addProperty("ParentName",14,"String",1,!1,null,0);Sa.addProperty("TenantId",6,"String",1,!1,null,0);Sa.addProperty("Version",4,"Int32",1,!1,null,0);Sa=ma.addType("Microsoft.Office.SensitivityLabelChangedEventArgs","{ca0930bd-14ec-4274-baf8-b0d81b2cd6af}","{afcf1725-5270-469f-91c8-ad4f0268a459}",2,0);Sa.addProperty("Context",
20,"String",1,!1,null,0);Sa.addProperty("Error",21,"Microsoft.Office.TryUpgradeLabelError",1,!1,null,0);Sa.addProperty("NewLabel",19,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);Sa.addProperty("PreviousLabel",18,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);Sa=ma.addType("Microsoft.Office.SensitivityService","{c7d4ae5b-a48c-4bfd-bf0b-1532a604d330}","{774bff62-b736-4038-a7a8-7bc1eeef213e}",3,2);Zb=Sa.addMethod("GetHighestSensitivityLabel",3,"Microsoft.Office.SensitivityLabelInfo",2,
0,"HighestSensitivityLabel",4);Zb.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo[]",2,null,0);Sa.addMethod("GetLabel",1,"Microsoft.Office.SensitivityLabelInfo",2,0,"Label",4);Zb=Sa.addMethod("TryUpgradeLabel",2,"Void",0,0,"TryUpgradeLabel",4);Zb.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo",2,null,0);Zb.addParameter("context","String",1,null,0);Sa.addMethod("_RegisterSensitivityLabelChangedEvent",16,"Void",0,1,"_RegisterSensitivityLabelChangedEvent",
4);Sa.addMethod("_UnregisterSensitivityLabelChangedEvent",17,"Void",0,1,"_UnregisterSensitivityLabelChangedEvent",4);Sa=ma.addType("Microsoft.Office.CopilotService","{d81cdd7f-f828-45a1-89fd-b1f6d0af7f76}","{c86a3d8f-7782-4ef9-8ded-2b569327f30c}",3,2);Zb=Sa.addMethod("LaunchHelpPaneByArticleId",2,"Void",0,0,"LaunchHelpPaneByArticleId",4);Zb.addParameter("articleId","Int32",1,null,0);Zb=Sa.addMethod("LaunchHelpPaneByArticleIdString",3,"Void",0,0,"LaunchHelpPaneByArticleIdString",4);Zb.addParameter("articleId",
"String",1,null,0);Zb=Sa.addMethod("LaunchHelpPaneByQuery",1,"Void",0,0,"LaunchHelpPaneByQuery",4);Zb.addParameter("query","String",1,null,0);Sa=ma.addEnumType("Microsoft.Office.BusinessBarType");Sa.addEnumField("Info",0);Sa.addEnumField("Error",1);Sa.addEnumField("Blocked",2);Sa.addEnumField("SevereWarning",3);Sa.addEnumField("Success",4);Sa.addEnumField("Warning",5);Sa=ma.addType("Microsoft.Office.BusinessBarShowArgs","{9cd04f48-f89b-4720-affd-b69cda192318}","{fb97b13e-bd55-46f2-a1bc-92cf8525546f}",
2,0);Sa.addProperty("HideCloseButton",6,"Boolean",1,!1,null,0);Sa.addProperty("Message",4,"String",1,!1,null,0);Sa.addProperty("MessageType",5,"Microsoft.Office.BusinessBarType",1,!1,null,0);Sa.addProperty("Title",3,"String",1,!1,null,0);Sa=ma.addType("Microsoft.Office.BusinessBarService","{0234fef7-ca58-4b3e-9ae8-6972ccf29564}","{8787e4f8-8270-480c-8721-5854ecbc8227}",3,2);Zb=Sa.addMethod("Hide",2,"Void",0,0,"Hide",4);Zb.addParameter("caller","String",1,null,0);Zb=Sa.addMethod("Show",1,"Void",0,
0,"Show",4);Zb.addParameter("caller","String",1,null,0);Zb.addParameter("options","Microsoft.Office.BusinessBarShowArgs",2,null,0);Sa=ma.addEnumType("Microsoft.Office.SimpleDialogCategory");Sa.addEnumField("information",0);Sa.addEnumField("error",1);Sa.addEnumField("warning",2);Sa.addEnumField("question",3);Sa.addEnumField("other",4);Sa=ma.addType("Microsoft.Office.ShowSimpleDialog","{55fc9dc0-9f07-4859-8ba1-f33c353972da}","{f55bd118-7884-4f60-9e0e-e3a7972b7ecb}",3,2);Zb=Sa.addMethod("LaunchSimpleDialog",
1,"Microsoft.Office.SimpleDialogState",1,0,"LaunchSimpleDialog",4);Zb.addParameter("title","String",1,null,0);Zb.addParameter("description","String",1,null,0);Zb.addParameter("telemetryid","String",1,null,0);Zb.addParameter("Category","Microsoft.Office.SimpleDialogCategory",1,null,0);Zb.addParameter("hasButton","Boolean",1,null,0);Zb.addParameter("buttonLabel","String",1,null,0);Zb.addParameter("hasCheckbox","Boolean",1,null,0);Zb.addParameter("checkboxLabel","String",1,null,0)}Sa=ma.addType("Microsoft.Office.PowerPoint.Application",
"{549654b5-691c-491b-bed1-3eccfa85e525}","{64189aae-7617-40e1-ba92-365392bd2387}",3,0);Zb=Sa.addMethod("InsertHyperLink",1001,"Void",0,0,"InsertHyperLink",4);Zb.addParameter("address","String",1,null,0);Zb.addParameter("displayName","String",1,null,0);Zb=Sa.addMethod("InsertSlideFromContent",1002,"Microsoft.Office.PowerPoint.InsertSlideReturnCode",1,0,"InsertSlideFromContent",4);Zb.addParameter("slideContent","String",1,null,0);Sa=ma.addType("Microsoft.Office.PowerPoint.Presentation","{a8af8473-88c1-49d7-a986-565cb7100e9e}",
"",3,0);Sa.addProperty("Id",14,"String",1,!0,null,0);Sa.addProperty("Bindings",15,"Microsoft.Office.PowerPoint.BindingCollection",3,!0,null,0);Sa.addProperty("SlideMasters",3,"Microsoft.Office.PowerPoint.SlideMasterCollection",3,!0,null,0);Sa.addProperty("Slides",2,"Microsoft.Office.PowerPoint.SlideCollection",3,!0,null,0);Sa.addProperty("Tags",4,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);Sa.addProperty("Title",1,"String",1,!0,null,0);Zb=Sa.addMethod("ApplyJOfcCommands",10,"String",
1,0,"ApplyJOfcCommands",4);Zb.addParameter("commandPayload","String",1,null,0);Zb.addParameter("options","Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions",2,null,0);Zb=Sa.addMethod("ApplyJOfcCommandsAsync",13,"String",1,0,"ApplyJOfcCommandsAsync",4);Zb.addParameter("commandPayload","String",1,null,0);Zb.addParameter("options","Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions",2,null,0);Zb=Sa.addMethod("CopilotAction",18,"String",1,0,"CopilotAction",4);Zb.addParameter("type","String",1,null,
0);Zb.addParameter("payload","String",1,null,0);Zb=Sa.addMethod("CopilotActionAsync",19,"String",1,0,"CopilotActionAsync",4);Zb.addParameter("type","String",1,null,0);Zb.addParameter("payload","String",1,null,0);Sa.addMethod("GetSelectedShapes",5,"Microsoft.Office.PowerPoint.ShapeScopedCollection",3,0,"SelectedShapes",0);Sa.addMethod("GetSelectedSlides",6,"Microsoft.Office.PowerPoint.SlideScopedCollection",3,0,"SelectedSlides",0);Sa.addMethod("GetSelectedTextRange",7,"Microsoft.Office.PowerPoint.TextRange",
3,0,"SelectedTextRange",0);Sa.addMethod("GetSelectedTextRangeOrNullObject",9,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRangeOrNullObject",0);Zb=Sa.addMethod("InsertSlidesFromBase64",1003,"Void",0,0,"InsertSlidesFromBase64",0);Zb.addParameter("base64File","String",1,null,0);Zb.addParameter("options","Microsoft.Office.PowerPoint.InsertSlideOptions",2,null,0);Zb=Sa.addMethod("SetSelectedSlides",8,"Void",0,0,"SetSelectedSlides",0);Zb.addParameter("slideIds","String[]",1,null,0);Zb=Sa.addMethod("_RegisterEvent",
1001,"Void",0,1,"_RegisterEvent",0);Zb.addParameter("referenceId","String",1,null,0);Zb.addParameter("eventType","Int32",1,null,0);Sa.addMethod("_RegisterEventApplyJOfcCommandsCompleted",11,"Void",0,0,"_RegisterEventApplyJOfcCommandsCompleted",0);Sa.addMethod("_RegisterEventCopilotActionCompleted",16,"Void",0,0,"_RegisterEventCopilotActionCompleted",0);Zb=Sa.addMethod("_UnregisterEvent",1002,"Void",0,1,"_UnregisterEvent",0);Zb.addParameter("referenceId","String",1,null,0);Zb.addParameter("eventType",
"Int32",1,null,0);Sa.addMethod("_UnregisterEventApplyJOfcCommandsCompleted",12,"Void",0,0,"_UnregisterEventApplyJOfcCommandsCompleted",0);Sa.addMethod("_UnregisterEventCopilotActionCompleted",17,"Void",0,0,"_UnregisterEventCopilotActionCompleted",0);Sa=ma.addType("Microsoft.Office.PowerPoint.AddSlideOptions","{171a8d61-4952-4d67-b7e1-0197ac277d6a}","{af133e5f-ae0b-4a2b-8316-7b26d0a6b4f6}",2,0);Sa.addProperty("LayoutId",1,"String",1,!1,null,0);Sa.addProperty("SlideMasterId",2,"String",1,!1,null,0);
Sa=ma.addType("Microsoft.Office.PowerPoint.ApplyJOfcCommandsCompletedEventArgs","{2a4c199e-e769-4225-9355-93dfe110c629}","{e20b2ede-8e1e-4e20-bb9e-dce2cbc70bcb}",2,0);Sa.addProperty("RequestId",1,"String",1,!1,null,0);Sa.addProperty("Result",2,"String",1,!1,null,0);Sa=ma.addType("Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions","{65f2dfc9-c96e-44ce-8f74-6ecb42f994cf}","{feeaf50c-98cf-4bed-93d5-a78df27c3b78}",2,0);Sa.addProperty("DesignerOptions",1,"String",1,!1,null,0);Sa.addProperty("ScenarioOptions",
2,"String",1,!1,null,0);Sa.addProperty("SelectionOptions",3,"String",1,!1,null,0);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.ConnectorType");Sa.addEnumField("Straight",0);Sa.addEnumField("Elbow",1);Sa.addEnumField("Curve",2);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.GeometricShapeType");Sa.addEnumField("LineInverse",0);Sa.addEnumField("Triangle",1);Sa.addEnumField("RightTriangle",2);Sa.addEnumField("Rectangle",3);Sa.addEnumField("Diamond",4);Sa.addEnumField("Parallelogram",5);Sa.addEnumField("Trapezoid",
6);Sa.addEnumField("NonIsoscelesTrapezoid",7);Sa.addEnumField("Pentagon",8);Sa.addEnumField("Hexagon",9);Sa.addEnumField("Heptagon",10);Sa.addEnumField("Octagon",11);Sa.addEnumField("Decagon",12);Sa.addEnumField("Dodecagon",13);Sa.addEnumField("Star4",14);Sa.addEnumField("Star5",15);Sa.addEnumField("Star6",16);Sa.addEnumField("Star7",17);Sa.addEnumField("Star8",18);Sa.addEnumField("Star10",19);Sa.addEnumField("Star12",20);Sa.addEnumField("Star16",21);Sa.addEnumField("Star24",22);Sa.addEnumField("Star32",
23);Sa.addEnumField("RoundRectangle",24);Sa.addEnumField("Round1Rectangle",25);Sa.addEnumField("Round2SameRectangle",26);Sa.addEnumField("Round2DiagonalRectangle",27);Sa.addEnumField("SnipRoundRectangle",28);Sa.addEnumField("Snip1Rectangle",29);Sa.addEnumField("Snip2SameRectangle",30);Sa.addEnumField("Snip2DiagonalRectangle",31);Sa.addEnumField("Plaque",32);Sa.addEnumField("Ellipse",33);Sa.addEnumField("Teardrop",34);Sa.addEnumField("HomePlate",35);Sa.addEnumField("Chevron",36);Sa.addEnumField("PieWedge",
37);Sa.addEnumField("Pie",38);Sa.addEnumField("BlockArc",39);Sa.addEnumField("Donut",40);Sa.addEnumField("NoSmoking",41);Sa.addEnumField("RightArrow",42);Sa.addEnumField("LeftArrow",43);Sa.addEnumField("UpArrow",44);Sa.addEnumField("DownArrow",45);Sa.addEnumField("StripedRightArrow",46);Sa.addEnumField("NotchedRightArrow",47);Sa.addEnumField("BentUpArrow",48);Sa.addEnumField("LeftRightArrow",49);Sa.addEnumField("UpDownArrow",50);Sa.addEnumField("LeftUpArrow",51);Sa.addEnumField("LeftRightUpArrow",
52);Sa.addEnumField("QuadArrow",53);Sa.addEnumField("LeftArrowCallout",54);Sa.addEnumField("RightArrowCallout",55);Sa.addEnumField("UpArrowCallout",56);Sa.addEnumField("DownArrowCallout",57);Sa.addEnumField("LeftRightArrowCallout",58);Sa.addEnumField("UpDownArrowCallout",59);Sa.addEnumField("QuadArrowCallout",60);Sa.addEnumField("BentArrow",61);Sa.addEnumField("UturnArrow",62);Sa.addEnumField("CircularArrow",63);Sa.addEnumField("LeftCircularArrow",64);Sa.addEnumField("LeftRightCircularArrow",65);
Sa.addEnumField("CurvedRightArrow",66);Sa.addEnumField("CurvedLeftArrow",67);Sa.addEnumField("CurvedUpArrow",68);Sa.addEnumField("CurvedDownArrow",69);Sa.addEnumField("SwooshArrow",70);Sa.addEnumField("Cube",71);Sa.addEnumField("Can",72);Sa.addEnumField("LightningBolt",73);Sa.addEnumField("Heart",74);Sa.addEnumField("Sun",75);Sa.addEnumField("Moon",76);Sa.addEnumField("SmileyFace",77);Sa.addEnumField("IrregularSeal1",78);Sa.addEnumField("IrregularSeal2",79);Sa.addEnumField("FoldedCorner",80);Sa.addEnumField("Bevel",
81);Sa.addEnumField("Frame",82);Sa.addEnumField("HalfFrame",83);Sa.addEnumField("Corner",84);Sa.addEnumField("DiagonalStripe",85);Sa.addEnumField("Chord",86);Sa.addEnumField("Arc",87);Sa.addEnumField("LeftBracket",88);Sa.addEnumField("RightBracket",89);Sa.addEnumField("LeftBrace",90);Sa.addEnumField("RightBrace",91);Sa.addEnumField("BracketPair",92);Sa.addEnumField("BracePair",93);Sa.addEnumField("Callout1",94);Sa.addEnumField("Callout2",95);Sa.addEnumField("Callout3",96);Sa.addEnumField("AccentCallout1",
97);Sa.addEnumField("AccentCallout2",98);Sa.addEnumField("AccentCallout3",99);Sa.addEnumField("BorderCallout1",100);Sa.addEnumField("BorderCallout2",101);Sa.addEnumField("BorderCallout3",102);Sa.addEnumField("AccentBorderCallout1",103);Sa.addEnumField("AccentBorderCallout2",104);Sa.addEnumField("AccentBorderCallout3",105);Sa.addEnumField("WedgeRectCallout",106);Sa.addEnumField("WedgeRRectCallout",107);Sa.addEnumField("WedgeEllipseCallout",108);Sa.addEnumField("CloudCallout",109);Sa.addEnumField("Cloud",
110);Sa.addEnumField("Ribbon",111);Sa.addEnumField("Ribbon2",112);Sa.addEnumField("EllipseRibbon",113);Sa.addEnumField("EllipseRibbon2",114);Sa.addEnumField("LeftRightRibbon",115);Sa.addEnumField("VerticalScroll",116);Sa.addEnumField("HorizontalScroll",117);Sa.addEnumField("Wave",118);Sa.addEnumField("DoubleWave",119);Sa.addEnumField("Plus",120);Sa.addEnumField("FlowChartProcess",121);Sa.addEnumField("FlowChartDecision",122);Sa.addEnumField("FlowChartInputOutput",123);Sa.addEnumField("FlowChartPredefinedProcess",
124);Sa.addEnumField("FlowChartInternalStorage",125);Sa.addEnumField("FlowChartDocument",126);Sa.addEnumField("FlowChartMultidocument",127);Sa.addEnumField("FlowChartTerminator",128);Sa.addEnumField("FlowChartPreparation",129);Sa.addEnumField("FlowChartManualInput",130);Sa.addEnumField("FlowChartManualOperation",131);Sa.addEnumField("FlowChartConnector",132);Sa.addEnumField("FlowChartPunchedCard",133);Sa.addEnumField("FlowChartPunchedTape",134);Sa.addEnumField("FlowChartSummingJunction",135);Sa.addEnumField("FlowChartOr",
136);Sa.addEnumField("FlowChartCollate",137);Sa.addEnumField("FlowChartSort",138);Sa.addEnumField("FlowChartExtract",139);Sa.addEnumField("FlowChartMerge",140);Sa.addEnumField("FlowChartOfflineStorage",141);Sa.addEnumField("FlowChartOnlineStorage",142);Sa.addEnumField("FlowChartMagneticTape",143);Sa.addEnumField("FlowChartMagneticDisk",144);Sa.addEnumField("FlowChartMagneticDrum",145);Sa.addEnumField("FlowChartDisplay",146);Sa.addEnumField("FlowChartDelay",147);Sa.addEnumField("FlowChartAlternateProcess",
148);Sa.addEnumField("FlowChartOffpageConnector",149);Sa.addEnumField("ActionButtonBlank",150);Sa.addEnumField("ActionButtonHome",151);Sa.addEnumField("ActionButtonHelp",152);Sa.addEnumField("ActionButtonInformation",153);Sa.addEnumField("ActionButtonForwardNext",154);Sa.addEnumField("ActionButtonBackPrevious",155);Sa.addEnumField("ActionButtonEnd",156);Sa.addEnumField("ActionButtonBeginning",157);Sa.addEnumField("ActionButtonReturn",158);Sa.addEnumField("ActionButtonDocument",159);Sa.addEnumField("ActionButtonSound",
160);Sa.addEnumField("ActionButtonMovie",161);Sa.addEnumField("Gear6",162);Sa.addEnumField("Gear9",163);Sa.addEnumField("Funnel",164);Sa.addEnumField("MathPlus",165);Sa.addEnumField("MathMinus",166);Sa.addEnumField("MathMultiply",167);Sa.addEnumField("MathDivide",168);Sa.addEnumField("MathEqual",169);Sa.addEnumField("MathNotEqual",170);Sa.addEnumField("CornerTabs",171);Sa.addEnumField("SquareTabs",172);Sa.addEnumField("PlaqueTabs",173);Sa.addEnumField("ChartX",174);Sa.addEnumField("ChartStar",175);
Sa.addEnumField("ChartPlus",176);Sa=ma.addType("Microsoft.Office.PowerPoint.ShapeAddOptions","{b75ad347-9abe-4531-a338-3ba7a70bf9e1}","{2b45cbde-9fbf-4aa2-9972-5508e4c99ad8}",2,0);Sa.addProperty("Height",1,"Double",1,!1,null,0);Sa.addProperty("Left",2,"Double",1,!1,null,0);Sa.addProperty("Top",3,"Double",1,!1,null,0);Sa.addProperty("Width",4,"Double",1,!1,null,0);Sa=ma.addType("Microsoft.Office.PowerPoint.ShapeCollection","{27a07ec1-bcc6-45bf-9c60-07250facfbca}","",3,0);Zb=Sa.addMethod("AddGeometricShape",
6,"Microsoft.Office.PowerPoint.Shape",3,0,"AddGeometricShape",0);Zb.addParameter("geometricShapeType","Microsoft.Office.PowerPoint.GeometricShapeType",1,null,0);Zb.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Zb=Sa.addMethod("AddLine",7,"Microsoft.Office.PowerPoint.Shape",3,0,"AddLine",0);Zb.addParameter("connectorType","Microsoft.Office.PowerPoint.ConnectorType",1,null,0);Zb.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Zb=Sa.addMethod("AddTextBox",
8,"Microsoft.Office.PowerPoint.Shape",3,0,"AddTextBox",0);Zb.addParameter("text","String",1,null,0);Zb.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Sa.addMethod("GetCount",1,"Int32",1,1,"Count",0);Zb=Sa.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Zb.addParameter("key","String",1,null,0);Zb=Sa.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Zb.addParameter("index","Int32",1,null,0);Zb=Sa.addMethod("GetItemOrNullObject",3,
"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Zb.addParameter("id","String",1,null,0);Sa.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);Sa.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);Sa=ma.addType("Microsoft.Office.PowerPoint.SlideLayout","{4494143a-d362-45fd-89c6-506e97741384}","",3,0);Sa.addProperty("Id",1,"String",1,!0,null,0);Sa.addProperty("Name",3,"String",1,!0,null,0);Sa.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);Sa.addMethod("_OnAccess",
2,"Void",0,1,"_OnAccess",0);Sa=ma.addType("Microsoft.Office.PowerPoint.SlideLayoutCollection","{8f09fea3-67af-49f9-b42a-0a8f8cd02615}","",3,0);Sa.addMethod("GetCount",1,"Int32",1,1,"Count",0);Zb=Sa.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideLayout",3,0);Zb.addParameter("key","String",1,null,0);Zb=Sa.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideLayout",3,1,"ItemAt",0);Zb.addParameter("index","Int32",1,null,0);Zb=Sa.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideLayout",
3,0,"ItemOrNullObject",0);Zb.addParameter("id","String",1,null,0);Sa.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);Sa.setCollectionInfo("Microsoft.Office.PowerPoint.SlideLayout",!0);Sa=ma.addType("Microsoft.Office.PowerPoint.SlideMaster","{4a835b29-4422-4659-ab73-2e1e0096e7c1}","",3,0);Sa.addProperty("Id",1,"String",1,!0,null,0);Sa.addProperty("Layouts",3,"Microsoft.Office.PowerPoint.SlideLayoutCollection",3,!0,null,0);Sa.addProperty("Name",4,"String",1,!0,null,0);Sa.addProperty("Shapes",5,"Microsoft.Office.PowerPoint.ShapeCollection",
3,!0,null,0);Sa.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);Sa=ma.addType("Microsoft.Office.PowerPoint.Tag","{f26bc228-f6da-40de-b9ef-2a57ad2b5162}","",3,0);Sa.addProperty("Key",2,"String",1,!0,null,0);Sa.addProperty("Value",3,"String",1,!1,null,0);Sa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Sa=ma.addType("Microsoft.Office.PowerPoint.TagCollection","{edf01799-a99c-4e57-94f2-5830600f5da4}","",3,0);Zb=Sa.addMethod("Add",1,"Void",0,0,"Add",0);Zb.addParameter("key","String",1,null,0);Zb.addParameter("value",
"String",1,null,0);Zb=Sa.addMethod("Delete",2,"Void",0,0,"Delete",0);Zb.addParameter("key","String",1,null,0);Sa.addMethod("GetCount",3,"Int32",1,1,"Count",0);Zb=Sa.addIndexerMethod(4,"Microsoft.Office.PowerPoint.Tag",3,0);Zb.addParameter("key","String",1,null,0);Zb=Sa.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Tag",3,1,"ItemAt",0);Zb.addParameter("index","Int32",1,null,0);Zb=Sa.addMethod("GetItemOrNullObject",6,"Microsoft.Office.PowerPoint.Tag",3,0,"ItemOrNullObject",0);Zb.addParameter("key",
"String",1,null,0);Sa.addMethod("_OnAccess",7,"Void",0,1,"_OnAccess",0);Sa.setCollectionInfo("Microsoft.Office.PowerPoint.Tag",!0);Sa=ma.addType("Microsoft.Office.PowerPoint.Slide","{61c859a3-9c46-44a7-a415-aeb6f43a1dc7}","",3,0);Sa.addProperty("Id",1,"String",1,!0,null,0);Sa.addProperty("Layout",5,"Microsoft.Office.PowerPoint.SlideLayout",3,!0,null,0);Sa.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);Sa.addProperty("SlideMaster",6,"Microsoft.Office.PowerPoint.SlideMaster",
3,!0,null,0);Sa.addProperty("Tags",7,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);Sa.addMethod("Delete",3,"Void",0,0,"Delete",0);Zb=Sa.addMethod("SetSelectedShapes",8,"Void",0,0,"SetSelectedShapes",0);Zb.addParameter("shapeIds","String[]",1,null,0);Sa.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.ShapeFillType");Sa.addEnumField("NoFill",0);Sa.addEnumField("Solid",1);Sa.addEnumField("Gradient",2);Sa.addEnumField("Pattern",3);Sa.addEnumField("PictureAndTexture",
4);Sa.addEnumField("SlideBackground",5);Sa=ma.addType("Microsoft.Office.PowerPoint.ShapeFill","{2df31ab1-fa27-4e46-9704-1fb3f49bed4b}","",3,0);Sa.addProperty("ForegroundColor",2,"String",1,!1,null,0);Sa.addProperty("Transparency",5,"Double",1,!1,null,0);Sa.addProperty("Type",6,"Microsoft.Office.PowerPoint.ShapeFillType",1,!0,null,0);Sa.addMethod("Clear",1,"Void",0,0,"Clear",0);Zb=Sa.addMethod("SetImage",7,"Void",0,0,"SetImage",0);Zb.addParameter("base64ImageString","String",1,null,0);Zb=Sa.addMethod("SetSolidColor",
4,"Void",0,0,"SetSolidColor",0);Zb.addParameter("color","String",1,null,0);Sa.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.ShapeLineStyle");Sa.addEnumField("Single",0);Sa.addEnumField("ThickBetweenThin",1);Sa.addEnumField("ThickThin",2);Sa.addEnumField("ThinThick",3);Sa.addEnumField("ThinThin",4);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.ShapeLineDashStyle");Sa.addEnumField("Dash",0);Sa.addEnumField("DashDot",1);Sa.addEnumField("DashDotDot",
2);Sa.addEnumField("LongDash",3);Sa.addEnumField("LongDashDot",4);Sa.addEnumField("RoundDot",5);Sa.addEnumField("Solid",6);Sa.addEnumField("SquareDot",7);Sa.addEnumField("LongDashDotDot",8);Sa.addEnumField("SystemDash",9);Sa.addEnumField("SystemDot",10);Sa.addEnumField("SystemDashDot",11);Sa=ma.addType("Microsoft.Office.PowerPoint.ShapeLineFormat","{f275eab8-4363-41e8-b11a-e41e3c725f21}","",3,0);Sa.addProperty("Color",1,"String",1,!1,null,0);Sa.addProperty("DashStyle",2,"Microsoft.Office.PowerPoint.ShapeLineDashStyle",
1,!1,null,0);Sa.addProperty("Style",4,"Microsoft.Office.PowerPoint.ShapeLineStyle",1,!1,null,0);Sa.addProperty("Transparency",5,"Double",1,!1,null,0);Sa.addProperty("Visible",6,"Boolean",1,!1,null,0);Sa.addProperty("Weight",7,"Double",1,!1,null,0);Sa.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.ShapeType");Sa.addEnumField("Unsupported",0);Sa.addEnumField("Image",1);Sa.addEnumField("GeometricShape",2);Sa.addEnumField("Group",3);Sa.addEnumField("Line",
4);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.ShapeAutoSize");Sa.addEnumField("AutoSizeNone",0);Sa.addEnumField("AutoSizeTextToFitShape",1);Sa.addEnumField("AutoSizeShapeToFitText",2);Sa.addEnumField("AutoSizeMixed",3);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.TextVerticalAlignment");Sa.addEnumField("Top",0);Sa.addEnumField("Middle",1);Sa.addEnumField("Bottom",2);Sa.addEnumField("TopCentered",3);Sa.addEnumField("MiddleCentered",4);Sa.addEnumField("BottomCentered",5);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment");
Sa.addEnumField("Left",0);Sa.addEnumField("Center",1);Sa.addEnumField("Right",2);Sa.addEnumField("Justify",3);Sa.addEnumField("JustifyLow",4);Sa.addEnumField("Distributed",5);Sa.addEnumField("ThaiDistributed",6);Sa=ma.addType("Microsoft.Office.PowerPoint.BulletFormat","{43bd46c0-809f-4417-b22c-84e44ab6e592}","",3,0);Sa.addProperty("Visible",2,"Boolean",1,!1,null,0);Sa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Sa=ma.addType("Microsoft.Office.PowerPoint.ParagraphFormat","{c164d05d-7a4f-409f-8a5e-ef5f1d2ffa54}",
"",3,0);Sa.addProperty("BulletFormat",1,"Microsoft.Office.PowerPoint.BulletFormat",3,!0,null,0);Sa.addProperty("HorizontalAlignment",2,"Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment",1,!1,null,0);Sa.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle");Sa.addEnumField("None",0);Sa.addEnumField("Single",1);Sa.addEnumField("Double",2);Sa.addEnumField("Heavy",3);Sa.addEnumField("Dotted",4);Sa.addEnumField("DottedHeavy",5);
Sa.addEnumField("Dash",6);Sa.addEnumField("DashHeavy",7);Sa.addEnumField("DashLong",8);Sa.addEnumField("DashLongHeavy",9);Sa.addEnumField("DotDash",10);Sa.addEnumField("DotDashHeavy",11);Sa.addEnumField("DotDotDash",12);Sa.addEnumField("DotDotDashHeavy",13);Sa.addEnumField("Wavy",14);Sa.addEnumField("WavyHeavy",15);Sa.addEnumField("WavyDouble",16);Sa=ma.addType("Microsoft.Office.PowerPoint.ShapeFont","{06c9e9fa-f317-4016-b9f4-aea94e9690f4}","",3,0);Sa.addProperty("Bold",1,"Boolean",1,!1,null,0);Sa.addProperty("Color",
2,"String",1,!1,null,0);Sa.addProperty("Italic",3,"Boolean",1,!1,null,0);Sa.addProperty("Name",5,"String",1,!1,null,0);Sa.addProperty("Size",6,"Double",1,!1,null,0);Sa.addProperty("Underline",7,"Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle",1,!1,null,0);Sa.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);Sa=ma.addType("Microsoft.Office.PowerPoint.TextRange","{1eb59e56-2d48-4b16-b3bb-4fe7debe51c2}","",3,0);Sa.addProperty("Font",1,"Microsoft.Office.PowerPoint.ShapeFont",3,!0,null,0);Sa.addProperty("Length",
7,"Int32",1,!1,null,0);Sa.addProperty("ParagraphFormat",4,"Microsoft.Office.PowerPoint.ParagraphFormat",3,!0,null,0);Sa.addProperty("Start",9,"Int32",1,!1,null,0);Sa.addProperty("Text",5,"String",1,!1,null,0);Sa.addMethod("GetParentTextFrame",10,"Microsoft.Office.PowerPoint.TextFrame",3,0,"ParentTextFrame",0);Zb=Sa.addMethod("GetSubstring",2,"Microsoft.Office.PowerPoint.TextRange",3,0,"Substring",0);Zb.addParameter("start","Int32",1,null,0);Zb.addParameter("length","Int32",1,null,0);Sa.addMethod("SetSelected",
8,"Void",0,0,"SetSelected",0);Sa.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);Sa=ma.addType("Microsoft.Office.PowerPoint.TextFrame","{b5929948-a2b9-4816-8e79-fe9deef82e48}","",3,0);Sa.addProperty("AutoSizeSetting",1,"Microsoft.Office.PowerPoint.ShapeAutoSize",1,!1,null,0);Sa.addProperty("BottomMargin",2,"Double",1,!1,null,0);Sa.addProperty("HasText",4,"Boolean",1,!0,null,0);Sa.addProperty("LeftMargin",6,"Double",1,!1,null,0);Sa.addProperty("RightMargin",7,"Double",1,!1,null,0);Sa.addProperty("TextRange",
8,"Microsoft.Office.PowerPoint.TextRange",3,!0,null,0);Sa.addProperty("TopMargin",9,"Double",1,!1,null,0);Sa.addProperty("VerticalAlignment",10,"Microsoft.Office.PowerPoint.TextVerticalAlignment",1,!1,null,0);Sa.addProperty("WordWrap",11,"Boolean",1,!1,null,0);Sa.addMethod("DeleteText",3,"Void",0,0,"DeleteText",0);Sa.addMethod("GetParentShape",13,"Microsoft.Office.PowerPoint.Shape",3,0,"ParentShape",0);Sa.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.BindingType");
Sa.addEnumField("Shape",0);Sa=ma.addType("Microsoft.Office.PowerPoint.Binding","{06666fef-b1f0-4949-84cc-76981e177ee8}","",3,0);Sa.addProperty("Id",3,"String",1,!0,null,0);Sa.addProperty("Type",5,"Microsoft.Office.PowerPoint.BindingType",1,!0,null,0);Sa.addMethod("Delete",1,"Void",0,0,"Delete",0);Sa.addMethod("GetShape",2,"Microsoft.Office.PowerPoint.Shape",3,0,"Shape",0);Sa.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);Sa=ma.addType("Microsoft.Office.PowerPoint.BindingCollection","{2736e0e7-1405-49c0-b36d-9ebf161fc960}",
"",3,0);Zb=Sa.addMethod("Add",1,"Microsoft.Office.PowerPoint.Binding",3,0,"Add",0);Zb.addParameter("shape","Microsoft.Office.PowerPoint.Shape",3,null,0);Zb.addParameter("bindingType","Microsoft.Office.PowerPoint.BindingType",1,null,0);Zb.addParameter("id","String",1,null,0);Zb=Sa.addMethod("AddFromSelection",2,"Microsoft.Office.PowerPoint.Binding",3,0,"AddFromSelection",0);Zb.addParameter("bindingType","Microsoft.Office.PowerPoint.BindingType",1,null,0);Zb.addParameter("id","String",1,null,0);Sa.addMethod("GetCount",
3,"Int32",1,1,"Count",0);Zb=Sa.addIndexerMethod(4,"Microsoft.Office.PowerPoint.Binding",3,0);Zb.addParameter("key","String",1,null,0);Zb=Sa.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Binding",3,1,"ItemAt",0);Zb.addParameter("index","Int32",1,null,0);Zb=Sa.addMethod("GetItemOrNullObject",6,"Microsoft.Office.PowerPoint.Binding",3,0,"ItemOrNullObject",0);Zb.addParameter("id","String",1,null,0);Sa.addMethod("_OnAccess",7,"Void",0,1,"_OnAccess",0);Sa.setCollectionInfo("Microsoft.Office.PowerPoint.Binding",
!0);Sa=ma.addType("Microsoft.Office.PowerPoint.CopilotActionCompletedEventArgs","{de7d6387-4e1a-4a64-96a0-e69ea20026bb}","{72dbbe4f-134c-442c-ab9c-63adc344c608}",2,0);Sa.addProperty("RequestId",1,"String",1,!1,null,0);Sa.addProperty("Result",2,"String",1,!1,null,0);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.ShapeZOrder");Sa.addEnumField("BringForward",0);Sa.addEnumField("BringToFront",1);Sa.addEnumField("SendBackward",2);Sa.addEnumField("SendToBack",3);Sa=ma.addType("Microsoft.Office.PowerPoint.Shape",
"{62ed0f8f-a9ce-46bd-8ad2-61634aee155d}","",3,0);Sa.addProperty("Fill",11,"Microsoft.Office.PowerPoint.ShapeFill",3,!0,null,0);Sa.addProperty("Height",5,"Double",1,!1,null,0);Sa.addProperty("Id",1,"String",1,!0,null,0);Sa.addProperty("Left",6,"Double",1,!1,null,0);Sa.addProperty("LineFormat",12,"Microsoft.Office.PowerPoint.ShapeLineFormat",3,!0,null,0);Sa.addProperty("Name",7,"String",1,!1,null,0);Sa.addProperty("Tags",3,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);Sa.addProperty("TextFrame",
13,"Microsoft.Office.PowerPoint.TextFrame",3,!0,null,0);Sa.addProperty("Top",8,"Double",1,!1,null,0);Sa.addProperty("Type",9,"Microsoft.Office.PowerPoint.ShapeType",1,!0,null,0);Sa.addProperty("Width",10,"Double",1,!1,null,0);Sa.addProperty("ZOrderPosition",22,"Int32",1,!0,null,0);Sa.addMethod("Delete",4,"Void",0,0,"Delete",0);Sa.addMethod("GetParentSlide",15,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlide",0);Sa.addMethod("GetParentSlideLayout",16,"Microsoft.Office.PowerPoint.SlideLayout",3,
0,"ParentSlideLayout",0);Sa.addMethod("GetParentSlideLayoutOrNullObject",18,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayoutOrNullObject",0);Sa.addMethod("GetParentSlideMaster",17,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMaster",0);Sa.addMethod("GetParentSlideMasterOrNullObject",19,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMasterOrNullObject",0);Sa.addMethod("GetParentSlideOrNullObject",20,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlideOrNullObject",
0);Zb=Sa.addMethod("SetZOrder",21,"Void",0,0,"SetZOrder",0);Zb.addParameter("position","Microsoft.Office.PowerPoint.ShapeZOrder",1,null,0);Sa.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);Sa=ma.addEnumType("Microsoft.Office.PowerPoint.InsertSlideFormatting");Sa.addEnumField("KeepSourceFormatting",0);Sa.addEnumField("UseDestinationTheme",1);Sa=ma.addType("Microsoft.Office.PowerPoint.InsertSlideOptions","{9ca3e504-5701-467b-9596-15521056bac3}","{806c3519-08f4-41ba-b0d9-3c323c51c3e9}",2,0);Sa.addProperty("Formatting",
1,"Microsoft.Office.PowerPoint.InsertSlideFormatting",1,!1,null,0);Sa.addProperty("SourceSlideIds",4,"String[]",1,!1,null,0);Sa.addProperty("TargetSlideId",5,"String",1,!1,null,0);Sa=ma.addType("Microsoft.Office.PowerPoint.ShapeScopedCollection","{607dbfd7-bd79-4651-b5ff-3a66bc46be74}","",3,0);Sa.addMethod("GetCount",1,"Int32",1,1,"Count",0);Zb=Sa.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Zb.addParameter("key","String",1,null,0);Zb=Sa.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Shape",
3,1,"ItemAt",0);Zb.addParameter("index","Int32",1,null,0);Zb=Sa.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Zb.addParameter("id","String",1,null,0);Sa.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);Sa.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);Sa=ma.addType("Microsoft.Office.PowerPoint.SlideCollection","{450b9577-a7dd-4d69-8dc9-afa8fba58465}","",3,0);Zb=Sa.addMethod("Add",6,"Void",0,0,"Add",0);Zb.addParameter("options","Microsoft.Office.PowerPoint.AddSlideOptions",
2,null,0);Sa.addMethod("GetCount",1,"Int32",1,1,"Count",0);Zb=Sa.addIndexerMethod(5,"Microsoft.Office.PowerPoint.Slide",3,0);Zb.addParameter("key","String",1,null,0);Zb=Sa.addMethod("GetItemAt",2,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Zb.addParameter("index","Int32",1,null,0);Zb=Sa.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Zb.addParameter("id","String",1,null,0);Sa.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);Sa.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",
!0);Sa=ma.addType("Microsoft.Office.PowerPoint.SlideScopedCollection","{574045cb-b56d-4fca-89e5-b567250b9ce5}","",3,0);Sa.addMethod("GetCount",1,"Int32",1,1,"Count",0);Zb=Sa.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Slide",3,0);Zb.addParameter("key","String",1,null,0);Zb=Sa.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Zb.addParameter("index","Int32",1,null,0);Zb=Sa.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);
Zb.addParameter("id","String",1,null,0);Sa.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);Sa.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);Sa=ma.addType("Microsoft.Office.PowerPoint.SlideMasterCollection","{d5e75669-5fac-49ec-aaad-e1f6181f6fbd}","",3,0);Sa.addMethod("GetCount",1,"Int32",1,1,"Count",0);Zb=Sa.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideMaster",3,0);Zb.addParameter("key","String",1,null,0);Zb=Sa.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideMaster",
3,1,"ItemAt",0);Zb.addParameter("index","Int32",1,null,0);Zb=Sa.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ItemOrNullObject",0);Zb.addParameter("id","String",1,null,0);Sa.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);Sa.setCollectionInfo("Microsoft.Office.PowerPoint.SlideMaster",!0);Sa=ma.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}","{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);Sa.addMethod("GetAppRuntimeStartState",
2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeStartState",0);Zb=Sa.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0);Zb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Sa=ma.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);Sa.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Zb=Sa.addMethod("SetAppRuntimeState",
1,"Void",0,0,"SetAppRuntimeState",0);Zb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Sa=ma.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Sa.addEnumField("Inactive",0);Sa.addEnumField("Background",1);Sa.addEnumField("Visible",2);Sa=ma.addEnumType("Microsoft.AppRuntime.Visibility");Sa.addEnumField("Hidden",1);Sa.addEnumField("Visible",2);Sa=ma.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",
3,0);Sa.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Zb=Sa.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Zb.addParameter("jsonCreate","String",1,null,0);Zb=Sa.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Zb.addParameter("jsonUpdate","String",1,null,0);Zb=Sa.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Zb.addParameter("id","String",1,null,0);Zb=Sa.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",
3,1,"Tab",0);Zb.addParameter("id","String",1,null,0);Sa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Sa=ma.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Sa.addProperty("Id",2,"String",1,!0,null,0);Zb=Sa.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Zb.addParameter("visibility","Boolean",1,null,0);Sa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Sa=ma.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}",
"",3,0);Sa.addProperty("Enabled",3,"Boolean",1,!1,null,0);Sa.addProperty("Id",2,"String",1,!0,null,0);Sa.addProperty("Label",4,"String",1,!0,null,0);Zb=Sa.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Zb.addParameter("enabled","Boolean",1,null,0);Sa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Sa=ma.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Sa.addMethod("GetCount",3,"Int32",1,1,"Count",0);Zb=Sa.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",
3,0);Zb.addParameter("key","String",1,null,0);Sa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Sa.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Sa=ma.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Sa.addEnumField("Unknown",0);Sa.addEnumField("Basic",1);Sa.addEnumField("Premium",2);Sa=ma.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Zb=Sa.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",
1,1,"FeatureTier",0);Zb.addParameter("feature","String",1,null,0);Zb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Zb=Sa.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Zb.addParameter("feature","String",1,null,0);Zb=Sa.addMethod("GetMsaDeviceTicket",7,"String",1,1,"MsaDeviceTicket",4);Zb.addParameter("resource","String",1,null,0);Zb.addParameter("policy","String",1,null,0);Zb.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",
3,null,0);Zb=Sa.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Zb.addParameter("feature","String",1,null,0);Zb.addParameter("fallbackValue","Boolean",1,null,0);Sa.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Zb=Sa.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Zb.addParameter("experienceId","String",1,null,0);Zb=Sa.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Zb.addParameter("feature",
"String",1,null,0);Sa=ma.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Sa.addProperty("Id",5,"String",1,!0,null,0);Sa.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Sa.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Sa=ma.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",3,0);Sa.addProperty("Scopes",
1,"String",1,!1,null,0)};var Ai=a(260);class Ii{constructor(ma,Sa){this.ung=ma;this.Olg=Sa}tml(ma){return[200,null,ma]}LHm(ma,Sa,Zb,Wc,rd,ee){const De=Ai.a.AA(),Af=this.ung.create(Sa,Zb,Wc);Wc.Fdl=Af;const mg=this.Olg.create(ee,Af);mg.context.appId=Sa;mg.context.controlId=Zb;const dg=()=>{Tf.rXl(!0);Af.uFg=!1;OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Af,Ci,mg,ma).then(Gh=>{if(!Gh)return f.ULS.sendTraceTag(508850825,802,10,"ExecuteRichApiRequest failed."),rd(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),
null;Tf.Ijk(De,Ai.a.AA());rd(Gh,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},Gh=>{f.ULS.sendTraceTag(508850824,802,10,"A PPT Rich API batch execution was failed, AppId: {0}  Reason: {1}",Sa,Gh);rd(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})},Zg=()=>{Tf.rXl(!1);let Gh=ma[4];if(cd.a("CapricornPassAppIdToNative"))try{const wh=JSON.parse(Gh);wh.appId=Sa;Gh=JSON.stringify(wh)}catch(wh){f.ULS.sendTraceTag(507639698,802,10,"ExecuteRichApiRequest requestBody cannot be parsed.")}cd.a("ExtensibilityUseSerializedPayloads")&&
(Gh=Uf(Wc,Gh));OfficeExtension.WacRuntime.Utility.createPromise(wh=>{const Ji={};Ji.promiseToResolve=wh;Ji.requestBody=Gh;u.AFrameworkApplication.vb.Qa(Ua.a.MDd,2,Ji)}).then(wh=>{cd.a("ExtensibilityResetResponse")&&u.AFrameworkApplication.vb.Qa(Ua.a.MDd,2,{promiseToResolve:null,requestBody:""});if(cd.a("ExtensibilityUseSerializedPayloads")){a:if((wh=Sys.Serialization.JavaScriptSerializer.deserialize(wh.toString()))&&wh.sel&&wh.sel.sldLst){var Ji=ee.presentation,bi=wh.sel.sldLst,ni=[];if(bi)for(eh of bi)({slideId:bi}=
We.a.iUk(eh)).returnValue&&(bi=Object(ta.a)(32,Ji.QB(bi)))&&ni.push(bi);var eh=ni;if(eh.length&&!Wc.pP.fWn(eh))wh=null;else{eh=1===eh.length?eh[0]:null;Ji=null;if(eh&&wh.sel.shpLst){ni=wh.sel.shpLst;Ji=[];if(ni)for(nj of ni)(ni=eh.WZ(parseInt(nj)))&&Ji.push(ni);var nj=Ji;if(nj.length&&!Wc.pP.eWn(nj)){wh=null;break a}Ji=1===nj.length?nj[0]:null}wh=Ji&&wh.sel.txRn&&(wh.sel.txRn.length&&2!==wh.sel.txRn.length||2===wh.sel.txRn.length&&0<=wh.sel.txRn[0]&&!Wc.pP.gWn(Ji,wh.sel.txRn[0],wh.sel.txRn[1]))?null:
wh.rst}}else wh=null;wh?(Tf.Ijk(De,Ai.a.AA()),rd(this.tml(wh),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):rd(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else Tf.Ijk(De,Ai.a.AA()),rd(this.tml(wh),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{rd(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})};ma?(Af.uFg=!0,OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Af,Ci,mg,ma).then(Gh=>{Gh&&Af.kIl?dg():Zg();return null},()=>{Zg();return null})):
dg()}}Object(c.a)(Ii,"RichApiRequest",null,[]);class gj extends Dg{constructor(ma,Sa,Zb){super();this.ung=ma;this.Olg=Sa;this.va=Zb}go(){this.nA={};this.dw()}dw(){const ma=this.parameters.ArrayData;if(ma){var Sa=null,Zb=this.QIi();Zb&&Zb.taskpane&&(Sa=Zb.taskpane.ownerAddinSolutionId);try{(new Ii(this.ung,this.Olg)).LHm(ma,Sa,this.controlId,this.Tc,Object(r.a)(this,this.MHm,"executeRichApiRequestCallback"),this.va)}catch(Wc){T.a.J(509112536,802,10,"Exception thrown at ExecuteRichApiRequestMethod: "+
Wc.toString()),this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.Aka()}}else this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.Aka()}MHm(ma,Sa){this.errorCode=Sa;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.nA.Data=ma);this.Aka()}get description(){return"Run ExecuteRichApi Invocation Completed."}}Object(c.a)(gj,"ExecuteRichApiRequestMethod",Dg,[]);class Ag extends Dg{constructor(){super()}go(){this.nA={};this.dw()}dw(){const ma=this.$Fe.E3m();
f.ULS.sendTraceTag(507843917,802,50,"GetAccessToken was called!");const Sa=(Zb,Wc)=>{Zb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(Wc=Wc.accessToken,this.nA[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Wc):(Wc=this.Tc.rTa.$Ja(this.controlId),f.ULS.sendTraceTag(507843916,802,10,"{0}",{["errorCode"]:Zb.toString(),["appId"]:Wc.Mx.id,["storeType"]:Wc.Mx.storeType}));this.Pp=Zb;this.Aka()};this.p0m.execute(Zb=>{const Wc=this.Tc.nq,rd=me.getInstance();te.getInstance(Wc,Zb,rd).getAccessToken(this.controlId,
ma,this.parameters,Sa)})}get description(){return"Postmessage to wac host layer to get an access token for Addin."}}Object(c.a)(Ag,"GetAccessTokenMethod",Dg,[]);class Og extends Dg{constructor(){super()}dw(){let ma=null;this.pP&&(ma=Microsoft.Office.WebExtension.ActiveView.Edit);ma?(this.result[Microsoft.Office.WebExtension.Parameters.Data]=ma,this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Returns the ActiveView value for current mode."}}
Object(c.a)(Og,"GetActiveViewMethod",Dg,[]);var aj=a(1517);class Qj extends Dg{constructor(){super()}go(){this.nA={};this.dw()}dw(){var ma=this.Hd.nq.getOsfControl(this.controlId);if(!u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!1)||ma.isFirstParty()){ma=ma.getManifest();var Sa=ma.getMarketplaceID(),Zb=ma.getWebApplicationId(),Wc=ma.getWebApplicationMsaId();ia.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(Sa).then(rd=>
{this.errorCode=0;const ee={};ee[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=rd.upn;ee[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=rd.userId;ee[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Zb;ee[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Wc?Wc:Zb;ee[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=rd.authority;ee[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=aj.a.Ktl(rd.authorityType);ee[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
rd.isAnonymous;ee[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=rd.tenantId;ee[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=rd.supportsAuthToken;this.nA[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=ee;this.Aka()},rd=>{this.Pp=1;this.nA[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=rd;this.Aka()})}}get description(){return"Return authentication context needed by WebAuth stack."}}Object(c.a)(Qj,"GetAuthContextMethod",Dg,[]);
class sj extends Dg{constructor(){super()}go(){this.nA={};this.dw();this.Pp!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.Aka()}dw(){var ma=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const Sa=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];ma=this.hTa.Ttl(ma);!ma||Sa*ma.K5l>=ma.fileSize?this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange:(wg.$Am(this.Tc.Nh,this.controlId,ma.ZCi,Sa,ma.K5l,Object(r.a)(this,this.Uof,"customizedOnFinished"),
Object(r.a)(this,this.Tof,"customizedOnError")).start(),this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}Uof(ma,Sa){ma?0===Sa.errorCode?(ma=Sa.value,this.nA[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=ma,this.nA[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=ma.length,this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.Aka()}Tof(){this.Pp=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.Aka()}get description(){return"Returns the specified slice."}}Object(c.a)(sj,"GetDocumentCopyChunkMethod",Dg,[]);class mi extends Dg{constructor(){super();this.JBb=this.vab=0}go(){this.nA={};this.dw();this.Pp!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.Aka()}dw(){try{const ma=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()];this.JBb=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()];
if(1>this.JBb||4194304<this.JBb)T.a.J(507843910,802,50,"GetDocumentCopyMethod: Invalid slice size: "+this.JBb),this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;else{switch(ma){case 1:this.vab=4;break;case 2:this.vab=3;break;default:T.a.J(507843909,802,50,"GetDocumentCopyMethod: Unsupported file type: "+ma);this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported;return}this.hTa.fCl(this.controlId,this.vab)?this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:this.hTa.wac.count>=
this.Tc.W3h.Md.bKe?this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:(this.UIn.QJa(!1,!0,!0,()=>{this.dJn()},Object(r.a)(this,this.fDb,"saveFailureCallback")),this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}catch(ma){T.a.J(507843908,802,10,"Exception thrown at GetDocumentCopyMethod: "+ma.toString()),this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}dJn(){wg.aBm(this.Tc.Nh,this.controlId,this.vab,this.JBb,Object(r.a)(this,this.Uof,"customizedOnFinished"),
Object(r.a)(this,this.Tof,"customizedOnError")).start()}fDb(){this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.Aka();return!1}Uof(ma,Sa){if(ma&&ma.length){ma=Sa.format;var Zb=Sa.sliceSize,Wc=Sa.errorCode;0===Wc?(Sa=Sa.fileSize,this.nA[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Sa,Sa=this.hTa.Vvm(this.controlId,Sa,Zb,ma),this.nA[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Sa,this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.Pp=174===
Wc?OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:175===Wc?OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.Aka()}Tof(ma,Sa){this.Pp=Sa?OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.Aka()}get description(){return"Returns the entire document file in slices."}}Object(c.a)(mi,"GetDocumentCopyMethod",
Dg,[]);class Wj extends Dg{constructor(){super()}dw(){this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;try{const ma=this.bMm(),Sa=this.pP.pOm(ma);Sa&&(this.nA[""+OSF.DDA.Marshaling.ThemingKeys.DocumentTheme]=Sa,this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(ma){T.a.J(507843904,802,10,"Exception thrown at GetDocumentThemeMethod: "+ma)}}get description(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."}}Object(c.a)(Wj,"GetDocumentThemeMethod",
Dg,[]);class Ff extends Dg{constructor(){super()}dw(){this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;let ma=null;if(this.pP&&void 0!==(ma=this.pP.Kac())&&null!==(ma=this.pP.Kac())){var Sa={};Sa[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=ma;this.result[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Sa;this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}get description(){return"Returns the file properties. Now it only returns the URL."}}Object(c.a)(Ff,"GetFilePropertiesMethod",
Dg,[]);class oi{constructor(){this.context=null;this.errorCode=0}}Object(c.a)(oi,"NestedAppAuthContextResult",null,[]);class Fj{static LQm(ma,Sa){const Zb=new oi;(ma=ma.getOsfControl(Sa))&&ma.isFirstParty()?(Zb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,ma={},Sa=u.AFrameworkApplication.ga.La("AADUserObjectId"),ma.userObjectId=Sa?Sa:u.AFrameworkApplication.ga.La("LoggableUserId"),ma.userPrincipalName=u.AFrameworkApplication.ga.La("UserPrincipalName"),ma.tenantId=u.AFrameworkApplication.ga.La("TenantId"),
ma.puid=u.AFrameworkApplication.ga.La("Puid"),ma.authorityBaseUrl=u.AFrameworkApplication.ga.La("HostAuthAuthority"),Sa=(u.AFrameworkApplication.ga.La("HostAuthType")||"").toLowerCase(),ma.authorityType="aad"===Sa?"aad":"msa"===Sa?"msa":"other",Zb.context=ma):Zb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return Zb}}Object(c.a)(Fj,"NestedAppAuthUtil",null,[]);class bj extends Dg{constructor(){super()}dw(){const ma=Fj.LQm(this.Hd.nq,this.controlId);ma.errorCode==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?
this.nA=ma.context:this.Pp=ma.errorCode}get description(){return"Returns information needed by MSAL.js to authenticate."}}Object(c.a)(bj,"GetNestedAppAuthContextMethod",Dg,[]);class Hg extends Dg{constructor(){super()}dw(){this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext}get description(){return"(Not implemented) Returns OfficeTheme properties."}}Object(c.a)(Hg,"GetOfficeThemeMethod",Dg,[]);class rg extends Dg{constructor(){super()}dw(){this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
if(this.pP)try{var ma=this.parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString();ma===Microsoft.Office.WebExtension.CoercionType.SlideRange?(ma=null,this.Pp=({LJn:ma}=this.pP.ISm()).returnValue,this.nA[OSF.DDA.WAC.UniqueArguments.Data]=ma):ma===Microsoft.Office.WebExtension.CoercionType.Text?(ma=null,this.Pp=({mPg:ma}=this.pP.LSm()).returnValue,this.nA[OSF.DDA.WAC.UniqueArguments.Data]=ma):this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}catch(Sa){T.a.J(8958164,
802,10,"Exception thrown at GetSelectedDataMethod: "+Sa.toString())}}get description(){return"Get data contained in the current selection of the document."}}Object(c.a)(rg,"GetSelectedDataMethod",Dg,[]);class Jj extends Dg{constructor(){super()}dw(){var ma=this.QIi();if(ma){const Sa={};Sa.Settings=this.NGi(ma.settings);this.nA[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=Sa;this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else ma="AppForOffice instance could not be found for ID "+this.controlId+
Wf.a.Ot(),T.a.J(508694660,802,10,ma),this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Loads/Refreshes Settings object for an app"}NGi(ma){const Sa={};let Zb=0;for(const Wc in ma)Sa[Zb.toString()]=[Wc,ma[Wc]],Zb++;return Sa}}Object(c.a)(Jj,"LoadSettingsMethod",Dg,[]);class uk extends Dg{constructor(){super()}dw(){f.ULS.sendTraceTag(587747346,802,50,"ExecuteAsync was called!");this.$Fe.OAb()?(this.Pp=cg.instance.V$b.pgn(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],
this.parameters[F.a.Maf],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]),this.Pp!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&f.ULS.sendTraceTag(587747345,806,10,"ExecuteAsync failed. Error code: {0}",this.Pp.toString())):this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run messageParent method."}}Object(c.a)(uk,"MessageParentMethod",Dg,[]);class ai extends Dg{constructor(){super()}dw(){this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
if(this.pP)try{const ma=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],Sa=ma[OSF.DDA.Marshaling.NavigationKeys.GoToType],Zb=ma[OSF.DDA.Marshaling.NavigationKeys.Id].toString();this.Pp=Sa===OSF.DDA.Marshaling.GoToType.Index?this.pP.BVm(Zb):Sa===OSF.DDA.Marshaling.GoToType.Slide?this.pP.CVm(Zb):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration}catch(ma){T.a.J(8958162,802,10,"Exception thrown at navigatetomethod: "+ma.toString())}}get description(){return"Go to the slide specified by user."}}
Object(c.a)(ai,"NavigateToMethod",Dg,[]);class mh extends Dg{constructor(){super();this.JEj=0}go(){this.nA={};this.dw();this.Pp!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.Aka()}dw(){this.JEj=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const ma=this.hTa.Ttl(this.JEj);ma?(wg.Sml(this.Tc.Nh,this.controlId,ma.ZCi,!1,!1,Object(r.a)(this,this.Uof,"customizedOnFinished"),Object(r.a)(this,this.Tof,"customizedOnError")).start(),this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):
this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist}Uof(ma,Sa){ma?0===Sa.errorCode?(this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.hTa.pFn(this.JEj)):this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.Aka()}Tof(){this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.Aka()}get description(){return"Closes the document file."}}Object(c.a)(mh,"ReleaseDocumentCopyMethod",Dg,[]);class tg extends Dg{constructor(){super();
this.mLc=null}dw(){var ma=this.QIi();if(ma){var Sa=this.parameters[OSF.DDA.WAC.UniqueArguments.SettingsRequest];this.mLc=this.NGi(Array.isArray(Sa[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?Sa[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null);Sa=null;ma.taskpane&&(Sa=ma.taskpane.ownerAddinSolutionId);var Zb;if(ma.taskpane&&Sa)if(Zb=this.Tc.Cib(Sa)){this.pP.rvk(Zb,this.mLc);if(Zb=this.Tc.rTa.PIi(Sa))Zb.settings=this.mLc;ma.settings=this.mLc;this.Tc.eZk(Sa,this.mLc);this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.xbh.xyl(Sa,
this.mLc,this.Hd)?(ma.settings=this.mLc,this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else(Zb=0===ma.KN?this.Tc.Vrl(ma.shape.slideId,ma.shape.id):this.Tc.Cib(ma.Mx.id))?(this.pP.rvk(Zb,this.mLc),ma.settings=this.mLc,this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else ma="AppForOffice instance could not be found for ID "+this.controlId+Wf.a.Ot(),T.a.J(507843875,
802,10,ma),this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Saves settings to document."}NGi(ma){const Sa={};if(ma)for(let Zb=0;Zb<ma.length;Zb++){const Wc=Array.isArray(ma[Zb])?ma[Zb]:null;Wc&&1<Wc.length&&(Sa[Wc[0]]=Wc[1])}return Sa}}Object(c.a)(tg,"SaveSettingsMethod",Dg,[]);class Kj extends Dg{constructor(){super()}dw(){this.$Fe.OAb()?(cg.instance.V$b.gKn(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[F.a.Maf],
this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run sendMessage/messageChild method."}}Object(c.a)(Kj,"SendMessageMethod",Dg,[]);class ek extends Dg{constructor(){super()}dw(){this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.pP)try{const Sa=this.parameters[OSF.DDA.WAC.UniqueArguments.SetData];var ma=Sa.CoerceType.toString();
const Zb=Sa[OSF.DDA.WAC.UniqueArguments.Data];if(ma===Microsoft.Office.WebExtension.CoercionType.Text)this.Pp=this.pP.UMn(Zb);else{let Wc;if(ma===Microsoft.Office.WebExtension.CoercionType.Image)Wc=0;else if(ma===Microsoft.Office.WebExtension.CoercionType.XmlSvg)Wc=1;else{this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;return}ma=!1;let rd=0,ee=0,De=0,Af=0;({mYm:ma,x:rd,y:ee,width:De,height:Af}=this.bIm(Sa,ma,rd,ee,De,Af));this.Pp=this.pP.vwh(Zb,ma,rd,ee,De,Af,Wc,this.parameters[F.a.Maf])}}catch(Sa){T.a.J(509112542,
802,10,"Exception thrown at SetSelectedDataMethod: "+Sa)}}bIm(ma,Sa,Zb,Wc,rd,ee){const De=ma[OSF.DDA.Marshaling.SetDataKeys.ImageLeft],Af=ma[OSF.DDA.Marshaling.SetDataKeys.ImageTop];void 0!==De&&null!==De&&"number"===typeof De&&void 0!==Af&&null!==Af&&"number"===typeof Af&&(Sa=!0,Zb=De,Wc=Af);ma[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]&&(rd=ma[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]);ma[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]&&(ee=ma[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]);return{mYm:Sa,
x:Zb,y:Wc,width:rd,height:ee}}get description(){return"Writes data to the current selection in the document."}}Object(c.a)(ek,"SetSelectedDataMethod",Dg,[]);class gi extends Dg{constructor(){super()}dw(){u.AFrameworkApplication.vb.Cb(this.parameters[0],2);this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Executes an action with the ActionManager."}}Object(c.a)(gi,"ExecuteFeature",Dg,[]);class Di extends Dg{constructor(){super()}dw(){const ma=u.AFrameworkApplication.vb.Cb(this.parameters[0],
1);this.Pp=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.nA[0]=32==ma;this.nA[1]=!0}get description(){return"Query an action with the ActionManager to check if it is enabled."}}Object(c.a)(Di,"QueryFeature",Dg,[]);class ak extends ci{constructor(ma){super(ma)}xwn(){this.lcg={};this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,()=>new Jj);this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new tg);this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,()=>new Og);this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,
()=>new ai);this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>new rg);this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new Ff);this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,()=>new Wj);this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,()=>new Hg);this.set(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,()=>new ek);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new mi);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>
new sj);this.set(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new mh);this.set(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new fj);this.set(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>new uk);this.set(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>new Kj);this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,()=>new Ag);this.set(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new Qj);this.set(OSF.DDA.MethodDispId.dispidCreateDocumentMethod,()=>new kj);
this.set(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>new gj(this.Hd.sIn,this.Hd.BAn,this.Hd.Sy));this.set(OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod,()=>new bj);this.set(OSF.DDA.MethodDispId.dispidExecuteFeature,()=>new gi);this.set(OSF.DDA.MethodDispId.dispidQueryFeature,()=>new Di)}}Object(c.a)(ak,"EditorMethodFactory",ci,[]);class Rj extends Sys.EventArgs{constructor(ma){super();this.N8g=ma}get Kp(){return this.N8g}}Object(c.a)(Rj,"FirstPartyAddInHidingEventArgs",Sys.EventArgs,
[]);class Lf{constructor(){this.oad={};this.WGj={};this.oph={};this.qoh={}}Kdl(ma,Sa){Sa&&ma&&(this.oad[ma]=Sa,this.qoh[ma]=!1)}Ynm(ma,Sa){ma&&Sa&&(this.oph[ma]=Sa)}nFn(ma){if(ma){var Sa=this.oad[ma];Sa&&(delete this.oph[Sa.Mx.id],delete this.oad[ma],delete this.WGj[ma],delete this.qoh[ma])}}$Ja(ma){return ma?this.oad[ma]:null}LPm(ma){return ma?this.qoh[ma]:!1}yTm(ma){return ma?this.WGj[ma]:null}I9l(ma,Sa){ma&&(this.qoh[ma]=Sa)}xYn(ma,Sa){ma&&(this.WGj[ma]=Sa)}PIi(ma){if(!ma)return null;const Sa=
this.oad;for(const Zb in Sa){const Wc=Sa[Zb];if(Wc&&Wc.Mx.id.toLowerCase()===ma.toLowerCase())return Wc}return null}aMm(ma,Sa,Zb){if(!ma||!Sa||!Zb)return null;const Wc=this.oad;for(const rd in Wc){const ee=Wc[rd];if(ee&&ee.taskpane&&ee.taskpane.ownerAddinSolutionId&&ee.taskpane.ownerAddinSolutionId.toLowerCase()===ma.toLowerCase()){const De=Zb.getOsfControl(ee.Kp);if(De&&De.getSharedRuntimeId()===Sa)return ee}}return null}xGi(ma){xe.a.forEach(this.oad,(Sa,Zb)=>{Sa=Object(ta.a)(902,Zb);1===Sa.KN&&
ma(Sa)},null)}VIm(ma){const Sa=this.oad;for(const Zb in Sa){const Wc=Object(ta.a)(902,Sa[Zb]);if(Wc&&ma(Wc))return Wc}return null}RDi(ma){return ma in this.oph?this.oph[ma]:null}}Object(c.a)(Lf,"OsfAppInstacneCache",null,[]);class Sh{constructor(){}}Object(c.a)(Sh,"AppForOfficeSDXDialog",null,[923]);class Nh{constructor(ma,Sa,Zb,Wc,rd,ee,De,Af,mg,dg,Zg,Gh,wh,Ji,bi,ni,eh,nj,Al,dl,Zi,Sj,Ei,oj,fk){this.plf=!1;this.h_k=!0;this.hXd=this.nad=this.iBj=this.Fdl=null;this.ua=new B.a;this.EJl=!1;this.Jan=3E3;
this.Kan=6E4;this.tmh=!1;this.Esn=()=>{this.Amh=ea.a("getTheme")?appChrome.api.getTheme():void 0;Nh.kBb.setAppTheme(this.Amh);return this.Amh};this.EE=ma;this.eW=Sa;this.MJj=new ak(this);this.zmh=new Wi(this,dl);this.bcc=Zi;this.M$c=Wc;this.aHl={};this.Rca=new Lf;this.Ran=Zb;this.F$c=rd.value;this.d1=De;this.Pb=ee;this.Rza=Af;this.Db=mg;this.Man=eh;this.oXd=dg;this.Fb=Zg;this.qm=Gh;this.va=wh;this.Ia=Ji;this.nc=bi;this.oc=ni;this.AEc=Al;this.iXd=new hc;this.Ian=nj;this.Hm=Sj;this.ung=Ei;this.Olg=
oj;this.c5d=fk}initialize(){this.Hka(this.Db.mode);this.Db.PM(Object(r.a)(this,this.vyl,"handleModeSwitch"))}dispose(){this.Db.R3(Object(r.a)(this,this.vyl,"handleModeSwitch"))}get xbh(){this.iXd||(this.iXd=new hc);return this.iXd}get Zzm(){return this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CopilotThemeSwitchEnabled",!1)}get nq(){if(!Nh.kBb){this.EE&&(this.EE.Md.EBl&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Se),this.Fb.getBooleanAppSetting(Oc.a.a5c)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Se,
new Md(this.EE.Md.Rh?u.AFrameworkApplication.ga.appSettings.AuthProxyHandlerWebServiceBase:u.AFrameworkApplication.ga.appSettings.WebServiceBase),this.Fb.getBooleanAppSetting(Oc.a.YVl)),OfficeExt.MosRequestHandler.init(new Se),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Se));const ma=new Ba(this.MJj,this.zmh);this.hXd=this.k0.jAm(this.Rca);Nh.kBb=this.Ran.wAm(this.eW,ma,this.hXd);Nh.kBb.setOAuthManager(this.c5d);Nh.kBb&&"undefined"!==
typeof Nh.kBb.hostCheckReadyHandler&&u.AFrameworkApplication.aqm(Object(r.a)(Nh.kBb,Nh.kBb.hostCheckReadyHandler,"hostCheckReadyHandler"));this.Zzm&&(this.Amh=ea.a("getTheme")?appChrome.api.getTheme():void 0,Nh.kBb.setAppTheme(this.Amh),ea.a("registerOnThemeChangeCallback")?appChrome.api.registerOnThemeChangeCallback(this.Esn):T.a.J(507801729,802,50,"Theme API doesn't exist - registerOnThemeChangeCallback"))}return Nh.kBb}VWk(ma){(ma=this.nq.getOsfControl(ma))&&this.hXd&&this.hXd.BPl(ma)}Occ(ma,Sa){this.hXd.Occ(ma,
Sa)}DFe(ma,Sa,Zb){this.hXd?this.hXd.v8m(ma,Sa,Zb):f.ULS.sendTraceTag(512508178,806,10,"m_appEventListener is null")}owb(ma,Sa,Zb=null){const Wc=this.k0.FIa(ma);if(this.Fb.getBooleanAppSetting(Oc.a.oSc)&&!OSF.OsfControl.isFirstPartyStoreString(this.tAe(Wc.storeType)))this.Hm.v0a(22)||this.Hm.Z$b(22);else if(0===Wc.KN)this.M$c.C3m(Wc.id)?(Zb=this.M$c.l$b[Wc.id],cd.a("Microsoft.Office.SharedOnline.FixBug6808089")?this.M$c.mec(Wc.id,this.oFk(ma),Sa):(Zb.Pyk(Sa),this.M$c.mec(Wc.id,this.oFk(ma),null))):
(ma=this.hxh(ma,Sa),ma.Pyk(Sa),this.M$c.VIn(Wc.id,ma));else if(1===Wc.KN){const rd=Wc.node.oa(za.a.I4,null);this.SAb(Wc.id)?Wc.fkh||this.TWc(rd,!0):this.hxh(ma,Sa,Zb);this.EE.Md.m0a&&!Wc.ownerAddinSolutionId&&(Sa=this.MXi(Wc.oub),this.eZk(Wc.oub,Sa.settings))}}launchInsertDialog(){this.ua.raiseEvent("OnInsertionDialogOpened");this.$ni();this.nq.launchInsertDialog(this.nad.kNb)}Csj(ma,Sa,Zb,Wc){ma=this.WG.D0(ma,Sa);this.EE.eS().Qa(eb.a.xOf,2,{version:ma.version,storeType:ma.storeType,storeId:ma.storeId,
assetId:ma.assetId,assetStoreId:ma.assetStoreId,targetType:ma.targetType,displayName:ma.displayName,solutionId:ma.solutionId,width:ma.width,height:ma.height});this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",!0)&&(Zb={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.storeType,ma.assetId,null,null,ma.storeId),["UILocation"]:Zb,["ControlId"]:Wc},Wc=new qa.a,Wc.name="Office.Extensibility.Host.InstallMRUAddinFromFlyout",Wc.dataFields=
N.a.Gw(Zb),U.a.sendTelemetryEvent(Wc))}Dbc(ma,Sa,Zb){const Wc=this.nq.getAppUILocale()||"en-US";this.qGl=new Ma(ma,"wac_powerpoint",Wc,rd=>{this.EE.eS().Qa(eb.a.xOf,2,rd);this.qGl.hide();if(this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)){rd={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(rd.solutionId,rd.storeType,rd.assetId,null,null,rd.storeId),["UILocation"]:Sa,["ControlId"]:Zb};const ee=new qa.a;ee.name="Office.Extensibility.Host.InstallPopularAddinFromFlyout";
ee.dataFields=N.a.Gw(rd);U.a.sendTelemetryEvent(ee)}});this.qGl.Dq("",null,null);return!0}Lsj(ma){this.ua.raiseEvent("OnInsertionDialogOpened");this.$ni();if(ma){const Sa={navigationMode:0};Sa.assetId=ma;this.nq.launchInsertDialog(this.nad.kNb,"{98143890-AC66-440E-A448-ED8771A02D52}",Sa)}else this.nq.launchInsertDialog(this.nad.kNb)}FFe(ma){this.ua.raiseEvent("OnInsertionDialogOpened");this.$ni();this.nq.launchInsertDialog(this.nad.kNb,ma,{navigationMode:0,assetId:null,category:null})}$ni(){const ma=
Sa=>{0===Sa&&this.EE.Md.m0a&&this.EE.Md.ekh&&(this.EE.eS().Qa(eb.a.Uth,2,{}),Sa=new qa.a,Sa.name="Office.Extensibility.Host.RefreshAddinsAfterClosingDialog",U.a.sendTelemetryEvent(Sa))};this.nad=new xi;this.nad.Dq("",this.Fb.isChangeGateEnabled("OfficeVSO:8619119_RefreshAddinsAfterClosingDialog")?ma:null,null)}hzl(){this.nad&&this.nad.hide()}uUa(ma){const Sa=this.hgh(ma);Sa?this.KZl(Sa):f.ULS.sendTraceTag(512508177,806,10,String.format("Failed to find the AppNode with instance id: {0}",ma))}KZl(ma){const Sa=
this.k0.FIa(ma);if(this.Fb.getBooleanAppSetting(Oc.a.oSc)&&!OSF.OsfControl.isFirstPartyStoreString(this.tAe(Sa.storeType)))this.Hm.v0a(22)||this.Hm.Z$b(22);else{var Zb=(Wc,rd)=>{const ee=this.k0.FIa(Wc),De=this.k0.Kdh(u.AFrameworkApplication.isRtl,ee.id,ee.width,ee.visibility);rd.F9(De);let Af=rd=null;this.EE.Md.m0a&&this.EE.Md.UDl&&(Af=this.Mth(ma),rd=()=>{this.lca(De,!0,!1);this.icb(Af)});this.owb(Wc,De.wbh,rd);Af&&(Wc=this.xT(Af.Mx.id).o9a,De.qNn(Wc));De.wA(ee.visibility)};if(this.EE.Md.m0a){const Wc=
this.k0.FIa(ma),rd={};rd.solutionId=Wc.oub;rd.version=Wc.version;rd.storeType=this.tAe(Wc.storeType);rd.storeId=Wc.store;rd.targetData=ma;this.nq.isAddinCommandsAsync(rd,(ee,De)=>{const Af=this.Mth(ma);var mg=ma.oa(R.a.isForUILessAction,!1);const dg=ma.oa(R.a.sharedRuntimeId,null),Zg=Wc.ownerAddinSolutionId,Gh=!!Af.oJ&&0<Af.oJ.state&&!!Af.oJ.Jbb;if(!De&&Wc.visibility||De&&Zg&&!Gh||mg&&!V.a.rb(dg))Zb(ma,this.d1),this.rTa.I9l(Wc.id,De);else if(De){if(mg=this.hxf(Wc.oub))Af.settings=mg.settings,this.pP.rvk(ma,
Af.settings);this.rTa.Kdl(Af.Kp,Af);this.rTa.I9l(Af.Kp,De);this.eZk(Af.Mx.id,Af.settings);if(Wc.visibility&&this.oXd.vEe||Gh){if("omex"!==rd.storeType.toLowerCase()&&!Gh)return;let wh=!1;this.mek(Ji=>{if(!Ji[F.a.Lfl]){if(Ji[F.a.n2h])for(const bi of Ji[F.a.n2h])if(wh=Lb.e(bi[1])===Lb.e(Wc.oub))break;wh||this.qah(Af)}})}}ee||T.a.J(512508176,220,10,"Checking AddinCommands fails for {0} from {1}",Wc.oub,this.tAe(Wc.storeType))})}else Zb(ma,this.d1)}}VJa(ma){return ma&&ma.assetId?ma.sourceLocationOverrideResourceId?
String.format("{0}.{1}",ma.assetId,ma.sourceLocationOverrideResourceId):ma.assetId:null}aqk(ma){ma.ZLb=-1;const Sa=this.Whl(ma);this.fLc=new uj(ma.z6c,ma.A6c,ma.JBd);void 0!=ma.dialogLeft&&void 0!=ma.osc&&void 0!=ma.dialogTop&&void 0!=ma.ksc&&this.fLc.zLn(ma.dialogLeft,ma.osc,ma.dialogTop,ma.ksc);void 0!=ma.dialogHeight&&void 0!=ma.dialogWidth&&this.fLc.ALn(ma.dialogHeight,ma.dialogWidth);this.fLc.msc=ma.msc;this.fLc.nsc=ma.nsc;this.fLc.Kp=ma.Kp;this.fLc.Dq(ma.qca,null,null);this.hxh(Sa,this.fLc.kNb,
null,ma)}Opk(ma){ma.ZLb=1;const Sa=this.Whl(ma),Zb=this.k0.FIa(Sa);if(u.AFrameworkApplication.bUd(Zb.oub)){const Wc=this.k0.Kdh(u.AFrameworkApplication.isRtl,Zb.id,Zb.width,Zb.visibility,ma);this.d1.F9(Wc);Wc.wA(Zb.visibility);this.hxh(Sa,Wc.wbh,null,ma)}else f.ULS.sendTraceTag(508425997,802,10,`AppForOfficeManager::renderFirstPartyTaskPane first party SDX addin ${Zb.oub} is not allowed`)}mek(ma){const Sa={};Sa.callback=ma;u.AFrameworkApplication.vb.Qa(eb.a.L5a,2,Sa)}qah(ma){const Sa=this.k0.Kdh(u.AFrameworkApplication.isRtl,
ma.Kp,ma.taskpane.width,ma.taskpane.visibility);this.d1.F9(Sa);Sa.wA(ma.taskpane.visibility);const Zb=Sa.wbh;Object(ta.a)(901,this.k0.xmi(this.EE.Md,ma,Zb,u.AFrameworkApplication.isRtl,this)).qah(this.nq,Zb,()=>{this.icb(ma);this.lca(Sa,!1,!!ma.oJ&&!!ma.oJ.Jbb);m.a.instance.setItem(F.a.O4c,"true")})}lca(ma,Sa,Zb){ma.wA(!1);Zb||(Nh.kBb.purgeOsfControl(ma.id,!1),Sa?this.EE.eS().Qa(Ua.a.T8c,2,ma.id):this.zmh.Vjl(ma.id),ma.dispose())}icb(ma){var Sa={};Sa.solutionId=ma.Mx.id;Sa.version=ma.Mx.version;Sa.storeType=
ma.Mx.storeType;Sa.storeId=ma.Mx.store;Sa.assetId=null;Sa.assetStoreId=null;Sa.sharedRuntimeId=ma.oJ?ma.oJ.Jbb:null;Sa.backgroundState=ma.oJ?ma.oJ.state:-1;ma=new b.a;ma.add(Sa);Sa={};Sa[F.a.aud]=ma;Sa[F.a.k9a]=3;this.EE.eS().Qa(eb.a.CFe,2,Sa)}L7c(){const ma=this.Rza.Qf;var Sa=null;ma&&(Sa=new Pe.GraphIterator,Sa.set(ma),Sa=Sa.Bb(18));return Sa}xT(ma){return ma?(ma=this.Rca.PIi(ma))&&ma.taskpane?ma:null:null}oJm(ma,Sa,Zb,Wc){if(!ma||!Sa||!Zb)return null;ma=this.getSharedRuntimeId(Sa,Wc,ma.solutionId,
Zb);return(Zb=this.Rca.aMm(Zb,ma,this.nq))&&Zb.taskpane?Zb:null}VBe(ma){return ma?(ma=this.Rca.$Ja(ma))&&ma.taskpane?ma:null:null}Cib(ma){if(!ma)return null;var Sa=this.L7c();if(Sa&&(Sa=this.Pb.Hc(Sa))&&Sa.Bb(19)){do{const Zb=Sa.currentNode;if(this.Pcf(Zb.oa(Ac.a.Ofb,null),ma))return Zb}while(Sa.Fj(19))}return null}hgh(ma){if(!ma)return null;var Sa=this.L7c();if(Sa&&(Sa=this.Pb.Hc(Sa))&&Sa.Bb(19)){do{const Zb=Sa.currentNode;if(this.Pcf(Zb.oa(za.a.I4,null),ma))return Zb}while(Sa.Fj(19))}return null}Vrl(ma,
Sa){return(ma=this.oc.Wk(ma))?ma.WZ(Sa):null}$ej(ma){return ma?this.Rca.LPm(ma):!1}pum(ma,Sa,Zb,Wc,rd){if(!ma||!ma)return null;if(!(ma.solutionId&&ma.version&&ma.storeId&&ma.storeType))return f.ULS.sendTraceTag(512508175,802,15,"Invalid entitlement"),null;const ee=Object(ta.a)(Qf.a,this.F$c.createInstance(1074135137));ee.setValue(Ac.a.Ofb,ma.solutionId);ee.setValue(Ac.a.qnc,ma.version);ee.setValue(Ac.a.pnc,ma.storeId);ee.setValue(za.a.m$b,this.vAe(ma.storeType));ma.assetId&&ma.assetStoreId&&(ee.setValue(za.a.k$b,
ma.assetId),ee.setValue(za.a.mnc,ma.assetStoreId));ee.setValue(Ac.a.onc,!1);ee.setValue(za.a.I4,ji.a.create().toString());ee.setValue(Ac.a.fze,"right");ee.setValue(Ac.a.n$b,Zb);rd&&ee.setValue(R.a.isForUILessAction,rd);Wc&&(ee.setValue(za.a.RAg,Wc),(ma=this.getSharedRuntimeId(Sa,rd,ma.solutionId,Wc))&&ee.setValue(R.a.sharedRuntimeId,ma));return ee}RIi(ma){ma=this.Cib(ma);return this.Mth(ma)}oum(ma,Sa){var Zb,Wc;if(!(ma&&ma&&ma.solutionId&&ma.version&&ma.storeId&&ma.storeType))return null;const rd=
null!==(Zb=ma.assetId)&&void 0!==Zb?Zb:null;Zb=null!==(Wc=ma.assetStoreId)&&void 0!==Wc?Wc:null;ma=new Qc(ma.solutionId,ma.version,ma.storeId,ma.storeType,rd,Zb);Sa=Sa?new sg(0,Sa):null;return new Bf(ma,null,null,null,null,{},1,Sa)}B6c(ma){te.Xwm(ma);const Sa=this.Rca.$Ja(ma);Sa&&(Nh.kBb.purgeOsfControl(Sa.Kp,!1),this.zmh.Vjl(Sa.Kp),this.Rca.nFn(Sa.Kp),this.M$c.nYl(Sa.Kp),this.bcc.uje(this.Nh,ma,!1,!0))}notifyAgave(ma,Sa){this.nq.notifyAgave(ma,Sa)}fEn(ma){!this.EJl&&ma.Vk&&(ma=ma.Vk,ma.Sd(47).R7(Object(r.a)(this,
this.rgl,"appDisposeHandler")),ma.Sd(10).R7(Object(r.a)(this,this.rgl,"appDisposeHandler")),this.EJl=!0)}rgl(ma,Sa){ma=Sa.node;Sa=ma.oa(za.a.ht,!1);const Zb=1074135137===ma.Me;if(Sa||Zb)ma=this.k0.FIa(ma),this.B6c(ma.id)}Whl(ma){var Sa;const Zb=Object(ta.a)(20,this.F$c.createInstance(1074135137));Zb.setValue(Ac.a.qnc,"1.0.0.0");Zb.setValue(Ac.a.pnc,"en-US");Zb.setValue(za.a.I4,ji.a.create().toString());Zb.setValue(Ac.a.n$b,!0);Zb.setValue(za.a.k$b,null);Zb.setValue(za.a.mnc,null);Zb.setValue(Ac.a.Ofb,
this.VJa(ma));(null!==(Sa=ma.V4g)&&void 0!==Sa?Sa:1)?(Zb.setValue(Ac.a.lzb,"sdxcatalog"),Zb.setValue(za.a.m$b,this.vAe("sdxcatalog"))):(Zb.setValue(Ac.a.lzb,"firstparty"),Zb.setValue(za.a.m$b,this.vAe("firstparty")));Zb.setValue(za.a.isAddinCommands,!1);Zb.setValue(Ac.a.onc,!1);Zb.setValue(Ac.a.fze,"right");return Zb}Mth(ma,Sa=null){if(!ma)return null;ma=this.k0.FIa(ma);var Zb=this.tAe(ma.storeType);const Wc=new Qc(ma.oub,ma.version,ma.store,Zb,ma.assetId,ma.assetStoreId);let rd=null,ee=null,De;if(-1==
(null===Sa||void 0===Sa?void 0:Sa.ZLb))De=new Sh;else if(0===ma.KN)rd=new $c(ma.shapeId,ma.slideId);else if(1===ma.KN)ee=new Hd(ma.Neh,ma.visibility,ma.width,ma.row,ma.ownerAddinSolutionId,ma.ownerAddinStoreType,ma.fkh);else return null;let Af={};Sa&&OSF.OsfControl.isFirstPartyStoreString(Zb)?Af=OSF.OUtil.serializeSettings(Sa.nonPersistedSettings):ma.ownerAddinSolutionId||(Af=ma.settings);Zb=ma.ZHa?new sg(ma.xSa,ma.ZHa):null;return new Bf(Wc,ma.id,rd,ee,De,Af,De&&Sa?Sa.ZLb:ma.KN,Zb)}kLe(ma,Sa=null){if(this.Fb.getBooleanAppSetting(Oc.a.QUl)){var Zb=
this.nq.getOsfControl(ma);if(Zb&&Sa){if(Sa.nonPersistedSettings){var Wc=OSF.OUtil.serializeSettings(Sa.nonPersistedSettings);Zb.setSettings(Wc);Zb.setHostSettings(Wc)}Sa.JB&&(Wc=Object(ta.a)(902,this.VBe(ma)))&&(Wc.o9a=Sa.JB,this.TWc(ma,!0));Zb.refresh();this.VWk(ma)}}}hxh(ma,Sa,Zb=null,Wc=null){const rd=this.Mth(ma,Wc);if(!rd||OSF.OsfControl.isFirstPartyStoreString(rd.Mx.storeType)&&!u.AFrameworkApplication.bUd(rd.Mx.id))return null;var ee=this.k0.FIa(ma);if(this.Fb.getBooleanAppSetting(Oc.a.oSc)&&
!OSF.OsfControl.isFirstPartyStoreString(this.tAe(ee.storeType)))return this.Hm.v0a(22)||this.Hm.Z$b(22),null;Wc&&Wc.JB&&(rd.o9a=Wc.JB);ee=Object(ta.a)(901,this.k0.xmi(this.EE.Md,rd,Sa,u.AFrameworkApplication.isRtl,this));this.Rca.Kdl(rd.Kp,rd);this.Rca.Ynm(rd.Mx.id,Sa);Wc&&Wc.LU&&Wc.LU();this.EE.Md.m0a&&rd.taskpane&&rd.taskpane.ownerAddinSolutionId&&(Sa=this.Rca.PIi(rd.taskpane.ownerAddinSolutionId))&&this.o9l(Sa.Kp,rd.Kp);ee.oPn(this.nq,this.oFk(ma),Zb,Wc,this.oXd.ldc);rd.taskpane&&rd.taskpane.ownerAddinSolutionId||
this.fEn(ma);return ee}$Ok(ma){if(this.oXd.iEl){const Zb=this.rTa.$Ja(ma);if(Zb&&0===Zb.KN&&Zb.shape){var Sa=this.rTa.yTm(ma);const Wc=new Date;!Sa||Wc.getTime()-Sa.getTime()>=this.oXd.cKe?(f.ULS.sendTraceTag(512508173,806,50,"Start to generate addin [{0}] {1} snapshot",Zb.Mx.id,ma),(Sa=this.Man.Xll(1,ma))?(this.rTa.xYn(ma,Wc),Sa.execute(this,this.Ian,null)):f.ULS.sendTraceTag(512508172,806,50,"Snapshot action is null for addin [{0}] {1}.",Zb?Zb.Mx.id:"AppNotExist",ma)):f.ULS.sendTraceTag(512508171,
806,50,"Addin [{0}] {1} snapshot interval is less than config interval threshold.",Zb?Zb.Mx.id:"AppNotExist",ma)}}}JQl(ma,Sa,Zb,Wc){1===ma&&this.Bsn(Sa,Zb,Wc)}Bsn(ma,Sa,Zb){let Wc=null;Zb&&Zb.result&&(Zb=Zb.result,Wc=Zb.substr(Zb.indexOf("base64,")+7));const rd=this.rTa.$Ja(ma);Sa===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&Wc&&0<Wc.length&&rd?0===rd.KN&&rd.shape&&rd.Mx&&this.qm.zzh(rd.shape.slideId.toString(),rd.shape.id,Wc,()=>{f.ULS.sendTraceTag(512508170,806,50,"Update addin [{0}] {1} snapshot succeed with {2} bytes",
rd.Mx.id,ma,Wc.length)},()=>{f.ULS.sendTraceTag(512508169,806,10,"Update addin [{0}] {1} snapshot failed",rd.Mx.id,ma);return!1}):f.ULS.sendTraceTag(512508168,806,10,"Generate addin [{0}] {1} snapshot failed with {2} bytes",rd?rd.Mx.id:"AppNotExist",ma,Wc?Wc.length:0)}hxf(ma){return ma?this.aHl[ma]:null}Cah(ma,Sa){ma&&Sa&&(this.aHl[ma]=Sa)}get pP(){this.iBj||(this.iBj=new Nb(this.EE.Md,ia.a.instance.resolve("Common.IAppSettingsManager"),this.eW,ia.a.instance.ge("Box4.IOutlineEditor"),ia.a.instance.ge("Box4.ISelectionManager"),
ia.a.instance.ge("Box4.ICharacterPropertiesEditor"),ia.a.instance.ge("PowerPointWebEditor.IClassFactory"),ia.a.instance.resolve("Common.Transaction.ITransactionFactory"),this.EE.eS(),ia.a.instance.resolve("PowerPointWebEditor.IPPTWorkspace"),ia.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ia.a.instance.resolve("Common.ITaskManager"),ia.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),ia.a.instance.resolve("PowerPointWebEditor.ISlideReader"),ia.a.instance.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"),
ia.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),ia.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),ia.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),ia.a.instance.resolve("PowerPointWebEditor.IShapeReader"),ia.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),ia.a.instance.resolve("Box4.IOutlineElementNavigator"),ia.a.instance.resolve("Box4.IParagraphReader"),ia.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager"),ia.a.instance.resolve("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory")));
return this.iBj}get hTa(){return this.bcc}idd(ma,Sa,Zb){this.zmh.OIi(ma).raiseEvent(Zb,Sa)}FWl(ma,Sa){this.Rca.xGi(Zb=>{this.idd(ma,Zb.Kp,Sa)})}o9l(ma,Sa){if(ma&&Sa){ma=this.rTa.$Ja(ma);var Zb=this.rTa.$Ja(Sa);ma&&Zb&&(Zb.settings=ma.settings,this.MQl(Sa,ma.settings))}}eZk(ma,Sa){ma&&Sa&&this.rTa.xGi(Zb=>{this.Pcf(Zb.taskpane.ownerAddinSolutionId,ma)&&!this.xbh.D3m(Zb.settings,Sa)&&(Zb.settings=Sa,this.MQl(Zb.Kp,Sa))})}vyl(ma){this.Hka(ma.mode)}Hka(ma){if(1!==ma&&2!==ma)throw Error.invalidOperation(String.format("The mode '{0}' being swtiched to is unsupported.",
ma));f.ULS.sendTraceTag(512508167,806,50,"AppForOfficeManager.SwitchToMode: {0} the content add-in's container on active slide.",2===ma?"Show":"Edit");this.M$c.Hka(ma);this.d1.Hka(ma)}MQl(ma,Sa){const Zb=OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString();this.idd(Zb,ma,Sa)}tAe(ma){switch(ma){case 0:ma="spcatalog";break;case 1:ma="filesystem";break;case 2:ma="omex";break;case 3:ma="spapp";break;case 4:ma="registry";break;case 5:ma="inmemory";break;case 6:ma="uploadfiledevcatalog";break;case 7:ma=
"excatalog";break;case 8:ma="firstparty";break;case 9:ma="sdxcatalog";break;default:throw Error.create(String.format("[{0}] is not the valid store type int value.",ma));}return ma}vAe(ma){if(!ma)throw Error.create("Store Type should not be null.");Nh.Kbb||Nh.D1m();if(ma in Nh.Kbb)return Nh.Kbb[ma];throw Error.create(String.format("[{0}] is not the valid store type.",ma));}MXi(ma){return ma?this.Rca.VIm(Sa=>this.Pcf(Sa.Mx.id,ma)):null}get W3h(){return this.EE}lqm(ma){this.ua.addHandler("OnInsertionDialogOpened",
ma)}maf(ma){this.ua.addHandler("OnFirstPartyAddInHidden",ma)}cGn(ma){this.ua.removeHandler("OnFirstPartyAddInHidden",ma)}Ufk(ma){this.ua.raiseEvent("OnFirstPartyAddInHidden",new Rj(ma))}$xd(ma){const Sa=Mi.a.PRa(this.d1.l9a,Zb=>Zb.id===ma);if(1!==Sa.length)return!1;this.lca(Sa[0],!0,this.SAb(ma));return!0}TWc(ma,Sa){const Zb=Mi.a.PRa(this.d1.l9a,Wc=>Wc.id===ma);1!==Zb.length?T.a.J(512508166,220,50,"Panes with appropriate instance id are {0}",Zb.length):Zb[0].wA(Sa)}yLm(ma){const Sa=Mi.a.PRa(this.d1.l9a,
Zb=>Zb.id===ma);return 1!==Sa.length?(T.a.J(512508165,220,50,"Panes with appropriate instance id are {0}",Sa.length),!1):Sa[0].isVisible}iWn(ma,Sa){const Zb=this.hxf(ma);Zb&&Zb.oJ&&Zb.oJ.Jbb&&(Zb.oJ.state=Sa?1:0,(this.Cib(ma)||this.xbh.xyl(ma,Zb.settings,this))&&this.EE.eS().Qa(Ua.a.POe,2,Zb))}zLm(ma){return(ma=this.hxf(ma))&&ma.oJ?1===ma.oJ.state:!1}mkl(ma){this.rTa.xGi(Sa=>{this.Pcf(Sa.taskpane.ownerAddinSolutionId,ma)&&this.$xd(Sa.Kp)})}mGd(ma){return this.Rca.$Ja(ma)}SAb(ma){if(!ma||4===this.nq.getOsfControlStatus(ma))return!1;
ma=this.nq.getOsfControl(ma);return!!ma&&!!ma.getSharedRuntimeId()}setInitialDisplayMode(ma,Sa){(ma=this.nq.getOsfControl(ma))&&ma.setInitialDisplayMode(Sa)}getSharedRuntimeId(ma,Sa,Zb,Wc){if(!ma)return null;const rd=new Qd;if(!rd)return null;if(Sa)return ma.getSharedRuntimeId(rd.aLa,Sa,null);Zb=(new Va("",Wc,rd,!0)).knl(Zb.substr(Wc.length));return ma.getSharedRuntimeId(rd.aLa,Sa,Zb)}xJm(ma,Sa){const Zb={};Zb.visibility=Sa?"Visible":"Hidden";Sa=JSON.stringify(Zb);this.fsl(ma,65539,"",Sa)}yJm(ma,
Sa,Zb){this.fsl(ma,1,Sa,Zb)}KQn(ma,Sa){ma=new Qc(ma.solutionId,ma.version,ma.storeId,ma.storeType,null,null);var Zb=new Hd("right",!0,350,0,null,null,!1);ma=new Bf(ma,Oi.a.create().toString(),null,Zb,null,{},1,null);const Wc=this.k0.Kdh(u.AFrameworkApplication.isRtl,ma.Kp,ma.taskpane.width,ma.taskpane.visibility);this.d1.F9(Wc);Wc.wA(ma.taskpane.visibility);Zb=Wc.wbh;Object(ta.a)(901,this.k0.xmi(this.EE.Md,ma,Zb,u.AFrameworkApplication.isRtl,this)).qah(this.nq,Zb,()=>{this.lca(Wc,!1,!1);Sa()})}fsl(ma,
Sa,Zb,Wc){var rd=Array(6);rd[0]=65536;rd[1]=Sa;rd[2]=Zb;rd[3]=Wc;rd[4]=-1;rd[5]=!1;Sa=Array(1);Sa[0]=rd;rd=new $d(OSF.DDA.EventDispId.dispidRichApiMessageEvent,ma,null,Sa);this.idd(OSF.DDA.EventDispId.dispidRichApiMessageEvent.toString(),ma,rd)}Pcf(ma,Sa){return ma&&Sa?ma.toLowerCase()===Sa.toLowerCase():!1}oFk(ma){return!this.Db||1!==this.Db.mode||ma&&"FA000000012"===ma.oa(za.a.k$b,null)?1===this.k0.FIa(ma).KN?!0:this.Ia.ATa(ma)?this.va.Ga===this.nc.Cg(ma):!1:!1}get Nh(){return this.EE.o$a().Nh}get ydh(){return this.M$c}get rTa(){return this.Rca}get k0(){return this.AEc.value}get sIn(){return this.ung}get BAn(){return this.Olg}get Sy(){return this.va}static D1m(){Nh.Kbb=
{};Nh.Kbb.inmemory=5;Nh.Kbb.uploadfiledevcatalog=6;Nh.Kbb.spcatalog=0;Nh.Kbb.omex=2;Nh.Kbb.registry=4;Nh.Kbb.spapp=3;Nh.Kbb.filesystem=1;Nh.Kbb.excatalog=7;Nh.Kbb.firstparty=8;Nh.Kbb.sdxcatalog=9}get WG(){return this.Iaf}get Iaf(){this.obh&&!this.pGl&&(this.jna?window.setTimeout(()=>{this.tmh||f.ULS.sendTraceTag(508598484,220,15,"When AddinDetailsManager.queryAddinDetails has not been called yet, a timed-out error occurs.")},this.Kan):this.PEn&&this.gHm(this.Jan),this.pGl=ih.createInstance(this.Fb,
new Ti.a(()=>this.nq),{["AppsForOfficeAllowExternalMarketplace"]:this.oXd.cfj,["AppsForOfficeThirdPartyIsDisabled"]:this.oXd.y9c,["AreThirdPartyAddInsAllowed"]:this.oXd.uSa,["PopularAddinDetailsJsonString"]:this.Rvd&&this.kwn?Nh.jwn:Nh.ycd}));return this.pGl}get obh(){return this.Fb.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}get PEn(){return this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",!1)}get jna(){return this.Fb.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&
this.Fb.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}gHm(ma){window.setTimeout(()=>{this.IHm()},ma)}IHm(){this.tmh?f.ULS.sendTraceTag(508826763,220,50,"The 1st attempt succeeded."):(f.ULS.sendTraceTag(508826764,220,15,"the 1st attempt was timeout, trigger another try."),this.tka(0,!0))}static yUd(ma){return 0===ma||10===ma}hje(ma,Sa){this.Iaf&&this.Iaf.hje(ma,Sa)}tka(ma,Sa){this.Iaf&&(!this.tmh&&Nh.yUd(ma)&&(this.tmh=!0),this.Iaf.tka(ma,Sa))}static get ycd(){return'[{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"wa104178141","version":"4.3.3.0","targetType":1,"width":0,"height":0,"description":"Unlimited access to licensed photos, clipart and your company\'s images in PowerPoint.","iconUrl":"52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickit.com/en/privacy-policy","addinInfo":{"priority":1,"AUP":2656}},{"displayName":"Poll Everywhere Presenter","solutionId":"wa104218073","version":"3.0.0.1","targetType":0,"width":960,"height":540,"description":"Gather audience responses via SMS or web, and display them instantly in gorgeous PowerPoint charts.","iconUrl":"27009.88b1aa30-f74d-43ab-b5f6-4565d9a70427.06bc2362-a830-44c4-84e3-f5b99c45acf8.47ba58ff-e53f-4c3e-bea2-3aa7562d1cc6.png","licenseUrl":"https://www.polleverywhere.com/terms","privacyUrl":"https://www.polleverywhere.com/privacy-policy","addinInfo":{"priority":2,"AUP":2577}},{"displayName":"Web Video Player","solutionId":"wa104221182","version":"3.3.0.0","targetType":0,"width":730,"height":411,"description":"Add YouTube videos to your PowerPoint presentations or Excel spreadsheets.","iconUrl":"21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.michael-saunders.com/videoplayer/pages/privacy.html","addinInfo":{"priority":1,"AUP":3054}},{"displayName":"Web Viewer","solutionId":"wa104295828","version":"1.9.0.0","targetType":0,"width":960,"height":540,"description":"Take it to the web! Insert a secure webpage into your presentation.","iconUrl":"53665.f48f5d64-1b9c-4db4-8579-0a8a770cc1df.479bd539-f5d1-4edd-8d3f-fd2aa12fe078.d7ba8494-d2ee-426a-985a-25a7db9bf8f5.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949675993/Asset_901070fc-4837-4edc-83b0-b3438f2ddf97/OfficeMixEULA.docx","privacyUrl":"https://aka.ms/mixaddinprivacy","addinInfo":{"priority":2,"AUP":8127}},{"displayName":"Mentimeter - Interactive Presentations","solutionId":"wa104379261","version":"3.0.2.4","targetType":0,"width":1000,"height":700,"description":"Engage your audience with fun and interactive presentations, visualizing their opinions in real-time","iconUrl":"51223.47e20eb4-286a-415c-a7c6-a30d8aaf5dd8.bb9bb1df-e506-4b71-82d1-44c6d0de3876.92bae303-c177-4756-a889-8da8fce426e2.png","licenseUrl":"https://www.mentimeter.com/terms","privacyUrl":"https://www.mentimeter.com/privacy","addinInfo":{"priority":3,"AUP":13796}},{"displayName":"LessonPix Symbols","solutionId":"wa104379370","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access your LessonPix Account and over 50K clipart symbols from within Microsoft Office.","iconUrl":"52104.453267e0-c2e7-43b0-b9d8-1a14024ce16f.bf27c658-00f3-4406-81ca-374c6f1bd24b.9ef3504f-30b7-4fd3-b135-7931280a8d74.png","licenseUrl":"https://lessonpix.com/articles/11/299/LessonPix%20Office%20Add-In%20Terms%20and%20Conditions","privacyUrl":"https://lessonpix.com/articles/11/26/LessonPix+Privacy+Policy","addinInfo":{"priority":1,"AUP":688}},{"displayName":"Pexels - Free Stock Photos","solutionId":"wa104379997","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Get great looking free stock photos for your documents and presentations.","iconUrl":"42183.883a975e-b768-42b6-804b-7440e32d8a14.594bab1e-71b2-4309-b08a-27d3d8832a91.9373d154-174d-40db-873f-11b8a2e636a4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://officeconsult.no/en/pexels-office-add-in/#privacy","addinInfo":{"priority":1,"AUP":307}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":1102}},{"displayName":"Emoji Keyboard","solutionId":"wa104380121","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Emoji for Microsoft Word, PowerPoint and OneNote","iconUrl":"59740.f26acde8-b516-46ad-8220-2984e6945380.2f899a00-04c7-483e-9ee2-e1b35c2b080f.12545571-342a-4850-b117-43d02783ed9d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://emoji.patbu.xyz/#/privacy","addinInfo":{"priority":1,"AUP":1275}},{"displayName":"Templafy Company Templates","solutionId":"wa104380278","version":"1.0.0.6","targetType":1,"width":0,"height":0,"description":"Access best practice professional templates and digital assets within your Office applications","iconUrl":"39478.da1eadf9-2005-4a37-9f41-d99acc46197e.5e0830db-920f-4070-b60e-bbd8de8c498c.6e4a303a-5acd-4946-9a57-53715948ec92.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.templafy.com/privacy","addinInfo":{"priority":3,"AUP":228}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":1790}},{"displayName":"officeatwork | Content Chooser for Office","solutionId":"wa104380602","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared content in Word, Excel, PowerPoint, Outlook, Browser, and other Apps.","iconUrl":"21517.8509aff9-edc8-4f6a-8b59-4b406996c84a.d1a19980-7c71-4be1-8215-82ff5834af8f.fa526dd8-ee50-4045-add0-21357070c87b.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":3,"AUP":1500}},{"displayName":"PP Timer","solutionId":"wa104380667","version":"3.0.0.1","targetType":0,"width":640,"height":480,"description":"Insert a timer into your PowerPoint presentation. Add an analog or digital timer into your slide.","iconUrl":"34537.0bb60981-b391-4645-8398-65b19c9df09a.571de747-edd5-4568-9dd0-072bcf87df09.69ce727f-55eb-405a-9470-668ccee0d6fc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pp-timer.com/privacy-policy","addinInfo":{"priority":1,"AUP":24}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":459}},{"displayName":"Pixton Comic Characters","solutionId":"wa104380907","version":"3.1.0.0","targetType":1,"width":0,"height":0,"description":"Add illustrated, posable comic characters to your training or educational presentations.","iconUrl":"29860.e57c0b3f-b9bb-4ebd-b4e4-8b64b797db43.8ed21d66-e83f-4ec7-98e4-f637d866c239.755b4296-081d-4793-8eb5-ed82118043d8.png","licenseUrl":"https://www.pixton.com/terms-of-use/addons","privacyUrl":"https://www.pixton.com/privacy-policy/addons","addinInfo":{"priority":1,"AUP":1945}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":341}},{"displayName":"Icons by Noun Project","solutionId":"wa104381063","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Over 1 million high-quality icons to choose from, perfect for presentations.","iconUrl":"43800.2d301a6f-7f58-486a-aa28-60900de38763.afe578dd-fbdd-497d-b1e4-66a6217bfb17.c7c39ea5-5370-437d-8e9d-f9fe1fa77b09.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://thenounproject.com/legal/#!privacy-policy","addinInfo":{"priority":1,"AUP":515}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint","solutionId":"wa104381155","version":"1.1.1.0","targetType":1,"width":0,"height":0,"description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"31139.c4694bde-161e-42b4-8b8f-87f0c1b5010e.4a78185a-5a69-438c-99c2-80f85f7092a3.39897ffc-7ed4-4e29-bd29-b748bc14ae57.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":4724}},{"displayName":"IconScout - Icons, Illustrations & 3D Assets","solutionId":"wa104381411","version":"2.4.1.0","targetType":1,"width":0,"height":0,"description":"Seamlessly access over 4.5 Million+ Design assets within Microsoft Office Applications","iconUrl":"36684.41fa480b-3128-4253-a7ae-3e7c1406bfb6.07fc268d-eaaa-4f81-b6b3-911c8b2d104d.5b4a7a13-0f35-4b05-a07e-7b5c347ad154.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://iconscout.com/legal/privacy-policy","addinInfo":{"priority":1,"AUP":562}},{"displayName":"Ubi Timer","solutionId":"wa104381448","version":"1.0.0.8","targetType":0,"width":348,"height":720,"description":"Add a customisable timer to your PowerPoint presentation slides.","iconUrl":"8460.b2044bd4-1b25-41e3-9810-3564d9472171.804e0d26-99a8-4b72-a103-49327a1a30b8.f01fef0d-5053-4e80-b246-34524e7c5f69.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ubicompsolutions.co.uk/timer_privacy","addinInfo":{"priority":3,"AUP":127}},{"displayName":"Forms","solutionId":"wa104381526","version":"1.0.0.2","targetType":0,"width":800,"height":450,"description":"Embed surveys, quizzes, and polls directly into a PowerPoint slide.","iconUrl":"3597.3f744035-7cc5-4b23-9aea-1e7380b37172.42f8397f-a77f-48a3-a506-4032a34b3bf7.14bf7247-1539-4086-9824-7fe176221f3d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?linkid=871815","addinInfo":{"priority":3,"AUP":50753}},{"displayName":"Wooclap","solutionId":"wa104381682","version":"1.0.0.5","targetType":0,"width":900,"height":500,"description":"With its many features and intuitive use, Wooclap turns events into interactive and dynamic learning","iconUrl":"13441.9fb6980a-f99b-4bf1-9d44-82fefa4843e1.4d33dfef-862e-473d-bfb1-2bdabc490da8.e1403f2d-3a83-46a6-8215-0a1020f33bbc.png","licenseUrl":"https://www.wooclap.com/en/terms-of-service","privacyUrl":"https://www.wooclap.com/en/privacy-policy","addinInfo":{"priority":2,"AUP":2742}},{"displayName":"MathType","solutionId":"wa104381909","version":"3.5.1.0","targetType":1,"width":0,"height":0,"description":"Write math equations and chemical formulas in your documents and presentations with MathType.","iconUrl":"44741.813eee75-3ca3-4574-8852-d4a1ee5fd6fb.a6600903-ad52-41cc-a277-a99d413f741b.18009730-067c-46f9-a8f7-539cd53cbd6b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.wiris.com/en/mathtype-privacy-policy","addinInfo":{"priority":1,"AUP":2153}},{"displayName":"EasyTimer","solutionId":"wa104382064","version":"1.0.0.2","targetType":0,"width":1000,"height":600,"description":"An easy-to-use timer for your PowerPoint presentations.","iconUrl":"17586.18a4e21f-e685-4cd1-910e-2b2e032b01ff.5f21673c-f2a3-4710-8cdc-532e6d7a4f45.baa310be-ee05-44be-8e2b-1373024798f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://lixiaoooowei.github.io/TimerLab/Home/PrivacyPolicy.html","addinInfo":{"priority":2,"AUP":2671}},{"displayName":"Pear Deck Add-in","solutionId":"wa200000094","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Add formative assessments and interactive activities to lessons and presentations","iconUrl":"59452.62af3df0-63ba-40f1-83d3-a0bc16189b66.26661aad-7dc8-4f47-a9d9-3aa9c939d106.e9f66df9-6115-41f5-8721-fab23ac9b3a8.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.peardeck.com/privacy-policy","addinInfo":{"priority":3,"AUP":6789}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":1715}},{"displayName":"Adobe Creative Cloud for Word and PowerPoint","solutionId":"wa200000729","version":"3.19.222.0","targetType":1,"width":0,"height":0,"description":"Bring your creative elements into Microsoft Office. Creative Cloud app is required for this add-in.","iconUrl":"18500.2f664073-3b83-4944-804c-69c30f0e9064.600364c5-532a-4bb4-8ea4-627757d016c6.9c5597d2-2156-401e-8697-18cb65b7c13c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.adobe.com/go/privacy-policy","addinInfo":{"priority":-1,"AUP":1132}},{"displayName":"Present Pal add-in - Presentation Support","solutionId":"wa200001313","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Control your slideshow directly from the Present Pal app to make presenting easy and accessible!","iconUrl":"26522.34e9b858-f1e6-4aa8-b47f-dfb0c9224869.2f9ca7d4-7141-4377-bde9-adcb55b44237.6092b85f-1084-427b-a1ec-55b33b8ee41f.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://presentpal.co.uk/privacy-policy","addinInfo":{"priority":3,"AUP":219}},{"displayName":"Premast Plus","solutionId":"wa200001396","version":"4.1.3.0","targetType":1,"width":0,"height":0,"description":"Use Premast plus features and professional templates to design better presentation, faster. Without ","iconUrl":"62947.925c188e-dab2-4231-acfb-60d131eb7da4.132d74f0-1c13-48eb-b8f5-fcec0b139825.1b91bd7f-2be5-430e-a33c-2016eb52f79a.png","licenseUrl":"https://premast.com/plus-terms-of-use","privacyUrl":"https://premast.com/privacy-policy","addinInfo":{"priority":1,"AUP":168}},{"displayName":"Slides365 - Build Professional Presentations Yourself","solutionId":"wa200001409","version":"1.0.0.3","targetType":1,"width":0,"height":0,"description":"Guided storytelling using pre-built Templates, Industry Domain Slides, Design Slides and Icons","iconUrl":"10382.5c0bebe6-0d6f-40c0-88ff-4bcc1c0a3acb.9a0fd746-d03b-42f5-8b9f-1eced5547c82.1b9b795d-9337-411d-be6b-fd064ef3dec8.png","licenseUrl":"https://slides365.com/Terms.html","privacyUrl":"https://slides365.com/Privacy-Policy.html","addinInfo":{"priority":2,"AUP":566}},{"displayName":"SlideHub","solutionId":"wa200001625","version":"1.0.0.7","targetType":1,"width":0,"height":0,"description":"Helps SlideHub users build better presentations faster via various tools and an on-demand service ","iconUrl":"28341.df79b07c-0691-4db6-9851-8b81eaa9f482.805bbb88-2bbf-4a63-9d09-d9c6ebedfc46.339597b4-5e8a-4295-8925-ed11ad30fbc1.png","licenseUrl":"https://slidehub.io/eula","privacyUrl":"https://slidehub.io/privacy","addinInfo":{"priority":2,"AUP":3193}},{"displayName":"Breaktime","solutionId":"wa200001661","version":"2.1.0.2","targetType":0,"width":800,"height":600,"description":"A quick way to tell everyone when you\'ll be back, because it\'s Breaktime!","iconUrl":"53429.790a3023-92b3-4c27-bd32-62a1ac84d552.c35b1205-7b21-4321-84c7-9708e97de568.4d0318b8-f51d-4eef-ae55-3c20fb66521e.png","licenseUrl":"https://www.flosim.com/breaktime/EULA.html","privacyUrl":"https://www.flosim.com/breaktime/Privacy_Policy.html","addinInfo":{"priority":1,"AUP":6596}},{"displayName":"Canto Connector","solutionId":"wa200001766","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Simplify how you add images and brand elements to Word and PowerPoint from your Canto image library.","iconUrl":"7869.c66666c2-edf3-4109-955b-4b8dcefb734e.39d11081-f25d-4285-9427-84ecd59deb0a.d2b7f5df-5a3f-4755-a8a6-9c5dd4a750dc.png","licenseUrl":"https://team.canto.com/b/Q9GTF","privacyUrl":"https://www.canto.com/privacy-policy","addinInfo":{"priority":3,"AUP":68}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":2,"AUP":869}},{"displayName":"Kahoot! for PowerPoint","solutionId":"wa200002908","version":"1.1.0.0","targetType":0,"width":800,"height":480,"description":"Host kahoots within PowerPoint and make presentations awesome! ","iconUrl":"5821.dc651664-7ea2-4fed-b845-27e926a3bf3f.29a4cdf3-8814-4a22-b5b3-c79c432e8b0f.0c3e5c0c-62fb-4d25-8518-3bf537f62cd0.png","licenseUrl":"https://trust.kahoot.com/terms-and-conditions","privacyUrl":"https://trust.kahoot.com/privacy-policy","addinInfo":{"priority":1,"AUP":2861}},{"displayName":"RRSlide Library","solutionId":"wa200003157","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"We supply PowerPoint templates, infographics, charts, 3D icons, etc. to make a quick presentation","iconUrl":"27146.0ffbcab3-3f86-4d90-847e-e9e416c2f04d.1ada7438-24b1-4363-861f-4f3235e1fe56.1c5b196a-7fe5-49ea-ad4c-a502150e70e9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://rrslide.com/privacy-policy","addinInfo":{"priority":2,"AUP":222}},{"displayName":"Microsoft Power BI","solutionId":"wa200003233","version":"2.0.0.3","targetType":0,"width":960,"height":570,"description":"Enhance storytelling with data by easily including Power BI reports into your presentation.","iconUrl":"44848.68115a5f-13b5-4260-9fe9-b6c37e561377.e47b03c9-a5b9-4b5b-97be-affb2ee9bff5.82fc138b-c424-4039-b098-8fdbd0d76965.png","licenseUrl":"https://docs.microsoft.com/en-us/dynamics365/legal/apps-for-power-platform-tou","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":143978}},{"displayName":"Microsoft Power BI Beta","solutionId":"wa200003251","version":"2.0.0.4","targetType":0,"width":960,"height":570,"description":"Enhance storytelling with data by easily including Power BI reports into your presentation.","iconUrl":"44848.e29569b7-a73e-472a-906f-7d3d7b5b56d0.6c0dd532-76c1-4565-a1f0-e5e8d45f1138.f53a6d02-633b-4da5-a56f-f804e844a2a0.png","licenseUrl":"https://docs.microsoft.com/en-us/dynamics365/legal/apps-for-power-platform-tou","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":657}},{"displayName":"Showmaster (Helper Plugin)","solutionId":"wa200003676","version":"1.0.0.0","targetType":0,"width":957,"height":538,"description":"Impress with remarkable animations, countdown and music before your presentation.","iconUrl":"38182.cc4515b5-7941-4c49-8152-a4da1dceef8d.f2ec1037-3774-4e94-a41a-f9e6432611d8.b9e80121-ccc1-40f9-b6f7-3430a31b50fc.png","licenseUrl":"https://showmaster.app/terms","privacyUrl":"https://showmaster.app/privacy","addinInfo":{"priority":3,"AUP":361}},{"displayName":"Showmaster","solutionId":"wa200003706","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Impress with remarkable animations, countdown and music before your presentation.","iconUrl":"38182.e0b83de2-8341-4aaf-a8da-e9a86c1dfdd3.e729953e-7bb6-4556-8a33-55c83e572918.0fe180b8-8511-42ae-b526-0796e91fbee1.png","licenseUrl":"https://showmaster.app/terms","privacyUrl":"https://showmaster.app/privacy","addinInfo":{"priority":3,"AUP":122}},{"displayName":"PresenterMedia | Thousands of Animations, Templates, and Designs at your Fingertips","solutionId":"wa200003891","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Insert customized graphics, templates and videos directly into your presentation.","iconUrl":"37569.30ec0671-d417-4ae9-8009-4cee496ea074.3b3c120c-ea56-4a82-a3c1-82e4591f6140.e03fae66-8132-4071-a176-963a53dd2798.png","licenseUrl":"https://www.presentermedia.com/addin_terms_of_use","privacyUrl":"https://www.presentermedia.com/privacy_policy","addinInfo":{"priority":3,"AUP":293}},{"displayName":"Read on reMarkable","solutionId":"wa200003915","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily send Word and PowerPoint documents to your reMarkable.","iconUrl":"7364.f24d322e-3985-4b36-9f2b-d1a92a90534c.43df7b3a-e5a9-4d72-ad4c-53ba599d45c7.1c530b09-8be4-40d7-878f-1bacd2fd0bce.png","licenseUrl":"https://support.remarkable.com/hc/en-us/articles/360000282757-reMarkable-End-User-License-Agreement","privacyUrl":"https://support.remarkable.com/hc/en-us/sections/360000090338-Privacy-Policy","addinInfo":{"priority":2,"AUP":466}},{"displayName":"beautiful.ai | AI powered slide templates","solutionId":"wa200003964","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Create beautiful presentations faster with AI powered slide templates","iconUrl":"5525.df072342-580e-437e-9d68-96615f75b68a.7429d240-ba6f-4dc1-b122-5ce6e89e8b49.50a5f98b-bd54-446f-a983-3d56cf4f16ca.png","licenseUrl":"https://www.beautiful.ai/terms-of-service","privacyUrl":"https://www.beautiful.ai/privacy-policy","addinInfo":{"priority":1,"AUP":2308}},{"displayName":"Project Plan","solutionId":"wa200004643","version":"1.0.0.3","targetType":0,"width":957,"height":538,"description":"Visualize your project plans and roadmaps right in PowerPoint and Excel.","iconUrl":"48512.5fa6879a-44fb-480a-8848-5280995a049e.88d32693-93e0-4681-93a8-a59ee99f893b.c488f1bf-ea9e-4e56-9711-4a5a41a432c4.png","licenseUrl":"https://www.projectplan-powerpoint.com/terms","privacyUrl":"https://www.projectplan-powerpoint.com/privacy","addinInfo":{"priority":1,"AUP":517}},{"displayName":"Vevox for PowerPoint (BETA)","solutionId":"wa200004709","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"Include Live Polls and interaction in PowerPoint presentations with the #1 rated polling platform.","iconUrl":"30836.b99a2c67-c0f9-4608-ab59-33f5dab5dffa.3c46736f-fe0e-4dad-b17e-edb4bd558f68.7ecef1a1-72c6-4083-afb1-715afe5fb27c.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.vevox.com/terms-conditions#PrivacyPolicy","addinInfo":{"priority":1,"AUP":601}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Use ChatGPT with the CoPilot experience right within your favorite office app.","iconUrl":"33851.9a73910f-bc07-461c-a5aa-da58e2ce898e.fe022fd3-f2d4-4057-bd68-fd8ef192180a.ac2e20fb-999e-43fc-b780-f35d91b9db91.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":1,"AUP":793}},{"displayName":"ChatGPT for PowerPoint","solutionId":"wa200005566","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"ChatGPT for Power Point - Transform Your Creativity into Stunning Slides! ","iconUrl":"60795.2ddb2031-2b3c-46f9-9ba9-970c6c6e57f2.4f9f089a-ead2-497f-83b6-c8856060da4a.1def0a40-20b2-4bc6-9365-76b02fbb890d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://appsdowonders.com/privacy-policy-chatgpt-for-powerpoint","addinInfo":{"priority":1,"AUP":6217}},{"displayName":"Personalised QR Code Generator","solutionId":"wa200003220","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":306}},{"displayName":"PickMe - Presentation images","solutionId":"wa104380510","version":"1.0.0.3","targetType":1,"width":0,"height":0,"description":"Search and add images, photos, icons and background images for your best presentation.","iconUrl":"45844.d6cd8bac-3b6d-45dc-8fbe-6307d6477d25.c4010abd-54d6-4345-be6e-fb8cdb8f926e.2095bcd7-d785-46dd-9472-c95cceb628d2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickme.gettyimagesbank.com/guide/Privacy/privacy_policy","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"Grafi","solutionId":"wa200006046","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Boost your PowerPoint presentations with Grafi: Free templates & graphics","iconUrl":"22521.e2bdd7cd-5d6d-423d-95c0-83ce8a96121d.09b88c42-1825-4a4b-9faf-4814d36b384d.473ee5f6-19a0-4be5-b6bf-a82ad70ad9ce.png","licenseUrl":"https://grafi.levidio.com/","privacyUrl":"https://grafi.levidio.com","addinInfo":{"priority":1,"AUP":71}},{"displayName":"AI Presenters from D-ID","solutionId":"wa200004566","version":"1.0.0.0","targetType":0,"width":200,"height":200,"description":"Add a talking head to every slide at the click of a button","iconUrl":"6295.59f0ef44-cf7c-4788-a003-23389dc1a647.ebaeaedd-394e-4ced-b282-bef1c906aa3a.d257a217-1cbc-4cdd-b3a3-84ff58b880f9.png","licenseUrl":"https://plugins.d-id.com/terms","privacyUrl":"https://plugins.d-id.com/privacy","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"Autopilot","solutionId":"wa200005669","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"The Ultimate Conversational AI with a ChatGPT Experience for Microsoft Office","iconUrl":"12203.36723807-bf6b-458b-85d4-c6c068296f33.807070a8-ca50-4721-a811-d6bb38b70be3.3aaef1c4-2963-4d9e-aab0-905e58073e52.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":3,"AUP":247}},{"displayName":"R2 Copilot: Private ChatGPT","solutionId":"wa200006000","version":"1.0.7.0","targetType":1,"width":0,"height":0,"description":"R2 Copilot is a privacy-centric, GPT-powered AI assistant for your everyday business communications.","iconUrl":"56225.76f6d8e7-715b-441b-8a4d-2139865ec45a.7610f06b-2158-4106-a7c2-fdce566d231b.edb31b7f-4abe-4ef4-a041-2873ff07d0c0.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://r2copilot.ai/policy","addinInfo":{"priority":1,"AUP":857}},{"displayName":"Lucidspark Boards for PowerPoint","solutionId":"wa200005801","version":"1.4.0","targetType":0,"width":970,"height":700,"description":"Bring ideas to life by adding Lucidspark brainstorming, planning or designs to Microsoft PowerPoint.","iconUrl":"38402.5e65280e-0024-4497-84e1-1e678778805a.66f5bf0a-7d4d-4dad-9693-13d0d4931e54.1b15e774-2b62-420c-9ced-e2cc73be7722.png","licenseUrl":"https://lucid.co/tos","privacyUrl":"https://lucid.co/privacy","addinInfo":{"priority":3,"AUP":110}},{"displayName":"BioRender for PowerPoint","solutionId":"wa200006038","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"Add BioRender figures to PowerPoint presentations & keep them updated in a click.","iconUrl":"45344.e489386f-60a2-494b-af7d-8d7507d4d17f.b1b4ad12-fefd-434e-9f8b-ac4d56a2a520.2d1b9760-294f-458b-ae03-871da4d360c3.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.biorender.com/privacy","addinInfo":{"priority":3,"AUP":45}},{"displayName":"Linguisity for Microsoft Office","solutionId":"wa200006005","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"The power of Linguisity for Microsoft Office","iconUrl":"16095.61234a59-81d3-44a9-9a2b-4413b4035013.40ed8cfa-a34e-4b76-8911-375be710f830.f832b65c-9a31-4efc-a3ac-9c946b40e41a.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://linguisity.com/privacy","addinInfo":{"priority":3,"AUP":6}},{"displayName":"Adobe Stock","solutionId":"wa104380902","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Access millions of high-quality images \u2014 all from the world\u2019s largest creative community.","iconUrl":"10824.d66ff806-ab47-402d-acca-8a7385271085.4cd20b77-c047-48a3-8a22-7688de8dc0d1.a54b5c27-baf8-4943-8c4f-8cdc844e5cdd.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.adobe.com/privacy.html","addinInfo":{"priority":2,"AUP":283}},{"displayName":"Visual Paradigm Online for Office","solutionId":"wa104381637","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Draw and insert flowcharts, UML, mind maps, BPMN, Venn, ERD, ArchiMate and more in Office documents.","iconUrl":"37179.b19e18e4-8129-4f14-9c5f-94ff9f478a8e.7039006e-f2b2-4482-98db-255ae2f58628.bd478170-6d94-42f7-b043-44f31827a0d2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://online.visual-paradigm.com/privacy.jsp","addinInfo":{"priority":2,"AUP":133}},{"displayName":"FMath Editor","solutionId":"wa104380848","version":"2.1.0.1","targetType":1,"width":0,"height":0,"description":"Allow users to insert equations into documents.","iconUrl":"21513.6a3c2fa6-ade2-4929-a881-1dd4c188f978.63d347ef-61d0-4ddb-a5af-5102243732ae.0ad9963c-9d43-4f1d-b599-319229de2eda.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://math-on-web.com/privacy_policy.html","addinInfo":{"priority":2,"AUP":144}},{"displayName":"PPT-Design Infographics Templates","solutionId":"wa200003052","version":"2.0.0","targetType":1,"width":0,"height":0,"description":"- Fully editable slides templates & infographics - Color palettes - QR Code generator - More...","iconUrl":"59758.408b9525-4c22-468b-a62c-aff57698e657.5d98aa4c-dc98-40d0-8c69-d5b0845733ce.1d6c144f-e771-4ae8-9dbf-fb6c3529f8a6.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ppt-design.com/privacypolicy","addinInfo":{"priority":2,"AUP":124}},{"displayName":"AI Perfect Assistant for Office","solutionId":"wa200006067","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Get organized and improve your productivity with cutting-edge AI","iconUrl":"34141.79788226-d6e6-4d20-87f3-a836aa48ba76.1d1eab50-c3d2-4eb7-a418-4ed9dc4ee23e.094dea61-f4f8-4064-a823-fde1b958588e.png","licenseUrl":"https://ai.ipirozhenko.com/terms","privacyUrl":"https://ai.ipirozhenko.com/privacy","addinInfo":{"priority":1,"AUP":144}}]'}static get jwn(){return'[{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"wa104178141","version":"4.3.3.0","targetType":1,"width":0,"height":0,"description":"Unlimited access to licensed photos, clipart and your company\'s images in PowerPoint.","iconUrl":"52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickit.com/en/privacy-policy","addinInfo":{"priority":1,"AUP":1885}},{"displayName":"Pear Deck Add-in","solutionId":"wa200000094","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Add formative assessments and interactive activities to lessons and presentations","iconUrl":"59452.62af3df0-63ba-40f1-83d3-a0bc16189b66.26661aad-7dc8-4f47-a9d9-3aa9c939d106.e9f66df9-6115-41f5-8721-fab23ac9b3a8.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.peardeck.com/privacy-policy","addinInfo":{"priority":3,"AUP":9847}}]'}get kwn(){return u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinDetailsForTestEnabled",
!1)}get Rvd(){return"Dev Box"===u.AFrameworkApplication.ga.La("StatusBarEnvironmentNameToUse")}Wzk(ma,Sa=null){if(this.nq.getOsfControl(ma)&&Sa){if(Sa.JB){const Zb=Object(ta.a)(902,this.VBe(ma));Zb&&(Zb.o9a=Sa.JB)}this.VWk(ma)}}}Nh.Kbb=null;Nh.kBb=null;Object(c.a)(Nh,"AppForOfficeManager",null,[903,24,245]);class Fk{constructor(ma,Sa,Zb){this.Jya=ma;this.UIl=Sa;this.Pb=Zb}register(){this.UIl.Am(Object(r.a)(this,this.wgl,"appSettingChangedEventHandler"))}dispose(){this.UIl.Pq(Object(r.a)(this,this.wgl,
"appSettingChangedEventHandler"))}wgl(ma,Sa){ma=Sa.node;Sa=Sa.property;try{if(1074135139===ma.Me&&Sa===Ac.a.iKb){Sa=null;var Zb=this.Pb.Hc(ma);Zb.pc(47)||Zb.pc(10);Zb.wc();this.chj(Zb.currentNode)&&(Sa=new X.a(Zb.currentNode));var Wc=Sa.settings;cd.a("RefreshAppSettingsValue")&&(this.Jya.mGd(Sa.id).settings=Wc);this.Jya.idd(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),Sa.id,Wc)}}catch(rd){f.ULS.sendTraceTag(507843922,802,10,"Failed to execute AppSettingChangedEventHanlder: {0}.",rd)}}chj(ma){if(!ma)return!1;
const Sa=Object(ta.a)(426,ma);return 1074135137===ma.Me||!!Sa&&Sa.ht}}Object(c.a)(Fk,"AppForOfficeSettingChangedEventListener",null,[900,24]);class bk{constructor(ma,Sa,Zb){this.Jya=ma;this.EGl=Sa;this.Pb=Zb}register(){for(const ma of this.EGl)ma.fG(Object(r.a)(this,this.xgl,"appSettingCreatedEventHandler"))}dispose(){for(const ma of this.EGl)ma.PO(Object(r.a)(this,this.xgl,"appSettingCreatedEventHandler"))}xgl(ma,Sa){ma=Sa.node;try{if(this.chj(ma)&&21===Sa.MZ){this.Pb.Hc(ma).Txc()||f.ULS.sendTraceTag(507843921,
802,15,"Got OnChildTopologyChanged event but no child found.");const Zb=new X.a(ma),Wc=Zb.settings;this.Jya.idd(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),Zb.id,Wc)}}catch(Zb){f.ULS.sendTraceTag(507843920,802,10,"Failed to execute AppSettingCreatedEventHandler: {0}.",Zb)}}chj(ma){if(!ma)return!1;const Sa=Object(ta.a)(426,ma);return 1074135137===ma.Me||!!Sa&&Sa.ht}}Object(c.a)(bk,"AppForOfficeSettingCreatedEventListener",null,[900,24]);class Uh{constructor(ma,Sa){this.ia=ma;this.Iz=
Sa}register(){this.Iz.Am(Object(r.a)(this,this.b7l,"taskpaneAppCreatedEventHandler"))}dispose(){this.Iz.Pq(Object(r.a)(this,this.b7l,"taskpaneAppCreatedEventHandler"))}b7l(ma,Sa){if(ma=Sa.node)ma=new X.a(ma),Sa.property.id===za.a.I4.id&&1===ma.KN&&(Sa=Sa.node.oa(za.a.I4,null))&&this.ia.Qa(Ua.a.uUa,2,Sa)}}Object(c.a)(Uh,"AppForOfficeTaskpaneAppCreatedEventListener",null,[900,24]);var Ge=a(1028),Hf=a(794),Bg=a(1189),qk=a(1190);class Oj{constructor(ma,Sa,Zb,Wc,rd,ee){this.Jya=ma;this.EE=Sa;this.Db=Zb;
this.Rca=Wc;this.d1=rd;this.la=ee}register(ma){ma.controlStatusChanged=Object(r.a)(this,this.BPl,"onControlStatusChanged");ma.notifyHost=Object(r.a)(this,this.NQl,"onOsfNotifyHost")}BPl(ma){var Sa;let Zb=this.Rca.RDi(ma.getSolutionId()),Wc=!1;cd.a("FixUILessShowTaskPaneIconIssue")&&(Wc=null!=ma.getSharedRuntimeId(),!Zb&&Wc&&(Zb=this.Rca.RDi(ma.getSolutionId()+"##UILessContainer##")));const rd=this.Rca.$Ja(ma.getID());rd&&rd.Mx&&ma.isFirstParty()&&(Zb=this.Rca.RDi(rd.Mx.id));if(Zb&&rd&&Zb.previousSibling){var ee=
ma.getSolutionId(),De=ma.getVersion(),Af=null,mg=null;mg=ma.isFirstParty()?OSF.OsfManifestManager.getCachedManifest(ee,""):OSF.OsfManifestManager.getCachedManifest(ee,De);ma.isFirstParty()&&rd.o9a?Af=rd.o9a:mg&&(Af=mg.getDefaultDisplayName(),rd.o9a=Af);if(0!==rd.KN&&-1!==rd.KN){De=null;mg&&(De=mg.getDefaultIconUrl());mg=Object.assign(new Bg.a,{getContent:()=>Zb,type:"LegacyTaskPaneProps",isSharedRuntimePane:Wc});var dg=Object.assign(new Ge.a,{title:Af,hideHeader:!0,iconUrl:De,width:320,location:2,
contentProps:mg,onOpen:()=>{},onClose:()=>{},isModernPane:!0});(null===rd||void 0===rd?0:rd.settings)&&qk.a.Bkh(rd.settings)&&(dg.hideHeader=!1,dg.contentProps=qk.a.Eul(rd.Kp,rd.settings,mg));"fa000000129"===(null===(Sa=null===rd||void 0===rd?void 0:rd.Mx)||void 0===Sa?void 0:Sa.id.toLowerCase())&&this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotTaskPaneMaxWidth",!1)&&(dg.enableResize=!0,dg.overrideMaxPaneWidthDonotuse=!0);ub.a.Py().then(Zg=>{const Gh=ma.getID();Zg.updateTaskPane(Gh,
dg);cd.a("FixUILessShowTaskPaneIconIssue")&&Wc&&this.Jya.TWc(ma.getID(),!1);return null}).catch(()=>{T.a.J(512360770,220,10,"taskPaneAPI.UpdateTaskpane() fails for {0}",ee)});Zb.previousSibling&&(Zb.previousSibling.innerText===Af||!ma.isFirstParty()&&""!==Zb.previousSibling.innerText)||!Af||!rd.taskpane||rd.taskpane.isForUILessAction||(Zb.previousSibling.innerText=Af,this.Db.gkb())}}}v8m(ma,Sa,Zb){this.NQl(ma,Sa,Zb)}get obh(){return cd.a("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}Fsm(ma,
Sa){return yf.a.Wn().equals(ma.solutionId,Sa.solutionId)&&yf.a.Wn().equals(ma.storeType,Sa.storeType)}NQl(ma,Sa,Zb){3===Sa?(this.Jya.hzl(),this.d1.gh(fd.a.L8),Zb?(this.Occ("InsertAgave",Zb),this.EE.eS().Qa(Ua.a.c9c,2,Zb)):f.ULS.sendTraceTag(512360769,806,10,"InsertAgave: should have valid insert agave parameters")):41===Sa?this.Occ("ClickTrust",Zb):40===Sa?this.obh&&this.NIj&&Zb&&this.Fsm(this.NIj,Zb)&&Zb.storeType&&(f.ULS.sendTraceTag(509669715,220,50,"AgaveHostAction.OsfControlLoad: the loadedAgaveParams' PrivacyCompliantId: {0}",
Oj.Jsa(Zb)),this.NIj=void 0,this.Jya.tka(Pa(Zb.storeType))):36===Sa?Zb?this.EE.eS().Qa(Ua.a.c9c,2,Zb):f.ULS.sendTraceTag(512360768,806,10,"InsertDevManifest: should have valid insert agave parameters"):37===Sa?Zb&&(ma=Object(ta.a)(Object,Zb),ma={["ak1"]:this.Jya.nq.getDevManifestInvalidUrlErrorString(ma.manifestUrl)},this.EE.eS().Qa(eb.a.jNe,2,ma)):2===Sa?this.Jya.hzl():9===Sa?this.EE.Md.m0a&&this.EE.Md.ekh&&this.EE.eS().Qa(eb.a.Uth,2,Zb):5===Sa||6===Sa?(Zb=this.Rca.$Ja(ma))?0===Zb.KN?this.d1.YSk(Sa):
this.d1.QJm(ma,Sa):f.ULS.sendTraceTag(512360738,806,10,String.format("Failed to find the cached app with instance Id: {0}",ma)):13===Sa||14===Sa?(Zb=this.Rca.$Ja(ma))?0===Zb.KN||Zb.taskpane&&Zb.taskpane.isForUILessAction?this.Jya.notifyAgave(ma,13===Sa?11:12):(be.a.zg&&document.activeElement.blur(),13===Sa?Ec.FocusManager.instance().PRg(fd.a.s_):this.d1.wsl(ma)):f.ULS.sendTraceTag(512360737,806,10,String.format("Failed to find the cached app with instance Id: {0}",ma)):16===Sa?(Sa=this.Rca.$Ja(ma))?
0===Sa.KN&&this.d1.Lql():f.ULS.sendTraceTag(512360736,806,10,String.format("Failed to find the cached app with instance Id: {0}",ma)):17===Sa||18===Sa?(Sa=this.Rca.$Ja(ma))?0===Sa.KN?this.d1.Lql():(be.a.zg&&document.activeElement.blur(),this.d1.wsl(ma)):f.ULS.sendTraceTag(512360735,806,10,String.format("Failed to find the cached app with instance Id: {0}",ma)):1===Sa||10===Sa?(Sa=this.Rca.$Ja(ma))?0===Sa.KN&&this.Jya.$Ok(ma):f.ULS.sendTraceTag(512360734,806,10,String.format("Failed to find the cached app with instance Id: {0}",
ma)):8===Sa?(ma={["ak1"]:this.Jya.nq.getManifestInvaildErrorString()},this.EE.eS().Qa(eb.a.jNe,2,ma)):15===Sa?(ma=this.d1.SVn(ma))&&(Sa=this.Jya.mGd(ma))&&Sa.taskpane&&!Sa.taskpane.isForUILessAction&&this.Jya.notifyAgave(ma,11):23===Sa?U.a.sendOtelEvent(Object.assign(new Hf.a,{otelEvent:Zb})):38===Sa?U.a.sendOtelCustomerContent(Object.assign(new Hf.a,{otelEvent:Zb})):32===Sa?(ma=Object(ta.a)(Object,Zb).solutionId,this.Jya.mkl(ma)):34===Sa&&(ma=Object(ta.a)(Object,Zb),Sa=ma.controlId,Zb=new Va("",
ma.ownerAddinSolutionId,new Qd,!0),ma.originalControlId=Zb?Zb.knl(Sa):Sa)}Occ(ma,Sa){this.obh&&Sa&&(this.NIj=Sa)}static Jsa(ma){return Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.solutionId,ma.storeType,ma.assetId,null,null,ma.storeId)}}Object(c.a)(Oj,"AppForOfficeAppEventHandler",null,[921]);var Hk=a(432),Hi=a(1592);class nh{static Xom(ma){var Sa=ma.getAttribute("style");Sa=Sa?Sa.toString():"";0>Sa.indexOf("pointer-events: auto")&&ma.className!==nh.mMe&&(cd.a("Microsoft.Office.SharedOnline.FixBug6808089")?
ma.style.pointerEvents="auto":ma.setAttribute("style",Sa+" pointer-events: auto"))}static Ydl(ma){var Sa=ma.getAttribute("style");Sa=Sa?Sa.toString():"";0>Sa.indexOf("pointer-events: none")&&ma.className===nh.mMe&&(cd.a("Microsoft.Office.SharedOnline.FixBug6808089")?ma.style.pointerEvents="none":ma.setAttribute("style",Sa+" pointer-events: none"))}static IFn(ma){var Sa=ma.getAttribute("style");Sa=Sa?Sa.toString():"";0<=Sa.indexOf("pointer-events: none")&&ma.className===nh.mMe&&(cd.a("Microsoft.Office.SharedOnline.FixBug6808089")?
ma.style.pointerEvents="":(Sa=Sa.replace("pointer-events: none",""),ma.setAttribute("style",Sa)))}}nh.JIn="AppForOfficeContainer EditAppForOfficeContainer";nh.mMe="AppForOfficeContainer EditAppForOfficeHidden EditAppForOfficeContainer";nh.luk="";Object(c.a)(nh,"AppForOfficeViewHelper",null,[]);var Pf=a(889),Q=a(336);class xa{constructor(ma,Sa,Zb,Wc,rd){this.O5=this.oGl=null;this.XTa=!1;this.c1=Sa;this.eo=Zb;Sa&&Sa.taskpane&&Sa.taskpane.isForUILessAction?(this.O5=null,this.oGl=Zb):(this.O5=new Q.a,
this.O5.We.className=nh.mMe,this.O5.We.id="AppForOffice_"+this.c1.Kp,this.O5.We.style.width="100%",this.O5.We.style.height="100%",this.O5.We.style.position="relative",this.O5.We.style.left="0",this.O5.We.style.top="0",Zb.appendChild(this.O5.We));this.Hd=rd}dispose(){this.oFn();this.c1=null}oFn(){this.O5&&this.O5.fr()}Pyk(ma){ma&&this.O5&&ma!==this.eo&&(this.eo=ma,ma.appendChild(this.O5.We),this.XTa&&this.Osa())}LDa(ma){ma&&(ma.We.innerHTML="")}oPn(ma,Sa,Zb=null,Wc=null,rd=!1){this.Enm(ma,Sa,Zb,Wc,
rd)}qah(ma,Sa,Zb){Sa=this.eFg(Sa);ma.insertBlankControlWithErrorUX(Sa,()=>{Zb()})}Enm(ma,Sa,Zb=null,Wc=null,rd=!1){this.XTa=rd;this.LDa(this.O5);this.c1&&ma&&(this.mec(Sa,null),Sa=this.eFg(this.O5?this.O5.We:this.oGl,Wc,ma),Sa.virtualOsfControlActivationCallback=Zb,ma.insertOsfControl(Sa),ma.setActivationCompletedStatus(this.c1.Kp,!0),rd&&this.Osa())}Osa(){if(this.O5){var ma=this.O5.ta;if(ma){var Sa=ma.parentNode;Sa&&"OsfAddinOverlay"!==Sa.className&&(Hk.a.instance.Zb(Eb.a.d2,Sa,Object(r.a)(this,
this.vYl,"removePointerEventsStyleHandler")),Hi.a.instance.Zb(Eb.a.drop,Sa,Object(r.a)(this,this.vYl,"removePointerEventsStyleHandler")),Hk.a.instance.Zb(Eb.a.e2,Sa,Object(r.a)(this,this.Yom,"addPointerEventsStyleHandler")),nh.Ydl(ma))}}}vYl(ma){ma=ma.Sb.target;for(let Sa=0;Sa<ma.childNodes.length;++Sa)nh.IFn(ma.childNodes[Sa]);return!0}Yom(ma){ma=ma.Sb.target;for(let Sa=0;Sa<ma.childNodes.length;++Sa)nh.Ydl(ma.childNodes[Sa]);return!0}mec(ma,Sa){this.O5&&(ma?(null!=Sa&&this.Pyk(Sa),this.O5.We.className=
""===nh.luk?nh.JIn:nh.luk,nh.Xom(this.O5.ta)):(this.O5.We.className!==nh.mMe&&(nh.luk=this.O5.We.className),this.O5.We.className=nh.mMe))}Vvh(ma){this.O5&&(this.O5.We.style.zIndex=String(ma))}eFg(ma,Sa=null,Zb=null){const Wc={};Wc.div=ma;Wc.id=this.c1.Kp;ma=this.c1.Mx.id;const rd=this.c1.taskpane?this.c1.taskpane.ownerAddinSolutionId:null;if(Zb&&rd){const ee=this.c1.taskpane.isForUILessAction;this.c1.oJ?Wc.sharedRuntimeId=this.c1.oJ.Jbb:(Zb=Zb.getOsfControl(rd).getManifest(),Wc.sharedRuntimeId=this.Hd.getSharedRuntimeId(Zb,
ee,ma,rd));Wc.initialDisplayMode=ee?1:2}Wc.hostInfoFlags=0;Wc.sharedRuntimeId?(Wc.hostInfoFlags|=1,Wc.solutionId=rd):Sa?(Wc.solutionId=Sa.assetId,Wc.sourceLocationOverrideResourceId=Sa.sourceLocationOverrideResourceId,Wc.featureGates=u.AFrameworkApplication.ga.gPm(Sa.assetId)):Wc.solutionId=ma;Wc.version=this.c1.Mx.version;Wc.storeId=this.c1.Mx.store;Wc.storeType=this.c1.Mx.storeType;Wc.assetId=this.c1.Mx.assetId;Wc.assetStoreId=this.c1.Mx.assetStoreId;Wc.settings=this.c1.settings;Sa&&OSF.OsfControl.isFirstPartyStoreString(this.c1.Mx.storeType)&&
(Wc.hostSettings=OSF.OUtil.serializeSettings(Sa.nonPersistedSettings),Wc.showLoadingSpinner=Sa.showLoadingSpinner);Wc.reason=Pf.a.contains(this.c1.Mx.id,this.c1.KN,this.c1.Mx.store,this.c1.Mx.storeType,this.c1.Mx.version)?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;0===this.c1.KN?Wc.osfControlType=0:1===this.c1.KN&&(Wc.osfControlType=1);u.AFrameworkApplication.uSa||OSF.OsfControl.isFirstPartyStoreString(Wc.storeType)||
(f.ULS.sendTraceTag(512369924,802,50,(0===this.c1.KN?"Content":"Taskpane")+" web add-in disabled by doc IRM"),Wc.hostInfoFlags|=4);this.c1.taskpane?(Wc.isForUILessAction=this.c1.taskpane.isForUILessAction,Wc.ownerAddinSolutionId=rd,Wc.ownerAddinStoreType=this.c1.taskpane.ownerAddinStoreType):Wc.isForUILessAction=!1;return Wc}}Object(c.a)(xa,"AppForOfficeView",null,[901]);var ob=a(442),Qb=a(135),mc=a(691);class yc{constructor(ma,Sa,Zb,Wc,rd,ee,De,Af,mg,dg,Zg,Gh,wh,Ji,bi){new ob.a(0,0,0,0);this.s_f=
this.t_f=this.nXd=this.Iya=this.xv=null;this.EQj=ResourceStrings.l_AddinPane;this.Rb=Ae.a.hg();this.Db=ee;this.ef=Af;this.d1=De;this.rf=mg;this.lA=ma;this.w3=Sa;this.EE=Zb;this.Nan=Wc;this.mc=rd;this.jA=dg;this.Hd=Zg;this.od=Gh;this.fc=wh;this.EU=Ji;this.yH=bi;this.initialize()}dispose(){this.ef&&this.xv&&(this.ef.jc(Eb.a.click,this.xv,Object(r.a)(this,this.Czb,"closePaneButtonClickHandler")),this.jA.removeHandler(this.xv,Eb.a.Lj,Object(r.a)(this,this.Iyl,"handleShortCutsOnCloseButton")),this.xv=
null);this.od.U4b(Object(r.a)(this,this.eE,"onUnifiedAppStateChanged"));this.Db.UCb(Object(r.a)(this,this.d_,"onSetOffline"));this.d1.Cnk(this)}initialize(){var ma;const Sa="label_"+this.w3,Zb="icon_"+this.w3;this.Rb.className=this.lA?"AddinPane AddinPaneRTL":"AddinPane AddinPaneLTR";if(Object(cd.a)("AddClassOnSDXPaneContainer")&&this.yH){const Wc=this.yH.fPk;Wc&&(this.Rb.className+=" "+Wc)}this.Rb.style.position="absolute";this.Rb.style.display="none";this.Rb.setAttribute(ld.a.pi,ld.a.qzb);this.Rb.setAttribute(ld.a.rma,
Sa);this.xv=this.Nqc("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.xv,"AddinPaneCloseButton");this.ef.Zb(Eb.a.click,this.xv,Object(r.a)(this,this.Czb,"closePaneButtonClickHandler"));this.jA.addHandler(this.xv,Eb.a.Lj,Object(r.a)(this,this.Iyl,"handleShortCutsOnCloseButton"));this.Rb.appendChild(this.xv);Object(cd.a)("AddInPaneHeaderEnhancement")?this.ZLn():Object(cd.a)("TempHeaderIconForActionAI")&&this.yH&&"ActionAITaskPane"===this.yH.fPk&&(this.t_f=Ae.a.uJ(),this.t_f.className=
"PaneIcon",this.t_f.id=Zb,this.t_f.src="https://fa000000121.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.1.2303.9002/en-us_web/assets/M365Orange.svg",this.Rb.appendChild(this.t_f));this.nXd=Ae.a.hg();this.nXd.className="PaneLabel";this.nXd.id=Sa;this.nXd.setAttribute(ld.a.pi,ld.a.Obh);this.nXd.setAttribute(ld.a.r$b,"1");this.Rb.appendChild(this.nXd);this.Iya=Ae.a.hg();this.Iya.className="AddinPanePanelResize";this.Rb.appendChild(this.Iya);this.od.fsa(Object(r.a)(this,this.eE,"onUnifiedAppStateChanged"));
this.Db.pSa(Object(r.a)(this,this.d_,"onSetOffline"));T.a.J(508425998,802,50,`AddInPane::initialize ${this.w3} for ${null===(ma=this.yH)||void 0===ma?void 0:ma.assetId}`)}ZLn(){var ma,Sa,Zb;const Wc="icon_"+this.w3;ea.c()?(null===(Sa=this.yH)||void 0===Sa?0:Sa.gPk)?(this.s_f=Ae.a.hg(),this.s_f.className="PaneIcon",this.s_f.id=Wc,null===appChrome||void 0===appChrome?void 0:appChrome.api.renderIcon(this.yH.gPk,this.s_f),this.Rb.appendChild(this.s_f)):T.a.J(509120517,811,50,"No Header Icon for current pane:{0}",
null===(Zb=this.yH)||void 0===Zb?void 0:Zb.JB):T.a.J(508966294,811,10,"appChrome not loaded yet for pane:{0}",null===(ma=this.yH)||void 0===ma?void 0:ma.JB)}eE(ma,Sa){Sa.nlb&&!this.fc.Mp&&this.isVisible&&this.dzl()}d_(ma){ma&&this.isVisible&&(Object(cd.a)("FixAddInPaneVisibilityInOfflineMode")&&this.Hd.B6c(this.w3),this.dzl())}dzl(){this.wA(!1);this.EE.eS().Qa(Ua.a.T8c,2,this.w3);this.Yrj()||this.dispose()}layout(ma,Sa){const Zb=Sa?ma.eP(this.width):ma.fP(this.width);this.isVisible&&(Sa?Zb.eP(1):
Zb.fP(1),this.Iya.style.height=(ma.height-this.xv.clientHeight-this.nXd.clientHeight).toString()+"px",this.Iya.style.width="100%");Ae.a.nda(this.Rb,Zb,!1);return ma}qNn(ma){this.EQj=ma}wA(ma){const Sa=this.mc!==ma;if(this.mc=ma)this.Rb.style.display="block";const Zb=this.Yrj();this.EU.y2l(this.w3,Zb);let Wc=this.EQj;Object(cd.a)("TaskPaneToolTip")?this.yH&&this.yH.YYg?Wc=this.yH.YYg:this.yH&&(Wc=this.yH.JB):Wc=this.yH?this.yH.JB:this.EQj;this.EU.l7(this,this.mc,Wc,this.w3);Zb&&(this.xv.style.visibility=
ma?"visible":"hidden",Sa&&this.Hd.xJm(this.w3,ma))}Yrj(){return this.Hd.SAb(this.w3)}Czb(){this.wA(!1);this.EE.eS().Qa(Ua.a.T8c,2,this.w3);this.Yrj()||this.dispose();return!0}J$b(ma,Sa,Zb,Wc,rd,ee,De){const Af=Ae.a.uJ();Af.alt=rd;Af.className=Qb.e(ma,Wc);Af.src=this.rf.Yp(ma+".png");Af.setAttribute("Unselectable","on");ma=Ae.a.yx();ma.className=Sa+" cui-img-cont-float";ma.appendChild(Af);Sa=Ae.a.yx();Sa.className=Zb;Sa.setAttribute("Unselectable","on");Sa.appendChild(ma);Zb=Ae.a.JYa();Zb.className=
"CommentPaneNoBorderButton cui-ctl";rd&&(Zb.title=rd);Zb.setAttribute(ld.a.pi,ld.a.BL);De&&Zb.setAttribute(ld.a.yz,De);Zb.tabIndex=0;Zb.appendChild(Sa);ee&&(rd=Ae.a.yx(),rd.className="cui-ctl-mediumlabel",rd.setAttribute("Unselectable","on"),rd.innerText=ee,Zb.appendChild(rd));return Zb}Nqc(ma,Sa){return Object(cd.a)("UseSVGAddInCloseButton")?(ma=document.createElement(Ae.a.poc),ma.type="button",ma.setAttribute(ld.a.yz,CommonUIStrings.l_DialogClose),ma.appendChild(Object(mc.b)(mc.a,20,20).ta),ma.className=
"AddinPaneSvgCloseButton",Sa=Ae.a.JYa(),Sa.setAttribute(ld.a.pi,ld.a.BL),Sa.setAttribute(ld.a.yz,CommonUIStrings.l_DialogClose),Sa.appendChild(ma),Sa):Object(cd.a)("RemoveTitleForAddInPaneCloseButton")?this.J$b(ma,"cui-img-16by16","cui-ctl-iconContainer",Sa,void 0,null,CommonUIStrings.l_DialogClose):this.J$b(ma,"cui-img-16by16","cui-ctl-iconContainer",Sa,CommonUIStrings.l_DialogClose,null,void 0)}Iyl(ma){ma.keyCode===Ya.a.hv||ma.keyCode===Ya.a.C7?(this.Czb(null),ma.preventDefault(),ma.stopPropagation()):
ma.keyCode===Ya.a.vu&&(ma.shiftKey?this.Hd.notifyAgave(this.w3,12):this.Hd.notifyAgave(this.w3,11),ma.preventDefault(),ma.stopPropagation())}get isVisible(){return this.mc}get ta(){return this.Rb}get order(){return 6}get width(){return this.isVisible?this.Nan:0}get wbh(){return this.Iya}get iym(){return this.xv}get id(){return this.w3}}Object(c.a)(yc,"AddInPane",null,[920,495,24]);class Sc{constructor(ma,Sa,Zb,Wc,rd,ee,De,Af,mg,dg,Zg){this.EE=ma;this.Db=Sa;this.d1=Zb;this.ef=Wc;this.rf=rd;this.L1d=
ee;this.Hd=De;this.od=Af;this.fc=mg;this.EU=dg;this.la=Zg}Kdh(ma,Sa,Zb,Wc,rd){return new yc(ma,Sa,this.EE,Zb,Wc,this.Db,this.d1,this.ef,this.rf,this.L1d,this.Hd,this.od,this.fc,this.EU,rd)}FIa(ma){return new X.a(ma)}jAm(ma){return new Oj(this.Hd,this.EE,this.Db,ma,this.d1,this.la)}xmi(ma,Sa,Zb,Wc,rd){return new xa(ma,Sa,Zb,Wc,rd)}}Object(c.a)(Sc,"AppforOfficeClassFactory",null,[899]);class wd{get formatting(){return 0}set formatting(ma){}get sourceSlideIds(){return null}set sourceSlideIds(ma){}get targetSlideId(){return null}set targetSlideId(ma){}getTypeName(){return"Microsoft.Office.PowerPoint.InsertSlideOptions"}invokePropertyGet(ma){switch(ma){case 1:return this.formatting;
case 4:return this.sourceSlideIds;case 5:return this.targetSlideId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma,Sa){switch(ma){case 1:this.formatting=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"int");return;case 4:this.sourceSlideIds=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"Array<string>");
return;case 5:this.targetSlideId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}}
Object(c.a)(wd,"InsertSlideOptions",null,[]);class zd{constructor(){this.$bl=this.h9k=null}get layoutId(){return this.h9k}set layoutId(ma){this.h9k=ma}get slideMasterId(){return this.$bl}set slideMasterId(ma){this.$bl=ma}getTypeName(){return"Microsoft.Office.PowerPoint.AddSlideOptions"}invokePropertyGet(ma){switch(ma){case 1:return this.layoutId;case 2:return this.slideMasterId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma,Sa){switch(ma){case 1:this.layoutId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 2:this.slideMasterId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}}Object(c.a)(zd,"AddSlideOptions",null,[]);class Pd{constructor(ma){this.uIl=this.AP=!1;this.$j=Ai.a.AA();this.CGl=ma;Tf.vDn(this.CGl)}qW(){this.uIl=!0}dispose(){if(this.uIl&&!this.AP){var ma=Ai.a.AA();Tf.uDn(this.CGl,this.$j,ma);this.AP=!0}}}Object(c.a)(Pd,"ApiCallLogger",null,[24]);class Je{constructor(ma,Sa,Zb){this.u_f=ma;this.Boa=Sa;this.Hd=Zb}getAppRuntimeStartState(){if(!this.Hd.SAb(this.Boa))throw Error.invalidOperation("GetAppRuntimeStartState: Invalid controlId or it is not shared runtime.");
return this.Hd.zLm(this.u_f)?1:0}setAppRuntimeStartState(ma){if(!this.Hd.SAb(this.Boa)||0!==ma&&1!==ma)throw Error.invalidOperation("SetAppRuntimeStartState: Invalid controlId or state, or it is not shared runtime.");this.Hd.iWn(this.u_f,1===ma)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,Sa){switch(ma){case 2:return this.dMm();case 1:return this.ZKn(Sa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}dMm(){return this.getAppRuntimeStartState()}ZKn(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
0,"int");this.setAppRuntimeStartState(ma);return null}}Object(c.a)(Je,"AppRuntimePersistenceService",null,[]);class ge{constructor(ma,Sa){this.Boa=ma;this.Hd=Sa}getAppRuntimeState(){if(!this.Hd.SAb(this.Boa))throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or it is not shared runtime.");return this.Hd.yLm(this.Boa)?2:1}setAppRuntimeState(ma){if(!this.Hd.SAb(this.Boa)||2!==ma&&1!==ma)throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or state, or it is not shared runtime.");
this.Hd.TWc(this.Boa,2===ma)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,
Sa){switch(ma){case 2:return this.eMm();case 1:return this.$Kn(Sa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}eMm(){return this.getAppRuntimeState()}$Kn(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");this.setAppRuntimeState(ma);return null}}Object(c.a)(ge,"AppRuntimeService",null,[]);class tb{insertHyperLink(){}insertSlideFromContent(){return 0}getTypeName(){return"Microsoft.Office.PowerPoint.Application"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,Sa){switch(ma){case 1001:return this.G2m(Sa);case 1002:return this.N2m(Sa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}G2m(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,"string");this.insertHyperLink(Sa,ma);return null}N2m(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.insertSlideFromContent(ma)}}Object(c.a)(tb,"Application",null,[]);class Kc{get requestId(){return null}set requestId(ma){}get result(){return null}set result(ma){}getTypeName(){return"Microsoft.Office.PowerPoint.CopilotActionCompletedEventArgs"}invokePropertyGet(ma){switch(ma){case 1:return this.requestId;
case 2:return this.result}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return Promise.resolve(ma)}invokePropertySet(ma,Sa){switch(ma){case 1:this.requestId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 2:this.result=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,
Sa){this.invokePropertySet(ma,Sa);return Promise.resolve()}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return Promise.resolve(ma)}}Object(c.a)(Kc,"CopilotActionCompletedEventArgs",null,[]);class ad{constructor(ma,Sa){this.mI=!1;this._id=ma;this.APh=Sa}get enabled(){return this.mI}set enabled(ma){this.mI=ma;u.AFrameworkApplication.vb.Qa(eb.a.dvf,2,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.APh,
["SourceControlId"]:this.id,["MethodData"]:this.enabled})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(ma){switch(ma){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma,
Sa){switch(ma){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,Sa){switch(ma){case 5:return this.KLn(Sa);case 1:return this.Qka()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=
this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}KLn(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"boolean");this.setEnabled(ma);return null}Qka(){this._OnAccess();return null}}Object(c.a)(ad,"RibbonButton",null,[]);class id{constructor(){}get id(){return null}setVisibility(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(ma){switch(ma){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,Sa){switch(ma){case 3:return this.zNn(Sa);case 1:return this.Qka()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}zNn(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"boolean");this.setVisibility(ma);return null}Qka(){this._OnAccess();return null}}Object(c.a)(id,"RibbonTab",null,[]);class ud{constructor(ma,Sa){this.p2c=this.G7=this.Q9g=null;this.vua=ma;this.bhd=Sa;V.a.rb(this.vua)||(this.p2c=Sa.mGd(ma),this.Q9g=(this.G7=this.bhd?this.bhd.nq:null)?this.G7.getOsfControl(this.vua):
null)}get buttons(){return null}executeRequestCreate(){return null}executeRequestUpdate(){return null}getButton(ma){let Sa=null;if(!this.jCl())return this.cml();if(!V.a.rb(ma)&&this.p2c&&this.p2c.taskpane){if(!this.Djl(ma))return this.iml(ma);Sa=new ad(ma,this.p2c.taskpane.ownerAddinSolutionId)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Sa)}getTab(ma){let Sa=null;if(!this.jCl())return this.cml();if(!V.a.rb(ma)&&this.p2c&&this.p2c.taskpane){if(!this.Djl(ma))return this.iml(ma);
Sa=new id(ma)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Sa)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(ma){switch(ma){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){switch(ma){case 1:return this.Qka()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){switch(ma){case 7:return this.JHm(Sa);case 6:return this.KHm(Sa);case 3:return this.xMm(Sa);case 5:return this.aUm(Sa)}ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}JHm(ma){ma=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.executeRequestCreate(ma)}KHm(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.executeRequestUpdate(ma)}xMm(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getButton(ma)}aUm(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getTab(ma)}Qka(){this._OnAccess();return null}iml(ma){return this.rml("ControlIdNotFound",
ResourceStrings.L_RichApiErrorMessage_ControlIdNotFound+ma)}cml(){return this.rml("ApiNotAvailable",ResourceStrings.L_RichApiErrorMessage_ApiNotAvailable)}jCl(){const ma=!V.a.rb(this.Q9g.getSharedRuntimeId());T.a.J(512497821,802,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",ma));return ma}Djl(ma){if(this.Q9g){var Sa=this.Q9g.getManifest();if(Sa&&(Sa=Sa.getRibbonExtensionControlMap()))return ma in Sa||this.bxm(ma)}return!1}bxm(ma){var Sa=this.iJm();if(Sa){Sa=Sa.epl;
for(const Zb of Sa.tabs){if(Zb.id===ma)return!0;for(const Wc of Zb.groups)for(const rd of Wc.controls){if(rd.id===ma)return!0;if("Menu"===rd.type){Sa=rd;for(const ee of Sa.items)if(ee.id===ma)return!0}}}}return!1}iJm(){return C.getInstance().JEd(this.p2c.taskpane.ownerAddinStoreType,this.p2c.taskpane.ownerAddinSolutionId,1)}rml(ma,Sa){return OfficeExtension.WacRuntime.Utility.createPromise((Zb,Wc)=>{Wc(OfficeExtension.WacRuntime.Utility.createRichApiException(ma,Sa))})}}Object(c.a)(ud,"DynamicRibbon",
null,[]);class ke{constructor(ma,Sa,Zb,Wc){this.Q4k="";this.k8g=0;this.Cda=ma;this._id=Sa;this.u3e=Zb;this.bhd=Wc}get id(){return this._id}_RegisterStateChange(){this.k8g||this.Cda.execute(ma=>{OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.u3e,this._id,1);this.Q4k=ma.OCb(this._id,Sa=>{this.bhd.yJm(this.u3e,this._id,JSON.stringify(Sa))})});this.k8g++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.k8g--;this.k8g||this.Cda.execute(ma=>
{ma.M4b(this._id,this.Q4k)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(ma){switch(ma){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){switch(ma){case 6:return this.Pem();case 7:return this.$em()}ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}Pem(){return this._RegisterStateChange()}$em(){return this._UnregisterStateChange()}}Object(c.a)(ke,
"LicenseFeature",null,[]);class of{get scopes(){return null}set scopes(ma){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(ma){switch(ma){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma,Sa){switch(ma){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,
0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}}Object(c.a)(of,"MsaDeviceTicketOptions",null,[]);class Yf{constructor(ma,
Sa){this.Cda=ia.a.instance.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.u3e=ma;this.bhd=Sa}getFeatureTier(ma,Sa){return OfficeExtension.WacRuntime.Utility.createPromise(Zb=>{const Wc=1===Sa?1:2===Sa?2:0;this.Cda.execute(rd=>{rd.getFeatureTier(ma,Wc).then(ee=>{Zb(this.dQm(ee))},()=>{Zb(Sa)})})})}getLicenseFeature(ma){ma=new ke(this.Cda,ma,this.u3e,this.bhd);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}getMsaDeviceTicket(){return null}isFeatureEnabled(ma,
Sa){return OfficeExtension.WacRuntime.Utility.createPromise(Zb=>{this.Cda.execute(Wc=>{Wc.isFeatureEnabled(ma,Sa).then(rd=>{Zb(rd)},()=>{Zb(Sa)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(ma=>{this.Cda.execute(Sa=>{Sa=Sa.isFreemiumUpsellEnabled();ma(Sa)})})}launchUpsellExperience(ma){if(this.bhd.nq.getOsfControl(this.u3e).isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.Cda.execute(Sa=>{Sa.launchUpsellExperience(ma)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException("AccessDenied",
"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,
Sa){switch(ma){case 7:return this.IQm(Sa);case 6:return this.Tem(Sa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){switch(ma){case 2:return this.SOm(Sa);case 5:return this.cQm(Sa);case 1:return this.x4m(Sa);case 3:return this.F4m();case 4:return this.M8m(Sa)}ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}SOm(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,"int");return this.getFeatureTier(Sa,ma)}cQm(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getLicenseFeature(ma)}IQm(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string"),Zb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,2,of);return this.getMsaDeviceTicket(Sa,Zb,ma)}x4m(ma){const Sa=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,"boolean");return this.isFeatureEnabled(Sa,ma)}F4m(){return this.isFreemiumUpsellEnabled()}M8m(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.launchUpsellExperience(ma)}Tem(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");this._TestFireStateChangedEvent(ma);return null}dQm(ma){switch(ma){case 1:return 1;
case 2:return 2;default:return 0}}}Object(c.a)(Yf,"License",null,[]);class If{get height(){return 0}set height(ma){}get left(){return 0}set left(ma){}get top(){return 0}set top(ma){}get width(){return 0}set width(ma){}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeAddOptions"}invokePropertyGet(ma){switch(ma){case 1:return this.height;case 2:return this.left;case 3:return this.top;case 4:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=
this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma,Sa){switch(ma){case 1:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"number");return;case 2:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"number");return;case 3:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"number");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,
0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}}Object(c.a)(If,"ShapeAddOptions",null,[]);class Jf{constructor(){this.rx=
this.$8a=null}get requestId(){return this.$8a}set requestId(ma){this.$8a=ma}get result(){return this.rx}set result(ma){this.rx=ma}getTypeName(){return"Microsoft.Office.PowerPoint.ApplyJOfcCommandsCompletedEventArgs"}invokePropertyGet(ma){switch(ma){case 1:return this.requestId;case 2:return this.result}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma,
Sa){switch(ma){case 1:this.requestId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");break;case 2:this.result=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string")}}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}}
Object(c.a)(Jf,"ApplyJOfcCommandsCompletedEventArgs",null,[]);class Th{constructor(){this.Bbl=this.xbl=this.H5k=null}get designerOptions(){return this.H5k}set designerOptions(ma){this.H5k=ma}get scenarioOptions(){return this.xbl}set scenarioOptions(ma){this.xbl=ma}get selectionOptions(){return this.Bbl}set selectionOptions(ma){this.Bbl=ma}getTypeName(){return"Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions"}invokePropertyGet(ma){switch(ma){case 1:return this.designerOptions;case 2:return this.scenarioOptions;
case 3:return this.selectionOptions}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma,Sa){switch(ma){case 1:this.designerOptions=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 2:this.scenarioOptions=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 3:this.selectionOptions=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}}Object(c.a)(Th,
"ApplyJOfcCommandsOptions",null,[]);class yh{constructor(ma){if(!ma)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.ARj=ma}areShortcutsInUse(ma){return OfficeExtension.WacRuntime.Utility.createPromise((Sa,Zb)=>{this.ARj.checkShortcutsInUse(ma).then(Wc=>{Sa(Wc)}).catch(Wc=>{Zb(Wc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((ma,Sa)=>{this.ARj.getShortcuts().then(Zb=>{ma(Zb)}).catch(Zb=>{Sa(Zb)})})}replaceShortcuts(ma){return OfficeExtension.WacRuntime.Utility.createPromise((Sa,
Zb)=>{this.ARj.replaceShortcuts(ma).then(()=>{Sa(null)}).catch(Wc=>{Zb(Wc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,
Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){switch(ma){case 3:return this.Gsm(Sa);case 1:return this.nTm();case 2:return this.bHn(Sa)}ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}Gsm(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"Array<string>");return this.areShortcutsInUse(ma)}nTm(){return this.getShortcuts()}bHn(ma){ma=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"any");return this.replaceShortcuts(ma)}}Object(c.a)(yh,"ActionService",null,[]);class yi{constructor(){this.data=null}}Object(c.a)(yi,"AugLoopHostMessageReceivedEventArgs",null,[]);var Xi=a(1356);class Fh{constructor(ma,Sa=!1,Zb=null){this.vua=ma;this.Xdb=Sa;this.Q8a=Zb||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(ma){this.Xdb||Xi.a.K1l(ma)}_RegisterHostMessageReceivedEvent(){this.Xdb||(Fh.eYl||(Xi.a.SXl(ma=>{this.Q8a.fireEvent("",
65542,Object.assign(new yi,{data:ma}))}),Fh.eYl=!0),this.Q8a.register(this.vua,"",65542))}_UnregisterHostMessageReceivedEvent(){this.Xdb||this.Q8a.unregister(this.vua,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,Sa){switch(ma){case 1:return this.fKn(Sa);case 2:return this.Nem();case 3:return this.Yem()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}fKn(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
0,"string");this.sendMessage(ma);return null}Nem(){this._RegisterHostMessageReceivedEvent();return null}Yem(){this._UnregisterHostMessageReceivedEvent();return null}}Fh.eYl=!1;Object(c.a)(Fh,"AugLoopEventService",null,[]);var Gi=a(474),Bj=a(485);class ck{constructor(ma,Sa,Zb){this.t3c=this.Y6k=null;this.vua=ma;this.U$k=Sa;if(this.Ba=Zb)this.Y6k=this.Ba.La("GetAccessTokenOAuthFirstPartyAllowList")}TQm(){this.t3c||(this.t3c=Bj.a.aG(ia.a.instance.Na("Common.App.OAuth.IOAuthManager")));return this.t3c}I4m(ma,
Sa){if(!this.U$k||""===this.vua||!this.Ba)return!1;const Zb=this.U$k.getOsfControl(this.vua);if(!Zb)return!1;let Wc=!1;this.Y6k.split(";").forEach(rd=>{Sa===rd&&(Wc=!0)});return 1===u.AFrameworkApplication.Ea.Kb.Im&&Zb.isFirstParty()&&ma===ck.Jrm&&Wc&&Lb.d(Zb.getSolutionId())===ck.Lrm}getAccessTokenFirstPartyOAuth(ma,Sa){let Zb;Zb=this.I4m(ma,Sa)?Wc=>{const rd=this.TQm();rd.continueWith(()=>{rd.result.qN(ma,Sa).then(ee=>{Wc(ee);return ee})})}:Wc=>{Wc(Object.assign(new Gi.a,{IsSuccess:!1,Token:null,
ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(Zb)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,
Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){switch(ma){case 1:return this.oLm(Sa)}ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}oLm(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
1,"string");return this.getAccessTokenFirstPartyOAuth(Sa,ma)}}ck.Jrm="Maker";ck.Lrm="fa000000043";Object(c.a)(ck,"Auth",null,[]);var Ph=a(46);class qj{constructor(){this.T3c=null}kTm(){this.T3c||(this.T3c=Bj.a.aG(ia.a.instance.Na("Common.App.SharedFilePicker.ISharedFilePicker")));return this.T3c}getSharedFilePickerResponse(ma){return OfficeExtension.WacRuntime.Utility.createPromise((Sa,Zb)=>{try{const Wc=this.kTm();Ph.Task.WAA.call(null,Wc).continueWith(()=>{const rd=Wc.result;if(rd){let ee={};({BD:ee}=
P.d(ma)).returnValue?rd.CCf(ee).then(De=>{De&&0<De.length?Sa(De):Zb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(De=>{Zb(De)}):Zb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Zb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(Wc){Zb(Wc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){switch(ma){case 1:return this.jTm(Sa)}ma=
this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}jTm(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getSharedFilePickerResponse(ma)}}Object(c.a)(qj,"SharedFilePicker",null,[]);class Ik{Ill(ma){return'[data-unique-id="Ribbon-'+ma+'"]'}dTl(ma,Sa){Sa=JSON.parse(Sa);if("callout"===Sa.type)return Sa.params.target=this.Ill(Sa.params.target),ma.callout(Sa.params);Sa.props.target=this.Ill(Sa.props.target);return Sa.props}pun(ma){return JSON.parse(ma)}addNotification(ma,
Sa){if(!this.Xdb)return ub.a.fS().then(Zb=>Zb.addNotification(this.dTl(Zb,ma),this.pun(Sa)))}removeNotification(ma){if(!this.Xdb)return ub.a.fS().then(Sa=>Sa.removeNotification(ma))}updateNotification(ma,Sa){if(!this.Xdb)return ub.a.fS().then(Zb=>Zb.updateNotification(ma,this.dTl(Zb,Sa)))}getTypeName(){return"Microsoft.Office.NotificationService"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){switch(ma){case 1:return this.Pom(Sa);case 3:return this.FFn(Sa);case 2:return this.SXn(Sa)}ma=
this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}Pom(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,"string");return this.addNotification(Sa,ma)}FFn(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.removeNotification(ma)}SXn(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");
ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,"string");return this.updateNotification(Sa,ma)}}Object(c.a)(Ik,"NotificationService",null,[]);class kk{createInstance(ma,Sa,Zb="",Wc=null,rd=null){switch(ma){case "Microsoft.Office.ActionService":return new yh(Sa);case "Microsoft.Office.SharedFilePicker":return new qj;case "Microsoft.Office.Auth":return new ck(Zb,Wc,rd);case "Microsoft.Office.AugLoopEventService":return new Fh(Zb);case "Microsoft.Office.NotificationService":return new Ik}return null}}
Object(c.a)(kk,"WacApiHost",null,[]);class cj{constructor(){this.responseData=null}}Object(c.a)(cj,"UserFeedbackResponseEventArgs",null,[]);class Bk{constructor(){this.isFeedbackSent=!1}}Object(c.a)(Bk,"UserFeedbackUIDismissedEventArgs",null,[]);class ul{constructor(ma,Sa,Zb=!1,Wc=null){this.vua=ma;this.Zid=Sa;this.Xdb=Zb;this.Q8a=Wc||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(ma){this.Q8a.fireEvent("",65546,Object.assign(new Bk,{isFeedbackSent:ma}))}onError(){}XHm(ma){this.Q8a.fireEvent("",
65550,Object.assign(new cj,{responseData:JSON.stringify(ma)}))}VQm(ma){switch(ma){case 0:return"Smile";case 1:return"Frown";case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}WQm(ma){switch(ma){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}UQm(ma){const Sa={};Sa.isScenarioEnabled=ma.isScenarioEnabled;Sa.scenarioType=ma.scenarioType;if(ma=ma.question){const Zb={};Zb.questionUiType=ma.questionUIType;Zb.questionUiBehavior=ma.questionUIBehavior;Zb.questionInstruction=
ma.questionInstruction;Zb.questionOptions=ma.questionOptions;Sa.questionDetails=Zb}return Sa}Htd(ma,Sa,Zb){"True"===Zb?ma[Sa]=!0:"False"===Zb&&(ma[Sa]=!1)}canCollectUserFeedback(){return u.AFrameworkApplication.$F}collectUserFeedback(ma,Sa,Zb,Wc){if(!this.Xdb){const rd={};u.AFrameworkApplication.ga.Amc(rd);const ee=this.Zid.getContext(rd);ee.initialFeedbackType=this.VQm(ma);ee.uiType=this.WQm(Sa);ee.telemetryGroup.featureArea=Zb;Wc.v2Config.contextDataFiles&&(ee.isShareContextDataEnabled=!0,ee.getContextData=
()=>Promise.all(Mi.a.map(Wc.v2Config.contextDataFiles,De=>window.fetch("data:application/octet-stream;base64,"+De.base64Data).then(Af=>Af.blob()).then(Af=>new File([Af],De.fileName,{type:De.fileType})))));(ma=Wc.v2Config.scenarioConfig)&&(ee.scenarioConfig=this.UQm(ma));this.Htd(ee,"showEmailAddress",Wc.v2Config.isEmailCollectionEnabled);this.Htd(ee,"isFileUploadEnabled",Wc.v2Config.isFileUploadEnabled);this.Htd(ee,"screenshot",Wc.v2Config.isScreenshotEnabled);this.Htd(ee,"isScreenRecordingEnabled",
Wc.v2Config.isScreenRecordingEnabled);this.Htd(ee,"isThankYouPageDisabled",Wc.v2Config.isThankYouPageDisabled);this.Htd(ee,"isHostManagedContextDataEnabled",Wc.v2Config.isHostManagedContextDataEnabled);this.Htd(ee,"isRetrieveFormDataEnabled",Wc.v2Config.isRetrieveFormDataEnabled);ee.hostManagedContextDataExplanationUrl=Wc.v2Config.hostManagedContextDataExplanationUrl;ub.a.eJd().then(De=>{De.initializeFeedbackModal(ee,Object(r.a)(this,this.onDismiss,"onDismiss"),Object(r.a)(this,this.onError,"onError"),
Object(r.a)(this,this.XHm,"extractFeedbackDataForHost"));return De})}}_RegisterUserFeedbackResponseEvent(){this.Xdb||this.Q8a.register(this.vua,"",65550)}_RegisterUserFeedbackUIDismissedEvent(){this.Xdb||this.Q8a.register(this.vua,"",65546)}_UnregisterUserFeedbackResponseEvent(){this.Xdb||this.Q8a.unregister(this.vua,"",65550)}_UnregisterUserFeedbackUIDismissedEvent(){this.Xdb||this.Q8a.unregister(this.vua,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,Sa){switch(ma){case 27:return this.uwm();case 1:return this.tym(Sa);case 28:return this.Qem();case 18:return this.Rem();case 29:return this.afm();
case 19:return this.bfm()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}uwm(){return this.canCollectUserFeedback()}tym(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int"),Zb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,"int"),Wc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,2,"string");
ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,3,"object");this.collectUserFeedback(Sa,Zb,Wc,ma);return null}Qem(){this._RegisterUserFeedbackResponseEvent();return null}Rem(){this._RegisterUserFeedbackUIDismissedEvent();return null}afm(){this._UnregisterUserFeedbackResponseEvent();return null}bfm(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(c.a)(ul,"UserFeedbackService",null,[]);var Ug=a(1532),cl=a(1125),Vk=a(1127),Ni=a(1128),Pi=a(1126);class Gj{c3i(ma){const Sa=
new cl.a("FA000000012","sdxcatalog","sdxcatalog","0.0.0.0"),Zb=new Pi.a(D.a.Jvl(),"Web","en-Us"),Wc=new Vk.a;Wc.TDa=ma;Ug.a.instance.Hsj(Sa,Ni.a.taskpane,"CopilotHelpTaskpane",Zb,Wc)}launchHelpPaneByArticleId(ma){this.c3i({SourceControlId:"SearchHelp",query:"AssetID="+ma});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByArticleIdString(ma){this.c3i({SourceControlId:"SearchHelp",query:"AssetID="+ma});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByQuery(ma){this.c3i({SourceControlId:"SearchHelp",
query:ma});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.CopilotService"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,
Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){switch(ma){case 2:return this.E8m(Sa);case 3:return this.F8m(Sa);case 1:return this.G8m(Sa)}ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}E8m(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return this.launchHelpPaneByArticleId(ma)}F8m(ma){ma=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.launchHelpPaneByArticleIdString(ma)}G8m(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.launchHelpPaneByQuery(ma)}}Object(c.a)(Gj,"CopilotService",null,[]);class vk{constructor(){this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=
0;this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0}getTypeName(){return"Microsoft.Office.SensitivityLabelInfo"}invokePropertyGet(ma){switch(ma){case 15:return this.color;case 13:return this.description;case 12:return this.displayName;case 8:return this.encryptionType;case 10:return this.hasExtractForUser;case 9:return this.isDke;case 7:return this.isEnabled;
case 5:return this.labelId;case 11:return this.order;case 14:return this.parentName;case 6:return this.tenantId;case 4:return this.version}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma,Sa){switch(ma){case 15:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 13:this.description=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,
0,"string");return;case 12:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 8:this.encryptionType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"int");return;case 10:this.hasExtractForUser=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"boolean");return;case 9:this.isDke=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"boolean");return;case 7:this.isEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,
0,"boolean");return;case 5:this.labelId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 11:this.order=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"int");return;case 14:this.parentName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 6:this.tenantId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 4:this.version=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}}Object(c.a)(vk,"SensitivityLabelInfo",null,[]);var Qi;(function(ma){ma[ma.generic=
0]="generic";ma[ma.coherencyFailure=1]="coherencyFailure";ma[ma.zol=2]="disabledByPolicy";ma[ma.fileCheckedOut=3]="fileCheckedOut";ma[ma.r3n=4]="fileEncrypted";ma[ma.s3n=5]="fileLocked";ma[ma.u3n=6]="fileNotSupported";ma[ma.fileTooLarge=7]="fileTooLarge";ma[ma.d4n=8]="invalidOperationOnZeroByteFile";ma[ma.$7m=9]="labelDisabled";ma[ma.m4n=10]="labelErrorRetryLater";ma[ma.a8m=11]="labelIdNotFound";ma[ma.n4n=12]="labelIrmDisabledByTenant";ma[ma.o4n=13]="labelNotSupported";ma[ma.y4n=14]="mandatoryConflict";
ma[ma.K4n=15]="minorVersionLimitExceeded"})(Qi||(Qi={}));Object(c.b)("SetPolicyLabelErrorType",Qi);var Hj=a(1355);class mj{constructor(){this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null;this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null}getTypeName(){return"Microsoft.Office.SensitivityLabelChangedEventArgs"}invokePropertyGet(ma){switch(ma){case 20:return this.context;case 21:return this.error;case 19:return this.newLabel;case 18:return this.previousLabel}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma,Sa){switch(ma){case 20:this.context=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 21:this.error=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"int");return;case 19:this.newLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"SensitivityLabelInfo");return;case 18:this.previousLabel=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"SensitivityLabelInfo");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}}
Object(c.a)(mj,"SensitivityLabelChangedEventArgs",null,[]);class Xj{constructor(ma,Sa){this.Q8a=OfficeExtension.WacRuntime.RichApi.getEventManager();this.vua=ma;this.x8g=Sa}XAb(){return u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)}Mkh(){return u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableLabelingDisabledCheckInOfficeJS",!1)}DEa(ma,Sa){ma={["Class"]:"SensitivityService",["ControlId"]:this.vua,
["Api"]:ma,["Hr"]:Sa.toString()};U.a.sendTelemetryEvent(Object.assign(new qa.a,{name:"Office.Online.Extensibility.ContextualTabsRichApi.Diagnostics",dataFields:N.a.Gw(ma)}))}dVm(ma){return ma.HasUserDefinedPermissions?2:ma.IsEndpointProtectionEnabled?1:0}O0k(ma){const Sa=new vk;Sa.color=ma.Color;Sa.description=ma.Tooltip;Sa.displayName=ma.ParentName?ma.ParentName+"\\"+ma.DisplayName:ma.DisplayName;Sa.encryptionType=this.dVm(ma);Sa.hasExtractForUser=ma.HasExtractForUser;Sa.isDke=!1;Sa.isEnabled=ma.Enabled;
Sa.labelId=ma.Id;Sa.order=ma.Order;Sa.parentName=ma.ParentName;Sa.tenantId="";Sa.version=0;return Sa}Bnn(ma){const Sa=new Hj.a;Sa.Id=ma.labelId;Sa.Enabled=ma.isEnabled;Sa.DisplayName=ma.displayName;Sa.Order=ma.order;Sa.Tooltip=ma.description;Sa.IsEndpointProtectionEnabled=1==ma.encryptionType||2==ma.encryptionType;Sa.Color=ma.color;Sa.HasUserDefinedPermissions=2==ma.encryptionType;Sa.ParentName=ma.parentName;return Sa}DMn(ma){switch(ma){case Qi.generic:return 2147467259;case Qi.zol:return 2147205115;
case Qi.a8m:return 2147205112;case Qi.$7m:return 2147205117;default:return 2147467259}}getHighestSensitivityLabel(ma){return OfficeExtension.WacRuntime.Utility.createPromise((Sa,Zb)=>{var Wc;this.XAb()||(this.DEa("getHighestSensitivityLabel",2147500033),Zb(2147500033));this.Mkh()&&!u.AFrameworkApplication.ga.getBooleanAppSetting("SupportsPolicies")&&(this.DEa("getHighestSensitivityLabel",2147205115),Zb(2147205115));ma&&0!=ma.length||(this.DEa("getHighestSensitivityLabel",2147942487),Zb(2147942487));
var rd=null===(Wc=this.x8g)||void 0===Wc?void 0:Wc.instance;rd||(this.DEa("getHighestSensitivityLabel",2147942488),Zb(2147942488));Wc=[];for(const ee of ma)Wc=Wc.concat(ee.labelId);rd=rd.getHighestSensitivityLabel(Wc);null==rd?(this.DEa("getHighestSensitivityLabel",2147205112),Zb(2147205112)):Sa(this.O0k(rd))})}getLabel(){return OfficeExtension.WacRuntime.Utility.createPromise((ma,Sa)=>{var Zb;this.XAb()||(this.DEa("getLabel",2147500033),Sa(2147500033));this.Mkh()&&!u.AFrameworkApplication.ga.getBooleanAppSetting("SupportsPolicies")&&
(this.DEa("getHighestSensitivityLabel",2147205115),Sa(2147205115));const Wc=null===(Zb=this.x8g)||void 0===Zb?void 0:Zb.instance;Wc||(this.DEa("getLabel",2147942488),Sa(2147942488));(Zb=Wc.fMm())?ma(this.O0k(Zb)):(this.DEa("getLabel",2147500037),Sa(2147500037))})}tryUpgradeLabel(ma,Sa){return OfficeExtension.WacRuntime.Utility.createPromise((Zb,Wc)=>{var rd;this.XAb()||(this.DEa("tryUpgradeLabel",2147500033),Wc(2147500033));this.Mkh()&&!u.AFrameworkApplication.ga.getBooleanAppSetting("SupportsPolicies")&&
(this.DEa("getHighestSensitivityLabel",2147205115),Wc(2147205115));ma||(this.DEa("tryUpgradeLabel",2147942487),Wc(2147942487));const ee=null===(rd=this.x8g)||void 0===rd?void 0:rd.instance;ee||(this.DEa("tryUpgradeLabel",2147942488),Wc(2147942488));Sa="OFFICEJS_SENSITIVITY_CONTEXT_"+Sa;rd=ee.tryUpgradeLabel(this.Bnn(ma),Sa);0==rd?Zb(rd):(this.DEa("tryUpgradeLabel",rd),Wc(rd))})}_RegisterSensitivityLabelChangedEvent(){var ma;if(this.XAb())if(this.Mkh()&&!u.AFrameworkApplication.ga.getBooleanAppSetting("SupportsPolicies"))this.DEa("getHighestSensitivityLabel",
2147205115);else{var Sa=null===(ma=this.x8g)||void 0===ma?void 0:ma.instance;Sa?(Sa.Y9b((Zb,Wc)=>{var rd;Zb=new mj;Zb.context=(null===(rd=Wc.context)||void 0===rd?0:rd.startsWith("OFFICEJS_SENSITIVITY_CONTEXT_"))?Wc.context.substring(29):Wc.context;Zb.error=Wc.vw?0:this.DMn(Wc.Q2l);Zb.newLabel=this.O0k(Wc.Xbf);this.Q8a.fireEvent("",65549,Zb)}),this.Q8a.register(this.vua,"",65549)):this.DEa("registerSensitivityLabelChangedEvent",2147942488)}else this.DEa("registerSensitivityLabelChangedEvent",2147500033)}_UnregisterSensitivityLabelChangedEvent(){this.XAb()?
this.Q8a.unregister(this.vua,"",65549):this.DEa("unregisterSensitivityLabelChangedEvent",2147500033)}getTypeName(){return"Microsoft.Office.SensitivityService"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,
Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){switch(ma){case 16:return this.Oem();case 17:return this.Zem()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){switch(ma){case 3:return this.rPm(Sa);case 1:return this.WPm();case 2:return this.lWn(Sa)}ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}rPm(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
0,"Array<Common.App.AppsForOffice.SensitivityLabelInfo>");return this.getHighestSensitivityLabel(ma)}WPm(){return this.getLabel()}lWn(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"SensitivityLabelInfo");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,"string");return this.tryUpgradeLabel(Sa,ma)}Oem(){this._RegisterSensitivityLabelChangedEvent();return null}Zem(){this._UnregisterSensitivityLabelChangedEvent();return null}}Object(c.a)(Xj,"SensitivityService",
null,[]);class $h{constructor(ma,Sa,Zb){this.uFg=!1;this.kIl=!0;this.u_f=ma;this.Boa=Sa;this.Hd=Zb}hostName(){return"PowerPointOnline"}appId(){return this.u_f}controlId(){return this.Boa}createInstance(ma){switch(ma){case "Microsoft.Office.PowerPoint.AddSlideOptions":return new zd;case "Microsoft.Office.PowerPoint.Application":return new tb;case "Microsoft.Office.PowerPoint.ApplyJOfcCommandsCompletedEventArgs":return new Jf;case "Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions":return new Th;
case "Microsoft.Office.PowerPoint.CopilotActionCompletedEventArgs":return new Kc;case "Microsoft.Office.PowerPoint.InsertSlideOptions":return new wd;case "Microsoft.Office.PowerPoint.ShapeAddOptions":return new If;case "Microsoft.AppRuntime.AppRuntimeService":return new ge(this.Boa,this.Hd);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return new Je(this.u_f,this.Boa,this.Hd);case "Microsoft.Office.Licensing.License":return new Yf(this.Boa,this.Hd);case "Microsoft.DynamicRibbon.DynamicRibbon":return new ud(this.Boa,
this.Hd);case "Microsoft.Office.NotificationService":case "Microsoft.Office.AugLoopEventService":var Sa=this.Hd.nq.getOsfControl(this.Boa);if(null===Sa||void 0===Sa?0:Sa.isFirstParty())return this.NMl||(this.NMl=new kk),ma=this.NMl.createInstance(ma,null,this.Boa),ma.Xdb=this.uFg,ma;break;case "Microsoft.Office.UserFeedbackService":Sa=this.Hd.nq.getOsfControl(this.Boa);if(null===Sa||void 0===Sa?0:Sa.isFirstParty())return new ul(this.Boa,ia.a.instance.resolve("Common.App.ICustomerFeedbackUiWrapper"),
this.uFg);break;case "Microsoft.Office.SensitivityLabelInfo":return new vk;case "Microsoft.Office.SensitivityService":Sa=this.Hd.nq.getOsfControl(this.Boa);if(null===Sa||void 0===Sa?0:Sa.isFirstParty)return new Xj(this.Boa,ia.a.instance.Na("Common.App.Policy.Contracts.IPolicyManager"));break;case "Microsoft.Office.CopilotService":if(Sa=this.Hd.nq.getOsfControl(this.Boa),"9202c06a-b7d3-466f-9adb-acad75789dbc"===(null===Sa||void 0===Sa?void 0:Sa.getSolutionId()))return new Gj}f.ULS.sendTraceTag(509085406,
802,10,"Typename: {0} is an invalid parameter. Only instance for Application can be created through this method.",ma);return null}Gtl(){const ma=this.Hd.rTa.$Ja(this.Boa);return ma.Mx.id+"#"+ma.Mx.storeType}static nG(ma){const Sa=ia.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager").Fdl;ma||(Sa.kIl=!1);return!Sa.uFg}}Object(c.a)($h,"RichApiHost",null,[919]);class tf{constructor(ma,Sa){this.Lqd=ma;this.gva=Sa}get fill(){$h.nG(!1);return null}get height(){$h.nG(!1);return 0}set height(ma){$h.nG(!1)}get id(){const ma=
new Pd(28);try{T.a.J(508303063,802,50,"PptApi Call - Shape.GetId");if(!this.Lqd)return T.a.J(508303062,802,10,"Shape is null."),"";const Sa=this.Lqd.get_shapeId().toString();ma.qW();return Sa}finally{ma&&ma.dispose()}}get left(){$h.nG(!1);return 0}set left(ma){$h.nG(!1)}get lineFormat(){$h.nG(!1);return null}get name(){$h.nG(!1);return null}set name(ma){$h.nG(!1)}get tags(){$h.nG(!1);return null}get textFrame(){$h.nG(!1);return null}get top(){$h.nG(!1);return 0}set top(ma){$h.nG(!1)}get type(){$h.nG(!1);
return 0}get width(){$h.nG(!1);return 0}set width(ma){$h.nG(!1)}get zOrderPosition(){$h.nG(!1);return 0}setZOrder(){$h.nG(!1)}deleteObject(){if($h.nG(!0)){var ma=new Pd(45);try{T.a.J(508303061,802,50,"PptApi Call - Shape.Delete");const Sa=Object(ta.a)(32,this.gva);Sa&&(Sa.Gnl(Object(ta.a)(426,this.Lqd)),ma.qW())}finally{ma&&ma.dispose()}}}getParentSlide(){$h.nG(!1);return null}getParentSlideLayout(){$h.nG(!1);return null}getParentSlideLayoutOrNullObject(){$h.nG(!1);return null}getParentSlideMaster(){$h.nG(!1);
return null}getParentSlideMasterOrNullObject(){$h.nG(!1);return null}getParentSlideOrNullObject(){$h.nG(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Shape"}invokePropertyGet(ma){switch(ma){case 11:return this.fill;case 5:return this.height;case 1:return this.id;case 6:return this.left;case 12:return this.lineFormat;case 7:return this.name;case 3:return this.tags;case 13:return this.textFrame;case 8:return this.top;case 9:return this.type;case 10:return this.width;
case 22:return this.zOrderPosition}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma,Sa){switch(ma){case 5:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"number");return;case 6:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"number");return;case 7:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,
0,"string");return;case 8:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"number");return;case 10:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,Sa){switch(ma){case 4:return this.wti();case 15:return this.qRm();
case 16:return this.rRm();case 18:return this.sRm();case 17:return this.tRm();case 19:return this.uRm();case 20:return this.vRm();case 21:return this.HNn(Sa);case 2:return this.Qka()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}wti(){this.deleteObject();return null}qRm(){return this.getParentSlide()}rRm(){return this.getParentSlideLayout()}sRm(){return this.getParentSlideLayoutOrNullObject()}tRm(){return this.getParentSlideMaster()}uRm(){return this.getParentSlideMasterOrNullObject()}vRm(){return this.getParentSlideOrNullObject()}HNn(ma){return this.setZOrder(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
0,"int"))}Qka(){this._OnAccess();return null}}Object(c.a)(tf,"Shape",null,[]);class yj{constructor(ma,Sa,Zb){this.CDh=this.xn=-1;this.iQ=Zb;0<=ma&&(this.xn+=ma,this.CDh=0<Sa?ma+Sa<this.iQ.getCount()?ma+Sa:this.iQ.getCount():this.iQ.getCount())}get_current(){return-1<this.xn&&this.xn<this.CDh?this.iQ.getItemAt(this.xn):null}moveNext(){const ma=this.VVn();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}VVn(){return this.xn+1<this.CDh?(this.xn++,!0):!1}}Object(c.a)(yj,"ElementEnumerator",
null,[943]);class vj{constructor(ma){this.qZe=this.Qxe=null;this.gva=ma;if(ma=Object(ta.a)(32,this.gva))this.Qxe=ma.AQb();this.twn()}twn(){this.qZe=new O.ScriptSharpLegacyMap;if(this.Qxe)for(const ma of this.Qxe){const Sa=new tf(ma,this.gva);this.qZe.add(Sa.id,Sa)}}addGeometricShape(){$h.nG(!1);return null}addLine(){$h.nG(!1);return null}addTextBox(){$h.nG(!1);return null}getCount(){const ma=new Pd(29);try{T.a.J(508360579,802,50,"PptApi Call - ShapeCollection.GetCount");if(!this.Qxe)return T.a.J(508360578,
802,50,"In Shape.GetCount(), _shapes is null"),0;ma.qW();return this.Qxe.length}finally{ma&&ma.dispose()}}getItem(ma){const Sa=new Pd(31);try{T.a.J(508360577,802,50,"PptApi Call - ShapeCollection.GetItem");try{const Zb=this.qZe.ha(ma);Sa.qW();return Zb}catch(Zb){throw T.a.J(508360576,802,15,String.format("In Shape.GetItem(id), Exception: {0} ",Zb.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");
}}finally{Sa&&Sa.dispose()}}getItemAt(ma){const Sa=new Pd(30);try{T.a.J(508360547,802,50,"PptApi Call - ShapeCollection.GetItemAt");try{const Zb=this.Qxe[ma].get_shapeId().toString(),Wc=this.qZe.ha(Zb);Sa.qW();return Wc}catch(Zb){throw T.a.J(508360546,802,15,String.format("In Shape.GetItemAt(index), Exception: {0} ",Zb.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{Sa&&
Sa.dispose()}}getItemOrNullObject(ma){const Sa=new Pd(32);try{T.a.J(508360545,802,50,"PptApi Call - ShapeCollection.GetItemOrNullObject");const {value:Zb}=this.qZe.Uh(ma);Sa.qW();return Zb}finally{null===Sa||void 0===Sa?void 0:Sa.dispose()}}_OnAccess(){}getAsyncEnumerator(ma,Sa){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new yj(ma,Sa,this))}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeCollection"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,Sa){switch(ma){case 6:return this.oom(Sa);case 7:return this.Fom(Sa);case 8:return this.zpm(Sa);case 1:return this.$Gd();case 2:return this.iId(Sa);
case 5:return this.hId(Sa);case 3:return this.jId(Sa);case 4:return this.Qka()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}oom(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,If);return this.addGeometricShape(Sa,ma)}Fom(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
0,"int");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,If);return this.addLine(Sa,ma)}zpm(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,If);return this.addTextBox(Sa,ma)}$Gd(){return this.getCount()}iId(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getItem(ma)}hId(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
0,"int");return this.getItemAt(ma)}jId(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getItemOrNullObject(ma)}Qka(){this._OnAccess();return null}}Object(c.a)(vj,"ShapeCollection",null,[939]);class jl{constructor(ma){this.G$g=ma}get id(){const ma=new Pd(15);try{T.a.J(508147477,802,50,"PptApi Call - SlideLayout.GetId");if(!this.G$g)return T.a.J(508147476,802,10,"SlideLayout is null."),"";const Sa=this.G$g.Id.toString();ma.qW();return Sa}finally{ma&&ma.dispose()}}get name(){const ma=
new Pd(16);try{T.a.J(508147475,802,50,"PptApi Call - SlideLayout.GetName");if(!this.G$g)return T.a.J(508147474,802,10,"SlideLayout is null."),"";const Sa=this.G$g.Name;ma.qW();return Sa}finally{ma&&ma.dispose()}}get shapes(){$h.nG(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayout"}invokePropertyGet(ma){switch(ma){case 1:return this.id;case 3:return this.name;case 4:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=
this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){switch(ma){case 2:return this.Qka()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}Qka(){this._OnAccess();return null}}Object(c.a)(jl,"SlideLayout",null,[]);class ri{constructor(ma){this.rZe=null;this.N6e=ma;this.uwn()}uwn(){this.rZe=new O.ScriptSharpLegacyMap;if(this.N6e)for(const ma of this.N6e){const Sa=new jl(ma);this.rZe.add(Sa.id,Sa)}}getCount(){const ma=new Pd(17);try{T.a.J(508360608,802,50,"PptApi Call - SlideLayoutCollection.GetCount");if(!this.N6e)return T.a.J(508360607,802,50,"In SlideLayouts.GetCount(), _slideLayouts is null"),
0;ma.qW();return this.N6e.length}finally{ma&&ma.dispose()}}getItem(ma){const Sa=new Pd(19);try{T.a.J(508360606,802,50,"PptApi Call - SlideLayoutCollection.GetItem");try{const Zb=this.rZe.ha(ma);Sa.qW();return Zb}catch(Zb){throw T.a.J(508360605,802,15,String.format("In SlideLayout.GetItem(id), Exception: {0} ",Zb.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{Sa&&Sa.dispose()}}getItemAt(ma){const Sa=
new Pd(18);try{T.a.J(508360604,802,50,"PptApi Call - SlideLayoutCollection.GetItemAt");try{const Zb=this.rZe.ha(this.N6e[ma].Id.toString());Sa.qW();return Zb}catch(Zb){throw T.a.J(508360603,802,15,String.format("In SlideLayouts.GetItemAt(index), Exception: {0} ",Zb.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{Sa&&Sa.dispose()}}getItemOrNullObject(ma){const Sa=
new Pd(20);try{T.a.J(508360602,802,50,"PptApi Call - SlideLayoutCollection.GetItemOrNullObject");const {value:Zb}=this.rZe.Uh(ma);Sa.qW();return Zb}finally{null===Sa||void 0===Sa?void 0:Sa.dispose()}}_OnAccess(){}getAsyncEnumerator(ma,Sa){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new yj(ma,Sa,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayoutCollection"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=
this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,Sa){switch(ma){case 1:return this.$Gd();case 2:return this.iId(Sa);case 3:return this.hId(Sa);case 4:return this.jId(Sa);case 5:return this.Qka()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}$Gd(){return this.getCount()}iId(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getItem(ma)}hId(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return this.getItemAt(ma)}jId(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getItemOrNullObject(ma)}Qka(){this._OnAccess();
return null}}Object(c.a)(ri,"SlideLayoutCollection",null,[939]);class Wk{constructor(ma){this.Zxe=ma}get id(){const ma=new Pd(21);try{T.a.J(508147473,802,50,"PptApi Call - SlideMaster.GetId");if(!this.Zxe)return T.a.J(508147472,802,10,"SlideMaster is null."),"";const Sa=this.Zxe.Id.toString();ma.qW();return Sa}finally{ma&&ma.dispose()}}get layouts(){const ma=new Pd(23);try{T.a.J(508147471,802,50,"PptApi Call - SlideMaster.GetLayouts");if(!this.Zxe)return T.a.J(508147470,802,10,"SlideMaster is null."),
null;const Sa=new ri(this.Zxe.ContentMasters);ma.qW();return Sa}finally{ma&&ma.dispose()}}get name(){const ma=new Pd(22);try{T.a.J(508147469,802,50,"PptApi Call - SlideMaster.GetName");if(!this.Zxe)return T.a.J(508147468,802,10,"SlideMaster is null."),"";const Sa=this.Zxe.Name;ma.qW();return Sa}finally{ma&&ma.dispose()}}get shapes(){$h.nG(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMaster"}invokePropertyGet(ma){switch(ma){case 1:return this.id;case 3:return this.layouts;
case 4:return this.name;case 5:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma){switch(ma){case 2:return this.Qka()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}Qka(){this._OnAccess();return null}}Object(c.a)(Wk,"SlideMaster",null,[]);class kl{constructor(ma,Sa){this.gva=ma;this.Yjc=Sa}get id(){const ma=new Pd(5);try{T.a.J(508147483,802,50,"PptApi Call - Slide.GetId");if(!this.gva)return T.a.J(508147482,802,10,"Slide is null."),"";const Sa=this.gva.Xb.toString();ma.qW();return Sa}finally{ma&&ma.dispose()}}get layout(){const ma=new Pd(9);
try{T.a.J(508147481,802,50,"PptApi Call - Slide.GetLayout");const Sa=this.Yjc.QY;for(let Zb=0;Zb<Sa.length;Zb++){const Wc=Sa[Zb].ContentMasters;for(let rd=0;rd<Wc.length;rd++)if(this.gva.en===Wc[rd].Id){const ee=new jl(Wc[rd]);ma.qW();return ee}}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a Layout.");}finally{ma&&ma.dispose()}}get shapes(){const ma=new Pd(6);try{T.a.J(508147480,802,50,"PptApi Call - Slide.GetShapes");
const Sa=new vj(this.gva);ma.qW();return Sa}finally{ma&&ma.dispose()}}get slideMaster(){const ma=new Pd(8);try{T.a.J(508147479,802,50,"PptApi Call - Slide.GetSlideMaster");const Sa=this.Yjc.QY;for(let Zb=0;Zb<Sa.length;Zb++)if(this.gva.lj===Sa[Zb].Id){const Wc=new Wk(Sa[Zb]);ma.qW();return Wc}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a SlideMaster.");}finally{ma&&ma.dispose()}}get tags(){$h.nG(!1);
return null}deleteObject(){if($h.nG(!0)){var ma=new Pd(7);try{T.a.J(508147478,802,50,"PptApi Call - Slide.Delete"),this.Yjc.UC(this.gva),ma.qW()}finally{ma&&ma.dispose()}}}setSelectedShapes(){$h.nG(!1)}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Slide"}invokePropertyGet(ma){switch(ma){case 1:return this.id;case 5:return this.layout;case 4:return this.shapes;case 6:return this.slideMaster;case 7:return this.tags}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,Sa){switch(ma){case 3:return this.wti();case 8:return this.SMn(Sa);case 2:return this.Qka()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}wti(){this.deleteObject();return null}SMn(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"Array<string>");this.setSelectedShapes(ma);return null}Qka(){this._OnAccess();return null}}Object(c.a)(kl,"Slide",null,[]);class tj{constructor(ma){this.sZe=null;this.Yjc=ma;this.$xe=this.Yjc.slides;this.vwn()}vwn(){this.sZe=new O.ScriptSharpLegacyMap;if(this.$xe)for(const ma of this.$xe){const Sa=
new kl(ma,this.Yjc);this.sZe.add(Sa.id,Sa)}}RNm(){return 0<this.getCount()?this.$xe[this.getCount()-1]:null}lHd(ma){return ma?ma.lj:this.Yjc.QY[0].Id}TNm(ma){const Sa=this.Yjc.QY;for(let Zb=0;Zb<Sa.length;Zb++)if(ma===Sa[Zb].Id)return Sa[Zb].ContentMasters[0].Id;return 0}add(ma){if($h.nG(!0)){var Sa=new Pd(10);try{T.a.J(508360587,802,50,"PptApi Call - SlideCollection.Add");const Zb=this.RNm();let Wc=0;Wc=ma&&ma.slideMasterId?parseInt(ma.slideMasterId):this.lHd(Zb);let rd=0;rd=ma&&ma.layoutId?parseInt(ma.layoutId):
this.TNm(Wc);this.Yjc.EJb(Zb,null,Wc,rd);Sa.qW()}finally{Sa&&Sa.dispose()}}}getCount(){const ma=new Pd(11);try{T.a.J(508360586,802,50,"PptApi Call - SlideCollection.GetCount");if(!this.$xe)return T.a.J(508360585,802,50,"In Slides.GetCount(), _slides is null"),0;ma.qW();return this.$xe.length}finally{ma&&ma.dispose()}}getItem(ma){const Sa=new Pd(13);try{T.a.J(508360584,802,50,"PptApi Call - SlideCollection.GetItem");try{const Zb=this.sZe.ha(ma);Sa.qW();return Zb}catch(Zb){throw T.a.J(508360583,802,
15,String.format("In Slide.GetItem(id), Exception: {0} ",Zb.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{Sa&&Sa.dispose()}}getItemAt(ma){const Sa=new Pd(12);try{T.a.J(508360582,802,50,"PptApi Call - SlideCollection.GetItemAt");try{const Zb=this.sZe.ha(this.$xe[ma].Xb.toString());Sa.qW();return Zb}catch(Zb){throw T.a.J(508360581,802,15,String.format("In Slide.GetItemAt(index), Exception: {0} ",
Zb.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{Sa&&Sa.dispose()}}getItemOrNullObject(ma){const Sa=new Pd(14);try{T.a.J(508360580,802,50,"PptApi Call - SlideCollection.GetItemOrNullObject");const {value:Zb}=this.sZe.Uh(ma);Sa.qW();return Zb}finally{null===Sa||void 0===Sa?void 0:Sa.dispose()}}_OnAccess(){}getAsyncEnumerator(ma,Sa){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new yj(ma,
Sa,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideCollection"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,
Sa){switch(ma){case 6:return this.Com(Sa);case 1:return this.$Gd();case 5:return this.iId(Sa);case 2:return this.hId(Sa);case 3:return this.jId(Sa);case 4:return this.Qka()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}Com(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,zd);this.add(ma);return null}$Gd(){return this.getCount()}iId(ma){ma=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getItem(ma)}hId(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"int");return this.getItemAt(ma)}jId(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getItemOrNullObject(ma)}Qka(){this._OnAccess();return null}}Object(c.a)(tj,"SlideCollection",null,[939]);class Mk{constructor(ma){this.tZe=null;this.O6e=ma;this.wwn()}wwn(){this.tZe=new O.ScriptSharpLegacyMap;
if(this.O6e)for(const ma of this.O6e){const Sa=new Wk(ma);this.tZe.add(Sa.id,Sa)}}getCount(){const ma=new Pd(24);try{T.a.J(508360594,802,50,"PptApi Call - SlideMasterCollection.GetCount");if(!this.O6e)return T.a.J(508360593,802,50,"In SlideMasters.GetCount(), _slideMasters is null"),0;ma.qW();return this.O6e.length}finally{ma&&ma.dispose()}}getItem(ma){const Sa=new Pd(26);try{T.a.J(508360592,802,50,"PptApi Call - SlideMasterCollection.GetItem");try{const Zb=this.tZe.ha(ma);Sa.qW();return Zb}catch(Zb){throw T.a.J(508360591,
802,15,String.format("In SlideMaster.GetItem(id), Exception: {0} ",Zb.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{Sa&&Sa.dispose()}}getItemAt(ma){const Sa=new Pd(25);try{T.a.J(508360590,802,50,"PptApi Call - SlideMasterCollection.GetItemAt");try{const Zb=this.tZe.ha(this.O6e[ma].Id.toString());Sa.qW();return Zb}catch(Zb){throw T.a.J(508360589,802,15,String.format("In SlideMasters.GetItemAt(index), Exception: {0} ",
Zb.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{Sa&&Sa.dispose()}}getItemOrNullObject(ma){const Sa=new Pd(27);try{T.a.J(508360588,802,50,"PptApi Call - SlideMasterCollection.GetItemOrNullObject");const {value:Zb}=this.tZe.Uh(ma);Sa.qW();return Zb}finally{null===Sa||void 0===Sa?void 0:Sa.dispose()}}_OnAccess(){}getAsyncEnumerator(ma,Sa){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new yj(ma,
Sa,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMasterCollection"}invokePropertyGet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,
Sa){switch(ma){case 1:return this.$Gd();case 2:return this.iId(Sa);case 3:return this.hId(Sa);case 4:return this.jId(Sa);case 5:return this.Qka()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}$Gd(){return this.getCount()}iId(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getItem(ma)}hId(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
0,"int");return this.getItemAt(ma)}jId(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");return this.getItemOrNullObject(ma)}Qka(){this._OnAccess();return null}}Object(c.a)(Mk,"SlideMasterCollection",null,[939]);class hj{constructor(){this.controlId=this.appId=null}}Object(c.a)(hj,"RequestContext",null,[]);var ll=a(61);class ml{constructor(ma,Sa,Zb){this.EI=new hj;this.eN=ma.presentation;this.oab=Zb;this.xLl=Sa}get context(){return this.EI}R9m(ma){try{"chatpane"==JSON.parse(ma).entryPoint.toLowerCase()&&
ll.c(Ua.a.K6l,!0)}catch(Sa){T.a.J(508682385,817,15,`PptApi::logCopilotEntryPoint parsing options.scenarioOptions threw exceptions : ${Sa}`)}}get id(){return null}get bindings(){$h.nG(!1);return null}get slideMasters(){const ma=new Pd(2);try{T.a.J(508908362,802,50,"PptApi Call - Presentation.GetSlideMasters");const Sa=new Mk(this.eN.QY);ma.qW();return Sa}finally{ma&&ma.dispose()}}get slides(){const ma=new Pd(3);try{T.a.J(508908361,802,50,"PptApi Call - Presentation.GetSlides");const Sa=new tj(this.eN);
ma.qW();return Sa}finally{ma&&ma.dispose()}}get tags(){$h.nG(!1);return null}get title(){const ma=new Pd(4);try{return T.a.J(508908360,802,50,"PptApi Call - Presentation.GetTitle"),ma.qW(),"This is the title property"}finally{ma&&ma.dispose()}}applyJOfcCommands(ma,Sa){if($h.nG(!0))return cd.a("PptApplyJOfcCommandsUseSharedCode")?((null===Sa||void 0===Sa?0:Sa.scenarioOptions)&&cd.a("PptChatLogUserAction")&&this.R9m(null===Sa||void 0===Sa?void 0:Sa.scenarioOptions),this.oab.applyJOfcCommands(ma,Sa.designerOptions,
Sa.scenarioOptions,Sa.selectionOptions,this.xLl.Gtl())):OfficeExtension.WacRuntime.Utility.createPromise(Zb=>{const Wc={};Wc.promiseToResolve=Zb;Wc.requestBody=ma;u.AFrameworkApplication.vb.Qa(Ua.a.sca,2,Wc)}).then(Zb=>{u.AFrameworkApplication.vb.Qa(Ua.a.sca,2,{promiseToResolve:null,requestBody:""});return Zb.toString()},()=>null)}applyJOfcCommandsAsync(ma,Sa){if($h.nG(!0))return this.oab.applyJOfcCommands(ma,Sa.designerOptions,Sa.scenarioOptions,Sa.selectionOptions,this.xLl.Gtl()),""}copilotAction(ma,
Sa){if($h.nG(!0))try{const Zb=JSON.parse(Sa),Wc=new Th;Wc.designerOptions=JSON.stringify(null===Zb||void 0===Zb?void 0:Zb.designerOptions);Wc.scenarioOptions=JSON.stringify(null===Zb||void 0===Zb?void 0:Zb.scenarioOptions);Wc.selectionOptions=JSON.stringify(null===Zb||void 0===Zb?void 0:Zb.selectionOptions);return this.applyJOfcCommands(JSON.stringify(null===Zb||void 0===Zb?void 0:Zb.jOfcCommands),Wc)}catch(Zb){return T.a.J(508117512,817,10,"Presentation::copilotAction error: {0}",Zb),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(this.oab.Nul())}}copilotActionAsync(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),
"Not implemented");}getSelectedShapes(){$h.nG(!1);return null}getSelectedSlides(){$h.nG(!1);return null}getSelectedTextRange(){$h.nG(!1);return null}getSelectedTextRangeOrNullObject(){$h.nG(!1);return null}insertSlidesFromBase64(){$h.nG(!1)}setSelectedSlides(){$h.nG(!1)}_RegisterEvent(ma,Sa){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,ma,Sa)}_RegisterEventApplyJOfcCommandsCompleted(){}_RegisterEventCopilotActionCompleted(){}_UnregisterEvent(ma,Sa){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,
ma,Sa)}_UnregisterEventApplyJOfcCommandsCompleted(){}_UnregisterEventCopilotActionCompleted(){}getTypeName(){return"Microsoft.Office.PowerPoint.Presentation"}invokePropertyGet(ma){switch(ma){case 15:return this.bindings;case 14:return this.id;case 3:return this.slideMasters;case 2:return this.slides;case 4:return this.tags;case 1:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokePropertyGetAsync(ma){ma=this.invokePropertyGet(ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}invokePropertySet(ma){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);
}invokePropertySetAsync(ma,Sa){this.invokePropertySet(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(ma,Sa){switch(ma){case 13:return this.wsm(Sa);case 19:return this.Xzm(Sa);case 5:return this.HSm();case 6:return this.JSm();case 7:return this.MSm();case 9:return this.NSm();case 1003:return this.O2m(Sa);case 8:return this.TMn(Sa);case 1001:return this.Mem(Sa);case 11:return this.Kem();case 16:return this.Lem();case 1002:return this.Xem(Sa);case 12:return this.Vem();
case 17:return this.Wem()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(ma);}invokeMethodAsync(ma,Sa){switch(ma){case 10:return this.xsm(Sa);case 18:return this.Yzm(Sa)}ma=this.invokeMethod(ma,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ma)}xsm(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,Th);return this.applyJOfcCommands(Sa,ma)}wsm(ma){const Sa=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,Th);return this.applyJOfcCommandsAsync(Sa,ma)}Yzm(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,"string");return this.copilotAction(Sa,ma)}Xzm(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
1,"string");return this.copilotActionAsync(Sa,ma)}HSm(){return this.getSelectedShapes()}JSm(){return this.getSelectedSlides()}MSm(){return this.getSelectedTextRange()}NSm(){return this.getSelectedTextRangeOrNullObject()}O2m(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,wd);this.insertSlidesFromBase64(Sa,ma);return null}TMn(ma){ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,
"Array<string>");this.setSelectedSlides(ma);return null}Mem(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,1,"int");this._RegisterEvent(Sa,ma);return null}Kem(){this._RegisterEventApplyJOfcCommandsCompleted();return null}Lem(){this._RegisterEventCopilotActionCompleted();return null}Xem(ma){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,0,"string");ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ma,
1,"int");this._UnregisterEvent(Sa,ma);return null}Vem(){this._UnregisterEventApplyJOfcCommandsCompleted();return null}Wem(){this._UnregisterEventCopilotActionCompleted();return null}}Object(c.a)(ml,"Presentation",null,[]);class Cj{constructor(ma){this.oab=ma}create(ma,Sa){return new ml(ma,Sa,this.oab)}}Object(c.a)(Cj,"PresentationFactory",null,[897]);class dj{create(ma,Sa,Zb){return new $h(ma,Sa,Zb)}}Object(c.a)(dj,"RichApiHostFactory",null,[898]);class Rg{constructor(ma){this.Rb=document.createElement("div");
this.Rb.className="AddinPaneFrame";this.d1=ma}dispose(){}layout(ma,Sa){this.d1.value.CWm(ma,Sa);return ma}get isVisible(){return!1}get ta(){return this.Rb}get order(){return 13}}Object(c.a)(Rg,"AddinPaneFrame",null,[877,495,24]);class Ri{constructor(){this.SYd=this.dnh=this.$=this.Hd=this.le=null}get name(){return"PowerPointWebEditor.AppForOffice"}lc(ma){this.le=ma.resolve("Common.AFrameworkApplication");this.$=ma;this.$.register(bg,"PowerPointWebEditor.AppForOfficeApi.GetDocumentCopyHelper").as("PowerPointWebEditor.IGetDocumentCopyHelper").na(()=>
new bg).ma();this.$.register(Cd,"PowerPointWebEditor.AppForOfficeFocusManager").as("PowerPointWebEditor.IAppForOfficeFocusManager").na(()=>new Cd(this.$.resolve("PowerPointWebEditor.IAddinPaneFrame").ta,this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("PowerPointWebEditor.IInputHandlerManager"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.ge("PowerPointWebEditor.IAppForOfficeManager"),this.$.resolve("PowerPointWebEditor.View.IViewEventNotifier"))).ma();this.$.register(pf,
"PowerPointWebEditor.AppForOfficeContentAppsContainer").as("PowerPointWebEditor.IAppForOfficeContentAppsContainer").na(()=>new pf(this.$.resolve("PowerPointWebEditor.IPPTZoomManager"),this.$.resolve("Box4.IPageView").container,this.$.resolve("PowerPointWebEditor.IViewElementHelper"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.$.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"))).ma();
this.$.register(dj,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").na(()=>new dj).ma();this.$.register(Cj,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").na(()=>new Cj(this.$.resolve("PowerPointWebEditor.ICopilotProxy"))).ma();this.$.register(Nh,"PowerPointWebEditor.AppForOfficeManager").as("PowerPointWebEditor.IAppForOfficeManager").na(()=>new Nh(this.$.resolve("PowerPointWebEditor.IApplicationContext"),
this.$.resolve("PowerPointWebEditor.IFrameContext"),new Rd,this.$.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer"),this.$.ge("PowerPointWebEditor.IClassFactory"),this.$.resolve("Box4.Graph.IGraphIteratorFactory"),this.$.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.$.resolve("PowerPointWebEditor.IPPTWorkspace"),this.$.resolve("Box4.IAppFrame"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("Common.IAppSettingsManager"),this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("PowerPointWebEditor.ISlideReader"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),new z,A.getInstance(),this.$.ge("PowerPointWebEditor.IAppforOfficeClassFactory"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IGetDocumentCopyHelper"),this.$.resolve("PowerPointWebEditor.IBusinessBarController"),this.$.resolve("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory"),
this.$.resolve("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory"),this.$.resolve("Common.App.OAuth.IOAuthManager"))).ma();const Sa=new h;this.$.register(Ld,"PowerPointWebEditor.AddinCommandsManager").as("PowerPointWebEditor.IAddinCommandsManager").na(()=>new Ld(this.le,this.$.resolve("PowerPointWebEditor.IAppForOfficeManager"),Sa,this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("Common.IAppSettingsManager"),new Qd,this.$.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
this.$.resolve("Common.IRibbonExternal"),this.$.resolve("Common.IExternalUICommandDefinitionMapping"),this.$.resolve("PowerPointWebEditor.IBusinessBarController"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.$.register(Id,"PowerPointWebEditor.ContextMenuExtensibilityHandler").as("PowerPointWebEditor.IContextMenuExtensibilityHandler").na(()=>new Id(Sa)).ma();this.$.register(Me,"PowerPointWebEditor.AppForOfficeListenerManager").as("PowerPointWebEditor.IAppForOfficeListenerManager").na(()=>
new Me(this.PKm())).ma();this.$.register(Sc,"PowerPointWebEditor.AppforOfficeClassFactory").as("PowerPointWebEditor.IAppforOfficeClassFactory").na(()=>new Sc(this.$.resolve("PowerPointWebEditor.IApplicationContext"),this.$.resolve("PowerPointWebEditor.AppFrame"),this.$.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.$.resolve("Common.IClickInputManager"),this.$.resolve("PowerPoint.IPathManager"),this.$.resolve("PowerPointWebEditor.IInputHandlerManager"),this.$.resolve("PowerPointWebEditor.IAppForOfficeManager"),
this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.$.resolve("PowerPointWebEditor.ITaskPaneManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"))).ma();this.$.register(877,"PowerPointWebEditor.IAddinPaneFrame").ma().na(()=>new Rg(this.$.ge("PowerPointWebEditor.IAppForOfficeFocusManager")));this.$.register(878,"PowerPointWebEditor.IAppForOfficeAuthFactory").ma().na(()=>new Ie)}init(){u.AFrameworkApplication.bZa||
this.$.resolve("Common.IAppSettingsManager").fg(Object(r.a)(this,this.su,"onFullAppSettingsReady"))}su(){this.Hd=this.$.resolve("PowerPointWebEditor.IAppForOfficeManager");this.Hd.plf=!0;this.Hd.h_k=!0;u.AFrameworkApplication.ga.getBooleanAppSetting("OcpsIsEnabled")?this.$.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ma=>{const Sa=this.$.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper");Promise.all([ma.isFeatureEnabled(Ri.mdn,!0),Sa.IV("WACSideloadAddins")]).then(([Zb,
Wc])=>{this.Hd.plf=Zb;this.Hd.h_k=Wc;this.dEe();return null})}):this.dEe()}dEe(){this.$.resolve("PowerPointWebEditor.IAddinCommandsManager");this.$.resolve("PowerPointWebEditor.IAppForOfficeAuthFactory");this.$.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").cJg();this.$.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer").initialize();const ma=this.$.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");ma.cTk();ma.dTk();ma.p1i();this.cWn();this.M1m();this.$.resolve("PowerPointWebEditor.IAppForOfficeManager").initialize()}dispose(){this.$.resolve("PowerPointWebEditor.IAppForOfficeManager").dispose();
this.$.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").dispose()}M1m(){const ma=this.$.resolve("PowerPointWebEditor.IAddinPaneFrame"),Sa=this.$.resolve("PowerPointWebEditor.IFocusManager"),Zb=this.$.resolve("PowerPointWebEditor.IAppForOfficeFocusManager");Sa.pTa(fd.a.rSa,fd.a.vl,ma,!Zb.pLf());this.le.nj.ls()}PKm(){const ma=[];var Sa=[];Sa.push(this.$.resolve("Box4.Graph.IGraphInstance").Sd(47));Sa.push(this.$.resolve("Box4.Graph.IGraphInstance").Sd(10));Sa=new bk(this.$.resolve("PowerPointWebEditor.IAppForOfficeManager"),
Sa,this.$.resolve("Box4.Graph.IGraphIteratorFactory"));ma.push(Sa);Sa=new Fk(this.$.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(49),this.$.resolve("Box4.Graph.IGraphIteratorFactory"));ma.push(Sa);Sa=new xb(this.$.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"));ma.push(Sa);
Sa=new Uh(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(47));ma.push(Sa);Sa=new Ye(this.$.resolve("Box4.Graph.IGraphInstance").Sd(8),this.$.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.$.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"));ma.push(Sa);return ma}cWn(){this.SYd=u.AFrameworkApplication.ga.La("DevAddinManifestFileUrl");this.dnh=u.AFrameworkApplication.ga.La("DevAddinManifestGuid");var ma=u.AFrameworkApplication.ga.La("IsDevAddinTest");
if(this.SYd&&this.dnh&&ma)if(ma="true"===ma,m.a.instance.getItem("optedIntoAddinDeveloperMode")||ma&&u.AFrameworkApplication.ga.getBooleanAppSetting("SuppressDeveloperAddinDialogs"))if(m.a.instance.getItem(this.dnh)||ma&&u.AFrameworkApplication.ga.getBooleanAppSetting("SuppressDeveloperAddinDialogs"))this.Hd.nq.validateAndCacheNewDevAddinManifest(this.SYd);else{ma=new n.a;ma.gf=4;const Sa=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,
this.SYd)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;ma.m7(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,Sa,Object(r.a)(this,this.PXl,"registerDevAddinManifestHandler"))}else ma=Object(r.a)(this,this.PXl,"registerDevAddinManifestHandler"),ma=new pg(this.SYd,ma),ma.gf=0,ma.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage)}PXl(ma){1===ma&&this.SYd&&this.lEn()}lEn(){this.Hd&&
(this.Hd.nq.validateAndCacheNewDevAddinManifest(this.SYd),m.a.instance.setItem(this.dnh,"true"))}static main(){l.a.instance.Fc(new Ri)}}Ri.mdn="mso_officeStore";Object(c.a)(Ri,"AppForOfficePackage",null,[3,4]);var Yi=a(154);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("OSF");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AppForOfficeApi");Object(Yi.c)("AppForOffice");Type.registerNamespace("CommandUI.AddInCommands");Ri.main();Object(Yi.b)("AppForOffice")},
653:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b,f){this.previewControlIds=this.legacyControlId=this.populationProps=this.menuItemId=this.commandRevertId=this.commandPreviewId=this.queryCommandId=this.commandId=this.externalUxCommand=null;this.externalUxCommand=b;this.commandId=f}}Object(x.a)(c,"CommandMetadata",null,[])},894:function(x,G,a){a.d(G,"a",function(){return r});x=a(0);var c=a(17),b=a(180),f=a(4),e=a(47),h=a(7),u=a(5),m=a(380),n=a(284),l=a(250);class r{static UCe(w){const y=
{};y.appSettings=r.mmf();y.singleSignOnSettings=r.SCe();y.appVersion="16";y.appUILocale=b.a.Ne(f.AFrameworkApplication.lcid).Mib;y.dataLocale=b.a.Ne(f.AFrameworkApplication.lcid).Mib;y.osfOmexBaseUrl=f.AFrameworkApplication.ga.La(n.a.cze);y.firstPartyManifestCDNUrl=f.AFrameworkApplication.ga.La(n.a.lze);y.sdxCdnUrl=f.AFrameworkApplication.ga.La(n.a.sdxCdnUrl);y.sdx1CdnUrl=f.AFrameworkApplication.ga.La("Sdx1CdnUrl");y.sdxDmsUrl=f.AFrameworkApplication.ga.La(n.a.sdxDmsUrl);y.forceUseSdx1Cdn=f.AFrameworkApplication.ga.getBooleanAppSetting("ForceUseSdx1Cdn");
y.sovereignFederationDMSToken=f.AFrameworkApplication.ga.La("SovereignFederationDMSToken");y.sovereignFederationDMSTokenSuffix=f.AFrameworkApplication.ga.La("SovereignFederationDMSTokenSuffix");y.sdxAssetsToPrefetchMapping=f.AFrameworkApplication.ga.La(n.a.sdxAssetsToPrefetchMapping);y.docUrl=w?w.documentUrl:"";y.pageBaseUrl=e.a.nN;y.lcid=f.AFrameworkApplication.lcid.toString();y.allowExternalMarketplace=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.T4c);y.localizedScriptsUrl=(f.AFrameworkApplication.aua?
f.AFrameworkApplication.ga.La("StaticContentHostNonOverriden"):e.a.nN)+f.AFrameworkApplication.ga.La(n.a.zbh);w=w?w.UDe:"";y.localizedImagesUrl=e.a.nN+w;y.localizedStylesUrl=e.a.nN+w;y.localizedResourcesUrl=e.a.ZWh(w);y.enableAddinCommands=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.zmc);y.enableMyApps=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.Njh);y.enableMyOrg=f.AFrameworkApplication.ga.getBooleanAppSetting("InsertAgaveMyOrgEnabledForHost");y.enableUploadFileDevCatalog=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.zmc)&&
!f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.iPe);y.enableDevCatalog=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.Jcd);y.devCatalogUrl=f.AFrameworkApplication.ga.La(n.a.ybh);y.enablePrivateCatalog=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.a5c);y.showSignOutFromPrivateCatalogMessage=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.showSignOutFromPrivateCatalogMessage);y.enableBlackForestRedirect=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.Cze);y.enableSingleSignOnForAddin=
f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.mze)&&f.AFrameworkApplication.vfj;y.enableTaskpaneUpgradeToAppCommand=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.eOe);y.hideAppsExtensionUrl=f.AFrameworkApplication.hideAppsExtensionUrl;y.enableAnonymousUseLegacyCatalogService=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.bze);y.enableInsertDialogAccessibilityFix=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.CIe);y.enableFirstPartySDXErrorMessages=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.BIe);
y.disableAppsForOfficeThirdParty=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.oSc);y.wacSessionId=f.AFrameworkApplication.userSessionId;y.disableLogging=!f.AFrameworkApplication.ga.getBooleanAppSetting("AriaLoggingIsEnabled");y.loggableUserId=f.AFrameworkApplication.ga.La("LoggableUserId");y.sessionStartInfoJson=f.AFrameworkApplication.ga.La("SessionStartInfoJson");y.wopiHostOriginFromPostMessage=f.AFrameworkApplication.wopiHostOriginFromPostMessage;y.wopiHostOriginFromWacPropBag=f.AFrameworkApplication.ga.La("PostMessageOrigin");
y.wacIsEmbedded=f.AFrameworkApplication.ga.getBooleanAppSetting("IsEmbedded");y.accessibilityAllowFocusAddinTaskpane=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.accessibilityAllowFocusAddinTaskpane);y.disableMicrophonePermission=h.a.XX(1)&&f.AFrameworkApplication.ga.getBooleanAppSetting("TranscriberSafariEnabled")&&f.AFrameworkApplication.ga.getBooleanAppSetting("RehearsalSafariEnabled");y.isHostFrameTrustCheckEnabledForAddIns=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.GDe);y.isHostFrameTrusted=
f.AFrameworkApplication.isHostFrameTrusted;y.hostAllowedSdxEmbedding=f.AFrameworkApplication.ga.getBooleanAppSetting("HostAllowedSdxEmbedding");y.hostAllowedOfficeStore=f.AFrameworkApplication.ga.getBooleanAppSetting("HostAllowedOfficeStore");y.hostInstallAddIns=f.AFrameworkApplication.ga.La("HostInstallAddIns");y.hostInstallAddInsIsEnabled=f.AFrameworkApplication.ga.getBooleanAppSetting("HostInstallAddInsIsEnabled");y.approvedAddIns=f.AFrameworkApplication.ga.La("ApprovedAddIns");y.is3pAddInsDisabled=
f.AFrameworkApplication.ga.getBooleanAppSetting("Is3pAddInsDisabled");y.isUpnCheckEnabled=f.AFrameworkApplication.ga.getBooleanAppSetting(n.a.isUpnCheckEnabled);y.wacUpn=f.AFrameworkApplication.ga.La("UserPrincipalName");y.isReactRibbonEnabled=!0;y.enableSetFocusOnTaskpaneOnUserAction=!0;y.enableMyOrg&&y.docUrl&&(w=y.docUrl.split("/"),y.spBaseUrl=2<w.length?w[0]+"//"+w[2]:null,y.spBaseUrl||c.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",y.docUrl)));y.userNameHashCode=
u.a.DV(f.AFrameworkApplication.userName);y.envCode=f.AFrameworkApplication.ga.Jc(n.a.Nbd,0).toString();return y}static mmf(){const w={};w.AddinRibbonIdAllowUnknown=f.AFrameworkApplication.ga.getBooleanAppSetting("AddinRibbonIdAllowUnknown");w.AddinRibbonNativeGroupControlIsEnabled=!0;w.AddinRibbonTabAutoFocusIsEnabled=!0;w.AddinRibbonTabPositionIsEnabled=!0;w.AgaveAddinUploadEnabled=f.AFrameworkApplication.ga.getBooleanAppSetting("AgaveAddinUploadEnabled");w.DevConsoleEnabled=f.AFrameworkApplication.ga.getBooleanAppSetting("AddinDevConsoleLog");
w.ManifestParserDevConsoleEnabled=!0;w.flightingTreatmentVariables=f.AFrameworkApplication.ga.uuc;w.DisabledChangeGates=f.AFrameworkApplication.ga.La("DisabledChangeGates");w.DmsSdxListPresentation=f.AFrameworkApplication.Leh;return w}static SCe(){try{const w={};(l.a("FixAddinTeamsBrowserSSO")||h.a.$$a)&&m.a.ykb&&(w.UiHostSupportsAuthTokenAddinList=r.n7c);w.UiHostSupportsAuthToken=m.a.ykb;return w}catch(w){c.ULS.sendTraceTag(512263001,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",
w.message)}return null}}r.n7c="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");Object(x.a)(r,"AppForOfficeHelper",null,[])},895:function(x,G,a){a.d(G,"a",function(){return e});x=a(0);var c=a(17),b=a(413),f=a(4);class e{static q4l(h){return parseInt(e.A8b(b.a.lbh,h)||"-1")<=(new Date).getTime()}static vIi(h){return parseInt(e.A8b(b.a.P4c,
h)||"-1")}static q6i(h){return Boolean.parse(e.A8b(b.a.Gaf,h)||"false")}static A8b(h,u){let m=null;try{const n=e.pwc();if(void 0!==n&&n){const l=b.a.Xuc(h)+u;m=n.getItem(l)}else c.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(n){c.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",h,u)}return m}static s0c(h,u,m){try{const n=e.pwc();if(void 0!==n&&n){const l=b.a.Xuc(h)+m;n.setItem(l,u)}else c.ULS.sendTraceTag(42074647,
220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(n){c.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",h,m)}}static pwc(){if(!e.pEa)return null;let h=null;try{h=localStorage}catch(u){e.pEa=!1,h=null}return h}static Jvl(){switch(f.AFrameworkApplication.Ea.Kb.Im){case 1:return"ExcelOnline";case 2:return"PowerPointOnline";case 3:return"WordOnline";case 4:return"OneNoteOnline";case 5:return"VisioOnline";default:return"Unknown"}}}
e.pEa=!0;Object(x.a)(e,"AddinUtil",null,[])},896:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b[b.notSupported=-1]="notSupported";b[b.OMEX=0]="OMEX";b[b.HRn=1]="spCatalog";b[b.GRn=2]="spApp";b[b.QIm=3]="fileSystem";b[b.exchange=4]="exchange";b[b.oneDrive=5]="oneDrive";b[b.registry=6]="registry";b[b.K0m=7]="inMemory";b[b.RYn=8]="uploadFileDevCatalog";b[b.cYm=9]="hardCodedPreinstall";b[b.DFg=10]="privateCatalog";b[b.b0n=16]="wopiCatalog"})(c||(c={}));Object(x.b)("AddinProviderType",
c)}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.appforoffice.js.map