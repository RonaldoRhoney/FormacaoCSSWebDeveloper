'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[21],{1064:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.Image16by16Class="Image16by16Class";c.Image32by32Class="Image32by32Class";c.On="On";c.LabelText="LabelText";c.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";c.EnsureControlRoleIsButton="EnsureControlRoleIsButton";c.Visible="Visible";Object(x.a)(c,"SplitButtonCommandProperties",null,[])},1115:function(x,G,a){a.d(G,"a",function(){return c});
x=a(0);a=a(875);class c extends a.a{constructor(b,f){super(f);this.Dad=b;this.ita=0}OBe(){const b=(new Date).getTime(),f=b-this.ita;if(0<this.ita&&0>=this.Dad-f)return this.ita=0,this.Poc(),!0;this.ita=b;this.Poc();this.setTimeout(this.Dad);return!1}}Object(x.a)(c,"FunctionDelayer",a.a,[])},1204:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(x.a)(c,"CalloutButtonProps",null,[])},1351:function(x,G,a){a.d(G,"a",
function(){return h});x=a(0);var c=a(68),b=a(22),f=a(249),e=a(263);a(297);class h{constructor(){this.qEa=null}get W8c(){return!1}XSk(u,m){let n=new c.a;const l=new e.GraphTransaction(3);try{l.hd(f.App.Vb.Pd.An.Zg),this.SVf(m)&&(n=this.dPf(m,n)),m!==u&&this.SVf(u)&&(n=this.dPf(u,n))}finally{l&&l.dispose()}return n.toArray()}SVf(u){return!!u}euh(u){let m=!1;for(const n of this.z8i)m||!Sys.UI.DomElement.containsCssClass(u,n.className)&&!Sys.UI.DomElement.containsCssClass(u,n.xJf)||(m=!0),b.a.uub(u,n.className),
b.a.uub(u,n.xJf)}}Object(x.a)(h,"AHighlightActor",null,[1339])},1352:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b,f){this.className=b;this.xJf=f}}Object(x.a)(c,"HighlightCssClassPair",null,[])},1353:function(x,G,a){a.d(G,"b",function(){return e});a.d(G,"a",function(){return h});var c=a(22);a(249);var b=a(263);a(253);a(293);var f=a(297);const e=u=>{const m=new b.GraphTransaction(3);try{m.hd(u),u.Fq(32,!0)}finally{m&&m.dispose()}},h=u=>{if(u){u=c.a.sna(u);if(-1===u.indexOf(f.a.x0)&&
-1!==u.indexOf(f.a.ON)&&-1===u.indexOf(f.a.yAd))return 2;if(-1===u.indexOf(f.a.x0)&&(-1!==u.indexOf(f.a.q6c)||-1!==u.indexOf(f.a.WN)||-1!==u.indexOf(f.a.yAd)||-1!==u.indexOf(f.a.wyd)||-1!==u.indexOf(f.a.NMb)||-1!==u.indexOf(f.a.xAd)||-1!==u.indexOf(f.a.prc)||-1!==u.indexOf(f.a.qrc)||-1!==u.indexOf(f.a.nrc)||-1!==u.indexOf(f.a.orc)||-1!==u.indexOf(f.a.mof)||-1!==u.indexOf(f.a.iof)||-1!==u.indexOf(f.a.jof)||-1!==u.indexOf(f.a.uAd)||-1!==u.indexOf(f.a.gof)))return 1;if(-1!==u.indexOf("WACImageContainer"))return 3}return 0}},
1354:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.type=this.action=0;this.JSc=this.F$a=null}}Object(x.a)(c,"HighlightOperation",null,[])},1680:function(x,G,a){a.r(G);var c=a(0),b=a(17),f=a(68),e=a(134),h=a(4);class u{}u.beginDraftingAsync="OSC:BDA";u.KJm="OSC:FEQ";u.selectComment="OSC:SC";Object(c.a)(u,"CommentTaskNames",null,[]);class m{constructor(db){this.GMa=db;this.Hbn=[]}get handler(){return this.GMa}get mib(){return this.Hbn}}Object(c.a)(m,"RegisteredListener",
null,[]);class n{constructor(db,gc){this.type=0;this.payload=null;this.type=db;this.payload=gc}}Object(c.a)(n,"OfficeSharedCommentsEvent",null,[711]);class l{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(c.a)(l,"ViewContainerEvent",null,[711]);var r=a(1054);class w{constructor(db){this.cFj=!1;this.D3=new f.a;this.Tb=db}CEn(db){db=new m(db);this.D3.add(db)}b9l(db){for(let gc=0;gc<this.D3.count;++gc)if(this.D3.ha(gc).handler===db){this.D3.removeAt(gc);
break}}B5b(db=!1){const gc=()=>{if(h.AFrameworkApplication.mi)b.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let Nb=0;Nb<this.D3.count;++Nb){const hc=this.D3.ha(Nb);for(;0<hc.mib.length;){var Dc=Array.dequeue(hc.mib);if(Object(e.a)(l,Dc)){var Ua=hc.handler;Ua(Dc)}else Object(e.a)(n,Dc)&&(Ua=hc.handler,Ua(Dc.type,Dc.payload))}}};db?gc():this.cFj||(this.cFj=!0,r.a.V9b(this.Tb,()=>{gc();this.cFj=!1},u.KJm))}}Object(c.a)(w,"GenericEventHost",
null,[]);class y extends w{constructor(db){super(db)}YEn(db){this.CEn(db)}OWn(db){this.b9l(db)}k3l(db){db=this.vAm(db);for(let gc=0;gc<this.D3.count;++gc)Array.enqueue(this.D3.ha(gc).mib,db);this.B5b(!0)}vAm(db){const gc=new l;gc.eventType=3;gc.viewContainerVisibilityState=db;return gc}RJm(){const db=this.JCm();for(let gc=0;gc<this.D3.count;++gc)Array.enqueue(this.D3.ha(gc).mib,db);this.B5b(!0)}JCm(){const db=new l;db.eventType=2;return db}}Object(c.a)(y,"ViewContainerEventHost",w,[689]);class z{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(c.a)(z,"BasicEventPayload",null,[1867]);class A{constructor(db){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=db}}Object(c.a)(A,
"CommentContextDetails",null,[]);class B{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(c.a)(B,"ContextChangeWithSelectedThreadIndex",null,[1867]);class H{constructor(){this.tasks=this.comments=null}}Object(c.a)(H,"LoadCommentsNoVirtualization",null,[1867]);class v extends w{constructor(db){super(db);this.wlm=0}FEn(db,gc,Dc,Ua,Nb,hc,Qc=0){db=new m(db);hc&&Array.enqueue(db.mib,
this.pAm(hc,this.wlm));hc=gc?gc.length:0;Array.enqueue(db.mib,this.hml(hc,Dc,Ua,Qc,null));hc&&Array.enqueue(db.mib,this.Eml(gc,Nb));this.D3.add(db);this.B5b()}gWk(db){this.b9l(db)}yxk(db,gc,Dc,Ua=0,Nb=null){this.d9c(this.hml(db,gc,Dc,Ua,Nb));this.B5b()}WJn(db,gc,Dc,Ua,Nb=null){this.d9c(this.xAm(db,gc,Dc,Ua,Nb));this.B5b()}E1l(db,gc,Dc){this.d9c(this.zAm(db,gc,Dc));this.B5b()}Ixk(db,gc){this.d9c(this.Eml(db,gc));this.B5b()}selectComment(db){this.d9c(this.Vml(db,6));this.B5b()}highlightComment(db){this.d9c(this.Vml(db,
7));this.B5b()}Tfd(db,gc){this.d9c(this.vBm(db,gc));this.B5b()}Ewn(db,gc){this.d9c(this.tCm(db,gc));this.B5b()}pAm(db,gc=0){const Dc=new z;Dc.modelCapabilityFlags=db;Dc.richTextCapabilityFlags=gc;return new n(12,Dc)}hml(db,gc,Dc,Ua,Nb=null){const hc=new z;hc.numberOfComments=db;hc.numberOfThreads=gc;hc.contextDetails=Object.assign(new A(Dc),{nextPopulatedContextDetails:Ua});hc.contextDrafts=Nb;hc.rehydrationDrafts=null;return new n(0,hc)}xAm(db,gc,Dc,Ua,Nb=null){const hc=new B;hc.numberOfComments=
db;hc.numberOfThreads=gc;hc.selectedThreadIndex=Dc;hc.contextDetails=Object.assign(new A(Ua),{nextPopulatedContextDetails:0});hc.contextDrafts=Nb;hc.rehydrationDrafts=null;return new n(0,hc)}zAm(db,gc,Dc){const Ua=new z;Ua.comments=db;Ua.numberOfThreads=gc;Ua.tasks=Dc;return new n(2,Ua)}Eml(db,gc){const Dc=new H;Dc.comments=db;Dc.tasks=gc;return new n(1,Dc)}Vml(db,gc){const Dc=new z;Dc.commentId="";db&&(Dc.commentId=db);return new n(gc,Dc)}vBm(db,gc){const Dc=new z;Dc.changes=[];Dc.contextDetails=
Object.assign(new A(gc),{nextPopulatedContextDetails:db});return new n(10,Dc)}tCm(db,gc){const Dc=new z;Dc.commentId=db;Dc.smartReplies=gc;return new n(15,Dc)}d9c(db){for(let gc=0;gc<this.D3.count;++gc)Array.enqueue(this.D3.ha(gc).mib,db)}}Object(c.a)(v,"OfficeSharedCommentsEventHost",w,[322]);var C=a(151);class F{constructor(){this.Lbl=this.pcl=!1;this.Qmm=[]}get xOe(){return this.Qmm}get Eqe(){return this.pcl}set Eqe(db){this.pcl=db;for(const gc of this.xOe)gc.Eqe=db}get Zme(){return this.Lbl}set Zme(db){this.Lbl=
db;for(const gc of this.xOe)gc.Zme=db}V_c(db){for(const gc of this.xOe)db=gc.V_c(db);return db}}Object(c.a)(F,"AggregateCommentTaskPersonTransformer",null,[1889]);var D=a(83);class N{constructor(db,gc,Dc,Ua,Nb=!1){this.priority=this.completion=-1;this.type=db;this.user=gc;this.time=Dc;this.recordId=Ua;this.isLossy=Nb}}Object(c.a)(N,"HistoryRecord",null,[]);class U{constructor(db,gc){this.ujm=new C.a(()=>gc.V_c(db.value))}INm(){return new Date}Kqc(db,gc,Dc){if(0===db)throw b.ULS.sendTraceTag(594650201,
327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const Ua=D.a.create().toString();Dc=new N(db,this.ujm.value,Dc,Ua,!1);Dc.commentId=gc;b.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",db);return Dc}}Object(c.a)(U,"HistoryRecordFactory",null,[1890]);class W{constructor(){this.endDate=this.startDate=null}}Object(c.a)(W,"CommentTaskSchedule",null,[]);class L{constructor(db,
gc,Dc,Ua,Nb,hc){this.isLossy=db;this.title=gc;this.assignees=Dc;this.schedule=Ua;this.completion=Nb;this.priority=hc}}Object(c.a)(L,"CommentTaskState",null,[]);class O{constructor(){this.commentId=null}}Object(c.a)(O,"HistoryItem",null,[]);class M{constructor(db,gc,Dc,Ua,Nb,hc,Qc){this.bLh=!1;if(1!==gc.type)throw Error.argument("createRecord");this.NVe=Dc;this.KVe=Ua;this.LVe=Nb;this.n$k=1;this.K8g=db;this.Xjm=hc;this._state=new L(!1,this.NVe,Qc,new W,this.LVe,this.KVe);this._history=[];this.Kml(gc)}HAe(db,
gc){if(1!==db.type)throw Error.argument("createRecordTemplate");const Dc=M.ZTm(db,this.n$k);this.n$k++;return Object.assign(new N(gc,db.user,db.time,Dc),{commentId:db.commentId})}get EEl(){return this.history[this.history.length-1]}get Syl(){return this.state.completion===this.LVe}get Ryl(){return this.state.priority===this.KVe}get Tyl(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get Uyl(){return this.state.title===
this.NVe}Kml(db){db=Object.assign(new O,{commentId:db.commentId,records:[db]});this.history.push(db)}Itl(db){let gc=-1;for(let Dc=0;Dc<this.state.assignees.length;Dc++)if(this.K8g.equals(this.state.assignees[Dc],db)){gc=Dc;break}return gc}fOn(db){const gc=this.EEl,Dc=gc.records[gc.records.length-1];return this.K8g.equals(Dc.user,db.user)&&gc.commentId===db.commentId&&Dc.time.getTime()===db.time.getTime()?!0:!1}JYn(db){switch(db.type){case 2:-1===this.Itl(db.assignee)&&this.state.assignees.push(db.assignee);
break;case 3:const gc=this.Itl(db.assignee);0<=gc&&this.state.assignees.splice(gc,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=db.schedule;break;case 6:this.state.completion=db.completion;break;case 9:this.state.title=db.title;break;case 10:this.state.priority=db.priority;break;case 0:this.state.isLossy=!0;break;case 1:b.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.bLh=!0;break;case 8:this.bLh=!1;break;case -1:b.ULS.sendTraceTag(51139905,
327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}db.isLossy&&(this.state.isLossy=!0);this.fOn(db)?this.EEl.records.push(db):this.Kml(db)}get isDeleted(){return this.bLh}get state(){return this._state}get history(){return this._history}tPm(db){if(!db)return this.history;const gc=Array.clone(this.history),Dc=gc[0],Ua=Dc.records.shift();if(!this.Xjm){var Nb=this.HAe(Ua,4);Dc.records.unshift(Nb)}!db.Syl&&this.Syl&&(Nb=this.HAe(Ua,6),Nb.completion=this.LVe,Dc.records.unshift(Nb));
!db.Ryl&&this.Ryl&&(Nb=this.HAe(Ua,10),Nb.priority=this.KVe,Dc.records.unshift(Nb));!db.Tyl&&this.Tyl&&(Nb=this.HAe(Ua,5),Nb.schedule=new W,Dc.records.unshift(Nb));!db.Uyl&&this.Uyl&&(Nb=this.HAe(Ua,9),Nb.title=this.NVe,Dc.records.unshift(Nb));db.isDeleted&&(db=this.HAe(Ua,8),Dc.records.unshift(db));return gc}static ZTm(db,gc){return"Synthesized-"+db.recordId+"-"+gc}}Object(c.a)(M,"CommentTaskStateBuilder",null,[]);var K=a(898);class P{constructor(db,gc,Dc,Ua){this.id=db;this.commentId=gc;this.currentState=
Dc;this.history=Ua}}Object(c.a)(P,"CommentTaskItem",null,[]);class V{constructor(db,gc="",Dc="",Ua=""){this.IsCurrentUser=!1;this.UserId=db;this.Provider=gc;this.DisplayName=Dc;this.Email=Ua}}Object(c.a)(V,"CommentTaskPerson",null,[1880]);const Y=db=>{const gc=new V(db.UserId,db.Provider,db.DisplayName,db.Email);gc.IsCurrentUser=db.IsCurrentUser;return gc};var ta=a(1233);a(74);class fa{constructor(db){this.extensions=db}}Object(c.a)(fa,"ExtensionList",null,[]);class Ta{static clone(db){db=Ta.cym(db.extensions);
return new fa(db)}static lkl(db){return db?Ta.clone(db):null}static isEmpty(db){return!db.extensions||!db.extensions.count}static rb(db){return!db||Ta.isEmpty(db)}static cym(db){if(!db)return null;const gc=new ta.a;db.forEach((Dc,Ua)=>{gc.add(Dc,Ua);return!0});return gc}}Object(c.a)(Ta,"ExtensionListExtensions",null,[]);class ha{static clone(db){var gc=Y(db.user);gc=new N(db.type,gc,db.time,db.recordId,db.isLossy);gc.commentId=db.commentId;gc.anchorExtensionList=Ta.lkl(db.anchorExtensionList);gc.recordExtensionList=
Ta.lkl(db.recordExtensionList);db.assignee&&(gc.assignee=Y(db.assignee));if(db.schedule){var Dc=db.schedule;const Ua=new W;Ua.startDate=Dc.startDate;Ua.endDate=Dc.endDate;gc.schedule=Ua}gc.completion=db.completion;gc.title=db.title;gc.priority=db.priority;gc.undoId=db.undoId;return gc}}Object(c.a)(ha,"HistoryRecordExtensions",null,[]);class qa{constructor(db,gc,Dc,Ua,Nb,hc,Qc,$c=!1){this.K8g=db;this.X9g=gc;this.L9b=Dc;this.Bgm=Ua;this.NVe=Nb;this.KVe=hc;this.LVe=Qc;this.W8g=$c}BCm(db,gc,Dc,Ua=null){if(!db)throw b.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!gc)throw b.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!Dc||!Dc.length)throw b.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Dc[0].type)throw b.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var Nb=[],hc=null,Qc=this.pBn(Dc);for(var $c of Dc)if(!Qc.contains($c.recordId))if(Dc=
this.rxl($c.commentId,Ua),Dc=this.gLm($c,Dc),1===Dc.type){let $d=[];this.W8g&&hc&&hc.state&&($d=hc.state.assignees);hc=new M(this.K8g,Dc,this.NVe,this.KVe,this.LVe,this.W8g,$d);Nb.push(hc)}else if(hc)hc.JYn(Dc);else throw b.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");Qc=null;$c=[];if(hc){hc.isDeleted||
(Qc=hc.state);hc=null;for(var Hd of Nb)Nb=Hd.tPm(hc),Array.addRange($c,Nb),hc=Hd}Hd=this.rxl(gc,Ua);Qc&&(Qc.completion=this.Mym(gc,Ua,Qc.completion));return new P(db,Hd,Qc,$c)}SKm(db,gc,Dc,Ua=null){if(!gc)throw b.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Dc&&!db)throw b.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const Nb=[],hc=this.L9b.INm();if(Dc){var Qc=this.L9b.Kqc(1,db,hc);Nb.push(Qc)}Qc=
null;if(gc.assigneeUpdate){if(!gc.assigneeUpdate.assigneesToAdd||!gc.assigneeUpdate.assigneesToRemove)throw b.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var $c=0;$c<gc.assigneeUpdate.assigneesToAdd.length;$c++){var Hd=this.Lml(2,gc.assigneeUpdate.assigneesToAdd[$c],db,hc);Hd&&Nb.push(Hd)}for($c=0;$c<gc.assigneeUpdate.assigneesToRemove.length;$c++)(Hd=this.Lml(3,gc.assigneeUpdate.assigneesToRemove[$c],db,hc))&&Nb.push(Hd)}else gc.assignee&&
(Dc||(Qc=this.L9b.Kqc(4,db,hc),Nb.push(Qc)),$c=this.L9b.Kqc(2,db,hc),Qc=this.X9g.V_c(gc.assignee),$c.assignee=Qc,Nb.push($c));gc.title?(Ua=this.L9b.Kqc(9,db,hc),Ua.title=gc.title,Nb.push(Ua)):Dc&&Ua&&($c=this.L9b.Kqc(9,db,hc),$c.title=this.Bgm.JUm(Ua,Qc),Nb.push($c));if(gc.schedule){if(gc.schedule.startDate>gc.schedule.endDate)throw b.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");Ua=this.L9b.Kqc(5,db,hc);Ua.schedule=gc.schedule;Nb.push(Ua)}if(void 0!==
gc.completion&&null!==gc.completion){Ua=gc.completion;if(0>Ua||100<Ua)throw b.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");Dc||b.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",Ua);Dc=this.L9b.Kqc(6,db,hc);Dc.completion=Ua;Nb.push(Dc)}if(void 0!==gc.priority&&null!==gc.priority){gc=gc.priority;if(0>gc||10<gc)throw b.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");db=this.L9b.Kqc(10,
db,hc);db.priority=gc;Nb.push(db)}return Nb}Lml(db,gc,Dc,Ua){if(2!==db&&3!==db)return b.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;db=this.L9b.Kqc(db,Dc,Ua);db.assignee=this.X9g.V_c(gc);return db}pBn(db){const gc=new K.a,Dc=new K.a;for(let Ua=db.length-1;0<=Ua;Ua--){const Nb=db[Ua],hc=Dc.contains(Nb.recordId);hc||-1!==Nb.type||(Dc.contains(Nb.undoId)?b.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):
Dc.add(Nb.undoId));if(hc||-1===Nb.type)gc.contains(Nb.recordId)?b.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):gc.add(Nb.recordId)}return gc}gLm(db,gc){const Dc=ha.clone(db);Dc.commentId=gc;Dc.user=this.X9g.V_c(db.user);Dc.assignee=this.X9g.V_c(db.assignee);return Dc}Mym(db,gc,Dc){let Ua=Dc;db&&gc&&(({value:gc}=gc.Uh(db)).returnValue?(Ua=gc.ResolveState?100:100===Dc?0:Dc,Ua!==Dc&&b.ULS.sendTraceTag(592719873,327,50,
"Task completion state has been changed to match comment resolution state for comment {0}",db)):b.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",db));return Ua}rxl(db,gc){let Dc=db;db&&gc&&(({value:gc}=gc.Uh(db)).returnValue?Dc=gc.CommentId:(b.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",db),Dc=db));return Dc}}Object(c.a)(qa,"CommentTaskTranslatorImpl",null,[1270]);class ra{constructor(){this.ijd=
{};this.ijd.ops=[]}M2m(db){const gc=this.ijd.ops;if(gc.length){var Dc=gc.length-1;const Ua=gc[Dc];if(!Ua.attributes){Ua.insert+=db;gc[Dc]=Ua;this.ijd.ops=gc;return}}Dc={};Dc.insert=db;Array.add(gc,Dc)}C2m(db,gc,Dc){var Ua={};Ua.fullName=gc.fullName;Ua.email=gc.email;Ua.resolveState=gc.resolveState;gc={};gc.atmention=Ua;db=this.shb(db,gc);Dc&&(Ua={},Ua.contentId=Dc.contentId,Dc={},Dc.atmention=Ua,db.optional=Dc);Array.add(this.ijd.ops,db)}tOf(db,gc){db=this.shb(db,{});const Dc={};Dc.base64=gc.base64;
gc={};gc.image=Dc;db.optional=gc;Array.add(this.ijd.ops,db)}insertHyperLink(db,gc){const Dc={};Dc.link=gc.link;this.LMn(Dc,gc);Array.add(this.ijd.ops,this.shb(db,Dc))}$Nm(){return Sys.Serialization.JavaScriptSerializer.serialize(this.ijd)}shb(db,gc){const Dc={};Dc.insert=db;Dc.attributes=gc;return Dc}LMn(db,gc){this.wme(gc.weight>=ra.rgn,db,"weight",gc.weight);this.wme(gc.italic,db,"italic",!0);this.wme(gc.underline,db,"underline",!0);this.wme(gc.strikethrough,db,"strikethrough",!0);this.wme(!!gc.highlight,
db,"highlight",gc.highlight);this.wme(!!gc.color,db,"color",gc.color);this.wme(!!gc.paragraph,db,"paragraph",gc.paragraph)}wme(db,gc,Dc,Ua){db&&(gc[Dc]=Ua)}static sul(db){return Sys.Serialization.JavaScriptSerializer.deserialize(db,!0)}}ra.rgn=700;Object(c.a)(ra,"DeltaFormatCreator",null,[353]);var I=a(881),ba=a(1530),Ga=a(6);class Oa{constructor(){this.ellipsis=Object(Ga.a)("Ellipsis")}JUm(db,gc){if(!db)throw b.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var Dc=ra.sul(db)}catch(Hd){throw b.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var Ua=db=0,Nb=0;const hc=RegExp("\\s+","g"),Qc=new Sys.StringBuilder;for(var $c of Dc.ops)$c.attributes&&$c.attributes.atmention&&$c.attributes.atmention.email&&gc&&(Dc=$c.attributes.atmention.email,0<Dc.length&&(Dc===gc.UserId||Dc===gc.Email||Dc===I.a.dOb(gc.UserId))&&(Ua=db,Nb=Ua+$c.insert.length)),Dc=$c.insert.replace(hc,
" "),db+=Dc.length,Qc.append(Dc);!Nb&&gc&&b.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",gc.Provider);gc=Qc.toString().trimEnd();db=gc.length;255<db?($c=(255-(Nb-Ua))/2,0>Ua-$c?(db=ba.a.instance.bAf(gc,255-this.ellipsis.length),Nb=gc.substring(0,db)+this.ellipsis,db="Trimmed End"):Nb+$c>db?(Ua=ba.a.instance.MHd(gc,db-255+this.ellipsis.length),Nb=this.ellipsis+gc.substring(Ua,db),db="Trimmed Start"):(Ua=ba.a.instance.MHd(gc,Ua-$c+this.ellipsis.length),db=ba.a.instance.bAf(gc,
Nb+$c-this.ellipsis.length),Nb=this.ellipsis+gc.substring(Ua,db)+this.ellipsis,db="Trimmed Both")):(db="No Trim",Nb=gc);b.ULS.sendTraceTag(592998804,327,50,db);return Nb}}Object(c.a)(Oa,"ContentExtractor",null,[]);class Ja{constructor(db,gc){this.tim=db;this.vjm=gc;this.Zme=this.Eqe=!1}V_c(db){if(!db)return null;if(void 0===db.UserId||null===db.UserId)throw b.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(db.IsCurrentUser||!this.tim.equals(this.vjm.value,
db))return db;db=Y(db);db.IsCurrentUser=!0;return db}}Object(c.a)(Ja,"EnsureIsCurrentUserSetTransformer",null,[1889]);class Qa{constructor(){this.Zme=this.Eqe=!1}V_c(db){if(!db)return null;if(void 0===db.UserId||null===db.UserId)return db;if(!db.Email||""===db.Email){let gc;if(gc=I.a.dOb(db.UserId))return db=Y(db),db.Email=gc,db}return db}}Object(c.a)(Qa,"RestoreEmailTransformer",null,[1889]);class Pa{constructor(){this.Zme=this.Eqe=!1}V_c(db){if(!db)return null;if(void 0!==db.UserId&&null!==db.UserId)return db;
switch(this.Eqe?this.Zme?2:1:0){case 0:if(void 0===db.UserId||null===db.UserId)throw b.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");db=Y(db);break;case 1:if(void 0===db.Id||null===db.Id)throw b.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===db.Email||null===db.Email)throw b.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var gc=Pa.jTl(db.Id,db.Email,null);
if(!gc||""===gc)throw b.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var Dc=h.AFrameworkApplication.ga.La("HostAuthType")||"";if("aad"!==Dc.toLowerCase()||gc.startsWith("S::")){if("msa"===Dc.toLowerCase())throw b.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");b.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Dc)}else throw b.ULS.sendTraceTag(593368211,327,
10,"Unexpected UserID format"),Error.argument("userId");db=new V(gc,"AD",db.DisplayName,db.Email);break;case 2:if(void 0===db.UserPrincipalName||null===db.UserPrincipalName)throw b.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==db.SuggestionSubtype&&null!==db.SuggestionSubtype)if("OrganizationUser"===db.SuggestionSubtype)gc="AD";else throw b.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",
db.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw b.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Dc=Pa.jTl(db.Id,db.UserPrincipalName,db.AadObjectId);if(!Dc||""===Dc)throw b.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===gc&&!Dc.startsWith("S::"))throw b.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");
db=new V(Dc,gc,db.Name,db.UserPrincipalName);break;default:throw b.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return db}static jTl(db,gc,Dc){if(!gc||""===gc)return b.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),db;if(Dc&&""!==Dc)return"S::"+gc+"::"+Dc;if(!db||""===db)return b.ULS.sendTraceTag(593368217,327,50,"Missing ID"),db;if(db.startsWith("S::"))return db;if(-1!==db.indexOf("@")){Dc=db.split("@");if(D.a.isValid(Dc[0]))return"S::"+gc+"::"+
Dc[0];b.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return db}}Object(c.a)(Pa,"UserIdCanonicalizationTransformer",null,[1889]);class ja{constructor(db,gc,Dc=!1,Ua=!1){this.shm=db;this.U4k=gc;this.yjm=Dc;this.W8g=Ua}uAm(){const db=new I.a;var gc=new C.a(ja.ENm);const Dc=new F;this.U4k&&(Dc.xOe.push(new Pa),Dc.xOe.push(new Qa));this.shm&&Dc.xOe.push(new Ja(db,gc));Dc.Eqe=this.U4k;Dc.Zme=this.yjm;gc=new U(gc,Dc);const Ua=new Oa;return new qa(db,Dc,gc,Ua,ja.qDm,ja.oDm,
ja.pDm,this.W8g)}static ENm(){const db=new V(h.AFrameworkApplication.ga.La("PresenceUserId")||"",h.AFrameworkApplication.ga.La("PresenceProvider")||"",h.AFrameworkApplication.userName||"");db.IsCurrentUser=!0;return db}}ja.qDm="";ja.oDm=5;ja.pDm=0;Object(c.a)(ja,"CommentTaskTranslatorFactory",null,[1879]);class va{constructor(){this.PSh=this.g4k=!1;this.Xxe=this.RI=this.L7k=this.p9k=this.bdl=this.$$k=this.vcl=this.m5k=this.LW=this.m6e=null}initialize(db,gc,Dc,Ua=null,Nb=null,hc=null,Qc=null,$c=null,
Hd=null,$d=null){this.LW=db;this.m5k=gc;this.vcl=Dc;this.$$k=Ua;this.bdl=Nb;this.p9k=hc;this.L7k=Qc;this.RI=$c;this.g4k=!0;this.Xxe=Hd;this.m6e=$d}xEe(){if(!this.g4k)return b.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((db,gc)=>{gc(r.a.lG(-2130915313))});if(this.PSh)return b.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.m6e||
(h.AFrameworkApplication.ga.getBooleanAppSetting("DynamicBundlesIsEnabled")?this.m6e=appResourceLoader.loadChunk("sharedComments"):this.m6e=this.LW.loadScript("sharedComments"));return this.m6e.then(()=>{this.isn()})}isn(){this.PSh||(this.Xxe&&this.Xxe.execute(db=>{db.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),sharedComments.instantiate(this.m5k,this.vcl,this.$$k,this.bdl,this.p9k,this.L7k,this.RI));this.PSh=!0}}Object(c.a)(va,"CommentActivationManager",
null,[1881]);class Ha{constructor(){this.actionBehavior=this.actionType=0}}Object(c.a)(Ha,"CommentUIActionPayload",null,[]);var gb=a(416);class Gb{constructor(db,gc){this.k4c=(Dc,Ua,Nb,hc,Qc)=>{if(this.MDh.Ob(Dc)){var $c=this.MDh.ha(Dc);if(!this.Fgd.Ob($c))return 8;const Hd=this.Fgd.ha($c);if(Hd.preCallback){const $d=Hd.preCallback(Dc,Ua,Nb,hc,Qc);if(2!==$d)return $d}if(!Hd.registeredCallback)return 1===Nb?8:2;$c=Object.assign(new Ha,{actionType:$c});1===Nb&&($c.actionBehavior=1);$c=Hd.registeredCallback($c);
return Hd.postCallback?Hd.postCallback($c,Dc,Ua,Nb,hc,Qc):$c?32:8}return 2};this.ya=db;this.Fgd=gc;this.MDh=new gb.a;for(const Dc of this.Fgd)this.MDh.K(Dc.value.canvasActionId,Dc.key),db=Dc.value,db.delayActionsUntilRegistration||this.za(db)}za(db){db.withFlags?this.ya.sa(db.canvasActionId,db.canvasContextId,this.k4c,97):this.ya.za(db.canvasActionId,db.canvasContextId,this.k4c)}LCb(db,gc){this.Fgd.Ob(db)&&(this.Fgd.ha(db).delayActionsUntilRegistration&&this.za(this.Fgd.ha(db)),this.Fgd.ha(db).registeredCallback=
gc)}}Object(c.a)(Gb,"OfficeSharedCommentsActionHost",null,[1860]);var Mb=a(73),hb=a(10),Da=a(49);class Bb{}Object(c.a)(Bb,"CommentActivityData",null,[]);var Za=a(43),mb=a(41);class vb{constructor(db,gc,Dc,Ua,Nb,hc,Qc,$c,Hd,$d=null,ue=null){this.Idl={["CancelCommentCreateThreadAction"]:hb.a.P3l,["CommitComment"]:hb.a.Q3l,["CommitDraftAction"]:hb.a.R3l,["CommitDraftCreateAction"]:hb.a.JEk,["CommitDraftEditAction"]:hb.a.KEk,["CommitDraftReplyAction"]:hb.a.IEk,["CreateReplyAction"]:hb.a.IEk,["CreateReplyWithMentions"]:hb.a.S3l,
["CreateReplyWithTaskAssigned"]:hb.a.T3l,["CreateThreadAction"]:hb.a.JEk,["CreateThreadWithMentions"]:hb.a.U3l,["CreateThreadWithTaskAssigned"]:hb.a.V3l,["DeletePostAction"]:hb.a.W3l,["DeleteThreadAction"]:hb.a.X3l,["DeleteThreadWithTask"]:hb.a.Y3l,["DiscardDraftAsync"]:hb.a.Z3l,["PresentLinkToCommentAction"]:hb.a.$3l,["ResolveThreadAction"]:hb.a.d4l,["ResolveThreadWithTask"]:hb.a.e4l,["ReopenThreadAction"]:hb.a.a4l,["ReopenThreadWithTask"]:hb.a.b4l,["RequestInitCommentSession"]:hb.a.c4l,["SelectCommentAction"]:hb.a.f4l,
["UpdateCommentBodyAction"]:hb.a.KEk};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=db;this.appVersion=gc;this.releaseAudience=Dc;this.releaseChannel=Ua;this.sessionId=Nb;this.ring=hc;this.dataCenter=Qc;this.disableUpload=$c;this.sovereignEnvironmentName=ue;this.ya=Hd;this.bal=$d;this.s2m()}s2m(){this.ya.za(hb.a.P3l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.Q3l,
mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.R3l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.IEk,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.S3l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.T3l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.JEk,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.U3l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.V3l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.W3l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.X3l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.Y3l,
mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.Z3l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.$3l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.d4l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.e4l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.a4l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.b4l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.c4l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.f4l,mb.a.frame,Da.ActionManager.Ii);this.ya.za(hb.a.KEk,mb.a.frame,Da.ActionManager.Ii)}sendULSTrace(db,
gc,Dc,Ua){b.ULS.sendTraceTag(db,gc,Dc,Ua)}recordActivity(db){this.Idl[db]&&this.ya.Cb(this.Idl[db],2)}sendOtelEvent(db){Za.a.sendOtelEvent(db)}recordPerfData(db,gc){this.bal&&(db=Object.assign(new Bb,{durationMs:gc,name:db}),this.bal.sUa(db))}}Object(c.a)(vb,"OfficeSharedCommentsTelemetry",null,[]);var sb=a(180);class bc{constructor(db,gc,Dc,Ua){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=db;this.appLocale=gc;this.uiCulture=Dc;this.dataCulture=Ua}}
Object(c.a)(bc,"LocalizationDetails",null,[]);var yb=a(485),uc=a(3),vc=a(13);class wc{constructor(db,gc){this.lnm=db;this.A6k=gc}getViewContainer(){return this.lnm}registerForViewContainerEvents(db){this.A6k.YEn(db)}unregisterForViewContainerEvents(db){this.A6k.OWn(db)}}Object(c.a)(wc,"ViewContainerProvider",null,[687]);var ub=a(118),aa=a(231),Na=a(40),ia=a(20),wa=a(249),pa=a(406),Ea=a(372),La=a(248),Aa=a(383),nb=a(1008);class Wa{static Xul(db){return db===Wa.create?0:db===Wa.reply?1:db===Wa.edit?
2:db===Wa.metadata?3:null}}Wa.create="CREATE";Wa.reply="REPLY";Wa.edit="EDIT";Wa.metadata="METADATA";Object(c.a)(Wa,"CommentSessionType",null,[]);class ea{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(c.a)(ea,"InitCommentSessionResult",null,[]);class Kb extends ea{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(c.a)(Kb,"BeginDraftingHostResult",ea,[]);class kc{constructor(db,gc="",
Dc="",Ua="",Nb=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=db;this.Provider=gc;this.DisplayName=Dc;this.Email=Ua;this.IsCurrentUser=Nb}}Object(c.a)(kc,"OfficeSharedCommentUser",null,[]);var ac=a(5),eb=a(19),Hb=a(36),ua=a(250);class Va{constructor(db,gc,Dc){this.As=db;this.Dbn=gc;this.jbn=Dc;this.cIl=null;this.LJl=!1}get S5c(){return this.As}get Y4(){return this.Dbn}get commentId(){return this.jbn}get nib(){return this.cIl}set nib(db){this.cIl=db}get hlh(){return this.LJl}set hlh(db){this.LJl=
db}}Object(c.a)(Va,"ActiveCommentSession",null,[]);var Yb=a(1103);class Cb{static get $fn(){return 50}static ULm(db){return Cb.WMm(db)}static DRm(db){if(""===db)return"";let gc=0,Dc="";try{const Ua=ra.sul(db);for(const Nb of Ua.ops)if(Cb.Wxa(Nb))gc||(Dc+=Cb.dPm(Nb.attributes.atmention.fullName)),gc+=1;else{const hc=Nb.insert?Nb.insert:"";" "!==hc&&0<hc.length&&(gc=0,Dc+=hc)}}catch(Ua){b.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return Dc}static WMm(db){db=
Cb.DRm(db);return 0<db.length&&db.split(" ").length<=Cb.$fn?db:null}static dPm(db){let gc="";db&&(db=db.split(" "),0<db.length&&(gc=db[0]));return gc}static Wxa(db){return!!db.attributes&&!!db.attributes.atmention}}Object(c.a)(Cb,"BaseCommentSmartReplyHelpers",null,[]);class ca{constructor(db){this.vCj=db}a_n(db,gc,Dc,Ua){-1===Dc||gc||(gc=Ua[Dc],Dc=gc.author?gc.author.IsCurrentUser:!1,gc&&gc.commentBody&&!Dc&&(gc=Cb.ULm(gc.commentBody))&&this.vCj.invoke(db,gc))}}Object(c.a)(ca,"CommentSmartReplyHelpers",
null,[]);var Ra=a(7),bb=a(286),wb=a(253),Fa=a(291),rb=a(292),$b=a(264);class ec{constructor(){this.fIh=this.TTh=this.y3c=null;this.Qyl=!1;this.zyh=this.Ayh=this.endPos=this.startPos=0}get paragraphs(){return this.y3c}get PQa(){return this.TTh}set PQa(db){this.TTh=db;this.y3c=[];this.y3c.push(this.TTh)}get $Sa(){return this.fIh}set $Sa(db){this.fIh=db;this.y3c&&this.WUf&&this.y3c.push(this.fIh)}qIm(){for(const db of this.y3c){const gc=Object(aa.a)(427,db);if(gc&&-1!==gc.f8c().indexOf("\ufffc"))return!0}return!1}$Dl(db){const gc=
(this.zyh&4294967295)>>>0;db.TextBodyLength!==this.Ayh||gc===db.TextBodyHash||ec.B0l.contains(this.zyh)||(ec.B0l.add(this.zyh),La.a.J(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",this.qIm()));return db.TextBodyLength===this.Ayh}get $Wl(){let db=0;if(this.isValid)if(this.WUf){db+=wb.ParagraphReader.textLength(this.PQa)-this.startPos;db+=this.endPos;for(let gc=1;gc<this.paragraphs.length-1;gc++){const Dc=this.paragraphs[gc];Dc&&
(db+=wb.ParagraphReader.textLength(Dc)+1)}}else db=this.endPos-this.startPos;return db}get $Qa(){if(!this.isValid)return Fa.a.auto;var db=$b.a.yj(this.PQa,this.startPos+1);if(!db)return Fa.a.auto;db=rb.a.xs(db);return db?(db=db.cache)&&db.m3?db.fontColor:Fa.a.auto:Fa.a.auto}get isValid(){return!!this.PQa&&!!this.$Sa&&!!this.paragraphs}get WUf(){return!this.PQa.equals(this.$Sa)}Dah(db){this.y3c&&db&&this.y3c.push(db)}d3m(){if(this.isValid&&(this.PQa.Fq(16,!0),this.WUf))for(let db=1;db<this.paragraphs.length;db++){const gc=
this.paragraphs[db];gc&&gc.Fq(16,!0)}}b4m(db,gc){if(!this.isValid)return!1;const Dc=Object(aa.a)(bb.AParagraphNode,db.node),Ua=Object(aa.a)(bb.AParagraphNode,gc.node);return!(Dc&&Ua&&Array.contains(this.paragraphs,Dc)&&Array.contains(this.paragraphs,Ua))||Dc.equals(this.PQa)&&(0>db.Va||db.Va<this.startPos)||Ua.equals(this.$Sa)&&(0>gc.Ib||gc.Ib>this.endPos)?!1:!0}zul(db){let gc=3;db&&(!this.WUf&&this.PQa.equals(db)?gc=2:this.PQa.equals(db)?gc=0:this.$Sa.equals(db)&&(gc=1));return gc}}ec.B0l=new K.a;
Object(c.a)(ec,"TextAnchorParagraphInfo",null,[]);class pc{static NBe(db,gc){return db||gc?db&&gc?db.commentId===gc.commentId:!1:!0}static Ifh(db){return!!db.Children&&0<db.Children.length}static mRm(db,gc){db=db.f8c()+"\r";for(let Dc=0;Dc<db.length;Dc++){let Ua=db.charCodeAt(Dc);160===Ua&&(Ua=32);gc=(gc<<5>>>0)+gc+Ua}return gc}static Iwa(db){return!!db&&!!db.textAnchoringInfo&&db.textAnchoringInfo.EndPos>db.textAnchoringInfo.StartPos&&0<db.textAnchoringInfo.TextBodyLength}static LHf(db,gc){if(!pc.Iwa(db))return null;
if(!gc||1>gc.wI().length)return La.a.J(509220243,805,gc?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!gc),null;let Dc=null,Ua=null,Nb=null;db.textAnchoringInfo.AnchoringShape&&(db.textAnchoringInfo.AnchoringShape.TableCell?(Dc=D.a.Xf(db.textAnchoringInfo.AnchoringShape.TableCell.RowId),Ua=D.a.Xf(db.textAnchoringInfo.AnchoringShape.TableCell.ColId)):db.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&(Nb=db.textAnchoringInfo.AnchoringShape.SmartArtNodeId,
Nb.startsWith("{")||(Nb="{"+Nb),Nb.endsWith("}")||(Nb+="}")));let hc=db.textAnchoringInfo.StartPos;db=db.textAnchoringInfo.EndPos;let Qc=0,$c=0;const Hd=new ec;gc=gc.wI();for(let ue=0;ue<gc.length;ue++){const Fe=gc[ue],cf=wb.ParagraphReader.textLength(Object(aa.a)(bb.AParagraphNode,Fe));if(Dc&&Ua){var $d=Fe.KV();if(!$d||!Dc.equals($d.rowId)||!Ua.equals($d.cellId))continue}else if(Nb&&(!Fe.get_smartArtModelId()||Nb!==Fe.get_smartArtModelId()))continue;if(!Hd.isValid&&(cf>hc||Hd.PQa)){if(!Hd.PQa&&(Hd.PQa=
Object(aa.a)(bb.AParagraphNode,Fe),Hd.startPos=hc,!Hd.PQa))return null;$d=ue===gc.length-1||!!Nb&&pc.r5m(Nb,gc[ue+1])||!!Dc&&!!Ua&&pc.q5m(Dc,Ua,gc[ue+1]);$d=cf<db&&0<cf&&$d;if((cf>=db||$d)&&!Hd.$Sa){if($d&&(db=cf),Hd.$Sa=Object(aa.a)(bb.AParagraphNode,Fe),Hd.endPos=db,!Hd.$Sa)return null}else Fe.equals(Hd.PQa)||Hd.Dah(Object(aa.a)(bb.AParagraphNode,Fe))}Qc+=cf+1;$c=pc.mRm(Fe,$c);Hd.PQa||(hc-=cf+1);db-=cf+1}Hd.Ayh=Qc;Hd.zyh=$c;return Hd}static r5m(db,gc){return gc.get_smartArtModelId()&&gc.get_smartArtModelId()===
db?!1:!0}static q5m(db,gc,Dc){return(Dc=Dc.KV())&&db.equals(Dc.rowId)&&gc.equals(Dc.cellId)?!1:!0}static lUm(db,gc,Dc,Ua){Dc=Ua=-1;if(!db)return La.a.J(509220242,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),{returnValue:null,vDb:Dc,Tzb:Ua};let Nb=Object(aa.a)(427,gc.Xa.node);const hc=Object(aa.a)(427,gc.mf.node);if(!Nb||!hc)return La.a.J(509220241,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",
!Nb,!hc),{returnValue:null,vDb:Dc,Tzb:Ua};const Qc=gc.Xa.e9a,$c=gc.mf.sJb;var Hd=wb.ParagraphReader.textLength(gc.Xa.node);gc=wb.ParagraphReader.textLength(gc.mf.node);if(0>Qc||0>=$c||Qc===$c&&Nb===hc||Qc>Hd||$c>gc)return La.a.J(509220240,805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",Qc,$c,Hd,gc),{returnValue:null,vDb:Dc,Tzb:Ua};db=db.wI();if(!db)return La.a.J(509220239,805,
15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),{returnValue:null,vDb:Dc,Tzb:Ua};Hd=0;for(const $d of db){if(hc.get_smartArtModelId()){if($d.get_smartArtModelId()!==hc.get_smartArtModelId())continue;Nb.get_smartArtModelId()!==hc.get_smartArtModelId()&&(Nb=$d)}if(hc.kt()){if($d.KV()!==hc.KV())continue;Nb.KV()!==hc.KV()&&(Nb=$d)}Nb===$d&&(Dc=Qc+Hd);hc===$d&&(Ua=$c+Hd);if(0<=Dc&&0<=Ua)return{returnValue:Nb,vDb:Dc,Tzb:Ua};Hd+=$d.f8c().length+1}0<=
Dc&&-1===Ua&&(Nb.get_smartArtModelId()||Nb.kt())&&(Ua=Hd-1);return{returnValue:Nb,vDb:Dc,Tzb:Ua}}static get fch(){return Ra.a.zg||Ra.a.vTa}static get Lfh(){return!Ra.a.lk}}Object(c.a)(pc,"CommentUtilities",null,[]);const dd=(db,gc)=>{var Dc,Ua;if(null===db||void 0===db||!db.ReactionList)return db;for(const Nb in db.ReactionList)db.ReactionList[Nb].ReactionInstances=null===(Ua=null===(Dc=db.ReactionList[Nb])||void 0===Dc?void 0:Dc.ReactionInstances)||void 0===Ua?void 0:Ua.filter(hc=>hc.User.UserId!=
gc.UserId);db.ReactionList=db.ReactionList.filter(Nb=>0!=Nb.ReactionInstances.length);0==db.ReactionList.length&&(db.ReactionList=void 0);return db},Ad=db=>db.getBooleanAppSetting("PPTOCommentReactionsUIEnabled");var Jb=a(284);class Bc{constructor(db,gc,Dc,Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee,xe,cg){this.Moh=!1;this.vd=db;this.icc=gc;this.bEj=Dc;this.Ean=Ua;this.Tb=Nb;this.Fb=hc;this.rqh=Qc;this.lbn=$c;this.mcc=Hd;this.vCj=ue;this.Mbn=Fe;this.$bc=cf;this.Q5d=Ee;this.hbn=xe;this.ia=cg}beginDraftingAsync(db){if(!db)return new Promise((Dc,
Ua)=>{Ua(r.a.lG(-2130915327))});const gc=Wa.Xul(db.sessionType);return void 0===gc||null===gc?new Promise((Dc,Ua)=>{Ua(r.a.lG(-2130915317))}):2===gc&&db.commentId===Bc.uIe?new Promise((Dc,Ua)=>{Ua(r.a.lG(-2130915324))}):new Promise((Dc,Ua)=>{r.a.V9b(this.Tb,()=>{this.vd.MA.isVisible||this.vd.Y6b();var Nb=this.vd.ORi(),hc=null;let Qc=-1;La.a.J(512496833,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",gc);try{switch(gc){case 0:if(this.Q5d)try{Qc=this.vd.Vul(!0)}catch(ue){La.a.J(512496832,
801,10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",ue),Qc=Nb.length}else Qc=Nb.length;hc=new Va(gc,db,"");this.Moh=!0;break;case 1:if(!db.threadId||!db.threadId.length)throw r.a.lG(-2130915324);Qc=Bc.BPm(Nb,db.threadId);if(-1===Qc)throw r.a.lG(-2130915323);if(this.Fb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var $c=db.threadId;(new ca(this.vCj)).a_n($c,Bc.eYm(Nb,$c),Bc.$Oi(Nb,$c),Nb)}hc=new Va(gc,db,db.threadId);break;case 2:if(!db.commentId||
!db.commentId.length)throw r.a.lG(-2130915324);Qc=Bc.$Oi(Nb,db.commentId);if(-1===Qc)throw r.a.lG(-2130915323);hc=new Va(gc,db,db.commentId);break;case 3:Qc=Bc.$Oi(Nb,db.threadId);hc=new Va(gc,db,db.threadId);break;default:throw r.a.lG(-2130915322);}if(!hc)throw r.a.lG(-2130915322);var Hd=this.vd.a1m(hc);if(Hd)throw Hd;}catch(ue){Ua(ue);return}Nb=new Kb;hc=this.Fb.La("UserName");Hd=this.Fb.La(Jb.a.lPa);$c=this.Fb.La(Jb.a.L2b);const $d=ua.a("PPTPlumbEmailThroughCG")?I.a.dOb(Hd||""):"";Hd=new kc(Hd,
$c,hc,$d,!0);Nb.author=Hd;Nb.insertIndex=Qc;Nb.authorName=hc;Nb.authorIdentity=new String;Dc(Nb)})})}commit(db,gc,Dc){if(!this.vd.KAe)throw La.a.J(512496803,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.vd.Bym),r.a.lG(-2130915320);var Ua=this.vd.KAe.Y4;if(!Ua)throw La.a.J(512496802,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),r.a.lG(-2130915320);const Nb=Wa.Xul(Ua.sessionType);if(void 0===Nb||null===Nb)throw r.a.lG(-2130915317);
if(db!==Ua.draftId)throw r.a.lG(-2130915327);const hc=this.$bc?Hb.e(D.a.create().toString()):"";this.vd.uol();switch(Nb){case 0:return La.a.J(512496801,805,50,"CommentAPI::Commit - Create Comment {0}",hc),Ua={},this.vd.ZGn(hc),Ua.commentId=hc,this.Moh=!1,this.vd.kOl=hc,Bc.l8l(Dc),Bc.k8l(),this.createComment(gc,Ua,Dc);case 1:return La.a.J(512496800,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",Ua.threadId,hc),db={},db.parentId=Ua.threadId,db.commentId=hc,Bc.l8l(Dc),Bc.k8l(),this.createComment(gc,
db,Dc);case 2:return La.a.J(512496799,805,50,"CommentAPI::Commit - Edit comment {0}",Ua.commentId),Dc={},Dc.commentBody=gc,this.pXn(Ua.commentId,Dc),db;case 3:return La.a.J(512496798,805,50,"CommentAPI::Commit - Update Metadata {0}",Ua.threadId),Ad(this.Fb)?this.qXn(Ua.threadId,Dc):this.s9l(Ua.threadId,Dc),Ua.threadId;default:throw r.a.lG(-2130915322);}}endCommentSession(db){La.a.J(512496797,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",db);this.vd.endCommentSession(db,this.Moh?9:1);this.Moh=
!1}createComment(db,gc,Dc){const Ua=this.rqh.Xyh(db,new Date);let Nb="";this.$bc&&(Nb=ac.a.rb(gc.commentId)?D.a.create().toString():gc.commentId);let hc=null;void 0!==Dc&&null!==Dc&&(hc=this.rqh.gVn(Nb,Dc.Task,db));db=this.vd.Avh;if(Dc=gc.parentId?null:this.vd.mUm())db=this.vd.NJn;this.icc.Wnm(Nb,Ua.plainText,gc.parentId,db,this.vd.anchorNode,Ua.iOl,hc,Dc);return ac.a.rb(Nb)?Bc.uIe:Nb}deleteComment(db){if(db===Bc.uIe)throw r.a.lG(-2130915327);La.a.J(512496796,805,50,"CommentAPI::DeleteComment - {0}",
db);this.icc.deleteComment(db)}selectComment(db){this.vd.MA.isVisible||this.vd.Y6b();db!==Bc.uIe&&this.vd.hDb(db,0,!1)}highlightComment(db){db!==Bc.uIe&&this.vd.Gnm(db)}r9l(db,gc,Dc){const Ua=Array.clone(this.vd.ORi());var Nb=null;for(var hc of Ua)if(hc.commentId===db){Nb=hc;break}if(!Nb)throw La.a.J(512496795,805,10,"Comment ID not found, UI and model in a mismatched state."),r.a.lG(-2130915323);(hc=h.AFrameworkApplication.userName)&&0<hc.length&&hc!==Nb.author.DisplayName&&La.a.J(512496794,805,
50,"Author of comment being edited is not the current user (isAnonymous={0})",h.AFrameworkApplication.dfc||h.AFrameworkApplication.a1);hc=new Date;Nb=this.rqh.Xyh(Nb.commentBody,null).plainText;gc=this.rqh.Xyh(gc.commentBody,hc);this.icc.VFm(gc.plainText,db,gc.iOl);Dc||Nb!==gc.plainText||this.bEj.E1l(Ua,this.vd.JOl,Array.clone(this.vd.Kvl()))}pXn(db,gc){if(db===Bc.uIe)throw r.a.lG(-2130915327);gc.commentBody&&(this.Fb.getBooleanAppSetting(Jb.a.Bbd)?this.r9l(db,gc,!0):r.a.V9b(this.Tb,()=>{this.r9l(db,
gc,!1)}))}qXn(db,gc){if(!((null===gc||void 0===gc?0:gc.Resolve)||(null===gc||void 0===gc?0:gc.Reaction)))throw r.a.lG(-2130915327);(null===gc||void 0===gc?0:gc.Resolve)&&this.s9l(db,gc);(null===gc||void 0===gc?0:gc.Reaction)&&this.sXn(db,gc)}s9l(db,gc){if(void 0===gc.Resolve||null===gc.Resolve)throw r.a.lG(-2130915327);const Dc=gc.Resolve.isResolved;let Ua=Dc?100:0;void 0!==gc.Task&&null!==gc.Task&&(Ua=gc.Task.completion);this.icc.t9l(db,Dc?1:0,Ua);Dc&&this.vd.lLn()}sXn(db,gc){if(Ad(this.Fb)){if(null==
(null===gc||void 0===gc?void 0:gc.Reaction))throw r.a.lG(-2130915327);a:{switch(gc.Reaction.reactionType){case 1:var Dc="\ud83d\udc4d";break a;default:La.a.J(509220244,805,50,"Unsupported reaction type")}Dc=void 0}void 0!==Dc&&(this.icc.tXn(db,Dc,gc.Reaction.isActive),this.vd.Non())}}setThreadResolvedState(db,gc){this.icc.t9l(db,gc?1:0,gc?100:0);gc&&this.vd.Unl(db)}selectFirstThreadInNextCommentContext(){this.vd.FJn()}selectLastThreadInPreviousCommentContext(){this.vd.HJn()}presentLinkToComment(db){var gc=
this.icc.rTm(db);gc?(db=JSON.stringify({["sId"]:gc.sid,["cId"]:gc.cid,["commentId"]:ua.a("FixDeepLinkedCommentsPPTO")&&this.icc.CPb(db)?db:void 0}),gc={},gc.nav=Yb.a(db),gc.mode="copy",La.a.J(512496792,805,50,"PresentLinkToComment: nav:{0}",db),this.ia.Qa(hb.a.dEa,2,gc)):La.a.J(512496793,805,50,"PresentLinkToComment failed")}registerForCommentEvents(db){this.hbn.zQm().then(gc=>{this.bEj.FEn(db,this.vd.ORi(),this.vd.JOl,this.vd.isReadOnly,this.vd.Kvl(),gc,this.lbn.Hlh)})}unregisterForCommentEvents(db){this.bEj.gWk(db)}registerForAction(db,
gc){this.Ean.LCb(db,gc);this.vd.WDn()}unregisterForAction(){}loadThreads(){La.a.J(512496791,805,10,"LoadThreads is not supported on WAC")}checkAtMentionCapability(){return new Promise(db=>{h.AFrameworkApplication.ga.fg(()=>{this.mcc?this.mcc.atMentionsEnabledAsync().then(gc=>{db(gc);return null}):db(!1)})})}resolveSupported(){return this.Mbn}static BPm(db,gc){let Dc=!1;for(let Ua=0;Ua<db.length;Ua++){if(Dc&&db[Ua].commentId!==gc&&db[Ua].parentId!==gc)return Ua;db[Ua].commentId===gc&&(Dc=!0)}return Dc?
db.length:-1}static eYm(db,gc){let Dc=!1;for(let Ua=0;Ua<db.length;Ua++)if(db[Ua].commentId===gc&&(Dc=!0),Dc&&db[Ua].parentId===gc)return!0;return!1}static $Oi(db,gc){for(let Dc=0;Dc<db.length;Dc++)if(db[Dc].commentId===gc)return Dc;return-1}static k8l(){if(ua.a("CommentsFpsIsEnabled"))try{const db=eb.a.instance.Na("Common.ISystemInitiatedFeedback");db&&db.execute(gc=>{gc.logActivity("PPTWebCommitNewCommentActivity","CommentsFpsIsEnabledBRS")})}catch(db){La.a.J(512496790,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",
db)}}static l8l(db){if(ua.a("CommentsTasksFpsIsEnabled")&&db&&db.Task)try{const gc=eb.a.instance.Na("Common.ISystemInitiatedFeedback");gc&&gc.execute(Dc=>{Dc.logActivity("PPTWebCommitTaskActivity","CommentsTasksFpsIsEnabledBRS")})}catch(gc){La.a.J(512496789,805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",gc)}}}Bc.uIe="temp-id";Object(c.a)(Bc,"CommentAPI",null,[1311,1312]);var Mc=a(94),ed=a(495),Yc=a(1354);class ab{constructor(db,gc,Dc){this.nBg=db;this.commentId=
gc;this.state=Dc}}Object(c.a)(ab,"CommentTextAnchorToHighlight",null,[]);class jb extends Sys.EventArgs{constructor(db){super();this.A3l=db}}Object(c.a)(jb,"CommentsVisibilityOnSmartArtChangeEventArgs",Sys.EventArgs,[]);class cc{constructor(db,gc,Dc,Ua,Nb,hc,Qc,$c,Hd,$d){this.RLl=[];this.Pqh=null;this.$wh=!1;if(!$d)throw Error.argumentNull("viewElementEventNotifier");this.Lc=gc;this.JOj=this.Wog=!1;this.Tmh=db;this.den=Dc;this.BYd=this.N$c=null;this.Hz=Ua;this.pa=Nb;this.ITa=hc;this.eFc=Qc;this.qBb=
$c;this.kbn=Hd;this.QF=$d;this.qBb.mJg(this.kbn)}get OSa(){return this.N$c&&this.N$c.isConnected?this.N$c:null}get E5l(){return this.Wog}TRg(db,gc,Dc=!1,Ua=!1){const Nb=this.den.w$(db);if(Nb)switch(gc){case 0:Nb.display(Dc,Ua);this.N$c=db;break;case 1:Nb.activate();this.BYd=db;break;case 2:Nb.dismiss();this.N$c=null;break;case 3:this.OSa&&this.OSa===db&&this.JAd&&this.sCi(this.JAd,db)?Nb.display(pc.Iwa(this.JAd),Ua):Nb.dismiss();this.BYd=null;break;case 4:Nb.dFm(Dc),this.N$c=db}}xwh(db){if(this.Lc&&
this.Lc.Yc)switch(db){case 0:this.Lc.Yc.highlight();this.Wog=!0;break;case 2:this.Lc.Yc.LVk();this.Wog=!1;break;case 1:this.Lc.Yc.highlight();this.JOj=!0;break;case 3:this.Lc.Yc.LVk(),this.JOj=!1}}oeh(){this.Tmh&&(this.Wog?this.xwh(2):this.OSa&&this.TRg(this.OSa,2),this.VAe(null))}sCi(db,gc){if(!pc.Iwa(db))return!0;db=this.Hz.I0();return Mc.a.any(db,Dc=>!pc.Iwa(Dc)&&Dc.anchorShape===gc.get_shapeId())}Iwk(db,gc,Dc,Ua=!1,Nb=!1){if(this.Tmh&&db&&(!Ua||cc.dBe(this.Hz.I0(),db))){Ua=this.Vib(db);var hc=
this.OSa!==Ua&&!!this.OSa;hc&&this.pa.PZ(this.OSa);this.oeh();if(Ua){const Qc=pc.Iwa(db);this.BYd===Ua?this.sCi(db,Ua)?this.TRg(Ua,4,Qc,Qc&&hc):this.N$c=Ua:this.sCi(db,Ua)?this.TRg(Ua,0,Qc,Dc&&hc):this.N$c=Ua;gc=!!gc&&gc===db.commentId;(Qc||gc)&&Nb||this.VJn(Ua,String.format(ResourceStrings.L_CommentAnchoringShapeSelection,db.authorName,db.dt.toDateString(),db.dt.toLocaleTimeString()))}else this.xwh(0),this.Lc&&this.Lc.Yc&&this.Lc.Yc.zd&&this.Dvh(String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,
(this.Lc.Yc.zd.ph+1).toString(),this.Lc.Yc.zd.title));!Nb&&hc&&this.pa.selectShape(this.OSa,!0,!1);this.VAe(null)}}Fnm(db){if(this.Tmh){var gc=this.Vib(db);gc?pc.Iwa(db)?this.BYd=gc:this.TRg(gc,1):this.xwh(1);this.VAe(db)}}heh(){this.BYd&&this.TRg(this.BYd,3);this.JOj&&!this.Wog&&this.xwh(3);this.VAe(null)}Vib(db){if(!db)return null;try{return this.eFc.Lgh(db)}catch(gc){return La.a.J(512496788,805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",gc),null}}VAe(db){const gc=
[];var Dc=this.BYd;db&&!Dc&&(Dc=this.OSa);const Ua=this.OSa?this.OSa:this.pa.lo();Ua||db&&Dc||this.j8l(gc);let Nb=null;const hc=[];var Qc=!1;if(pc.Iwa(db)&&Dc&&0<Dc.wI().length&&(!this.JAd||db.commentId!==this.JAd.commentId)){var $c=pc.LHf(db,Dc);$c&&$c.isValid&&(Qc=ed.a.Xf("{"+db.commentId+"}{1}"),gc.push(new ab($c,Qc,1)),Qc=!0,Dc=this.eFc.Ak(Dc))&&(hc.push(Dc),(Dc=Dc.shapeNode)&&Dc.rg&&(Nb=Dc))}if(this.$wh||Ua&&0<Ua.wI().length)if(Dc=this.Hz.I0())for(var Hd of Dc){if(!pc.Iwa(Hd)||!this.$wh&&Hd.anchorShape!==
Ua.get_shapeId()||Qc&&Hd.commentId===db.commentId)continue;$c=this.$wh?this.Vib(Hd):Ua;if(!$c)continue;const $d=pc.LHf(Hd,$c);if(!$d||!$d.isValid)continue;let ue=5;(Dc=!!this.JAd&&Hd.commentId===this.JAd.commentId)&&(ue=0);const Fe=ed.a.Xf("{"+Hd.commentId+"}{1}");gc.push(new ab($d,Fe,ue));if($c=this.eFc.Ak($c))hc.push($c),$c=$c.shapeNode,!Nb&&$c&&Dc&&$c.rg&&(Nb=$c)}for(const $d of this.RLl)!$d||Array.contains(hc,$d)||$d.shapeNode&&$d.shapeNode.rg||($d.wRf=!1,$d.isLocked||!$d.Ho||$d.Tx||$d.G7b());
db=null;for(const $d of hc)(Hd=$d.shapeNode)&&Hd.rg?(db||(db=Hd),Nb||Ua!==Hd||(Nb=Hd)):($d.wRf=!0,$d.Ho||(La.a.J(512496787,805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),$d.ifd()));Nb||this.pa.$K()||!db||(Nb=db);this.RLl=hc;this.QF.DWl(new jb(Nb));this.j8l(gc)}j8l(db){db=Object.assign(new Yc.a,{action:0,type:0,F$a:db,JSc:this.qBb.vDc?this.qBb.vDc.F$a:null});this.qBb.HMe(db)}Dvh(db){this.ITa.JCb(db)}VJn(db,gc){this.ITa.rik(db,gc)}tzk(db){this.Tmh=
db}get JAd(){return this.Pqh&&this.Pqh.sMe?this.Pqh.sMe.comment:null}static dBe(db,gc){if(db)for(const Dc of db)if(gc.commentId===Dc.commentId)return!0;return!1}}Object(c.a)(cc,"CommentAnchoringHighlightsHelper",null,[]);var Hc=a(260);class Vc{constructor(db,gc,Dc,Ua,Nb,hc,Qc){this.oc=db;this.va=gc;this.Knh=Dc;this.Vya=Ua;this.fen=Nb;this.Db=hc;this.Tb=Qc;this.R8k=0}Tfd(db,gc){if(db||1!==this.Hlh)if(2>this.oc.hl())this.Jnm?this.iBk(5):this.iBk(1);else{const Dc=Hc.a.Fk("UpdateNextPopulatedContextDetails",
2);this.Knh.iEi((Ua,Nb,hc)=>{this.Jpn(Ua,Nb,hc,Dc,gc)},Dc)}}get Hlh(){return this.R8k}Jpn(db,gc,Dc,Ua,Nb){let hc=1;if(this.va.Ga){const Qc=this.va.Ga.ph;let $c=!1,Hd=!1,$d=!1;gc&&db&&(db=db.ph,db<Qc?$c=!0:db===Qc?Hd=!0:($d=!0,Dc||($c=!0)));0<=Nb&&(Nb<Qc?$c=!0:Nb===Qc?Hd=!0:$d=!0);$d?hc=$c||Hd?3:2:$c?hc=4:Hd&&(hc=5)}this.iBk(hc);Ua.finish();r.a.V9b(this.Tb,()=>{this.Db.Zf()})}iBk(db){this.R8k=db;this.fen.Tfd(db,1===this.Db.mode)}get Jnm(){return!!this.va.Ga&&this.Vya.yFm(this.va.Ga)}}Object(c.a)(Vc,
"CommentContextDetailsUpdateHelper",null,[1272]);var Tc=a(256);class cd{mLn(db){if(null===db)throw Error.argumentNull("comment");db.setValue(Tc.a.commentId,"")}iLn(db,gc){if(null===db)throw Error.argumentNull("comment");db.setValue(Tc.a.eAe,gc)}kLn(db){if(null===db)throw Error.argumentNull("comment");if(db=Object(aa.a)(586,db))db.Fzb=ResourceStrings.anonymousCommentAuthor}NMe(db){if(null===db)throw Error.argumentNull("comment");db.setValue(Tc.a.R5c,!0)}f2l(db,gc,Dc,Ua){if(null===db)throw Error.argumentNull("comment");
if(db=Object(aa.a)(586,db))db.authorName=gc,db.authorId=Dc,db.zdf=Ua}oLn(db,gc){if(null===db)throw Error.argumentNull("comment");db.setValue(Tc.a.Xpc,gc)}nLn(db,gc){if(!db)throw Error.argumentNull("comment");gc=ia.c(gc);db.setValue(Tc.a.reactions,gc)}}Object(c.a)(cd,"CommentEditor",null,[1308]);var Lb=a(252),Rc=a(288),md=a(274);class Zc{constructor(){this.anchorShape=0;this.dt=this.commentId=this.Children=this.changesData=this.authorName=null;this.isUnread=!1;this.reactions=this.providerId=this.pos=
null;this.status=0;this.userId=this.textAnchoringInfo=this.text=this.taskInfo=null}}Object(c.a)(Zc,"Comment",null,[]);var ld=a(438),fe=a(1192),Ac=a(414),R=a(275),za=a(251);class X{constructor(db,gc,Dc,Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee,xe){this.iBb=null;this.F$c=Ua;this.Mb=Nb;this.va=hc;this.t3=Qc;this.Anb=$c;this.Fb=Hd;this.Pb=$d;this.pa=ue;this.Pca=Fe;this.K1f=cf;this.nc=Ee;this.ZTa=xe;this.K3=db;this.ibn=Dc;this.Lbn=0===gc;this.j9l();this.Mvj()}dispose(){}get userName(){return this.Fb.appSettings.UserName}get userId(){return this.Fb.appSettings[Jb.a.lPa]}get providerId(){return this.Fb.appSettings[Jb.a.L2b]}get nmb(){return this.Fb.getBooleanAppSetting(R.a.nmb)}get GCl(){return ua.a("Comments.LogTasksTelemetry")}get tCi(){return this.Fb.getBooleanAppSetting("SlideResizePerfImprovementEnabled")}addComment(db,
gc,Dc){this.Ndl("",db,gc,Dc,null,null,null,null)}Wnm(db,gc,Dc,Ua,Nb,hc,Qc,$c){this.Ndl(db,gc,Dc,Ua,Nb,hc,Qc,$c)}Ndl(db,gc,Dc,Ua,Nb,hc,Qc,$c){const Hd=this.K3.wl("UserAction","AddComment");h.AFrameworkApplication.ga.p3?this.Pdl(db,gc,Dc,Ua,Nb,hc,Qc,$c,Hd):this.Fb.fg(()=>{this.Pdl(db,gc,Dc,Ua,Nb,hc,Qc,$c,Hd)})}Pdl(db,gc,Dc,Ua,Nb,hc,Qc,$c,Hd){this.ibn.Vzd().then($d=>{X.x0l&&(La.a.J(512262931,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",this.Lbn,$d),this.Pca.S9m($d),
X.x0l=!1);this.Vnm(db,gc,Dc,Ua,Nb,hc,Qc,$c);Hd&&Hd.stop();return $d}).catch($d=>{La.a.J(512262930,805,10,JSON.stringify($d));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}Vnm(db,gc,Dc,Ua,Nb,hc,Qc,$c){if(this.FEe()){var Hd=!1,$d=0,ue=0;Ua&&(Hd=!0,$d=Ua.x,ue=Ua.y);Ua=this.Mb.qe(15);try{var Fe=this.iBb;Ua.rc(Fe);const cf=Lb.GraphIterator.pb(Fe),Ee=Object(aa.a)(Rc.a,this.F$c.createInstance(1074135127));this.Anb.NMe(Ee);this.Anb.mLn(Ee);this.Anb.iLn(Ee,db);Fe=
null;const xe=Object(aa.a)(586,Ee);if(xe){if(xe.Gzb=Hd)xe.BIa=Object.assign(new fe.a,{X:$d,Y:ue});xe.Fyh=this.K1f.jxl();xe.qvd=hc;if(Fe=Object(aa.a)(426,Nb))xe.syd=Fe.get_shapeId();Dc&&(xe.WOa=Dc);Qc&&(xe.taskInfo=Qc);$c&&(xe.textAnchoringInfo=$c);xe.wYa=gc}let cg=this.userId;Nb=!cg;const Gg=!this.providerId,Of=!this.userName;(Nb||Gg)&&La.a.J(512262928,805,Nb&&!Gg?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",Nb,Gg,Of);ua.a("Comments.UseNameInPlaceOfUserId")&&Nb&&
!Gg&&(cg=Of?ResourceStrings.anonymousCommentAuthor:this.userName);this.Anb.f2l(Ee,this.userName,cg,this.providerId);Of&&this.Anb.kLn(Ee);cf.fl(Ee,1);La.a.J(512262927,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",db,!!Qc,!!$c,!!Fe)}finally{Ua&&Ua.dispose()}this.C9m(db,Dc,gc,$c,Qc)}else La.a.J(512262929,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable")}C9m(db,gc,
Dc,Ua,Nb){this.GCl?gc?(gc=this.CPb(gc))?(gc=this.Hac(gc))?this.Pca.D9m(db,Dc.length-1,!!Ua,gc.taskInfo,Nb):La.a.J(512262925,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):La.a.J(512262926,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):this.Pca.E9m(db,Dc.length-1,!!Ua,!!Nb):this.Pca.rvj(db,Dc.length-1,!!Ua,!!Nb)}deleteComment(db){this.Pca.Q$m();if(this.FEe()){var gc=this.Mb.Fd(15);try{gc.rc(this.iBb),this.qti(db,this.iBb),
gc.sc=za.a.deleteComment}finally{gc&&gc.dispose()}}else La.a.J(512262924,805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")}qti(db,gc){ua.a("IsDeselectShapeOnDeleteCommentEnabled")&&this.pa.g8()&&(La.a.J(512262923,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),this.pa.Ti());const Dc=this.UMm(db,gc);if(Dc&&0<Dc.count){this.Anb.NMe(gc);for(const Ua of Dc)gc=Lb.GraphIterator.pb(Ua),gc.pc(39),gc.Bi();La.a.J(512262922,
805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",db)}else La.a.J(512262921,805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",db);this.Pca.GDn()}fNb(){const db=Date.now();this.Pca.U9m();const gc=this.I0();if(gc){var Dc=this.Mb.Fd(15);try{Dc.rc(this.va.Ga);for(const Ua of gc)this.qti(Ua.commentId,this.iBb);Dc.sc=za.a.fNb}finally{Dc&&Dc.dispose()}La.a.J(512262919,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-db)}else La.a.J(512262920,
805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide")}Ppf(db){const gc=Date.now();db?this.Pca.V9m():this.Pca.T9m();const Dc=this.va.presentation;if(Dc){var Ua=Dc.slides;if(Ua){var Nb=this.Mb.Fd(15);try{Nb.rc(Dc);for(const hc of Ua){const Qc=Object(aa.a)(32,hc);if(!Qc||!Qc.JV()){La.a.J(512262918,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",Qc);continue}const $c=Lb.GraphIterator.pb(Qc).Bb(16);for(const Hd of this.Iac(Qc.JV()))(db?
1===Hd.status:1)&&this.qti(Hd.commentId,$c)}Nb.sc=db?za.a.Orc:za.a.Nrc}finally{Nb&&Nb.dispose()}La.a.J(512262917,805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-gc,db)}}}VFm(db,gc,Dc){this.UFm(db,gc,Dc)}UFm(db,gc,Dc){if(this.FEe()){var Ua=this.CPb(gc);if(Ua){const Nb=this.Mb.qe(15);try{Nb.rc(Ua);this.Anb.NMe(Ua);const hc=Object(aa.a)(586,Ua);hc&&(hc.wYa=db,hc.qvd=Dc)}finally{Nb&&Nb.dispose()}La.a.J(512262915,805,50,"CommentManager::EditCommentInternal - Edited comment {0}",
gc)}else La.a.J(512262914,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",gc);this.Pca.Z9m()}else La.a.J(512262916,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable")}F9d(db,gc){if(this.FEe()){var Dc=this.CPb(db);if(Dc){if(null===gc)throw Error.argumentNull("pos");const Ua=this.Mb.qe(15);try{Ua.rc(Dc),this.Anb.NMe(Dc),Object(aa.a)(586,Dc).BIa=Object.assign(new fe.a,{X:gc.x,Y:gc.y})}finally{Ua&&Ua.dispose()}La.a.J(512262912,805,50,"CommentManager::MoveComment - Moved comment {0}",
db)}else La.a.J(512262883,805,10,"CommentManager::MoveComment - Failed to find comment node {0}",db);this.Pca.r$m(db)}else La.a.J(512262913,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")}tXn(db,gc,Dc){this.Fb.fg(()=>{this.uXn(db,gc,Dc)})}uXn(db,gc,Dc){if(this.FEe()){var Ua=this.CPb(db);if(Ua){var Nb=this.Mb.qe(15);try{Nb.rc(Ua);this.Anb.NMe(Ua);const $d=Object(aa.a)(586,Ua);if($d){var hc=$d.reactions,Qc={DisplayName:this.userName,Email:void 0,FullName:this.userName,ProviderId:this.providerId,
UserId:this.userId};if(Dc){let ue;ue=dd(hc,Qc);a:{db=ue;var $c;const Fe={Time:new Date,User:Qc};if(db&&db.ReactionList){for(const [cf,Ee]of db.ReactionList.entries())if(Ee.Type===gc){null===($c=db.ReactionList[cf].ReactionInstances)||void 0===$c?void 0:$c.push(Fe);ue=db;break a}db.ReactionList.push({Type:gc,ReactionInstances:[Fe]})}else db={ReactionList:[{Type:gc,ReactionInstances:[Fe]}]};ue=db}var Hd=ue}else Hd=dd(hc,Qc);this.Anb.nLn(Ua,Hd)}else La.a.J(509215366,805,10,"CommentManager::updateCommentReactionsInternal - Failed to cast to comment node {0}",
db)}finally{null===Nb||void 0===Nb?void 0:Nb.dispose()}}else La.a.J(509219337,805,10,"CommentManager::updateCommentReactionsInternal - Failed to find comment node {0}",db)}else La.a.J(509613472,805,10,"CommentManager::updateCommentReactionsInternal - CommentContentNode is unavailable")}t9l(db,gc,Dc){if(this.FEe()){var Ua=this.CPb(db);if(Ua){const Nb=this.Mb.qe(15);try{Nb.rc(Ua),this.Anb.NMe(Ua),this.Anb.oLn(Ua,gc),Object(aa.a)(586,Ua).bcb=Dc,this.nmb&&this.Anb.f2l(Ua,this.userName,this.userId,this.providerId)}finally{Nb&&
Nb.dispose()}if(this.GCl){Dc=this.Hac(Ua);if(!Dc){La.a.J(512262881,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");return}1===gc?this.Pca.E$m(!!Dc.taskInfo):0===gc&&this.Pca.kan(!!Dc.taskInfo)}else 1===gc&&this.Pca.F$m();La.a.J(512262880,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",db,gc)}else La.a.J(512262879,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",db)}else La.a.J(512262882,805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}I0(){return this.Iac(this.iBb)}Iac(db){const gc=
[];if(!db||39!==db.type)return gc;db=Lb.GraphIterator.pb(db);for(var Dc=db.hj();Dc;){if(40===Dc.type){const Ua=Object(aa.a)(586,Dc).WOa;Dc=this.Hac(Dc);if(Ua)for(const Nb of gc)Nb.commentId===Ua&&(Nb.Children||(Nb.Children=[]),Nb.Children.push(Dc));else gc.push(Dc)}Dc=db.hp()}return gc}j9l(){const db=this.va.Ga;this.iBb=db?Lb.GraphIterator.pb(db).Bb(16):null}lPm(){if(!this.iBb)return!1;const db=Lb.GraphIterator.pb(this.iBb);if(this.t3.UKi(this.iBb))return!0;let gc=db.hj();for(;gc;){if(this.t3.UKi(gc))return!0;
gc=db.hp()}return!1}bJm(db,gc){return this.Wrl(db,gc,!1)}eJm(db,gc){return this.Wrl(db,gc,!0)}Wrl(db,gc,Dc){if(!db)return null;if(db=db.JV()){db=this.Pb.Hc(db);let Ua=Dc?db.Txc():db.hj();for(;Ua;){if(!(this.t3.WTd(Ua)||gc&&0!==this.t3.iBf(Ua)))return this.Hac(Ua);Ua=Dc?db.Msa():db.hp()}}return null}yFm(db){return db?(db=db.JV())?!!this.Pb.Hc(db).hj():!1:!1}uCe(db){if(!db)return 0;var gc=db.JV();db=0;if(gc){gc=this.Pb.Hc(gc);let Dc=gc.hj();for(;Dc;)this.t3.WTd(Dc)||db++,Dc=gc.hp()}return db}FEe(){return!!this.iBb&&
this.iBb.isConnected}UMm(db,gc){gc=Lb.GraphIterator.pb(gc);var Dc=gc.hj();const Ua=new f.a;for(;Dc;){const Nb=this.t3.ahh(Dc),hc=Object(aa.a)(586,Dc).WOa;db!==Nb&&db!==hc||Ua.add(Dc);Dc=gc.hp()}return Ua}CPb(db){const gc=Lb.GraphIterator.pb(this.iBb);let Dc=gc.hj();for(;Dc;){const Ua=this.t3.ahh(Dc);if(db===Ua)return Dc;Dc=gc.hp()}return null}eUi(db){db=this.CPb(db);if(!db)return null;const gc=Object(aa.a)(586,db).WOa;return ac.a.rb(gc)?db:this.CPb(gc)}Hac(db){const gc=Object(aa.a)(586,db);if(!gc)return null;
const Dc=new Zc;Dc.dt=gc.n6c;Dc.text=gc.wYa;Dc.status=this.t3.iBf(db);Dc.userId=gc.authorId;Dc.commentId=this.t3.ahh(db);Dc.authorName=gc.authorName;Dc.providerId=gc.zdf;Dc.anchorShape=gc.syd;Dc.pos=Object.assign(new ld.a,{X:gc.BIa.X,Y:gc.BIa.Y});Dc.taskInfo=gc.taskInfo;Dc.textAnchoringInfo=gc.textAnchoringInfo;Dc.changesData=gc.changesData;Dc.isUnread=this.ZTa.instance&&this.ZTa.instance.Y3m(gc);Ad(this.Fb)&&(Dc.reactions=gc.reactions);return Dc}TGd(db){if(!db)return[];const gc=this.Iac(db.JV());
if(!gc||this.tCi&&!gc.length){if(!gc)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");return gc}gc.sort((Dc,Ua)=>{var Nb=this.nc.KGf(db,Dc.anchorShape);Nb=Nb?Nb.MR:new md.a(0,0);var hc=this.nc.KGf(db,Ua.anchorShape);hc=hc?hc.MR:new md.a(0,0);Nb.y+=Dc.pos.Y;hc.y+=Ua.pos.Y;Nb.x+=Dc.pos.X;hc.x+=Ua.pos.X;let Qc=Nb.y-hc.y;Qc||(Qc=Nb.x-hc.x)||(Qc=+Dc.dt-+Ua.dt);return Qc});return gc}rTm(db){var gc=this.va.presentation;if(!gc)return null;gc=gc.slides;if(!gc)return null;
for(const Dc of gc)if(gc=Object(aa.a)(Ac.a,Dc))for(const Ua of this.Iac(gc.JV())){if(db===Ua.commentId)return Dc;if(Ua.Children)for(const Nb of Ua.Children)if(db===Nb.commentId)return Dc}return null}Mvj(){let db=0,gc=0;var Dc=this.va.presentation;if(Dc){var Ua=Dc.slides;if(Ua){Dc=new f.a;for(const Nb of Ua)if((Ua=Object(aa.a)(Ac.a,Nb))&&Ua.JV())for(const hc of this.Iac(Ua.JV()))pc.Iwa(hc)?gc+=1:hc.textAnchoringInfo&&Dc.add(hc.commentId),db+=1;this.Pca.Mvj(db,gc,Dc)}}}}X.x0l=!0;Object(c.a)(X,"CommentManager",
null,[1309,1310,24]);var lb=a(318);class oc{constructor(db,gc,Dc,Ua){this.Vya=db;this.Lc=gc;this.xb=Dc;this.Ac=Ua}bTm(db){if(null===db)throw Error.argumentNull("comment");if(db=this.Lgh(db))if(db=this.Ak(db))return db.ta.ta;return null}SLm(db){if(null===db)throw Error.argumentNull("comment");if(db=this.Lgh(db)){if(db.Zc){var gc=this.Ac.NQ(db);if(!gc)return La.a.J(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",db.get_shapeId()),null;gc=gc.tc(this.xb.Oa);
return gc&&gc.htmlElement?lb.a.ufa(new Sys.UI.Bounds(gc.htmlElement.clientLeft,gc.htmlElement.clientTop,gc.htmlElement.clientWidth,gc.htmlElement.clientHeight)):(La.a.J(595133521,805,10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",db.get_shapeId()),null)}if(db=this.Ak(db))return db=db.ta.ta,lb.a.ufa(new Sys.UI.Bounds(db.clientLeft,db.clientTop,db.clientWidth,db.clientHeight))}return null}Lgh(db){if(null===db)throw Error.argumentNull("comment");if(!db.anchorShape)return null;
db=this.Vya.eUi(db.commentId);db=this.Vya.Hac(db);if(!db)return null;const gc=this.Lc.Yc?this.Lc.Yc.zd:null;return gc?gc.uC(db.anchorShape):(La.a.J(557090388,805,50,"ActiveSlide is null"),null)}TLm(db){if(null===db)throw Error.argumentNull("comment");if(!db.anchorShape)return 0;if(db=this.Lgh(db))if(db=this.Ak(db))return db.rotation;return 0}Ak(db){if(null===db)throw Error.argumentNull("shapeNode");return Object(aa.a)(284,db.tc(this.xb.Oa))}}Object(c.a)(oc,"CommentMarkerAnchorHelper",null,[1266]);
var Oc=a(719),sd=a(309);class Ld{constructor(db,gc,Dc){this.eka=db;this.Lc=gc;this.tCj=Dc}xFm(db){const gc=Object(aa.a)(586,this.tCj.CPb(db.commentId));if(!gc)throw b.ULS.sendTraceTag(508360530,805,10,"There is no graph node for comment {0}",db.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");return!!gc.BIa}kSm(db,gc){if(!db)throw Error.argumentNull("commentMarkerViewElement");if(!gc)throw Error.argumentNull("comment");if(!this.tCj.CPb(gc.commentId))return b.ULS.sendTraceTag(508360529,
805,10,"GetRenderingPosition: There is no graph node for comment {0}",gc.commentId),new md.a(0,Number.MIN_VALUE);const Dc=db.wt;db=db.ush;if(!this.xFm(gc)||!gc.pos.X&&!gc.pos.Y){if(Dc)return gc=new md.a(Dc.Bd-Dc.Ic-Ld.pvh.width-Ld.w0l.width,Ld.w0l.height),Ld.Fyl(gc,Dc,db),gc;if(this.Lc.Yc&&this.Lc.Yc.rr)return new md.a(this.Lc.Yc.rr.clientWidth-Ld.pvh.width,0);b.ULS.sendTraceTag(508360528,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");
return new md.a(0,0)}gc=new md.a(this.eka.ke(gc.pos.X,0),this.eka.ke(gc.pos.Y,1));gc=new md.a(gc._x-Ld.aed._x,gc._y-Ld.aed._y);Dc&&(gc._x=Math.max(0,gc._x),gc._y=Math.max(0,gc._y),gc._x=Math.min(gc._x,Dc.Bd-Dc.Ic-Ld.pvh.width),gc._y=Math.min(gc._y,Dc.xd-Dc.Xc-Ld.pvh.height),Ld.Fyl(gc,Dc,db));return gc}rXn(db,gc){var Dc=new md.a(db.element.offsetLeft,db.element.offsetTop);Dc=new md.a(Dc._x+Ld.aed._x,Dc._y+Ld.aed._y);const Ua=db.wt;Ua&&db.ush%360&&Ld.Mgl(Dc,0-db.ush,Ua.ej());gc.pos.X=this.eka.vf(Dc._x,
0);gc.pos.Y=this.eka.vf(Dc._y,1);this.tCj.F9d(gc.commentId,new md.a(gc.pos.X,gc.pos.Y))}static Fyl(db,gc,Dc){if(gc&&Dc%360){var Ua=new md.a(db._x+Ld.aed._x,db._y+Ld.aed._y);Ld.Mgl(Ua,Dc,gc.ej());db.update(Ua._x-Ld.aed._x,Ua._y-Ld.aed._y)}}static Mgl(db,gc,Dc){db.vS(0-Dc._x,0-Dc._y);gc=Oc.a.R$b(gc);db.update(db._x*Math.cos(gc)-db._y*Math.sin(gc)+Dc._x,db._x*Math.sin(gc)+db._y*Math.cos(gc)+Dc._y)}}Ld.pvh=new sd.a(20,20);Ld.w0l=new sd.a(4,4);Ld.aed=new md.a(4,20);Object(c.a)(Ld,"CommentMarkerPositionHelper",
null,[1267]);var Qd=a(366),Id=a(135),he=a(268);class xb{constructor(db,gc){this.VLc=this.BJc=this.BKj=null;this.d1f=db;this.ty=gc}vv(){return!0}ru(db){if(!db)return!1;this.VLc=this.d1f.element.style;this.BKj=new md.a(db.clientPoint.x,db.clientPoint.y);this.BJc=new md.a(parseInt(this.VLc.left),parseInt(this.VLc.top));this.Bv(db);return!0}Bv(db){if(!db)return!1;db=this.xvl(new md.a(db.clientPoint.x,db.clientPoint.y),this.BKj);this.VLc.left=he.a.Uc(this.BJc._x+db._x);this.VLc.top=he.a.Uc(this.BJc._y+
db._y);return!0}Pn(db){if(db){db=this.xvl(new md.a(db.clientPoint.x,db.clientPoint.y),this.BKj);var gc=this.BJc._x+db._x,Dc=this.BJc._y+db._y,Ua=this.d1f.wt;Ua&&(gc=Math.max(Ua.Ic,gc),gc=Math.min(Ua.Bd-this.d1f.element.clientWidth,gc),Dc=Math.max(Ua.Xc,Dc),Dc=Math.min(Ua.xd-this.d1f.element.clientHeight,Dc),db._x=gc-this.BJc._x,db._y=Dc-this.BJc._y);this.VLc.left=he.a.Uc(gc);this.VLc.top=he.a.Uc(Dc);this.d1f.UNl(db)}}Ut(){this.VLc.left=he.a.Uc(this.BJc._x);this.VLc.top=he.a.Uc(this.BJc._y)}xvl(db,
gc){db=md.a.tu(db,gc);return new md.a(this.ty.Nr(db.x),this.ty.Nr(db.y))}}Object(c.a)(xb,"CommentMarkerDragAdapter",null,[156]);class Sb{constructor(db,gc,Dc,Ua,Nb,hc,Qc,$c){this.YYd=null;this.$$c=this.bad=!1;if(!gc)throw Error.argumentNull("parentElement");this.zGe=$c;this.znb=db;this.ks=Dc;this.WVb=Ua;this.jaa=Nb;this.Anh=Qc;this.FC=document.createElement("div");this.FC.className=pc.Ifh(db)?this.jaa.kNl:this.jaa.jNl;this.FC.title=ResourceStrings.L_CommentMarkerTooltip;this.FC.style.display=this.Anh||
this.zGe?"none":"block";this.FC.setAttribute("data-pptcommentid",String.format("{0}",db.commentId));this.a6=document.createElement("img");this.a6.alt=ResourceStrings.L_CommentMarkerTooltip;this.a6.src=Dc.frame.Yp(Dc.frame.vIa+".png");this.a6.setAttribute(Qd.a.pi,Qd.a.BL);this.FC.appendChild(this.a6);this.Rfd();this.frame.ef.Zb(uc.a.click,this.FC,Object(Na.a)(this,this.fX,"clickHandler"));pc.Lfh&&(vc.a.addHandler(this.FC,uc.a.gv,Object(Na.a)(this,this.A4a,"mouseOverHandler")),vc.a.addHandler(this.FC,
uc.a.uy,Object(Na.a)(this,this.Ptg,"mouseOutHandler")));pc.fch&&vc.a.addHandler(this.a6,uc.a.mouseDown,Object(Na.a)(this,this.rFg,"preventNativeDragMouseDownHandler"));gc.appendChild(this.FC);hc||this.hni()}dispose(){this.a6&&(pc.fch&&vc.a.removeHandler(this.a6,uc.a.mouseDown,Object(Na.a)(this,this.rFg,"preventNativeDragMouseDownHandler")),this.frame.ef.jc(uc.a.click,this.FC,Object(Na.a)(this,this.fX,"clickHandler")),this.a6.parentNode&&this.a6.parentNode.removeChild(this.a6),this.a6=null);this.FC&&
(pc.Lfh&&(vc.a.removeHandler(this.FC,uc.a.gv,Object(Na.a)(this,this.A4a,"mouseOverHandler")),vc.a.removeHandler(this.FC,uc.a.uy,Object(Na.a)(this,this.Ptg,"mouseOutHandler"))),this.WVb&&(this.WVb.zhf(),this.WVb.lL(this.FC,this.YYd)),this.FC.parentNode&&this.FC.parentNode.removeChild(this.FC));this.ks=this.znb=null}get comment(){return this.znb}get element(){return this.FC}get frame(){return this.ks.frame}hni(){this.WVb&&(this.YYd=new xb(this,eb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),
this.WVb.NO(this.FC,this.YYd))}updatePosition(db){this.FC.style.left=he.a.Uc(db._x-(this.ks.isRightToLeft?this.jaa.FSj:0));this.FC.style.top=he.a.Uc(db._y)}UNl(db){this.ks.F9d(this.znb,db)}select(db){this.bad=db;this.Rfd()}activate(db){this.$$c=db;this.Rfd()}I4l(){}setVisibility(db){this.FC.style.display=db&&!this.zGe?"block":"none"}Rfd(){this.zGe||(this.a6.className=pc.Ifh(this.znb)?this.bad?Id.e(this.frame.vIa,this.jaa.nNl):this.$$c?Id.e(this.frame.vIa,this.jaa.lNl):Id.e(this.frame.vIa,this.jaa.mNl):
this.bad?Id.e(this.frame.vIa,this.jaa.iNl):this.$$c?Id.e(this.frame.vIa,this.jaa.ESj):Id.e(this.frame.vIa,this.jaa.Asg))}get wt(){return null}get ush(){return 0}fX(db){if(db.cD!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.znb,null,!1,!0,db.yg,1,!1);db=db.Sb;db.preventDefault();db.stopPropagation();return!0}A4a(){this.frame.vye(this.znb,1)}Ptg(){this.frame.vye(null,1)}rFg(db){db.preventDefault()}}Object(c.a)(Sb,"LegacyCommentMarkerViewElement",null,[1335]);var Cc=a(22),qb=
a(1024);class Ob{constructor(db,gc,Dc,Ua,Nb,hc,Qc,$c,Hd){this.YYd=null;this.oIl=this.$$c=this.bad=!1;if(!gc)throw Error.argumentNull("parentElement");this.znb=db;this.ks=Dc;this.WVb=Ua;this.jaa=Nb;this.eFc=hc;this.Rmh=Qc;this.Anh=Hd;this.FC=document.createElement("div");this.FC.className=pc.Ifh(db)?this.jaa.kNl:this.jaa.jNl;Sys.UI.DomElement.addCssClass(this.FC,"CommentMarker");this.FC.title=ResourceStrings.L_CommentMarkerTooltip;this.FC.style.display="none";this.FC.setAttribute("data-pptcommentid",
String.format("{0}",db.commentId));this.a6=document.createElement("img");this.a6.alt=ResourceStrings.L_CommentMarkerTooltip;this.a6.src=Dc.frame.Yp(Dc.frame.vIa+".png");this.a6.setAttribute(Qd.a.pi,Qd.a.BL);this.FC.appendChild(this.a6);this.Rfd();this.frame.ef.Zb(uc.a.click,this.FC,Object(Na.a)(this,this.fX,"clickHandler"));pc.Lfh&&(vc.a.addHandler(this.FC,uc.a.gv,Object(Na.a)(this,this.A4a,"mouseOverHandler")),vc.a.addHandler(this.FC,uc.a.uy,Object(Na.a)(this,this.Ptg,"mouseOutHandler")));pc.fch&&
vc.a.addHandler(this.a6,uc.a.mouseDown,Object(Na.a)(this,this.rFg,"preventNativeDragMouseDownHandler"));gc.appendChild(this.FC);$c||this.hni()}dispose(){this.a6&&(pc.fch&&vc.a.removeHandler(this.a6,uc.a.mouseDown,Object(Na.a)(this,this.rFg,"preventNativeDragMouseDownHandler")),this.frame.ef.jc(uc.a.click,this.FC,Object(Na.a)(this,this.fX,"clickHandler")),this.a6.parentNode&&this.a6.parentNode.removeChild(this.a6),this.a6=null);this.FC&&(pc.Lfh&&(vc.a.removeHandler(this.FC,uc.a.gv,Object(Na.a)(this,
this.A4a,"mouseOverHandler")),vc.a.removeHandler(this.FC,uc.a.uy,Object(Na.a)(this,this.Ptg,"mouseOutHandler"))),this.WVb&&(this.WVb.zhf(),this.WVb.lL(this.FC,this.YYd)),this.FC.parentNode&&this.FC.parentNode.removeChild(this.FC));this.ks=this.znb=null}get comment(){return this.znb}get element(){return this.FC}get frame(){return this.ks.frame}hni(){this.WVb&&(this.YYd=new xb(this,eb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.WVb.NO(this.FC,this.YYd))}updatePosition(){const db=
this.Rmh.kSm(this,this.comment);this.FC.style.left=db._x+"px";this.FC.style.top=db._y+"px"}UNl(){this.Rmh.rXn(this,this.comment)}select(db){this.bad=db;this.Rfd();this.SOa()}activate(db){this.$$c=db;this.Rfd();this.SOa()}I4l(db){this.oIl=db;this.Rfd();this.SOa()}setVisibility(db){this.Anh=!db;this.SOa()}SOa(){!this.Anh&&(this.bad||this.$$c||this.oIl)?(this.updatePosition(this.frame.tqc(this.comment.pos.X,this.comment.pos.Y)),this.FC.style.display="block",Cc.a.e3(this.FC,qb.a.$gb)):(this.FC.style.display=
"none",Cc.a.uub(this.FC,qb.a.$gb))}get wt(){return this.eFc.SLm(this.znb)}get ush(){return this.eFc.TLm(this.znb)}Rfd(){this.a6.className=pc.Ifh(this.znb)?this.bad?Id.e(this.frame.vIa,this.jaa.nNl):this.$$c?Id.e(this.frame.vIa,this.jaa.lNl):Id.e(this.frame.vIa,this.jaa.mNl):this.bad?Id.e(this.frame.vIa,this.jaa.iNl):this.$$c?Id.e(this.frame.vIa,this.jaa.ESj):Id.e(this.frame.vIa,this.jaa.Asg)}fX(db){if(db.cD!==Sys.UI.MouseButton.leftButton)return!1;this.frame.MA.isVisible||this.frame.Y6b();this.frame.selectComment(this.znb,
null,!1,!0,db.yg,1,!1);db=db.Sb;db.preventDefault();db.stopPropagation();return!0}A4a(){this.a6.className=Id.e(this.frame.vIa,this.jaa.ESj)}Ptg(){this.a6.className=Id.e(this.frame.vIa,this.jaa.Asg)}rFg(db){db.preventDefault()}}Object(c.a)(Ob,"ModernCommentMarkerViewElement",null,[1335]);class Pb{constructor(db,gc,Dc,Ua,Nb,hc){this.eFc=db;this.Rmh=gc;this.jaa=Dc;this.t4f=Nb;this.zGe=hc;Ua.Vzd().then(Qc=>{Qc||this.BDk(!1)})}dispose(){this.jaa=null}create(db,gc,Dc,Ua,Nb,hc){if(this.t4f){const Qc=this.eFc.bTm(db);
return new Ob(db,Qc||gc,Dc,Ua,this.jaa,this.eFc,this.Rmh,Nb,hc)}return new Sb(db,gc,Dc,Ua,this.jaa,Nb,hc,this.zGe)}BDk(db){this.zGe=this.t4f=db;this.jaa.BDk(db)}}Object(c.a)(Pb,"CommentMarkerViewElementFactory",null,[1268,24]);var qc=a(30);class Uc extends qc.a{constructor(){super()}zfl(db){this.addHandler(Uc.u6l,db)}EOl(){this.raiseEvent(Uc.u6l)}}Uc.u6l="S";Object(c.a)(Uc,"ATransactionCompletedProcessor",qc.a,[1334]);var pd=a(258);class Od extends Uc{constructor(db,gc,Dc){super();this.Ven=db;this.Wnh=
gc;this.mY=Dc}get index(){return 0}run(){this.Ven()}Mkl(db,gc){gc.property!==Tc.a.BIa&&gc.property!==Tc.a.wYa&&gc.property!==Tc.a.commentId&&gc.property!==Tc.a.R5c&&gc.property!==Tc.a.Xpc&&gc.property!==Tc.a.f_c&&gc.property!==Tc.a.e_c&&gc.property!==Tc.a.reactions||this.EOl()}Ekl(db,gc){gc.property!==pd.a.ny&&gc.property!==Tc.a.R5c||this.EOl()}l0m(){this.Wnh.Sd(39).Am(Object(Na.a)(this,this.Ekl,"commentContentPropertyChanged"));this.Wnh.Sd(40).Am(Object(Na.a)(this,this.Mkl,"commentPropertyChanged"));
this.mY.a2l(this,3)}rWn(){this.Wnh.Sd(40).Pq(Object(Na.a)(this,this.Mkl,"commentPropertyChanged"));this.Wnh.Sd(39).Pq(Object(Na.a)(this,this.Ekl,"commentContentPropertyChanged"))}}Object(c.a)(Od,"CommentPropertyTracker",Uc,[]);var be=a(516),te=a(330);class Le extends be.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new te.a,{T_:Le.getTypeName(),B_:Le.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(c.a)(Le,"CommentSmartReplySignal",be.a,[]);var kf=a(682);class fg extends kf.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new te.a,{T_:fg.getTypeName(),B_:fg.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(c.a)(fg,"SmartReply",kf.a,[]);var pe=a(431),me=a(422);class Ke{constructor(db,gc){this.qgm=db;this.v4k=
gc}initialize(){this.v4k.execute(db=>{const gc=fg.getTypeName();db.e0(gc);db.GBa(gc,Object(Na.a)(this,this.Fna,"handleAnnotationEvent"))})}invoke(db,gc){const Dc=Object.assign(new pe.a,{parentPath:["Signal",Le.getTypeName()],items:[Object.assign(new me.a,{body:Object.assign(new Le,{commentId:db,comment:gc})})]});this.v4k.execute(Ua=>{Ua.submitOperation(Dc)})}Fna(db){if(db){var gc=new f.a;if(db&&db.CommentId&&db.ResultSets&&0<db.ResultSets.length&&db.ResultSets[0].Documents&&0<db.ResultSets[0].Documents.length){for(const Dc of db.ResultSets[0].Documents)gc.add(Dc.Caption);
0<gc.count&&this.qgm.Ewn(db.CommentId,gc.toArray())}else La.a.J(507843648,327,10,"Invalid response from SmartReplies request")}else La.a.J(507843649,327,50,"Smart reply invocation returned null annotations.")}}Object(c.a)(Ke,"CommentSmartReplyProvider",null,[]);var Ie=a(96),Ef=a(27),We=a(521),Ae=a(297),se=a(84),pf=a(18),eg=a(278),pg=a(860);class ne{constructor(db,gc,Dc,Ua,Nb){this.wCj=this.rDj=this.ODj=this.smh=0;this.rHl=new f.a;this.eQj=this.wHl=this.yCj=this.Zmg=this.UJj=0;this.bNj=new f.a;this.VAj=
this.UAj=this.WAj=this.TAj=0;this.yGl=new f.a;this.Lph=new f.a;this.mDj=this.kDj=this.lDj=this.pDj=this.$Gj=this.ZGj=this.aHj=this.bHj=0;this.wmh=this.ZEj=this.Umh=wa.App.ep;this.Aad=null;this.WPj=this.XPj=this.hqh=this.uqh=this.uph=this.SAj=0;if(!db)throw Error.argumentNull("coreEventHandler");if(!gc)throw Error.argumentNull("appSettingsManager");this.od=db;this.Fb=gc;this.va=Dc;this.t3=Ua;this.sCj=Nb;this.od.VG(Object(Na.a)(this,this.Oq,"onSessionRehydrated"));this.od.sE(Object(Na.a)(this,this.JI,
"onSessionEnd"))}get Mhi(){return this.Fb.getBooleanAppSetting("CommentTextAnchoringCreateNewEnabled")}get FTn(){return this.Fb.getBooleanAppSetting("TasksForCommentsEnabled")}rvj(db,gc,Dc,Ua){this.smh+=1;this.wCj+=gc;Dc&&(this.TAj+=1,this.bNj.add(db));Ua&&(this.SAj+=1)}E9m(db,gc,Dc,Ua){this.hqh=Ua?this.hqh+1:this.hqh;this.rvj(db,gc,Dc,Ua)}D9m(db,gc,Dc,Ua,Nb){(Nb=!!Nb)&&Ua?this.XPj+=1:Nb&&(this.WPj+=1);this.rvj(db,gc,Dc,Nb)}$$m(){this.WAj+=1}X$m(){this.UAj+=1}Y$m(){this.VAj+=1}Z$m(db,gc,Dc,Ua){this.ECl(db.commentId)||
(Dc&&!this.d7m(gc,Dc.wI(),Ua)?this.RFl(db,Dc,!0):this.RFl(db,Dc,!1))}GDn(){this.rDj+=1}Q$m(){this.pDj+=1}U9m(){this.lDj+=1}T9m(){this.kDj+=1}V9m(){this.mDj+=1}Z9m(){this.ODj+=1}r$m(db){this.rHl.contains(db)||(this.UJj+=1,this.rHl.add(db))}E$m(db){this.uph=db?this.uph+1:this.uph;this.Zmg+=1}kan(db){this.uqh=db?this.uqh+1:this.uqh}F$m(){this.Zmg+=1}Mvj(db,gc,Dc){this.yCj=db;this.eQj=gc;this.yGl=Dc;this.GFl()}S9m(db){this.wHl=db?1:2}Kon(db){this.Umh===wa.App.ep&&(this.Umh=new Date,this.hBb("OnCollabCornerCommentsEnabled",
this.Umh,db),this.wxk("CollabCornerCommentsEnabled",this.Umh))}Lpn(db){this.ZEj===wa.App.ep&&(this.ZEj=new Date,this.hBb("OnFloatingCommentsRendered",this.ZEj,db))}fon(db){this.wmh===wa.App.ep&&(this.wmh=new Date,this.hBb("OnAllFloatingContainersVisible",this.wmh,db),this.wxk("AllFloatingContainersVisible",this.wmh))}bpn(db){const gc=new Date;this.hBb("OnDeepLinkedCommentSelected",gc,db);this.wxk("DeepLinkedCommentSelected",gc)}ECl(db){return this.yGl.contains(db)||this.Lph.contains(db)}d7m(db,gc,
Dc){let Ua=0;for(const hc of gc)if(gc=Object(aa.a)(988,hc.tc(Dc))){gc=gc.htmlElement.getElementsByClassName(Ae.a.q6c);for(let Qc=0;Qc<gc.length;Qc++){var Nb=gc[Qc];const $c=Ie.a.we(Nb,Ae.a.ukf);$c&&(Ua+=Mc.a.contains($c,db)?1:0);(Nb=Ie.a.we(Nb,Ae.a.qkf))&&(Ua+=Mc.a.contains(Nb,db)?1:0);if(2===Ua)return!0}}return!1}RFl(db,gc,Dc){if(db&&db.textAnchoringInfo&&!this.ECl(db.commentId))if(db.textAnchoringInfo.EndPos<=db.textAnchoringInfo.StartPos){if(gc){if(Dc){this.$Gj+=1;this.Lph.add(db.commentId);return}this.aHj+=
1}else this.bHj+=1;this.Lph.add(db.commentId)}else 0>=db.textAnchoringInfo.TextBodyLength&&(this.bNj.contains(db.commentId)?this.bNj.remove(db.commentId):(this.ZGj+=1,this.Lph.add(db.commentId)))}hBb(db,gc,Dc){const Ua={};Ua.Event=db;Ua.Time=gc.getTime();Ua.SlideId=Dc.toString();Ua.LandingSlide=this.XPm();Ua.SessionDimensions=this.iVi();Ua.PerfMetrics=this.cMm();Ua.CommentPerfMetrics=this.VMm();Ua.CommentFileType=this.sCj;Ua.CommentDeepLinkedOpen=!!this.Fb.La("CurrentCommentId");Ua.StandaloneCommentJsEnabled=
!0;Ua.LoadSharedCommentsEarly=!0;Ua.FetchFullAppSettingsOnBoot=!0;Ua.PrefetchCommentCloudPolicy=!0;La.a.J(509703831,805,15,ia.c(Ua))}GFl(){La.a.J(509703830,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",this.yCj,this.sCj);La.a.J(509703829,805,15,"Text Anchor(s) - OnOpen:{0}",this.eQj);La.a.J(509703828,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",this.Mhi,this.FTn)}log(){La.a.J(509703827,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",
this.smh,this.ODj,this.rDj,this.wCj/this.smh,this.UJj,this.Zmg,this.yCj,this.sCj,this.wHl);La.a.J(509703826,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",this.eQj,this.TAj,this.WAj,this.UAj,this.VAj,this.aHj,this.ZGj,this.bHj,this.$Gj);La.a.J(509703825,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.pDj,this.lDj,this.kDj,
this.mDj);this.V$m()}V$m(){La.a.J(509703824,845,15,"Task(s) - Added:{0}",this.SAj);const db={};db.ResolvedTasksCount=this.uph;db.UnresolvedTasksCount=this.uqh;db.TasksCreatedNewThreadCount=this.hqh;db.TasksReassignedInReplyCount=this.XPj;db.TasksCreatedInReplyCount=this.WPj;La.a.J(509703823,845,15,ia.c(db))}Oq(){this.GFl()}JI(){this.log()}XPm(){if(this.Aad)return this.Aad;this.Aad={};var db=parseInt(this.Fb.La("CurrentSlideId"));db=db!==eg.a.empty.sid?eg.a.Yq(db,0):this.va.presentation.tAb(0);if(!db)return this.Aad;
this.Aad.SlideId=db.toString();if(db=this.va.presentation.iih(db.sid))db=Object(aa.a)(32,db).JV(),this.Aad.HasComments=this.t3.Wih(db),this.Aad.HasActiveComments=this.t3.Sih(db);return this.Aad}iVi(){const db={};db.Ring=h.AFrameworkApplication.Rf.Ring;db.Host=h.AFrameworkApplication.Rf.Host;db.UiHost=h.AFrameworkApplication.Rf.UiHost;db.SessionOrigin=h.AFrameworkApplication.Rf.SessionOrigin;db.ApplicationMode=h.AFrameworkApplication.Rf.ApplicationMode;db.Browser=h.AFrameworkApplication.Rf.Browser;
db.Os=h.AFrameworkApplication.Rf.Os;return db}cMm(){const db={};db[Ef.a.Zfd]=Mb.a.instance.Ph(Ef.a.Zfd);db.DocPageNavigationStart=Mb.a.instance.Ph("DocPageNavigationStart");db[Ef.a.C7c]=Mb.a.instance.Ph(Ef.a.C7c);db[pg.a.bMg]=Mb.a.instance.Ph(pg.a.bMg);db[pg.a.aMg]=Mb.a.instance.Ph(pg.a.aMg);db[pg.a.irk]=Mb.a.instance.Ph(pg.a.irk);db[pg.a.pBi]=Mb.a.instance.Ph(pg.a.pBi);db[pg.a.Ffh]=Mb.a.instance.Ph(pg.a.Ffh);db[pg.a.Efh]=Mb.a.instance.Ph(pg.a.Efh);db[pg.a.Zch]=Mb.a.instance.Ph(pg.a.Zch);db[Ef.a.wPe]=
0<We.a.instance.Qth();return db}VMm(){const db={};db[nb.a.odh]=Mb.a.instance.Ph(nb.a.odh);db[nb.a.qdh]=Mb.a.instance.Ph(nb.a.qdh);db[nb.a.fEe]=Mb.a.instance.Ph(nb.a.fEe);db[nb.a.Gjh]=Mb.a.instance.Ph(nb.a.Gjh);db[nb.a.Vwh]=Mb.a.instance.Ph(nb.a.Vwh);db[nb.a.xEe]=Mb.a.instance.Ph(nb.a.xEe);db[nb.a.Hjh]=Mb.a.instance.Ph(nb.a.Hjh);db[nb.a.Qlh]=Mb.a.instance.Ph(nb.a.Qlh);db[nb.a.lgh]=Mb.a.instance.Ph(nb.a.lgh);db[nb.a.mgh]=Mb.a.instance.Ph(nb.a.mgh);db[nb.a.XSg]=Mb.a.instance.Ph(nb.a.XSg);db[nb.a.anf]=
Mb.a.instance.Ph(nb.a.anf);db[nb.a.$mf]=Mb.a.instance.Ph(nb.a.$mf);return db}aTm(){const db=Mb.a.instance.Ph("DocPageNavigationStart");if(!Mb.a.instance.Ph(Ef.a.Zfd))return db;const gc=Mb.a.instance.Ph(Ef.a.Zfd);return 6E4>db-gc?gc:db}wxk(db,gc){const Dc=[];Array.add(Dc,Object.assign(new pf.a,{name:"EventName",string:db}));Za.a.sendActivityEvent(Object.assign(new se.a,{name:"CommentsBootEvents",durationMs:gc.getTime()-this.aTm(),dataFields:Dc}))}}Object(c.a)(ne,"CommentTelemetryManager",null,[1304]);
var sf=a(1351),Ye=a(1352),Yd=a(1353);class Lg extends sf.a{constructor(db,gc){super();this.xcn=db;this.Uj=gc;this.aGj=[new Ye.a(Ae.a.yhi,null),new Ye.a(Ae.a.zhi,null),new Ye.a(Ae.a.Ahi,null),new Ye.a(Ae.a.Dhi,null),new Ye.a(Ae.a.Hhi,null),new Ye.a(Ae.a.Ihi,null),new Ye.a(Ae.a.Ghi,null),new Ye.a(Ae.a.Bhi,null),new Ye.a(Ae.a.Chi,null),new Ye.a(Ae.a.Ehi,null),new Ye.a(Ae.a.Fhi,null)]}get isInHighContrastMode(){return!!this.Uj&&this.Uj.isInHighContrastMode}get W8c(){return this.xcn}get z8i(){return this.aGj}fQc(db,
gc){var Dc=this.qEa.Ahb;if(Dc&&0===Dc.type&&(Dc=this.qEa.Ahb.F$a,Dc=Object(e.a)(Array,Dc)?Dc:null)){var Ua=null,Nb=null,hc=new ta.a;for(const Qc of Dc)Qc.nBg.isValid&&Array.contains(Qc.nBg.paragraphs,db)&&(0===Qc.state?Ua=Qc.commentId:1===Qc.state&&(Nb=Qc.commentId),hc.K(Qc.commentId,Qc.nBg));this.vsm(gc.querySelectorAll("*"),hc,db,Ua,Nb)}}dPf(db,gc){db=Object(e.a)(Array,db)?Array.isArray(db)?db:null:null;if(!db||0<db.length&&!Object(aa.a)(ab,db[0]))return gc;for(const Dc of db)if(Dc.nBg.isValid)for(const Ua of Dc.nBg.paragraphs)Ua&&
(Yd.b(Ua),gc.add(Ua));return gc}pIm(db,gc){db=db.$Qa;const Dc=gc?Lg.rbn:Lg.sbn;gc=Fa.a.EKi(db,gc?Lg.Qcn:Lg.Rcn);db=Fa.a.EKi(db,Dc);return gc<db}vsm(db,gc,Dc,Ua,Nb){const hc=new K.a,Qc=new K.a;for(let $d=0;$d<db.length;$d++){const ue=db[$d];this.euh(ue);if(!ue.parentNode)continue;var $c=Ie.a.we(ue,Ae.a.ukf),Hd=Ie.a.we(ue,Ae.a.qkf);const Fe=[!1,!1,!1];if($c)for(const cf of $c)if(gc.Ob(cf)){$c=gc.ha(cf).zul(Dc);if(gc.ha(cf).Qyl||(2===$c||0===$c)&&!this.isInHighContrastMode&&this.pIm(gc.ha(cf),cf===Nb))gc.ha(cf).Qyl=
!0,hc.add(cf);Qc.add(cf);this.$nl(gc,Dc,cf,Ua,Nb,Fe,!0)}if(Hd)for(const cf of Hd)Qc.contains(cf)&&(Qc.remove(cf),hc.remove(cf),this.$nl(gc,Dc,cf,Ua,Nb,Fe,!1));if(0!==Yd.a(ue)){Hd=($c=0<hc.count)&&!!Nb&&hc.contains(Nb);const cf=!!Ua&&Qc.contains(Ua),Ee=!!Nb&&Qc.contains(Nb);0<Qc.count&&!this.isInHighContrastMode&&0<=ue.parentNode.className.indexOf(Ae.a.Sta)&&(Cc.a.e3(ue.parentNode,Ae.a.yhi),Ee?Cc.a.e3(ue.parentNode,Hd?Ae.a.Chi:Ae.a.Bhi):cf?(Cc.a.e3(ue.parentNode,Ae.a.zhi),$c=ue.parentNode.className.match(new RegExp("\\b"+
Ae.a.jjh+"\\b")),(!$c||1>$c.length)&&Cc.a.e3(ue.parentNode,Ae.a.Ahi)):Cc.a.e3(ue.parentNode,$c?Ae.a.Ihi:Ae.a.Hhi));Fe[1]?Cc.a.e3(ue,Hd?Ae.a.Fhi:Ae.a.Ehi):Fe[0]?Cc.a.e3(ue,Ae.a.Dhi):Fe[2]&&Cc.a.e3(ue,Ae.a.Ghi)}}}$nl(db,gc,Dc,Ua,Nb,hc,Qc){db=db.ha(Dc).zul(gc);if(2===db||(Qc?0===db:1===db))Ua&&Ua.equals(Dc)&&(hc[0]=!0),Nb&&Nb.equals(Dc)&&(hc[1]=!0),hc[2]=!0}}Lg.Rcn="#F5E7F6";Lg.sbn="#503355";Lg.Qcn="#F2E1F4";Lg.rbn="#4C3050";Object(c.a)(Lg,"CommentTextAnchorHighlightActor",sf.a,[]);class Yg{constructor(db){let gc;
this.Ljm=20;gc=db?db="SharedCommentBubble":db="SharedCommentBubbleSelected";this.Gjm=this.y7c("SharedCommentBubble");this.Fjm=this.y7c("SharedCommentBubbleHover");this.F9k=this.y7c(db);this.Kjm=this.y7c("SharedCommentBubble");this.Jjm=this.y7c("SharedCommentBubbleHover");this.G9k=this.y7c(gc);this.Hjm="ModernCommentMarkerElementSingle cui-img-cont-float";this.Ijm="ModernCommentMarkerElementWithReplies cui-img-cont-float"}get jNl(){return this.Hjm}get kNl(){return this.Ijm}get FSj(){return this.Ljm}get Asg(){return this.Gjm}get ESj(){return this.Fjm}get iNl(){return this.F9k}get mNl(){return this.Kjm}get lNl(){return this.Jjm}get nNl(){return this.G9k}BDk(db){const gc=
db?this.Asg:"SharedCommentBubbleSelected";db=db?this.Asg:gc;this.F9k=this.y7c(gc);this.G9k=this.y7c(db)}y7c(db){return String.format("{0}_{1}x{2}x32",db,this.FSj,this.FSj)}}Object(c.a)(Yg,"CommentViewHelper",null,[]);class Ng{constructor(db,gc,Dc,Ua,Nb,hc){this.od=db;this.va=gc;this.Tb=Dc;this.$Kl=Ua;this.vd=hc;this.$Kl.fG(Object(Na.a)(this,this.QIe,"onSlideOrderChanged"));this.od.mel(Object(Na.a)(this,this.APl,"onCommentsChanged"))}dispose(){this.od.EYl(Object(Na.a)(this,this.APl,"onCommentsChanged"));
this.$Kl.PO(Object(Na.a)(this,this.QIe,"onSlideOrderChanged"))}APl(){const db=this.va.Ga;r.a.V9b(this.Tb,()=>{this.Nwn(db)})}QIe(db,gc){if(2===gc.MZ){const Dc=this.va.Ga;r.a.V9b(this.Tb,()=>{this.lUl(Dc)})}}lUl(db){this.va.Ga===db&&db&&this.vd.Tfd(!0)}Nwn(db){this.lUl(db)}}Object(c.a)(Ng,"CommentsChangeListener",null,[24]);var df=a(55),Pg=a(442),ig=a(267);class ji{constructor(db,gc,Dc,Ua,Nb){this.NGc=this.Tad=null;new Pg.a(0,0,0,0);this.sHl=null;this.m4l=this.j6d=!1;this.dha=Ua;this.Db=gc;this.dha||
(this.Tad=document.createElement("div"),this.Tad.className="CommentPanel",this.Tad.style.position="absolute");this.mc=!1;this.xMl=Dc;this.Jo=Nb}dispose(){}layout(db){return db}hostView(db){this.NGc=db}pLn(db){this.sHl=db}wA(db){this.mc=db;this.dha?this.l7(this.mc):this.xMl.l7(this,this.mc,ResourceStrings.L_Comments,ig.a.Sz)}l7(db){df.a.Py().then(gc=>{db?(gc.showTaskPane(ig.a.Sz,this.sHl),ua.a("UpdateCommentLoadMetrics")&&!this.j6d&&(this.Jo.qK(this.Jo.gxd,this.Jo.xyd),this.Jo.fUa(this.Jo.gxd,this.Jo.xyd),
this.j6d=!0)):gc.hideTaskPane(ig.a.Sz,2);return null}).catch(gc=>{La.a.J(508887565,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",gc.toString(),db.toString())})}zvh(){df.a.Py().then(db=>{db.setSelectedTaskPane(ig.a.Sz);return null}).catch(db=>{La.a.J(508887564,833,10,"CommentsPane::SelectPane exception: {0}",db.toString())})}DJn(){try{this.dha?this.zvh():this.xMl.zvh(ig.a.Sz)}catch(db){La.a.J(508887563,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",
db)}}F$d(db){this.Db.F$d(db?1:2)}get isVisible(){return this.mc}get ta(){return this.Tad}get order(){return 18}}Object(c.a)(ji,"CommentsPane",null,[1273,495,24,965]);class Ca{constructor(){this.Wdc=this.Gec=0;this.Kd=this.oed=this.FLb=null}}Object(c.a)(Ca,"FindCommentContext",null,[]);var cb;(function(db){db[db.findNextComment=0]="findNextComment";db[db.findPreviousComment=1]="findPreviousComment";db[db.findNextActiveComment=2]="findNextActiveComment";db[db.findPreviousActiveComment=3]="findPreviousActiveComment"})(cb||
(cb={}));Object(c.b)("FindCommentRequestType",cb);class Eb{constructor(db,gc,Dc,Ua,Nb,hc){this.oc=db;this.va=gc;this.REj=Dc;this.Vya=Ua;this.GJl=Nb;this.ei=new Ca;this.acn=hc}get ISa(){return this.acn.value}dispose(){this.REj.dispose();this.ei=this.REj=null}hEi(db,gc,Dc){this.PDi(0,!1,db,gc,Dc)}rEi(db,gc,Dc){this.PDi(1,!1,db,gc,Dc)}iEi(db,gc){this.PDi(0,!0,db,gc,!1)}PDi(db,gc,Dc,Ua,Nb){var hc=this.va.presentation;if(!hc)throw Error.argumentNull("Presentation is null");Ua||(Ua=Hc.a.Fk("FindComment",
0),Ua.Ya("FindCommentRequestType",cb[db]));Ua.Ya(Eb.S$h,"true");if(this.GJl&&this.va.Ga){if(!this.va.Ga)throw Error.argumentNull("ActiveSlide is null");const Qc=this.va.Ga.ph;hc=hc.slides||[];this.ei.FLb=Dc;this.ei.Wdc=Eb.YOm(db,Nb);this.ei.Kd=Ua;gc?this.QDi(hc[Qc>=hc.length-1?0:Qc+1]):1===db?this.asl(hc,Qc-1,Nb):this.$rl(hc,Qc+1,Nb)}else Ua.Ya(Eb.Evm,this.GJl.toString()),Dc(null,null,!1,!1)}$rl(db,gc,Dc){this.ei.oed=null;this.ei.Gec=gc;for(let Ua=gc;Ua<db.length;Ua++)if(db[Ua]&&this.MDl(db[Ua])){const Nb=
this.cPm(db[Ua],Dc);if(Nb){this.ei.FLb(db[Ua],Nb,!1,!1);return}}else{this.QDi(db[Ua]);return}0<gc?this.gJm(Dc):this.notFound()}asl(db,gc,Dc){this.ei.oed=null;this.ei.Gec=gc;for(let Ua=gc;-1<Ua;Ua--)if(db[Ua]&&this.MDl(db[Ua])){const Nb=this.$Pm(db[Ua],Dc);if(Nb){this.ei.FLb(db[Ua],Nb,!1,!1);return}}else{this.QDi(db[Ua]);return}gc<db.length-1?this.hJm(Dc):this.notFound()}QDi(db){this.ei.Kd.km(Eb.Ovm,new Date);db&&this.REj.find(db.Xb,this.ei.Wdc,Object(Na.a)(this,this.Xrn,"onServerFindSucceeded"),Object(Na.a)(this,
this.Wrn,"onServerFindFailed"))}Xrn(db){this.ei.Kd.Iv(Eb.S$h,"false");this.ei.Kd.km(Eb.Fil,new Date);this.ei.Kd.Ya(Eb.zil,"true");db?(this.ei.oed=db,-1===this.mxc(this.ei.oed.TargetSlideId)?this.notFound():this.ei.FLb(this.xUn(this.ei.oed.TargetSlideId),this.ei.oed.TargetComment,this.ei.oed.IsFirstComment,this.ei.oed.IsLastComment)):this.notFound()}Wrn(){this.ei.Kd.Iv(Eb.S$h,"false");this.ei.Kd.km(Eb.Fil,new Date);this.ei.Kd.Ya(Eb.zil,"false");La.a.J(512496786,805,50,"OnServerFindFailed");this.notFound()}gJm(db){var gc=
this.va.presentation;if(!gc)throw Error.argumentNull("Presentation is null");gc=gc.slides||[];Mc.a.rb(gc)?this.notFound():this.$rl(gc,0,db)}hJm(db){var gc=this.va.presentation;if(!gc)throw Error.argumentNull("Presentation is null");gc=gc.slides||[];Mc.a.rb(gc)?this.notFound():this.asl(gc,gc.length-1,db)}cPm(db,gc){db=this.oc.Wk(db.Xb);if(this.ISa){const Dc=(db=this.Vya.TGd(db))?db.length:0;for(let Ua=0;Ua<Dc;Ua++){const Nb=db[Ua];if(Eb.mEl(Nb,gc))return Nb}return null}return this.Vya.bJm(db,gc)}$Pm(db,
gc){db=this.oc.Wk(db.Xb);if(this.ISa){var Dc=(db=this.Vya.TGd(db))?db.length:0;for(--Dc;0<=Dc;Dc--){const Ua=db[Dc];if(Eb.mEl(Ua,gc))return Ua}return null}return this.Vya.eJm(db,gc)}MDl(db){return db.yC}mxc(db){var gc=this.va.presentation;if(!gc)throw Error.argumentNull("Presentation is null");if(db){gc=gc.slides||[];db=new eg.a(db);for(let Dc=0;Dc<gc.length;Dc++)if(gc[Dc]&&eg.a.JSa(gc[Dc].Xb,db))return Dc}return-1}xUn(db){return db?this.oc.s$a(new eg.a(db)):null}notFound(){this.ei.FLb&&this.ei.FLb(null,
null,!1,!1)}static YOm(db,gc){if(gc)switch(db){case 0:return 2;case 1:return 3}return db}static mEl(db,gc){return!gc||0===db.status}}Eb.S$h="IsCompletedSearchInClient";Eb.Ovm="ServerSearchStartTime";Eb.Fil="ServerSearchEndTime";Eb.zil="IsServerSearchSucceeded";Eb.Evm="IsBRSOn";Object(c.a)(Eb,"FindCommentLogic",null,[1271,24]);var fc=a(39);class Ec{constructor(){this.type=0;this.FLb=this.Kd=null;this.vXh=!1}}Object(c.a)(Ec,"Entry",null,[]);class Ya{constructor(db,gc){this.tnh=null;this.St=db;this.Tb=
gc;this.gZb=[];this.HJj=0}dispose(){this.St.dispose();this.gZb=this.St=null;La.a.J(507843594,805,50,"MaxQueuedEntryNum: {0}",this.HJj)}hEi(db,gc,Dc){this.enqueue(1,db,gc,Dc)}rEi(db,gc,Dc){this.enqueue(0,db,gc,Dc)}iEi(db,gc){this.enqueue(2,db,gc,!1)}enqueue(db,gc,Dc,Ua){Dc.Ya("AlreadyQueuedEntryCount",this.gZb.length.toString());db=Object.assign(new Ec,{type:db,FLb:(Nb,hc,Qc,$c)=>{gc(Nb,hc,Qc,$c);this.tnh=null;this.wTl()},Kd:Dc,vXh:Ua});Array.enqueue(this.gZb,db);this.HJj=Math.max(this.HJj,this.gZb.length);
this.wTl()}wTl(){0<this.gZb.length&&!this.tnh&&(this.tnh=new fc.a(2,1,0,Object(Na.a)(this,this.aBn,"processOneEntry"),90,"49"),this.Tb.Qb(this.tnh))}aBn(){const db=Array.dequeue(this.gZb);1===db.type?this.St.hEi(db.FLb,db.Kd,db.vXh):0===db.type?this.St.rEi(db.FLb,db.Kd,db.vXh):this.St.iEi(db.FLb,db.Kd)}}Object(c.a)(Ya,"FindCommentLogicDecorator",null,[1271,24]);var Ub=a(578),rc=a(312);class fd extends rc.a{constructor(db,gc){super();this.StartSlideId=null;this.RequestType=0;this.FFindModernComments=
!1;if(null===db)throw Error.argumentNull("slideId");this.RequestType=gc;this.StartSlideId=db.toString();this.FFindModernComments=!0}Gn(){return 88}}Object(c.a)(fd,"FindCommentRequest",rc.a,[]);class Cd extends Ub.a{constructor(db){super();this.TEa=null;this.mLl=0;this.KBb=this.nBb=null;this.enabled=2;this.lHe=0;this.Rm=!1;this.hq=db;this.hq.register(this)}dispose(){this.Rm||(1===this._state&&this.hq.unregister(this),this.Rm=!0,this.lHe=0)}find(db,gc,Dc,Ua){0<this.lHe&&null!==Dc&&(La.a.J(507843207,
805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",this.lHe),Dc(null));this.TEa=db;this.mLl=gc;this.YM(Dc,Ua,null)}Cxa(){return 0<this.lHe&&!this.Rm}$N(){return!1}G_a(){return this.pDl||this.Cxa()}c5b(){if(1===this._state)this.pe.wK=new fd(this.TEa,this.mLl),this.pe.status=1,this._state=3;else if(3===this._state&&this.pDl)if(La.a.J(507843206,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",this.pe.Ldd,this.pe.qq,this.pe.zr),2===this.pe.statusCode&&this.pe.yw&&
1===this.pe.yw.length){const db=this.pe.yw[0];0!==db.StatusCode?this.iN(db):this.O6(db)}else this.iN()}YM(db,gc){this.lHe++;this.KBb=db;this.nBb=gc;this.hq.Aba()}forceOutbound(){}iN(db=null){La.a.J(507843204,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",this.pe.httpStatusCode,this.pe.statusCode,db?db.StatusCode:-1);this.kQl(db,!1)}O6(db){this.kQl(db,!0)}get pDl(){return!!this.pe&&2===this.pe.status}kQl(db,gc){this.lHe--;
this._state=1;if(gc){gc=null;try{gc=Sys.Serialization.JavaScriptSerializer.deserialize(db.FindCommentResult)}catch(Dc){La.a.J(507843203,805,10,"Cannot parse find comment result: {0}",Dc)}this.KBb(gc)}else this.nBb(null,-1)}}Object(c.a)(Cd,"FindCommentReplicator",Ub.a,[24]);class Jd{constructor(){this.RI=null;this.m7g=this.sal=this.t4k=this.u7e=this.ddl=this.m$k=this.Wal=!1}hTm(){this.RI||(b.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),
this.Y2l());return this.RI}zQm(){return new Promise((db,gc)=>{this.m7g?db(this.uvl()):this.Y1l().then(()=>{db(this.uvl())}).catch(Dc=>{gc(Dc)})})}uvl(){this.m7g||b.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let db;db=33;this.t4k&&(db|=2);this.Wal&&(db|=8);this.ddl&&(db|=16);this.m$k&&(db|=4);this.u7e&&(db|=64);this.sal&&(db|=128);return db}}Object(c.a)(Jd,"OfficeSharedCommentsAppCapabilities",
null,[321]);class Rd extends Jd{constructor(db,gc,Dc,Ua,Nb,hc){super();this.Fb=db;this.Aa=gc;this.TKl=Dc;this.K4d=hc;this.jNn(Ua,Nb);this.Y2l();this.Y1l()}jNn(db,gc){ua.a("CheckTaskHostIsEnabledForOneDriveConsumer")&&this.IOn(db)?this.u7e=!0:this.u7e=this.Fb.getBooleanAppSetting("TasksForCommentsEnabled")&&!db;this.ddl=!1;this.Wal=gc;this.sal=this.m$k=!0}IOn(db){return this.Fb.getBooleanAppSetting("TasksForCommentsEnabled")&&!db&&this.Fb.getBooleanAppSetting("TasksHostIsEnabled")}Y2l(){this.RI={};
const db=this.u7e&&this.Aa.TDl;this.RI.CommentsFluentUI="true";this.RI.CommentTasks=this.u7e.toString();this.RI.DisabledChangeGates=this.Fb.La("DisabledChangeGatesInSharedComments");this.RI.DiscreteHostedComments="true";this.RI.CommentReactions=Ad(this.Fb).toString();this.RI.NewCommentButton="true";this.RI.PersonaColor="true";this.RI.LivePersonaPicker="true";this.RI.AtMentionFloodgateSurvey=h.AFrameworkApplication.ga.getBooleanAppSetting("AtMentionUserFloodGateCampaignIsEnabled").toString();this.RI.CommentTasksFromReply=
db.toString();this.RI.LogDraftCommentIdPair=this.K4d.toString();this.RI.HyperlinksInComments="true";this.RI.SmartReplies=this.Fb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1).toString();this.RI.TaskPaneWithNewInfrastructure=this.Aa.vkf.toString();this.RI.NewSelectionInteractions="true";this.RI.ExtendedDrafting="true";this.RI.LinkToComment="true";this.RI.WebThemeIntegration="true";this.RI.TaskHistoryRecordIDs=this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1).toString();this.RI.ConsumerEmailLPPEnabled=this.Fb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerEmailLPPEnabled",!1).toString()}Y1l(){return new Promise((db,gc)=>{this.TKl?this.TKl.atMentionsEnabledAsync().then(Dc=>{this.t4k=Dc;this.m7g=!0;db(this.m7g)}):(b.ULS.sendTraceTag(509645712,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),gc(r.a.lG(-2130915320)))})}}Object(c.a)(Rd,"PPTSharedCommentAppCapabilities",
Jd,[]);class Me{constructor(db){this.Yo=db}display(db,gc){this.Yo.vWk(db?0:2,gc);this.Yo.setVisibility()}dismiss(){this.Yo.xxm();this.Yo.setVisibility()}activate(){this.Yo.vWk(1);this.Yo.setVisibility()}dFm(db){this.Yo.vWk(db?0:2)}xq(db){this.Yo.xq(db)}KR(db){this.Yo.KR(db)}Qt(){return this.Yo.Qt()}YZ(db){return this.Yo.sSb(db)}hD(db){this.Yo.hD(db)}dispose(){this.Yo.dispose()}hG(){this.Yo.hG()}vP(db){return this.Yo.vP(db)}iL(db){return this.Yo.iL(db)}draw(db,gc){this.Yo.draw(db,gc)}get visible(){return this.Yo.visible}set visible(db){this.Yo.visible=
db}setPosition(db,gc){this.Yo.setPosition(db,gc)}Yi(db){this.Yo.Yi(db)}Vu(db){this.Yo.Vu(db)}Kz(db){this.Yo.Kz(db)}setZIndex(db){this.Yo.setZIndex(db)}LP(db,gc){this.Yo.LP(db,gc)}setSelection(){}}Object(c.a)(Me,"ShapeCommentsAnchoredSelectionView",null,[1298,760,301,24]);class lf{constructor(db,gc){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=db;this.canvasContextId=
gc}}Object(c.a)(lf,"CommentUIAction",null,[]);var yf=a(26),ff=a(1028),jf=a(349),Nf=a(72),og=a(28),Tg=a(1064),Ce=a(700);class vf{constructor(){this.draftId=null;this.insertIndex=0;this.anchorHintText=null}}Object(c.a)(vf,"CurrentContextDraft",null,[]);class Eg{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}Object(c.a)(Eg,"IContentAnchorPosition",null,[]);class hf{constructor(){this.y=this.x=this.height=this.width=
0}}Object(c.a)(hf,"IViewportInfo",null,[]);class Qh{constructor(){this.allContainersVisibleCallback=this.positionsUpdatedScrollHeightCallback=this.positionsUpdatedCallback=this.paneOpenedCallback=this.paneClosedCallback=null}}Object(c.a)(Qh,"FloatingContainerManagerCreationParams",null,[]);var hi=a(321),Vg=a(265),uh=a(1176),Eh=a(585),Bh=a(572),ag=a(1195),zf;(function(db){db[db.line=0]="line";db[db.lineInv=1]="lineInv";db[db.triangle=2]="triangle";db[db.rtTriangle=3]="rtTriangle";db[db.rect=4]="rect";
db[db.diamond=5]="diamond";db[db.parallelogram=6]="parallelogram";db[db.trapezoid=7]="trapezoid";db[db.nonIsoscelesTrapezoid=8]="nonIsoscelesTrapezoid";db[db.pentagon=9]="pentagon";db[db.hexagon=10]="hexagon";db[db.heptagon=11]="heptagon";db[db.octagon=12]="octagon";db[db.decagon=13]="decagon";db[db.dodecagon=14]="dodecagon";db[db.star4=15]="star4";db[db.star5=16]="star5";db[db.star6=17]="star6";db[db.star7=18]="star7";db[db.star8=19]="star8";db[db.star10=20]="star10";db[db.star12=21]="star12";db[db.star16=
22]="star16";db[db.star24=23]="star24";db[db.star32=24]="star32";db[db.roundRect=25]="roundRect";db[db.round1Rect=26]="round1Rect";db[db.round2SameRect=27]="round2SameRect";db[db.round2DiagRect=28]="round2DiagRect";db[db.snipRoundRect=29]="snipRoundRect";db[db.snip1Rect=30]="snip1Rect";db[db.snip2SameRect=31]="snip2SameRect";db[db.snip2DiagRect=32]="snip2DiagRect";db[db.plaque=33]="plaque";db[db.ellipse=34]="ellipse";db[db.teardrop=35]="teardrop";db[db.homePlate=36]="homePlate";db[db.chevron=37]=
"chevron";db[db.pieWedge=38]="pieWedge";db[db.pie=39]="pie";db[db.blockArc=40]="blockArc";db[db.donut=41]="donut";db[db.noSmoking=42]="noSmoking";db[db.rightArrow=43]="rightArrow";db[db.leftArrow=44]="leftArrow";db[db.upArrow=45]="upArrow";db[db.downArrow=46]="downArrow";db[db.stripedRightArrow=47]="stripedRightArrow";db[db.notchedRightArrow=48]="notchedRightArrow";db[db.bentUpArrow=49]="bentUpArrow";db[db.leftRightArrow=50]="leftRightArrow";db[db.upDownArrow=51]="upDownArrow";db[db.leftUpArrow=52]=
"leftUpArrow";db[db.leftRightUpArrow=53]="leftRightUpArrow";db[db.quadArrow=54]="quadArrow";db[db.leftArrowCallout=55]="leftArrowCallout";db[db.rightArrowCallout=56]="rightArrowCallout";db[db.upArrowCallout=57]="upArrowCallout";db[db.downArrowCallout=58]="downArrowCallout";db[db.leftRightArrowCallout=59]="leftRightArrowCallout";db[db.upDownArrowCallout=60]="upDownArrowCallout";db[db.quadArrowCallout=61]="quadArrowCallout";db[db.bentArrow=62]="bentArrow";db[db.uturnArrow=63]="uturnArrow";db[db.circularArrow=
64]="circularArrow";db[db.leftCircularArrow=65]="leftCircularArrow";db[db.leftRightCircularArrow=66]="leftRightCircularArrow";db[db.curvedRightArrow=67]="curvedRightArrow";db[db.curvedLeftArrow=68]="curvedLeftArrow";db[db.curvedUpArrow=69]="curvedUpArrow";db[db.curvedDownArrow=70]="curvedDownArrow";db[db.swooshArrow=71]="swooshArrow";db[db.cube=72]="cube";db[db.can=73]="can";db[db.lightningBolt=74]="lightningBolt";db[db.heart=75]="heart";db[db.sun=76]="sun";db[db.moon=77]="moon";db[db.smileyFace=
78]="smileyFace";db[db.irregularSeal1=79]="irregularSeal1";db[db.irregularSeal2=80]="irregularSeal2";db[db.foldedCorner=81]="foldedCorner";db[db.bevel=82]="bevel";db[db.frame=83]="frame";db[db.halfFrame=84]="halfFrame";db[db.corner=85]="corner";db[db.diagStripe=86]="diagStripe";db[db.chord=87]="chord";db[db.arc=88]="arc";db[db.leftBracket=89]="leftBracket";db[db.rightBracket=90]="rightBracket";db[db.leftBrace=91]="leftBrace";db[db.rightBrace=92]="rightBrace";db[db.bracketPair=93]="bracketPair";db[db.bracePair=
94]="bracePair";db[db.straightConnector1=95]="straightConnector1";db[db.bentConnector2=96]="bentConnector2";db[db.bentConnector3=97]="bentConnector3";db[db.bentConnector4=98]="bentConnector4";db[db.bentConnector5=99]="bentConnector5";db[db.curvedConnector2=100]="curvedConnector2";db[db.curvedConnector3=101]="curvedConnector3";db[db.curvedConnector4=102]="curvedConnector4";db[db.curvedConnector5=103]="curvedConnector5";db[db.callout1=104]="callout1";db[db.callout2=105]="callout2";db[db.callout3=106]=
"callout3";db[db.accentCallout1=107]="accentCallout1";db[db.accentCallout2=108]="accentCallout2";db[db.accentCallout3=109]="accentCallout3";db[db.borderCallout1=110]="borderCallout1";db[db.borderCallout2=111]="borderCallout2";db[db.borderCallout3=112]="borderCallout3";db[db.accentBorderCallout1=113]="accentBorderCallout1";db[db.accentBorderCallout2=114]="accentBorderCallout2";db[db.accentBorderCallout3=115]="accentBorderCallout3";db[db.wedgeRectCallout=116]="wedgeRectCallout";db[db.wedgeRoundRectCallout=
117]="wedgeRoundRectCallout";db[db.wedgeEllipseCallout=118]="wedgeEllipseCallout";db[db.cloudCallout=119]="cloudCallout";db[db.cloud=120]="cloud";db[db.ribbon=121]="ribbon";db[db.ribbon2=122]="ribbon2";db[db.ellipseRibbon=123]="ellipseRibbon";db[db.ellipseRibbon2=124]="ellipseRibbon2";db[db.leftRightRibbon=125]="leftRightRibbon";db[db.verticalScroll=126]="verticalScroll";db[db.horizontalScroll=127]="horizontalScroll";db[db.wave=128]="wave";db[db.doubleWave=129]="doubleWave";db[db.plus=130]="plus";
db[db.flowChartProcess=131]="flowChartProcess";db[db.flowChartDecision=132]="flowChartDecision";db[db.flowChartInputOutput=133]="flowChartInputOutput";db[db.flowChartPredefinedProcess=134]="flowChartPredefinedProcess";db[db.flowChartInternalStorage=135]="flowChartInternalStorage";db[db.flowChartDocument=136]="flowChartDocument";db[db.flowChartMultidocument=137]="flowChartMultidocument";db[db.flowChartTerminator=138]="flowChartTerminator";db[db.flowChartPreparation=139]="flowChartPreparation";db[db.flowChartManualInput=
140]="flowChartManualInput";db[db.flowChartManualOperation=141]="flowChartManualOperation";db[db.flowChartConnector=142]="flowChartConnector";db[db.flowChartPunchedCard=143]="flowChartPunchedCard";db[db.flowChartPunchedTape=144]="flowChartPunchedTape";db[db.flowChartSummingJunction=145]="flowChartSummingJunction";db[db.flowChartOr=146]="flowChartOr";db[db.flowChartCollate=147]="flowChartCollate";db[db.flowChartSort=148]="flowChartSort";db[db.flowChartExtract=149]="flowChartExtract";db[db.flowChartMerge=
150]="flowChartMerge";db[db.flowChartOfflineStorage=151]="flowChartOfflineStorage";db[db.flowChartOnlineStorage=152]="flowChartOnlineStorage";db[db.flowChartMagneticTape=153]="flowChartMagneticTape";db[db.flowChartMagneticDisk=154]="flowChartMagneticDisk";db[db.flowChartMagneticDrum=155]="flowChartMagneticDrum";db[db.flowChartDisplay=156]="flowChartDisplay";db[db.flowChartDelay=157]="flowChartDelay";db[db.flowChartAlternateProcess=158]="flowChartAlternateProcess";db[db.flowChartOffpageConnector=159]=
"flowChartOffpageConnector";db[db.actionButtonBlank=160]="actionButtonBlank";db[db.actionButtonHome=161]="actionButtonHome";db[db.actionButtonHelp=162]="actionButtonHelp";db[db.actionButtonInformation=163]="actionButtonInformation";db[db.actionButtonForwardNext=164]="actionButtonForwardNext";db[db.actionButtonBackPrevious=165]="actionButtonBackPrevious";db[db.actionButtonEnd=166]="actionButtonEnd";db[db.actionButtonBeginning=167]="actionButtonBeginning";db[db.actionButtonReturn=168]="actionButtonReturn";
db[db.actionButtonDocument=169]="actionButtonDocument";db[db.actionButtonSound=170]="actionButtonSound";db[db.actionButtonMovie=171]="actionButtonMovie";db[db.gear6=172]="gear6";db[db.gear9=173]="gear9";db[db.funnel=174]="funnel";db[db.mathPlus=175]="mathPlus";db[db.mathMinus=176]="mathMinus";db[db.mathMultiply=177]="mathMultiply";db[db.mathDivide=178]="mathDivide";db[db.mathEqual=179]="mathEqual";db[db.mathNotEqual=180]="mathNotEqual";db[db.cornerTabs=181]="cornerTabs";db[db.squareTabs=182]="squareTabs";
db[db.plaqueTabs=183]="plaqueTabs";db[db.chartX=184]="chartX";db[db.chartStar=185]="chartStar";db[db.chartPlus=186]="chartPlus"})(zf||(zf={}));Object(c.b)("ST_ShapeType",zf);var Df=a(342);class $f{constructor(){this.RowId=this.ColId=null}}Object(c.a)($f,"TableCellInfo",null,[]);var Kg=a(1194),ug=a(269),rh=a(359),gh=a(323),Mh=a(369),Rh=a(1204),Ch=a(882),ih=a(883),Mi=a(182),Oi=a(63);class Ti{constructor(db,gc){this.qcc=this.mGe=null;this.PJl=!1;this.qOj=db;this.qj=gc}get K6m(){return this.PJl}pLe(db,
gc){gc&&db.removeNotification(gc);return gc}sFn(db){this.mGe=this.pLe(db,this.mGe);this.pLe(db,this.qcc);this.qcc=this.mGe=null}yQn(db,gc,Dc){db?this.qOj.MA.isVisible&&1===db.Fta.length&&gc.Ga&&eg.a.DUa(db.WEd.Xb,gc.Ga.Xb)||df.a.fS().then(Ua=>{this.qcc=this.pLe(Ua,this.qcc);this.qcc=null;var Nb=Object.assign(new Rh.a,{label:db.sbb,onExecute:()=>{db.primaryButtonAction(this.qOj,gc);gc.Ga.ph!==db.WEd.ph&&Dc.x8(db.WEd.ph);this.pLe(Ua,this.qcc);this.qcc=null}}),hc=Object.assign(new Rh.a,{label:db.gec,
onExecute:()=>{this.PJl=!0;this.pLe(Ua,this.qcc);this.qcc=null}});hc=Object.assign(new Ch.a,{target:".EditingRibbonPanel",title:db.title,content:db.content,primaryButtonProps:Nb,secondaryButtonProps:hc,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new ih.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,onDismiss:()=>{this.qj.Cr(ig.a.bwb)},preventDismissOnScroll:!0,preventDismissOnResize:!0})});Nb=Object.assign(new Mi.a,{onShow:()=>{this.qj.XW(ig.a.bwb)}});hc=Ua.callout(hc);this.qcc=
Ua.addNotification(hc,Nb)}):La.a.J(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}C4l(db,gc){const Dc=new Oi.a;Dc.gf=4;Dc.xG(ResourceStrings.l_DeleteAllCommentsConfirmationTitle,gc?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,Ua=>{1===Ua?(db.Ppf(gc),this.qOj.oCi(gc)?this.D4l():this.B4l(gc?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:
ResourceStrings.l_DeleteAllCommentsInPresentationCallout),La.a.J(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",gc)):La.a.J(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",gc)})}D4l(){const db=new Oi.a;db.gf=0;db.xG(ResourceStrings.l_DeleteAllCommentsErrorTitle,ResourceStrings.l_DeleteAllCommentsError,1,null)}B4l(db){const gc=
()=>{this.qj.XW(ig.a.bwb)},Dc=()=>{this.qj.Cr(ig.a.bwb)};df.a.fS().then(Ua=>{this.pLe(Ua,this.mGe);this.mGe=null;var Nb=Object.assign(new Ch.a,{target:".EditingRibbonPanel",title:ResourceStrings.l_DeleteAllCommentsCalloutTitle,content:db,showCloseIcon:!0,useTeachingStyles:!1,calloutProps:Object.assign(new ih.a,{directionalHint:6,isBeakVisible:!1,onDismiss:Dc,preventDismissOnScroll:!0,preventDismissOnResize:!0})});const hc=Object.assign(new Mi.a,{onShow:gc});Nb=Ua.callout(Nb);this.mGe=Ua.addNotification(Nb,
hc)})}}Object(c.a)(Ti,"CommentCalloutDialogManager",null,[]);var xi=a(1115);class uj{constructor(db){this.icc=db;this.gZb=[];this.$1f=new xi.a(1E3,Object(Na.a)(this,this.perform,"perform"))}Mwn(db){Array.contains(this.gZb,db)||Array.add(this.gZb,db);this.$1f.perform()}perform(){const db=this.gZb;this.gZb=[];for(let gc=0;gc<db.length;gc++){const Dc=db[gc];this.icc.F9d(Dc.commentId,new md.a(Dc.pos.X,Dc.pos.Y))}}}Object(c.a)(uj,"CommentKeyboardMoveController",null,[]);class Ma{constructor(db,gc,Dc,Ua,
Nb){this.vEc=this.rcc=null;this.BBb=[];if(!db)throw Error.argumentNull("parentElement");if(!gc)throw Error.argumentNull("frame");this.eHe=Dc;this.eo=db;this.vd=gc;this.sIl=Ua;this.yIl=Nb}dispose(){this.Amk();this.vd=this.eo=null}Amk(){this.vEc=this.rcc=null;if(this.BBb&&0<this.BBb.length){for(const db of this.BBb)db&&db.dispose();Array.clear(this.BBb)}}c7c(db){if(!this.tCi)return!0;if(!db||!db.length)return!1;db=Mh.e(db,gc=>0===gc.status);return!!db&&0<db.length}Vth(db){this.Amk();if(db&&this.eo){var gc=
this.vd.isReadOnly?null:this.vd.Zw;for(const Dc of db)this.BBb.push(this.eHe.create(Dc,this.eo,this,gc,this.vd.isReadOnly,pc.Iwa(Dc)||!this.yIl));this.c7c(db)&&this.kYk()}}selectComment(db,gc){if(!(!db&&!this.rcc||this.rcc&&pc.NBe(db,this.rcc.comment))&&(this.rcc&&this.rcc.select(!1),this.rcc=null,db))for(const Dc of this.BBb){if(pc.NBe(Dc.comment,db)){this.rcc=Dc;Dc.select(!0);break}if(gc&&Dc.comment.Children)for(const Ua of Dc.comment.Children)if(pc.NBe(Ua,db)){this.rcc=Dc;Dc.select(!0);return}}}vye(db,
gc){if(!(!db&&!this.vEc||this.vEc&&pc.NBe(db,this.vEc.comment))&&(this.vEc&&this.vEc.activate(!1),this.vEc=null,db))for(const Dc of this.BBb){if(pc.NBe(Dc.comment,db)){this.vEc=Dc;Dc.activate(!0);break}if(gc&&Dc.comment.Children)for(const Ua of Dc.comment.Children)if(pc.NBe(Ua,db)){this.vEc=Dc;Dc.activate(!0);return}}}J4l(db){for(const gc of this.BBb)gc.I4l(db)}kYk(){for(const db of this.BBb)db.updatePosition(this.vd.tqc(db.comment.pos.X,db.comment.pos.Y))}F9d(db,gc){gc=this.vd.Mll(gc._x,gc._y);db.pos.X+=
gc._x;db.pos.Y+=gc._y;gc=new md.a(db.pos.X,db.pos.Y);this.vd.selectComment(db,null,!0,!1,0,1,!1);this.vd.manager.F9d(db.commentId,gc)}QXn(db){for(const gc of this.BBb)if(gc.comment===db){gc.updatePosition(this.vd.tqc(gc.comment.pos.X,gc.comment.pos.Y));break}}RXn(db){for(const gc of db)for(const Dc of this.BBb)Dc.comment.commentId===gc.commentId&&Dc.updatePosition(this.vd.tqc(Dc.comment.pos.X,Dc.comment.pos.Y))}setVisibility(db){this.yIl=db;for(const gc of this.BBb)gc.setVisibility(!pc.Iwa(gc.comment)&&
db)}get frame(){return this.vd}get isRightToLeft(){return this.sIl}set isRightToLeft(db){this.sIl=db}get parentElement(){return this.eo}set parentElement(db){this.eo=db}get sMe(){return this.rcc}get tCi(){return!!h.AFrameworkApplication.ga&&h.AFrameworkApplication.ga.getBooleanAppSetting("SlideResizePerfImprovementEnabled")}}Object(c.a)(Ma,"CommentMarkerView",null,[]);class jc{static J$b(db,gc,Dc,Ua,Nb,hc,Qc){const $c=he.a.uJ();$c.alt=hc;$c.className=Id.e(gc,Nb);$c.setAttribute(Qd.a.pi,Qd.a.BL);$c.src=
db.Yp(gc+".png");$c.setAttribute("Unselectable","on");db=he.a.yx();db.className=Dc+" cui-img-cont-float";db.setAttribute(Qd.a.pi,Qd.a.BL);db.appendChild($c);Dc=he.a.yx();Dc.className=Ua;Dc.setAttribute("Unselectable","on");Dc.setAttribute(Qd.a.pi,Qd.a.BL);Dc.appendChild(db);Ua=he.a.JYa();Ua.className=jc.MIn+" cui-ctl";Ua.title=hc;Ua.setAttribute(Qd.a.pi,Qd.a.BL);Ua.setAttribute(Qd.a.yz,hc);Ua.appendChild(Dc);Qc&&(hc=he.a.yx(),hc.className="cui-ctl-mediumlabel",hc.setAttribute("Unselectable","on"),
hc.setAttribute(Qd.a.pi,Qd.a.BL),hc.innerText=Qc,Ua.appendChild(hc));return Ua}static Nqc(db,gc){return jc.J$b(db,db.vIa,"cui-img-16by16","cui-ctl-iconContainer",gc,CommonUIStrings.l_DialogClose,null)}}jc.KIn="CommentPaneLTR";jc.LIn="CommentPaneRTL";jc.MIn="CommentPaneWithBorderButton";Object(c.a)(jc,"CommentPaneHelper",null,[]);class Lc{constructor(){this.comment=this.slide=null;this.direction=0;this.Hwk=null}}Object(c.a)(Lc,"CommentSelectContext",null,[]);var gd;(function(db){db[db.previous=0]=
"previous";db[db.next=1]="next"})(gd||(gd={}));Object(c.b)("CommentSelectDirection",gd);class Md{constructor(db,gc){if(!db||1>db.length)throw Error.argument("ISlideNode[] slides");if(!gc)throw Error.argumentNull("ICommentGraphManager graphManager");this.uen=db;this.Hz=gc;this.CNj=[];this.init()}get hBa(){return this.uen}get Fta(){return this.CNj}get WEd(){return this.Fta[this.Fta.length-1]}get sbb(){return 1<this.Fta.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton}get gec(){return ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton}get title(){return ResourceStrings.L_CommentReviewResolvedCalloutTitle}get content(){return this.XQn()}init(){for(const db of this.hBa)for(const gc of this.Hz.Iac(db.JV()))if(1===
gc.status){this.CNj.push(db);break}if(1>this.CNj.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");}XQn(){switch(this.Fta.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,this.Fta[1].ph+1,this.Fta[0].ph+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,this.Fta[2].ph+1,this.Fta[1].ph+1,this.Fta[0].ph+1);
case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,this.Fta[3].ph+1,this.Fta[2].ph+1,this.Fta[1].ph+1);default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,this.Fta[this.Fta.length-1].ph+1,this.Fta[this.Fta.length-2].ph+1,this.Fta[this.Fta.length-3].ph+1,this.Fta.length-3)}}ePm(){for(const db of this.Hz.TGd(this.WEd))if(1===db.status)return db;return null}primaryButtonAction(db,gc){if(!gc.presentation||!gc.presentation.slides)return La.a.J(571269902,
805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",gc.presentation?"Presentation.Slides":"Presentation"),null;const Dc=this.ePm();if(!Dc)return null;db.MA.isVisible||db.Y6b();if(gc.Ga&&eg.a.DUa(gc.Ga.Xb,this.WEd.Xb))db.hDb(Dc.commentId,1,!0);else for(const Ua of gc.presentation.slides)if(eg.a.DUa(Ua.Xb,this.WEd.Xb))return Object.assign(new Lc,{slide:this.WEd,comment:Dc,direction:1,Hwk:Hc.a.Fk("SelectResolvedCommentCrossSlide",1)});return null}}Object(c.a)(Md,
"ResolvedCommentsCalloutParams",null,[]);class Kd{constructor(){this.type="SharedCommentsTaskPaneProps";this.focusCallback=null}}Object(c.a)(Kd,"SharedCommentsTaskPaneProps",null,[]);var ye=a(591),Se=a(175),Pe=a(388);class Qf{constructor(db,gc,Dc,Ua,Nb,hc,Qc,$c,Hd,$d,ue,Fe,cf,Ee,xe,cg,Gg,Of,ch,vg,jg,sh,Zh,ae,Wi,ci,Fi,hh,wf,qg,Lh,dh,wg,bg,vh,fi,Jg,Dg,fj,kj,ng,Oh,Tf,Kh,wi,Uf,Ci,Ai,Ii,gj,Ag,Og,aj,Qj,sj,mi,Wj,Ff){this.aOj=this.XD=null;this.q_d=!0;this.zs=this.oEj=this.y4f=this.kEj=this.p0d=!1;this.b5d=
0;this.Gph=this.EHe=!1;this.Ubc=this.pph=this.Gt=this.t$c=this.a7d=this.uqb=this.zGl=null;this.BEj=this.tad=!1;this.zP=null;this.DOj=this.iEj=!1;this.nLl=null;this.wil=[ig.a.jL,ig.a.Sz,ig.a.Wva,ig.a.Dkl];this.lgd=2147483647;this.EZf=0;this.dKl=-1;this.qHl=0;this.Hcg=null;this.dIj=this.Yoh=this.j6d=this.qCj=!1;this.qtb=(oi,Fj)=>{this.dIj=Fj.tbc};this.bsb=(oi,Fj)=>{Fj.slide===this.va.Ga&&(oi=this.ZTa.instance.o6i||this.ZTa.instance.p6i,!Fj.slide.isUnread||oi)&&(Fj=this.Hz.I0(),this.jLe(Fj,h.AFrameworkApplication.isRtl,
!0))};if(!fi)throw Error.argumentNull("appSettingsManager");if(!sh)throw Error.argumentNull("commentEventHost");if(!gc)throw Error.argumentNull("commentTelemetryManager");if(!Ff)throw Error.argumentNull("sorterViewActorLazy");this.dha=Ag;this.ia=Dc;this.Db=Ua;this.MA=Nb;this.Zw=hc;this.ef=Qc;this.Ma=$c;this.qj=Hd;this.rf=$d;this.pa=ue;this.Lc=cf;this.cE=Ee;this.NA=xe;this.Hz=db;this.Pca=gc;this.Lcn=new uj(db);this.Rza=cg;this.va=Gg;this.iqh=Of.Sd(40);this.NKl=ua.a("PreventCommentDraftDeletionOnPageContentChange")?
Of.Sd(7):Of.Sd(8);this.pHe=Fe;this.Soa=cf.Yc?cf.Yc.ndh:null;this.wBb=Wi;this.Tb=vg;this.Z1a=sh;this.F8d=Zh;this.xKl=jg;this.Dph=ae;this.rCj=ci;this.Knh=Fi;this.Jf=qg;this.Uoh=hh;this.Nq=wf;this.Wmh=Lh;this.$o=dh;this.eHe=wg;this.K3=bg;this.EF=vh;this.Fb=fi;this.Io=Dg;this.gIl=fj;this.nab=new f.a;this.ee=kj;this.nb=ng;this.tcc=Tf;this.$bc=Oh;this.Ad=Kh;this.Ia=Ci;this.Ydn=Ai;this.xH=Ii;this.dad=gj;this.Aa=aj;this.Jo=Qj;this.Wya=sj;this.t4f=Uf;this.VJl=!1;this.ia.Bia(this);this.kYd=new Ti(this,this.qj);
this.ZTa=mi;this.lpa=Wj;this.Raa=Ff;if(!Jg)throw Error.argumentNull("InteractiveViewManagerFuture");this.xJl=Jg;this.Gan=this.eAm();this.dha&&this.MA.pLn(this.jRm());this.Aa.isAnimationPreviewEnabled&&this.Ad.H4c(this.qtb);this.l3f=ua.a("DoNotZoomUxControls");this.Pb=Og;wi.Vzd().then(oi=>{oi||this.tzk(!1)})}get Hfh(){return this.gIl}get irl(){return this.$bc}get LAe(){return this.Fb.La("CurrentCommentId")}get isi(){return this.Fb.La("CurrentSlideId")}get lzn(){return this.Fb.getBooleanAppSetting("PPTSafeLinksIsEnabledForModernComments")}get Cym(){return this.Fb.getBooleanAppSetting("CommentTextAnchoringReadWriteEnabled")}get Mhi(){return this.Fb.getBooleanAppSetting("CommentTextAnchoringCreateNewEnabled")}get Epl(){return this.Fb.getBooleanAppSetting("EnableDeleteAllComments")}get tBe(){return ua.a("CompactingDHCsEnabled")}get Yql(){return ua.a("CanvasToCommentFocusFixV2")}get DEe(){return ua.a("AutoShowHideOfCommentsPaneEnabled")}initialize(){this.zs=
1===this.Db.mode;this.dha||(this.wBb?Sys.UI.DomElement.addCssClass(this.pHe,jc.LIn):Sys.UI.DomElement.addCssClass(this.pHe,jc.KIn));const db=this.Ma.gd(ig.a.Sz);db.$V=!0;db.bfc=!0;db.csa(Dc=>{const Ua=!ua.a("FixAltF12KeboardingInCommentPane")||!Dc||Dc.name!==ig.a.s_;this.Bxg(!0,!Dc||Dc.name!==ig.a.jL&&Ua,!0)});db.lSa((Dc,Ua)=>{Dc=(Ua.name===ig.a.FR||Ua.name===ig.a.yba)&&Dc.name===ig.a.Sz;this.Bxg(!1,!1,Ua.name===ig.a.Sz||Ua.name===ig.a.kh||Ua.name===ig.a.jL||Ua.name===ig.a.Wva||Ua.name===ig.a.s_||
Dc)});const gc=this.Ma.gd(ig.a.jL);gc.csa((Dc,Ua)=>{this.vrn(Dc,Ua)});gc.lSa(()=>{this.urn()});this.dha||this.ef.xbb(uc.a.click,this.pHe,Object(Na.a)(this,this.FIe,"onCommentPaneParentDivClick"),null,db.bfc);this.Hb();this.cE.Kye(Object(Na.a)(this,this.Yab,"onBeforeSlideSwitched"));this.cE.Fea(Object(Na.a)(this,this.PWk,"updateCommentsWhenNavigateSlide"));this.NA.g9a(Object(Na.a)(this,this.Hdl,"activeSlideDOMDisplayed"));this.Nq.ifl(Object(Na.a)(this,this.SQl,"onPageViewZoomChanged"));this.Io.d$b(Object(Na.a)(this,
this.onShapeSelected,"onShapeSelected"));this.Io.I4c(Object(Na.a)(this,this.tta,"onShapeDeselected"));this.cE.e$b(Object(Na.a)(this,this.yRl,"onShapeTextSelected"));this.cE.Caf(Object(Na.a)(this,this.fcd,"onSlideBackgroundClicked"));this.t4f&&(this.cE.qSa(Object(Na.a)(this,this.osn,"onSlideSizeUpdated")),this.cE.ufl(Object(Na.a)(this,this.vRl,"onShapeRotatedOrBoundsUpdated")),this.cE.rfl(Object(Na.a)(this,this.vRl,"onShapeRotatedOrBoundsUpdated")));this.iqh.Am(Object(Na.a)(this,this.TRl,"onTextAnchorPropertyChanged"));
this.NKl.fG(Object(Na.a)(this,this.XB,"onChildTopologyChanged"));this.iqh.h9a(Object(Na.a)(this,this.oPl,"onBeforeTextAnchorDisconnect"));this.tcc.Am(Object(Na.a)(this,this.dcd,"onShapePropertyChange"));this.tcc.ffl(Object(Na.a)(this,this.sRl,"onShapeInvalidation"));this.Ad.oel(Object(Na.a)(this,this.SPl,"onF6FocusDocument"));this.Ad.E4c(Object(Na.a)(this,this.bCb,"onSetFocus"));this.lpa.execute(Dc=>{Dc.Oye(this.bsb)});this.Wmh.$td(Object(Na.a)(this,this.OIe,"onSessionExpired"));this.Wmh.sE(Object(Na.a)(this,
this.$Ea,"onSessionEnded"));this.Lc.Yc&&this.Lc.Yc.ndh&&(this.Yab(this,null),this.PWk(this,null));this.Db.PM(Object(Na.a)(this,this.ePl,"onAppModeSwitched"));this.Db.pSa(Object(Na.a)(this,this.d_,"onSetOffline"));this.NA.J4c(Object(Na.a)(this,this.$rh,"onShapeViewElementAddedOrRemoved"));this.NA.ebh(Object(Na.a)(this,this.$rh,"onShapeViewElementAddedOrRemoved"));this.pa.QM(Object(Na.a)(this,this.QH,"onSelectionChanged"))}$rh(db,gc){this.XD&&(db=gc.cI)&&db.shapeNode&&this.o6m(db.shapeNode.slideId)&&
this.XD.Vth(this.Hz.I0())}o6m(db){return!!this.va&&!!this.va.$v&&this.va.$v.equals(db)}tzk(db){this.$bc=this.gIl=db;this.EF.tzk(db)}osn(db,gc){var Dc,Ua,Nb;!this.XD||this.l3f&&(null===(Ua=null===(Dc=null===gc||void 0===gc?void 0:gc.yA)||void 0===Dc?void 0:Dc.zd)||void 0===Ua?void 0:Ua.id)!==(null===(Nb=this.va.Ga)||void 0===Nb?void 0:Nb.id)||this.XD.kYk()}vRl(db,gc){if(this.XD){const Dc=gc.cI.shapeNode;if(Dc){if((db=this.Hz.I0())&&db.length){gc=[];for(const Ua of db)Ua.anchorShape===Dc.get_shapeId()&&
gc.push(Ua);this.XD.RXn(gc)}}else La.a.J(512496785,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")}}erl(){return this.Gt&&this.Gt.nib&&this.va.Ga?!eg.a.DUa(this.Gt.nib,this.va.Ga.Xb):!1}JBe(){return this.Gt&&this.va.Ga?!this.Gt.nib||eg.a.DUa(this.Gt.nib,this.va.Ga.Xb):!1}MGn(){if(this.zP&&this.zP.isIntegratedExtensionEnabled()){const db=this.Hz.I0();db&&0<db.length&&this.Fuh();this.JBe()&&this.NZl(this.Gt)}}drn(){this.Db.F$d(1)}ern(){this.pqf();this.Db.F$d(1)}nrn(db){this.EZf!==
db&&(this.EZf=db,this.Lc&&this.Lc.Yc&&this.Lc.Yc.Dzh(2,!1,this.EZf))}HAl(){const db=Object.assign(new Qh,{paneClosedCallback:Object(Na.a)(this,this.drn,"onPaneClosedCallback"),paneOpenedCallback:Object(Na.a)(this,this.ern,"onPaneOpenedCallback"),positionsUpdatedScrollHeightCallback:Object(Na.a)(this,this.nrn,"onPositionUpdatedScrollHeightCallback")});ua.a("UpdateCommentLoadMetrics")||(db.allContainersVisibleCallback=Object(Na.a)(this,this.eon,"onAllContainersVisible"));this.zP=floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(db)}p2m(){this.lzn&&
this.Ydn.execute(db=>{const gc=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();gc?gc.registerSafelinksNavigator(Object(Na.a)(db,db.U0g,"tryNavigate")):La.a.J(512496783,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}h1m(){this.HAl();this.iEj=!0;const db=this.gBf();vc.a.hJg(db,[uc.a.contextMenu]);if(this.zP){this.zP.setDhcContainerPanel(db,this.wBb);var gc=Object.assign(new hf,{width:parseFloat(db.style.width),height:this.lgd,
x:0,y:0});this.zP.updateViewport(gc);this.zP.setCompactContainers(this.tBe)}this.Fuh();this.Pca.Lpn(this.va.$v);gc=this.Ma.gd(ig.a.Wva);gc.$V=!0;gc.bfc=!0;gc.csa(Dc=>{this.Bxg(!0,!Dc||Dc.name!==ig.a.jL,!0)});gc.lSa((Dc,Ua)=>{Dc=(Ua.name===ig.a.FR||Ua.name===ig.a.yba)&&Dc.name===ig.a.Wva;this.Bxg(!1,!1,Ua.name===ig.a.Sz||Ua.name===ig.a.kh||Ua.name===ig.a.jL||Ua.name===ig.a.Wva||Ua.name===ig.a.s_||Dc)});this.Ma.hEe(ig.a.Wva,ig.a.vl,db,!0);this.RXl();this.ia.za(za.a.Fka,mb.a.frame,Object(Na.a)(this,
this.Fka,"showHideComments"))}Fuh(){const db=this.Hz.I0();this.LZl(db)}RXl(){if(this.zP){const db=this.gBf();if(db){const gc=this.Ma.gd(ig.a.Wva);this.ef.xbb(uc.a.click,db,Object(Na.a)(this,this.FIe,"onCommentPaneParentDivClick"),null,gc.bfc)}}}d9l(){if(this.zP){const db=this.gBf();db&&this.ef.jc(uc.a.click,db,Object(Na.a)(this,this.FIe,"onCommentPaneParentDivClick"))}}gBf(){const db=this.Lc&&this.Lc.Yc?this.Lc.Yc.pdh:null;return db?db.ta:null}LZl(db){if(this.Lc.Yc&&this.iEj){if(!this.zP)try{this.HAl(),
La.a.J(512496782,801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",!!this.zP)}catch(Ua){La.a.J(512496781,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",Ua);return}var gc=Date.now();if((db=this.Vnl(db))&&db.length){var Dc=this.gBf();Dc.setAttribute(Qd.a.pi,"group");if(Dc){this.nab=this.cNm(db);La.a.J(512496780,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",
this.nab.count);if(!this.nab.count&&!this.pSd){La.a.J(512496779,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",Date.now()-gc);return}this.zP.setDhcContainerPanel(Dc,this.wBb);this.zP.attachContainers(this.nab.toArray())}La.a.J(512496778,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",Date.now()-gc)}}}Vnl(db){if(!db||!db.length)return db;const gc=new f.a;for(const Dc of db)0!==Dc.status?this.Unl(Dc.commentId):gc.add(Dc);return gc.toArray()}nYn(){this.qCj=
!1;if(!this.EF.E5l&&!this.EF.OSa&&this.Lc.Yc){var db=this.Hz.TGd(this.Lc.Yc.zd);for(const gc of db)if(0===gc.status){this.selectComment(gc,null,!0,!0,0,0,!1);break}}}sTm(){if(!this.Lc||!this.Lc.Yc||!this.Lc.Yc.zd)return this.lgd;var db=this.Lc.Yc.zd;if(isNaN(db.ek))return this.lgd;db=db.ek;return 0>db?this.lgd:db}Atl(db){var gc=this.EF.Vib(db);db=db.pos.Y;gc&&(db+=gc.MR.y,gc.wg&&(gc=this.Ia.Dr(gc),db+=gc&&gc.MR?gc.MR.y:0));return this.tqc(0,db).y}ZWk(){if(this.zP){const db=this.sTm();db!==this.dKl&&
(this.dKl=db,this.zP.setSlideHeight(db))}}NZl(db){if(db&&0===db.S5c){var gc=0;if(this.tBe)gc=-this.lgd,this.ZWk();else{const Dc=this.pa.lo();Dc&&(gc=this.tqc(0,Dc.MR.y).y)}gc=Object.assign(new Eg,{contentId:db.Y4.draftId,containerContentType:0,anchorTop:gc,anchorLeft:0});this.zP.setDhcContainerPanel(this.gBf(),this.wBb);this.zP.updateDrafting(gc,!0);this.zP.selectContainer(db.Y4.draftId,!0)}}ZGn(db){if(this.nab){var gc=0,Dc="";if(this.tBe){var Ua=this.pa.lo();Ua&&(gc=this.tqc(0,Ua.MR.y).y);if(Ua=
this.Hz.I0())for(const Nb of Ua)ac.a.rb(Nb.commentId)||this.Atl(Nb)!==gc||(Dc=Nb.commentId)}gc=Object.assign(new Eg,{contentId:db,containerContentType:0,anchorTop:gc,anchorLeft:0});this.tBe?this.zP.updateDraftingAndPosition(gc,!1,Dc):this.zP.updateDrafting(gc,!1);this.zP.selectContainer(db,!0)}}Unl(db){if(this.zP&&this.nab)for(const gc of this.nab)Qf.qNl(gc,db)&&(this.zP.detachContainers([gc]),this.nab.remove(gc))}lLn(){this.qCj=!0}qfh(){this.MA&&this.MA.isVisible&&this.MA.DJn()}hIm(){var db=this.va.presentation;
if(!db)return!1;db=db.slides;if(!db)return!1;for(const gc of db)if(db=Object(aa.a)(Ac.a,gc))for(const Dc of this.Hz.Iac(db.JV()))if(pc.Iwa(Dc))return!0;return!1}dWi(db){var gc=this.va.presentation;if(!gc)return null;gc=gc.slides;if(!gc)return null;for(const Dc of gc)if(gc=Object(aa.a)(Ac.a,Dc),eg.a.DUa(gc.Xb,db))return gc;return null}dIm(){return this.Mhi||this.Cym&&this.hIm()}Vwl(){const db=this.pa.Ua.mb,gc=this.pa.Ua.t_;if(!db||!gc)return null;var Dc=Object(aa.a)(427,db.Xa.node),Ua=Object(aa.a)(427,
gc.Xa.node);if(!Dc||!Ua)return null;Dc=Object(aa.a)(rh.TableCellNode,Dc.KV());Ua=Object(aa.a)(rh.TableCellNode,Ua.KV());return Dc&&Ua?Dc.rowIndex>Ua.rowIndex?db:gc:null}mUm(){if(!this.dIm()||!this.pa.g8())return null;La.a.J(512496777,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");var db=0,gc=0;if(this.pa.Ua.nk){var Dc=this.Vwl();if(!Dc)return La.a.J(512496776,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null;var Ua=
Dc}else Ua=this.pa.Ua.mb;if(!Ua)return La.a.J(512496775,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),null;const Nb=({vDb:db,Tzb:gc}=pc.lUm(this.pa.c8(),Ua,db,gc)).returnValue;if(!Nb||0>db||0>gc||0>=gc-db)return La.a.J(512496774,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",!Nb,gc,db),null;Dc=new Kg.a;Dc.StartPos=db;Dc.EndPos=gc;if(this.pa.d1a()&&
Nb.get_smartArtModelId()){La.a.J(512496773,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");Dc.AnchoringShape=new ag.a;db=D.a.Xf(Nb.get_smartArtModelId()).toString();if(!db||!D.a.isValid(db))return La.a.J(512496772,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!db),null;Dc.AnchoringShape.SmartArtNodeId=db;this.Pca.X$m()}else if(Nb.kt()){La.a.J(512496771,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");
gc=Object(aa.a)(rh.TableCellNode,Nb.KV());if(!gc)return La.a.J(512496770,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),null;db=gc.rowId.toString();gc=gc.cellId.toString();if(!(db&&gc&&D.a.isValid(db)&&D.a.isValid(gc)))return La.a.J(512496769,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",!db,!gc),null;Dc.AnchoringShape=new ag.a;Dc.AnchoringShape.TableCell=new $f;Dc.AnchoringShape.TableCell.RowId=
db;Dc.AnchoringShape.TableCell.ColId=gc;this.Pca.Y$m()}db=Object(aa.a)(427,Ua.Xa.node);Ua=Object(aa.a)(427,Ua.mf.node);db!==Ua&&this.Pca.$$m();La.a.J(512496768,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");return Dc}$Dm(db){if(this.zP&&db)for(const gc of this.nab.toArray()){let Dc=!1;for(const Ua of db)if(Qf.qNl(gc,Ua.commentId)){Dc=!0;break}Dc||(this.zP.detachContainers([gc]),this.nab.remove(gc),La.a.J(512496739,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",
gc.contentId))}}pqf(){if(this.zP){for(const db of this.nab.toArray())this.zP.detachContainers([db]);this.nab.clear()}}YKk(db){if(!db)return null;db.sort((gc,Dc)=>{var Ua=this.EF.Vib(gc);Ua=Ua?Ua.MR:new md.a(0,0);var Nb=this.EF.Vib(Dc);Nb=Nb?Nb.MR:new md.a(0,0);Ua.y+=gc.pos.Y;Nb.y+=Dc.pos.Y;Ua.x+=gc.pos.X;Nb.x+=Dc.pos.X;let hc=Ua.y-Nb.y;hc||(hc=Ua.x-Nb.x)||(hc=+gc.dt-+Dc.dt);return hc});return db}cNm(db){const gc=new f.a;if(db){this.tBe&&this.ZWk();for(const Dc of db)ac.a.rb(Dc.commentId)||(db=this.Atl(Dc),
db=Object.assign(new Eg,{contentId:Dc.commentId,containerContentType:0,anchorTop:db,anchorLeft:0}),gc.add(db))}return gc}d_(db){this.tQl(db)}pYl(db,gc){for(let Dc=0;Dc<db.Za.length;Dc++){const Ua=db.Za.ha(Dc);if(!Ua.Sg)continue;const Nb=[];for(let hc=0;hc<Ua.Sg.length;hc++){const Qc=Ua.Sg.ha(hc);Qc.jG.equals(gc)&&Nb.push(Qc)}if(!(1>Nb.length))try{db.TQa=!0;for(const hc of Nb)Ua.Sg.remove(hc)}catch(hc){La.a.J(512496738,805,10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",
hc.toString())}finally{db.TQa=!1}}}Odl(db,gc,Dc){db.Sg||(db.Sg=new Eh.a(db));const Ua=db.Sg.Pe.paragraph;gc=new uh.a(db.Sg.Pe,null,gc,Dc);db.Sg.add(gc);Ua.uu()}Ndh(db){return ed.a.Xf("{"+db+"}{1}")}H9e(db,gc,Dc,Ua){let Nb=null;for(let hc=0;hc<db.Za.length;hc++){let Qc=db.Za.ha(hc);if(Qc.cp>=Dc){try{db.TQa=!0;if(Qc.cp>Dc||!Qc.formatting)this.xH.Lba(db,hc,Dc,Nb),Qc=db.Za.ha(hc);this.Odl(Qc,gc,Ua)}catch($c){La.a.J(512496737,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",
$c.toString())}finally{db.TQa=!1}return}Qc.formatting&&(Nb=Qc.formatting)}if(wb.ParagraphReader.textLength(db)>=Dc)try{db.TQa=!0;this.xH.Lba(db,db.Za.length,Dc,Nb);const hc=db.Za.ha(db.Za.length-1);this.Odl(hc,gc,Ua)}catch(hc){La.a.J(512496736,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",hc.toString())}finally{db.TQa=!1}}Lsf(){var db=this.Hz.I0();if(db){var gc=Date.now(),Dc=!1,Ua=new ta.a;for(var Nb of db){var hc=pc.LHf(Nb,this.EF.Vib(Nb));
Ua.K(Nb.commentId,hc)}for(var Qc of db)if(Qc.textAnchoringInfo&&(Nb=this.EF.Vib(Qc))&&(hc=Ua.ha(Qc.commentId),!hc||!hc.isValid||hc.$Dl(Qc.textAnchoringInfo)))for(var $c of Nb.wI())this.pYl(Object(aa.a)(bb.AParagraphNode,$c),this.Ndh(Qc.commentId));for(const Hd of db)if((db=Ua.ha(Hd.commentId))&&db.isValid&&db.$Dl(Hd.textAnchoringInfo)&&(this.MA.isVisible||0===Hd.status)){Dc=this.Ndh(Hd.commentId);this.H9e(db.PQa,Dc,db.startPos,!0);if(db.WUf)for(Qc=1;Qc<db.paragraphs.length;Qc++){if($c=db.paragraphs[Qc])this.H9e($c,
Dc,0,!0),db.$Sa.equals($c)?this.H9e(db.$Sa,Dc,db.endPos,!1):this.H9e($c,Dc,wb.ParagraphReader.textLength($c),!1)}else this.H9e(db.$Sa,Dc,db.endPos,!1);db.d3m();Dc=!0}Dc&&La.a.J(512496735,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",Date.now()-gc)}}TRl(db,gc){if((db=this.Hz.Hac(gc.node))&&(gc.property===Tc.a.f_c||gc.property===Tc.a.e_c||gc.property===Tc.a.Ere||gc.property===Tc.a.Fre)){const Dc=pc.Iwa(db);Dc&&this.Lsf();!db.textAnchoringInfo||Dc||gc.property!==Tc.a.Fre&&
gc.property!==Tc.a.Ere||this.Pca.Z$m(db,this.Ndh(db.commentId),this.EF.Vib(db),this.Lc.Yc.Oa)}}Spl(){this.Gt&&this.uqb&&(this.Z1a.yxk(this.uqb.length,this.b5d,this.zs,this.rCj.Hlh),this.Z1a.Ixk(Array.clone(this.uqb),Array.clone(this.a7d)),this.Ajl(2))}E6m(db,gc){gc=this.Pb.Hc(gc);for(var Dc=gc.Bb(2);Dc;Dc=gc.xf(2))if((Dc=Object(aa.a)(31,Dc))&&eg.a.DUa(Dc.Xb,db))return!0;return!1}XB(db,gc){gc&&(db=Object(aa.a)(571,gc.node),gc=gc.MZ,db&&2===gc&&((gc=this.Rza.Qf)&&gc.slides&&0>=gc.slides.length&&this.MA.isVisible&&
this.XIg(!1,!1),this.Gt&&(gc=this.Gt.nib,!gc&&this.va.Ga&&(gc=this.va.Ga.Xb),this.E6m(gc,db)||this.Spl())))}oPl(db,gc){if((db=this.Hz.Hac(gc.node))&&pc.Iwa(db)&&(gc=this.EF.Vib(db)))for(const Dc of gc.wI())this.pYl(Object(aa.a)(bb.AParagraphNode,Dc),this.Ndh(db.commentId))}sRl(db,gc){(db=Object(aa.a)(426,gc.node))&&0<db.wI().length&&(gc.Rdj&192||gc.Rdj&4)&&this.Lsf()}dcd(db,gc){db=gc.property;gc=gc.node;if(db===pd.a.hx||db===pd.a.ix)if(db=this.Hz.I0()){for(const Dc of db)Dc.pos.Y=gc.MR.y,Dc.pos.X=
gc.MR.x;this.Fuh()}}OIe(){La.a.J(512496734,805,this.uyc?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",this.uyc)}$Ea(db,gc){La.a.J(512496733,805,this.uyc?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",ye.a[gc.aI],this.uyc)}dispose(){this.XD&&(this.XD.dispose(),this.XD=null);this.eHe&&(this.eHe.dispose(),this.eHe=null);this.cE.puh(Object(Na.a)(this,this.Yab,"onBeforeSlideSwitched"));this.cE.b6a(Object(Na.a)(this,this.PWk,"updateCommentsWhenNavigateSlide"));
this.cE.R4b(Object(Na.a)(this,this.Hdl,"activeSlideDOMDisplayed"));this.Nq.mZl(Object(Na.a)(this,this.SQl,"onPageViewZoomChanged"));this.Io.BLe(Object(Na.a)(this,this.onShapeSelected,"onShapeSelected"));this.Io.yuh(Object(Na.a)(this,this.tta,"onShapeDeselected"));this.cE.QUc(Object(Na.a)(this,this.yRl,"onShapeTextSelected"));this.cE.zuh(Object(Na.a)(this,this.fcd,"onSlideBackgroundClicked"));this.tcc.Pq(Object(Na.a)(this,this.dcd,"onShapePropertyChange"));this.tcc.kZl(Object(Na.a)(this,this.sRl,"onShapeInvalidation"));
this.Ad.GYl(Object(Na.a)(this,this.SPl,"onF6FocusDocument"));this.Ad.xLe(Object(Na.a)(this,this.bCb,"onSetFocus"));this.lpa.execute(db=>{db.Buh(this.bsb)});this.iqh.Pq(Object(Na.a)(this,this.TRl,"onTextAnchorPropertyChanged"));this.NKl.PO(Object(Na.a)(this,this.XB,"onChildTopologyChanged"));this.iqh.zbb(Object(Na.a)(this,this.oPl,"onBeforeTextAnchorDisconnect"));this.Db.R3(Object(Na.a)(this,this.ePl,"onAppModeSwitched"));this.Wmh.QKg(Object(Na.a)(this,this.OIe,"onSessionExpired"));this.Wmh.F8(Object(Na.a)(this,
this.$Ea,"onSessionEnded"));this.Db.UCb(Object(Na.a)(this,this.d_,"onSetOffline"));this.dha||this.ef.jc(uc.a.click,this.pHe,Object(Na.a)(this,this.FIe,"onCommentPaneParentDivClick"));this.d9l();this.Soa=this.pHe=null;this.NA.CLe(Object(Na.a)(this,this.$rh,"onShapeViewElementAddedOrRemoved"));this.NA.vZl(Object(Na.a)(this,this.$rh,"onShapeViewElementAddedOrRemoved"));this.pa.Bbb(Object(Na.a)(this,this.QH,"onSelectionChanged"))}get isReadOnly(){return this.zs}get pSd(){return!!this.Gt}get hasFocus(){return this.kEj}eAm(){const db=
new Se.a;var gc=new lf(za.a.ebc,ug.a.application);gc.preCallback=Object(Na.a)(this,this.$ch,"claimFocus");gc.postCallback=Object(Na.a)(this,this.tol,"disableOnEmptyDeckAndReadOnly");db.K(0,gc);gc=new lf(za.a.deleteComment,ug.a.application);gc.preCallback=Object(Na.a)(this,this.$ch,"claimFocus");gc.postCallback=Object(Na.a)(this,this.tol,"disableOnEmptyDeckAndReadOnly");db.K(3,gc);gc=new lf(za.a.JKe,ug.a.application);gc.preCallback=Object(Na.a)(this,this.$ch,"claimFocus");gc.postCallback=Object(Na.a)(this,
this.iUl,"postCommentAction");db.K(2,gc);gc=new lf(za.a.vIe,ug.a.application);gc.preCallback=Object(Na.a)(this,this.$ch,"claimFocus");gc.postCallback=Object(Na.a)(this,this.iUl,"postCommentAction");db.K(1,gc);gc=new lf(hb.a.ose,ug.a.application);gc.preCallback=Object(Na.a)(this,this.SPn,"showHideActionPreCallback");gc.postCallback=Object(Na.a)(this,this.RPn,"showHideActionPostCallback");gc.delayActionsUntilRegistration=this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&ua.a("DelayCommentsShowHideAction");db.K(6,gc);return db}SPn(db,gc,Dc,Ua,Nb){if(1===Dc)return!this.va.Ga||this.isDisabled?8:2;La.a.J(36983504,805,50,"New Comment Pane opened.");this.MA.F$d(!!Nb&&Nb.AutoShowHide);return 2}RPn(db,gc,Dc,Ua,Nb,hc){if(1===Ua)return db&&this.Pca.Kon(this.va.$v),db?32:8;this.Vfl(this.MA.isVisible,!!hc&&hc.AutoShowHide);return db?32:8}$ch(db,gc,Dc,Ua,Nb){if(1===Dc&&this.pa.sTa())return 8;1!==Dc&&((this.y4f=!!Nb&&Nb.ShouldCanvasTakeFocus)||this.jac(),this.pa.Rw(),this.oEj=
!0);return 2}iUl(db,gc,Dc,Ua){if(1===Ua&&(this.tad||!this.uqb)||this.dIj&&this.Aa.isAnimationPreviewEnabled)return 8;this.y4f=!1;return db?32:8}tol(db,gc,Dc,Ua){return(1!==Ua||!this.zs&&this.uqb)&&this.Lc.Yc?db?32:8:8}tqc(db,gc){return new md.a(this.Uoh.ke(db,0),this.Uoh.ke(gc,1))}Mll(db,gc){return new md.a(this.Uoh.vf(db,0),this.Uoh.vf(gc,1))}tCe(db){db=this.Hz.CPb(db);return this.Hz.Hac(db)}hDb(db,gc,Dc){!this.erl()||db!==this.Gt.Y4.draftId&&db!==this.Gt.commentId?this.JBe()&&db===this.Gt.Y4.draftId?
(this.Z1a.selectComment(db),this.zP&&this.zP.selectContainer(db,!0),this.Yql&&!this.hasFocus&&1!==gc&&this.jac()):this.selectComment(this.tCe(db),null,!0,!0,0,gc,Dc):(db=this.dWi(this.Gt.nib),db)?1!==gc&&(this.Gt.hlh=!0,this.Raa.instance&&this.Raa.instance.x8(db.ph)):(La.a.J(512496732,805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),this.endCommentSession(this.Gt.Y4.draftId,0))}selectComment(db,gc,Dc,Ua,Nb,hc,Qc){this.pa.Rw();gc=this.lPg?
this.lPg.commentId:null;Qc||this.qfh();0!==hc?db?this.Z1a.selectComment(db.commentId):this.Z1a.selectComment(null):0===hc&&(hc=this.EF.Vib(db))&&hc.nJ&&this.EF.Dvh(zf[hc.nJ]);this.XD&&this.XD.selectComment(db,!0);!this.MA.isVisible&&this.zP&&db&&db!==this.t$c&&(hc=this.Hz.eUi(db.commentId))&&(hc=this.Hz.Hac(hc),this.zP.selectContainer(hc.commentId,!this.y4f&&!Qc&&!this.oEj),this.oEj=!1,this.Lc&&this.Lc.Yc&&this.Lc.Yc.C3g(5,!1,this.EZf));Qc||this.y4f||this.jac();!this.EF||!this.MA.isVisible&&this.MA.isVisible||
(this.EF.Iwk(db,gc,!0,!1,Qc),pc.Iwa(db)&&!Qc&&this.Lsf());this.Db.Zf()}get lPg(){return this.XD&&this.XD.sMe?this.XD.sMe.comment:null}FJn(){if(!this.tad){const db=Hc.a.Fk("SelectNextCommentCrossSlide",1),gc=!this.MA.isVisible;this.tad=!0;this.Knh.hEi((Dc,Ua)=>{this.WPl(Dc,Ua,1,db)},db,gc)}}HJn(){if(!this.tad){const db=Hc.a.Fk("SelectPreviousCommentCrossSlide",1),gc=!this.MA.isVisible;this.tad=!0;this.Knh.rEi((Dc,Ua)=>{this.WPl(Dc,Ua,0,db)},db,gc)}}WPl(db,gc,Dc,Ua){Ua.km("FindCommentEndTime",new Date);
this.Tb.Qb(new fc.a(2,1,100,()=>{this.tad&&(this.tad=!1,this.uOn(db,gc,Dc)?this.hDb(this.Gt.commentId||this.Gt.Y4.draftId,0,!1):gc&&db&&this.Lc.Yc.zd?db.Xb.equals(this.Lc.Yc.zd.Xb)?(this.selectComment(gc,null,!0,!0,2,1,!1),Ua.Ya("CircularSelectCommentInSingleSlide",gd[Dc]),Ua.finish()):(this.Ubc=Object.assign(new Lc,{slide:db,comment:gc,direction:Dc,Hwk:Ua}),this.Raa.instance&&this.Raa.instance.x8(db.ph)):(this.Db.Zf(),Ua.Ya("NoCommentFound",gd[Dc]),Ua.finish()))},90,"47"))}Wul(){let db=-1;if(!this.Gt)return db;
if(this.Gt.nib){const gc=this.dWi(this.Gt.nib);gc&&(db=gc.ph)}else this.Lc.Yc&&this.Lc.Yc.zd&&(db=this.Lc.Yc.zd.ph);return db}uOn(db,gc,Dc){if(!this.Gt||this.Gt.Y4.sessionType!==Wa.create)return!1;const Ua=this.Wul();if(0>Ua)return!1;if(!gc||!db)return!0;gc=this.Lc.Yc.zd.ph;if(1===Dc)return Dc=Ua<=gc&&gc<db.ph,gc=db.ph<=gc&&gc<Ua,Ua<=db.ph&&!Dc||gc;Dc=Ua>=gc&&gc>db.ph;gc=db.ph>=gc&&gc>Ua;return Ua>db.ph&&!Dc||gc}Ofd(db){0!==db&&this.Z1a.selectComment(null);this.XD&&this.XD.selectComment(null,!1);
if(this.zP&&(this.zP.deselectContainer(),this.Lc&&this.Lc.Yc)){let gc=5;const Dc=this.pa.lo();Dc&&Dc.rg&&(gc=2);this.Lc.Yc.C3g(gc,!1,this.EZf)}this.EF&&0!==db&&(this.EF.oeh(),this.EF.heh());this.Db.Zf()}Gnm(db){this.vye(this.tCe(db),0)}vye(db,gc){this.t$c!==db&&(this.EF&&(db?this.EF.Fnm(db):this.EF.heh()),this.t$c=db,0!==gc&&(this.t$c?this.Z1a.highlightComment(this.t$c.commentId):this.Z1a.highlightComment(null)),this.XD&&this.XD.vye(this.t$c,!0))}EJn(){this.MA.isVisible||this.Y6b();if(this.LAe){var db=
this.tCe(this.LAe),gc=this.Lc.Yc.zd.sid,Dc=gc===parseInt(this.isi);if(db){1!==db.status&&2!==db.status||this.Y6b();if(ua.a("FixDeepLinkedCommentsPPTO")){gc=this.Hz.I0();const Ua=0<(null===gc||void 0===gc?void 0:gc.length);let Nb=0;const hc=()=>{Ua&&this.MA.isVisible?this.selectComment(db,null,!0,!0,0,1,!1):Nb<this.Aa.Jc("maxCommentsPaneLoadedRetries",10)&&(r.a.V9b(this.Tb,hc),Nb++)};r.a.V9b(this.Tb,hc)}else this.selectComment(db,null,!0,!0,0,1,!1);this.Pca.bpn(this.va.$v);La.a.J(512496730,804,15,
"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",this.LAe,this.isi)}else Dc&&this.ee.Zr(Object.assign(new Df.a,{Code:389,Source:4}),this.nb.podSessionId),La.a.J(512496731,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",this.LAe,this.isi,parseInt(gc))}}get manager(){return this.Hz}get vIa(){return"per"}get oNl(){return this.Soa}set oNl(db){this.Soa=db;this.XD&&(this.XD.parentElement=db)}get kOl(){return this.Hcg}set kOl(db){this.Hcg=
db}Vth(db){this.jLe(db,void 0,!0)}fia(db,gc){gc=!ua.a("FixAltF12KeboardingInCommentPane")||gc;this.Bxg(db,gc,!0)}Ekk(){!this.dha&&this.MA&&(this.pHe.style.display=this.MA.isVisible?"flex":"none");this.XD&&(this.XD.setVisibility(this.q_d),this.XD.J4l(this.p0d),this.EF.VAe(this.t$c))}XIg(db,gc){this.E8l(db,gc);this.Ekk();this.Vfl(db,gc)}SQl(){this.XD&&!this.t4f&&this.XD.kYk();this.Fuh();this.tBe&&this.ZWk()}qAn(){this.tad=!1;this.$pl();this.XD&&this.XD.Amk();this.EHe=!1;this.d9l()}$pl(){this.Hz.j9l()}Yab(){const db=
this.DQf(),gc=db&&this.Aa.getBooleanAppSetting("EnableTelemetryLogging")?new Pe.a("SharedCommentFrame::onBeforeSlideSwitched",za.a.oF):ua.a("LogPasteSlideStepTime")&&this.ia.Bz(za.a.fE)?new Pe.a("SharedCommentFrame::onBeforeSlideSwitched",za.a.fE):void 0;null===gc||void 0===gc?void 0:gc.Cf("ST");this.VJl=this.c7c()||this.JBe();this.EF&&this.VJl&&(this.EF.oeh(),this.EF.heh());null===gc||void 0===gc?void 0:gc.Cf("TB_prepareForSlideSwitch");this.qAn();null===gc||void 0===gc?void 0:gc.Cf("TA_prepareForSlideSwitch");
!ua.a("DuplicateSlideRunAutoShowHideCommentsPane")&&(this.Aa.getBooleanAppSetting("OptimizeSetActiveSlideForDuplicateSlide")&&db||ua.a("PasteSlideSkipCode")&&this.ia.Bz(za.a.fE))?null===gc||void 0===gc?void 0:gc.Cf("Skipped_AutoShowHideCommentsPane"):this.rtm();null===gc||void 0===gc?void 0:gc.Cf("ET");null===gc||void 0===gc?void 0:gc.BM()}FOn(){return this.Gt&&this.Gt.nib&&this.va.Ga?this.Gt.hlh&&eg.a.DUa(this.Gt.nib,this.va.Ga.Xb):!1}PWk(){this.va.Ga||this.Yab(this,null);this.$pl();this.Lc.Yc&&
(this.oNl=this.Lc.Yc.ndh);const db=this.Lc&&this.Lc.Yc?this.Hz.TGd(this.Lc.Yc.zd):this.Hz.I0(),gc=this.CPm(db),Dc=this.c7c()||this.JBe();this.j6d||Dc||(this.Jo.Lbd(this.Jo.gxd,this.Jo.xyd),this.j6d=!0);this.MA.isVisible||(Dc?(this.pqf(),this.MGn()):this.c7c()&&this.pqf(),this.RXl());this.jLe(db,h.AFrameworkApplication.isRtl,!1,gc);ua.a("OpenPaneWhenMovingToAnotherSlideUsingPrevNextComment")&&!this.MA.isVisible&&this.Ubc&&-1!==gc&&this.Y6b();this.FOn()?(this.hDb(this.Gt.commentId||this.Gt.Y4.draftId,
0,!1),this.Gt.hlh=!1):-1<gc&&this.hDb(db[gc].commentId,0,!1);this.Ubc&&(this.Ubc.Hwk.finish(),this.Ubc=null);this.Tfd(!1);-1!==gc&&this.XD&&(this.XD.vye(null,!1),this.XD.selectComment(db[gc],!1))}Hdl(){if(this.DOj){try{this.kYd.yQn(this.nLl,this.va,this.Jf)}catch(db){La.a.J(512496729,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",db)}this.DOj=!1}}Tfd(db){const gc=this.Wul();this.rCj.Tfd(db,gc)}A9l(db){this.Gt&&!this.Gt.nib&&(this.Gt.nib=db)}onShapeSelected(db,
gc){this.Hfh&&(db=gc.shapeNode,this.xEk(db),db&&0<db.wI().length&&this.Lsf())}yRl(db,gc){this.Hfh&&(this.xEk(gc.cI.shapeNode),this.Lsf())}QH(db,gc){if(gc&&gc.Ok&&this.pa.g8()&&(db=this.Hz.I0())){gc=!1;for(var Dc of db)if(pc.Iwa(Dc)){gc=!0;break}gc&&((Dc=this.pa.c8())?this.xEk(Dc):La.a.J(512496728,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}}xEk(db){db.get_shapeId()&&(this.EF&&db!==this.EF.OSa&&this.Ofd(1),this.r1l(db.get_shapeId(),!0))}r1l(db,
gc){var Dc=this.Hz.I0();if(Dc){var Ua=null,Nb=null,hc=0,Qc=null;for(const $c of Dc)if((this.MA.isVisible||0===$c.status)&&$c.anchorShape===db)if(this.pa.g8()&&pc.Iwa($c)){Dc=this.pa.Ua.mb.Xa;const Hd=this.pa.Ua.mb.mf,$d=pc.LHf($c,this.EF.Vib($c));$d&&$d.isValid?(this.lPg&&this.lPg.commentId===$c.commentId||$d.Ayh===$c.textAnchoringInfo.TextBodyLength)&&$d.b4m(Dc,Hd)&&(Nb?(Dc=$d.$Wl,Dc<hc&&(Nb=$c,hc=Dc)):(Nb=$c,hc=$d.$Wl)):(Ua=$c,La.a.J(512496727,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null."))}else Nb||
Qc||pc.Iwa($c)||(Qc=$c);Nb?this.hDb(Nb.commentId,1,gc):Qc?this.hDb(Qc.commentId,1,gc):this.pa.g8()&&!Ua?this.EF&&this.Ofd(1):Ua&&this.hDb(Ua.commentId,1,gc)}}tta(){if(this.Hfh){var db=this.RLi();this.EF.Dvh(String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,db.toString()));this.Ofd(1)}}RLi(){const db=this.Hz.I0();let gc=[];db&&(gc=Mh.e(db,Dc=>0===Dc.status));return gc.length}fcd(){this.Hfh&&this.Ofd(1)}SPl(db,gc){gc.SBb===ig.a.kh&&this.EF.Dvh(ResourceStrings.l_SlidePanel+", "+
String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,this.RLi().toString()));gc.f3b===ig.a.kh&&this.Ofd(1)}bCb(db,gc){this.Yql&&gc.SBb!==ig.a.Wva&&(gc.f3b===ig.a.Wva||ig.a.jL)&&this.uyc&&this.Ofd(1)}CPm(db){let gc=-1;if(this.Ubc&&this.Lc.Yc)if(this.Ubc.slide!==this.Lc.Yc.zd)La.a.J(512496726,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");else if(db&&0<db.length){if(this.MA.isVisible)gc=1===this.Ubc.direction?0:db.length-1;else if(1===
this.Ubc.direction)for(var Dc=0;Dc<db.length;Dc++){if(0===db[Dc].status){gc=Dc;break}}else for(Dc=db.length-1;0<=Dc;Dc--)if(0===db[Dc].status){gc=Dc;break}0<=gc&&gc<db.length&&(db=db[gc],Dc=this.Ubc.comment,Dc.dt===db.dt&&Dc.commentId===db.commentId&&Dc.authorName===db.authorName||La.a.J(512496725,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide"))}return gc}kZj(){!this.Hz.lPm()||this.Yoh?(this.jLe(this.Hz.I0(),h.AFrameworkApplication.isRtl,!0),this.Yoh&&(this.Yoh=
!1)):this.Gt&&(0===this.Gt.S5c||1===this.Gt.S5c?(this.irl&&this.jLe(this.Hz.I0(),h.AFrameworkApplication.isRtl,!0),0===this.Gt.S5c&&(this.Gph=!0)):this.Gt&&2===this.Gt.S5c&&this.irl&&this.jLe(this.Hz.I0(),h.AFrameworkApplication.isRtl,!0))}Non(){Ad(this.Fb)&&(this.Yoh=!0,this.kZj())}get Avh(){const db=this.pa.lo();if(db){const gc=db.MR;this.aOj=new md.a(h.AFrameworkApplication.isRtl?gc.x:gc.x+db.Tv,gc.y)}else this.aOj=null;return this.aOj}get NJn(){if(!this.pa.g8())return null;var db=Object(aa.a)(427,
this.pa.Ua.mb.mf.node);if(!db)return null;const gc=Object(aa.a)(988,db.tc(this.Lc.Yc.Oa));if(!gc)return null;var Dc=null,Ua=gc.htmlElement.getElementsByClassName("Selected");if(0<Ua.length)Dc=Ua[Ua.length-1];else if(this.pa.Ua.nk){if(Ua=this.Vwl())if(Ua=Object(aa.a)(427,Ua.mf.node))if(Ua!==db){if(db=Object(aa.a)(988,Ua.tc(this.Lc.Yc.Oa)))Dc=db.htmlElement}else Dc=gc.htmlElement}else return null;db=this.pa.lo();if(!db||!Dc)return null;db=Object(aa.a)(284,db.tc(this.Lc.Yc.Oa));if(!db)return null;Dc=
yf.a.Ni(Dc);db=yf.a.Ni(db.Yn);if(0>=Dc.width+Dc.height&&0>=db.width+db.height)return null;db=md.a.tu(new md.a(Dc.x,Dc.y),new md.a(db.x,db.y));return this.Mll(db.x+Dc.width-5,db.y+10)}get anchorNode(){const db=this.pa.lo();return this.zGl=db?db:this.Lc.Yc.zd}E8l(db,gc){this.MA&&(this.DEe||gc||this.uzk(),this.F8d.k3l(db?3:1),!this.isDisabled&&db&&ua.a("CommentShimmerBugFix")&&this.Wya&&this.Wya.isVisible&&(this.Wya.hjh(),this.Db.F$d(1)),this.MA.wA(!this.isDisabled&&db,gc),this.MA.isVisible&&(this.q_d=
!0))}kWn(db){this.MA&&(this.q_d=!this.isDisabled&&db,this.q_d||(this.F8d.k3l(1),this.MA.wA(!1,!1),this.Ma.lm(ig.a.Sz,!1)))}jRm(){const db=new Kd;db.focusCallback=Object(Na.a)(this,this.qgh,"focusFirstPaneElement");return Object.assign(new ff.a,{title:ResourceStrings.L_Comments,hideHeader:!1,width:parseInt(this.j5n?300:320),contentProps:db,location:2,onOpen:gc=>{this.DEe&&!this.c7c()&&(this.BEj=!0);vc.a.hJg(gc,[uc.a.contextMenu]);const Dc=this.Ma.gd(ig.a.Sz);this.ef.xbb(uc.a.click,gc,Object(Na.a)(this,
this.FIe,"onCommentPaneParentDivClick"),null,Dc.bfc)},onClose:gc=>{this.XIg(!1,!1);this.ef.jc(uc.a.click,gc,Object(Na.a)(this,this.FIe,"onCommentPaneParentDivClick"));this.DEe&&this.uzk()},isModernPane:!0})}rtm(){if(!this.BEj){var db=this.Hz.I0();db=!!db&&0<db.length;La.a.J(512496722,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",db);db?this.c7c()&&this.DEe&&this.Y6b():this.DEe?this.ezl():this.pqf()}}Y6b(){this.MA.isVisible||this.ia.Cb(za.a.Fka,2);this.qfh()}ezl(){this.MA.isVisible&&
this.ia.Cb(za.a.Fka,2)}Yp(db){return this.rf.Yp(db)}get isDisabled(){const db=this.Rza.Qf;return!db||this.Aa.isAnimationPreviewEnabled&&this.dIj?!0:db.B$a}PZh(){this.pph||(this.pph=new fc.a(0,1,0,Object(Na.a)(this,this.NDn,"refreshCommentsTask"),90,"48"),this.Tb.Qb(this.pph))}ePl(db){this.tQl(1===db.mode)}tQl(db){this.zs=db;this.PZh();ua.a("PreventCommentPaneCloseOnReadOnlyChanged")?this.Spl():this.MA.isVisible&&this.zs&&this.ezl()}ORi(){return this.uqb?this.uqb:[]}Kvl(){return this.a7d?this.a7d:
[]}get JOl(){return this.b5d}get KAe(){return this.Gt}Vul(db){const gc=this.Lc&&this.Lc.Yc?this.Hz.TGd(this.Lc.Yc.zd):this.YKk(this.Hz.I0());if(!gc||!gc.length)return 0;let Dc=null;this.Avh&&(Dc=this.tqc(this.Avh.x,this.Avh.y));let Ua=-1,Nb=0;for(let Hd=0;Hd<gc.length;Hd++){var hc=this.EF.Vib(gc[Hd]);if(!Dc&&hc)break;if(hc&&Dc){var Qc=hc.MR.x,$c=hc.MR.y;Qc+=gc[Hd].pos.X;$c+=gc[Hd].pos.Y;hc.wg&&(hc=this.Ia.Dr(hc),Qc+=hc&&hc.MR?hc.MR.x:0,$c+=hc&&hc.MR?hc.MR.y:0);$c=this.tqc(Qc,$c);Qc=$c.y;$c=$c.x;if(Dc.y<
Qc)break;if(Dc.y>Qc||Dc.y===Qc&&Dc.x>=$c)Ua=Hd,gc[Hd].Children&&db&&(Nb+=gc[Hd].Children.length)}else hc||(Ua=Hd,gc[Hd].Children&&db&&(Nb+=gc[Hd].Children.length))}return Ua+Nb+1}a1m(db){if(!this.iEj)throw La.a.J(512496721,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),r.a.lG(-2130915320);if(this.Gt)return La.a.J(512496720,805,15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),r.a.lG(-2130915319);if(null===db)throw Error.argumentNull("session");
if(!db.commentId.length&&0!==db.S5c)return r.a.lG(-2130915327);this.Gt=db;this.Tfd(!0);0===db.S5c&&(this.Ofd(0),this.MA.isVisible||this.NZl(db));if(this.MA.isVisible||!this.MA.isVisible)this.jac(),this.AGm();let gc="";db.Y4&&(gc=db.Y4.draftId);La.a.J(512496719,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",gc);return null}endCommentSession(db,gc){if(this.Gt){if(this.Gt.Y4&&this.Gt.Y4.draftId!==db)throw La.a.J(512496718,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",
db,this.Gt.Y4.draftId),r.a.lG(-2130915327);this.qHl=gc}9!==gc||this.MA.isVisible||this.Ma.AS(ig.a.kh);this.Gt=null;this.Db.Zf();if(this.zP&&!this.MA.isVisible){const Dc=[Object.assign(new Eg,{contentId:db,containerContentType:0,anchorTop:0,anchorLeft:0})];this.zP.detachContainers(Dc)}this.Dph.sDl&&this.uol();La.a.J(512496717,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",db,gc)}get Bym(){return this.qHl}Cka(){this.jac()}xeh(db){if(this.Aa.getBooleanAppSetting("CommentCopyPasteEnabled")&&
!this.kYd.K6m)for(const gc of db)for(const Dc of this.Hz.Iac(gc.JV()))if(1===Dc.status){this.nLl=new Md(db,this.Hz);this.DOj=!0;return}}Hb(){1!==this.dad.osa&&(this.ia.za(za.a.FYc,ug.a.application,Object(Na.a)(this,this.Fka,"showHideComments")),this.ia.sa(za.a.bHg,ug.a.application,Object(Na.a)(this,this.$3b,"queryShowHideComments"),97));this.Epl&&(this.ia.za(za.a.fNb,ug.a.application,Object(Na.a)(this,this.Ppf,"deleteAllComments")),this.ia.za(za.a.Nrc,ug.a.application,Object(Na.a)(this,this.Ppf,"deleteAllComments")),
this.ia.za(za.a.Orc,ug.a.application,Object(Na.a)(this,this.Ppf,"deleteAllComments")));this.ia.za(za.a.a7b,ug.a.application,Object(Na.a)(this,this.Fka,"showHideComments"));this.ia.sa(hb.a.zth,mb.a.frame,Object(Na.a)(this,this.$3b,"queryShowHideComments"),97);this.ia.sa(za.a.$3b,ug.a.application,Object(Na.a)(this,this.$3b,"queryShowHideComments"),97);this.ia.sa(za.a.Z3b,ug.a.application,Object(Na.a)(this,this.$3b,"queryShowHideComments"),97);this.ia.sa(za.a.Vhe,ug.a.application,Object(Na.a)(this,this.$3b,
"queryShowHideComments"),97);this.ia.za(za.a.Stg,ug.a.application,Object(Na.a)(this,this.yrh,"nudgeCommentMarker"));this.ia.za(za.a.Ttg,ug.a.application,Object(Na.a)(this,this.yrh,"nudgeCommentMarker"));this.ia.za(za.a.Utg,ug.a.application,Object(Na.a)(this,this.yrh,"nudgeCommentMarker"));this.ia.za(za.a.Vtg,ug.a.application,Object(Na.a)(this,this.yrh,"nudgeCommentMarker"));this.ia.za(za.a.nse,ug.a.application,Object(Na.a)(this,this.nse,"toggleCommentAnchoringFocus"));this.Aa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)&&(this.ia.za(hb.a.dBe,ug.a.application,Object(Na.a)(this,this.dBe,"doesCommentExist")),this.ia.za(hb.a.lAe,ug.a.application,Object(Na.a)(this,this.lAe,"commentActivitySelected")));this.ve()}ve(){var db=this.Ma.gd(jf.AFrame.vl),gc=this.Ma.gd(ig.a.jL);const Dc=this.Ma.gd(ig.a.tW);db.bindAction(Nf.a.eb(og.a.o9b,1),za.a.nse);gc.bindAction(Nf.a.eb(og.a.o9b,1),za.a.nse);Dc.bindAction(Nf.a.eb(og.a.o9b,1),za.a.nse);db=this.Ma.gd(ig.a.Sz);gc=[db,this.Ma.gd(ig.a.Lz),this.Ma.gd(gh.a.lsa),this.Ma.gd(ig.a.kh),
this.Ma.gd(ig.a.sX)];for(const Ua of gc)Ua.bindAction(Nf.a.eb(og.a.VRa,Nf.a.Ke|(Ra.a.Ck?4:1)),za.a.ebc);db.bindAction(Nf.a.eb(og.a.VDb,1),za.a.ebc)}jLe(db,gc,Dc,Ua=-1){this.wBb=gc;!this.XD&&this.Soa&&(this.XD=new Ma(this.Soa,this,this.eHe,this.wBb,this.q_d),this.EF.Pqh=this.XD);if(db){Qf.O9m(db);gc=null;this.pa.g8()&&(gc=this.pa.Ua);var Nb=0<db.length?db[db.length-1]:null;if(this.XD){var hc=this.XD.sMe?this.XD.sMe.comment:null;const Qc=hc?hc.commentId:null;this.XD.isRightToLeft=this.wBb;this.XD.Vth(db);
this.EF&&(this.c7c()||this.JBe())&&(this.EF.oeh(),this.EF.heh());this.XD.selectComment(null,!1);if(this.Gt)hc=this.tCe(this.Gt.commentId),this.EF&&this.EF.Iwk(hc,Qc,!1),this.XD.selectComment(hc,!0);else if(Dc&&hc){const $c=this.tCe(hc.commentId);this.EF&&(this.MA.isVisible||!$c||1!==$c.status&&2!==$c.status)&&(this.XD.selectComment(hc,!1),this.EF.Iwk(hc,Qc,!1,!0))}else this.Gph&&Nb&&(this.hDb(Nb.commentId,1,!1),this.XD.selectComment(Nb,!1));this.XD.J4l(this.p0d);this.p0d&&this.EF.VAe(this.t$c)}this.b5d=
db.length;db=this.YKk(db);this.uqb=this.xKl.bVn(db,this.zs);this.a7d=this.xKl.aVn(db);Dc?(this.Tfd(!0),this.Z1a.E1l(Array.clone(this.uqb),this.b5d,Array.clone(this.a7d)),this.Gph&&Nb&&this.Z1a.selectComment(Nb.commentId)):(Dc=[],this.JBe()&&(Dc=this.Vul(!1),Dc=[Object.assign(new vf,{draftId:this.Gt.Y4.draftId,insertIndex:0>Ua?0:Dc})]),0>Ua?this.Z1a.yxk(this.uqb.length,this.b5d,this.zs,this.rCj.Hlh,Dc):this.Z1a.WJn(this.uqb.length,this.b5d,Ua,this.zs,Dc),this.Z1a.Ixk(Array.clone(this.uqb),Array.clone(this.a7d)));
if(this.Hcg){if(Ua=this.tCe(this.Hcg))this.selectComment(Ua,null,!0,!0,0,1,!1),this.Hcg=null}else gc&&this.pa.YB(gc);db=this.Vnl(db);this.nab&&db&&this.nab.count>db.length&&this.$Dm(db);this.LZl(db);this.qCj&&this.nYn();this.Gph=!1}else this.Z1a.yxk(0,0,this.zs,1),this.Z1a.Ixk([],[]),this.b5d=0,this.XD&&(this.XD.isRightToLeft=this.wBb,this.XD.Vth(null)),this.a7d=this.uqb=null,this.E8l(!1,!1),this.pqf()}jac(){this.qfh();this.hasFocus?this.Gt&&this.Dph.sDl&&!this.erl()&&this.Ma.AS(ig.a.jL):this.Ma.AS(this.MA.isVisible?
ig.a.Sz:ig.a.Wva)}NDn(){this.pph=null;this.kZj()}FIe(){this.jac();this.pa.Rw();return!1}Ajl(db){if(this.Gt){if(!this.Gt.Y4)throw La.a.J(512496716,805,10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",db),r.a.lG(-2130915320);this.endCommentSession(this.Gt.Y4.draftId,db)}else La.a.J(512496715,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",db),this.endCommentSession("",db)}AGm(){this.EHe=this.Ma.currentScope.name===
(this.MA.isVisible?ig.a.Sz:ig.a.Wva);this.Dph.Ufl(!0)}uol(){this.Dph.Ufl(!1);this.EHe&&(this.Ma.AS(this.MA.isVisible?ig.a.Sz:ig.a.Wva),this.EHe=!1)}vrn(db,gc){if(db&&db.name!==ig.a.Sz&&db.name!==ig.a.Wva&&gc.name===ig.a.jL)if(this.MA.isVisible)this.qgh();else if(this.Gt){db="";switch(this.Gt.S5c){case 0:db=this.Gt.Y4?this.Gt.Y4.draftId:"";break;case 1:case 2:if(gc=this.Hz.eUi(this.Gt.commentId))db=this.Hz.Hac(gc).commentId}this.zP.selectContainer(db,!0)}this.EHe=!0}urn(){this.EHe=!1}qgh(){this.MA.isVisible&&
this.F8d.RJm()}Bxg(db,gc,Dc){this.kEj=db;this.Db.Zf();(ua.a("FixAltF12KeboardingInCommentPane")||!this.dha)&&this.kEj&&gc&&this.qgh();db||Dc||this.Ofd(1)}oCi(db){var gc=this.va.presentation;if(!gc)return!1;gc=gc.slides;if(!gc)return!1;for(const Dc of gc)if(gc=Object(aa.a)(Ac.a,Dc))if(gc=this.Hz.Iac(gc.JV()),db)for(const Ua of gc){if(1===Ua.status)return!0}else{if(gc&&0<gc.length)return!0}else La.a.J(512496714,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found");return!1}ADm(){this.Hz.fNb();
const db=this.Hz.I0();db&&db.length?this.kYd.D4l():this.kYd.B4l(ResourceStrings.l_DeleteAllCommentsOnSlideCallout)}yrh(db,gc,Dc){if(1===Dc)return 32;if(null!==this.w1l){gc=this.w1l;switch(db){case za.a.Stg:gc.pos.Y+=20;break;case za.a.Ttg:gc.pos.X-=20;break;case za.a.Utg:gc.pos.X+=20;break;case za.a.Vtg:gc.pos.Y-=20}this.XD.QXn(gc);this.Lcn.Mwn(gc)}return 32}Ppf(db,gc,Dc){return!this.Epl||this.zs||this.Gt&&this.Gt.Y4?8:1===Dc?this.YNm(db):this.zDm(db)}YNm(db){switch(db){case za.a.fNb:return this.Hz.I0()&&
this.Hz.I0().length?32:8;case za.a.Nrc:return this.oCi(!1)?32:8;case za.a.Orc:return 1!==this.dad.osa&&this.oCi(!0)?32:8;default:return La.a.J(512496712,805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",db),2}}zDm(db){switch(db){case za.a.fNb:this.ADm();break;case za.a.Nrc:this.kYd.C4l(this.Hz,!1);break;case za.a.Orc:this.kYd.C4l(this.Hz,!0);break;default:return La.a.J(512496711,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",
db),2}return 32}Fka(db,gc,Dc,Ua,Nb){if(1===Dc)return!this.va.Ga||this.isDisabled?8:32;gc=!this.MA.isVisible;Dc=this.K3.wl("UserAction",String.format("ShowHideComments: {0}",gc?"ShowPane":"HidePane"));La.a.J(36983504,805,50,"New Comment Pane opened.");db===za.a.a7b?(this.kWn(!this.q_d),this.Ekk()):db===za.a.FYc?(this.p0d=!this.p0d,this.EF.$wh=this.p0d,this.Ekk()):this.XIg(gc,!!Nb&&Nb.AutoShowHide);Dc&&Dc.stop();return 32}YGm(){this.MA.isVisible&&this.hDb(this.Gt.Y4.draftId,1,!1)}nse(){var db=this.Ma.currentScope.name;
if(this.Gt&&this.Gt.Y4)return db===ig.a.kh?(this.jac(),ua.a("FixAltF12KeboardingInCommentPane")||ua.a("SelectCommentDuringAlt12ActiveDraftEnable")&&this.YGm()):this.Ma.gh(ig.a.kh),32;if(this.EF.E5l||this.EF.OSa){if(db===ig.a.kh||db===ig.a.tW){var gc=this.EF.OSa;this.MA.isVisible||(db=0,gc&&(db=gc.get_shapeId()),this.r1l(db,!1));this.jac();return 32}if(Mc.a.contains(this.wil,db)){if((gc=this.lPg)&&pc.Iwa(gc)){if(db=pc.LHf(gc,this.EF.OSa),db.isValid){const Dc=[];for(let Nb=0;Nb<db.paragraphs.length;Nb++){const hc=
db.paragraphs[Nb];hc&&Dc.push(Vg.SelectionFactory.Y7(hc,db.PQa.equals(hc)?db.startPos:0,db.$Sa.equals(hc)?db.endPos:wb.ParagraphReader.textLength(hc)))}const Ua=new hi.SelectionCollection(Dc,0);gc.textAnchoringInfo.AnchoringShape&&gc.textAnchoringInfo.AnchoringShape.SmartArtNodeId?(this.Ma.gh(ig.a.tW),this.xJl.execute(Nb=>{(Nb=Object(aa.a)(957,Nb.Jd))&&this.xJl.instance.Dwh(Object(aa.a)(Bh.a,Nb),Ua)})):(this.Ma.gh(ig.a.kh),this.pa.YB(Ua))}}else this.Ma.gh(ig.a.kh);return 32}}else{if(Mc.a.contains(this.wil,
db))this.Ma.gh(ig.a.kh);else{db=null;db=this.Lc&&this.Lc.Yc?this.Hz.TGd(this.Lc.Yc.zd):this.YKk(this.Hz.I0());if(!Mc.a.rb(db))for(gc of db)if(this.MA.isVisible||0===gc.status){this.hDb(gc.commentId,1,!1);break}this.jac()}return 32}return 8}Vfl(db,gc){db&&!gc?this.dha?this.qfh():(this.Ma.lm(ig.a.Sz,!0),this.jac(),this.qgh()):gc?db&&this.Ma.pTa(ig.a.Sz,ig.a.vl,this.MA,!1):0<this.RLi()||this.Gt&&this.Gt.Y4?this.Ma.lm(ig.a.Wva,!0):this.Ma.lm(ig.a.Sz,!1);this.DEe||gc||this.uzk()}eon(){this.j6d||(this.Jo.qK(this.Jo.gxd,
this.Jo.xyd),this.Jo.fUa(this.Jo.gxd,this.Jo.xyd),this.j6d=!0,this.Pca.fon(this.va.$v));this.Wya&&this.Wya.prl()}uzk(){const db=this.Hz.I0();db&&0<db.length&&(this.BEj=!0)}c7c(){var db=this.Hz.I0();if(!db||!db.length)return!1;db=Mh.e(db,gc=>0===gc.status);return!!db&&0<db.length}$3b(db,gc,Dc,Ua,Nb){db===za.a.$3b?Nb[Tg.a.On]=this.MA.isVisible:db===za.a.Z3b||db===hb.a.zth?Nb[Ce.a.On]=this.MA.isVisible:db===za.a.Vhe?Nb[Ce.a.On]=this.q_d:db===za.a.bHg&&(Nb[Ce.a.On]=this.p0d);return!this.va.Ga||this.isDisabled?
16:32}dBe(db,gc,Dc,Ua,Nb){return 2!==Dc?32:(db=this.Vql(Nb))&&this.findComment(db)?32:8}lAe(db,gc,Dc,Ua,Nb){return 2!==Dc?32:(db=this.Vql(Nb))&&this.ymn(db)?32:8}Vql(db){if(!db)return null;db=db.NavigationId;if(!db)return null;try{return JSON.parse(db)}catch(gc){return La.a.J(512496710,805,10,"ExtractNavParams - Exception while parsing navigation id",gc),null}}ymn(db){if(this.aCl(this.Lc.Yc.zd,db))return this.q1l(db);var gc=eg.a.Yq(db.sId,db.cId);gc=this.dWi(gc);if(!gc)return!1;this.Raa.instance&&
this.Raa.instance.x8(gc.ph);r.a.V9b(this.Tb,()=>{this.q1l(db)});return!0}q1l(db){const gc=this.findComment(db);if(!gc)return!1;1!==gc.status&&2!==gc.status||this.Y6b();this.hDb(db.commentId,1,!1);return!0}findComment(db){var gc=this.va.presentation;if(!gc)return null;gc=gc.slides;if(!gc)return null;for(const Dc of gc)if((gc=Object(aa.a)(Ac.a,Dc))&&this.aCl(gc,db)){gc=this.Hz.Iac(gc.JV());for(const Ua of gc){if(Ua.commentId===db.commentId)return Ua;if(Ua.Children&&Ua.Children.length)for(const Nb of Ua.Children)if(Nb.commentId===
db.commentId)return Nb}}return null}aCl(db,gc){return db.cid&&gc.cId?db.cid===gc.cId:db.sid===gc.sId}isCollapsed(){return!1}get w1l(){return null}clearSelection(){}WDn(){this.Db.Zf()}get uyc(){return!!this.Gt}vxm(){this.Gt&&this.Ajl(8)}getName(){return"SharedFrame"}M6(db){2===db.behavior&&db.actionId===za.a.f_&&(db=this.$o.i$a(!0),db!==za.a.fE&&db!==za.a.oF&&db!==za.a.fNb&&db!==za.a.Nrc&&db!==za.a.Orc||df.a.fS().then(gc=>{this.kYd.sFn(gc)}))}K6(){}static qNl(db,gc){return db.contentId===gc}static O9m(db){let gc=
"";if(db){for(const Dc of db)if(gc+=Dc.commentId+";",Dc.Children)for(const Ua of Dc.Children)gc+=Ua.commentId+";";La.a.J(512496659,805,15,"LogCommentIds() - {0}",gc)}}DQf(){return this.ia.Bz(za.a.oF)}}Object(c.a)(Qf,"SharedCommentFrame",null,[1296,24,1297,85]);class sg{constructor(db,gc,Dc,Ua,Nb,hc,Qc=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=db;this.parentId=gc;this.commentBody=Dc;this.author=Ua;
this.date=Nb;this.commentFlags=hc;this.usersByReactionType=Qc}}Object(c.a)(sg,"OfficeSharedCommentModel",null,[]);class Bf{constructor(db,gc){this.CommentId=db;this.ResolveState=gc}}Object(c.a)(Bf,"CommentProperties",null,[]);class Wf{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(c.a)(Wf,"AtMentionAttributes",null,[]);class Xf{constructor(){this.contentId=""}}Object(c.a)(Xf,"AtMentionOptionalAttributes",null,[]);class Xa{constructor(){this.atmention=this.altText=this.lang=
null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(c.a)(Xa,"DeltaAttributes",null,[]);var T;(function(db){db[db.Undo=-1]="Undo";db[db.Unknown=0]="Unknown";db[db.Create=1]="Create";db[db.B0n=2]="Assign";db[db.K1n=3]="Unassign";db[db.L1n=4]="UnassignAll";db[db.r1n=5]="Schedule";db[db.j1n=6]="Progress";db[db.Delete=7]="Delete";db[db.p1n=8]="Restore";db[db.x1n=9]="SetTitle";db[db.Priority=10]="Priority"})(T||(T={}));
Object(c.b)("HistoryRecordType",T);class Ba{constructor(){this.Id=this.FullName=this.Email=this.DispName=null}}Object(c.a)(Ba,"CommentAtMention",null,[]);var kb=a(1193);class Ab{constructor(){this.UserId=this.ProviderId=this.FullName=this.Email=this.DisplayName=null}}Object(c.a)(Ab,"UserInfo",null,[]);class ic{constructor(db,gc){this.plainText=db;this.iOl=gc}}Object(c.a)(ic,"TextTranslationResult",null,[]);var zc=a(92);class Fc{constructor(db,gc,Dc){this.WHn="[";this.Ssm=RegExp("\\<\\@(.*?)\\>|\\[\\@(.*?)\\]");
this.a9m=RegExp("(?:https?:\\/\\/|www\\.)[^\\s]+","gi");this.Tsm=RegExp("(\\<\\@.*?\\>|\\[\\@.*?\\]|(?:https?:\\/\\/|www\\.)[^\\s]+)","gi");this.ZFl=!1;this.HCm=Ua=>{if(!Ua)return null;const Nb={};for(const hc of Ua){a:{switch(hc.Type){case "\ud83d\udc4d":Ua=1;break a;default:La.a.J(509220245,805,50,"Unsupported reaction type")}Ua=void 0}void 0!==Ua&&(Nb[Ua.toString()]=this.gBn(hc.ReactionInstances))}return Nb};this.gBn=Ua=>{const Nb=[];for(const hc of Ua)Ua=hc.User,Nb.push({DateUtc:hc.Time,DisplayName:Ua.DisplayName,
Email:Ua.Email,Provider:Ua.ProviderId,UserId:Ua.UserId,IsCurrentUser:this.isCurrentUser(hc.User.UserId,hc.User.ProviderId)});return Nb};this.Fb=db;this.rOj=gc;this.wIj=Dc}get userId(){return this.Fb.appSettings[Jb.a.lPa]}get providerId(){return this.Fb.appSettings[Jb.a.L2b]}gTm(db,gc){let Dc=0;if(1===db.status||2===db.status)Dc|=8;gc&&(Dc|=1);this.COn(db)&&(Dc|=16);db.isUnread&&(Dc|=32);return Dc}isCurrentUser(db,gc){return db?"Author"===db||this.userId===db&&gc===gc?!0:!1:!1}X3m(db){return this.isCurrentUser(db.userId,
db.providerId)}COn(db){return""===db.userId||"Author"===db.userId||!this.m_n(db.userId)||this.userId===db.userId&&this.providerId===db.providerId?!1:!0}m_n(db){return 3===db.split("::").length}T7l(db,gc,Dc){var Ua;if(null===db)throw Error.argumentNull("comment");const Nb=this.dVn(db.text);var hc=db.authorName,Qc=ua.a("PPTPlumbEmailThroughCG")?I.a.dOb(db.userId||""):"";const $c=db.dt;Dc=this.gTm(db,Dc);hc=new kc(db.userId,db.providerId,hc,Qc,this.X3m(db));return Ad(this.Fb)&&(null===db||void 0===db?
0:db.reactions)?(Qc=this.HCm(null===(Ua=db.reactions)||void 0===Ua?void 0:Ua.ReactionList),new sg(db.commentId,gc,Nb,hc,$c,Dc,Qc)):new sg(db.commentId,gc,Nb,hc,$c,Dc)}bVn(db,gc){if(null===db)throw Error.argumentNull("comments");const Dc=new f.a;for(const Ua of db)if(Dc.add(this.T7l(Ua,"",gc)),Ua.Children&&0<Ua.Children.length)for(const Nb of Ua.Children)Dc.add(this.T7l(Nb,Ua.commentId,gc));return Dc.toArray()}hVn(db,gc,Dc,Ua){const Nb=Object.assign(new kb.a,{Asignees:[]});db=this.rOj.SKm(db,gc,!gc.taskId,
Dc);for(const hc of db)2===hc.type?hc.assignee?(db=Object.assign(new Ab,{DisplayName:hc.assignee.DisplayName,FullName:hc.assignee.DisplayName,UserId:hc.assignee.UserId,ProviderId:hc.assignee.Provider,Email:hc.assignee.Email}),Nb.Asignees.push(db)):La.a.J(512496658,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null."):9===hc.type&&(Nb.Title=hc.title);if(!Nb.Asignees)return La.a.J(512496657,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),
null;Nb.Title||(La.a.J(512496656,845,15,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),Nb.Title=Ua);return Nb}fVn(db,gc){const Dc=new kb.a;if(db.assignee){const Ua=new Ab,Nb=db.assignee;Ua.DisplayName=Nb.Name;Ua.FullName=Nb.Name;Ua.UserId=Nb.UserPrincipalName;Ua.ProviderId="O365";Ua.Email=Nb.UserPrincipalName;Dc.Asignees=[Ua]}Dc.Title=db.title?db.title:gc;return Dc}gVn(db,gc,Dc){if(!gc)return null;try{const Ua=this.Xyh(Dc,new Date).plainText,Nb=this.wIj?this.hVn(db,
gc,Dc,Ua):this.fVn(gc,Ua);if(!Nb)return null;Nb.CompletionPercentage=gc.completion?gc.completion:0;return Nb}catch(Ua){La.a.J(512496655,845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",Ua)}return null}aVn(db){if(null===db)throw Error.argumentNull("comments");const gc=new f.a;for(const Dc of db)Dc.taskInfo&&Dc.taskInfo.Asignees&&0<Dc.taskInfo.Asignees.length&&(db=this.$Un(Dc))&&gc.add(db);return gc.toArray()}$Un(db){if(this.wIj&&this.rOj&&0<db.taskInfo.TaskHistoryRecords.length)try{const gc=
Fc.Lzm(db.taskInfo.TaskHistoryRecords),Dc=new zc.a;Dc.add(db.commentId,new Bf(db.commentId,100===db.taskInfo.CompletionPercentage));const Ua=this.rOj.BCm(db.commentId,db.commentId,gc,Dc);Fc.$wm(db,Ua,this.wIj);return Ua}catch(gc){return La.a.J(512496654,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",gc.message),this.S7l(db)}else return this.S7l(db)}S7l(db){var gc=new W;gc.startDate=db.taskInfo.StartDate;gc.endDate=db.taskInfo.DueDate;const Dc=new V(db.taskInfo.Asignees[0].UserId);
Dc.DisplayName=db.taskInfo.Asignees[0].DisplayName;Dc.Provider=db.taskInfo.Asignees[0].ProviderId;Dc.Email=db.taskInfo.Asignees[0].Email;const Ua=Array(1);Ua[0]=Dc;gc=new L(!1,db.taskInfo.Title,Ua,gc,db.taskInfo.CompletionPercentage,0);return new P(db.commentId,db.commentId,gc,[])}dVn(db){if(null===db)throw Error.argumentNull("nativeText");const gc=new ra;db=db.split(this.Tsm);for(const Ua of db){var Dc=this.Ssm.exec(Ua);Dc&&3===Dc.length?(db=new Wf,Dc[0].substring(0,1)===this.WHn?(db.fullName=Dc[2],
db.resolveState=1):(db.fullName=Dc[1],db.resolveState=0),db.email="UnknownEmail",Dc=new Xf,Dc.contentId="Pre-existing Mention",gc.C2m("@"+db.fullName,db,Dc),this.ZFl||(this.ZFl=!0,La.a.J(512496653,845,15,"Rendering mention when AtMentions are disabled."))):(db=this.a9m.exec(Ua))&&1===db.length?(db=db[0],gc.insertHyperLink(db,Object.assign(new Xa,{link:db}))):gc.M2m(Ua)}return gc.$Nm()}Xyh(db,gc){var Dc=Sys.Serialization.JavaScriptSerializer.deserialize(db);db=[];gc||(gc=new Date);const Ua=new Sys.StringBuilder;
for(const Nb of Dc.ops)if(Nb.attributes){if(Nb.attributes.atmention){const hc=1<Nb.insert.length?Nb.insert.substring(1,Nb.insert.length):"";if(Nb.optional&&Nb.optional.atmention&&Nb.optional.atmention.contentId)Dc=Fc.Zul(hc,1===Nb.attributes.atmention.resolveState);else{Dc=Fc.Zul(hc,1===Nb.attributes.atmention.resolveState);const Qc=Fc.NQm(gc,1===Nb.attributes.atmention.resolveState);Array.add(db,Object.assign(new Ba,{FullName:Nb.attributes.atmention.fullName,DispName:hc,Id:Qc,Email:Nb.attributes.atmention.email}));
gc=new Date(gc.getTime()+1)}}else Nb.attributes.link||La.a.J(512496652,845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),Dc=Nb.insert;Ua.append(Dc)}else Ua.append(Nb.insert);return new ic(Ua.toString(),db)}static Uzm(db){switch(db){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}static Szm(db){var gc=null;db.User&&(gc=new V(db.User.UserId,
db.User.ProviderId,db.User.DisplayName));gc=new N(Fc.Uzm(db.HistoryRecordType),gc,db.DtTime,db.RecordId);gc.commentId=db.CommentId;db.Assignee&&(gc.assignee=new V(db.Assignee.UserId,db.Assignee.ProviderId,db.Assignee.DisplayName));db.StartDate&&db.DueDate?(gc.schedule=new W,gc.schedule.startDate=db.StartDate?db.StartDate:null,gc.schedule.endDate=db.DueDate?db.DueDate:null):db.StartDate&&!db.DueDate?La.a.J(512496651,845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):
!db.StartDate&&db.DueDate&&La.a.J(512496650,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");var Dc=db.Priority;0<Dc?gc.priority=Dc:La.a.J(512496649,845,10,"Priority is negative");Dc=db.CompletionPercentage;0<=Dc?gc.completion=Dc:La.a.J(512496648,845,10,"Percent complete is negative");gc.title=db.Title;gc.undoId=db.UndoId;return gc}static Lzm(db){const gc=db.length,Dc=Array(gc);for(let Ua=0;Ua<gc;++Ua)Dc[Ua]=Fc.Szm(db[Ua]);return Dc}static $wm(db,gc,Dc){const Ua=
gc.currentState,Nb=db.taskInfo;let hc=!1;const Qc=ua.a("SetTaskFromTaskStateInsteadOfHistory");Nb.StartDate.toString()!==Ua.schedule.startDate.toString()&&(Qc&&(Ua.schedule.startDate=Nb.StartDate),hc=!0,La.a.J(512496647,845,10,"Start Date does not match."));Nb.DueDate.toString()!==Ua.schedule.endDate.toString()&&(Qc&&(Ua.schedule.endDate=Nb.DueDate),hc=!0,La.a.J(512496646,845,10,"End Date does not match."));Nb.CompletionPercentage!==Ua.completion&&(Qc&&(Ua.completion=Nb.CompletionPercentage),hc=!0,
La.a.J(512496645,845,10,"Completion percentage does not match."));Nb.Title!==Ua.title&&(Qc&&(Ua.title=Nb.Title),hc=!0,La.a.J(512496644,845,10,"Title does not match."));Nb.Asignees[0].UserId!==Ua.assignees[0].UserId&&(Qc&&(Ua.assignees[0].UserId=Nb.Asignees[0].UserId),hc=!0,La.a.J(512496643,845,10,"Assigned to user id does not match."));Nb.Asignees[0].DisplayName!==Ua.assignees[0].DisplayName&&(Qc&&(Ua.assignees[0].DisplayName=Nb.Asignees[0].DisplayName),hc=!0,La.a.J(512496642,845,10,"Assigned to display name does not match."));
Nb.Asignees[0].ProviderId!==Ua.assignees[0].Provider&&(Qc&&(Ua.assignees[0].Provider=Nb.Asignees[0].ProviderId),hc=!0,La.a.J(512496641,845,10,"Assigned to provider id does not match."));Nb.Asignees[0].Email!==Ua.assignees[0].Email&&(Qc&&(Ua.assignees[0].Email=Nb.Asignees[0].Email),Dc||(hc=!0,La.a.J(512496640,845,10,"Assigned to email does not match.")));if(hc&&Dc&&(Fc.U$m(db,gc),ua.a("IsThrowForTaskStateMismatchEnabled")))throw La.a.J(0,845,10,"There was a mismatch between the state and state as determined by history"),
Error.create("TaskStateMismatch");}static U$m(db,gc){const Dc=new f.a;for(const Ua of gc.history)for(const Nb of Ua.records)Dc.add(T[Nb.type]);if(Dc.count!==db.taskInfo.TaskHistoryRecords.length){gc=new f.a;for(const Ua of db.taskInfo.TaskHistoryRecords)gc.add(T[Ua.HistoryRecordType]);La.a.J(512496611,845,10,"LogTaskHistoryDetailsForMismatch")}}static NQm(db,gc){db=db._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);return gc?db+"_Z":db}static Zul(db,gc){return gc?"[@"+
db+"]":"<@"+db+">"}}Object(c.a)(Fc,"SharedCommentModelTranslator",null,[1295]);class lc{constructor(db,gc,Dc){this.t8k=!1;this.Ma=db;this.qj=gc;this.J$c=Dc}Ufl(db){db?(this.J$c&&this.J$c.isVisible||this.qj.XW(ig.a.jL),this.qj.Cr(ig.a.Sz),this.Ma.AS(ig.a.jL)):this.qj.Cr(ig.a.jL);this.t8k=db}get sDl(){return this.t8k}}Object(c.a)(lc,"SharedCommentsRTEFocusActionHelper",null,[1269]);class nd{constructor(db,gc,Dc,Ua){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=db;this.body=
gc;this.confirmButton=Dc;this.cancelButton=Ua}}Object(c.a)(nd,"ViewContainerModalDialogStrings",null,[]);class vd{constructor(db,gc,Dc){this.containerType="full-pane";this.identifier=null;this.vd=db;this.Ma=gc;this.identifier=Dc}closeView(){this.vd.XIg(!1,!1)}openView(){this.vd.XIg(!0,!1)}invokeModalConfirmationDialog(db,gc,Dc){const Ua=new Oi.a;Dc&&Dc.title&&Dc.body&&Dc.confirmButton&&Dc.cancelButton||(La.a.J(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),Dc=new nd("",
"","",""));Ua.gf=1;Ua.Fg(1,Dc.confirmButton);Ua.Fg(0,Dc.cancelButton);Ua.vsc=this.Ma.currentScope.name;Ua.xIe=!0;Ua.xG(Dc.title,Dc.body,1,Nb=>{1===Nb?(db(),Ua.vsc=null):gc()})}}Object(c.a)(vd,"ViewContainerAPI",null,[1293,1294]);class od extends Sys.EventArgs{constructor(){super()}}Object(c.a)(od,"CommentsPackageLoadedEventArgs",Sys.EventArgs,[]);var Bd=a(664);class Wd{constructor(){this.nKl=this.AMl=this.F8d=this.LMl=this.mcc=this.Qmh=this.Tad=this.Smh=this.g1=this.$=null;this.QZd=this.$bc=this.Z$c=
!1;this.K3=this.xCj=null;this.OKl="6F1926CF-E872-4C4C-9393-3956FCFEB98A";this.Vya=null;this.dha=!1}lc(db){this.$=db;this.dha=this.$.resolve("PowerPointWebEditor.IApplicationSettings").vkf;this.K3=this.$.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");this.F8d=new y(h.AFrameworkApplication.je,"CommentPane");db.register(cd,"PowerPointWebEditor.CommentEditor").as("PowerPointWebEditor.ICommentEditor").ma().na(()=>new cd);const gc=this.$.resolve("PowerPointWebEditor.IFileInfo").osa,Dc=2===
gc||3===gc;this.Z$c=Dc;this.QZd=1===gc;db.register(ne,"PowerPointWebEditor.CommentTelemetryManager").as("PowerPointWeb.Comments.ICommentTelemetryManager").ma().na(()=>new ne(this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("Common.IAppSettingsManager"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.Graph.ICommentReader"),gc));db.register(X,"PowerPointWebEditor.CommentManager").as("PowerPointWeb.Comments.ICommentGraphManager").ma().na(()=>
new X(this.K3,gc,this.$.resolve("PowerPointWebEditor.ICommentCloudPolicy"),this.$.resolve("PowerPointWebEditor.IClassFactory"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.Graph.ICommentReader"),this.$.resolve("PowerPointWebEditor.ICommentEditor"),this.$.resolve("Common.IAppSettingsManager"),this.$.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.$.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.$.resolve("PowerPoint.IDateHelper"),this.$.resolve("PowerPointWebEditor.ISlideReader"),this.$.Na("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager")));const Ua=this.Z$c||!this.QZd;this.Vya=this.$.resolve("PowerPointWeb.Comments.ICommentGraphManager");Ua&&db.register(738,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>").ma().na(()=>new Bd.a((Hd,$d)=>
{let ue=null;const Fe=Object(aa.a)(284,Hd.tc(db.resolve("Box4.IPageView").Oa));Fe&&!Fe.isDisposed&&(Hd=db.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").Zpi(db.resolve("PowerPointWebEditor.IPptSelectionManager"),null,Hd,$d,Fe.Jqa,db.resolve("PowerPointWebEditor.IZoomContext"),db.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),db.resolve("PowerPointWebEditor.IApplicationSettings")),ue=new Me(Hd),ue.xq(Fe.Jqa),Fe.hzb(ue,5),ue.visible=Fe.TK||Fe.Ho);return ue}));
this.$.register(1266,"PowerPointWeb.Comments.ICommentMarkerAnchorHelper").ma().na(()=>new oc(this.Vya,this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),db.resolve("PowerPointWebEditor.Graph.ITableReader")));this.$.register(1267,"PowerPointWeb.Comments.ICommentMarkerPositionHelper").ma().na(()=>new Ld(this.$.resolve("PowerPointWebEditor.View.IPPTPageView").yd,this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.Vya));
const Nb=this.Z$c||!this.QZd;this.$.register(1268,"PowerPointWeb.Comments.ICommentMarkerViewElementFactory").ma().na(()=>new Pb(this.$.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.$.resolve("PowerPointWeb.Comments.ICommentMarkerPositionHelper"),new Yg(Nb),this.$.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Nb,Nb));this.$.register(Lg,"PowerPointWebEditor.CommentTextAnchorHighlightActor").ma().na(()=>new Lg(!this.QZd,this.$.resolve("Common.Utils.IHighContrastDetector")));
const hc=new cc(Ua,this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Ua?this.$.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>"):null,this.Vya,this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.IAriaManager"),this.$.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.$.resolve("Box4.Highlight.IHighlightManager"),this.$.resolve("PowerPointWebEditor.CommentTextAnchorHighlightActor"),
this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"));db.register(1269,"PowerPointWebEditor.IRTEFocusActionHelper").ma().na(()=>new lc(db.resolve("Common.IFocusManager"),db.resolve("Common.IF6Manager"),db.resolve("PowerPointWebEditor.ICommentsPane")));this.$.register(v,"Common.Comments.OfficeSharedCommentsEventHost").as("Common.Comments.IOfficeSharedCommentsEventHost").ma().na(()=>new v(this.$.resolve("Common.ITaskManager")));const Qc=this.$.resolve("Common.IAppSettingsManager").getBooleanAppSetting(R.a.nmb);
Qc&&this.$.register(1270,"Common.Comments.ICommentTaskTranslator").ma().na(()=>(new ja(!0,Qc,!0)).uAm());this.$.register(Fc,"PowerPointWebEditor.SharedCommentModelTranslator").as("PowerPointWeb.Comments.ISharedCommentModelTranslator").ma().na(()=>new Fc(this.$.resolve("Common.IAppSettingsManager"),Qc?this.$.resolve("Common.Comments.ICommentTaskTranslator"):null,Qc));this.$.register(va,"Common.Comments.CommentActivationManager").as("Common.Comments.ICommentActivationManager").ma().na(()=>new va);this.$bc=
this.$.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Jb.a.Bbd)&&(Dc||!this.QZd);this.$.register(Qf,"PowerPointWebEditor.SharedCommentFrame").as("PowerPointWeb.Comments.ICommentFrame").as("PowerPointWebEditor.ICommentSessionManager").ma().na(()=>new Qf(this.Vya,this.$.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.$.resolve("PowerPointWebEditor.ICommentsPane"),this.$.resolve("Common.DragInputManager"),
this.$.resolve("Common.IClickInputManager"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("Common.IF6Manager"),this.$.resolve("PowerPoint.IPathManager"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.ICommentsPane").ta,this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.$.resolve("PowerPointWebEditor.IPPTWorkspace"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("Box4.Graph.IGraphInstance"),this.$.resolve("PowerPoint.IDateHelper"),this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),this.$.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.F8d,this.$.resolve("PowerPointWebEditor.IRTEFocusActionHelper"),h.AFrameworkApplication.isRtl,this.$.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),
this.$.resolve("PowerPointWebEditor.IFindCommentLogic"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView").yd,this.$.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.$.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.$.resolve("PowerPointWeb.Comments.ICommentMarkerViewElementFactory"),this.K3,hc,this.$.resolve("Common.IAppSettingsManager"),this.$.Na("Box4.IInteractiveViewManager"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),Ua,db.resolve("PowerPointWebEditor.IErrorHandler"),db.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.$bc,db.resolve("Box4.Graph.IGraphInstance").Sd(10),db.resolve("PowerPointWebEditor.View.IViewEventSource"),db.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Nb,db.resolve("PowerPointWebEditor.IShapeReader"),db.Na("Common.App.SafeLinks.ISafeLinksManager"),db.resolve("Box4.ICharacterPropertiesEditor"),db.resolve("PowerPointWebEditor.IFileInfo"),
this.dha,db.resolve("Box4.Graph.IGraphIteratorFactory"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.IPPTRumTracker"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").OBb?this.$.resolve("PowerPointWebEditor.ICommentShimmerView"):null,this.$.Na("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.$.Na("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),this.$.Na("PowerPointWebEditor.ISorterViewActorLazy")));
this.$.register(Gb,"Common.Comments.OfficeSharedCommentsActionHost").as("Common.Comments.IOfficeSharedCommentsActionHost").ma().na(()=>new Gb(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWeb.Comments.ICommentFrame").Gan));this.$.register(vd,"PowerPointWebEditor.ViewContainerAPI").as("PowerPointWeb.Comments.IPptViewContainerAPI").ma().na(()=>new vd(this.$.resolve("PowerPointWeb.Comments.ICommentFrame"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.OKl));const $c=
new Eb(this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new Cd(this.$.resolve("PowerPointWebEditor.IPPTReplicationScheduler")),this.Vya,this.$.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Jb.a.pUl),this.$.ge("PowerPointWeb.Comments.ICommentFrame"));this.$.register(1271,"PowerPointWebEditor.IFindCommentLogic").ma().na(()=>new Ya($c,this.$.resolve("Common.ITaskManager")));this.$.register(Ng,"PowerPointWebEditor.CommentsChangeListener").ma().na(()=>
new Ng(this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("Common.ITaskManager"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(7),this.$.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.$.resolve("PowerPointWeb.Comments.ICommentFrame")));this.$.register(1272,"PowerPointWebEditor.ICommentContextDetailsUpdateHelper").ma().na(()=>new Vc(this.$.resolve("PowerPointWebEditor.IPresentationReader"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.IFindCommentLogic"),this.Vya,this.$.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.$.resolve("Common.ITaskManager")));this.$.register(Od,"PowerPointWebEditor.CommentPropertyTracker").ma().na(()=>new Od(Object(Na.a)(this.$.resolve("PowerPointWeb.Comments.ICommentFrame"),this.$.resolve("PowerPointWeb.Comments.ICommentFrame").kZj,
"onCommentPropertiesUpdated"),wa.App.pN.GS,pa.GraphTransactionManager.instance));this.$.register(1273,"PowerPointWebEditor.ICommentsPane").ma().na(()=>new ji(this.$.resolve("PowerPointWebEditor.IFrameContext"),this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.$.resolve("PowerPointWebEditor.ITaskPaneManager"),this.dha,this.$.resolve("PowerPointWebEditor.IPPTRumTracker")));this.$.register(Ke,"PowerPointWebEditor.CommentSmartReplyProvider").ma().na(()=>new Ke(this.$.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){Mb.a.instance.kc(nb.a.qdh,(new Date).getTime());const db=this.K3.wl("UserAction","InitCommentsPackage"),gc={};this.dha||(this.Tad=this.$.resolve("PowerPointWebEditor.ICommentsPane").ta);this.g1=this.$.resolve("PowerPointWeb.Comments.ICommentFrame");this.g1.initialize();var Dc=db.nv;gc.CommentFrameInitMS=Dc;this.$.resolve("PowerPointWebEditor.ICommentSessionManager");this.Smh=this.$.resolve("PowerPointWebEditor.CommentPropertyTracker");
this.Smh.l0m();const Ua=db.nv;gc.CommentPropertyTrackerInitMS=Ua-Dc;this.xCj=this.$.resolve("PowerPointWebEditor.CommentsChangeListener");this.LMl=this.$.resolve("PowerPointWeb.Comments.IPptViewContainerAPI");var Nb=ia.b(h.AFrameworkApplication.ga.appSettings.SessionStartInfoJson.toString());Dc=Nb.Ring||"Unknown";Nb=Nb.WACDatacenter||"Unknown";const hc=this.$.resolve("PowerPointWebEditor.IApplicationSettings").FBl;var Qc=h.AFrameworkApplication.ga.La("LokiComplianceEnvironment");Qc=Qc&&""!==Qc?Qc:
h.AFrameworkApplication.ga.La("SovereignEnvironmentName");this.AMl=new vb("PowerPoint",h.AFrameworkApplication.buildVersion,null,null,h.AFrameworkApplication.userSessionId,Dc,Nb,!hc,this.$.resolve("Common.IActionManagerExtended"),null,Qc);Dc=sb.a.Ne(h.AFrameworkApplication.lcid);this.nKl=new bc(h.AFrameworkApplication.isRtl,Dc?Dc.name:Sys.CultureInfo.CurrentCulture.name,h.AFrameworkApplication.uiCulture,h.AFrameworkApplication.dataCulture);this.dha||(this.Tad.id=this.OKl);this.fEe();h.AFrameworkApplication.ga.fg(Object(Na.a)(this,
this.su,"onFullAppSettingsReady"));(Dc=this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"))&&Dc.CWl(new od);Dc=db.nv;gc.CommentReactPaneInitMS=Dc-Ua;this.b1m();gc.CommentPaneInitMS=db.nv-Dc;h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)&&this.$.resolve("PowerPointWebEditor.CommentSmartReplyProvider").initialize();db.stop();La.a.J(512262878,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",
gc,this.$.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Jb.a.Bbd))}b1m(){const db=this.$.resolve("PowerPointWebEditor.ICommentsPane"),gc=this.$.resolve("PowerPointWebEditor.IPaneManager");this.dha||document.getElementsByClassName("CommentPanel").length||gc.F9(db);gc.Ebc(2);this.$.resolve("PowerPointWebEditor.IFocusManager").pTa(ig.a.Sz,ig.a.vl,db,!db.isVisible)}fEe(){Mb.a.instance.kc(nb.a.fEe,(new Date).getTime());const db=this;this.$.resolve("PowerPointWebEditor.ICommentCloudPolicy").Vzd().then(gc=>
{Mb.a.instance.kc(nb.a.Gjh,(new Date).getTime());yb.a.aG(db.$.Na("Common.App.People.IExternalPeopleAPI")).continueWith(Dc=>{db.mcc=Dc.result;db.mcc||La.a.J(512262877,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");db.$.resolve("PowerPointWebEditor.IApplicationSettings").Rh&&(Dc=db.$.resolve("Common.IAppSettingsManager").La(Jb.a.B8),db.mcc.V3j(Dc+"p"));Dc=[uc.a.contextMenu];db.dha||vc.a.hJg(db.Tad,Dc);const Ua=gc&&(db.Z$c||!db.QZd),Nb=db.$.resolve("Common.IAppSettingsManager").getBooleanAppSetting("PositionDraftCommentCardOnCommentsPaneBasedOnAnchorPositionEnabled");
db.$.register(Rd,"PowerPointWebEditor.PPTSharedCommentAppCapabilities").as("Common.Comments.IOfficeSharedCommentsAppCapabilities").ma().na(()=>new Rd(db.$.resolve("Common.IAppSettingsManager"),db.$.resolve("PowerPointWebEditor.IApplicationSettings"),db.mcc,db.QZd,Ua,db.$bc));db.$.register(Bc,"PowerPointWebEditor.CommentAPI").as("PowerPointWebEditor.IPptOfficeSharedCommentAPI").ma().na(()=>new Bc(db.$.resolve("PowerPointWeb.Comments.ICommentFrame"),db.Vya,db.$.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
db.$.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),db.$.resolve("Common.ITaskManager"),db.$.resolve("Common.IAppSettingsManager"),db.$.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),db.$.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),db.mcc,db.$.resolve("PowerPointWebEditor.ICommentCloudPolicy"),db.$.resolve("PowerPointWebEditor.CommentSmartReplyProvider"),Ua,db.$bc,Nb,db.$.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),db.$.resolve("Common.IActionManagerExtended"),
db.$.resolve("PowerPointWebEditor.IApplicationSettings")));db.Qmh=db.$.resolve("PowerPointWebEditor.IPptOfficeSharedCommentAPI")},11).continueWith(()=>{db.Qmh&&db.Qmh.checkAtMentionCapability().then(Dc=>{Dc&&((Dc=db.$.Na("Common.ISystemInitiatedFeedback"))?Dc.execute(Ua=>{Ua.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}):La.a.J(512262876,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});db.$0m()})})}$0m(){Mb.a.instance.kc(nb.a.Vwh,
(new Date).getTime());const db=this.$.resolve("Common.IDynamicScriptLoaderProvider").LW,gc=this.$.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),Dc=this.$.resolve("Common.Comments.ICommentActivationManager");Mb.a.instance.kc("CommentActivationManagerInitStart",(new Date).getTime());Dc.initialize(db,this.Qmh,this.AMl,this.mcc,new wc(this.LMl,this.F8d),this.nKl,null,gc.hTm());Mb.a.instance.kc(nb.a.xEe,(new Date).getTime());Dc.xEe().then(()=>{Mb.a.instance.kc(nb.a.Hjh,(new Date).getTime());
this.g1.p2m();Mb.a.instance.kc(nb.a.Qlh,(new Date).getTime());Aa.a(this.$)("floatingContainerManager").then(()=>{Mb.a.instance.kc(nb.a.lgh,(new Date).getTime());this.g1.h1m();Mb.a.instance.kc(nb.a.mgh,(new Date).getTime());const Ua=this.Vya.I0();Ua&&0<Ua.length?(this.g1.EJn(),Mb.a.instance.kc(nb.a.XSg,(new Date).getTime()),Ea.App.kDb(null,nb.a.XSg)):La.a.J(512262875,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}).catch(Ua=>{La.a.J(512262874,801,10,"Failed to load the resources for the floating container UI + "+
Ua.toString())})})}su(){this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame").Zf()}dispose(){this.Smh&&this.Smh.rWn();this.g1&&this.g1.dispose();this.xCj&&this.xCj.dispose();this.mcc=null}get name(){return"PowerPointWebEditor.CommentsPackage"}static main(){Mb.a.instance.kc(nb.a.odh,(new Date).getTime());ub.a.instance.Fc(new Wd,0,!0)}}Object(c.a)(Wd,"CommentsPackage",null,[3,4]);var ce=a(154);Type.registerNamespace("Common.App.SharedComments");Type.registerNamespace("FloatingContainer");Type.registerNamespace("FloatingContainerManager");
Type.registerNamespace("PowerPointWeb.Comments");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("RichContentEditAPI");Type.registerNamespace("Common.Comments");Object(ce.c)("Comment");Wd.main();Object(ce.b)("Comment")},664:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(1233);class b{constructor(f){this.Bm=new c.a;this.rbd=f}w$(f){const e=f.id;let h=null;this.Bm.Ob(e)?h=this.Bm.ha(e):(this.rbd&&(h=this.rbd(f,()=>{this.QJg(e)})),h&&this.Bm.K(e,h));return h}k5(f){f=
f.id;return this.Bm.Ob(f)?this.Bm.ha(f):null}QJg(f){this.Bm.remove(f)}}Object(x.a)(b,"ShapeComponentViewManager",null,[738])},882:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=
null}}Object(x.a)(c,"CalloutParameters",null,[])},883:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}Object(x.a)(c,"ICalloutProps",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.comment.js.map