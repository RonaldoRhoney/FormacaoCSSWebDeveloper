'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[25],{1685:function(x,G,a){a.r(G);x=a(0);var c=a(118);class b{get name(){return"Ppt.UploadDocument"}lc(I){this.$=I}init(){this.$.resolve("Common.IInsertFileUploader")}static main(){c.a.instance.Fc(new b)}dispose(){}}Object(x.a)(b,"PptUploadDocumentPackage",null,[3,4]);var f=a(17),e=a(68),h=a(20);class u{constructor(I,ba){this.start=I;this.end=ba}}Object(x.a)(u,"SliceByteRange",null,[]);var m=a(4),n=a(39),l=a(174),
r=a(5),w=a(92);class y{constructor(I,ba,Ga,Oa){this.K6e=null;this.Yxe=0;this.sDa=1E3;this.Hyb=I;this.$mm=ba;this.Ghm=Ga;this.JIh=Oa}VQn(){this.K6e=y.fCm(this.Hyb);const I=this.Hyb.slice(this.K6e.ha(0).start,this.K6e.ha(0).end);this.j_k(I,0)}j_k(I,ba){const Ga=y.oPm(this.Hyb.size,this.K6e.ha(ba));this.Yxe++;y.$nf(this.$mm,I,Oa=>{if(Oa.status===l.a.wnm)this.msn(ba);else if(Oa.status===l.a.m6c){f.ULS.sendTraceTag(508822418,231,50,"MSO:BlobSlicer: File created successfully");try{var Ja;let Qa;if(!({BD:Qa}=
h.d(Oa.responseText)).returnValue)throw Error.create("Unable to deserialize OneDriveItem response json");(Ja=Qa)?this.Ghm(Ja):(f.ULS.sendTraceTag(508822417,231,10,"MSO:BlobSlicer: OneDriveItem is null"),this.JIh(2))}catch(Qa){f.ULS.sendTraceTag(508822416,231,10,"Exception while parsing OneDriveItemResponse {0}",Qa.message),this.JIh(2)}}else this.pIn(I,ba,Oa.status)},Ga)}msn(I){f.ULS.sendTraceTag(508822415,231,50,"MSO:BlobSlicer Slice uploaded successfully. SliceNumber {0}, UploadAttempts {1}",I,this.Yxe);
this.s_l();var ba=this.K6e.ha(I+1);ba=this.Hyb.slice(ba.start,ba.end);this.j_k(ba,I+1)}pIn(I,ba,Ga){1>this.Yxe&&y.U5m(Ga)?(f.ULS.sendTraceTag(508822414,231,10,"MSO:BlobSlicer: Retrying Slice upload request. Failure statusCode: {0}, attempts {1}",Ga,this.Yxe),m.AFrameworkApplication.je.Qb(new n.a(2,1,this.sDa,()=>{this.j_k(I,ba)},42)),this.sDa*=2):(f.ULS.sendTraceTag(508822413,231,10,"MSO:BlobSlicer: Slice upload request failed, aborting the upload. Failure statusCode: {0}, attempts {1}",Ga,this.Yxe),
this.s_l(),this.JIh(1,Ga))}s_l(){this.Yxe=0;this.sDa=1E3}static fCm(I){const ba=new e.a;I=I.size;const Ga=Math.ceil(I/5242880);let Oa=0,Ja;for(let Qa=0;Qa<Ga;Qa++)Ja=Math.min(Oa+5242880,I),ba.add(new u(Oa,Ja)),Oa=Ja;return ba}static oPm(I,ba){const Ga=new w.a;Ga.K("Content-Range",String.format("bytes {0}-{1}/{2}",ba.start,ba.end-1,I));Ga.K("Accept","application/json");return Ga}static $nf(I,ba,Ga,Oa){const Ja=new XMLHttpRequest;Ja.open("PUT",I,!0);if(Oa)for(const Qa of Oa)Ja.setRequestHeader(Qa.key,
r.a.Kna(Qa.value));Ja.onreadystatechange=()=>{4===Ja.readyState&&Ga(Ja)};Ja.send(ba)}static U5m(I){switch(I){case l.a.n6a:case l.a.a3m:case l.a.r7h:case l.a.DKn:case l.a.AKm:return!0;default:return!1}}}Object(x.a)(y,"BlobSlicer",null,[]);var z=a(36),A=a(7),B=a(6);const H=()=>"%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M12.9993%2017C12.9993%2016.4484%2012.5522%2016.0013%2012.0006%2016.0013C11.4491%2016.0013%2011.002%2016.4484%2011.002%2017C11.002%2017.5515%2011.4491%2017.9986%2012.0006%2017.9986C12.5522%2017.9986%2012.9993%2017.5515%2012.9993%2017ZM12.7401%209.1467C12.6901%208.78066%2012.3761%208.49876%2011.9964%208.49906C11.5822%208.49939%2011.2467%208.83545%2011.247%209.24966L11.2506%2013.7513L11.2575%2013.853C11.3075%2014.2191%2011.6215%2014.501%2012.0012%2014.5007C12.4154%2014.5003%2012.7509%2014.1643%2012.7506%2013.7501L12.747%209.24846L12.7401%209.1467ZM13.9693%203.65888C13.113%202.11108%2010.8878%202.1111%2010.0316%203.65893L2.28634%2017.6604C1.45678%2019.16%202.5414%2020.9995%204.25518%2020.9995H19.7462C21.46%2020.9995%2022.5446%2019.16%2021.715%2017.6603L13.9693%203.65888ZM11.3442%204.38501C11.6296%203.86907%2012.3713%203.86906%2012.6567%204.38499L20.4025%2018.3865C20.679%2018.8863%2020.3175%2019.4995%2019.7462%2019.4995H4.25518C3.68392%2019.4995%203.32238%2018.8863%203.5989%2018.3865L11.3442%204.38501Z%22%20fill%3D%22%23817400%22%2F%3E%0A%3C%2Fsvg%3E%0A",
v=(I,ba)=>{appChrome.PRIToastManager.showToastForUploadFile("",I,ba);I=new n.a(2,m.AFrameworkApplication.ga&&m.AFrameworkApplication.ga.isChangeGateEnabled("FixEarlyToastDismissIssue")?1:2,8E3,C,0);m.AFrameworkApplication.je.Qb(I)},C=()=>{appChrome.PRIToastManager.dismissToast()},F=I=>{const ba='\\/:*?"<>|'.split(""),Ga=new Sys.StringBuilder("");if(!I||""===I)return f.ULS.sendTraceTag(508672207,231,10,"MSO:InsertFileUploaderUtils: Empty File Name"),v(Object(B.a)("UploadFileWithEmptyFileName"),H()),
!1;if(250<I.length)return f.ULS.sendTraceTag(508672206,231,10,"MSO:InsertFileUploaderUtils: File Name larger than limit"),I=String.format(Object(B.a)("UploadFileWithLargerFileName"),250),v(I,H()),!1;let Oa=!1;for(let Ja=0;Ja<ba.length;Ja++)Ga.append(ba[Ja]),Ga.append(" "),z.a(I,ba[Ja])&&(Oa=!0);return Oa?(f.ULS.sendTraceTag(508672205,231,10,"MSO:InsertFileUploaderUtils: Invalid character in File Name"),I=String.format(Object(B.a)("UploadFileWithInvalidCharacterInFileName"),Ga.toString()),v(I,H()),
!1):!0};var D=a(86),N=a(33),U=a(26);class W{constructor(){this.G4k=this.N9g=this.Hyb=null;this.twe=0;this.ulm=1E3;this.D4k=""}$1l(I){this.D4k=I}cCn(I){this.pFe()?f.ULS.sendTraceTag(508822472,231,10,"MSO:CloudFileUploadManager:QueueFileUpload There is already an upload in progress"):I?(f.ULS.sendTraceTag(508822470,231,50,"MSO:CloudFileUploadManager: File Queued of size: {0} and type: {1}",I.size.toString(),I.type),this.Hyb=I,appChrome.PRIToastManager.showToastForUploadFile("",Object(B.a)("UploadFileProcessStartedMessage"),
null,!0),this.l6c()):f.ULS.sendTraceTag(508822471,231,10,"MSO:CloudFileUploadManager:QueueFileUpload Invalid upload context")}pFe(){return!!this.Hyb}l6c(){let I=m.AFrameworkApplication.ga.isChangeGateEnabled("UsePopsServiceForUploadFeature")?String.format("{0}UploadFileToHostHandler.ashx?action=uploadFile&{1}",this.D4k,m.AFrameworkApplication.ui):String.format("UploadFileToHostHandler.ashx?action=uploadFile&{0}",m.AFrameworkApplication.ui);I=N.a.ezb(I,"filename",this.Hyb.name);const ba=["request-id"];
this.twe++;const Ga={};Ga.ismsa=m.AFrameworkApplication.ga.getBooleanAppSetting("IsO365ConsumerHost");try{this.lmm=Date.now(),m.AFrameworkApplication.ye.rk(I,1,null,Ga,!1,2,Oa=>{this.Xnf(Oa)},Oa=>{this.mIn(Oa)},null,void 0,void 0,void 0,3E4,void 0,void 0,void 0,void 0,ba)}catch(Oa){f.ULS.sendTraceTag(508822469,231,10,"MSO:CloudFileUploadManager: Exception when creating uploadSession {0}",Oa.message),this.wxg(0)}}mIn(I){2>this.twe?(f.ULS.sendTraceTag(508822468,231,10,"MSO:CloudFileUploadManager: CreateUploadSession request failed with code: {0}, with correlation and request id {1} and attempts {2}",
I.data.Ze,I.data.fk,this.twe),this.l6c()):(f.ULS.sendTraceTag(508822467,231,10,"MSO:CloudFileUploadManager: CreateUploadSession request failed with code: {0}, with correlation and request id {1} and attempts {2}",I.data.Ze,I.data.fk,this.twe),this.wxg(0,I.data.Ze))}Xnf(I){f.ULS.sendTraceTag(508822466,231,50,"MSO:CreateUploadSessionRequestSucceeded:CloudFileUploadManager CloudAttachment request succeeded with code: {0}, with correlation and request id {1} and message {2} and attempts {3}",I.data.Ze,
I.data.fk,I.data.responseData,this.twe);try{var ba;let Ga;if(!({BD:Ga}=h.d(I.data.responseData)).returnValue)throw Error.create("Unable to deserialize uploadSession response json");(ba=Ga)&&ba.uploadUrl&&""!==ba.uploadUrl?this.OYn(ba.uploadUrl):(f.ULS.sendTraceTag(507901398,231,10,"createUploadSessionRequestSucceeded: upload session created: {0}",ba?!0:!1),this.wxg(0))}catch(Ga){f.ULS.sendTraceTag(508822465,231,10,"MSO:CreateUploadSessionRequestSucceeded:CloudFileUploadManager Exception while parsing OneDriveItemResponse {0}",
Ga.message),this.wxg(0)}}OYn(I){this.G4k=new y(this.Hyb,I,ba=>{this.Iym(ba)},(ba,Ga)=>{this.wxg(ba,Ga)});m.AFrameworkApplication.je.Qb(new n.a(2,1,this.ulm,()=>{this.G4k.VQn()},42))}Iym(I){this.pFe()?(this.N9g=I,this.j_(!0)):f.ULS.sendTraceTag(508822464,231,15,"MSO:CloudFileUploadManager:CompleteUpload There is no upload in progress")}wxg(I,ba=0){this.pFe()?(f.ULS.sendTraceTag(507901397,231,10,"onFileUploadFailed: failureType {0} with status {1}",I,ba),I=this.JOm(ba),v(I,H()),this.j_(!1)):f.ULS.sendTraceTag(508822435,
231,15,"MSO:CloudFileUploadManager:OnFileUploadFailed There is no upload in progress, failureType {0}",I)}JOm(I=0){switch(I){case 507:return Object(B.a)("UploadFileInsufficientStorageError");default:return Object(B.a)("UploadFileInternalServerError")}}j_(I){this.pFe()?(I&&(f.ULS.sendTraceTag(508703698,231,50,"MSO:CloudFileUploadManager: File successfully uploaded"),I=Date.now()-this.lmm,f.ULS.sendTraceTag(508044241,231,50,"TimeTaken: {0} to upload a file of Size:{1}",I,this.Hyb.size.toString()),this.Hyb.name!==
this.N9g.name&&f.ULS.sendTraceTag(508672208,231,50,"MSO:CloudFileUploadManager: Renamed file name"),appChrome.PRIToastManager.dismissToast(),U.a.aCe(this.N9g.webUrl),D.a.dispatch("fileUploadedSuccessfully")),this.Hyb=null,this.twe=0,this.N9g=null):f.ULS.sendTraceTag(508822434,231,15,"MSO:CloudFileUploadManager: There is no upload in progress")}}Object(x.a)(W,"CloudFileUploadManager",null,[1342]);var L=a(40);class O{constructor(I,ba,Ga){this.p1c=this.jSl=null;this.Vyb=this.a9a=0;this.p8g=null;this.Hpn=
Oa=>{if(this.Y_k(Oa)){if(A.a.KA||A.a.zg)this.p8g=Oa;this.FZa(this.p1c)}};this.qx=I;this.ze=ba;this.Ba=Ga;this.Bui=!1;this.m$l=!0;this.JHn();this.rIe=this.ga.getBooleanAppSetting("NativeFileOpenDialogIsEnabled")}get context(){return this.qx}get ga(){return this.Ba}get retryCount(){return this.a9a}get aec(){return this.Vyb}Xcc(I){this.p1c=I;if(!this.Bui){if(this.m$l){if(this.rIe&&A.a.KA){this.p8g=I.wNb(this.Hpn);return}this.p8g=I.wNb(null);if(!this.Y_k(this.p8g))return}this.FZa(I)}}ebb(){this.jSl&&
this.jSl()}JHn(){this.a9a=0;this.Vyb=this.ga.Jc("Box4UploadRetryDelayStart",200);this.p1c&&(this.p1c.dispose(),this.p1c=null)}}Object(x.a)(O,"FileUploader",null,[]);var M=a(13);const K=(I,ba,Ga)=>{if(I){var Oa=0;do{try{I();break}catch(Ja){if(f.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",Oa,Ga,Ja.message,Ja.stack),Oa>=ba)break}Oa++}while(1)}};var P=a(366),V=a(121),Y=a(1528),ta=a(83);class fa{constructor(I,ba,Ga,Oa,Ja,Qa,Pa,ja,
va=!0,Ha=null,gb=!1,Gb=null){this.Mrl="FileUpload.ashx";this.MM=null;this._initialized=!1;this.zm=this.sXe=this.GIh=this.fah=this.m8g=this.O_=this.Xra=null;this.yn=!1;this.a9=this.o8g=this.iWh=null;this.KIm=()=>{this.m8g&&(this.m8g.innerText=this.GPm())};this.nce=()=>{try{if(!this.MM.contentWindow.document.body)return}catch(hb){return}if(!(this._initialized||this.rIe&&A.a.KA))this.otc();else if(!this.rIe||!A.a.KA||this.b5m){var Mb=this.MM.contentWindow.document.body.innerText.toLowerCase();const hb=
0<=Mb.indexOf("responses")||0<=Mb.indexOf("wopisrc");Mb=0<=Mb.indexOf("http error");!hb&&Mb&&f.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.MM.contentWindow.document.body.innerText)}};this._parent=I;this.yim=ba;this.W6k=Ja;this.i6e=Pa;this.$3k=ja;this.c$k=Gb;this.W4k=Ha;this.hWh=!1;this.Oim=Oa.getBooleanAppSetting("CanaryRenewalForFileUploadIsEnabled");(this.v3c=gb)||this.dmf(Qa);va&&this.WAl()}get sessionId(){return this.i6e}get iFrame(){return this.MM}get Wfh(){return this.O_}get rIe(){return m.AFrameworkApplication.ga?
m.AFrameworkApplication.ga.getBooleanAppSetting("NativeFileOpenDialogIsEnabled"):!1}get Irl(){return m.AFrameworkApplication.ga?m.AFrameworkApplication.ga.getBooleanAppSetting("FileInputDescriptionAccessibilityIsEnabled"):!1}get QYn(){return m.AFrameworkApplication.ga?m.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.UploadDocumentFromPCIsEnabled",!1):!1}get b5m(){return this.v3c?!1:z.b(this.MM.contentWindow.location.pathname,this.Mrl,0)}get Irm(){return!A.a.eA&&m.AFrameworkApplication.ga.getBooleanAppSetting("AllowMultipleImageInsertFromLocalDevice")}WAl(){this.a9=
ta.a.create().toString();this.v3c?this.otc():this.lsm()}dmf(I){this.MM=document.createElement("iframe");this.MM.className=I;this.MM.id=I;this.W6k&&(this.MM.style.visibility="visible",this.MM.style.height="30px",this.MM.setAttribute("frameborder","0"));this.fah=this.nce;M.a.addHandler(this.MM,"load",this.fah)}wNb(I=null){m.AFrameworkApplication.Ea.mUa();if(!this.O_)return f.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";M.a.addHandler(this.O_,"change",()=>{this.Fwf(I)});K(Object(L.a)(this,
this.LIm,"fileInputClick"),1,"DoFileOpenDialog");return this.O_.value}Fwf(I){I&&I(this.O_.value)}GPm(){let I=null;if(this.O_.value){const ba=this.O_.value,Ga=ba.lastIndexOf("\\");0<Ga&&(I=ba.substring(Ga+1,ba.length))}return I?I:""}LIm(){try{f.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.O_.click()}catch(I){throw f.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",I.message),I;}}iyh(){this.j6m()?this.NNe():(this.ZZk(),
this.Xra.submit())}j6m(){return(this.Oim||this.v3c)&&!(void 0===window.self.FormData||null===window.self.FormData)}wMe(I){if(I){const ba=this.Vll();this.zm=new XMLHttpRequest;this.zm.open("POST",ba);this.zm.setRequestHeader("X-CorrelationId",this.a9);this.f$m(I);this.zm.onreadystatechange=Object(L.a)(this,this.s8a,"uploadResponseReceived");this.zm.send(I)}}f$m(I){if(!A.a.eA&&I.get){var ba=I.get("ImageId");I=window.self.navigator;ba={["CorrelationId"]:this.a9,["Canary"]:m.AFrameworkApplication.oC,
["ImageNodeId"]:ba};I&&(I=I.connection?I.connection:I.mozConnection?I.mozConnection:I.webkitConnection?I.webkitConnection:null)&&(ba.effectiveType=I.effectiveType,ba.downlink=I.downlink,ba.type=I.type,ba.rtt=I.rtt);f.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",ba)}}NNe(){try{this.ZZk();f.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const I=new (Type.parse("FormData"))(this.Xra);this.wMe(I)}catch(I){f.ULS.sendTraceTag(594888407,
322,10,"SubmitFormWithRequest failed to send the request with exception "+I.message)}}VSn(I){try{if(this.ZZk(),f.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.h_n(I)){this.o8g=I;this.Xra.contains(this.O_)&&this.Xra.removeChild(this.O_);var ba=new (Type.parse("FormData"))(this.Xra);ba.append("applicationfileInput",I.blob,I.filename);this.wMe(ba)}}catch(Ga){f.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+
Ga.message)}}h_n(I){return I&&void 0!==I.blob&&null!==I.blob&&void 0!==I.filename&&null!==I.filename&&""!==I.filename?void 0===window.self.FormData||null===window.self.FormData?(f.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(I=I?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===I.blob||null===I.blob,void 0===I.filename||null===I.filename||""===I.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",
f.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",I)),!1)}s8a(){if(4===this.zm.readyState)if(200===this.zm.status){f.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.a9);const I=this.zm.getResponseHeader("X-NewKey"),ba=this.K3m(this.zm);let Ga=!1;if(void 0!==I&&null!==I&&ba&&(Ga=this.b_n(I),!this.hWh&&Ga)){f.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",
this.a9);this.hWh=!0;void 0!==this.o8g&&null!==this.o8g?this.VSn(this.o8g):this.NNe();return}f.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.hWh,ba,!(void 0===I||null===I),Ga,this.a9)}else f.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.zm.status,this.zm.responseText?!1:!0,this.a9)}K3m(I){try{const ba=
h.a(I.responseText).Responses;if(void 0!==ba&&null!==ba&&1===ba.length){const Ga=ba[0];if(void 0!==Ga&&null!==Ga&&2===Ga.length&&28===Ga[1].StatusCode)return!0}}catch(ba){}return!1}b_n(I){Y.a.L8b(I);return m.AFrameworkApplication.oC!==I?!1:!0}ZZk(){this.iWh||(this.iWh=new Date)}dispose(){this.yn||(this.v3c?this._parent.removeChild(this.Xra):(this._parent.removeChild(this.MM),M.a.removeHandler(this.MM,"load",this.fah),this.fah=null),this.GIh&&(M.a.removeHandler(this.O_,"change",this.GIh),this.GIh=
null),this.Irl&&(this.sXe&&(M.a.removeHandler(this.O_,"change",this.sXe),this.sXe=null),this.m8g=null),this.O_=this.Xra=this._parent=this.MM=null,this.yn=!0,this.iWh=null,f.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}neh(){this.dispose()}cBm(I){if(this.Xra){var ba;(ba=this.Xra.querySelector("input[name=__REQUESTDIGEST]"))?ba.value=I:(ba=this.Omf(),ba.type="hidden",ba.id="__REQUESTDIGEST",ba.name="__REQUESTDIGEST",ba.value=I,this.Xra.appendChild(ba))}}Omf(){return this.v3c?document.createElement("input"):
this.MM.contentWindow.document.createElement("input")}otc(){if(!this._initialized){var I=this.i3("uploadForm");const ba=this.i3("fileInput"),Ga=this.Vll();this.XAm();this.Xra.id=I;this.Xra.method="post";this.Xra.encoding="multipart/form-data";this.Xra.action=Ga;this.O_.type="file";this.$3k&&(this.O_.accept=this.$3k,this.W4k&&(this.O_.capture=this.W4k));this.O_.id=ba;this.O_.name=ba;this.Irm&&(this.O_.multiple=!0);this.QYn&&("true"===this.c$k?this.O_.multiple=!0:"false"===this.c$k&&(this.O_.multiple=
!1));!this.Irl||A.a.ul||A.a.Uo||(this.sXe=this.KIm,M.a.addHandler(this.O_,"change",this.sXe),this.m8g=P.a.Pbf(this.Xra,this.O_,"InputFileDescription",""));this.W6k&&(this.v3c||(I=this.MM.contentWindow.document.body,I.style.margin="0",I.style.overflow="hidden"),I=m.AFrameworkApplication.Ea,this.O_.style.fontFamily=I.N8,this.O_.style.fontSize=I.Ifd,this.O_.style.margin="0");(I=document.getElementById("__REQUESTDIGEST"))&&this.cBm(I.value);this.Xra.appendChild(this.O_);this._initialized=!0;this.yim(this)}}XAm(){if(this.v3c)this.Xra=
document.createElement("form"),this._parent.appendChild(this.Xra),this.O_=document.createElement("input");else{this.Xra=this.MM.contentWindow.document.createElement("form");const I=this.MM.contentWindow.document;I.body.appendChild(this.Xra);this.O_=I.createElement("input")}}lsm(){this._parent.appendChild(this.MM);this.rIe&&A.a.KA&&this.otc()}Vll(){var I=new V.QueryStringBuilder(this.Mrl);m.AFrameworkApplication.dzb(I);I=I.toString();if(A.a.zg||A.a.KA||A.a.Uo)I=N.a.XJa(I);return I}}Object(x.a)(fa,
"UploadFrame",null,[24]);class Ta extends fa{constructor(I,ba,Ga,Oa,Ja,Qa,Pa=null,ja,va=!1){super(I,ba,Ga,Oa,Ja,"WACUploadFrame",m.AFrameworkApplication.userSessionId,Qa,void 0,Pa,va,"false");this.WAl()}i3(){return ta.a.create().toString()}}Object(x.a)(Ta,"FileUploadFrame",fa,[]);var ha=a(19);class qa extends O{constructor(I,ba,Ga){super(I,ba,Ga);this.IK=this.c5k=null;this.Ipn=Oa=>{Oa?(Oa=Oa.split("/"),Oa=Oa[Oa.length-1].split("\\"),Oa=Oa[Oa.length-1]):Oa=null;this.f_n(Oa)&&this.lym.cCn(this.p1c.Wfh.files[0])};
this.cTj=0;this.x3h=new e.a}get jca(){return this.IK||(this.IK=ha.a.instance.resolve("Common.Utils.IAriaNotifier"))}get lym(){return this.c5k||(this.c5k=ha.a.instance.resolve("Common.App.UploadFromPC.ICloudFileUploadManager"))}G2l(I){this.cTj=I}U1l(I){this.x3h=I}get VYn(){return"InsertFile"}showDialog(){var I;if((I=this.x3h)&&I.count){var ba=new Sys.StringBuilder(""),Ga=I.count;for(let Oa=0;Oa<Ga-1;Oa++)ba.append("."),ba.append(I.ha(Oa)),ba.append(", ");ba.append(".");ba.append(I.ha(Ga-1));I=ba.toString()}else I=
"";""===I?v(Object(B.a)("UnableToOpenFilePickerDialog"),H()):void 0!==window.self.FormData&&null!==window.self.FormData?(this.Bui=!1,this.p1c=new Ta(document.body,Object(L.a)(this,this.Xcc,"onUploadFrameInitialized"),Object(L.a)(this,this.s8a,"uploadResponseReceived"),this.ga,!1,I,void 0,void 0,!0)):A.a.ul||A.a.Uo||this.rIe&&A.a.KA?f.ULS.sendTraceTag(508699840,231,50,"MSO:InsertFileUploader: Dialog not rendered for OpenFilePickerDirectly: {0}",A.a.ul||A.a.Uo):f.ULS.sendTraceTag(508822474,231,50,"MSO:InsertFileUploader: Dialog not rendered")}Xcc(I){this.p1c=
I;this.Bui||(this.m$l?(f.ULS.sendTraceTag(508703702,231,50,"MSO:InsertFileUploader: Insert file uploader frame opened"),I.wNb(this.Ipn)):this.FZa(I))}f_n(I){if(!this.Y_k(I))return!1;if(!this.g_n(I))return f.ULS.sendTraceTag(508703700,231,10,"MSO:InsertFileUploader: Invalid File Extension"),v(Object(B.a)("UploadFileWithInvalidExtension"),H()),!1;I=this.YHm(this.p1c);var ba=this.cTj;f.ULS.sendTraceTag(508822419,231,50,"{0}:Size:{1}",this.VYn,I);if(!(0<I&&I<=1048576*ba))return f.ULS.sendTraceTag(508703699,
231,10,"MSO:InsertFileUploader: Invalid File Size"),I=String.format(Object(B.a)("UploadFileLargerThanMaxSize"),this.cTj),v(I,H()),!1;f.ULS.sendTraceTag(508822473,231,50,"MSO:InsertFileUploader: Cloud File Upload of size: {0}",I);return!0}g_n(I){I=RegExp("\\.([a-zA-Z0-9]{1,5})$").exec(I);return this.x3h.contains(I&&2===I.length?I[1]:null)}Y_k(I){return F(I)}FZa(){this.PYn()}YHm(I){return I.Wfh.files[0].size}s8a(){}PYn(){this.ebb();this.jca.H8(Object(B.a)("UploadCompletedText"),!0)}}Object(x.a)(qa,
"InsertFileUploader",O,[1343]);class ra{constructor(){this.Ha=null}get name(){return"Common.App.UploadFromPC"}init(){}dispose(){}lc(I){this.Ha=I;this.Ha.register(1342,"Common.App.UploadFromPC.ICloudFileUploadManager").ma().na(()=>new W);this.Ha.register(1343,"Common.IInsertFileUploader").ma().na(()=>new qa(null,m.AFrameworkApplication.je,m.AFrameworkApplication.ga))}static main(){c.a.instance.Fc(new ra,7)}}Object(x.a)(ra,"FileUploaderPackage",null,[3,4]);Type.registerNamespace("PowerPointWebEditor.UploadFromPC");
Type.registerNamespace("Common.App.UploadFromPC");ra.main();b.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.uploaddocument.js.map