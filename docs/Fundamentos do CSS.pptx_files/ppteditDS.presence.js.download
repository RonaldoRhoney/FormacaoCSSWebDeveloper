'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[12],{1495:function(x,G,a){a.d(G,"a",function(){return f});x=a(0);var c=a(278);class b{constructor(e,h,u){this.slideId=e;this.shapes=h;this.sn=u}}Object(x.a)(b,"SerializablePresenceData",null,[]);class f{constructor(e,h,u=0){if(!f.isValid(e))throw Error.create("Invalid Presence Data");this.jK=e;this.Sph=h;this.HLl=u?u:++f.XCm}get $v(){return this.jK}get XPa(){return this.Sph}toString(){return this.jK.toString()+" : "+
(this.XPa&&this.XPa.length?this.XPa[0].toString():"")+" : "+this.HLl}dVi(){return new b(this.jK.hfc,this.Sph,this.HLl)}static isValid(e){return!!e}static Rdh(e){return new f(new c.a(e.slideId),e.shapes,e.sn)}}f.XCm=0;Object(x.a)(f,"PresenceData",null,[])},1683:function(x,G,a){a.r(G);x=a(0);class c{constructor(ac,eb){this.H3c=null;this.Y4a=()=>{c.Zgl(this.H3c.jGd())&&(this.H3c.Cpk(this.Y4a),this.Gkm.IsRealCoauthSession=!0)};this.U3e=ac;this.Gkm=eb}init(){this.U3e.continueWith(()=>{this.H3c=this.U3e.result;
this.H3c.Rye(this.Y4a)})}static Zgl(ac){let eb=null;for(const Hb of ac)if(Hb)if(ac=Hb.isAnonymous||!Hb.email?Hb.clientId:Hb.email.toUpperCase(),!eb)eb=ac;else if(eb!==ac)return!0;return!1}}Object(x.a)(c,"CoauthTelemetry",null,[1509]);var b=a(17),f=a(219),e=a(231),h=a(4),u;(function(ac){ac[ac.g2n=0]="badStatePreventedTelemetry";ac[ac.notImplemented=1]="notImplemented";ac[ac.L5n=2]="renderHandled";ac[ac.M5n=3]="renderHandledWithVeto"})(u||(u={}));Object(x.b)("CoauthorGalleryTelemetryEndResult",u);var m=
a(42),n=a(21),l=a(91),r=a(46);class w{constructor(ac,eb,Hb,ua,Va,Yb,Cb,ca,Ra){this.aal=this.g5k=this.$ra=null;this.esh=()=>{this.Y4a()};this.Oxg=()=>{const bb=this.mP.Ph("AppInitStatus_interactivityReady");b.ULS.shipAssertTag(42259235,325,!!this.U$g);const wb=this.U$g-bb,Fa={};Fa.InteractiveTime=bb;Fa.ReactRenderComplete=this.U$g;Fa.HadTabSwitch=this.Dhd();Fa.IsModernGallery=this.f4c;b.ULS.sendTraceTag(594883104,325,20,n.a.toJSON(Fa));this.f4c?(b.ULS.sendTraceTag(42062997,325,15,wb.toString()),this.I$g.uZ(this.o_n(wb)?
3:2)):b.ULS.sendTraceTag(594883103,325,15,wb.toString())};this.I8a=ac;this.I$g=new f.a;this.Ba=Hb;this.ZFh=eb;this.Ska=ua;this.mP=Va;this.gQh=Yb;this.B3c=Cb;this.Ffm=ca;this.p7k=this.m7k=!1;this.U$g=0;this.e5k=1;this.Dhd=Ra;this.f4c=this.Ba.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled");this.o2c=Object(e.a)(String,h.AFrameworkApplication.Rf.Application)||""}get w6l(){return this.I$g.task}init(){r.Task.WAA.call(null,this.B3c,this.ZFh,this.gQh).continueWith(()=>{this.$ra=this.B3c.result;
this.g5k=this.ZFh.result;this.aal=this.gQh.result;r.Task.WAA.call(null,this.ZFh.result.H9a,this.gQh.result.Eyh).continueWith(()=>{this.e5k=this.g5k.H9a.result;this.U$g=this.aal.Eyh.result;this.$ra.Rye(this.esh);this.$ra.jGd().length&&this.Y4a()})})}Y4a(){this.Ffm(this.$ra.jGd())?(this.$ra.Cpk(this.esh),this.Kpn(this.m7k)):this.I$g.uZ(1);this.m7k=!0}Kpn(ac){this.p7k?this.w6l.continueWith(()=>{b.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",u[this.w6l.result])}):
(this.p7k=!0,this.mBn(0===this.e5k&&!ac))}mBn(ac){ac?this.Ska.$i(4,this.Oxg):this.I$g.uZ(1)}o_n(ac){const eb=ac>this.Ba.Jc("CoauthorGalleryTimeToRenderDurationMs",1E4);var Hb="Word"===this.o2c;const ua="PowerPoint"===this.o2c;if(this.Dhd())return b.ULS.sendTraceTag(50455714,325,50,eb.toString()),!1;Hb&&m.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",l.b.FailureBased,"wordcollabrel",null);eb&&(Hb&&m.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",
!1,!0,null),Hb=h.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientCoauthorGalleryRenderLatencyQoSError"),ua&&Hb&&ac<this.Ba.Jc("CoauthorGalleryTimeToRenderCutoffThresholdMs",3E4)&&m.Health.instance.recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,null),b.ULS.sendTraceTag(42062998,325,15,ac.toString()));return eb}}Object(x.a)(w,"CoauthorGalleryTelemetry",null,[1508]);class y{constructor(ac){this.$ra=
null;this.F7g={};this.W9g={};this.HZe=null;this.Y4a=()=>{this.T9l()};this.Gym=(eb,Hb)=>eb.aUb>Hb.aUb?1:eb.aUb<Hb.aUb?-1:0;this.B3c=ac}Shh(ac){const eb=new f.a;this.init().continueWith(()=>{ac in this.F7g?eb.uZ(this.F7g[ac]):this.W9g[ac]=eb});return eb.task}init(){if(this.HZe)return this.HZe.task;this.HZe=new f.a;this.B3c.continueWith(()=>{this.$ra=this.B3c.result;this.$ra.Rye(this.Y4a);this.T9l();this.HZe.vj(null)});return this.HZe.task}T9l(){const ac=this.$ra.jGd();ac.sort(this.Gym);this.F7g={};
for(let eb=0;eb<ac.length&&ac[eb]&&ac[eb].aUb;eb++)this.Zom(this.F7g,ac[eb].clientId,eb)}Zom(ac,eb,Hb){ac[eb]=Hb;eb in this.W9g&&(this.W9g[eb].uZ(Hb),delete this.W9g[eb])}}Object(x.a)(y,"CoauthorPositionFinder",null,[1507]);var z=a(232),A=a(233),B=a(1584),H=a(68),v=a(83);class C{constructor(){this.gJb=null;this.gUe=Array(32)}xor(ac){if(!ac)throw Error.argumentNull("Guid argument cannot be null");const eb=new C,Hb=new Sys.StringBuilder;for(let ua=0;ua<ac.gUe.length;ua++){const Va=this.gUe[ua]^ac.gUe[ua];
eb.gUe[ua]=Va;Hb.append(Va.toString(16));7!==ua&&11!==ua&&15!==ua&&19!==ua||Hb.append("-")}eb.gJb=v.a.Xf(Hb.toString());return eb}toString(){return this.gJb.toString()}equals(ac){if(!ac)throw Error.argumentNull("Guid argument cannot be null");return this.gJb.equals(ac.gJb)}static fromString(ac){if(!ac)throw Error.argumentNull("String input cannot be null");const eb=new C;eb.gJb=v.a.Xf(ac);const Hb=eb.gJb.toString();let ua=0;for(let Yb=0;Yb<Hb.length;Yb++){var Va=ac.charAt(Yb);if(C.M4m(Va))Va=C.HYm(Va,
ac.charCodeAt(Yb)),eb.gUe[ua++]=Va;else if(!C.E4m(Va))throw Error.argument("String contains characters not valid in Guids");}return eb}static M4m(ac){return"0"<=ac&&"9">=ac||"A"<=ac&&"F">=ac||"a"<=ac&&"f">=ac}static E4m(ac){return"{"===ac||"}"===ac||"-"===ac}static HYm(ac,eb){if("0"<=ac&&"9">=ac)return eb-48;if("A"<=ac&&"F">=ac)return eb-65+10;if("a"<=ac&&"f">=ac)return eb-97+10;throw Error.argument("Char is not valid hex digit");}}Object(x.a)(C,"Guid",null,[]);var F=a(80);class D{constructor(ac,
eb,Hb,ua){this.H3c=null;this.A5k=this.d$k=!1;this.f9k=0;this.Y4a=()=>{this.qym(this.H3c.jGd())};this.U3e=ac;this.vUh=eb;this.Ba=Hb;this.qOh=ua;this.ufm=h.AFrameworkApplication.dfc||h.AFrameworkApplication.a1;this.w9k=new z.a(A.a.Wn())}get Gri(){return this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}init(){this.U3e.continueWith(()=>{this.H3c=this.U3e.result;this.H3c.Rye(this.Y4a)})}qym(ac){var eb=0;const Hb=new B.a(A.a.Wn());for(const ua of ac)if(ua&&
ua.isAnonymous){F.a.BI("70eb6120;2gfeb930");if(Hb.Ob(ua.userName))Hb.ha(ua.userName).add(ua.clientId);else{let Va;Hb.add(ua.userName,(Va=new H.a,Va.add(ua.clientId),Va))}ua.clientId!==this.qOh?(eb++,2<=eb&&!this.d$k&&this.t$m()):!this.A5k&&this.Gri&&"Guest"===ua.userName&&(b.ULS.sendTraceTag(509726851,302,50,"User was assigned 'Guest' name"),this.A5k=!0)}if(this.Gri&&this.f9k!==eb){b.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",eb+(this.ufm?1:0));this.f9k=eb;for(const ua of Hb.keys)2<=
Hb.ha(ua).count&&(ac=this.qOm(Hb.ha(ua)),this.w9k.contains(ac)||(eb={},eb.guestsWithSameName=Hb.ha(ua).count,eb.identifier=ac,b.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected: {0}",eb),this.w9k.add(ac)))}}t$m(){b.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.d$k=!0;this.Gri&&this.vUh&&this.vUh.continueWith(()=>{window.setTimeout(()=>{this.vUh.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}qOm(ac){if(!ac||1>=ac.count)return"";
let eb=C.fromString(ac.ha(0));for(let Hb=1;Hb<ac.count;Hb++)eb=eb.xor(C.fromString(ac.ha(Hb)));return eb.toString()}}Object(x.a)(D,"GuestCoauthTelemetry",null,[]);var N=a(151);class U{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(x.a)(U,"PL",null,[]);var W=a(20);class L{constructor(){this.ct=this.vt=this.d=0}static O1l(ac,eb,Hb){const ua=new L;ua.d=ac;ua.vt=eb;ua.ct=Hb;return W.c(ua)}}Object(x.a)(L,"VD",null,[]);class O{constructor(ac,eb,Hb,ua,
Va,Yb,Cb,ca,Ra){this.Mm=0;this.Kbl=!1;this._id=ac;this.icl=eb;this.xz=Hb;this.rOh=ua;this.gVh=Va;this.Csd=Yb;this.ajd=Cb;this.lgm=ca;this.Dhd=Ra;this.o2c=Object(e.a)(String,h.AFrameworkApplication.Rf.Application)||""}cve(ac){r.Task.WAA(this.icl,this.rOh,this.gVh).continueWith(()=>{if(this.rOh.result<=this.gVh.result)ac.uZ(!1);else{this.Mm=this.icl.result;var eb=this.xz-this.Mm,Hb=new U;Hb.id=this._id;Hb.et=this.xz;Hb.st=this.Mm;Hb.d=this.xz-this.Mm;Hb.mp=this.rOh.result;Hb.tp=this.gVh.result;Hb.ct=
this.IMm(this.lgm);Hb.vc=this.Dhd();var ua=W.c(Hb),Va="Word"===this.o2c,Yb="PowerPoint"===this.o2c;b.ULS.sendTraceTag(42078597,302,15,ua);if(Va){const Cb=new Map;Cb.set("data",ua);m.Health.instance.recordKpiUsage("PresenceExperienceDegraded",l.b.FailureBased,"wordcollabrel",Cb)}eb>this.Csd.value&&!this.Kbl&&!Hb.vc&&(this.Kbl=!0,ac.uZ(!0),Hb={inStaging:!0,extendedProperties:new Map},Hb.extendedProperties.set("data",ua),Va&&m.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",
!1,!0,Hb),eb<this.ajd.value&&(b.ULS.sendTraceTag(42078598,302,15,L.O1l(eb,this.Csd.value,this.ajd.value)),eb=h.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientThumbnailPresenceRenderLatencyQoSError"),Yb&&eb&&(Hb.inStaging=!1,m.Health.instance.recordQosError("PresenceRenderDurationIsTooLong",["PresenceExperienceDegraded"],!1,!0,!0,!1,Hb))));ac.task.isCompleted||ac.uZ(!1)}})}IMm(ac){switch(ac){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";
default:return"Unknown"}}}Object(x.a)(O,"PresenceLatencyActivityLogger",null,[]);class M{constructor(ac,eb,Hb){this.V4k=this.d5k=this.C7g=this.E7g=this.hwe=0;this._id=ac;this.Csd=eb;this.ajd=Hb;this.o2c=Object(e.a)(String,h.AFrameworkApplication.Rf.Application)||""}get Wfl(){return this.hwe}set Wfl(ac){this.hwe=ac;this.Adi()}get rkl(){return this.E7g}set rkl(ac){this.E7g=ac;this.Adi()}get ljl(){return this.C7g}set ljl(ac){this.C7g=ac;this.Adi()}get skl(){return 0!==this.d5k}get mjl(){return 0!==this.V4k}Adi(){!this.skl&&
this.hwe&&this.E7g&&(this.d5k=this.cve(this.E7g,"CoauthGalleryLightupDurationTooLong"));!this.mjl&&this.hwe&&this.C7g&&(this.V4k=this.cve(this.C7g,"CanvasPresenceLightupDurationTooLong"))}cve(ac,eb){const Hb=ac-this.hwe;var ua=new U;ua.id=this._id;ua.et=ac;ua.st=this.hwe;ua.d=Hb;var Va=W.c(ua);ac="Word"===this.o2c;ua="CanvasPresenceLightupDurationTooLong"===eb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===eb?b.ULS.sendTraceTag(572289499,302,
15,Va):b.ULS.sendTraceTag(571524118,302,15,Va);if(ac){var Yb=new Map;Yb.set("data",Va);m.Health.instance.recordKpiUsage(ua,l.b.FailureBased,"wordcollabrel",Yb)}return Hb>this.Csd.value?(Yb=Object.assign({},{inStaging:!0,extendedProperties:new Map}),Yb.extendedProperties.set("data",Va),Va=Hb<this.ajd.value,Yb.extendedProperties.set("cash",Va?"true":"false"),ac&&m.Health.instance.recordKpiFailure(ua,eb,!1,!0,Yb),b.ULS.sendTraceTag(572289500,302,15,L.O1l(Hb,this.Csd.value,this.ajd.value)),Va?2:1):3}}
Object(x.a)(M,"PresenceLightupLatencyLogger",null,[]);class K{constructor(ac,eb,Hb,ua,Va,Yb,Cb,ca=null,Ra=null,bb=null){this.Aal={};this.XFh={};this.I8k=new H.a;this.p7g=this.IZe=this.$ra=this.q$g=null;this.hcl=this.gcl=0;this.Krn=(wb,Fa)=>{if(!this.I4k&&2===Fa.newState){var rb=this.$ul();rb.continueWith(()=>{var $b=rb.result;$b=Date.now()-$b;const ec={};ec.clientId=this.dOl;ec.bootTime=$b;this.I4k=!0;this.q$g.mvb(15,ec)})}};this.Ion=(wb,Fa)=>{if(15===Fa.type){wb=Date.now();Fa=Fa.Yec;var rb=Fa.bootTime;
this.NPi(Fa.clientId).Wfl=wb-rb}};this.esh=()=>{this.Y4a()};this.Csd=new N.a(()=>ca.axa("PresenceBootLatencyThreshold",1E4));this.ajd=new N.a(()=>ca.axa("PresenceBootLatencyCutoffThreshold",6E4));this.knm=new N.a(()=>ca.axa("PresenceLightupLatencyThreshold",2E3));this.Mgm=new N.a(()=>ca.axa("PresenceLightupLatencyCutoffThreshold",1E4));this.Ska=ua;this.Ikm=Va;this.f5k=ac;this.obl=eb;this.B3c=Hb;this.mP=Yb;this.qOh=Ra;this.Dhd=Cb;this.q7k=bb;this.I4k=!1;this.init()}PGm(ac,eb=0){var Hb=new Date;const ua=
new f.a;this.init().continueWith(()=>{this.orn(ac);this.QGm(ua,ac,Hb,eb)})}get dOl(){return this.qOh||"{"+h.AFrameworkApplication.userSessionId+"}"}init(){if(this.IZe)return this.IZe.task;this.IZe=new f.a;this.Dhd()&&b.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.f5k.continueWith(()=>{const ac=this.f5k.result,eb=ac.H9a,Hb=ac.lIe;Hb.continueWith(()=>{eb.continueWith(()=>{this.q7k&&this.q7k.addQosPillar("RealTimeCoauth");this.rSn(eb.result,Hb.result);this.IZe.vj(null)})})});this.obl.continueWith(()=>
{this.q$g=this.obl.result;this.q$g.Otd(this.Krn);this.q$g.Zmc(this.Ion)});this.B3c.continueWith(()=>{this.$ra=this.B3c.result;this.$ra.Rye(this.esh);0<this.$ra.jGd().length&&this.Y4a()});return this.IZe.task}$ul(){this.p7g||(this.p7g=new f.a,this.Ska.$i(4,()=>{this.p7g.uZ(this.mP.Ph("AppInitStatus_interactivityReady"))}));return this.p7g.task}Y4a(){const ac=Date.now();var eb=this.$ra.jGd();const Hb=new H.a;for(const ua of eb)this.I8k.contains(ua.clientId)||(this.I8k.add(ua.clientId),Hb.add(ua.clientId));
if(0<Hb.count)for(const ua of Hb)eb=this.NPi(ua),eb.skl||(eb.rkl=ac)}orn(ac){ac=this.NPi(ac);ac.mjl||(ac.ljl=Date.now())}NPi(ac){return ac in this.XFh?this.XFh[ac]:this.XFh[ac]=new M(ac,this.knm,this.Mgm)}rSn(ac,eb=0){this.gcl=ac;this.hcl=eb?eb:(new Date).getTime()}QGm(ac,eb,Hb,ua){Hb=Hb?Hb.getTime():(new Date).getTime();eb in this.Aal?ac.ija():(ua=new O(eb,this.ATm(),Hb,this.Shh(this.dOl),this.Shh(eb),this.Csd,this.ajd,ua,this.Dhd),this.Aal[eb]=ua,ua.cve(ac))}ATm(){return 1===this.gcl?r.Task.rF(this.hcl):
this.$ul()}Shh(ac){return this.Ikm.Shh(ac)}}Object(x.a)(K,"PresenceBootTelemetry",null,[1346]);var P=a(45),V=a(118),Y=a(27),ta=a(73),fa=a(521),Ta=a(19),ha=a(485);class qa{get name(){return"Common.App.CoauthTelemetry"}lc(ac){ac.register(c,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").ma().na(()=>new c(ha.a.aG(ac.Na("Common.IPeopleInfoProvider")),h.AFrameworkApplication.Oh));ac.register(w,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").ma().na(()=>
new w(h.AFrameworkApplication.vb,ha.a.aG(ac.Na("Common.ICoauthoringTelemeryInfoProvider")),h.AFrameworkApplication.ga,P.a.get_instance(),ta.a.instance,ha.a.aG(ac.Na("Common.IPeoplesWell")),ha.a.aG(ac.Na("Common.IPeopleInfoProvider")),c.Zgl,()=>this.Vhl()));ac.register(K,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").ma().na(()=>new K(ha.a.aG(ac.Na("Common.ICoauthoringTelemeryInfoProvider")),ha.a.aG(ac.Na("Common.IRealtimeChannelBasic")),
ha.a.aG(ac.Na("Common.IPeopleInfoProvider")),P.a.get_instance(),ac.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),ta.a.instance,()=>this.Vhl(),h.AFrameworkApplication.ga,null,m.Health.instance));ac.register(y,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").ma().na(()=>new y(ha.a.aG(ac.Na("Common.IPeopleInfoProvider"))));ac.register(D,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").ma().na(()=>new D(ha.a.aG(ac.Na("Common.IPeopleInfoProvider")),
ha.a.aG(ac.Na("Common.ISystemInitiatedFeedback")),h.AFrameworkApplication.ga,"{"+h.AFrameworkApplication.userSessionId+"}"))}init(){h.AFrameworkApplication.ga.fg(()=>{Ta.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();Ta.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();h.AFrameworkApplication.ga.getBooleanAppSetting("CoauthorGalleryTelemetryIsEnabled")&&Ta.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();h.AFrameworkApplication.ga.getBooleanAppSetting("CashTelemetryIsEnabled")&&
(Ta.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),Ta.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})}dispose(){}Vhl(){return fa.a.ySa&&ta.a.instance.kl(Y.a.Yfd)?0<ta.a.instance.Ph(Y.a.Yfd)[Y.a.wPe]:!1}static main(){V.a.instance.Fc(new qa)}}Object(x.a)(qa,"CoauthTelemetryPackage",null,[3,4]);var ra=a(447),I=a(58);class ba{constructor(ac,eb,Hb,ua,Va){this.$d=ac;this._clientId=eb;this.bhm=Va;this.cim=Hb||(()=>null);this.dim=ua||(()=>null)}get id(){return this.$d.id}get l4c(){return this.$d.l4c}get p4c(){return this.$d.p4c}get o4c(){return this.$d.o4c}get n4c(){return this.$d.n4c}get m4c(){return this.$d.m4c}get Ysd(){return this.$d.Ysd}get uye(){return this.$d.uye}get g7b(){return this.$d.g7b}get ope(){return this.$d.ope}get $9d(){return this.$d.$9d}get clientId(){return this._clientId}get NQb(){return this.cim}get x_a(){return this.dim}get eFm(){return this.bhm}static createInstance(ac,
eb,Hb,ua,Va=!1){return new ba(ac,eb,Hb,ua,Va)}}Object(x.a)(ba,"PeoplesWellSettings",null,[]);var Ga=a(40),Oa=a(248);class Ja{constructor(ac){this.Op=ac}get H9a(){return this.Op.H9a}get lIe(){return this.Op.lIe}}Object(x.a)(Ja,"CoauthoringTelemetryInfoProvider",null,[1E3]);var Qa=a(880),Pa=a(30),ja=a(53),va=a(1174),Ha=a(849),gb=a(275);class Gb{constructor(ac,eb,Hb,ua,Va){this.aIe=new Pa.a;this.H3=null;this.Op=ac;this.Z5d=Hb;this.Oca=ua;this.Oca.eaf(Object(Ga.a)(this,this.Jrh,"onEditorTableUpdate"));
this.Pbn=h.AFrameworkApplication.ga.getBooleanAppSetting(gb.a.ocd);this.JMj=Va;eb&&eb.execute(Yb=>{this.H3=Yb})}dispose(){this.aIe&&(ja.a.hOg([this.aIe]),this.aIe=null);this.Oca.luh(Object(Ga.a)(this,this.Jrh,"onEditorTableUpdate"))}Rye(ac){this.aIe.addHandler("UsersUpdatedEvent",ac)}Cpk(ac){this.aIe.removeHandler("UsersUpdatedEvent",ac)}jGd(){return this.ztl(!1)}LLm(){return this.ztl(!0)}ztl(ac){const eb=[];this.Op.f0c(this.Op.IP).returnValue||Oa.a.J(512497499,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",
this.Op.IP);var Hb=null;this.H3&&(Hb=this.H3.Kgh());const ua=this.JMj.bNi();let Va=!1;for(const Yb of this.Op.a8)ac&&Gb.Mbh(ua,Yb.EmailAddress)?Va=!0:Array.add(eb,this.IBm(Yb,Hb));Hb={};Hb.fExcludeCurrent=ac;Hb.fCurrentExcluded=Va;Hb.CurrentID=this.Op.IP;Hb.EditorCount=this.Op.a8.length;Hb.IsRtcNull=!this.H3;Hb.UserCount=eb.length;Oa.a.J(512497498,814,50,"PeopleInfoProvider::GetAllUsers:{0}",W.c(Hb));return eb}IBm(ac,eb){const Hb=this.Z5d.w_a(new Qa.a(ac.EmailAddress,void 0,ac.Name),ac.ID,1),ua=new va.a;
ua.kXc(0);let Va=0,Yb=!1,Cb=!1;if(eb&&ac.ID in eb){ua.kXc(1);if(this.Pbn){const ca=eb[ac.ID];ca&&ca.capabilities&4&&ua.kXc(4);Yb=!0;ca&&(Va=ca.capabilities,Cb=ca.isAnonymous)}delete eb[ac.ID]}Oa.a.J(512497495,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities: {6}; fIssuserinrtc: {7}; isAnonymous: {8}",ac.ID,Hb,ua.RKa(1),ua.RKa(4),this.Op.IP,
!ac.EmailAddress,Va,Yb,Cb);return new Ha.a(ac.ID,ac.Name,Hb,ua,null,ac.EmailAddress,void 0,void 0,Cb,void 0,void 0,ac.JoinCoauthTime)}Jrh(){Oa.a.J(512497494,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.aIe.raiseEvent("UsersUpdatedEvent",this)}static Mbh(ac,eb){return!!ac&&!!eb&&ac.toLowerCase()===eb.toLowerCase()}}Object(x.a)(Gb,"PeopleInfoProvider",null,[53]);var Mb=a(39),hb=a(387),Da=a(329),Bb=a(481),Za=a(435);class mb extends hb.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=
!1;this.ImageUrl=null;this.CanJump=this.ActiveStatus=!1;this.CoauthorPresenceDescription=this.Upn=null}get ControlType(){return 5}}Object(x.a)(mb,"PeopleButtonProps",hb.a,[]);var vb=a(1177),sb=a(5),bc=a(92);class yb{constructor(ac){this.b5g=new bc.a;this.Ari=null;this.clientId=ac}xNn(ac){this.mFn();this.wLn(ac);for(const eb of ac)eb.clientId!==this.clientId&&this.iel(eb)}get Wzh(){const ac=[];for(const eb of this.b5g.values){const Hb=this.t1l(eb);Array.add(ac,Hb)}return ac}get Gcc(){return this.b5g.count}N_h(ac,
eb){ac=ac.toUpperCase();let Hb;({value:Hb}=this.b5g.Uh(ac)).returnValue||(Hb=[],this.b5g.K(ac,Hb));Array.add(Hb,eb)}mFn(){this.b5g=new bc.a}wLn(ac){for(const eb of ac)if(eb.clientId===this.clientId){this.Ari=eb;break}}}Object(x.a)(yb,"UserTracker",null,[1903]);class uc extends yb{constructor(ac,eb){super(ac);this.eim=eb}iel(ac){ac.isAnonymous||!ac.email?this.N_h(ac.clientId,ac):this.Ari&&A.a.Wn().equals(this.Ari.email,ac.email)||this.N_h(ac.email,ac)}t1l(ac){let eb=new Date(0),Hb=0<ac.length?ac[0]:
null;for(const ua of ac)(ac=this.eim(ua.clientId))&&eb.getTime()<ac.AFe.getTime()&&(eb=ac.AFe,Hb=ua);return Hb}}Object(x.a)(uc,"UniqueUserTracker",yb,[]);class vc extends yb{constructor(ac){super(ac)}iel(ac){this.N_h(ac.clientId,ac)}t1l(ac){return ac[0]}}Object(x.a)(vc,"UserInstanceTracker",yb,[]);const wc=(ac,eb,Hb)=>Hb?new uc(ac,eb):new vc(ac);var ub=a(41),aa=a(796),Na=a(10),ia=a(6);class wa{constructor(ac,eb=null,Hb=null){this.$ra=null;this.kVh=new f.a;this.Jon=(ua,Va,Yb,Cb,ca)=>{this.kVh.uZ(ca.RenderTime);
return 32};this.$d=ac;this.Bsh=eb;Hb&&Hb.continueWith(()=>{this.$ra=Hb.result;this.$ra.Rye(Object(Ga.a)(this,this.Y4a,"onUsersUpdated"));this.Wth()});new Ha.a(this.settings.clientId,"Anonymous user","#cccccc",new va.a(7));this.sjj=this.iMh=!0;this.MJh=this.fQh=!1;this.v8a=wc(this.settings.clientId,this.settings.x_a,ac.eFm)}get settings(){return this.$d}get W3m(){return h.AFrameworkApplication.ga?h.AFrameworkApplication.ga.getBooleanAppSetting("ColorPresenceHashIsEnabled"):!1}get V3m(){return h.AFrameworkApplication.ga?
h.AFrameworkApplication.ga.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled"):!1}iNm(){let ac,eb,Hb,ua;var Va=this.jNm();this.v8a.Gcc?1===this.v8a.Gcc?(ac=!0,eb=this.settings.g7b.cluster,Hb=this.settings.g7b.p6c,ua=this.v8a.Wzh[0].color):(ac=!0,eb=this.settings.$9d.cluster,Hb=this.settings.$9d.p6c,ua=""):(ac=!1,ua=Hb=eb="");const Yb=Va[0];Va=Va.slice(1);return{Ltn:Yb,Mtn:Va,Htn:ac,i5n:eb,Jtn:Hb,Itn:ua}}jNm(){if(2<=this.v8a.Gcc)return[String.format(Object(ia.a)("PeoplesWellStateNumberOfOtherPeopleEditingHere"),
this.v8a.Gcc)];if(1===this.v8a.Gcc){const ac=this.v8a.Wzh[0],eb=this.settings.x_a(ac.clientId);return eb&&2===eb.status?[Object(ia.a)("PeoplesWellStateUserIsInactive"),ac.userName]:[ac.isReadOnly?Object(ia.a)("PeoplesWellStateUserIsAlsoViewing"):Object(ia.a)("PeoplesWellStateUserIsAlsoEditing"),ac.userName]}return[Object(ia.a)("PeoplesWellStateYouAreAllByYourself")]}UUm(ac){return this.VUm(ac)}djl(ac,eb,Hb){return eb?this.wwm(eb)?(ac=this.settings.x_a(ac))&&2===ac.status?!1:!0:(Hb&&b.ULS.sendTraceTag(4482394,
325,50,"User has presence data but app can't use it"),!1):(Hb&&b.ULS.sendTraceTag(4482393,325,50,"User does not have any presence data"),!1)}ETm(ac){return ac.isReadOnly?Object(ia.a)("PeoplesWellUserStatusIsViewingOffline"):Object(ia.a)("PeoplesWellUserStatusLocationUnknown")}VUm(ac){var eb,Hb;if(!ac.capabilities.RKa(1))return this.ETm(ac);const ua=ac.isReadOnly,Va=this.settings.x_a(ac.clientId);ac=this.settings.NQb(ac.clientId);if(!Va)return Object(ia.a)("PeoplesWellUserStatusLocationUnknown");switch(Va.status){case 1:if(!ac)return Object(ia.a)("PeoplesWellUserStatusLocationUnknown");
if(h.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:8350444_RealTimeViewPresenceState")){if(1!==(null===(Hb=null===(eb=null===h.AFrameworkApplication||void 0===h.AFrameworkApplication?void 0:h.AFrameworkApplication.Ea)||void 0===eb?void 0:eb.Kb)||void 0===Hb?void 0:Hb.Im)&&ua)return Object(ia.a)("PeoplesWellUserStatusIsViewingOnline")}else if(ua)return Object(ia.a)("PeoplesWellUserStatusIsViewingOnline");return this.Wzm(ac)||Object(ia.a)("PeoplesWellUserStatusLocationUnknown");case 2:return Object(ia.a)("PeoplesWellUserStatusIsInactive");
default:return Object(ia.a)("PeoplesWellUserStatusLocationUnknown")}}APm(ac){if(this.Bsh.QUd)return this.Bsh.LMb(ac.email,"O365",h.AFrameworkApplication.ui,0)}PUm(ac){ac=this.settings.x_a(ac.clientId);return!ac||ac&&1===ac.status?!0:!1}QUm(ac){var eb=String.format("buttonPeoplesWellUser-{0}",ac.clientId),Hb=ac.clientId,ua=this.UUm(ac);const Va=ac.userName,Yb=ac.color;var Cb=Object,ca=Cb.assign,Ra=new mb,bb=this.settings.Ysd.toString(),wb=this.settings.ope.cluster,Fa=this.settings.ope.p6c,rb=this.wul(),
$b=ac.isAnonymous,ec;if(ec=[Va],ec.length){var pc=new Sys.StringBuilder("STRARRY@");for(const dd of ec)pc.append(dd?dd.length:0),pc.append(","),pc.append(dd),pc.append(",");ec=pc.toString().slice(0,-1)}else ec=null;eb=ca.call(Cb,Ra,{Id:eb,Command:bb,LabelText:"{0}",Image32by32:wb,Image32by32Class:Fa,MenuItemId:Hb,CommandValueId:Hb,Alt:Va,DisplayMode:rb,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:ua,ImageBackColor:Yb,IsAnonymous:$b,LabelTextUserGeneratedPlaceholderReplacements:ec,
Upn:ac.email});h.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseCustomStylesForCoauthorDescription",!1)&&(Hb=this.OMm(ac),eb.CoauthorPresenceDescription=Hb);h.AFrameworkApplication.ga.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")&&this.Bsh&&(Hb=this.APm(ac),ua=this.PUm(ac),eb.ImageUrl=Hb,eb.ActiveStatus=ua,eb.JoinTimeInMS=ac.aUb,ac=this.djl(ac.clientId,this.settings.NQb(ac.clientId),!1),eb.CanJump=ac,""===Hb&&b.ULS.sendTraceTag(40969413,302,50,"ImageURL collection failed"));
return eb}mPm(){return Object.assign(new hb.a,{Id:"BasicChat",Command:"2288458806",LabelText:Object(ia.a)("StartGroupChat"),LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}wul(){return this.W3m?"Initials":"Menu32"}RUm(ac){const eb=[];for(const Hb of ac)ac=this.QUm(Hb),Array.add(eb,ac);return eb}pkh(){return 0<this.v8a.Gcc}$Bn(ac){if(!this.iMh)return!0;this.sjj||(ac[aa.a.Visible]=!0);const {Ltn:eb,Mtn:Hb,Htn:ua,Jtn:Va,Itn:Yb}=this.iNm();ac[aa.a.LabelText]=
eb;Hb&&Hb.length&&(ac[aa.a.LabelTextUserGeneratedPlaceholderReplacements]=Hb);ac[aa.a.ImageIsVisible]=ua;ac[aa.a.Image16by16Class]=Va;ac[aa.a.ImageBackColor]=Yb;this.iMh=!1;return!0}qwn(ac){if(0>=this.v8a.Gcc)return!1;var eb=this.DRn(this.v8a.Wzh),Hb=this.RUm(eb);eb=Object.assign(new Bb.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});Hb=Object.assign(new Za.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.wul(),ControlList:Hb});h.AFrameworkApplication.ga.getBooleanAppSetting("WordEditorDisplayPeoplesWellLabelIsEnabled")&&
this.Bsh&&(Hb.Title=Object(ia.a)("PeoplesWellFlyoutLabel"),Hb.TitleId="menuCoauthorsTitle",Hb.Theme="Light");Array.add(eb.MenuSectionList,Hb);h.AFrameworkApplication.ga.getBooleanAppSetting("DocChatIsEnabled")&&h.AFrameworkApplication.ga.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")&&h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.JD&&(Hb=[],Array.add(Hb,this.mPm()),Hb=Object.assign(new Za.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",ControlList:Hb}),Array.add(eb.MenuSectionList,
Hb));h.AFrameworkApplication.Ea&&h.AFrameworkApplication.Ea.Kb.JD?ac.MenuItems=eb:ac.PopulationXML=Da.l(eb);return!0}rZn(ac){b.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");ac=ac.MenuItemId;if(!ac)return!1;const eb=this.settings.NQb(ac);if(!this.djl(ac,eb,!0))return!1;this.M7m(ac,eb);return!0}ODn(){const ac=this.OLm();this.v8a.xNn(ac);this.sjj&&1<=this.v8a.Gcc&&(b.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.sjj=!1);this.iMh=!0}Y4a(){this.MJh||
(window.setTimeout(()=>{this.Wth();this.MJh=!1},3E3),this.MJh=!0)}OLm(){let ac;ac=this.MLm()||[];for(const eb of ac)this.TIn(eb);return ac}TIn(ac){ac.clientId||(ac.clientId=v.a.create().toString());ac.userName||(ac.userName="Anonymous user");ac.capabilities||(ac.capabilities=new va.a);ac.color||(ac.color="#cccccc");ac.aUb||(ac.aUb=0)}DRn(ac){const eb=[];Array.addRange(eb,ac);eb.sort(wa.Atn);return eb}LEn(){h.AFrameworkApplication.ga.getBooleanAppSetting("CoauthorGalleryTelemetryIsEnabled")&&!this.fQh&&
(h.AFrameworkApplication.vb.g3(Na.a.tkl)&&vb.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||h.AFrameworkApplication.vb.sa(Na.a.tkl,ub.a.frame,this.Jon,96));this.MEn();this.fQh=!0;this.Wth()}get Eyh(){return this.kVh.task}Wth(){if(!this.fQh&&(this.kVh.uZ((new Date).getTime()),b.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),this.V3m))return;this.ODn();this.PDn()}dispose(){this.$ra&&
(this.$ra.Cpk(Object(Ga.a)(this,this.Y4a,"onUsersUpdated")),this.$ra=null)}static Atn(ac,eb){return h.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:8425872_SortUsersByEditorsViewersInactive")?ac.capabilities.RKa(1)&&!eb.capabilities.RKa(1)?-1:!ac.capabilities.RKa(1)&&eb.capabilities.RKa(1)?1:!ac.isReadOnly&&eb.isReadOnly?-1:ac.isReadOnly&&!eb.isReadOnly?1:sb.a.localeCompare(ac.userName,eb.userName):ac.capabilities.RKa(1)&&eb.capabilities.RKa(1)||!ac.capabilities.RKa(1)&&!eb.capabilities.RKa(1)?
sb.a.localeCompare(ac.userName,eb.userName):ac.capabilities.RKa(1)?-1:1}OMm(ac){var eb,Hb;null===(eb=this.settings)||void 0===eb||eb.NQb(ac.clientId);null===(Hb=this.settings)||void 0===Hb||Hb.x_a(ac.clientId)}}Object(x.a)(wa,"APeoplesWell",null,[1888,24]);var pa=a(257);class Ea extends wa{constructor(ac,eb,Hb=null,ua=null){super(ac,Hb,ua);this.Ygc=()=>!0;this.ya=eb}bCn(ac){return this.$Bn(ac)}swn(ac){return this.qwn(ac)}tZn(ac){return this.rZn(ac)}Qja(ac,eb,Hb,ua,Va,Yb){ac=!1;switch(Hb){case 1:ac=
Va(ua);break;case 2:ac=Yb(ua)}return Ea.Vtm(ac)}d4m(ac,eb,Hb,ua,Va){return this.Qja(ac,eb,Hb,Va,()=>this.pkh(),this.Ygc)}aCn(ac,eb,Hb,ua,Va){return this.Qja(ac,eb,Hb,Va,Object(Ga.a)(this,this.bCn,"queryUsersProxy"),this.Ygc)}rwn(ac,eb,Hb,ua,Va){return this.Qja(ac,eb,Hb,Va,this.Ygc,Object(Ga.a)(this,this.swn,"populateFlyoutContentsProxy"))}xym(ac,eb,Hb,ua,Va){return this.Qja(ac,eb,Hb,Va,this.Ygc,this.Ygc)}wym(ac,eb,Hb,ua,Va){return this.Qja(ac,eb,Hb,Va,this.Ygc,this.Ygc)}sZn(ac,eb,Hb,ua,Va){return this.Qja(ac,
eb,Hb,Va,this.Ygc,Object(Ga.a)(this,this.tZn,"userButtonClickProxy"))}Uun(ac,eb,Hb,ua,Va){return this.Qja(ac,eb,Hb,Va,this.Ygc,()=>{this.Wth();return!0})}MEn(){this.ya.za(this.settings.l4c,pa.a.application,Object(Ga.a)(this,this.d4m,"isControlEnabledHandler"));this.ya.sa(this.settings.p4c,pa.a.application,Object(Ga.a)(this,this.aCn,"queryUsersHandler"),96);this.ya.sa(this.settings.n4c,pa.a.application,Object(Ga.a)(this,this.xym,"commandMenuOpenHandler"),96);this.ya.sa(this.settings.m4c,pa.a.application,
Object(Ga.a)(this,this.wym,"commandMenuCloseHandler"),96);this.ya.sa(this.settings.o4c,pa.a.application,Object(Ga.a)(this,this.rwn,"populateFlyoutContentsHandler"),96);this.ya.za(this.settings.Ysd,pa.a.application,Object(Ga.a)(this,this.sZn,"userButtonClickHandler"));this.ya.sa(this.settings.uye,pa.a.application,Object(Ga.a)(this,this.Uun,"peoplesWellRefreshControlHandler"),96)}dispose(){super.dispose()}static Vtm(ac){return ac?32:8}}Object(x.a)(Ea,"ABox4PeoplesWell",wa,[]);var La=a(1495);class Aa extends Sys.EventArgs{constructor(ac){super();
this.controlId=ac}}Object(x.a)(Aa,"RibbonControlStatusChangedEventArgs",Sys.EventArgs,[]);var nb=a(250);class Wa extends Ea{constructor(ac,eb,Hb,ua,Va,Yb,Cb,ca,Ra,bb,wb,Fa,rb,$b,ec,pc,dd,Ad,Jb){super(ac,eb,pc,Ad?r.Task.rF(Ad):null);this.H3=null;this.WFj=!1;if(!Va)throw Error.argumentNull("coauthStateGetter");if(!Yb)throw Error.argumentNull("appFrame");if(!Cb)throw Error.argumentNull("taskManager");this.Op=Va;this.Db=Yb;this.Tb=Cb;ua&&ua.execute(Bc=>{this.H3=Bc});Hb&&Hb.execute(Bc=>{Bc.Cqm(Object(Ga.a)(this,
this.vAn,"presenceChanged"))});this.oc=ca;this.Jf=Ra;this.Ge=bb;this.p2d=rb;this.abn=wb;this.Z5d=Fa;this.wGe=$b;this.YTa=ec;this.JMj=dd;this.UKl=Ad;this.Raa=Jb;this.Eyh.continueWith(()=>{this.YTa.cql(this.Eyh.result)})}M7m(ac,eb){let Hb=null;({data:Hb}=this.dUk(eb)).returnValue&&Hb&&Hb.$v&&(Oa.a.J(512497493,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",ac,Hb.$v,this.Op.IP),(ac=this.oc.s$a(Hb.$v))?nb.a("CollabGoToLocationFix")?this.Raa.value.x8(ac.ph):
this.Jf.x8(ac.ph):Oa.a.J(512497492,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",Hb.$v))}dUk(ac){let eb;eb=null;if(!ac)throw Oa.a.J(512497491,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",this.Op.IP),Error.argumentNull("presence");return ac?(eb=La.a.Rdh(ac.data))?{returnValue:!0,data:eb}:{returnValue:!1,data:eb}:{returnValue:!1,data:eb}}wwm(ac){let eb=null;return({data:eb}=this.dUk(ac)).returnValue&&eb&&eb.$v?!0:!1}MLm(){if(this.UKl)return this.UKl.LLm();
Oa.a.J(512497490,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null.");const ac=this.NLm();0<ac.length&&Oa.a.J(512497489,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",ac.length);return ac}NLm(){const ac=[],eb=this.JMj.bNi();this.Op.f0c(this.Op.IP).returnValue||Oa.a.J(512497488,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",this.Op.IP);let Hb=null;this.H3&&(Hb=this.H3.Kgh());var ua=h.AFrameworkApplication.ga.getBooleanAppSetting(gb.a.ocd);
for(var Va of this.Op.a8){var Yb=this.Z5d.w_a(new Qa.a(Va.EmailAddress,void 0,Va.Name),Va.ID,1),Cb=new va.a;Cb.kXc(0);let ca=0,Ra=!1;if(Wa.k7m(Va.ID,Hb)){Cb.kXc(1);if(ua){const bb=Hb[Va.ID];bb&&(ca=bb.capabilities);Ra=!0;bb&&bb.capabilities&4&&Cb.kXc(4)}delete Hb[Va.ID]}Wa.Mbh(eb,Va.EmailAddress)||(Array.add(ac,new Ha.a(Va.ID,Va.Name,Yb,Cb,null,Va.EmailAddress)),Oa.a.J(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",
Va.ID,Yb,Cb.RKa(1),Cb.RKa(4),this.Op.IP,!Va.EmailAddress,ca,Ra))}if(!ua&&this.p2d&&Hb)for(const ca in Hb)ua=Hb[ca],!Wa.Mbh(eb,ua.email)&&ua&&ua.userName&&(Va=new va.a,Va.kXc(1),ua.capabilities&4&&Va.kXc(4),Yb=this.wGe.jhh(ua.email)||ua.email,Cb=this.Z5d.w_a(new Qa.a(Yb,void 0,ua.userName),ua.clientId,1),Array.add(ac,new Ha.a(ua.clientId,ua.userName,Cb,Va,null,Yb)),Oa.a.J(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
ua.clientId,Cb,Va.RKa(1),Va.RKa(4),this.H3.clientId,!ua.email,ua.capabilities));return ac}Wzm(ac){let eb=null,Hb=" ";({data:eb}=this.dUk(ac)).returnValue&&eb&&eb.$v&&(ac=this.oc.s$a(eb.$v))&&(Hb=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,ac.ph+1));return Hb}vAn(){this.Db.av.CLa?this.WFj||(this.Tb.Qb(new Mb.a(2,1,0,Object(Ga.a)(this,this.handlePendingRefresh,"handlePendingRefresh"),90,"70")),this.WFj=!0):this.ya.Cb(Na.a.Dzb,2)}PDn(){this.Ge.RWl(new Aa(this.settings.id,!0));
const ac=1<this.v8a.Gcc||1===this.v8a.Gcc&&this.v8a.Wzh[0].clientId!==this.settings.clientId;this.abn.execute(eb=>{ac&&this.YTa&&this.YTa.IFl();eb.M8b()});ac&&this.YTa.Vh(14,Date.now())}handlePendingRefresh(){this.WFj=!1;this.ya.Cb(Na.a.Dzb,2)}dispose(){super.dispose()}static k7m(ac,eb){return eb&&ac in eb?!0:!1}static Mbh(ac,eb){return!!ac&&!!eb&&ac.toLowerCase()===eb.toLowerCase()}}Object(x.a)(Wa,"PowerPointPeoplesWell",Ea,[]);class ea{constructor(ac){this.Ilg=null;ac.execute(eb=>{this.Ilg=eb})}NQb(ac){return this.Ilg?
this.Ilg.NQb(ac):null}x_a(ac){return this.Ilg?this.Ilg.x_a(ac):null}}Object(x.a)(ea,"PresenceUserInfoGetterProxy",null,[1303]);var Kb=a(284);class kc{constructor(){this.Jab=this.Oca=this.Sm=this.$=null}get name(){return"PowerPointWebEditor.PeoplesWell"}lc(ac){kc.m1f=Date.now();this.$=ac;this.Jab=this.$.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.Sm=this.Jab.oAb(6,this.name);this.$.register(1303,"PowerPointWebEditor.IPresenceUserInfoGetter").ma().na(()=>new ea(this.$.Na("PowerPointWebEditor.IDelayedPresenceUserInfoGetter")));
this.$.register(1E3,"Common.ICoauthoringTelemeryInfoProvider").ma().na(()=>new Ja(this.$.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.$.register(Gb,"PowerpointPresence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").ma().na(()=>new Gb(this.$.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.$.Na("Common.IRealtimeChannelBasic"),this.$.resolve("PowerpointPresence.IPresenceColorProvider"),this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.$.resolve("PowerpointPresence.IPresencePrepCacheParser")));
if(nb.a("PeoplesBaseUlrConfiguredForPods")&&(ac=this.$.resolve("Common.App.People.IExternalPeopleAPI"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").Rh)){const eb=this.$.resolve("Common.IAppSettingsManager").La(Kb.a.B8);ac.V3j(eb+"p")}Oa.a.J(509669911,814,50,"PPTWebEditorPeoplesWellPackage:Configure")}init(){this.$.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").tca("pptedit.presence1",null,null,()=>a.e(18).then(a.bind(null,1682)));this.$.resolve("Common.ICoauthoringTelemeryInfoProvider");
this.$.resolve("Common.IPeopleInfoProvider");h.AFrameworkApplication.NZ.g$a?(this.Oca=this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),I.a.Lbd("ribbon","coauthorGallery"),this.Oca.Mah(Object(Ga.a)(this,this.VAl,"initializePeoplesWellHandler"))):this.UAl()}VAl(){try{h.AFrameworkApplication.NZ.g$a||(this.UAl(),this.Oca.kuh(Object(Ga.a)(this,this.VAl,"initializePeoplesWellHandler")))}catch(ac){Oa.a.J(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",
ac)}}UAl(){const ac=this.Sm.qI("peoplewell");this.k2m(this.$.resolve("PowerPointWebEditor.IPresenceUserInfoGetter"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.AppFrame"),this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerpointPresence.RtcParams").clientId);this.Sm.uI(ac)}k2m(ac,eb,Hb,ua,Va,Yb){var Cb=this.$.resolve("PowerpointPresence.IPresencePerfLogger");Cb.Vh(10,kc.m1f);Cb.Vh(9,kc.rmg);Cb.Vh(11,
(new Date).getTime());Cb=Date.now();const ca=ra.a.Mhh(h.AFrameworkApplication.jp,"per_SingleCollabUserGlyph_16x16x32",h.AFrameworkApplication.jp,"per_SingleCollabUserGlyph_32x32x32",h.AFrameworkApplication.jp,"per_MoreUsersGlyph_16x16x32");ac=ba.createInstance(ca,Yb,Object(Ga.a)(ac,ac.NQb,"getUserPresence"),Object(Ga.a)(ac,ac.x_a,"getUserStatusInfo"),!0);(Yb=this.$.resolve("PowerpointPresence.PeopleInfoProvider"))||Oa.a.J(509669910,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider");
Oa.a.J(509669909,814,50,"InitializePeoplesWellInternal; creating peopleswell");const Ra=new Wa(ac,eb,this.$.Na("PowerpointPresence.IPresenceManager"),this.$.Na("Common.IRealtimeChannelBasic"),this.$.resolve("PowerPointWebEditor.ICoauthStateGetter"),Hb,ua,this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.$.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.$.Na("Box4.IBox4BridgeCommandUi"),this.$.resolve("PowerpointPresence.IPresenceColorProvider"),
Va.n5a,this.$.resolve("PowerpointPresence.IPresenceEmailConverter"),this.$.resolve("PowerpointPresence.IPresencePerfLogger"),this.$.resolve("Common.App.People.IPeopleManager"),this.$.resolve("PowerpointPresence.IPresencePrepCacheParser"),Yb,this.$.ge("PowerPointWebEditor.ISorterViewActorLazy"));Ra.LEn();this.$.register(Wa,"PowerpointPresence.PowerPointPeoplesWell").as("Common.IPeoplesWell").ma().na(()=>Ra);this.$.resolve("Common.IPeoplesWell");this.$.Na("Box4.IBox4BridgeCommandUi").execute(bb=>{bb.M8b()});
Oa.a.J(8958615,814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",Date.now()-Cb);this.$.resolve("PowerpointPresence.IPresencePerfLogger").gql()}dispose(){}static main(){kc.rmg=Date.now();if(h.AFrameworkApplication.ga&&h.AFrameworkApplication.ga.getBooleanAppSetting("IsSyncConfigPresenceEnabled")){const ac=new kc;ac.lc(Ta.a.instance);ac.init()}else V.a.instance.Fc(new kc)}}kc.rmg=0;kc.m1f=0;Object(x.a)(kc,"PPTWebEditorPeoplesWellPackage",null,[3,4]);
Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PeoplesWell");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("RealtimePresenceUI");window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");qa.main();Type.registerNamespace("RealtimePresenceUI");kc.main()},428:function(x,G,a){a.r(G);a.d(G,"CuiHelperStatic",function(){return b});x=a(0);var c=a(329);class b{static addButton(f,e,h,u,m,n,l,r){e=c.a(f,e,h,u,null,
null,null,n,null,null,void 0,void 0,m);(f=r.hostControl(f,e,n))&&l.appendChild(f);return f}}b.Dta="btnReplyWithChanges";Object(x.a)(b,"CuiHelperStatic",null,[])},447:function(x,G,a){a.d(G,"a",function(){return W});x=a(0);var c=a(17),b=a(528);a(649);var f=a(4),e=a(22),h=a(19),u=a(10),m=a(6);class n{}Object(x.a)(n,"RibbonUpsellButtonCreator",null,[]);class l extends Sys.EventArgs{constructor(L){super();this.l6g=L}}Object(x.a)(l,"TopRowCreatedEventArgs",Sys.EventArgs,[]);var r=a(576),w=a(483);a(47);
var y=a(329);a(37);a(135);var z=a(391),A=a(79),B=a(3);class H{constructor(L,O){this.cluster=L;this.p6c=O}}Object(x.a)(H,"ImageInfo",null,[]);class v{constructor(L,O,M,K,P,V,Y,ta,fa,Ta,ha,qa,ra,I,ba=null,Ga=null){this.id=L;this.l4c=O;this.p4c=M;this.o4c=K;this.n4c=P;this.m4c=V;this.Ysd=Y;this.uye=ta;this.g7b=new H(fa,Ta);this.ope=new H(ha,qa);this.$9d=new H(ra,I);ba&&Ga&&new H(ba,Ga)}}Object(x.a)(v,"PeoplesWellBaseSettings",null,[]);class C{constructor(){this.FKb=null}}Object(x.a)(C,"BreadcrumbControls",
null,[]);class F{constructor(L){this.id=L}}new F("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32");Object(x.a)(F,"ChatButtonSettings",null,[]);class D{constructor(){this.id=this.image=this.label=this.command=null}}Object(x.a)(D,"SkypeButtonInfo",null,[]);class N{constructor(){this.u8a=this.l8b=this.aYa=null}}Object(x.a)(N,"TopRowControls",null,[]);var U=a(94);a(5);class W{constructor(L,O,M=null,K=null,P=null){var V;this.i9=L;this.gWa=U.a.Xqh(O,P);(null===
(V=f.AFrameworkApplication.ga)||void 0===V?0:V.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableNewCommonStringLoad",!1))?(this.gWa.push(CommonUiStrings),"undefined"!==typeof CommonUIStrings&&this.gWa.push(CommonUIStrings)):this.gWa.push(CommonUIStrings);b.b();W.ya=void 0===M||null===M?f.AFrameworkApplication.vb:M;void 0!==K&&null!==K||this.iwd()}iwd(){Object(m.a)("SignoutLink");Object(m.a)("SignIn")}static get yMd(){return W.tja||(W.tja=h.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static Mhh(L,
O,M,K,P,V){return new v(W.iCb,u.a.edh,u.a.Q5c,u.a.hdh,u.a.gdh,u.a.fdh,u.a.idh,u.a.Dzb,L,O,M,K,P,V,null,null)}static xrf(L){L.aYa&&(W.jCd(L.aYa),L.aYa=null);L.l8b&&(W.iCd(),L.l8b=null);L.u8a&&(W.kCd(L.u8a),L.u8a=null);W.yMd.yHg();let O;({C$a:O}=w.a.jcb(!1)).returnValue&&e.a.LDa(O)}static ORb(){f.AFrameworkApplication.vb.Cb(u.a.ORb,2)}static iCd(){f.AFrameworkApplication.bac&&A.EventHandlerManager.instance.H0c(f.AFrameworkApplication.bac)}static addButton(L,O,M,K,P,V,Y,ta){O=y.a(L,O,M,K,null,null,null,
V,null,null,void 0,void 0,P);(L=ta.hostControl(L,O,V))&&Y.appendChild(L);return L}static yMb(L,O,M,K,P){let V;K?(V=document.createElement("a"),V.href=K,V.target="_top",z.a.instance.xbb(B.a.click,V,W.tae,null,!0)):P?(V=document.createElement("div"),V.tabIndex=0):V=document.createElement("span");V.className="BreadcrumbItem"+(P?" Selectable":"");V.id=O;V.innerText=M;V.setAttribute("dir","auto");L.appendChild(V);return V}static jCd(L){L.FKb&&A.EventHandlerManager.instance.vzh(L.FKb)}static tae(L){const O=
r.a.instance.Ao(u.a.ech);O.properties.add("id",L.Oj.id);O.end();c.ULS.sendTraceTag(595732178,207,50,"Breadcrumb link clicked: {0}",{["id"]:L.Oj.id});return W.qEb?W.qEb(L):!1}static kCd(L){z.a.instance.Fte(B.a.click,L,W.Xbe,!0)}static Xbe(){f.AFrameworkApplication.w1c?(f.AFrameworkApplication.Ea.ywb(f.AFrameworkApplication.Ea.Kb.RCe()),f.AFrameworkApplication.w1c=!1):window.top.location=f.AFrameworkApplication.signInUrl;return!0}static bBb(){return!!f.AFrameworkApplication.Ea&&f.AFrameworkApplication.Ea.Kb.bBb}}
W.tja=null;W.VSg="ShareServerWhite_20x20x32";W.nac="ExternalHeaderFullTopBars";W.uDe="HeaderTopBars";W.w$b="BreadcrumbBrand";W.x$b="BreadcrumbFolder";W.y$b="BreadcrumbTitle";W.s7c="FolderSeparator";W.hOe="sbTellMe";W.vNe="TellMe-SearchBox";W.icd="btnOpenInClient";W.yec="btnFileSharing";W.yVg="BasicChat";W.Dta="btnReplyWithChanges";W.g7c="jbtnGiveFeedback";W.iCb="PeoplesWellControl";W.Usf="EditableBreadcrumbItem";W.ya=null;W.qEb=null;W.G0c=50;W.cMf=null;Object(x.a)(W,"CuiHelper",null,[67])},489:function(x,
G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b[b.unknown=0]="unknown";b[b.excel=1]="excel";b[b.powerPoint=2]="powerPoint";b[b.word=3]="word";b[b.oneNote=4]="oneNote";b[b.Z5g=5]="visio"})(c||(c={}));Object(x.b)("OfficeAppType",c)},515:function(x,G,a){a.d(G,"a",function(){return f});a.d(G,"b",function(){return e});a.d(G,"c",function(){return h});var c=a(4),b=a(489);const f=()=>{const u=c.AFrameworkApplication.Ea.Kb.Im;return(3===u||1===u||2===u||4===u)&&c.AFrameworkApplication.ga.getBooleanAppSetting("PremiumUpsellIsEnabled")},
e=(u,m,n,l=!1)=>{m=1===m;1===u&&(m=2===c.AFrameworkApplication.Ea.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",b.a[u],m?"Editor":"Viewer",l?"Dime":"Unknown",n?n:"dimedefault")},h=u=>{switch(u){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},528:function(x,G,a){a.d(G,"b",function(){return m});a.d(G,"h",function(){return n});a.d(G,"d",function(){return l});a.d(G,"g",function(){return r});
a.d(G,"f",function(){return y});a.d(G,"e",function(){return z});a.d(G,"c",function(){return A});a.d(G,"a",function(){return B});var c=a(4);a(123);var b=a(638),f=a(515);a(58);var e=a(7),h=a(6),u;const m=()=>c.AFrameworkApplication.h8,n=()=>{const H=c.AFrameworkApplication.Ea.Kb.eO;return!m()&&!c.AFrameworkApplication.hideHeader&&f.a()&&(H||1===c.AFrameworkApplication.Zyf)},l=()=>c.AFrameworkApplication.ga.getBooleanAppSetting("DiscoverPremiumButtonEnabled"),r=()=>c.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AnonymousSignInButtonExperiment",
!1)&&c.AFrameworkApplication.ga.getBooleanAppSetting("IsAnonymousUser"),w=()=>c.AFrameworkApplication.hNe&&!m()&&!c.AFrameworkApplication.hideHeader,y=()=>w()&&"officecomhwa"!==(c.AFrameworkApplication.ga.La(c.AFrameworkApplication.QI)||"").toLowerCase()&&!c.AFrameworkApplication.wDe&&!e.a.qTf,z=()=>!c.AFrameworkApplication.V8c&&w(),A=()=>!m()&&!c.AFrameworkApplication.hideHeader&&c.AFrameworkApplication.ga.getBooleanAppSetting("BasicChatIsEnabled"),B=()=>{if(c.AFrameworkApplication.BDe)return null;
var H=!!c.AFrameworkApplication.Ea&&c.AFrameworkApplication.Ea.Kb.eO;if((c.AFrameworkApplication.K9c&&c.AFrameworkApplication.gFa||c.AFrameworkApplication.NDb)&&H)return Object.assign(new b.a,{command:"1197060601",label:Object(h.a)("ReplyWithChanges"),id:a(428).CuiHelperStatic.Dta});if(c.AFrameworkApplication.ifc){H="";switch(c.AFrameworkApplication.l9b){case "Assign":H=Object(h.a)("Assign");break;case "Submit":H=Object(h.a)("Submit")}if(""!==H)return Object.assign(new b.a,{command:"2988588587",label:H,
id:"btnWorkflow"})}return null};null===(u=c.AFrameworkApplication.ga)||void 0===u||u.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HeaderPlaceholderAddNewUx",!1)},638:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(x.a)(c,"HeaderButtonInfo",null,[])},649:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}Object(x.a)(c,"RibbonPeripheralSection",null,[])},796:function(x,G,a){a.d(G,"a",
function(){return c});x=a(0);a=a(429);class c{}c.LabelText=a.a.labelText;c.LabelTextUserGeneratedPlaceholderReplacements=a.a.Flh;c.Visible=a.a.visible;c.ImageIsVisible="ImageIsVisible";c.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible";c.Image16by16Class=a.a.DAb;c.Image32by32Class=a.a.Jxa;c.Image48by48Class=a.a.jzc;c.ImageBackColor="ImageBackColor";c.On="On";c.SourceControlId="SourceControlId";Object(x.a)(c,"FlyoutAnchorCommandProperties",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.presence.js.map