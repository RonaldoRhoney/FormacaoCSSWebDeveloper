'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[18],{1130:function(x,G,a){function c(){var f,e;return(null!==(e=null===(f=b.AFrameworkApplication.ga)||void 0===f?void 0:f.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseSessionExpirationManagerWithRefreshV2",!1))&&void 0!==e?e:!1)&&b.AFrameworkApplication.DE&&2==b.AFrameworkApplication.i1k}a.d(G,"a",function(){return c});var b=a(4)},1131:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}
c.wNl=31E3;c.lTj=8E3;Object(x.a)(c,"RealtimeChannelStaticConstants",null,[])},1359:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.ncl=!1;this.uQh=null;this.u5k=0;this.MIh=this.dnl();this.I7g=this.dnl();this.Eid=this.Lwe=0;this.getCurrentTime=()=>new Date}get bTn(){return this.ncl}dnl(){const b=Array(6);for(let f=0;f<b.length;f++)b[f]=0;return b}$Om(){return this.MIh.toString()}aNm(){return this.I7g.toString()}jSn(){this.uQh=this.getCurrentTime()}BIg(b,f,e=!1){this.bTn||
(e&&(this.ncl=!0),e=this.getCurrentTime(),0===b&&5<this.Lwe||1===b&&5<this.Eid||(this.u5k<b?(1===this.Lwe%2&&(this.MIh[this.Lwe]=-1,this.Lwe++),this.u5k=b,1===f&&(this.I7g[this.Eid]=-1,this.Eid++),this.I7g[this.Eid]=this.LMk(e),this.Eid++):0===b?(this.MIh[this.Lwe]=this.LMk(e),this.Lwe++):(this.I7g[this.Eid]=this.LMk(e),this.Eid++)))}LMk(b){const f=b.getTime()-this.uQh.getTime();this.uQh=b;return f}static get instance(){c.Wa||(c.Wa=new c);return c.Wa}static set instance(b){c.Wa=b}}c.Wa=null;Object(x.a)(c,
"LatencyMetrics",null,[])},1360:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b,f,e,h){this.ogn=b;this.z_c=f;this.bgn=e;this.xVm=h}}Object(x.a)(c,"ThrottlerManagerSettings",null,[])},1393:function(x,G,a){a.d(G,"a",function(){return C});x=a(0);class c extends Sys.EventArgs{constructor(F,D){super();this.newState=F;this.oldState=D}}Object(x.a)(c,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);class b extends Sys.EventArgs{constructor(F,D){super();this.Wxm=F;this.ixb=
D}}Object(x.a)(b,"ClientInfoEventArgs",Sys.EventArgs,[]);class f extends Sys.EventArgs{constructor(F){super();this.presence=F}}Object(x.a)(f,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(F){super();this.kgi=F}}Object(x.a)(e,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);class h extends Sys.EventArgs{constructor(F,D){super();this.type=F;this.hPe=D}}Object(x.a)(h,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var u=a(1627);class m extends Sys.EventArgs{constructor(F,
D=null){super();this.xL=F;this.Ymm=D}get type(){return this.xL}get Yec(){return this.Ymm}}Object(x.a)(m,"UpdateNotificationEventArgs",Sys.EventArgs,[]);class n extends Sys.EventArgs{constructor(F){super();this.yAn=F}}Object(x.a)(n,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);class l extends Sys.EventArgs{constructor(F,D,N,U,W,L){super();this.uPe=F;this.Zji=D;this.ezm=N;this.Kql=W;this.Efi=U;this.kD=L}}Object(x.a)(l,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class r extends Sys.EventArgs{constructor(F){super();
this.hubConnection=F}}Object(x.a)(r,"RefreshProxyEventArgs",Sys.EventArgs,[]);class w extends Sys.EventArgs{constructor(F,D){super();this.uIm=F;this.errorMessage=D}}Object(x.a)(w,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class y extends Sys.EventArgs{constructor(F,D,N){super();this.type=F;this.presence=D;this.ixb=N}}Object(x.a)(y,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var z=a(1520);class A extends Sys.EventArgs{constructor(){super()}}Object(x.a)(A,"SessionPropertiesChangedEventArgs",
Sys.EventArgs,[]);class B extends Sys.EventArgs{constructor(F){super();this.kgi=F}}Object(x.a)(B,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class H extends Sys.EventArgs{constructor(F,D){super();this.type=F;this.MYn=D}}Object(x.a)(H,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var v=a(30);class C{constructor(){this.kb=new v.a}fCn(F,D){this.kb.raiseEvent("CSC",new c(F,D))}rCn(F){this.kb.raiseEvent("RP",new r(F))}Fth(F){this.kb.raiseEvent("RC",F)}tCn(){this.kb.raiseEvent("RMID")}qCn(F,
D,N,U,W,L){this.kb.raiseEvent("RPS",new l(F,D,N,U,W,L))}XWl(F,D){this.kb.raiseEvent("UPSR",new H(F,D))}MWl(F,D){this.kb.raiseEvent("PU",new u.a(F,D))}lCn(F){this.kb.raiseEvent("MPU",new f(F))}Ygk(F,D,N,U){this.kb.raiseEvent("SUN",new z.a(F,D,N,U))}FCn(F,D){this.kb.raiseEvent("UNR",new m(F,D))}UWl(F,D,N){this.kb.raiseEvent("SP",new y(F,D,N))}LWl(F,D){this.kb.raiseEvent("PSU",new h(F,D))}pCn(F){this.kb.raiseEvent("PSC",new e(F))}jCn(F){this.kb.raiseEvent("IPSC",new e(F))}GCn(F){this.kb.raiseEvent("UPSC",
new B(F))}uCn(F,D){this.kb.raiseEvent("SPC",new A(F,D))}SWl(F,D){this.kb.raiseEvent("RCF",new w(F,D))}iCn(F){this.kb.raiseEvent("CPSWM",new n(F))}ECn(F,D){this.kb.raiseEvent("UCI",new b(F,D))}Otd(F){this.kb.addHandler("CSC",F)}hok(F){this.kb.removeHandler("CSC",F)}Fqm(F){this.kb.addHandler("RP",F)}pGn(F){this.kb.removeHandler("RP",F)}Eqm(F){this.kb.addHandler("RC",F)}oGn(F){this.kb.removeHandler("RC",F)}Kqm(F){this.kb.addHandler("RMID",F)}Dqm(F){this.kb.addHandler("RPS",F)}nGn(F){this.kb.removeHandler("RPS",
F)}Yqm(F){this.kb.addHandler("UPSR",F)}BGn(F){this.kb.removeHandler("UPSR",F)}$ah(F){this.kb.addHandler("PU",F)}Zpm(F){this.kb.addHandler("IPU",F)}WFn(F){this.kb.removeHandler("IPU",F)}Wqm(F){this.kb.addHandler("UCI",F)}zGn(F){this.kb.removeHandler("UCI",F)}Nqm(F){this.kb.addHandler("SUN",F)}tGn(F){this.kb.removeHandler("SUN",F)}$pm(F){this.kb.addHandler("IUNR",F)}XFn(F){this.kb.removeHandler("IUNR",F)}Zmc(F){this.kb.addHandler("UNR",F)}Ypm(F){this.kb.addHandler("IPSU",F)}VFn(F){this.kb.removeHandler("IPSU",
F)}Xpm(F){this.kb.addHandler("IPSC",F)}UFn(F){this.kb.removeHandler("IPSC",F)}Xqm(F){this.kb.addHandler("UPSC",F)}AGn(F){this.kb.removeHandler("UPSC",F)}Mqm(F){this.kb.addHandler("SP",F)}sGn(F){this.kb.removeHandler("SP",F)}ofl(F){this.kb.addHandler("SPC",F)}vGn(F){this.kb.removeHandler("SPC",F)}Lqm(F){this.kb.addHandler("RCF",F)}Wpm(F){this.kb.addHandler("CPSWM",F)}TFn(F){this.kb.removeHandler("CPSWM",F)}static getInstance(){return C.Wa||(C.Wa=new C)}}C.Wa=null;Object(x.a)(C,"RtcEventHub",null,[1458])},
1520:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c extends Sys.EventArgs{constructor(b,f,e,h){super();this.type=b;this.Yec=f;this.DDm=e;this.ixb=h}}Object(x.a)(c,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1521:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b[b.disconnected=0]="disconnected";b[b.connecting=1]="connecting";b[b.connected=2]="connected"})(c||(c={}));Object(x.b)("ChannelConnectionState",c)},1522:function(x,G,a){a.d(G,"a",function(){return c});
x=a(0);class c{}c.Ztk="rr";c.AIn="rd";c.wIn="rbp";c.lxk="sa";Object(x.a)(c,"RtcReconnectParams",null,[])},1523:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.n9d="throttling_messageDelay";c.cFe="enabled";c.z_c="throttling_timeToWaitForResponse";c.b9d="throttling_maxNumberOfOutstandingMessages";c.w_i="throttling_globalMaxNumberOfOutstandingMessages";c.errorMessage="errorMessage";c.OJk="url";c.vbb="queryString";c.W7="connectionString";Object(x.a)(c,"RtcFindSessionOutputFieldNameConstants",
null,[])},1524:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.Dih=this.Rqh=this.Sqh=this.Uqh=0;this.xUf=!1;this.correlationId=this.W7=this.vbb=this.Lkf=this.errorMessage=null}get Tkl(){return this.Lkf+"?"+this.vbb}}Object(x.a)(c,"FindSessionResponse",null,[])},1529:function(x,G,a){a.r(G);a.d(G,"FindSessionStrategy",function(){return M});x=a(0);var c=a(17),b=a(40),f=a(68),e=a(1521),h=a(1523),u=a(4),m=a(33),n=a(26),l=a(741),r=a(21),w=a(5),y=a(83),z=a(1524);class A{}
A.clientId="ClientId";A.qZn="UserApp";A.userSessionId="usid";A.userType="UserType";A.EZn="UserVersion";A.ITc="qs";A.Zxm="clientProtocol";A.Umn="NoAuth";Object(x.a)(A,"RtcFindSessionInputQueryParamConstants",null,[]);class B{constructor(K,P,V,Y,ta,fa){this.zpd=null;this.blm=K;K=String.format("{0}={1}",A.clientId,w.a.Sj(Y));K=String.format("{0}&{1}={2}",K,A.userSessionId,w.a.Sj(ta));K=String.format("{0}&{1}={2}",K,A.qZn,w.a.Sj(V.toString()));K=String.format("{0}&{1}={2}",K,A.userType,w.a.Sj("1"));K=
String.format("{0}&{1}={2}",K,A.EZn,w.a.Sj(P));K=String.format("{0}&{1}={2}",K,A.Zxm,w.a.Sj(B.Yxm));(P=B.jMm(V,fa))&&(K=String.format("{0}&{1}",K,P));this.xgm=K}vkk(){this.zpd=this.blm()}Hgh(){this.zpd&&""!==this.zpd||(this.vkk(),c.ULS.sendTraceTag(575784194,500,this.zpd&&""!==this.zpd?50:15,"Query signature delegate called for refresh returned: {0} ",this.zpd));const K=String.format("{0}={1}",A.ITc,w.a.Sj(this.zpd));return String.format("{0}&{1}",K,this.xgm)}static jMm(K,P){return 4===K?String.format("{0}={1}",
A.Umn,"1"):P?P.xxl():null}}B.Yxm="1.0";Object(x.a)(B,"FindSessionQueryStringGenerator",null,[]);var H=a(1533),v=a(1359),C=a(706),F=a(1360);class D{}D.mJm="FSType";Object(x.a)(D,"RtcFindSessionRequestHeaders",null,[]);class N{}N.eDn="polling";Object(x.a)(N,"RtcFindSessionTypes",null,[]);var U=a(1522);class W{}W.k_n="RTC-TokenProofkey";W.z7m="RTC-IsWacJsBootFsRequest";Object(x.a)(W,"RtcRequestHeaders",null,[]);var L=a(155),O=a(1130);class M{constructor(K,P,V,Y,ta,fa,Ta,ha,qa,ra,I,ba,Ga=null){this.V8k=
(new Date(0)).getTime();this.B9k=0;this.q9g=!1;this.Fbl=null;this.skk=36E5;this.wwe=M.PAl;this.dXe=0;this.Rke=null;this.cec=0;this.kMe=this.dll=null;this.qlm=[h.a.cFe,h.a.errorMessage,h.a.OJk,h.a.W7,h.a.vbb,h.a.w_i,h.a.b9d,h.a.z_c,h.a.n9d];this.plm=[h.a.cFe,h.a.errorMessage];this.W7=this.X_b=null;this.NIh=new B(I?I:()=>u.AFrameworkApplication.ui,ta,fa,Ta,K,P);this.FUe=ba;this.Un=Y;this.$m=P;this.Ohm=V;this.VI=ha;this.Kt=qa;this.yXe=Ga;this.Q6k=!1;this.oxf=9E4;ra&&ra.execute(Oa=>{Object(O.a)()?Oa.Yah(()=>
{c.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",this.VI);this.NIh.vkk()}):Oa.saf(()=>{c.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",this.VI);this.NIh.vkk()})});2>=100*Math.random()&&(this.skk=3E5);H.a.instance&&(H.a.instance.Ysl=this.skk)}lCk(K){this.kMe=K}init(){this.Kt.Kqm(Object(b.a)(this,this.CHn,"resetGetMachineIdDelay"));this.Kt.Otd(Object(b.a)(this,this.$Bb,"onConnectionStateChanged"))}$Bb(K,P){this.cec=
P.newState;2===P.newState&&(this.dXe=0)}qhh(){let K;K=this.Rke.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.Rke.vbb,M.bmi,w.a.Sj(K)),correlationId:K}}sUi(K,P,V,Y,ta){this.YJn(()=>{Y(ta,"GetMachineIdSuccess")&&(c.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.W7,this.VI),K(this.Fbl),V(this.uUm()))},fa=>{Y(ta,"GetMachineIdFailure")&&(c.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",this.VI),P(fa))},Y,ta)}Rvi(){this.Xjl();
this.R0m()}YJn(K,P,V,Y){c.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.W7);this.W7?K():window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(K,P,V,Y)},this.dwm())}sendFindSessionRequestToServerInternal(K,P,V,Y){V(Y,"RequestMachineId")&&(this.V8k=(new Date).getTime(),V=n.a.xi(),this.Gul(ta=>{const fa=n.a.xi();this.wsh(ta);this.aBk();K();ta=n.a.xi()-fa;c.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",
ta)},ta=>{const fa=n.a.xi();this.Xjl();H.a.instance&&H.a.instance.Uja(2,3);P(ta);ta=n.a.xi()-fa;c.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ta)},!1),V=n.a.xi()-V,c.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",V))}R0m(){this.wwe+=M.mQm;this.wwe=Math.min(this.wwe,M.Yfn)}dwm(){let K=this.V8k+this.wwe-(new Date).getTime();0>K&&(K=0);return K}wsh(K){try{this.Rke=K,this.X_b=K.Tkl,this.W7=K.W7,this.dll=K.vbb,this.Fbl=K.Lkf}catch(P){c.ULS.sendTraceTag(17956953,
500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",P.toString())}}Xjl(){this.W7=null;this.Yjl()}aBk(){this.Yjl();this.q9g=!0;this.B9k=window.setTimeout(Object(b.a)(this,this.UDn,"refreshMachineId"),this.skk)}Yjl(){this.q9g&&(window.clearTimeout(this.B9k),this.q9g=!1)}UDn(){this.q9g=!1;this.Gul(K=>{const P=this.dll!==K.vbb,V=this.W7!==K.W7,Y=this.W7;this.wsh(K);0!==this.cec&&(V?(c.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",
Y||"null",K.W7),this.Kt.Fth()):(this.Kt.uCn(P,V),this.aBk()))},()=>{H.a.instance&&H.a.instance.Uja(2,3);this.aBk()},!0)}CHn(){this.wwe=M.PAl}uUm(){return new F.a(this.Rke.Uqh,this.Rke.Sqh,this.Rke.Rqh,this.Rke.Dih)}eVn(K){if(Object.getType(K)!==Object)return null;for(let P in K);return this.SAm(K)}SAm(K){if(!(h.a.cFe in K))return null;const P=K[h.a.cFe];var V=P?this.qlm:this.plm;for(const Y of V)if(!(Y in K))return null;V=Object.assign(new z.a,{xUf:K[h.a.cFe],errorMessage:K[h.a.errorMessage],correlationId:y.a.create().toString()});
P&&(V.Lkf=K[h.a.OJk],V.vbb=K[h.a.vbb],V.W7=K[h.a.W7],V.Dih=K[h.a.w_i],V.Rqh=K[h.a.b9d],V.Sqh=K[h.a.z_c],V.Uqh=K[h.a.n9d]);return V}aPm(K,P){c.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.yXe.kJm.continueWith(()=>{this.yXe.kJm.result?(c.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),K(this.yXe.lJm)):(c.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),P(this.yXe.lJm))})}i_l(K,P,V,Y,ta=
!1){return fa=>{v.a.instance.BIg(0,1);K&&K.stop();this.FUe=this.kMe=null;this.KFl(fa.data,!0,P);var Ta=C.RtcUtils.deserialize(fa.data.responseData,"FindSession",null);if(Ta)if(Ta=this.eVn(Ta)){if(Ta.xUf&&Ta.vbb&&Ta.W7){c.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",this.VI);this.X9m(fa.data);V(Ta);return}P.FindSessionFailureReason="FindSessionInvalidResponse";P.IsRtcEnabled=Ta.xUf;P.IsQueryStringEmpty=!Ta.vbb;P.IsConnectionStringEmpty=!Ta.W7;c.ULS.sendTraceTag(4290720,
500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",this.VI,Ta.xUf,!Ta.vbb,!Ta.W7)}else P.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",c.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.VI);else P.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",c.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",
this.VI);this.TWl(P,ta);Y(null)}}f_l(K,P,V,Y=!1){return ta=>{v.a.instance.BIg(0,1);K&&K.stop();this.FUe=this.kMe=null;this.KFl(ta.data,!1,P);let fa=null;var Ta="unknown";let ha="unknown";ta.data&&((Ta=ta.data.fk)&&M.BNg in Ta&&(fa=Ta[M.BNg].toString()),Ta=l.a[ta.data.status],ha=ta.data.Ze.toString());P.FindSessionFailureReason="FindSessionRequestFailed";P.HttpErrorCode=ha;P.HttpErrorStatus=Ta;P[M.BNg]=fa;c.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",
Ta,ha,this.VI,fa,Y);this.TWl(P,Y);V(ha)}}Gul(K,P,V=!1){let Y=null;c.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.VI);const ta={};var fa=this.NIh.Hgh();ta[L.a.EIa]=y.a.create().toString();this.kMe&&""!==this.kMe?fa=String.format("{0}&{1}={2}",fa,U.a.Ztk,this.kMe):this.FUe&&""!==this.FUe&&(fa=String.format("{0}&{1}={2}",fa,U.a.Ztk,this.FUe),ta[W.k_n]="True",ta[W.z7m]="True");fa=this.Ohm+"?"+fa;V&&(ta[D.mJm]=N.eDn);const Ta={};Ta.IsNetworkOfflineBeforeSendRequest=this.$m.wTa;
Ta.HasAvailableConnectionsBeforeSendRequest=this.$m.Uih;Ta.MaxConnectionsAllowed=this.$m.Qqh;Ta.IsRefreshMachineId=V;this.yXe&&!this.Q6k?(this.aPm(this.i_l(null,Ta,K,P,V),this.f_l(null,Ta,P,V)),this.Q6k=!0):(this.Un&&(Y=this.Un.wl("WebServiceCall","GetMachineIdFromTheServer")),H.a.instance&&H.a.instance.Uja(2,0),0>this.$m.HZ(fa,1,null,ta,[M.Idh,M.BNg,M.Gvg,M.Ytk,M.ZNl,M.OOl,M.NOl],!1,1,this.i_l(Y,Ta,K,P,V),this.f_l(Y,Ta,P,V),null,null,!1,null,this.oxf,"3",null,!0)&&(5<this.dXe&&200>this.dXe&&c.ULS.sendTraceTag(578166985,
500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.dXe),window.setTimeout(()=>{this.dXe++;P("-1")},1E3)))}KFl(K,P,V){V||(V={});V.IsNetworkOfflineAfterRequestComplete=this.$m.wTa;V.IsRequestSucceeded=P;K&&(V.EnqueueTime=K.WC,V.InvokedTime=K.qq,V.CompletedTime=K.zr,K.fk&&(M.Idh in K.fk&&(V.CorrelationId=K.fk[M.Idh]),M.Gvg in K.fk&&(V[M.Gvg]=K.fk[M.Gvg])));c.ULS.sendTraceTag(38633565,500,P?50:15,C.RtcUtils.AIe(V))}TWl(K,P){K||(K={});K.ConnectionState=
e.a[this.cec];P||this.Kt.SWl(1,K)}X9m(K){try{var P=!1,V=!1,Y=K.fk,ta=m.a.aN(K.request.get_url());if(Y&&M.Ytk in Y){const ra=Y[M.Ytk].toString().toLocaleLowerCase();V="true"===ra;P="false"===ra}Y=!1;const qa=0<=ta.toLocaleLowerCase().indexOf("collab");V&&!qa?Y=!0:P&&qa&&(Y=!0);if(Y){P={};P.HostName=ta;P.Status=l.a[K.status];P.HttpStatus=K.Ze.toString();var fa=K.request.get_headers();for(let ra in fa){var Ta=fa[ra];(ta=ra)&&0<ta.length&&(V=0,Ta&&(V=Ta.toString().length),P["r_"+ta]=V)}if(K.fk){const ra=
new f.a;ra.add(M.Idh);ra.add(M.Gvg);ra.add(M.BNg);ra.add(M.OOl);ra.add(M.NOl);ra.add(M.ZNl);M.fpm(P,K.fk,ra)}M.cpm(K.request.get_url(),P);var ha=r.a.toJSON(P);c.ULS.sendTraceTag(559437006,500,15,ha)}}catch(qa){c.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",qa.toString())}}static createInstance(K,P,V,Y,ta,fa,Ta,ha,qa,ra,I,ba=null){return M.CAe(K,P,V,Y,ta,fa,Ta,ha,qa,ra,null,I,ba)}static hBm(K,P,V,Y,ta,fa,Ta,ha,qa,ra,I=null){return M.CAe(K,P,V,Y,ta,3,fa,Ta,ha,qa,ra,I,null)}static CAe(K,
P,V,Y,ta,fa,Ta,ha,qa,ra,I,ba,Ga=null){K=K||y.a.create().toString();K=new M(K,P,V,Y,ta,fa,Ta,ha,qa,ra,I,ba,Ga);K.init();return K}static fpm(K,P,V){for(let Y of V)Y in P&&(K[Y]=P[Y])}static cpm(K,P){if(K){var V=K.indexOf("?");if(-1!==V)for(K=K.substr(V+1).split("&"),V=0;V<K.length;++V){var Y=K[V].split("=");if(2===Y.length){const ta=Y[0];if(ta&&0<ta.length){let fa=0;if(Y=Y[1])fa=Y.length;P["q_"+ta]=fa}}}}}}M.mQm=3E3;M.Yfn=3E5;M.PAl=1E3;M.Idh="X-CorrelationId";M.bmi="corrid";M.BNg="RtcErrorCode";M.Gvg=
"X-OfficeCluster";M.Ytk="X-NewEnv";M.ZNl="X-MSEdge-Ref";M.NOl="X-OFFICEFD";M.OOl="X-OfficeFE";Object(x.a)(M,"FindSessionStrategy",null,[1454])},1533:function(x,G,a){a.d(G,"a",function(){return m});x=a(0);var c=a(17),b=a(40),f=a(21),e;(function(n){n[n.s1n=0]="SendNotification";n[n.t1n=1]="SendPersistentState";n[n.N0n=2]="FindSession";n[n.Kcm=3]="Last"})(e||(e={}));Object(x.b)("ApiType",e);var h;(function(n){n[n.C0n=0]="AttemptCount";n[n.z1n=1]="SuccessCount";n[n.I0n=2]="DropCount";n[n.J0n=3]="FailedCount";
n[n.Y0n=4]="LatencyOverThresholdCount";n[n.Z0n=5]="LatencyUnderThresholdCount";n[n.H1n=6]="ThrottledCount";n[n.Kcm=7]="Last"})(h||(h={}));Object(x.b)("EventCountType",h);var u=a(1359);class m{constructor(n){this.bll=this.dsl=null;this.vNl=this.Ysl=0;this.NM=null;this.y9k=this.zNh=0;this.$m=n;this.g2m();this.sIh=this.S6k=this.dOh=!1;this.tNh=0}get THm(){return this.sIh}iSn(n){this.y9k=n;window.setInterval(Object(b.a)(this,this.yxj,"logMetricsBatchAndReset"),n);this.zNh=(new Date).getTime()}Uja(n,l){this.hOn(n)&&
!this.S6k||this.THm||!window.navigator.onLine||this.$m.wTa||(this.NM[n][l]++,this.dOh=!0)}g2m(){this.NM=Array(3);for(let n=0;3>n;n++){this.NM[n]=Array(7);for(let l=0;7>l;l++)this.NM[n][l]=0}}Num(){const n={};for(let l=0;3>l;l++)for(let r=0;7>r;r++)this.r7m(l,r)&&(n[e[l]+h[r]]=this.NM[l][r]);n.FSDomain=this.dsl;n.ConnectionDomain=this.bll;n.FSRetryInterval=this.Ysl;n.MaxPayloadSize=this.vNl;n.LogNumber=this.tNh;1===this.tNh&&(n.FSLatencies=u.a.instance.$Om(),n.ConLatencies=u.a.instance.aNm());return n}r7m(n,
l){return 2===n&&3!==l&&0!==l?!1:!0}hOn(n){return 2===n?!1:!0}yxj(){if(this.dOh){this.tNh++;if((new Date).getTime()-this.zNh<5E3+this.y9k){var n=f.a.toJSON(this.Num());c.ULS.sendTraceTag(50644352,500,15,n)}this.zNh=(new Date).getTime();for(n=0;3>n;n++)for(let l=0;7>l;l++)this.NM[n][l]=0;this.dOh=!1}}Efn(){this.S6k=!0}static get instance(){return m.Wa}static create(n){m.instance||(m.Wa=new m(n));return m.instance}}m.Wa=null;Object(x.a)(m,"FrequentLoggingMetrics",null,[1477])},1536:function(x,G,a){a.d(G,
"a",function(){return b});x=a(0);var c;(function(f){f[f.aOl=0]="multipleBrowsersImageClassName";f[f.yTl=1]="peopleImageClassName";f[f.zTl=4]="peopleImageClusterPath";f[f.$Nl=5]="multipleBrowserImageClusterPath";f[f.oTa=6]="imageDimension";f[f.rtl=8]="rtl";f[f.kCb=9]="pointerInputManager";f[f.BSa=10]="clickInputManager";f[f.vertical=11]="vertical";f[f.zIndex=12]="zIndex";f[f.W5c=13]="contextMenuInputManager";f[f.uAl=14]="imageDomElement";f[f.n$l=15]="useIdleTooltip";f[f.G$l=16]="viewportBoundsCallback";
f[f.usl=17]="flipHorizontalDirection";f[f.qsl=18]="fixRemoveFadeOutElementCrash";f[f.sAl=19]="ignoreEventOnExpandedTooltip";f[f.qBl=20]="ipWidthAdjustForFlyout"})(c||(c={}));Object(x.b)("PresenceTooltipSettingKeys",c);class b{constructor(){this.kP={}}get(f,e=null){f=c[f];return"number"===typeof e?(e=this.kP[f])?Number.parseInvariant(e.toString()):0:this.kP[f]}add(f,e){this.kP[c[f]]=e}eca(f,e){c[f]in this.kP||(this.kP[c[f]]=e)}remove(f){delete this.kP[c[f]]}}Object(x.a)(b,"PresenceTooltipSettings",
null,[])},1627:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c extends Sys.EventArgs{constructor(b,f){super();this.hPe=b;this.Dol=f}}Object(x.a)(c,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1628:function(x,G,a){a.r(G);a.d(G,"RealtimeChannelMetrics",function(){return h});x=a(0);var c=a(17),b=a(174),f=a(21),e=a(706);class h{constructor(){this.z$k=this.A$k=this.B$k=this.x$k=this.w$k=this.y$k=this.Q2e=this.QOh=0;this.r8g=this.TMh=this.o1e=this.OMh=this.PMh=this.LMh=this.g3c=this.b1e=
this.gxe=this.KMh=this.q8g=this.Hwe=null;this.KNh=this.g2e=this.Ebl=this.a5k=0;this.W9k=!1;this.Oth=this.Tik;this.Wik=this.Xik;this.Pth=this.Vik;this.wIg=this.fjk;this.lXl=this.ejk;this.ujk=this.vjk;this.rjk=this.sjk;this.Wie=this.pjk;this.DIg=this.qjk;this.jXl=this.Uik;this.A0b=this.xWj;this.Ccc=this.yWj}Tik(){this.QOh++;this.KMh=new Date;this.Hwe||(this.Hwe=new Date)}Xik(){this.Q2e++;this.g3c=new Date;this.q8g||(this.q8g=this.g3c);this.o1e=this.g3c;this.Nym()}Vik(){this.y$k++;this.LMh=new Date}fjk(){this.w$k++;
this.gxe=new Date}ejk(){this.x$k++;this.b1e=new Date}sjk(){this.PMh=new Date;this.B$k++}qjk(){this.r8g||(this.r8g=new Date);this.A$k++}pjk(){this.OMh=new Date;this.z$k++}vjk(){if(!this.W9k&&this.QOh){var u=this.jdh();c.ULS.sendTraceTag(39321871,500,15,f.a.toJSON(u));this.W9k=!0}}Uik(u){const {l9i:m,m9i:n,oj:l}=e.RtcUtils.Sql(u);m&&m!==b.a.bC&&(c.ULS.sendTraceTag(40157596,500,15,f.a.toJSON({["HttpErrorCode"]:m,["HttpErrorStatus"]:n,["Exception"]:l})),b.a.Egj(m)&&this.a5k++,b.a.fpj(m)&&this.Ebl++)}xWj(){this.TMh=
new Date}yWj(){this.gxe=this.o1e=new Date}jdh(){return{["numberOfConnectionAttempts"]:this.QOh,["numberOfSuccessfulConnections"]:this.Q2e,["numberOfFailedConnections"]:this.y$k,["numberOfDisconnectedConnections"]:this.w$k,["numberOfExplicitDisconnectedConnections"]:this.x$k,["numberOfSentMessages"]:this.B$k,["numberOfReceivedMessages"]:this.A$k,["numberOfLostMessages"]:this.z$k,["firstConnectionAttempt"]:this.Hwe?this.Hwe:null,["firstMessageReceived"]:this.r8g?this.r8g:null,["firstConnectionSuccess"]:this.q8g?
this.q8g:null,["lastConnectionAttempt"]:this.KMh?this.KMh:null,["lastConnectionSuccess"]:this.g3c?this.g3c:null,["lastConnectionFailure"]:this.LMh?this.LMh:null,["lastMessageSent"]:this.PMh?this.PMh:null,["lastMessageLost"]:this.OMh?this.OMh:null,["lastDisconnect"]:this.gxe?this.gxe:null,["lastExplicitDisconnect"]:this.b1e?this.b1e:null,["lastTimeOnline"]:this.o1e?this.o1e:null,["lastTimeOffline"]:this.TMh?this.TMh:null,["maxDisconnectedTimeMs"]:this.g2e,["maxExplicitDisconnectedTimeMs"]:this.KNh,
["clientConnectionErrors"]:this.a5k,["serverConnectionErrors"]:this.Ebl}}Nym(){this.Hwe&&1===this.Q2e&&(this.g2e=Math.max(this.g2e,this.g3c.getTime()-this.Hwe.getTime()));this.gxe&&1<this.Q2e&&(this.g2e=Math.max(this.g2e,this.g3c.getTime()-this.gxe.getTime()));this.b1e&&1<this.Q2e&&(this.KNh=Math.max(this.KNh,this.g3c.getTime()-this.b1e.getTime()))}static createInstance(u){h.Wa||(h.Wa=new h,c.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",u));return h.Wa}}h.Wa=
null;Object(x.a)(h,"RealtimeChannelMetrics",null,[1842,281])},1629:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b[b.unspecified=0]="unspecified";b[b.word=1]="word";b[b.excel=2]="excel";b[b.powerPoint=3]="powerPoint";b[b.test=4]="test";b[b.BPe=5]="wacFrontEnd";b[b.oneNote=6]="oneNote";b[b.Z5g=7]="visio";b[b.V4n=8]="officeMobile";b[b.B2n=9]="cosmosDBChangefeed";b[b.last=10]="last"})(c||(c={}));Object(x.b)("RtcClientAppName",c)},1636:function(x,G,a){a.r(G);a.d(G,"RealtimeChannel",
function(){return Mb});x=a(0);var c=a(17),b=a(40),f=a(219),e=a(1629),h=a(1521),u=a(92),m=a(4);class n{constructor(hb,Da){this.status=hb;this.AFe=Da}}Object(x.a)(n,"UserStatusInfo",null,[]);var l=a(33),r=a(1359);class w{constructor(hb,Da){this.data=hb;this.timeStamp=Da}}Object(x.a)(w,"PresenceData",null,[]);var y=a(175),z=a(1131);class A{constructor(){this.HEh=this.A4k=!1;this.FEh=0;this.LFh=this.lTh=this.kTh=this.iEh=!1;this.OIh=0;this.nbl=!1;this.mbl=this.lbl=0;this.dSh=!1;this.hSh=this.fSh=this.iSh=
this.eSh=0;this.gSh=!1}get Xbh(){return this.HEh}get h5c(){return this.FEh}get Erm(){return this.iEh}get rOn(){return this.kTh}get sOn(){return this.lTh}get Xxm(){return this.LFh}get oxf(){return this.OIh}get CIn(){return this.nbl}get k0l(){return this.lbl}get BIn(){return this.mbl}get xIn(){return this.dSh}get yIn(){return this.eSh}get p0l(){return this.iSh}get l0l(){return this.fSh}get n0l(){return this.hSh}get m0l(){return this.gSh}static createInstance(hb){return hb?Object.assign(new A,{A4k:hb.getBooleanAppSetting("AwayStatusManagerIsEnabled"),
HEh:hb.getBooleanAppSetting("AwayStatusOneMinuteTimeoutIsEnabled"),FEh:hb.Jc("AwayCoauthorThresholdMs",9E5),iEh:hb.getBooleanAppSetting("RtcAllowCrossDomainAccessEnabled"),kTh:hb.getBooleanAppSetting("ShouldLogOnContentNotification"),lTh:hb.getBooleanAppSetting("ShouldLogOnHostSubscriptionNotification"),LFh:hb.getBooleanAppSetting("RtcClientMetricsEnabled"),OIh:hb.Jc("RtcFindSessionRequestTimeoutInMS",6E4),nbl:hb.getBooleanAppSetting("RtcJsClientFrequentlyLogsMetrics"),lbl:hb.Jc("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),mbl:hb.Jc("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),dSh:hb.getBooleanAppSetting("RtcClientMessageTelemetryEnabled"),eSh:hb.Jc("RtcClientMessageTelemetrySampleSize",5),iSh:hb.Jc("RtcSendTelemetryMessageIntervalInMS",3E5),fSh:hb.Jc("RtcLogClientMessageMetricsTimeOutInMs",2E4),hSh:hb.Jc("RtcMaxPayloadSizeInCharactersOverride",z.a.lTj),gSh:hb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new A,{A4k:!1,HEh:!1,FEh:9E5,iEh:!1,kTh:!1,
lTh:!0,LFh:!1,OIh:9E4,dSh:!1,eSh:5,iSh:3E5,fSh:2E4,hSh:z.a.lTj,gSh:!1})}}Object(x.a)(A,"RealtimeChannelSettings",null,[1849]);var B=a(30),H=a(1360);class v{constructor(hb,Da=""){this.BWe=this.E7e=0;this.FLh=!1;this.hye=this.T$g=null;this.axe=!1;this.Dbl=hb;this.D7l=Da;this.setTimeout=v.Ksi;this.$rd=this.E7e=this.BWe=0}tjk(){0<this.$rd&&0<this.BWe&&c.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.D7l,this.BWe,this.$rd);0<this.$rd&&0<this.E7e&&c.ULS.sendTraceTag(36545634,
500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.D7l,this.E7e,this.$rd)}get XEe(){return this.FLh}Bwh(hb,Da){this.E7e++;this.pjf(!0);this.FLh=!0;this.T$g=hb;this.hye=Da}pjf(hb){this.FLh=!1;this.hye&&hb&&(this.BWe++,this.hye.hSj());this.hye=this.T$g=null}static Ksi(hb,Da){return window.setTimeout(hb,Da)}}Object(x.a)(v,"ThrottlerBase",null,[]);class C{constructor(){this.R4k=this.iGh=!1;this.callback=null}Iwg(hb){this.callback=hb;this.Y7l()}YMl(hb){this.iGh||(this.iGh=!0,this.tgm=
hb,this.Y7l())}Y7l(){this.iGh&&this.callback&&!this.R4k&&(this.R4k=!0,this.callback(this.tgm))}}Object(x.a)(C,"CompletionTask",null,[]);class F{constructor(){this.T9k=new C;this.S9k=new C}Rrh(hb){this.T9k.Iwg(hb)}Qrh(hb){this.S9k.Iwg(hb)}qsg(hb){this.T9k.YMl(hb)}ubd(hb){this.S9k.YMl(hb)}hSj(){this.qsg(2);this.ubd(2)}}Object(x.a)(F,"MessageStatus",null,[1858]);class D extends v{constructor(hb,Da=""){super(hb,Da);this.n9d=0;this.rKn=()=>{if(this.XEe){const Bb=this.T$g,Za=this.hye;this.pjf(!1);this.BPg(Bb,
Za)}};this.m1e=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(hb){this.axe||(this.n9d=hb,this.axe=!0)}add(hb){this.axe||this.init(D.tnl);this.$rd++;const Da=this.currentTime(),Bb=new F;this.m1e>Da&&(this.m1e=Da);this.XEe?(this.pjf(!0),this.Bwh(hb,Bb)):this.m1e+this.n9d<=Da?this.BPg(hb,Bb):(this.Bwh(hb,Bb),this.setTimeout(this.rKn,this.m1e+this.n9d-Da));return Bb}BPg(hb,Da){this.m1e=this.currentTime();hb=this.Dbl(hb);hb.Rrh(Bb=>{Da.qsg(Bb)});hb.Qrh(Bb=>{Da.ubd(Bb)})}static createInstance(hb,
Da=""){return new D(hb,Da)}}D.tnl=200;Object(x.a)(D,"MaxRateThrottler",v,[1855,1856]);class N extends v{constructor(hb,Da=""){super(hb,Da);this.b9d=this.z_c=0;this.kb=new B.a;this.$we=!1;this.Q7g=this.J7g=this.hVh=0;this.tKn=()=>{this.$we=!1;if(this.XEe){const Bb=this.T$g,Za=this.hye;this.pjf(!1);this.BPg(Bb,Za)}};this.Iqn=()=>{++this.Q7g;this.Q7g>Math.floor(this.b9d/2)&&(this.Q7g=-1E9,this.kb.raiseEvent("TMUDM"))};this.G9g=0;this.V$g=[];this.clearTimeout=N.qsi}add(hb){this.axe||this.init(N.znl,N.xnl);
this.$rd++;const Da=new F;this.XEe?this.Bwh(hb,Da):this.G9g<this.b9d?this.BPg(hb,Da):(this.Bwh(hb,Da),this.$we=!1);return Da}BPg(hb,Da){hb=this.Dbl(hb);const Bb=this.setTimeout(this.Iqn,this.z_c);++this.G9g;Array.add(this.V$g,Bb);const Za=this.J7g;hb.Rrh(mb=>{Da.qsg(mb)});hb.Qrh(mb=>{this.J7g===Za&&(this.Hqn(Za,Bb),Da.ubd(mb))})}Hqn(hb,Da){this.J7g===hb&&(--this.G9g,this.clearTimeout(Da),Array.remove(this.V$g,Da),this.XEe&&this.sKn())}sKn(){this.XEe&&!this.$we&&(this.hVh=this.setTimeout(this.tKn,
0),this.$we=!0)}gbh(hb){this.kb.addHandler("TMUDM",hb)}FZl(hb){this.kb.removeHandler("TMUDM",hb)}reset(){this.$rd=this.E7e=this.BWe=this.Q7g=0;++this.J7g;for(const hb of this.V$g)this.clearTimeout(hb);this.G9g=0;this.V$g=[];this.pjf(!0);this.$we&&(this.clearTimeout(this.hVh),this.hVh=0,this.$we=!1)}init(hb,Da){this.axe||(this.z_c=hb,this.b9d=Da,this.axe=!0)}static createInstance(hb,Da=""){return new N(hb,Da)}static qsi(hb){window.clearTimeout(hb)}}N.znl=15E3;N.xnl=5;Object(x.a)(N,"MaxOutstandingThrottler",
v,[1857,1856]);class U{constructor(hb){this.$d=null;this.WS=!1;this.kb=new B.a;this.RNh=new u.a;this.ONh=new u.a;this.iVh=hb;this.Owe=this.iVh.Hml(Da=>Da.send(),"GlobalMaxOustandingThrottler");this.Owe.gbh(()=>{this.kb.raiseEvent("TMUDM")})}init(hb){this.WS||(this.$d=hb,this.Owe.init(this.$d.z_c,this.$d.xVm),this.WS=!0)}sUm(hb){this.WS||this.init(new H.a(D.tnl,N.znl,N.xnl,U.cgn));if(!({value:Da}=this.RNh.Uh(hb)).returnValue){if(!({value:Da}=this.ONh.Uh(hb)).returnValue){var Da="MaxOutstandingThrottler-"+
hb;Da=this.iVh.Hml(Object(b.a)(this.Owe,this.Owe.add,"add"),Da);Da.init(this.$d.z_c,this.$d.bgn);Da.gbh(()=>{this.kb.raiseEvent("TMUDM")});this.ONh.add(hb,Da)}const Bb="MaxRateThrottler-"+hb;Da=this.iVh.nBm(Object(b.a)(Da,Da.add,"add"),Bb);Da.init(this.$d.ogn);this.RNh.add(hb,Da)}return Da}reset(){for(const hb of this.RNh)hb.value.tjk();for(const hb of this.ONh)hb.value.tjk(),hb.value.reset();this.Owe.tjk();this.Owe.reset()}gbh(hb){this.kb.addHandler("TMUDM",hb)}FZl(hb){this.kb.removeHandler("TMUDM",
hb)}}U.cgn=1E3;Object(x.a)(U,"ThrottlerManager",null,[1848]);class W{}W.v0m="realtimeChannelHub";W.Ufd="UpdatePresence";W.mvb="SendUpdateNotification";W.ZKi="GetCompletePersistentStateWithMetadata";W.WOe="UpdatePersistentState";W.Sfd="UpdateClientInfo";Object(x.a)(W,"RtcHubMethodNames",null,[]);class L{constructor(hb){this.N9b=!1;this.jye=0;this.lGh=!1;this.I$m=()=>{c.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.VI)};this.setTimeout=L.Ksi;this.clearTimeout=
L.qsi;this.lan=this.I$m;this.VI=hb}Pon(){this.N9b||(this.jye=this.setTimeout(()=>{this.N9b=!1;this.MFl()},8E3),this.N9b=!0,this.lGh=!1)}tpn(){this.R4()}ysn(){this.MFl()}MFl(){this.R4();this.lGh||(this.lGh=!0,this.lan())}R4(){this.N9b&&this.clearTimeout(this.jye);this.jye=0;this.N9b=!1}static Ksi(hb,Da){return window.setTimeout(hb,Da)}static qsi(hb){window.clearTimeout(hb)}}Object(x.a)(L,"ConnectedUsageKpiLogger",null,[1847]);class O{constructor(){this.Oth=this.Tik;this.Wik=this.Xik;this.Pth=this.Vik;
this.wIg=this.fjk;this.lXl=this.ejk;this.ujk=this.vjk;this.rjk=this.sjk;this.Wie=this.pjk;this.DIg=this.qjk;this.jXl=this.Uik;this.A0b=this.xWj;this.Ccc=this.yWj}Tik(){}Xik(){}Vik(){}fjk(){}ejk(){}sjk(){}qjk(){}pjk(){}vjk(){}Uik(){}xWj(){}yWj(){}}Object(x.a)(O,"NoopRealtimeChannelMetrics",null,[1842,281]);class M{}M.Ufd="presenceUpdated";M.updateNotification="updateNotification";M.HTl="persistentStateCleared";M.WOe="persistentStateUpdated";Object(x.a)(M,"RtcClientMethodNames",null,[]);class K{constructor(hb){this.D4=
hb}QEn(hb){this.D4.on(M.Ufd,hb)}WEn(hb){this.D4.on(M.updateNotification,hb)}OEn(hb){this.D4.on(M.WOe,hb)}NEn(hb){this.D4.on(M.HTl,hb)}JWn(hb){this.D4.off(M.Ufd,hb)}MWn(hb){this.D4.off(M.updateNotification,hb)}IWn(hb){this.D4.off(M.WOe,hb)}HWn(hb){this.D4.off(M.HTl,hb)}Ufd(hb){return this.D4.invoke(W.Ufd,hb)}Sfd(hb){return this.D4.invoke(W.Sfd,hb)}mvb(hb,Da){return this.D4.invoke(W.mvb,hb,Da)}ZKi(hb){return this.D4.invoke(W.ZKi,hb)}WOe(hb,Da){return this.D4.invoke(W.WOe,hb,Da)}}Object(x.a)(K,"RealtimeChannelProxy",
null,[1844,1845,1846]);var P=a(1393),V=a(231);class Y{constructor(hb){this.Nrd=null;this.cec=0;this.WDd=!1;this.Kt=hb;this.Kt.Otd(Object(b.a)(this,this.$Bb,"onConnectionStateChanged"))}$Bb(hb,Da){this.cec=Da.newState}bSl(){c.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.Kt.Fth()}F1m(hb){this.Nrd.init(hb)}}Object(x.a)(Y,"ARtcMessageHandler",null,[]);var ta=a(185);class fa{constructor(){this.Presence=null;this.TimeStamp=0}}Object(x.a)(fa,"PresenceDataEntryForClients",
null,[]);var Ta=a(21);class ha{constructor(hb,Da=""){this.Dlm=hb;this.Qyb=Da}send(){return this.Dlm()}get messageId(){return this.Qyb}}Object(x.a)(ha,"MessageHandler",null,[1859]);class qa extends Sys.EventArgs{constructor(hb,Da,Bb,Za){super();this.Bqk=hb;this.reconnectDelay=Da;this.reason=Bb;this.lxk=Za}}Object(x.a)(qa,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var ra=a(1520);class I{constructor(){this.jUh=this.Mm=null}get nv(){return this.Mm?this.jUh?this.jUh.getTime()-this.Mm.getTime():
(new Date).getTime()-this.Mm.getTime():0}start(){this.Mm=new Date}stop(){this.jUh=new Date}}Object(x.a)(I,"SimpleStopwatch",null,[]);var ba=a(1522),Ga;(function(hb){hb[hb.z2n=0]="contentUpdate";hb[hb.a3n=1]="editorsTableUpdate";hb[hb.SBe=2]="fileNameUpdate";hb[hb.f7n=3]="wetContentUpdate";hb[hb.n5n=4]="persistedContentUpdate";hb[hb.r2n=5]="clientRtcReconnectRequest";hb[hb.P5n=6]="replicationTelemetry";hb[hb.w4n=7]="lockUpdate";hb[hb.v2n=8]="collabServiceContentUpdate";hb[hb.I6n=9]="trackChangeSettingUpdate";
hb[hb.X5n=10]="saveTargetUpdate";hb[hb.Q6n=11]="uploadToOcsUpdate";hb[hb.p4n=12]="labelUpdate";hb[hb.W3n=13]="hostNotificationSubscriptionStatus";hb[hb.y6n=14]="subscribeOrExtend";hb[hb.b3n=15]="elapsedBootTelemetry";hb[hb.t2n=16]="clientToClientTelemetryMessage";hb[hb.s2n=17]="clientToClientResponseMessage";hb[hb.T6n=18]="verifyNotificationPipeline";hb[hb.V3n=19]="hostNotificationHeartbeat";hb[hb.d6n=20]="secondaryMetadataUpdate";hb[hb.last=21]="last"})(Ga||(Ga={}));Object(x.b)("UpdateNotificationType",
Ga);var Oa=a(91),Ja=a(706);class Qa extends Y{constructor(hb,Da,Bb,Za,mb,vb,sb,bc,yb,uc){super(sb);this.D4=null;this.Mal=this.r7g=this.v9k=!1;this.Qyb=0;this.bQh=new y.a;this.qjm=Qa.eNm();this.BPh=m.AFrameworkApplication.ga.La("OwningFeatureCrewForRtcNotificationKpis");this.$d=hb;this.u$k=this.t$k=0;this.Nrd=Da;this.Nrd.gbh(Object(b.a)(this,this.bSl,"onTooManyUndeliveredMessages"));this._clientId=Bb;this.Ykm=mb;this.Kt.Fqm(Object(b.a)(this,this.dRl,"onRefreshProxyRequired"));this.Kt.Dqm(Object(b.a)(this,
this.bRl,"onRefreshAllPersistentStateRequest"));this.Kt.Nqm(Object(b.a)(this,this.mvb,"sendUpdateNotification"));this.Kt.Zpm(Object(b.a)(this,this.pQl,"onInternalPresenceUpdated"));this.Kt.$pm(Object(b.a)(this,this.qQl,"onInternalUpdateNotificationReceived"));this.Kt.Ypm(Object(b.a)(this,this.oQl,"onInternalPersistentStateUpdated"));this.Kt.Xpm(Object(b.a)(this,this.nQl,"onInternalPersistentStateCleared"));this.Kt.Mqm(Object(b.a)(this,this.Gvh,"sendPersistentState"));this.Kt.Wqm(Object(b.a)(this,
this.Sfd,"updateClientInfo"));this.Un=vb;this.VI=Za;this.NM=bc;this.Iua=yb;this.j2e=uc;this.o2c=Object(V.a)(String,m.AFrameworkApplication.Rf.Application)||""}dRl(hb,Da){this.D4=this.Ykm(Da.hubConnection);this.Nrd.reset();this.D4.QEn(Object(b.a)(this,this.Tyg,"onPresenceUpdated"));this.D4.OEn(Object(b.a)(this,this.Urh,"onPersistentStateUpdated"));this.D4.NEn(Object(b.a)(this,this.L0j,"onPersistentStateCleared"));this.D4.WEn(Object(b.a)(this,this.hAg,"onUpdateNotificationReceived"))}$Bb(hb,Da){this.cec=
Da.newState;2===Da.newState&&this.mKn()}mKn(){for(const hb of this.bQh)this.mvb(null,new ra.a(hb.key,hb.value,!1,new f.a));this.bQh=new y.a}bRl(hb,Da){Da.Efi();for(hb=0;3>hb;++hb)this.ZJn(hb,Da)}ZJn(hb,Da){try{this.D4.ZKi(hb).done(Bb=>{Da.uPe(Da.Zji,"GetCompletePresenceSuccess")&&(Da.ezm.ysn(),c.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}] of type [{1}]",this.VI,hb),this.Kt.tCn(),this.hrn(hb,Bb),this.Kt.iCn(Bb),Da.Kql.Ob(hb)&&this.Kt.UWl(hb,Da.Kql.ha(hb),
new f.a))}).fail(Bb=>{Da.uPe(Da.Zji,"GetCompletePresenceFail")&&(c.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}] of type [{2}]",Ja.RtcUtils.AIe(Bb),this.VI,hb),this.Kt.Fth())}).always(()=>{Da.kD&&Da.kD.stop()})}catch(Bb){c.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",Da.Zji,Bb.message)}}Gvh(hb,Da){hb=Da.presence;
let Bb;const Za=Da.ixb;this.Iua.Uja(1,0);try{Bb=Ja.RtcUtils.Ddi(hb,this.j2e)}catch(sb){this.Iua.Uja(1,3);c.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",sb.message);Za.setException(sb);return}const mb=new u.a;mb.K(this._clientId,Object.assign(new fa,{Presence:hb,TimeStamp:(new Date).getTime()}));this.Kt.XWl(Da.type,mb);if(2!==this.cec)this.NM.Wie(),this.Iua.Uja(1,2),Za.vj(null);else{var vb=this.Qyb.toString();++this.Qyb;hb=new ha(()=>
this.oKn(Da.type,Bb,vb),vb);hb=this.C7l(0,Da.type).add(hb);hb.Rrh(sb=>{2===sb&&(this.Iua.Uja(1,6),this.r7g||2!==Da.type||c.ULS.sendTraceTag(508651234,500,15,"First persistent state update of type LiveMeeting for [{0}] was throttled",this.VI));Za.vj(null)});hb.Qrh(()=>{})}}oKn(hb,Da,Bb){let Za=null;const mb=new I,vb=new F;c.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}] of type [{1}]",this.VI,hb);if(2!==this.cec)return this.NM.Wie(),this.Iua.Uja(1,2),c.ULS.sendTraceTag(7934171,
500,15,"Connection is lost - unable to send the message for [{0}] of type [{1}]",this.VI,hb),vb.hSj(),vb;this.Un&&20>this.t$k&&(Za=this.Un.wl("WebServiceCall","Send Presence Message"),this.t$k++);mb.start();vb.qsg(1);try{this.D4.WOe(hb,Da).done(()=>{this.NM.rjk();this.Iua.Uja(1,1);c.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}] of type [{2}]",Bb,this.VI,hb);2===hb&&(this.r7g=!0);vb.ubd(1);mb&&(mb.stop(),mb.nv>this.$d.k0l?this.Iua.Uja(1,4):this.Iua.Uja(1,
5))}).fail(sb=>{this.WDd||(this.NM.Wie(),this.Iua.Uja(1,3),this.r7g||2!==hb||c.ULS.sendTraceTag(508651233,500,15,"First persistent state update of type LiveMeeting for [{0}] failed",this.VI),c.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",Bb,Ja.RtcUtils.AIe(sb),this.VI));vb.ubd(2)}).always(()=>{Za&&Za.stop()})}catch(sb){c.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",sb.message),
this.Iua.Uja(1,3),this.r7g||2!==hb||c.ULS.sendTraceTag(508651232,500,15,"First persistent state update of type LiveMeeting for [{0}] hit an exception",this.VI),vb.ubd(2)}return vb}Sfd(hb,Da){hb=Da.Wxm;const Bb=Da.ixb;let Za;try{Za=Ja.RtcUtils.Ddi(hb,this.j2e)}catch(mb){c.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",mb.message);Bb.setException(mb);return}try{this.D4.Sfd(Za).done(()=>{c.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(mb=>
{this.WDd||c.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",Ja.RtcUtils.AIe(mb));Bb.vj(null)})}catch(mb){c.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",mb.message),Bb.vj(null)}}mvb(hb,Da){const Bb=Da.type;hb=Da.Yec;const Za=Da.DDm,mb=Da.ixb;let vb;this.Iua.Uja(0,0);try{vb=Ja.RtcUtils.Ddi(hb,this.j2e)}catch(bc){this.Iua.Uja(0,3);c.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",
bc.message);mb.setException(bc);return}if(2!==this.cec)Za?this.bQh.K(Bb,hb):(this.NM.Wie(),this.Iua.Uja(0,2)),mb.vj(null);else{var sb=this.Qyb.toString();++this.Qyb;Da=new ha(()=>this.vKn(Bb,vb,sb),sb);Da=this.C7l(1,Bb).add(Da);Da.Rrh(bc=>{2===bc&&this.Iua.Uja(0,6);mb.vj(null)});Da.Qrh(()=>{})}}vKn(hb,Da,Bb){let Za=null;const mb=new I,vb=new F;c.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}] of type [{1}]",this.VI,hb);if(2!==this.cec)return this.NM.Wie(),this.Iua.Uja(0,2),
c.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.VI),vb.hSj(),vb;this.Un&&3===hb&&20>this.u$k&&(Za=this.Un.wl("WebServiceCall","Send WetContent Update"),this.u$k++);mb.start();vb.qsg(1);this.D4.mvb(hb,Da).done(()=>{this.NM.rjk();this.Iua.Uja(0,1);c.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}] of type [{2}]",Bb,this.VI,hb);vb.ubd(1);mb&&(mb.stop(),mb.nv>this.$d.k0l?this.Iua.Uja(0,4):this.Iua.Uja(0,
5))}).fail(sb=>{this.WDd||(this.NM.Wie(),this.Iua.Uja(0,3),c.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",Bb,Ja.RtcUtils.AIe(sb),this.VI));vb.ubd(2)}).always(()=>{Za&&Za.stop()});return vb}yFa(){this.D4.JWn(Object(b.a)(this,this.Tyg,"onPresenceUpdated"));this.D4.IWn(Object(b.a)(this,this.Urh,"onPersistentStateUpdated"));this.D4.HWn(Object(b.a)(this,this.L0j,"onPersistentStateCleared"));this.D4.MWn(Object(b.a)(this,this.hAg,"onUpdateNotificationReceived"))}cEm(){this.BHn();
this.Kt.hok(Object(b.a)(this,this.$Bb,"onConnectionStateChanged"));this.Kt.pGn(Object(b.a)(this,this.dRl,"onRefreshProxyRequired"));this.Kt.nGn(Object(b.a)(this,this.bRl,"onRefreshAllPersistentStateRequest"));this.Kt.tGn(Object(b.a)(this,this.mvb,"sendUpdateNotification"));this.Kt.WFn(Object(b.a)(this,this.pQl,"onInternalPresenceUpdated"));this.Kt.XFn(Object(b.a)(this,this.qQl,"onInternalUpdateNotificationReceived"));this.Kt.VFn(Object(b.a)(this,this.oQl,"onInternalPersistentStateUpdated"));this.Kt.UFn(Object(b.a)(this,
this.nQl,"onInternalPersistentStateCleared"));this.Kt.sGn(Object(b.a)(this,this.Gvh,"sendPersistentState"));this.Kt.zGn(Object(b.a)(this,this.Sfd,"updateClientInfo"))}pQl(hb,Da){this.Tyg(Da.hPe,Da.Dol)}Tyg(hb){this.NM.DIg();this.Urh(0,hb)}oQl(hb,Da){this.Urh(Da.type,Da.hPe)}hrn(hb,Da){const Bb={};for(const Za in Da)Bb[Za]=Da[Za].Presence;this.UQl(hb,Bb,Da)}Urh(hb,Da){this.NM.DIg();this.UQl(hb,Da)}UQl(hb,Da,Bb=null){if(c.ULS.T6b(500,100))for(var Za in Da);delete Da[this._clientId];if(!Ta.a.isEmpty(Da)){for(var mb in Da)Za=
mb,Da[Za]=Ja.RtcUtils.deserialize(Da[mb],"Presence",Za,!1,this.j2e);mb=new u.a;Za=(new Date).getTime();for(const sb in Da){var vb=Da[sb];const bc=sb;let yb;Bb?(yb=Bb[bc],yb.Presence=vb):yb=Object.assign(new fa,{Presence:vb,TimeStamp:Za});mb.K(bc,yb)}this.Kt.XWl(hb,mb);switch(hb){case 0:this.v9k||(c.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.VI),this.v9k=!0,m.AFrameworkApplication.Oh&&m.AFrameworkApplication.Oh.Cfn());this.Kt.MWl(Da,[]);break;case 2:this.Mal||
(c.ULS.sendTraceTag(508867081,500,50,"Raising first live meeting update notification for [{0}]",this.VI),this.Mal=!0);this.Kt.LWl(hb,Da);break;default:this.Kt.LWl(hb,Da)}}}nQl(hb,Da){this.L0j(Da.kgi)}L0j(hb){this.NM.DIg();if(c.ULS.T6b(500,100))for(let Da=0;Da<hb.length;++Da);hb.length&&(this.Kt.GCn(hb),this.Kt.pCn(hb),this.Kt.MWl({},hb))}qQl(hb,Da){this.hAg(Da.type,Da.Yec)}hAg(hb,Da=null){this.$d.rOn&&0===hb&&c.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");
if(0===hb&&this.BPh&&0<this.BPh.length){const Bb=ta.a.getInstance({topLevelKpiName:"ContentUpdateNotificationReceived",featureName:"RtcNotification",crewAlias:this.BPh,vetoPillar:"RealTimeCoauth"});Bb&&Bb.logKpiUsage(this.qjm)}this.$d.sOn&&13===hb&&c.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",Da||"<none>"));this.NM.DIg();5===hb?(Da=(hb=this.tun(Da))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",
hb.reason,hb.reconnectDelay):"Received client reconnection request from the server without params.",c.ULS.sendTraceTag(18637071,500,50,Da),this.Kt.Fth(hb)):(Da=Ja.RtcUtils.deserialize(Da,String.format("UpdateNotification-{0}",Ga[hb]),null,!1,this.j2e),this.Kt.FCn(hb,Da))}tun(hb){try{if(!hb||""===hb)return null;const Da=JSON.parse(hb);return new qa(Da[ba.a.Ztk],Da[ba.a.wIn],Da[ba.a.AIn],Da[ba.a.lxk])}catch(Da){return c.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",Da.message),
null}}C7l(hb,Da){return this.Nrd.sUm(this.tUm(hb,Da))}tUm(hb,Da){return hb+","+Da}BHn(){this.Nrd.reset();this.Nrd.FZl(Object(b.a)(this,this.bSl,"onTooManyUndeliveredMessages"))}static eNm(){var hb=new Map;hb.set("SkipAria","True");hb=Object.assign({},{extendedProperties:hb});return{kpiName:"ContentUpdateNotificationReceived",kpiType:Oa.b.FailureBased,optionalProperties:hb,blockFutureEmissionDurationInMs:3E5}}}Object(x.a)(Qa,"RtcMessageHandler",Y,[]);class Pa{Hml(hb,Da=""){return N.createInstance(hb,
Da)}nBm(hb,Da=""){return D.createInstance(hb,Da)}}Object(x.a)(Pa,"ThrottlerFactory",null,[1843]);var ja=a(1533),va=a(495),Ha=a(68);class gb{constructor(hb){this.messageId=hb;this.uKn=(new Date).getTime();this.zsj=new Ha.a}}Object(x.a)(gb,"MessageLatencyDetails",null,[]);class Gb{constructor(hb,Da,Bb){this.E9b=null;this.ANh=this.DSh=0;this.sendMessage=()=>{if(this.e6e){const Za=va.a.create().toString();this.E9b=new gb(Za);this.Kt.Ygk(16,Za,!1,new f.a);window.setTimeout(()=>{this.q$m(Za)},this.ANh)}};
this.mDn=(Za,mb)=>{16===mb.type?this.Kt.Ygk(17,mb.Yec,!1,new f.a):17===mb.type&&this.e6e&&mb.Yec&&this.processMessage(mb.Yec)};this.$d=Da;this.U9k=Bb;this.e6e=!1;this.Kt=hb;this.Kt.Zmc(this.mDn)}start(){if(this.U9k&&!this.e6e){const hb=this.$d.p0l;this.ANh=this.$d.l0l;hb<=this.ANh?(c.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",
this.$d.p0l,this.$d.l0l),this.U9k=!1):(this.e6e=!0,this.DSh=window.setInterval(this.sendMessage,hb))}}q$m(hb){this.E9b&&this.E9b.messageId===hb&&(0<this.E9b.zsj.count?(hb=this.E9b.zsj.toArray().join(","),c.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",hb)):c.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.E9b=null)}stop(){this.DSh&&(window.clearInterval(this.DSh),this.e6e=!1)}processMessage(hb){hb&&this.E9b&&hb.toString()===this.E9b.messageId&&this.E9b.zsj.add((new Date).getTime()-
this.E9b.uKn)}static get instance(){return Gb.Wa}static $Qm(hb,Da,Bb){return Gb.instance||(Gb.Wa=new Gb(hb,Da,Bb))}}Gb.Wa=null;Object(x.a)(Gb,"ClientToClientMessageTelemetry",null,[]);class Mb{constructor(hb,Da,Bb,Za,mb,vb,sb,bc,yb,uc,vc,wc){this.iUh=!1;this.nVa=null;this.dHa=new u.a;this.hVe=1;this.M8a=null;this.gla=!1;this.MMh=(new Date(0)).getTime();this.Ybl=0;this.j6l=()=>{const ub=this.hVe;this.iUh=!1;this.NM.Oth();this.q2c.sUi(this.dzm,this.UPl,Object(b.a)(this.PVc,this.PVc.F1m,"initThrottlerManager"),
Object(b.a)(this,this.uPe,"verifyConnectionToken"),ub)};this.UPl=(ub=null)=>{this.NM.Pth();let aa=null;!ub||"documentsessiondeleted"!==(aa=ub.toLowerCase())&&"documentsessionexpired"!==aa?this.Tqf():(c.ULS.sendTraceTag(508396225,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.VI,ub),this.disconnect())};this.Tqf=(ub,aa=null)=>{c.ULS.sendTraceTag(508396224,500,50,"Disconnecting the connection [{0}]",this.nVa);ub=(ub=
2===this.oVa||1===this.oVa)&&!this.PVc.WDd;let Na=!0,ia=0;aa&&Object.getType(aa)!==Object.getType(Sys.EventArgs.Empty)&&aa.Bqk&&""!==aa.Bqk&&(ub=!0,this.q2c.lCk(aa.Bqk),Na=aa.lxk,ia=aa.reconnectDelay);ub&&this.$Bb(1,this.oVa);++this.hVe;this.PVc.yFa();this.GSn(Na);this.q2c.Rvi();this.Mml();ub&&window.setTimeout(this.j6l,Math.min(ia,3E4))};this.u9l=()=>{let ub=null;const aa=({correlationId:ub}=this.q2c.qhh()).returnValue;this.M8a.qs=aa;c.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",
this.VI,ub)};this.dzm=ub=>{this.MMh=(new Date).getTime();let aa=null;this.M8a.qs=({correlationId:aa}=this.q2c.qhh()).returnValue;this.$d.Erm&&(this.M8a.url=ub,ja.a.instance&&(ja.a.instance.bll=l.a.aN(ub)));let Na=null;this.Un&&(Na=this.Un.wl("WebServiceCall","ConnectToServer"));c.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.VI);ub={};this.$$g&&(ub.transport=1===this.$$g.length?this.$$g[0]:this.$$g);ub.pingInterval=null;r.a.instance.BIg(1,0);ub.waitForPageLoad=!1;this.M8a.start(ub,
null).done(ia=>{this.NM.Wik();r.a.instance.BIg(1,1,!0);c.ULS.sendTraceTag(508396195,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",ia.id,aa)}).fail(ia=>{c.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",this.q2c.W7,aa,this.VI);this.UPl();this.NM.jXl(ia);r.a.instance.BIg(1,1,!1);this.Kt.SWl(0,{["CorrelationId"]:aa,["ErrorDetails"]:ia,["ConnectionState"]:h.a[this.oVa]})}).always(()=>
{Na&&Na.stop();ja.a.instance&&(ja.a.instance.sIh=!1)})};this.iSl=(ub,aa)=>{for(const Na of aa.MYn)this.dHa.Ob(Na.key)||this.dHa.K(Na.key,new y.a),ub=Na.value,this.dHa.ha(Na.key).K(aa.type,new w(ub.Presence,new Date(ub.TimeStamp))),Na.key===this._clientId&&0===aa.type&&this.Kt.lCn(ub.Presence)};this.hSl=(ub,aa)=>{for(const Na of aa.kgi)this.dHa.remove(Na)};this.Efi=()=>{let ub;const aa=[];({value:ub}=this.dHa.Uh(this._clientId)).returnValue&&this.dHa.remove(this._clientId);for(const Na of this.dHa.keys)Array.add(aa,
Na);for(const Na of aa)this.dHa.remove(Na);ub&&this.dHa.K(this._clientId,ub);this.Kt.jCn(aa)};this._clientId=hb;this.$$g=Da;this.oVa=0;this.Un=Za;this.kGh=bc;this.ylm=sb;this.ffm=yb;this.vgm=mb;this.q2c=vb;this.VI=Bb;this.NM=uc;this.$d=vc;this.$m=wc;this.cmm=1>100*Math.random()}get X_b(){return this.q2c.X_b}set X_b(hb){this.q2c.X_b=hb}get PVc(){return this.ylm}get Kt(){return this.ffm}init(){this.Kt.Eqm(this.Tqf);this.Kt.Yqm(this.iSl);this.Kt.Xqm(this.hSl);this.$m.DJb(this.NM);m.AFrameworkApplication.Mba(()=>
{this.NM.ujk();ja.a.instance&&ja.a.instance.yxj()});this.Mml();this.UEm();this.Kt.ofl(this.u9l)}UEm(){try{const Bb=$.signalR;if(!Bb)throw Error.invalidOperation("Failed to retrieve Signalr object");const Za=Bb.version;if(!Za)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===Za){var hb=Bb.transports;if(!hb)throw Error.invalidOperation("Failed to retrieve transports object");var Da=hb.longPolling;if(!Da)throw Error.invalidOperation("Failed to retrieve longPolling object");
if(!Da.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");Da.supportsKeepAlive=this.dCm()}}catch(Bb){c.ULS.sendTraceTag(508396227,500,15,"Failed to disable longPolling KeepAlives: {0}",Bb.message)}}dCm(){return()=>!1}Mml(){const hb=++this.hVe;this.MMh=(new Date(0)).getTime();this.M8a=this.vgm();this.Kt.rCn(this.M8a);this.M8a.stateChanged(Da=>{this.Son(Da,hb)});this.M8a.connectionSlow(Object(b.a)(this,this.vsn,"onSlowConnection"));this.M8a.error(Object(b.a)(this,
this.ksn,"onSignalRError"));this.M8a.log=Object(b.a)(this,this.lsn,"onSignalRLog")}uPe(hb,Da){return hb!==this.hVe?(c.ULS.sendTraceTag(508396226,500,50,"ConnectionToken verification failed for {0}",Da),!1):!0}connect(){2!==this.oVa&&1!==this.oVa&&(c.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.VI),this.kGh.Pon(),r.a.instance.jSn(),this.$Bb(1,this.oVa),this.j6l())}disconnect(){0===this.oVa?c.ULS.sendTraceTag(508396194,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",
this.VI):(this.NM.lXl(),ja.a.instance&&(ja.a.instance.sIh=!0),c.ULS.sendTraceTag(508396193,500,50,"Starting explicit disconnect for [{0}]",this.VI),this.PVc.WDd=!0,this.kGh.tpn(),this.$Bb(0,this.oVa),this.Tqf(),this.PVc.WDd=!1)}GSn(hb){const Da=this.iwm(),Bb=this.M8a,Za=this.nVa,mb=()=>{if(this.iUh)c.ULS.sendTraceTag(508396191,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.iUh=!0,Bb.stop(!0,hb)}catch(vb){c.ULS.sendTraceTag(508396192,500,15,"Stopping connection failed: {0}",
vb.message)}};0<Da?(c.ULS.sendTraceTag(508396190,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",Za,Da),window.setTimeout(mb,Da)):(c.ULS.sendTraceTag(508396189,500,50,"Stopping connection [{0}].",Za),mb())}iwm(){let hb=0;0===this.M8a.state&&(hb=this.MMh+Mb.O_n-(new Date).getTime(),0>hb&&(hb=0));return hb}get connectionState(){return this.oVa}Otd(hb){this.Kt.Otd(hb)}hok(hb){this.Kt.hok(hb)}Oxk(hb){return this.Gvh(0,hb)}Gvh(hb,Da){const Bb=new f.a;this.Kt.UWl(hb,Da,Bb);return Bb.task}$ah(hb){this.Kt.$ah(hb)}NQb(hb){return this.SUm(hb)}Kgh(){return this.JLm()}JLm(){const hb=
{};for(const Da of this.dHa)Da.value.Ob(0)&&(hb[Da.key]=Da.value.ha(0).data);return hb}SUm(hb){return this.dHa.Ob(hb)&&this.dHa.ha(hb).Ob(0)?this.dHa.ha(hb).ha(0).data:null}ILm(){const hb=new y.a;if(!this.dHa.Ob(this._clientId))return hb;for(const Da of this.dHa.ha(this._clientId))hb.K(Da.key,Da.value.data);return hb}mvb(hb,Da=null,Bb=!1){const Za=new f.a;this.Kt.Ygk(hb,Da,Bb,Za);return Za.task}Zmc(hb){this.Kt.Zmc(hb)}JQm(){return this.x_a(this._clientId)}x_a(hb){let Da,Bb;return({value:Da}=this.dHa.Uh(hb)).returnValue&&
({value:Bb}=Da.Uh(0)).returnValue?new n(this.TUm(Bb),Bb.timeStamp):null}PLm(){const hb={};for(const Da of this.dHa)Da.value.Uh(0).returnValue&&(hb[Da.key]=this.x_a(Da.key));return hb}Sfd(hb){const Da=new f.a;this.Kt.ECn(hb,Da);return Da.task}get clientId(){return this._clientId}get QQn(){return this.cmm}dispose(){var hb;if(!this.gla){if(null===(hb=m.AFrameworkApplication.ga)||void 0===hb?0:hb.getBooleanAppSetting("DetachRtcEventHandlerOnDispose"))this.bEm(),this.PVc.cEm();this.PVc.yFa();this.$m.QCb(this.NM);
this.NM.ujk();ja.a.instance&&ja.a.instance.yxj();this.gla=!0}}Son(hb,Da){this.uPe(Da,"StateChangedSignalR")&&this.$Bb(this.Hll(hb.newState),this.Hll(hb.oldState))}$Bb(hb,Da){if((1!==this.oVa||0!==Da||1!==hb)&&this.oVa!==Da){var Bb=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.oVa,Da,hb]));c.ULS.sendTraceTag(508396188,500,10,Bb)}if(this.oVa!==hb){switch(hb){case 2:ja.a.instance&&ja.a.instance.Efn();
this.nVa=this.M8a.id;c.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.nVa,this.VI);this.gan(this.M8a);c.ULS.sendTraceTag(508396186,500,50,"Retrieving complete session state");Bb=null;this.Un&&(Bb=this.Un.wl("WebServiceCall","Receive First Presence"));const Za=this.hVe;this.Kt.qCn(Object(b.a)(this,this.uPe,"verifyConnectionToken"),Za,this.kGh,this.Efi,this.ILm(),Bb);this.$d.xIn&&Gb.$Qm(this.Kt,this.$d,100*Math.random()<=this.$d.yIn).start();break;case 1:2===Da&&
c.ULS.sendTraceTag(508396185,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.nVa);break;case 0:if(Gb.instance&&Gb.instance.stop(),this.PVc.WDd)c.ULS.sendTraceTag(508396182,500,50,"Connection [{0}] has been explicitly closed",this.nVa);else{1===Da&&(c.ULS.sendTraceTag(508396184,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.nVa),this.NM.wIg());2===Da&&c.ULS.sendTraceTag(508396183,
500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.nVa);this.Tqf();return}}this.oVa=hb;this.Kt.fCn(hb,Da)}}bEm(){this.Kt.oGn(this.Tqf);this.Kt.BGn(this.iSl);this.Kt.AGn(this.hSl);this.Kt.vGn(this.u9l)}gan(hb){if(hb&&hb.transport&&hb.transport.name){hb=hb.transport.name;var Da=hb.toLowerCase();"websockets"===Da?c.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",hb,this.VI):"serversentevents"===
Da?c.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",hb,this.VI):"foreverframe"===Da?c.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",hb,this.VI):"longpolling"===Da?c.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",hb,this.VI):"mocktransport"!==Da&&c.ULS.sendTraceTag(508396180,500,15,"Unknown transport protocol encountered - '{0}'",hb)}else c.ULS.sendTraceTag(508396181,500,10,"Transport protocol name is missing")}vsn(){if(this.$d.m0l){const hb=l.a.NV(this.X_b,
"mid");c.ULS.sendTraceTag(508396178,500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.nVa,hb)}else c.ULS.sendTraceTag(508396177,500,50,"Detected that the connection [{0}] is slow",this.nVa)}ksn(){c.ULS.sendTraceTag(508396176,600,15,"SignalR ERROR for connection [{0}];",this.nVa)}lsn(hb){hb=a(706).RtcUtils.AIe(hb);if(this.$d.m0l&&hb.startsWith("Keep alive timed out.")){const Da=l.a.NV(this.X_b,"mid");c.ULS.sendTraceTag(508396175,500,15,"SignalR lib: {0}. Target Machine: {1}",
hb,Da)}else this.QQn&&2E3>this.Ybl&&!hb.startsWith("Invok")&&!hb.startsWith("Trigger")&&(c.ULS.sendTraceTag(508396174,500,50,"SignalR lib: {0}",hb),this.Ybl++)}Hll(hb){switch(hb){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",hb,"Unknown SignalR state");}}TUm(hb){return hb&&hb.timeStamp?(new Date).getTime()-hb.timeStamp.getTime()>(this.$d.Xbh?6E4:this.$d.h5c)?2:1:1}static createInstance(hb,Da,Bb,Za,mb,vb,sb,bc=null,yb=null,uc=null,vc,
wc=null,ub=null){return Mb.RAm(hb,Da,Bb,ub,Za,mb,vb,sb,bc,yb,uc,wc)}static RAm(hb,Da,Bb,Za,mb,vb,sb,bc,yb=null,uc=null,vc=null,wc=null){const ub=A.createInstance(m.AFrameworkApplication.ga),aa=m.AFrameworkApplication.buildVersion?m.AFrameworkApplication.buildVersion:"1.0",Na=Mb.zHi(hb,Da,sb),ia=ub.Xxm?a(1628).RealtimeChannelMetrics.createInstance(Na):new O;var wa=ja.a.create(mb);ub.CIn&&wa.iSn(ub.BIn);var pa="";pa=yb&&""!==yb?yb:"/rtc2/";wa.dsl=l.a.aN(pa);const Ea=pa+"signalr";yb=pa+"findsession";
const La=W.v0m;pa=new Pa;vc=vc||P.a.getInstance();c.ULS.shipAssertTag(508396228,500,ub.n0l<=z.a.wNl,"Client attempting to override max payload size beyond absolute limit");const Aa=Math.min(ub.n0l,z.a.wNl);wa.vNl=Aa;wa=new Qa(ub,new U(pa),hb,Na,nb=>new K(nb.createHubProxy(La)),bc,vc,ia,wa,Aa);uc||(uc=a(1529).FindSessionStrategy.createInstance(Da,mb,yb,bc,aa,sb,hb,Na,vc,vb,Za,wc));uc.oxf=ub.oxf;Da=new L(Na);Bb=Bb?Bb.split(","):null;hb=new (a(1636).RealtimeChannel)(hb,Bb,Na,bc,()=>$.hubConnection(Ea),
uc,wa,Da,vc,ia,ub,mb);hb.init();return hb}static zHi(hb,Da,Bb){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",hb,this.Jhf(e.a[Bb]),this.Jhf("browser"),Da)}static Jhf(hb){return hb?hb.charAt(0).toLocaleUpperCase()+hb.substring(1,hb.length):hb}}Mb.O_n=15E3;Object(x.a)(Mb,"RealtimeChannel",null,[1356,1355])},1638:function(x,G,a){a.d(G,"a",function(){return K});x=a(0);var c=a(17),b=a(530),f=a(531),e=a(40);class h{static $Li(P,V,Y){return h.aMi(P,V,Y,!0)}static aMi(P,V,Y,ta){const fa=
document.createElementNS(h.Mve,"svg");fa.setAttribute("viewBox",String.format(h.Tri,h.Q5g,h.P5g));fa.appendChild(h.lXi(P,V,Y,ta));return fa}static lXi(P,V,Y,ta){const fa=h.Q5g/P,Ta=V/2*fa,ha=h.P5g/2;let qa=0;ta&&(qa=(P-3*V-4*Y)*fa/2);P=document.createElementNS(h.Mve,"g");Sys.UI.DomElement.addCssClass(P,h.Sri);for(ta=1;3>=ta;ta++)P.appendChild(h.iKi(ta,Ta,qa+(ta*(V+Y)-V/2)*fa,ha));return P}static iKi(P,V,Y,ta){const fa=document.createElementNS(h.Mve,"circle");Sys.UI.DomElement.addCssClass(fa,String.format("{0}-{1}",
h.cfi,P));fa.setAttribute("cx",String.format("{0}",Y));fa.setAttribute("cy",String.format("{0}",ta));fa.setAttribute("r",String.format("{0}",V));return fa}}h.Mve="http://www.w3.org/2000/svg";h.Sri="prDancingDots";h.cfi="prAnimateCircle";h.Tri="0 0 {0} {1}";h.P5g=40;h.Q5g=120;Object(x.a)(h,"ModernPresenceTooltipDancingDots",null,[]);var u=a(4),m=a(47),n=a(135),l=a(3),r=a(366),w=a(71),y=a(22),z=a(5),A=a(46);class B extends b.a{constructor(P,V){super(P);this.g8e=this.gGa=this.nid=this.Lua=this.uua=this.nI=
this.wu=null;this.Qla=V.get(8,!1);this.bGa=V.get(6,0);this.kWh=V.get(15,!1);this.$d=V;this.iXe=0;this.element=P;this.element.className=B.jFd;this.mQ=document.createElement("span");this.element.appendChild(this.mQ);this.WHh=h.$Li(V.get(6,0),4,2);this.OO(V);this._state=5}nSa(P){this.addHandler(f.a.xI,P)}d6a(P){this.removeHandler(f.a.xI,P)}get user(){return this.g8e}get state(){return this._state}dispose(){this.element&&(this.wu.jc(l.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.wu.jc(l.a.doubleClick,
this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")),this.nI.jc(l.a.TH,this.element,Object(e.a)(this,this.rta,"onPointerDown")),this.nI.jc(l.a.AR,this.element,Object(e.a)(this,this.O3,"onPointerOut")),this.nI.jc(l.a.KP,this.element,Object(e.a)(this,this.P3,"onPointerOver")),this.uua.jc(this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}OO(P){this.wu=P.get(10);this.wu.Zb(l.a.click,this.element,Object(e.a)(this,this.onClick,
"onClick"));this.wu.Zb(l.a.doubleClick,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior"));this.nI=P.get(9);this.nI.Zb(l.a.KP,this.element,Object(e.a)(this,this.P3,"onPointerOver"));this.nI.Zb(l.a.AR,this.element,Object(e.a)(this,this.O3,"onPointerOut"));this.nI.Zb(l.a.TH,this.element,Object(e.a)(this,this.rta,"onPointerDown"));this.uua=P.get(13);this.uua.Zb(this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior"))}hide(P=null,V=0,Y=0){this.kWh&&
P?this.vIk(P,V,Y):(3===this.state&&this.VJg(),this.visible=!1,this._state=5)}vIk(P,V,Y=0){this.show(P,V,15,4,void 0,Y)}sUg(P,V,Y,ta=!1,fa=!1,Ta=!1,ha=0){this.show(P,V,Y+20,ta?2:fa?1:0,Ta,ha)}aIk(P,V,Y,ta=!1,fa=0){this.show(P,V,Y+20,3,ta,fa)}show(P,V,Y,ta=3,fa=!1,Ta=0){!P||ta===this.state&&this.r7i(V,Y)||(this.TXh(ta,fa,Ta),this.h0(P,ta,Ta),this._state=ta,4===Ta||0===Ta&&!this.Qla?this.element.style.left=V+"px":this.element.style.right=V+"px",this.element.style.top=Y+"px",this.visible=!0)}h0(P,V,Y){this.g8e=
P;y.a.wx(this.mQ);w.a.fkl(this.mQ);this.mQ.id="fly_"+P.clientId;this.mQ.style.backgroundColor=P.color;4!==V?(this.mQ.style.height=this.bGa+"px",this.mQ.style.lineHeight=this.bGa+"px",w.a.Eka(this.mQ,"border-radius",this.bGa+"px")):4===Y||0===Y&&!this.Qla?this.mQ.style.left="0px":this.mQ.style.right="0px";2!==V&&(4===V?y.a.SA(this.mQ,""):1===V?this.mQ.appendChild(this.WHh):(this.mQ.setAttribute("dir","auto"),Y=z.a.Chh(P.userName,!1),(!P.isAnonymous||u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",
!1))&&Y||0!==V?(P=P.userName,0===V&&(P=Y,w.a.Eka(this.mQ,"text-align","center")),y.a.SA(this.mQ,P)):(this.Lua||(this.Lua=this.wmi()),this.mQ.appendChild(this.Lua),w.a.Eka(this.mQ,"text-align","start"))))}onClick(P){if(0===this.state)return this.raiseEvent(f.a.xI,new f.a(1,P)),!0;3===this.state&&c.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}O3(P){3===this.state&&this.raiseEvent(f.a.xI,new f.a(3,P));return!1}P3(P){3!==P.yg&&this.raiseEvent(f.a.xI,new f.a(2,P));return!1}rta(P){if(3!==
P.yg)return!0;this.raiseEvent(f.a.xI,new f.a(4,P));return!1}wmi(){const P=document.createElement("img");P.src=m.a.mX("doughperson_white_glyph.svg");P.setAttribute("Unselectable","on");r.a.Uia(P,r.a.pi,r.a.KZ);return n.c(this.bGa,this.bGa,null,null,B.WFi,"",!1,"",this.element.ownerDocument,P)}TXh(P,V=!1,Y=0){if(!this.zSb(this.state)||!this.zSb(P))switch(Sys.UI.DomElement.removeCssClass(this.element,this.nid),this.state){case 4:3===P?this.yva(B.kFd,B.qyf):this.zSb(P)&&this.yva(B.iFd,B.qyf);break;case 3:4===
P?this.yva(B.mFd,B.pyf):this.zSb(P)&&(V&&this.VJg(),this.yva(B.iFd,B.pyf,V?B.VFi:""));break;case 0:case 1:case 2:4===P?this.yva(B.mFd,B.lFd):3===P&&(V&&this.NYh(),this.yva(B.kFd,B.lFd,V?B.ryf:"",3===Y?B.YFi:B.XFi));break;default:4===P?this.yva(B.mFd):3===P?this.yva(B.kFd):this.zSb(P)&&this.yva(B.iFd)}}yva(...P){this.nid=P.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.nid)}NYh(){this.iXe=window.setTimeout(()=>{this.element&&(this.gGa=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.gGa),
this.element.style.zIndex="2",this.gGa.style.zIndex="1")},300)}VJg(){window.clearTimeout(this.iXe);this.gGa&&(Sys.UI.DomElement.removeCssClass(this.gGa,B.lFd+" "+B.ryf),Sys.UI.DomElement.addCssClass(this.gGa,B.UFi),A.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.gGa.parentNode&&this.element.parentNode.removeChild(this.gGa)}),w.a.tLe(this.element,"z-index"))}zSb(P){return 0===P||1===P||2===P}r7i(P,V){const Y=w.a.oka(this.element.style.top);return w.a.oka(this.element.style.left)===
P&&Y===V}zke(P){3===P&&w.a.Uva(this.element,"left")?(P=w.a.oka(this.element.style.left),w.a.tLe(this.element,"left"),this.element.style.right=-1*P+"px"):4===P&&w.a.Uva(this.element,"right")&&(P=w.a.oka(this.element.style.right),w.a.tLe(this.element,"right"),this.element.style.left=-1*P+"px")}}B.jFd="prModernFlyout UIFont";B.mFd="flyoutIdle";B.kFd="flyoutExpanded";B.iFd="flyoutCollapsed";B.qyf="flyoutFromIdle";B.pyf="flyoutFromExpanded";B.lFd="flyoutFromCollapsed";B.ryf="flyoutStacked";B.VFi="flyoutFromStacked";
B.UFi="flyoutFadeOut";B.WFi="cui-img-cont-float cui-img-20by20";B.XFi="flyoutLtrDir";B.YFi="flyoutRtlDir";Object(x.a)(B,"ModernPresenceTooltipFlyoutControl",b.a,[]);class H{constructor(P,V,Y=2,ta=4){this.offsetTop=P;this.offsetLeft=V;this.G5g=Y;this.CMf=ta}}Object(x.a)(H,"FlyoutsPositioningInfo",null,[]);var v=a(26);class C{constructor(P=!1,V=!1){this.Ooe=!1;this.Ym=P;this.lkd=V;this.Ooe=u.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO:9192023_CalculateFlyoutDirectionsToHandleRTLScenarios")}GPi(P,
V,Y,ta,fa,Ta,ha){const qa=ha.y,ra=ha.height;var I=this.xJi(Ta);const ba=I+V;fa=P*Y+(P-1)*fa;Y=null;1===P||this.$bi(I,fa,qa,ra)?P=new H(0,0,2):(P=this.VEi(ba,fa,qa,ra),P.offsetTop-=I);this.lkd?Y=new H(0,0,void 0,this.Ym?4:3):(Ta=this.wJi(Ta,ha),I=Math.max(0,ha.x),ha=ha.width,V=Ta+V,this.Ooe?Y=this.eci(Ta,ta,I,ha):this.aci(Ta,ta,I,ha)?Y=new H(0,0,void 0,this.Ym?3:4):this.bci(V,ta,I)&&(Y=new H(0,0,void 0,this.Ym?4:3)),Y||(Y=this.UEi(Ta,V,I,ha)));return new H(P.offsetTop,Y.offsetLeft,P.G5g,Y.CMf)}xJi(P){return v.a.jAf(P)}wJi(P,
V){return this.Ym?this.Ooe?v.a.Sgh(P)-v.a.Ptl(P):V.width-v.a.Sgh(P):v.a.iAf(P)}$bi(P,V,Y,ta){return P+V<=Y+ta}VEi(P,V,Y,ta){let fa=1,Ta=Math.max(Y,P-V);V>P-Y&&(fa=2,Ta=V<ta?ta-V:Y);return new H(Ta,0,fa)}eci(P,V,Y,ta){const fa=this.cci(P,V,Y);P=this.dci(P,V,Y,ta);if(fa||P)return new H(0,0,void 0,this.Ym?fa?3:4:P?4:3)}aci(P,V,Y,ta){return P+V<=Y+ta}bci(P,V,Y){return V<=P-Y}dci(P,V,Y,ta){return P+V<=Y+ta}cci(P,V,Y){return Y<=P-V}UEi(P,V,Y,ta){ta-V>=P-Y?P=4:(V=P,P=3);return new H(0,V,void 0,P)}}Object(x.a)(C,
"ModernPresenceTooltipPositioner",null,[]);class F{constructor(P,V,Y,ta,fa,Ta,ha){this.MW=P;this._parent=V;this.aVe=Y;this.$Fh=ta;this.hKh=fa;this.nfb=Ta;this.Qla=ha;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(P,V){if(3!==P)if(5!==P&&this.MW&&this.MW.length){if(4===P){var Y=this.hKh;var ta=(this.nfb-Y)/2;this.element.style.height=this.nfb+"px";this.element.style.width=this.nfb+"px";P=w.a.oka(this.MW[0].element.style.top);
V=w.a.oka(this.Qla?this.MW[0].element.style.right:this.MW[0].element.style.left)}else Y=this.aVe,ta=(this.nfb-Y)/2,this.element.style.height=this.nfb+"px",this.element.style.width=this.CKi()+2*ta+"px",P=w.a.oka(this.MW[this.MW.length-1].element.style.top),V=this.ubi(this.MW[this.MW.length-1].element,Y,V);w.a.Eka(this.element,"border-radius",this.nfb+"px");this.element.style.top=P-ta-Y+"px";this.Qla?this.element.style.right=V-ta+"px":this.element.style.left=V-ta+"px";this.element.parentNode||this._parent.insertBefore(this.element,
this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}ubi(P,V,Y){return this.Qla&&!Y?w.a.oka(P.style.right):this.Qla||Y?this.Qla&&Y?-w.a.oka(P.style.left)-V:-w.a.oka(P.style.right)-V:w.a.oka(P.style.left)}CKi(){return this.MW&&this.MW.length?this.aVe+Math.min(this.MW.length-1,2)*this.$Fh:0}}Object(x.a)(F,"ModernPresenceTooltipTarget",null,[]);var D=a(51),N=a(53),U=a(94);class W extends b.a{constructor(P,V,Y){super(P);this.Geb=this.tla=this.FZe=this.KVa=
!1;this.Fm=[];this.iia=(ta,fa)=>{ta=this.fRa;this.s8h()||2!==fa.type&&(4!==fa.type||3===ta)?4===fa.type&&3===ta?(this.tla&&(this.tla=!1),this.hyd()):3!==fa.type||3!==ta||this.KVa||(1<this.Lwa?(this.tla=!0,A.Task.delay(250).continueWith(()=>{this.tYa(!0);this.tla=!1})):this.hyd()):(this.tla&&(this.tla=!1),3!==ta&&(this.svf(),3===fa.$g.yg&&this.hyd(2E3)));this.raiseEvent(f.a.xI,fa)};this.Vrb=ta=>{3===ta.yg?this.iia(this,new f.a(4,ta)):ta.eventName===l.a.KP?this.iia(this,new f.a(2,ta)):ta.eventName===
l.a.AR&&this.iia(this,new f.a(3,ta));return!1};this.$hc={};this.$d=Y;this.Ym=Y.get(8,!1);this.XYe=Y.get(15,!1);this.bHh=Y.get(12,0);this.fIa=Y.get(6,0);this.$kc=V;this.w8e=Y.get(16);this.lkd=Y.get(17,!1);this.jKh=Y.get(19,!1);this.qQh=Y.get(20,!1);this.Oic=0;this.pQh=new C(this.Ym,this.lkd);this.bEb=this.TBf();this.gpd=!1;this.hua=[];this.eGb=[];this.element.id=W.XFd();this.element.className=b.a.GAe("prControl",this.Ym);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Ym;this.Dme(V);
this.Qda=this.createElement("div");this.Qda.className="prFlyoutContainer";this.element.appendChild(this.Qda);this.MW=[];this.oGa=new F(this.JQ,this.element,this.fIa,4,6,32,this.Ym);this.nI=Y.get(9);this.nI.Zb(l.a.TH,this.oGa.element,this.Vrb);this.nI.Zb(l.a.KP,this.oGa.element,this.Vrb);this.nI.Zb(l.a.AR,this.oGa.element,this.Vrb)}get DKe(){return U.a.clone(this.Fm)}get JQ(){return this.MW}get defaultZIndex(){return this.bHh}get Lwa(){return this.JQ?this.JQ.length:0}get fRa(){return 0<this.Lwa?this.JQ[0].state:
5}get zSd(){return 3===this.fRa&&!this.KVa}nSa(P){this.addHandler(f.a.xI,P)}d6a(P){this.removeHandler(f.a.xI,P)}dispose(){if(this.zSd)this.gpd=!0;else{if(this.JQ)for(const P of this.JQ)P.d6a(this.iia),N.a.lE(P);this.MW=null;this.nI.jc(l.a.TH,this.oGa.element,this.Vrb);this.nI.jc(l.a.KP,this.oGa.element,this.Vrb);this.nI.jc(l.a.AR,this.oGa.element,this.Vrb);super.dispose()}}rDb(){this.tYa();this.visible=!0}Zoe(){this.visible=!0;this.svf();this.KVa=!0}Cec(){this.Zoe()}hide(){this.lKg();this.Ixa();this.oGa.update(this.fRa,
this.Geb)}h0(P){const V=this.fRa,Y=this.KVa;P.clientId||(P.clientId=(W.kGb++).toString());if(P.clientId in this.$hc){var ta=this.JJa(P.clientId);if(0<=ta){ta=this.Fm[ta];if(ta.color===P.color&&ta.userName===P.userName)return;this.Bqa(P.clientId)}}this.hide();ta=new B(this.createElement("div"),this.$d);ta.nSa(this.iia);this.Qda.insertBefore(ta.element,this.Qda.firstChild);this.$hc[P.clientId]=ta;Array.add(this.Fm,P);Array.add(this.JQ,ta);this.v4g(V,Y);this.visible=!0}Bqa(P){if(this.zSd)Array.add(this.eGb,
P);else{var V=this.fRa,Y=this.KVa;this.hide();this.P4b(P);this.v4g(V,Y)}}V9d(P){const V=this.JJa(P);if(!(0>=V)){var Y=this.Fm[V];P=this.$hc[P];Array.removeAt(this.Fm,V);Array.insert(this.Fm,0,Y);Array.removeAt(this.JQ,V);Array.insert(this.JQ,0,P);this.Qda.removeChild(P.element);this.Qda.appendChild(P.element);this.tYa()}}v4g(P,V){0>=this.Fm.length?this.hide():3===P&&V?this.Zoe():this.rDb()}Dne(P,V){V?this.BXh(P):this.LJg(P)}Xuf(P){if(this.zSd&&this.jKh)return!1;P=W.JJd(P);if(this.Qda!==P&&y.a.RAb(this.Qda,
P))return!0;for(const V of this.JQ)if(y.a.RAb(V.element,P))return!0;return!1}position(P,V){this.element.style.top=V+"px";this.element.style.left=P+"px"}tYa(P=!1){if(!P||this.tla){this.FZe&&this.SRg(!0);var V=Math.min(3,this.Lwa)-1;P=0;var Y=1,ta=0;this.Geb&&(P=this.bEb,Y=-1,ta=-this.fIa);for(let fa=this.Lwa-1;fa>V;fa--)this.JQ[fa].sUg(this.Fm[fa],-4*V*Y+ta,0,!0,!1,!0,P);for(;0<=V;V--)this.JQ[V].sUg(this.Fm[V],-4*V*Y+ta,0,0<V,Array.contains(this.hua,this.Fm[V].clientId),V!==this.Oic,P);this.Oic=0;
this.oGa.update(0,this.Geb);this.zIndex=this.defaultZIndex;this.KVa=!1;this.lKg(0);this.gpd&&this.dispose()}}svf(){this.FZe&&this.SRg(!1);this.zIndex=this.defaultZIndex+1;const {offsetX:P,offsetY:V,BMf:Y}=this.MAk();for(let ta=0;ta<this.Lwa;ta++)this.JQ[ta].aIk(this.Fm[ta],P,V+(this.fIa+2)*ta,ta!==this.Oic,Y)}Ixa(){let P=0,V=0;this.Geb&&(P=this.bEb,V=-6);for(let Y=0;Y<this.Lwa;Y++)this.JQ[Y].hide(this.Fm[Y],V,P);this.zIndex=this.defaultZIndex;this.visible=this.KVa=!1;this.gpd&&this.dispose()}hyd(P=
0){P?(this.tla=!0,A.Task.delay(P).continueWith(()=>{this.XYe?this.u8i():this.tYa(!0);this.tla=!1})):this.XYe?this.hide():this.tYa()}u8i(){this.tla&&this.hide()}s8h(){if(u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.lga&&D.c()){const P=appChrome.selectors.getShyState();return P.isActive&&0!==P.state}return!1}Dme(P){this.element.style.width=P+"px";this.element.style.height=this.fIa+"px"}P4b(P){this.LJg(P);P=this.JJa(P);if(!(0>P)){var V=this.Fm[P];Array.removeAt(this.Fm,P);delete this.$hc[V.clientId];
V=this.JQ[P];this.Qda.removeChild(V.element);this.$d.get(18,!1)&&V.d6a(this.iia);Array.removeAt(this.JQ,P);V.dispose()}}lKg(P=5){if(this.eGb.length){this.visible&&this.Ixa();for(let V=0;V<this.eGb.length;V++)this.P4b(this.eGb[V]);Array.clear(this.eGb);0>=this.Fm.length||5===P?this.hide():0===P&&this.rDb()}}JJa(P){for(let V=0;V<this.Fm.length;V++)if(this.Fm[V].clientId===P)return V;return-1}BXh(P){if(-1===this.JJa(P))c.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");
else{if(Array.contains(this.hua,P)){if(this.Fm[0].clientId===P)return;Array.remove(this.hua,P)}Array.add(this.hua,P);this.V9d(P);1!==this.fRa&&this.tYa()}}LJg(P){-1===this.JJa(P)?c.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.hua,P)&&(Array.remove(this.hua,P),this.Fm[0].clientId===P&&0<this.hua.length&&this.V9d(this.hua[this.hua.length-1]),this.Fm[0].clientId===P&&1===this.fRa&&this.tYa())}SRg(P){P?Sys.UI.DomElement.addCssClass(this.Qda,
"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.Qda,"prBackgroundSelection")}MAk(){let P,V;V=P=0;var Y=this.bEb;if(this.w8e){const ta=this.w8e(this);if(!ta)return{offsetX:P,offsetY:V,BMf:Y};const fa=4===this.fRa;Y=this.pQh.GPi(this.Lwa,fa?6:this.fIa,this.fIa,150,2,this.element,ta);V=Y.offsetTop;this.Oic=this.ePi(Y.G5g,Y.offsetTop);Y=Y.CMf;Y!==this.bEb&&(this.zke(Y),this.element.dir=3===Y?"rtl":"ltr",this.bEb=Y);Y!==this.TBf()?(P=this.qQh?-2:fa?-6:-this.fIa,this.Geb=!0):this.Geb=!1}return{offsetX:P,
offsetY:V,BMf:Y}}ePi(P,V){if(1===P)return this.Lwa-1;P=Math.abs(V);return 0<P?P/(this.fIa+2):0}zke(P){for(let V=0;V<this.Lwa;V++)this.JQ[V].zke(P)}TBf(){return this.Ym?3:4}static XFd(){return String.format("{0}-{1}","presencetooltip",W.kGb++)}static JJd(P){return P.Sb.rawEvent.relatedTarget}}W.kGb=0;Object(x.a)(W,"ModernPresenceTooltipControl",b.a,[344,24]);var L=a(391),O=a(460),M=a(457);class K{constructor(P){this.$d=P;this.$d.eca(10,L.a.instance);this.$d.eca(9,M.a.instance);this.$d.eca(6,20);this.$d.eca(13,
O.a.instance);this.$d.eca(17,!1)}Qdh(P,V){this.$d.eca(15,!1);return new W(P,V,this.$d)}umf(P){this.$d.eca(15,!1);return new W(P,20,this.$d)}}Object(x.a)(K,"ModernPresenceTooltipFactory",null,[343])},1640:function(x,G,a){a.d(G,"a",function(){return H});x=a(0);var c=a(231),b=a(530),f=a(531),e=a(40),h=a(3),u=a(22);class m extends b.a{constructor(v,C){super(v);this.Fm=null;this.Qla=C.get(8,!1);this.bGa=C.get(6,0);this.element=v;this.element.className=m.jFd;this.ksd=this.createElement("ul");this.element.appendChild(this.ksd);
this.wu=C.get(10);this.wu.Zb(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.nI=C.get(9);this.nI.Zb(h.a.AR,this.element,Object(e.a)(this,this.O3,"onPointerOut"));this.nI.Zb(h.a.TH,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior"));this.uua=C.get(13);this.uua.Zb(this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior"))}nSa(v){this.addHandler(f.a.xI,v)}d6a(v){this.removeHandler(f.a.xI,v)}get users(){return this.Fm}dispose(){this.element&&
(this.wu.jc(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.nI.jc(h.a.TH,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")),this.nI.jc(h.a.AR,this.element,Object(e.a)(this,this.O3,"onPointerOut")),this.uua.jc(this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(v,C,F){this.hide();!v||0>=v.length||(this.Qla?this.element.style.right=C+"px":this.element.style.left=C+"px",this.element.style.top=
F+"px",this.P_h(v),this.visible=!0)}P_h(v){this.Fm=v;u.a.wx(this.ksd);for(let C=v.length-1;0<=C;C--)this.h0(v[C])}h0(v){const C=document.createElement("li");C.style.backgroundColor=v.color;C.style.height=this.bGa+"px";C.id="fly_"+v.clientId;C.style.lineHeight=this.bGa+"px";u.a.SA(C,v.userName);C.setAttribute("dir","auto");this.ksd.appendChild(C)}onClick(){this.hide();return!1}O3(v){this.raiseEvent(f.a.xI,new f.a(3,v));return!1}}m.jFd="prFlyout UIFont";Object(x.a)(m,"PresenceTooltipFlyoutControl",
b.a,[]);var n=a(135);class l extends b.a{constructor(v,C,F){super(v);this.Lua=null;this.Fm=[];this.element.className="prGlyph";this.$d=C;this.veb=this.$d.get(9);this.rE=this.$d.get(10);this.uua=this.$d.get(13);this.F8i();this.h0(F);this.$ld=!1}get KAa(){return this.Fm.length}get users(){return this.Fm}nSa(v){this.addHandler(f.a.xI,v)}d6a(v){this.removeHandler(f.a.xI,v)}dispose(){this.MVk();super.dispose()}h0(v){Array.add(this.Fm,v);2===this.KAa?this.Vxb(!0):1===this.KAa?this.Vxb(!1):this.Vxb(this.$ld)}Bqa(v){this.MDi(v)&&
(1<this.KAa&&this.Vxb(!0),1===this.KAa?this.Vxb(!1):1>this.KAa&&this.hide())}show(){this.Vxb(2<=this.KAa);this.visible=!0}hide(){this.visible=!1}UOi(v){return v?this.$Af(0,5):this.$Af(1,4)}MDi(v){for(let C=0;C<this.KAa;C++)if(this.Fm[C].clientId===v)return v=this.Fm[C],Array.removeAt(this.Fm,C),v;return null}Vxb(v){this.$ld!==v&&(this.Lua&&this.element.removeChild(this.Lua),this.Lua=this.UOi(v),this.element.appendChild(this.Lua),this.$ld=v);this.Lua.childNodes[0].style.backgroundColor=this.Fm[this.Fm.length-
1].color}$Af(v,C){const F=this.$d.get(6,0),D=this.$d.get(14);return n.c(F,F,this.$d.get(v),this.$d.get(C),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,D?D.cloneNode(!0):null)}P3(v){3!==v.yg&&this.raiseEvent(f.a.xI,new f.a(2,v));return!1}onClick(v){this.raiseEvent(f.a.xI,new f.a(1,v));return!0}O3(v){3!==v.yg&&this.raiseEvent(f.a.xI,new f.a(3,v));return!1}MVk(){this.element&&(this.veb.jc(h.a.TH,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")),
this.veb.jc(h.a.KP,this.element,Object(e.a)(this,this.P3,"onPointerOver")),this.veb.jc(h.a.AR,this.element,Object(e.a)(this,this.O3,"onPointerOut")),this.rE.jc(h.a.doubleClick,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")),this.rE.jc(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.uua.jc(this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")))}F8i(){this.element&&(this.veb.Zb(h.a.TH,this.element,Object(e.a)(this,
this.q_,"stopPropagationAndPreventDefaultBehavior")),this.veb.Zb(h.a.KP,this.element,Object(e.a)(this,this.P3,"onPointerOver")),this.veb.Zb(h.a.AR,this.element,Object(e.a)(this,this.O3,"onPointerOut")),this.rE.Zb(h.a.doubleClick,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")),this.rE.Zb(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.uua.Zb(this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")))}}Object(x.a)(l,"PresenceTooltipGlyph",
b.a,[]);var r=a(53);a(26);var w=a(94);class y extends b.a{constructor(v,C,F){super(v);this.Fm=[];this.kC=[];this.Dla=0;this.EIb=this.Cdb=!1;this.qTe=null;this.iia=(D,N)=>{var U=Object(c.a)(l,D);U=U?this.$wf(U):-1;if(2===N.type||1===N.type&&-1!==U&&!this.wX[U].visible)this.YRc(D);else if(1===N.type)this.Ixa(),this.Cdb=!1;else if(3===N.type){if(this.Xuf(N.$g))return;this.Cdb||this.Ixa()}this.raiseEvent(f.a.xI,N)};this.cGb={};this.$d=F;this.Ym=F.get(8,!1);this.q4=F.get(11,!1);v=F.get(12,0);this.oTa=
F.get(6,0);this.$kc=C;this.element.id=y.XFd();this.element.className=b.a.GAe("prControl",this.Ym);v&&(this.zIndex=v);this.rtl=this.Ym;this.Dme(C);this.j4=this.createElement("div");this.j4.className=this.q4?"prContainerV":"prContainerHr";this.element.appendChild(this.j4);this.LXe=Array(this.Dla);for(C=0;C<this.Dla;C++)this.wX[C]=new m(this.createElement("div"),this.$d),this.wX[C].nSa(this.iia),this.element.appendChild(this.wX[C].element)}get DKe(){return w.a.clone(this.Fm)}getGlyph(v){return this.cGb[v]}get wX(){return this.LXe}get o9e(){return this.qTe}get aZc(){return this.oTa+
2}get width(){return this.q4?this.aZc:this.$kc}get height(){return this.q4?this.$kc:this.aZc}nSa(v){this.addHandler(f.a.xI,v)}d6a(v){this.removeHandler(f.a.xI,v)}dispose(){if(this.wX)for(const v of this.wX)v.d6a(this.iia),r.a.lE(v);r.a.hOg(this.kC);this.kC=this.LXe=null;super.dispose()}rDb(){this.Ixa();this.Uoe();this.visible=!0;this.Cdb=!1}Zoe(){!this.kC||1>this.kC.length||(this.Ixa(),this.visible=!0,this.Uoe(),this.YRc(this.kC[this.kC.length-1]),this.Cdb=!0)}Cec(){if(this.kC&&!(1>this.kC.length)){this.visible=
!0;this.Uoe();var v=0;for(const C of this.kC)this.YRc(C,v++);this.Cdb=!1;this.EIb=!0}}hide(){this.visible=!1;this.Ixa();for(let v=0;v<this.kC.length;v++)this.kC[v].hide();this.Cdb=!1}oif(){if(!this.EIb)return!1;let v=0;for(const C of this.wX)C.visible&&v++;return this.EIb=0<v&&(this.Fm.length<=this.Dla?v===this.Fm.length:v===this.Dla)}h0(v){if(!(0>=this.Dla)){v.clientId||(v.clientId=(y.kGb++).toString());if(v.clientId in this.cGb){var C=this.JJa(v.clientId);if(0<=C){C=this.Fm[C];if(C.color===v.color&&
C.userName===v.userName)return;this.Bqa(v.clientId)}}C=this.oif();var F=0;if(this.Fm.length<this.Dla){var D=new l(this.createElement("div"),this.$d,v);D.nSa(this.iia);this.Ym&&!this.q4&&0<this.Fm.length?this.j4.insertBefore(D.element,this.j4.firstChild):(this.j4.appendChild(D.element),F=this.kC.length);Array.add(this.kC,D)}else this.Ym&&!this.q4?D=this.kC[0]:(F=this.kC.length-1,D=this.kC[F]),D.h0(v);D.show();this.cGb[v.clientId]=D;Array.add(this.Fm,v);this.S2g(D,F);C&&this.Cec()}}Bqa(v){const C=this.oif();
C&&this.Ixa();this.P4b(v);this.Fm.length>=this.Dla&&this.kC.length<this.Dla&&this.Eik();0>=this.Fm.length?this.hide():C&&this.Cec()}V9d(){}P4b(v){var C=this.JJa(v);0>C||(v=this.Fm[C],Array.removeAt(this.Fm,C),C=this.cGb[v.clientId],delete this.cGb[v.clientId],C.Bqa(v.clientId),this.S2g(C),0>=C.KAa&&(this.j4.removeChild(C.element),Array.remove(this.kC,C),C.dispose()))}Dne(){}Eik(){var v=this.WRi();!v||1>=v.users.length||(v=Array.clone(this.Fm),v.forEach(C=>{this.P4b(C.clientId)}),v.forEach(C=>{this.h0(C)}))}JJa(v){for(let C=
0;C<this.Fm.length;C++)if(this.Fm[C].clientId===v)return C;return-1}WRi(){return this.Ym&&!this.q4?this.kC[0]:this.kC[this.kC.length-1]}position(v,C){this.element.style.top=C+"px";this.element.style.left=v+"px"}Uoe(){for(let v=0;v<this.kC.length;v++)this.kC[v].show()}Ixa(){for(let v=0;v<this.Dla;v++)this.wX[v].hide();this.EIb=!1}YRc(v,C=0){if(v)if(this.qTe=v,this.q4){const F=this.oTa;if(1<v.users.length)this.wX[C].show(v.users,F,this.height-this.oTa);else{const D=this.j4.children.length;for(let N=
0;N<this.j4.children.length;N++)v.element===this.j4.children[N]&&this.wX[C].show(v.users,F,this.height-(D-N)*this.aZc+2)}}else this.wX[C].show(v.users,this.width,0)}Xuf(v){v=y.JJd(v);let C=!1;for(const F of this.wX)if(u.a.RAb(F.element,v)){C=!0;break}return this.j4!==v&&u.a.RAb(this.j4,v)||C}S2g(v,C=0){const F=this.Sej(v);F&&0>=v.KAa?this.wX[C].hide():F?this.YRc(v):this.wX[C].hide()}$wf(v){let C=0;for(const F of this.kC){if(v===F)return C;C++}return-1}Sej(v){const C=this.$wf(v);return!!this.o9e&&
v===this.o9e&&-1!==C&&this.wX[C].visible}Dme(v){this.Dla=v===this.oTa?1:Math.floor(v/this.aZc);this.q4?(this.element.style.height=v+"px",this.element.style.width=this.oTa+"px"):(this.element.style.width=v+"px",this.element.style.height=this.oTa+"px")}static XFd(){return String.format("{0}-{1}","presencetooltip",y.kGb++)}static JJd(v){v=v.Sb.rawEvent;return v.relatedTarget||v.toElement}}y.kGb=0;Object(x.a)(y,"PresenceTooltipControl",b.a,[344,24]);var z=a(391),A=a(460),B=a(457);class H{constructor(v){this.$d=
v;this.$d.eca(10,z.a.instance);this.$d.eca(9,B.a.instance);this.$d.eca(6,16);this.$d.eca(13,A.a.instance)}Qdh(v,C){return new y(v,C,this.$d)}umf(v){return new y(v,16,this.$d)}}Object(x.a)(H,"PresenceTooltipFactory",null,[343])},1682:function(x,G,a){a.r(G);var c=a(0),b=a(17),f=a(68),e=a(30),h=a(39),u=a(10),m=a(46),n=a(6);class l{constructor(Lb,Rc,md,Zc,ld,fe,Ac,R,za=!1){this.m2c=null;this.RIh=!0;this.rQh=this.mHa=this.GEh=null;this.kb=new e.a;this.t1m=()=>{this.pbl.result&&this.ral.result&&(this.mHa=
this.pbl.result,this.rQh=this.ral.result,this.mHa.$ah(this.Tyg),this.GEh=new h.a(2,2,this.B4k,this.jXn,88),l.ze.Qb(this.GEh))};this.Tyg=(X,lb)=>{(this.RIh||this.pDn(lb.hPe))&&l.ze.Eta(this.GEh,0)};this.jXn=X=>{var lb=this.mHa.PLm();if(lb){var oc=new Date,Oc=!1;if(this.RIh){this.m2c=lb;this.RIh=!1;var sd=this.m2c;for(var Ld in sd){lb=Ld;var Qd=sd[Ld];Qd.AFe<oc&&(oc=Qd.AFe);2===Qd.status&&(Oc=!0,this.rQh.iuh(lb))}Oc&&this.ZWl();l.ze.Eta(X,this.Dvl(oc))}else{Qd=new f.a;Ld=!1;var Id=this.m2c;for(sd in Id){Id=
sd;if(!(Id in this.m2c)||this.Yjm.clientId===Id)continue;var he=this.m2c[Id];const xb=lb[Id];if(he&&xb){he=he.status;const Sb=xb.status;2===he&&1===Sb?(Qd.add(Id),b.ULS.sendTraceTag(38052609,392,50,Id+" returned from away")):1===he&&2===Sb&&(Ld=Oc=!0,this.rQh.iuh(Id),b.ULS.sendTraceTag(38052610,392,50,Id+" went away"));1===Sb&&xb.AFe<oc&&(oc=xb.AFe)}}this.m2c=lb;l.ze.Eta(X,this.Dvl(oc));(0<Qd.count||Oc)&&this.ZWl();0<Qd.count&&!this.llm?(X=this.NMm(Qd),this.AUn(X)):X=new f.a;(Ld||0<X.count)&&this.Ukm(u.a.Dzb,
2)}}};this.Yjm=Lb;this.pbl=Rc;this.ral=md;this.qal=Zc;this.B4k=fe;l.ze=ld;this.Ukm=Ac;this.Y8a=R;this.llm=za;m.Task.WAA(Rc,md).continueWith(this.t1m)}ZWl(){this.kb.raiseEvent("u",null,this)}pDn(Lb){for(const md in Lb){var Rc=this.qal.bwl({key:md,value:Lb[md]});if(Rc&&Rc.clientId&&(Rc=Rc.clientId.toLowerCase(),(Rc=this.m2c[Rc]||this.m2c[Rc.toUpperCase()])&&2===Rc.status))return!0}return!1}AUn(Lb){if(Lb.count)for(const Rc of Lb)Lb=this.Y8a.pX(String.format(Object(n.a)("EditorsToastArriving"),Rc),!1),
Lb.image=5,Lb.SV="CoAuth_AuthorStatus_16x16x32",this.Y8a.Vh(Lb)}NMm(Lb){const Rc=this.mHa.Kgh(),md=new f.a;for(const Zc in Rc){const ld={key:Zc,value:Rc[Zc]};if(Lb.contains(ld.key)){const fe=this.qal.bwl(ld);fe&&(md.add(fe.userName),Lb.remove(ld.key))}}md.count||b.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return md}Dvl(Lb){return Math.max(Lb.getTime()+this.B4k-(new Date).getTime(),0)}}l.ze=null;Object(c.a)(l,"AwayManager",null,[]);var r=a(849),w=a(19),y=a(4),z=a(485),
A=a(1636),B=a(118),H=a(1629),v=a(40),C=a(219),F=a(1524),D=a(1529),N=a(1393),U=a(706),W=a(1523),L=a(249),O=a(574),M=a(372),K=a(248),P=a(1174),V=a(5),Y=a(231),ta=a(134),fa=a(1209),Ta=a(529),ha=a(258),qa=a(278);class ra{constructor(Lb,Rc){this.shapeNode=Lb;this.m6l=Rc}}Object(c.a)(ra,"ShapeNodeStartEditingNotificationTracking",null,[]);class I{constructor(Lb,Rc,md,Zc,ld="",fe=""){if(!Lb||!Rc||0>md)throw Error.argumentNull("LockEntry");this.a_=Lb;this.jK=Rc;this.Dha=md;this.Scn=Zc;this.tMl=ld;this.sMl=
fe;this.gKl=new Date}get clientId(){return this.a_}get Bxh(){return this.jK}get shapeId(){return this.Dha}get lockType(){return this.Scn}get X6l(){return this.tMl}get V6l(){return this.sMl}get SDl(){return!V.a.rb(this.sMl)&&!V.a.rb(this.tMl)}get NEl(){return this.gKl}set NEl(Lb){this.gKl=Lb}}Object(c.a)(I,"LockEntry",null,[]);class ba{constructor(Lb,Rc,md,Zc,ld="",fe=""){this.clientId=Lb;this.slideId=Rc;this.shapeId=md;this.lockType=Zc;this.rowId=ld;this.cellId=fe}}Object(c.a)(ba,"SerializableLockData",
null,[]);var Ga=a(359),Oa=a(275),Ja=a(403);class Qa{constructor(Lb,Rc,md,Zc,ld,fe,Ac,R,za,X,lb,oc,Oc,sd,Ld,Qd,Id,he,xb,Sb,Cc,qb){this.vVm=new r.a("",ResourceStrings.L_GhostUserName,fa.a.leh,new P.a(1));this.cHe={};this.dHe={};this.bHe={};this.ZJl=L.App.ep;this.MIj=null;this.YNj={};this.qmh={};this.rmh={};this.$Jl=L.App.ep;this.qMl=!0;this.HKl=this.yKl=0;this.Koh=(new Date(0)).getTime();this.Loh=(new Date(0)).getTime();this.rdg=(new Date(0)).getTime();this.FKj=(new Date(0)).getTime();this.pMl=!1;this.V1a=
Lb;this.pR=Rc;this.hHe=md;this.lmg=Zc;this.$b=ld;this.Tb=fe;this.pa=Ac;this.o1f=R;this.nr=za;this.Ia=X;this.Ac=lb;this.Lad=oc;this.cDj=Oc.qkh;this.GP=sd;this.eUa=Ld;this.va=Qd;this.PLl=Id;this.kd=he;this.kd.tfl(Object(v.a)(this,this.esn,"onShapeViewElementRequestUpdateAuthorInfo"));(this.A3=y.AFrameworkApplication.ga.getBooleanAppSetting(Oa.a.itb))&&this.pa.QM(Object(v.a)(this,this.QH,"onSelectionChanged"));this.lmg.Zmc(Object(v.a)(this,this.hAg,"onUpdateNotificationReceived"));this.Ten=xb;this.xe=
Sb;this.Fen=Cc;this.Aa=Oc;this.Xad=qb;this.x1m()}x1m(){K.a.J(509219588,828,50,"CoauthStateChangesHandler:InitRttRelatedTasks - IsDedicatedSession: {0}, RttLockSettings: {1}",this.cDj,this.GP.T$m());this.GP.avi||(0<this.GP.zdd?this.Tb.Qb(new h.a(2,2,this.GP.zdd,Object(v.a)(this,this.removeExpiredLock,"removeExpiredLock"),90,"71")):K.a.J(509219587,804,10,"RemoveExipredLockIntervalMs is not set correctly while RTT lock is enabled"),0<this.GP.Oqe?(this.Tb.Qb(new h.a(2,2,this.GP.Oqe/2,Object(v.a)(this,
this.switchPendingSveToFidelity,"switchPendingSveToFidelity"),90,"72")),this.qMl=!1):K.a.J(509219586,804,50,"Switch to fidelity delay after unlock is disabled"),0<this.GP.XDe?this.Tb.Qb(new h.a(2,2,this.GP.XDe,Object(v.a)(this,this.updateLockIfImeActive,"updateLockIfImeActive"),90,"73")):K.a.J(509219585,804,50,"IME typing lock notification disabled"),0<this.GP.vbd?this.Tb.Qb(new h.a(2,2,this.GP.vbd,Object(v.a)(this,this.detectLockLeak,"detectLockLeak"),90,"74")):K.a.J(509219584,804,50,"Lock leack detection is disabled"),
this.o1f.addHandler(Ta.a.tdh,(Lb,Rc)=>{this.Lym(Rc)}),this.GP.Pqf||this.DYg||(this.Lad.oSa(Object(v.a)(this,this.mPl,"onBeforeParagraphNodePropertyChanged")),0<this.GP.Hfd?this.Tb.Qb(new h.a(2,2,this.GP.Hfd,Object(v.a)(this,this.updateLockForActiveShapeNodes,"updateLockForActiveShapeNodes"),90,"75")):K.a.J(509219555,804,15,"DedicatedWorkerTypingUpdateIntervalMs is not set correctly")),this.DYg&&(this.Fen.oSa(Object(v.a)(this,this.ece,"onTableCellNodePropertyChanged")),this.Lad.oSa(Object(v.a)(this,
this.mPl,"onBeforeParagraphNodePropertyChanged")),this.Ten.initialize(),0<this.GP.Hfd&&this.Tb.Qb(new h.a(2,2,this.GP.Hfd,Object(v.a)(this,this.updateLockForActiveTableCellNodes,"updateLockForActiveTableCellNodes"),90,"76")),0<this.GP.zdd&&this.Tb.Qb(new h.a(2,2,this.GP.zdd,Object(v.a)(this,this.removeExpiredTableCellLock,"removeExpiredTableCellLock"),90,"77"))))}get DYg(){return this.GP.xyi&&this.GP.Opl}removeExpiredLock(){var Lb=Ja.a(this.cHe);for(const Rc of Lb){Lb=Object(Y.a)(284,this.cHe[Rc]);
if(!Lb){delete this.cHe[Rc];continue}const md=Lb.shapeNode;md&&md.isConnected?this.eUa.Bul(md)||this.lth(Rc)||(delete this.cHe[Rc],this.eUa.lCf(md)||Lb.isDisposed?K.a.J(509219554,814,50,"Previous non wet changes lock is expired but the shape contains wet changes now"):this.X8l(Lb)):delete this.cHe[Rc]}}removeExpiredTableCellLock(){var Lb=Ja.a(this.dHe);for(const Rc of Lb){Lb=Object(Y.a)(918,this.dHe[Rc]);if(!Lb){delete this.dHe[Rc];continue}const md=Lb.tableCellNode;md&&md.isConnected?V.a.rb(this.eUa.EAf(md))&&
!this.lth(Rc)&&(delete this.dHe[Rc],this.Y8l(Lb)):delete this.dHe[Rc]}}detectLockLeak(){const Lb=[],Rc=new Date,md=this.yxl();for(const Zc of md)Zc.isLocked&&+Rc-+Zc.gWd>this.GP.vbd&&Lb.push(Zc.shapeNode.Ql);0<Lb.length&&K.a.J(509219553,828,15,"Following objects are locked longer than {0} : {1}",this.GP.vbd,Lb.join(";"))}switchPendingSveToFidelity(){const Lb=new Date,Rc=this.yxl();for(const md of Rc)md.isLocked||md.shapeNode.Zc&&this.DYg||!md.Ho||md.Tx||!(+Lb-+md.iFl>this.GP.Oqe)||md.GA||md.G7b()}updateLockIfImeActive(){if(this.ZJl>=
this.$Jl&&this.MIj){const Lb=this.nJm(this.MIj);this.Xzh(Lb)&&this.FPg(Lb.slideId,Lb.get_shapeId(),2)}this.$Jl=new Date}updateLockForActiveShapeNodes(){var Lb=Ja.a(this.qmh);for(const Rc of Lb)Lb=Object(Y.a)(426,this.qmh[Rc]),this.Xzh(Lb)&&this.FPg(Lb.slideId,Lb.get_shapeId(),3);this.qmh={}}updateLockForActiveTableCellNodes(){var Lb=Ja.a(this.rmh);for(const Rc of Lb)if(Lb=Object(Y.a)(502,this.rmh[Rc]),this.Xzh(Lb)){const md=this.Ia.ln(Lb);this.FPg(md.slideId,md.get_shapeId(),3,Lb.rowId.toString(),
Lb.cellId.toString())}this.rmh={}}nJm(Lb){return(Lb=this.nr.QK(Lb))?this.Ia.ln(Lb.hb):null}mPl(Lb,Rc){Rc&&Rc.node?(Lb=Object(Y.a)(427,Rc.node),Lb)?Lb.loading||Lb.udc||Rc.property.id!==ha.a.tq.id||(Rc=this.Ia.Mja(Lb),Lb=this.Ac.mEa(Lb),Rc&&(Lb?(Rc=this.Wgh(Rc.slideId,Rc.get_shapeId(),Lb.rowId.toString(),Lb.cellId.toString()),this.rmh[Rc]=Lb):(Lb=this.QCe(Rc.slideId,Rc.get_shapeId()),this.qmh[Lb]=Rc))):K.a.J(509219551,828,10,"Invalid argument."):K.a.J(509219552,828,10,"Invalid argument.")}lJn(Lb){const Rc=
new h.a(2,1,this.GP.sWg,Object(v.a)(this,this.rtcNotifyStartEditing,"rtcNotifyStartEditing"),90,"78");Rc.customData=new ra(Lb,!1);this.Tb.Qb(Rc);this.YNj[this.QCe(Lb.slideId,Lb.get_shapeId())]=Rc}rtcNotifyStartEditing(Lb){Lb=Object(Y.a)(ra,Lb.customData);const Rc=Lb.shapeNode;this.Xzh(Rc)&&this.J6m(Rc)&&this.FPg(Rc.slideId,Rc.get_shapeId(),1);Lb.m6l=!0}Xzh(Lb){return Lb?Lb.isConnected:!1}J6m(Lb){return(Lb=this.Ak(Lb))?Lb.CE:!1}Ak(Lb){return Object(Y.a)(284,Lb.Qg(this.$b.An.Oa))}yxl(){const Lb=[];
if(!this.va.Ga)return Lb;var Rc=this.va.Ga.xj();if(!Rc)return Lb;for(const md of Rc)(Rc=this.Ak(md))&&!Rc.isDisposed?Lb.push(Rc):K.a.J(509219549,828,50,"Shape {0} on active slide doesn't have valid view element",md.Ql);return Lb}xRl(Lb){this.s4l(Lb)&&(this.V1a.amIAlone||this.lJn(Lb))}QH(Lb,Rc){for(Lb=0;Lb<Rc.RH.length;Lb++){const Zc=Rc.RH[Lb];var md=Object(Y.a)(426,Zc.context.node);md&&md.isConnected&&(md=Object(Y.a)(284,md.tc(this.xe)))&&(md=this.PLl.k5(md.shapeNode))&&(1===Zc.ffa?md.$tg():0===Zc.ffa&&
md.TUj())}}wRl(Lb){if(this.s4l(Lb)&&!this.GP.Nqf){var Rc=this.QCe(Lb.slideId,Lb.get_shapeId()),md=Object(Y.a)(h.a,this.YNj[Rc]);if(md){const Zc=Object(Y.a)(ra,md.customData);this.Tb.li(md);Zc&&Zc.m6l&&this.FPg(Lb.slideId,Lb.get_shapeId(),4);this.YNj[Rc]=null}}}esn(Lb,Rc){this.fSl(Rc.cI)}fSl(Lb){Lb.UK()||Lb.shapeNode.O$a?this.Kom(Lb):this.gSl(Lb)}ece(Lb,Rc){if((Rc=Object(Y.a)(Ga.TableCellNode,Rc.node))&&(Lb=Object(Y.a)(918,Rc.Qg(this.xe)))&&Rc.isConnected){Rc=this.eUa.EAf(Rc);const md=this.wek(Lb.tableCellNode);
V.a.rb(Rc)?md?(this.mvj(Lb,this.bQb(md.clientId,Qa.Jxi)),this.iYk(Lb)):V.a.rb(Rc)&&(this.wek(Lb.tableCellNode)||this.Y8l(Lb)):(this.mvj(Lb,this.bQb(Rc,Qa.Jxi)),this.iYk(Lb))}}mvj(Lb,Rc){Lb.lock(Rc)}Y8l(Lb){Lb.unlock()}FPg(Lb,Rc,md,Zc="",ld=""){try{const fe=new ba(this.hHe,Lb.hfc,Rc,md,Zc,ld);this.lmg.mvb(7,fe)}catch(fe){K.a.J(509219548,814,10,"LockManager.SendLockNotification : MyClientId: {0}; Exception: {1}. ",this.hHe,fe.stack)}}hAg(Lb,Rc){this.Aa.YJe&&!this.pMl&&8===Rc.type&&this.Xad&&this.XOn(Rc)&&
(K.a.J(509219547,814,50,"Log coauth activity"),this.pMl=!0,this.Xad.continueWith(()=>{this.Xad.result.logActivity("CoauthContentMerge","PptCoauthSurveyFloodgateEnabled")}));7===Rc.type&&((Lb=Rc.Yec)?Lb.clientId===this.hHe?K.a.J(509219545,828,15,"Lock notification : lock notification from myself recieved"):(K.a.J(509219544,828,50,"Lock notification : LockClientId {0}, MyClientId: {1}.",Lb.clientId,this.hHe),Lb=new I(Lb.clientId,Lb.slideId,Lb.shapeId,Lb.lockType,Lb.rowId,Lb.cellId),this.Qom(Lb),this.fBn(Lb)):
K.a.J(509219546,828,10,"Lock notification: invalid lock data recieved"))}gSl(Lb){if(!Lb||Lb.isDisposed)K.a.J(509219543,828,15,"UpdateAuthorInfoTaskHandler: shapeViewElement is null: {0}.",!Lb);else{var Rc=Lb.shapeNode;if(!(Rc.rg||this.cDj&&Rc.Zc&&(this.GP.XBd||this.DYg))){var md=this.eUa.lCf(Rc);md?this.Xlh(Lb,this.bQb(md,Qa.Jxi)):(Rc=this.eUa.Bul(Rc))?(this.Xlh(Lb,this.bQb(Rc,Qa.ZFm)),this.hYk(Lb)):(Rc=this.wek(Lb.shapeNode))?(this.Xlh(Lb,this.bQb(Rc.clientId,this.rQi(Rc.lockType))),this.hYk(Lb)):
Lb.isLocked&&this.X8l(Lb)}}}X8l(Lb){const Rc=this.PLl.k5(Lb.shapeNode);Rc&&(Rc.Izh(null),Lb.unlock(this.qMl||!Rc.o7i))}Xlh(Lb,Rc){Lb.lock(Rc);Lb.UK()&&this.pa.Ti()}XOn(Lb){if(!Lb||null===Lb.Yec)return!1;Lb=this.zun(Lb.Yec);for(const Rc of Lb)Rc&&Rc.clientId&&(Rc.clientId.toLowerCase()===this.hHe.toLowerCase()?(this.yKl++,this.Koh=this.Koh===(new Date(0)).getTime()?(new Date).getTime():this.Koh,this.Loh=(new Date).getTime()):this.l5m(Rc.clientId)||(this.HKl++,this.rdg=this.rdg===(new Date(0)).getTime()?
(new Date).getTime():this.rdg,this.FKj=(new Date).getTime()));return 5<=this.yKl&&5<=this.HKl&&(this.FKj>=this.Koh&&this.rdg<=this.Loh||this.Loh>=this.rdg&&this.Loh<=this.FKj)&&1<=this.pR.NCe()?!0:!1}zun(Lb){let Rc=null;try{Rc=Lb}catch(md){}if(null===Rc||!Rc.length){let md=null;try{md=Lb}catch(Zc){K.a.J(509219541,828,10,"UpdateHint can't convert to RTC message.")}if(null!==md)return[md]}return Rc}l5m(Lb){Lb=this.bQb(Lb);const Rc=this.bQb(this.hHe);return Lb&&Rc&&Lb.userName===Rc.userName&&Lb.email===
Rc.email?!0:!1}rQi(Lb){switch(Lb){case 1:return Qa.dSn;case 2:return Qa.H0m;case 3:return Qa.mWn;case 4:return Qa.KGm}K.a.J(509219539,828,10,"Unknown lock type");return"Unknown lock type"}Qom(Lb){if(Lb&&Lb.Bxh){var Rc=Lb.SDl?this.Wgh(new qa.a(Lb.Bxh),Lb.shapeId,Lb.X6l,Lb.V6l):this.QCe(new qa.a(Lb.Bxh),Lb.shapeId);if(4===Lb.lockType)this.bHe[Rc]=Lb;else{var md=Object(Y.a)(I,this.bHe[Rc]);md?(md=this.pQi(md),this.pQi(Lb)>md&&(this.bHe[Rc]=Lb)):this.bHe[Rc]=Lb}}}pQi(Lb){return this.iQm(Lb.lockType)-
(+new Date-+Lb.NEl)}iQm(Lb){switch(Lb){case 1:return this.GP.rWg;case 2:return this.GP.hNf;case 3:return this.GP.D1g;case 4:return this.GP.jDd}K.a.J(509219536,828,10,"Unknown lock type");return 0}wek(Lb){if(Object(ta.a)(426,Lb)){Lb=Object(Y.a)(426,Lb);if(!Lb.slideId)return null;Lb=this.QCe(Lb.slideId,Lb.get_shapeId());return this.lth(Lb)}if(Object(ta.a)(502,Lb)){Lb=Object(Y.a)(502,Lb);const Rc=this.Ia.Mja(Lb);if(!Rc.slideId)return null;Lb=this.Wgh(Rc.slideId,Rc.get_shapeId(),Lb.rowId.toString(),Lb.cellId.toString());
return this.lth(Lb)}return null}lth(Lb){if(!Lb)return null;const Rc=Object(Y.a)(I,this.bHe[Lb]);return Rc?0>=this.pQi(Rc)?this.bHe[Lb]=null:Rc:null}hYk(Lb){const Rc=this.cTm(Lb);Rc&&(this.cHe[Rc]=Lb)}iYk(Lb){const Rc=this.bUm(Lb);Rc&&(this.dHe[Rc]=Lb)}cTm(Lb){return Lb?this.QCe(Lb.shapeNode.slideId,Lb.shapeNode.get_shapeId()):null}bUm(Lb){if(!Lb)return null;Lb=Lb.tableCellNode;const Rc=this.Ia.Mja(Lb);return this.Wgh(Rc.slideId,Rc.get_shapeId(),Lb.rowId.toString(),Lb.cellId.toString())}QCe(Lb,Rc){return String.format("{0}#{1}#{2}",
Lb.sid,Lb.cid,Rc)}Wgh(Lb,Rc,md,Zc){return String.format("{0}#{1}#{2}#{3}#{4}",Lb.sid,Lb.cid,Rc,md,Zc)}e5m(Lb){const Rc=Object(Y.a)(32,this.va.Ga);return Rc&&qa.a.Dxh(Lb.Bxh,Rc.Xb.hfc)?!0:!1}fBn(Lb){if(this.e5m(Lb)){var Rc=Lb.shapeId,md=Lb.clientId;this.va.Ga&&(Rc=this.va.Ga.WZ(Rc))&&(Lb.SDl&&this.GP.xyi?this.lBn(Lb,md,Rc):this.iBn(Lb,md,Rc))}}iBn(Lb,Rc,md){md.rg||this.cDj&&md.Zc&&(this.GP.XBd||this.DYg)||!(md=this.Ak(md))||(this.Xlh(md,this.bQb(Rc,this.rQi(Lb.lockType))),this.hYk(md))}lBn(Lb,Rc,md){if((md=
this.cUm(md,Lb.X6l,Lb.V6l))&&md.isConnected){var Zc=Object(Y.a)(918,md.Qg(this.xe));Zc&&V.a.rb(this.eUa.EAf(md))&&(this.mvj(Zc,this.bQb(Rc,this.rQi(Lb.lockType))),this.iYk(Zc))}}cUm(Lb,Rc,md){Lb=this.Ac.NQ(Object(Y.a)(426,Lb));if(!Lb)return null;var Zc=this.Ac.Oja(Lb);Lb=null;for(const ld of Zc){Zc=this.Ac.u$a(ld);for(const fe of Zc)if(fe.rowId.toString()===Rc&&fe.cellId.toString()===md){Lb=fe;break}}return Lb}Kom(Lb){const Rc=new h.a(0,1,0,()=>{this.gSl(Lb)},90,"79");this.Tb.Qb(Rc)}Lym(Lb){this.ZJl=
new Date;this.MIj=this.ZIm(Lb.Dc)}ZIm(Lb){return Lb?Lb.querySelector(".Paragraph"):null}bQb(Lb,Rc=""){const md=this.pR.bQb(Lb);if(md)return md;K.a.J(509219531,828,50,"Failed to find presence user for client id: {0}; DataSource: {1}.",Lb,Rc);return this.vVm}s4l(Lb){return!this.GP.avi&&!(this.GP.XBd&&Lb.Zc)&&!Lb.rg}}Qa.Jxi="EditingBy";Qa.ZFm="EditingByInSameWorker";Qa.dSn="StartEditing";Qa.KGm="EndEditing";Qa.H0m="ImeTyping";Qa.mWn="Typing";Object(c.a)(Qa,"CoauthStateChangesHandler",null,[1457]);class Pa{constructor(Lb){this.Mbc=
{};this.a_=Lb.IP;this.init(Lb)}init(Lb){if(Lb=Lb.a8)for(const Rc of Lb)Rc.ID!==this.a_&&(this.Mbc[Rc.ID]=new Date)}eom(Lb){for(let Rc=0;Rc<Lb.length;Rc++)Lb[Rc]in this.Mbc||Lb[Rc]===this.a_||(this.Mbc[Lb[Rc]]=new Date)}JSn(Lb){const Rc=this.Mbc[Lb];Rc&&(K.a.J(37590341,814,50,"EditorPresenceTracker : Presence of coauthoring user never appeared, but leaving coauth; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.a_,Lb,(new Date).getTime()-Rc.getTime()),delete this.Mbc[Lb])}ISn(Lb){const Rc=
this.Mbc[Lb];Rc&&(K.a.J(507843859,814,50,"EditorPresenceTracker : Presence of coauthoring user appeared; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.a_,Lb,(new Date).getTime()-Rc.getTime()),delete this.Mbc[Lb])}HSn(){for(const Lb of Object.keys(this.Mbc))K.a.J(507843858,814,15,"EditorPresenceTracker : Presence of coauthoring user never appear; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.a_,Lb,(new Date).getTime()-this.Mbc[Lb].getTime());this.Mbc={}}}Object(c.a)(Pa,
"EditorPresenceTracker",null,[1456]);class ja{constructor(Lb){this.Jdn=Lb;this.BO=new C.a;this.BO.vj(this.Jdn)}}Object(c.a)(ja,"PPTRtcProvider",null,[1455]);var va=a(83),Ha=a(151),gb=a(1360);class Gb{constructor(Lb,Rc,md,Zc,ld){this.oBb=null;this.UMa=!1;this.BCj=this.xJj=null;this.nbn=va.a.create();this.xnh=!1;this.oxf=0;this.YTa=ld;md.Rh&&(this.findSessionResponse=Lb,Zc.ofl(Object(v.a)(this,this.KKn,"sessionPropertiesChanged")));this.oGc=new Ha.a(()=>Rc())}get findSessionResponse(){return this.oBb}set findSessionResponse(Lb){if(this.UMa)K.a.J(507843676,
814,15,"PptAssignRtcMachineStrategy : FindSessionResponse Not updating cached find session response as it is already set");else if(this.oBb=Lb)this.UMa=!0,this.xJj=this.oBb.Tkl,this.BCj=this.oBb.W7}get X_b(){return this.UMa?this.xJj:this.oGc.value.X_b}set X_b(Lb){this.UMa?this.xJj=Lb:this.oGc.value.X_b=Lb}lCk(Lb){this.oGc.value.lCk(Lb)}get W7(){return this.UMa?this.BCj:this.oGc.value.W7}set W7(Lb){this.UMa?this.BCj=Lb:this.oGc.value.W7=Lb}qhh(){let Lb;K.a.J(507843675,814,50,"PptAssignRtcMachineStrategy : OnConnectionStateChanged isFindSessionResponseValid:{0}, havePerformedFindSessionWithLazyStrategy:{1}",
this.UMa,this.xnh);return this.UMa?(Lb=this.oBb.correlationId||this.nbn.toString(),K.a.J(507843674,500,50,"CorrelationId after FindSession: {0}",Lb),{returnValue:String.format("{0}&{1}={2}",this.oBb.vbb,y.AFrameworkApplication.bmi,V.a.Sj(Lb)),correlationId:Lb}):this.xnh?this.oGc.value.qhh():(K.a.J(507843673,814,50,"PptAssignRtcMachineStrategy : GetFindSessionRequestQs returning null QS to avoid crashing"),{returnValue:null,correlationId:null})}sUi(Lb,Rc,md,Zc,ld){K.a.J(507843672,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",
this.UMa);this.UMa?(Lb(this.oBb.Lkf),md(new gb.a(this.oBb.Uqh,this.oBb.Sqh,this.oBb.Rqh,this.oBb.Dih))):(this.oGc.value.sUi(Lb,Rc,md,Zc,ld),this.xnh=!0);this.YTa&&this.YTa.Vh(26,!this.xnh)}Rvi(){K.a.J(507843671,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.UMa);this.UMa?this.UMa=!1:this.oGc.value.Rvi()}$Bb(Lb,Rc){K.a.J(507843670,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.UMa);this.UMa||this.oGc.value.$Bb(Lb,Rc)}KKn(){K.a.J(507843669,
814,50,"PptAssignRtcMachineStrategy : SessionPropertiesChanged; FindSessionQs refreshed isFindSessionResponseValid:{0}",this.UMa);this.UMa=!1}}Object(c.a)(Gb,"PptAssignRtcMachineStrategy",null,[1454]);var Mb=a(1534);class hb{constructor(){this.us=null}h$b(Lb,Rc){this.us||(this.us={});this.us[Rc]||(this.us[Rc]=0);this.us[Rc]+=Lb}getData(){return this.us}reset(){this.us=null}}Object(c.a)(hb,"MultiSumDataAggregator",null,[1829]);class Da{constructor(Lb,Rc){this.gEh=Mb.a.UZ(Lb,Rc,new hb,!0)}Bf(Lb){this.gEh.track(1,
Lb)}}Object(c.a)(Da,"MultiCounter",null,[1869]);class Bb{constructor(Lb,Rc,md,Zc){this.H3=Lb;this.Yca=Rc;this.Len=md;this.lcn=Zc;this.H3.Zmc(Object(v.a)(this,this.DIn,"rtcOnUpdateNotificationReceived"))}DIn(Lb,Rc){0===Rc.type&&(this.lcn.Bf("CU"),this.Len||this.YM())}YM(){!y.AFrameworkApplication.mi&&this.Yca.aW&&this.Yca.YM(null,null,null)}}Object(c.a)(Bb,"ContentNotificationManager",null,[]);class Za extends Bb{constructor(Lb,Rc,md,Zc){super(Lb,Rc,md,Zc)}static init(){if(L.App.Vb){var Lb=L.App.Vb.Pd;
if(Lb&&(Lb.Kah(Za.dPl),Lb=Lb.gj)&&(Lb=Lb.yq)){var Rc=L.App.ji;if(Rc&&Rc.Iw&&(Rc=w.a.instance.resolve("AppRealtimeChannel.IRealtimeChannel"))){var md=y.AFrameworkApplication.ga.getBooleanAppSetting("Box4ThrottleInboundRequests"),Zc=new Da(11,1);Za.Omh=Za.Omh||new Za(Rc,Lb,md,Zc);Za.Omh.YM()}}}}static dPl(Lb){Za.Omh||(Lb.juh(Za.dPl),Za.init())}}Za.Omh=null;Object(c.a)(Za,"PptContentNotificationManager",Bb,[]);var mb=a(21),vb=a(73),sb=a(42),bc;(function(Lb){Lb[Lb.m6n=0]="signalRConnectFailed";Lb[Lb.x3n=
1]="findSessionFailed"})(bc||(bc={}));Object(c.b)("RtcConnectFailureType",bc);var yb=a(411),uc=a(250);class vc{constructor(Lb,Rc,md,Zc,ld,fe){this.Poh=this.AKl=this.a5d=this.$4d=0;this.U3d=this.xIc=this.UXb=this.Rag=this.Mnh=this.q2a=null;this.eoh=this.goh=this.hoh=this.coh=this.doh=!1;this.ALl=Lb;this.Op=Rc;this.tY=md;this.tY.Hye(Object(v.a)(this,this.h1b,"onNetworkHealthStateChanged"));this.Kj=Zc;this.PNj=fe;$addHandler(window,"visibilitychange",Object(v.a)(this,this.SOa,"onVisibilityChange"));
this.Xdn=ld;this.Xdn.Lqm(Object(v.a)(this,this.Jrn,"onRtcConnectFailed"))}h1b(Lb,Rc){Rc.ZEe||(this.goh=this.hoh=!0)}SOa(){window.document.hidden&&(this.coh=this.doh=!0)}Jrn(Lb,Rc){Lb=Rc.uIm;if(Rc=Rc.errorMessage){if(0===Lb){const {l9i:md,m9i:Zc,oj:ld}=U.RtcUtils.Sql(Rc.ErrorDetails);Rc.HttpErrorCode=md;Rc.HttpErrorStatus=Zc;Rc.Exception=ld;delete Rc.ErrorDetails;if(!md&&this.PNj&&0<this.PNj.length)try{let fe=!0;const Ac=window.location.hostname.toLowerCase();for(const R of this.PNj.split(";"))if(Ac.endsWith(R)){fe=
!1;break}Rc.IsCORS=fe.toString()}catch(fe){Rc.Unexpected=fe.message}}K.a.J(508946247,500,15,"PptRealtimeChannelMetrics:OnRtcConnectFailed; AmIAlone:{0}; IsPageHidden:{1}; IsNetworkHealthy:{2}; rtc connect failed type:{3}; errorMessage:{4}",this.Op.amIAlone,window.document.hidden,this.Kj.xP,bc[Lb],mb.a.toJSON(Rc));this.eoh||(this.eoh=this.k6m(Lb,Rc))}}k6m(Lb,Rc){const md=yb.c(Rc,"HttpErrorCode",-1);return 500<=md&&599>=md||1===Lb&&"FindSessionRequestFailed"!==Rc.FindSessionFailureReason?!0:!1}Yyl(){return this.q2a&&
1===this.a5d?this.doh||this.hoh:this.UXb&&1<this.a5d?this.coh||this.goh:!1}Xyl(){return this.UXb&&0<this.Poh?this.coh||this.goh:this.q2a&&0<this.$4d?this.doh||this.hoh:!1}Oth(){this.$4d++;this.Rag=new Date;this.q2a||(this.q2a=new Date,this.doh=window.document.hidden,this.hoh=!this.Kj.xP)}Wik(){this.kXl(0)}kXl(Lb){this.a5d++;this.xIc=new Date;this.Mnh?this.vdh>this.ALl.Wtk&&(Lb={["hasExceededReconnectionThrehold"]:!0,["numberOfSuccessfullConnections"]:this.a5d,["numberOfConnectionAttempts"]:this.$4d,
["firstConnectionAttempt"]:this.q2a?this.q2a.toISOString():"",["lastConnectionSuccess"]:this.xIc?this.xIc.toISOString():"",["lastUnexpectedDisconnect"]:this.UXb?this.UXb.toISOString():"",["lastExplicitDisconnect"]:this.U3d?this.U3d.toISOString():"",["reconnectDurationInMs"]:this.vdh,["hasPageHiddenOrNetworkIssue"]:this.Yyl()},K.a.J(36804373,500,15,mb.a.toJSON(Lb))):(this.Mnh=this.xIc,vb.a.instance.kc("FirstPresenceUpdated",(new Date).getTime().toString()),this.vdh>this.ALl.Wtk&&(Lb={["hasExceededConnectionThrehold"]:!0,
["numberOfConnectionAttempts"]:this.$4d,["firstConnectionAttempt"]:this.q2a?this.q2a.toISOString():"",["firstConnectionSuccess"]:this.Mnh?this.Mnh.toISOString():"",["lastExplicitDisconnect"]:this.U3d?this.U3d.toISOString():"",["connectDurationInMs"]:this.vdh,["connectionDurationFromStopWatchInMs"]:Lb,["hasPageHiddenOrNetworkIssue"]:this.Yyl()},K.a.J(36804373,500,15,mb.a.toJSON(Lb))))}Pth(){this.AKl++;const Lb={["numberOfFailedConnections"]:this.AKl,["numberOfConnectionAttempts"]:this.$4d,["firstConnectionAttempt"]:this.q2a?
this.q2a.toISOString():"",["lastConnectionAttempt"]:this.Rag?this.Rag.toISOString():"",["lastExplicitDisconnect"]:this.U3d?this.U3d.toISOString():"",["lastConnectionFail"]:(new Date).toISOString(),["disconnectedDurationMs"]:this.Eol,["hasPageHiddenOrNetworkIssue"]:this.Xyl()};this.eoh?(b.ULS.sendTraceTag(508946246,500,15,mb.a.toJSON(Lb)),this.oXl("ClientRTCSetupFailureDueToServerError")):(b.ULS.sendTraceTag(36804375,500,15,mb.a.toJSON(Lb)),this.oXl("ClientRTCSetupFailureDueToClientError"))}oXl(Lb){!this.Xyl()&&
5E3<this.Eol&&uc.a("ClientRTCSetupFailureQoSErrorEnabled")&&sb.Health.instance.recordQosError(Lb,["PresenceExperienceDegraded"],!1,!0,!0,!1,null)}wIg(){this.Poh++;this.UXb=new Date;this.coh=window.document.hidden;this.goh=!this.Kj.xP}yDn(){this.AOn()&&this.Pth();this.U3d=new Date;this.Kxm()}Kxm(){this.Poh=this.a5d=this.$4d=0;this.xIc=this.UXb=this.Rag=this.q2a=null;this.eoh=!1}AOn(){return!!this.Rag&&!this.xIc&&!this.UXb}get vdh(){if(this.xIc){if(this.q2a&&1===this.a5d)return this.Op.aBf(this.q2a,
this.xIc);if(this.UXb&&1<this.a5d)return this.Op.aBf(this.UXb,this.xIc)}return 0}get Eol(){return this.UXb&&0<this.Poh?this.Op.aBf(this.UXb,new Date):this.q2a&&0<this.$4d?this.Op.aBf(this.q2a,new Date):0}}Object(c.a)(vc,"PptRealtimeChannelMetrics",null,[1453]);var wc=a(286),ub=a(253),aa=a(256);class Na{constructor(Lb,Rc,md,Zc,ld){this.hdn=Lb.toLowerCase();this.ZIc=Rc;this.un=md;this.Iz=Zc;this.Nq=ld;this.Iz.esa(Object(v.a)(this,this.ccd,"onShapeNodeLoaded"));this.Nq.N1h(Object(v.a)(this,this.vzg,
"onShapeViewElementUnlocked"))}dispose(){this.Iz.e6a(Object(v.a)(this,this.ccd,"onShapeNodeLoaded"));this.Nq.ppk(Object(v.a)(this,this.vzg,"onShapeViewElementUnlocked"))}kG(Lb){return this.qzm(Lb)||this.hll(Lb)}hll(Lb){if(!Lb||Lb.rg)return!1;const Rc=Lb.oa(aa.a.Xsf,"");return+new Date-+Lb.gWd<this.ZIc&&!!Rc&&Rc.toLowerCase()!==this.hdn}qzm(Lb){return!!this.lCf(Lb)}Bul(Lb){let Rc="";Lb&&this.hll(Lb)&&(Rc=Lb.gb(aa.a.Xsf));return Rc}lCf(Lb){return Lb?Lb.oa(aa.a.$eh,""):""}EAf(Lb){return Lb?Lb.oa(aa.a.qjl,
""):""}rYn(Lb){if(Lb&&(Lb.kG=this.kG(Lb),Lb.anchor)){const md=this.un.rsa(Lb);for(;md.moveNext();){var Rc=md.currentNode;ub.ParagraphReader.me(Rc)&&(Rc=Object(Y.a)(wc.AParagraphNode,Rc))&&(Rc.kG=Lb.kG)}}}vzg(Lb,Rc){this.rYn(Rc.cI.shapeNode)}ccd(Lb,Rc){Lb=Rc.node;Lb.L9l();Lb.kG=this.kG(Lb)}}Object(c.a)(Na,"PptWetChangeHandler",null,[1452,24]);class ia{constructor(Lb){this.Adn=Lb}eTa(){return this.Adn.eTa()}}Object(c.a)(ia,"PresenceCache",null,[]);var wa=a(880),pa=a(1627),Ea=a(1601),La=a(1588);class Aa extends e.a{constructor(){super();
this.fph=[]}GJb(Lb){Lb&&(K.a.J(8958528,814,50,"PresenceDataManager : AddPresence; clientId: {0}; presence: {1}",Lb.clientId,Lb.presence.toString()),Array.add(this.fph,Lb))}iuh(Lb){(Lb=this.VKd(Lb))&&this.rLe(Lb);return Lb}rLe(Lb){Lb&&(K.a.J(507843860,814,50,"PresenceDataManager : RemovePresence; clientId: {0}; presence: {1}",Lb.clientId,Lb.presence.toString()),Array.remove(this.fph,Lb))}VKd(Lb){for(const Rc of this.fph)if(Rc.clientId===Lb)return Rc;return null}eTa(){return this.fph}}Object(c.a)(Aa,
"PresenceDataManager",e.a,[]);var nb=a(257),Wa=a(1495);class ea{constructor(Lb,Rc,md,Zc,ld,fe,Ac,R,za,X,lb){this.clientId=Lb;this.data=Ac;this.chatThreadId=Rc;this.chatThreadDiscoveryUri=md;this.inChat=Zc;this.email=ld;this.capabilities=fe;this.userName=R;this.clientType=za;this.fHasClientEverExperiencedNetworkLoss=X;this.isAnonymous=lb}}Object(c.a)(ea,"SerializablePresenceInfo",null,[]);class Kb{constructor(Lb,Rc,md,Zc,ld,fe,Ac,R,za,X,lb){this.Hlg=null;this.a_=Lb.toLowerCase();this.jK=Rc;this.HMj=
md;this.nHl=Zc;this.mHl=ld;this.qJl=fe;this.U$c=Ac;this.jHl=R;this.VEa=za;this.zLl=X;this.lIl=lb}dVi(){return new ea(this.a_,this.nHl,this.mHl,this.qJl,this.U$c,this.jHl.capabilities,this.HMj?this.HMj.dVi():null,this.VEa,this.zLl,this.lIl,y.AFrameworkApplication.dfc||y.AFrameworkApplication.a1)}sYm(Lb){if(!(Lb&&this.$v.equals(Lb.slideId)&&this.presence&&this.presence.XPa))return!1;for(const Rc of this.presence.XPa)if(Rc===Lb.get_shapeId())return!0;return!1}get presence(){return this.HMj}get clientId(){return this.a_}get chatThreadId(){return this.nHl}get chatThreadDiscoveryUri(){return this.mHl}get inChat(){return this.qJl}get email(){return this.U$c}get capabilities(){return this.jHl}get $v(){return this.jK}get userName(){return this.VEa}get clientType(){return this.zLl}get fHasClientEverExperiencedNetworkLoss(){return this.lIl}get presenceUser(){return this.Hlg}set presenceUser(Lb){this.Hlg&&
(Lb?!this.Hlg.client||0===this.Hlg.client||Lb.client&&0!==Lb.client||K.a.J(50942305,814,50,"PresenceEntry::SetPresenceUser; Specific to non-specific ClientType {0}.",this.a_):K.a.J(50942303,814,50,"PresenceEntry::SetPresenceUser; Non-null to null PresenceUser {0}.",this.a_));this.Hlg=Lb}static Rdh(Lb){if(!Lb||!Lb.clientId)return K.a.J(50942301,814,50,"PresenceEntry : CreateFromData; Invalid presence info"),null;const Rc=Wa.a.Rdh(Lb.data);let md=0;Lb.clientType&&8>=Lb.clientType&&(md=Lb.clientType);
return new Kb(Lb.clientId,Rc.$v,Rc,Lb.chatThreadId,Lb.chatThreadDiscoveryUri,Lb.inChat,Lb.email,new P.a(Lb.capabilities),Lb.userName,md,Lb.fHasClientEverExperiencedNetworkLoss)}}Object(c.a)(Kb,"PresenceEntry",null,[]);class kc extends Sys.EventArgs{constructor(Lb,Rc,md,Zc,ld,fe){super();this.jK=Lb;this.bfn=md;this.Sph=Rc;this.Fim=Zc;this.sen=ld;this.Bdn=fe}get slideId(){return this.jK}get user(){return this.bfn}get shapes(){return this.Sph}get Psa(){return this.Fim}get H5l(){return this.sen}get AVl(){return this.Bdn}}
Object(c.a)(kc,"SlidePresenceChangedEventArgs",Sys.EventArgs,[]);var ac=a(251);class eb extends e.a{constructor(Lb,Rc,md,Zc,ld,fe,Ac,R,za,X,lb,oc,Oc,sd,Ld,Qd,Id,he,xb,Sb,Cc,qb,Ob,Pb,qc,Uc,pd){super();this.REa=new Aa;this.es=null;this.BHl=[];this.CHl=null;this.pGe=!0;this.U1d=!1;this.cKl=new Date;this.dbd=null;this.qIl=this.Obn=this.XIl=!1;this.eph=null;this.mpb=Lb;Lb.userName||(Lb.userName=Pb);this.Fb=Rc;this.H3=md;this.a_=Zc.clientId;this.Jha=Zc.IB;this.tg=ld;this.fc=Cc;this.Ojg=Sb;this.YTa=qb;this.B2a=
pd;Ob.execute(Od=>{this.es=Od});this.m0m();this.Op=Oc;this.Gr=sd;this.zad=Ld.EDl;this.p2d=Ld.n5a;this.Dcn=Ld.sJe;this.TJl=y.AFrameworkApplication.DE;this.PHj=Ld.Rh&&Ld.Pcd;this.pa=fe;this.pa.QM(Object(v.a)(this,this.QH,"onSelectionChanged"));this.Io=Ac;this.Io.Hfl(Object(v.a)(this,this.Psn,"onValidShapeIdLoaded"));this.kd=R;this.kd.Fea(Object(v.a)(this,this.Mnn,"onActiveSlideDOMReady"));this.Oca=za;this.Oca.eaf(Object(v.a)(this,this.Jrh,"onEditorTableUpdate"));this.Dh=Qd;this.Dh.sE(Object(v.a)(this,
this.JI,"onSessionEnd"));this.Dh.VG(Object(v.a)(this,this.Oq,"onSessionRehydrated"));this.Dh.IXa(Object(v.a)(this,this.Ebe,"onOutboundReplication"));this.Zan=Ld.WJe;this.ia=lb;this.va=X;this.gph=oc;this.mnh=Id;this.Z5d=he;this.wGe=xb;Ld.Rh&&(this.Dh.cbh(Object(v.a)(this,this.sQc,"onSessionAccessTokenExpiring")),this.Dh.Ztd(Object(v.a)(this,this.ZEa,"onSessionAccessTokenExpired")),this.Dh.$td(Object(v.a)(this,this.OIe,"onSessionExpired")),this.Fb.fg(()=>{this.mpb.userName=this.Fb.appSettings.UserName;
this.mpb.email||(this.mpb.email=y.AFrameworkApplication.ga.La("UserPrincipalName"));this.fc.dO||(K.a.J(512360717,814,50,"PresenceManager : Disconnect from RTC"),this.disconnect());this.PHj&&this.Dh.fsa(Object(v.a)(this,this.eE,"onUnifiedAppStateChanged"))}),this.TJl&&this.Dh.Sye(Object(v.a)(this,this.fbb,"onWopiTokenRefreshed")));K.a.J(512360716,814,50,"PresenceManager - m_isWopiTokenRefreshEnabled:{0}",this.TJl)}Hb(){this.ia.sa(ac.a.a4b,nb.a.application,Object(v.a)(this,this.a4b,"querySlidePresenceUsers"),
96)}a4b(Lb,Rc,md,Zc,ld){ld.upe=this.dHf(ld.slideId);ld.Wbk=this.NCe();return 32}dHf(Lb){return(Lb=this.Gwl(Lb))?Lb.length:0}m0m(){this.H3.Otd(Object(v.a)(this,this.gzm,"connectionStateChanged"));this.H3.$ah(Object(v.a)(this,this.xAn,"presenceUpdated"));y.AFrameworkApplication.ga.getBooleanAppSetting("PPTForceUpdateEditorTableEnabled")&&this.H3.Zmc(Object(v.a)(this,this.TXn,"updateNotificationReceived"));N.a.getInstance().Wpm(Object(v.a)(this,this.cQl,"onGotCompletePersistentStateWithMetadata"));this.dbd=
this.Jha.wl("WebServiceCall","RtcConnection");this.YTa.fql();this.H3.connect()}xXl(){const Lb=this.H3.Kgh();this.U9l(new pa.a(Lb,null));this.yPg()}cQl(Lb,Rc){this.YTa.iql(Rc.yAn);N.a.getInstance().TFn(Object(v.a)(this,this.cQl,"onGotCompletePersistentStateWithMetadata"))}gzm(Lb,Rc){K.a.J(512360715,814,50,"PresenceManager : Connection State changed; oldState: {0}; newState: {1}; MyClientId: {2}",eb.$Ki(Rc.oldState),eb.$Ki(Rc.newState),this.a_);switch(Rc.newState){case 2:this.dbd.stop();Lb=this.dbd.nv;
this.YTa.eql();this.xXl();this.Ojg.kXl(Lb);break;case 1:2===Rc.oldState&&this.Ojg.wIg();this.Ojg.Oth();break;case 0:this.pGe?this.Lxm():2===Rc.oldState&&(window.setTimeout(()=>{this.H3.connect()},0),K.a.J(512360714,814,50,"PresenceManager : Reconnect rtc; Session time: {0}",this.tg.PCe().getTime()),this.Ojg.wIg())}}getSelectedShapes(){if(!this.zad)return null;const Lb=[],Rc=this.pa.ud();for(let md=0;md<Rc.length;++md)Array.add(Lb,Rc[md].get_shapeId());0<Lb.length&&Lb.sort();return Lb}Lxm(){var Lb=
this.REa.eTa();if(Lb&&Lb.length){Lb=Array.clone(Lb);for(const Rc of Lb)this.rLe(Rc);this.raiseEvent("PresenceChanged")}}Oxk(Lb,Rc){try{this.mpb.email||(this.mpb.email=y.AFrameworkApplication.ga.La("UserPrincipalName"));const md=new Wa.a(Lb,Rc),Zc=new Kb(this.mpb.clientId,Lb,md,this.mpb.chatThreadId,this.mpb.chatThreadDiscoveryUri,this.mpb.inChat,this.mpb.email,this.mpb.capabilities,this.mpb.userName,1,this.Obn);this.mpb.email||K.a.J(512360713,814,15,"PresenceManager : SendPresence; empty email for user");
this.H3.Oxk(Zc.dVi()).continueWith(()=>{K.a.J(8958538,814,50,"PresenceManager : SendPresence; Send presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.a_,md.toString(),this.tg.PCe().getTime())});this.cKl=new Date;this.YTa.wFl();this.xDn(Lb,Rc);K.a.J(8958540,814,50,"PresenceManager : SendPresence; Sending presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.a_,md.toString(),this.tg.PCe().getTime());this.DDn(md)}catch(md){K.a.J(512360712,814,10,"PresenceManager : SendPresence; Exception creating presence data {0}; MyClientId: {1};",
md.toString(),this.a_)}}xAn(Lb,Rc){Lb=!!this.es&&this.es.CJa;K.a.J(8958544,814,50,"PresenceManager : PresenceUpdated; Received presence update; MyClientId: {0}, Rehydrating: {1} ",this.a_,Lb);if(!Lb){this.YTa.yFl(Rc.hPe);Lb=null;this.Jha&&(Lb=this.Jha.wl("ServerNotification","Presence Updated"));try{this.U9l(Rc)}finally{Lb&&Lb.stop()}}}TXn(Lb,Rc){K.a.J(512360711,814,50,"PresenceManager : Update notification received; Type: {0}; MyClientId: {1}",Rc.type,this.a_)}U9l(Lb){this.Rom(Lb.hPe);this.Cdd(Lb.Dol);
K.a.J(8958546,814,50,"PresenceManager::UpdatePresenceCache; Refresh Peoples Well on presence update");this.raiseEvent("PresenceChanged")}yPg(){this.va.$v?this.Oxk(this.va.$v,this.getSelectedShapes()):K.a.J(512360708,814,50,"PresenceManager::SendCurrentSelection: m_graphTopologyManager.CurrentSlideId is null")}QH(){if(this.va.$v){var Lb=this.getSelectedShapes();(eb.tYm(this.CHl,this.va.$v)||eb.t7i(Lb,this.BHl))&&this.yPg()}else K.a.J(512360707,814,50,"PresenceManager::OnSelectionChanged: m_graphTopologyManager.CurrentSlideId is null")}Mnn(Lb,
Rc){Rc.Ga?this.va.$v?this.yPg():K.a.J(512360705,814,50,"PresenceManager::OnActiveSlideDOMReady: m_graphTopologyManager.CurrentSlideId is null"):K.a.J(512360706,814,50,"PresenceManager::OnActiveSlideDOMReady: ActiveSlide is null")}Psn(Lb,Rc){this.va.$v?Array.contains(this.getSelectedShapes(),Rc.shapeNode.get_shapeId())&&this.yPg():K.a.J(512360704,814,50,"PresenceManager::OnValidShapeIdLoaded: m_graphTopologyManager.CurrentSlideId is null")}IQn(Lb,Rc,md){Rc=this.$tl(Rc);Lb=this.$tl(Lb);this.tg.aul().Lec.raiseEvent(eb.gtf,
new Ea.a(this.Op.IP,null,Rc,Lb,null,0,0,md))}$tl(Lb){const Rc=new Map;for(let md=0;md<Lb.length;md++){const Zc=Lb[md];if(!Zc)continue;if(Zc.ID===this.Op.IP)continue;if(!Zc.EmailAddress){Rc.set(Zc.ID,this.Ztl(Zc));continue}const ld=this.REa.VKd(this.Op.IP);ld&&ld.email&&Zc.EmailAddress&&ld.email.toUpperCase()===Zc.EmailAddress.toUpperCase()||Rc.set(Zc.EmailAddress.toUpperCase(),this.Ztl(Zc))}return[...Rc.values()]}Ztl(Lb){const Rc=new La.a;Rc.EmailAddress=Lb.EmailAddress;Rc.Id=Lb.ID;Rc.Name=Lb.Name;
return Rc}Jrh(Lb,Rc){this.IQn(Rc.jtj,Rc.j6h,Rc.rCl);if(Lb=this.Op.a8){var md=Rc.jtj;for(var Zc=0;Zc<md.length;Zc++)this.mnh.JSn(md[Zc].ID);md=[];Rc=Rc.j6h;for(Zc=0;Zc<Rc.length;Zc++){const fe=Rc[Zc],Ac=fe.ID;if(Ac!==this.Op.IP){const R=this.REa.VKd(Ac);R?this.wGe.P9h(R.email,fe.EmailAddress):Array.add(md,Ac)}}this.mnh.eom(md);2<=Lb.length&&K.a.J(512360674,814,50,"PresenceManager : EditorTable has atleast 2 coauthors; MyClientID: {0}; EditorTableCount: {1}",this.a_,Lb.length);md=[];Rc=[];for(var ld of Lb)Array.add(md,
ld.ID),ld.ID===this.Op.IP||this.REa.VKd(ld.ID)||Array.add(Rc,ld.ID);K.a.J(512360673,814,50,"PresenceManager : OnEditorTableUpdate; Received Editor Table update; MyClientID: {0}; editorTableCount: {1}; ClientIDs : {2}; ClientIDs with missing presence: {3}",this.a_,Lb.length,md.join(","),Rc.join(","));for(const fe of this.REa.eTa())({editor:ld}=this.Op.f0c(fe.clientId)).returnValue?(this.CDn(fe),Lb=this.Z5d.w_a(new wa.a(ld.EmailAddress,void 0,ld.Name),ld.ID,0),fe.presenceUser=new r.a(fe.clientId,ld.Name,
Lb,new P.a(1),null,null,fe.clientType),this.gph.PHg(new kc(fe.$v,fe.presence.XPa,fe.presenceUser,!0,this.dHf(fe.$v),this.NCe())),K.a.J(512360671,814,50,"PresenceManager : OnEditorTableUpdate; Adding/Updating presence UI; ClientId: {0};  Presence: {1}; Color: {2}; MyClientId: {3};",fe.clientId,fe.presence.toString(),fe.presenceUser.color,this.a_)):K.a.J(512360670,814,50,"PresenceManager : OnEditorTableUpdate; Client not in Editor table; ClientId: {0};  Presence: {1}: Color: {2}; MyClientId: {3};",
fe.clientId,fe.presence.toString(),fe.presenceUser?fe.presenceUser.color:"",this.a_);this.raiseEvent("PresenceChanged")}else K.a.J(512360675,814,50,"PresenceManager : OnEditorTableUpdate; Received null on Editor Table update; MyClientID: {0};",this.a_)}JI(Lb,Rc){this.mnh.HSn();5!==Rc.aI&&(K.a.J(512360669,814,50,"PresenceManager : OnSessionEnd - Disconnect from RTC"),this.disconnect())}sQc(){K.a.J(512360668,814,50,"PresenceManager : OnSessionAccessTokenExpiring");this.U1d||(K.a.J(512360667,814,50,
"PresenceManager : OnSessionAccessTokenExpiring; Access token expired"),this.U1d=!0)}ZEa(){K.a.J(512360666,814,50,"PresenceManager : OnSessionAccessTokenExpired; Disconnecting from RTC");this.U1d||(K.a.J(512360665,814,50,"PresenceManager : OnSessionAccessTokenExpired; Access token expired"),this.U1d=!0)}OIe(){K.a.J(512360664,814,50,"PresenceManager : OnSessionExpired - Disconnect from RTC");this.disconnect()}fbb(Lb,Rc){K.a.J(512360663,814,50,"PresenceManager : OnWopiTokenRefreshed");try{Rc.FVf?(K.a.J(512360662,
814,50,"PresenceManager::OnWopiTokenRefreshed Token refresh succeeded. - RTC Connection State: {0}",eb.$Ki(this.H3.connectionState)),this.U1d=!1,this.PHj&&!this.fc.dO?K.a.J(512360661,814,15,"PresenceManager : OnWopiTokenRefreshed; Do not connect to RTC in readonly mode"):this.pGe||2!==this.H3.connectionState?this.connect():(Lb={},Lb.qs=this.B2a.Nh.string,K.a.J(512360660,814,50,"PresenceManager : OnWopiTokenRefreshed; Calling UpdateClientInfo"),this.H3.Sfd(Lb))):K.a.J(512360659,814,15,"PresenceManager::OnWopiTokenRefreshed Token refresh failed.")}catch(md){K.a.J(512360658,
814,10,"PresenceManager::OnWopiTokenRefreshed Exception: {0}",md)}}Oq(Lb,Rc){this.Dcn&&this.U1d||this.PHj&&!this.fc.dO?K.a.J(512360657,814,50,"PresenceManager : OnSessionRehydrated; Do not connect to RTC; IsAccessTokenExpired={0}; IsInEditingModeOrCanEditAnyway={1};",this.U1d,this.fc.dO):4!==Rc.Ldc||this.pGe?this.connect():(K.a.J(512360656,814,50,"PresenceManager : OnSessionRehydrated - catch up presence"),this.xXl())}eE(Lb,Rc){Rc.PEe&&!this.fc.dO&&(K.a.J(512360655,814,50,"PresenceManager : OnUnifiedAppStateChanged; Change to readonly, disconnect from RTC"),
this.disconnect())}connect(){K.a.J(512360654,814,50,"PresenceManager : Connect");this.pGe=!1;this.H3.connect()}Ebe(){this.GOn()&&(K.a.J(512360653,814,50,"PresenceManager : OnOutboundReplication; Send presence update for editing actions"),this.yPg())}GOn(){const Lb=this.H3.JQm();return Lb?2===Lb.status||+new Date-+this.cKl>this.Zan?!0:!1:!1}fDl(){const Lb=this.REa.eTa();if(0<Lb.length)for(const Rc of Lb)if(Rc.presence&&Rc.presence.$v)return!0;return!1}vOn(){return!this.XIl&&this.p2d&&2!==this.Op.Hja}Rom(Lb){for(const md in Lb){var Rc=
Lb[md];try{const Zc=Kb.Rdh(Rc);if(!Zc||Zc.clientId===this.a_)continue;const ld=Zc.clientId;this.vOn()&&(this.XIl=!0,this.Gr.Xec(2),K.a.J(512360652,814,50,"PresenceManager : Update coauth status to Coauthoring from RTC"));K.a.J(39326610,814,50,"PresenceManager : AddOrUpdatePresence; ClientId: {0}; NewPresence: {1};",ld,Zc.presence.toString());const fe=Zc.email;if(!this.wGe.jhh(fe)){let Ac;({editor:Ac}=this.Op.f0c(ld)).returnValue&&this.wGe.P9h(fe,Ac.EmailAddress)}this.Tom(Zc);this.YTa.dql()}catch(Zc){K.a.J(512360651,
814,10,"PresenceManager : AddOrUpdatePresence; Invalid Presence Data Received {0}; MyClientId: {1};",Zc.toString(),this.a_)}}this.YTa.xFl(Lb)}Tom(Lb){this.NGm(Lb);const Rc=this.H3.x_a(Lb.clientId);Rc&&2===Rc.status?K.a.J(39326613,814,50,"PresenceManager : AddOrUpdatePresenceWithAwayStatus; Do not add presence for inactive user; ClientId: {0};",Lb.clientId):this.Som(Lb)}Som(Lb){const Rc=this.REa.VKd(Lb.clientId);if(Rc){if(!this.nYm(Rc,Lb))return;K.a.J(8958560,814,50,"PresenceManager : AddOrUpdatePresence; Updating existing presence; ClientId: {0};  ExistingPresence: {1}; NewPresence: {2}; MyClientId: {3};",
Lb.clientId,Rc.presence.toString(),Lb.presence.toString(),this.a_);this.rLe(Rc)}this.$om(Lb)}rLe(Lb){Lb&&(this.REa.rLe(Lb),Lb.presenceUser&&this.gph.PHg(new kc(Lb.$v,Lb.presence.XPa,Lb.presenceUser,!1,this.dHf(Lb.$v),this.NCe())))}kql(Lb){if(Lb)if(Lb.presenceUser)K.a.J(512360649,814,100,"PresenceManager:AddOrUpdatePresence; PresenceUser already created for ClientId{0};",Lb.clientId);else{const Rc=this.awl(Lb.clientId);Rc?Lb.presenceUser=Rc:K.a.J(512360650,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",
Lb.clientId)}}$om(Lb){Lb&&(this.REa.GJb(Lb),this.mnh.ISn(Lb.clientId),this.kql(Lb),Lb.presenceUser?this.gph.PHg(new kc(Lb.$v,Lb.presence.XPa,Lb.presenceUser,!0,this.dHf(Lb.$v),this.NCe())):K.a.J(512360648,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",Lb.clientId))}nYm(Lb,Rc){let md;(md=!Lb.$v.equals(Rc.$v))&&K.a.J(512360647,814,50,"Slide Presence Changed - CurrentSlide: {0} ; NewSlide: {1}",Lb.$v,Rc.$v);(Lb=this.zad&&eb.UNn(Lb,Rc))&&K.a.J(512360646,814,50,"Shape Presence Changed");
return md||Lb}Cdd(Lb){if(Lb){for(let Rc=0;Rc<Lb.length;Rc++)Lb[Rc]=Lb[Rc].toLowerCase();for(const Rc of Lb)K.a.J(512360645,814,50,"PresenceManager : RemovePresence; Removing presence for disconnected clients; ClientId: {0}",Rc),(Lb=this.REa.iuh(Rc))?Lb.presenceUser?this.gph.PHg(new kc(Lb.$v,Lb.presence.XPa,Lb.presenceUser,!1,this.dHf(Lb.$v),this.NCe())):K.a.J(512360643,814,15,"PresenceManager : RemovePresence; entry.PresenceUser is null"):K.a.J(512360644,814,15,"PresenceManager : RemovePresence; entry did not exist")}}Gwl(Lb){const Rc=
[];for(const md of this.REa.eTa())md.$v.equals(Lb)&&md.presenceUser&&Array.add(Rc,md.presenceUser);return Rc}BVi(Lb){const Rc=[];for(const md of this.REa.eTa())md.presence&&md.sYm(Lb)&&md.presenceUser&&Array.add(Rc,md.presenceUser);return Rc}J7c(){const Lb=[];for(const Rc of this.REa.eTa())Rc.presenceUser&&Array.add(Lb,Rc.presenceUser);return Lb}NCe(){const Lb=this.J7c();return Lb?Lb.length:0}bQb(Lb){if(!Lb)return null;Lb=Lb.toLocaleLowerCase();for(const Rc of this.REa.eTa())if(Rc.presenceUser&&Rc.presenceUser.clientId===
Lb)return Rc.presenceUser;return this.awl(Lb)}iuh(Lb){const Rc=this.REa.VKd(Lb);this.rLe(Rc);K.a.J(512360641,814,50,"PresenceManager : RemoveUserPresence; Removing presence; ClientId: {0};  MyClientId: {1};",Rc?Rc.clientId:Lb+" not found",this.a_)}Cqm(Lb){this.addHandler("PresenceChanged",Lb)}eTa(){return this.REa.eTa()}connectionState(){return this.H3.connectionState}disconnect(){try{K.a.J(512360640,814,50,"PresenceManager : Disconnect"),this.pGe||this.Ojg.yDn(),this.pGe=!0,this.H3.disconnect()}catch(Lb){K.a.J(512360611,
814,10,"PresenceManager : Disconnect; Exception disconnecting rtc; Message: {0}; Callstack: {1}",Lb.message,Lb.stack)}}xDn(Lb,Rc){this.CHl=Lb;this.BHl=Rc}awl(Lb){let Rc;const md=({editor:Rc}=this.Op.f0c(Lb)).returnValue;var Zc=this.H3.NQb(Lb),ld=!!Zc;if(!md&&!ld)return K.a.J(512360610,814,50,"PresenceUser:GetPresenceUser; ClientId {0} neither in presence nor rtc.",Lb),null;Zc=ld?Zc:null;md||K.a.J(512360609,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in EditorTable",Lb);ld||K.a.J(512360608,
814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in Presence",Lb);ld&&md&&K.a.J(512360607,814,50,"PresenceUser:GetPresenceUser; ClientId {0} in both. IsSameID={1}, IsSameEmail={2}.",Lb,Zc.clientId!==Rc.ID,Zc.email!==Rc.EmailAddress);var fe=md?new wa.a(Rc.EmailAddress,void 0,Rc.Name):new wa.a(this.wGe.jhh(Zc.email)||Zc.email,void 0,Zc.userName);fe=this.Z5d.w_a(fe,md?Rc.ID:Zc.clientId,0);ld=ld?Zc.clientType:0;return new r.a(Lb,md?Rc.Name:Zc.userName,fe,new P.a(1),null,null,ld)}CDn(Lb){this.va.$v.equals(Lb.$v)&&
Lb.presence.XPa&&Lb.presence.XPa.length&&K.a.J(512360606,814,50,"PresenceManager : {0}; Begin to add shape presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",Lb.clientId,Lb.presence.toString(),this.a_,this.tg.PCe().getTime());K.a.J(512360605,814,50,"PresenceManager : {0}; Begin to add slide presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",Lb.clientId,Lb.presence.toString(),this.a_,this.tg.PCe().getTime())}DDn(Lb){const Rc=
[this.Op.userName];let md=0;for(var Zc of this.REa.eTa())Zc.presence.$v.equals(Lb.$v)&&!eb.t7i(Zc.presence.XPa,Lb.XPa)&&(md++,Zc.presenceUser&&Array.add(Rc,Zc.presenceUser.userName));if(0<md){Zc={};let ld=0,fe=0;for(let Ac=0;Ac<Rc.length;++Ac){let R=Rc[Ac];R&&R.length||(R="anonymous",fe++);R in Zc||(Zc[R]=!0,ld++)}K.a.J(512360604,814,50,"PresenceManager : {0} users, {2} unique users are selecting same {1}. {3} users have no identity",md+1,Lb.XPa&&0<Lb.XPa.length?"shape":"slide",ld,fe)}}NGm(Lb){try{this.YTa.mrl()&&
!this.REa.VKd(Lb.clientId)&&(this.kql(Lb),this.OGm(Lb.presenceUser))}catch(Rc){K.a.J(512360603,814,15,"PresenceManager:EndPresenceBootTelemetry; Exception {0};",Rc.toString())}}OGm(Lb){Lb&&Lb.clientId&&(this.qIl||this.eph||(this.qIl=!0,this.eph=w.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),this.eph&&this.eph.PGm(Lb.clientId,eb.tSm(Lb)))}static $Ki(Lb){let Rc="";switch(Lb){case 2:Rc="Connected";break;case 1:Rc="Connecting";break;case 0:Rc="Disconnected"}return Rc}static t7i(Lb,
Rc){if(!Lb&&!Rc)return!1;if(!Lb&&Rc||Lb&&!Rc||Lb.length!==Rc.length)return!0;for(let md=0;md<Lb.length;md++)if(Lb[md]!==Rc[md])return!0;return!1}static tYm(Lb,Rc){return!qa.a.DUa(Lb,Rc)}static UNn(Lb,Rc){return Lb.$v.equals(Rc.$v)&&eb.t7i(Lb.presence.XPa,Rc.presence.XPa)}static tSm(Lb){return Lb&&1===Lb.client?1:0}}eb.gtf="ETU";Object(c.a)(eb,"PresenceManager",e.a,[1448,1449,1450,1451]);var Hb=a(1638),ua=a(1640),Va=a(1536),Yb=a(135),Cb=a(268),ca=a(512);class Ra{constructor(Lb,Rc,md,Zc,ld){this.rS=
null;this.A3=y.AFrameworkApplication.ga.getBooleanAppSetting(Oa.a.itb);Rc=this.NRm(Rc,Zc,ld);this.rS=this.A3?(new Hb.a(Rc)).umf(Lb):(new ua.a(Rc)).Qdh(Lb,md)}dispose(){this.rS.dispose()}Ubk(){return Cb.a.Ni(document.getElementById(ca.a.xzb))}NRm(Lb,Rc,md){const Zc=new Va.a;Zc.add(0,Yb.e(y.AFrameworkApplication.iS,"MoreUsersGlyph_16x16x32"));Zc.add(5,y.AFrameworkApplication.jp);Zc.add(1,Yb.e(y.AFrameworkApplication.iS,this.A3?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph_16x16x32"));Zc.add(4,
y.AFrameworkApplication.jp);Zc.add(6,md);Zc.add(8,y.AFrameworkApplication.isRtl);Zc.add(12,Lb);Zc.add(11,Rc);this.A3&&(Zc.add(16,Object(v.a)(this,this.Ubk,"presenceViewportBoundsCallback")),Zc.add(17,!0));return Zc}h0(Lb){this.rS?(K.a.J(8958619,814,50,"PresencePawn:AddUser at PresencePawn for ClientId {0}",Lb.clientId),this.rS.h0(Lb)):K.a.J(509219530,814,10,"PresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {0}",Lb.clientId)}Bqa(Lb){this.rS?(K.a.J(509219528,814,50,"PresencePawn:RemoveUser at PresencePawn for ClientId {0}",
Lb.clientId),this.rS.Bqa(Lb.clientId)):K.a.J(509219529,814,15,"PresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser for ClientId {0}",Lb.clientId)}clear(){if(this.rS)if(K.a.J(509219526,814,50,"PresencePawn:Clear at PresencePawn "),this.kTa())for(const Lb of this.kTa())this.Bqa(Lb);else K.a.J(509219525,814,50,"PresencePawn:Clear - Pawn has no users");else K.a.J(509219527,814,15,"PresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}kTa(){return this.rS?this.rS.DKe:
null}d5l(){this.rS&&(this.A3&&this.rS.rDb(),this.rS.Cec())}lzl(){this.rS&&this.rS.rDb()}}Object(c.a)(Ra,"PresencePawn",null,[772,24]);class bb{bnl(Lb,Rc,md){return new Ra(Lb,2,Rc,!0,md)}}Object(c.a)(bb,"PresencePawnFactory",null,[1357]);var wb=a(1233),Fa=a(252);class rb{constructor(Lb,Rc,md,Zc,ld,fe,Ac,R,za,X,lb){this.UKj=[];this.Xad=null;this.KIl=this.JIl=this.IEj=0;this.$nh=this.aoh=null;this.Xoh=[];if(!Rc)throw Error.argumentNull("graphTopologyManager");if(!md)throw Error.argumentNull("presenceManager");
if(!Zc)throw Error.argumentNull("dragInputManager");if(!ld)throw Error.argumentNull("coauthStateChangesHandler");this.kd=Lb;this.va=Rc;this.pR=md;this.Zw=Zc;this.Z0f=ld;this.aZb=fe;this.Ub=Ac;this.xe=R;this.jbd=za;this.$Yb=X;this.Sca=lb;this.$Yb.f$b(Object(v.a)(this,this.Hxh,"slidePresenceChanged"));this.kd.Fea(Object(v.a)(this,this.UAa,"onSlideNavigation"));this.kd.Daf(Object(v.a)(this,this.dbb,"onThumbnailRefresh"));this.kd.SJb(Object(v.a)(this,this.dAg,"onThumbnailVisibleRangeChanged"));this.CJl=
y.AFrameworkApplication.ga.getBooleanAppSetting(Oa.a.YDg);(this.A3=y.AFrameworkApplication.ga.getBooleanAppSetting(Oa.a.itb))&&this.CJl&&(this.JIl=y.AFrameworkApplication.ga.Jc("PPTCanvasPresenceFloodGateSurveyTimeLapseSec",30),this.KIl=y.AFrameworkApplication.ga.Jc("PPTCanvasPresenceFloodGateSurveyTriggerThreshold",3),this.IEj=0,this.Xad=z.a.aG(w.a.instance.Na("Common.ISystemInitiatedFeedbackWithTimeLapse")));this.kd.J4c(Object(v.a)(this,this.$Nn,"shapeViewElementAdded"));this.kd.L1h(Object(v.a)(this,
this.aOn,"shapeViewElementLocked"));this.kd.Yel(Object(v.a)(this,this.fsn,"onShapeViewElementShowLockHint"));this.kd.Zel(Object(v.a)(this,this.gsn,"onShapeViewElementShowPresenceHint"));this.kd.Wel(Object(v.a)(this,this.asn,"onShapeViewElementHidePresenceHint"))}UAa(){this.va.$v&&(K.a.J(512263071,814,50,"PresencePresenter::OnSlideNavigation; refreshing shape presence for slideId: {0}",this.va.$v),this.YDn(this.va.$v))}YDn(Lb){if(this.va.$v&&this.va.$v.equals(Lb)&&(K.a.J(512263070,814,50,"PresencePresenter::RefreshShapePresenceOnSlide refreshing presence for slideId: {0}",
Lb),Lb=new Fa.GraphIterator,Lb.set(this.va.Ga),Lb.Bb(1))){do if(0<Lb.currentNode.gb(aa.a.shapeId)){const Rc=Object(Y.a)(426,Lb.currentNode);Rc&&this.EXl(Rc)}while(Lb.xf(1))}}Hxh(Lb,Rc){this.Zw.CLa?(K.a.J(512263069,814,50,"PresencePresenter:SlidePresenceChanged - DragInputManager active."),this.$nh||(this.$nh=new h.a(2,1,0,()=>{this.handlePendingPresenceChangedEvent(Rc)},90,"68"),y.AFrameworkApplication.je.Qb(this.$nh)),Rc&&this.Xoh.push(Rc)):(this.kBn(Rc),this.jBn(Rc))}handlePendingPresenceChangedEvent(){this.$nh=
null;this.XDn();if(this.va.$v&&0<this.Xoh.length){const md={},Zc={};var Lb=this.va.$v;for(var Rc of this.Xoh){if(!Lb.equals(Rc.slideId))continue;if(!Rc.shapes||!Rc.user)continue;Rc.user.clientId in Zc||(md[Rc.user.clientId]=Rc.user,Zc[Rc.user.clientId]=new wb.a(0));const ld=Zc[Rc.user.clientId];for(const fe of Rc.shapes){const Ac=Rc.Psa?1:0;ld.Ob(fe)?0<(ld.ha(fe)^Ac)&&ld.K(fe,Ac):ld.add(fe,Ac)}}for(const ld in md){Lb=md[ld];Rc=ld;if(!(Rc in Zc))continue;const fe=[],Ac=[];Zc[Rc].forEach((R,za)=>{0<
za?Ac.push(R):fe.push(R);return!0});0<fe.length&&this.yYl(fe,Lb);0<Ac.length&&this.bel(Ac,Lb)}this.Xoh=[]}}kBn(Lb){Lb.Psa?this.GJb(Lb.slideId,Lb.user):this.Cdd(Lb.slideId,Lb.user)}dbb(Lb,Rc){this.DXl([Rc.RQk])}dAg(Lb,Rc){this.DXl(Rc.vda)}DXl(Lb){const Rc=[];for(const md of Lb)Lb=this.Sca?this.Ub.TCe(md):this.Ub.s$a(md),this.Sca&&0>=Lb.u_||Lb&&Array.add(Rc,Lb);this.CXl(Rc)}GJb(Lb,Rc){const md=this.fxl(Lb);md?(md.GJb(Rc),this.pvj(),K.a.J(512263067,814,50,"ThumbnailNavigationPaneView : Add slide presence succeeded. slideId  = {0}",
Lb.toString())):K.a.J(21770506,814,50,"ThumbnailNavigationPaneView : AddPresence - slideId is invalid {0}",Lb.toString())}Cdd(Lb,Rc){const md=this.fxl(Lb);md?md.Cdd(Rc):K.a.J(512263066,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Lb.toString())}fxl(Lb){const Rc=this.Ub.s$a(Lb);return Rc?Object(Y.a)(974,Rc.Qg(this.jbd)):(K.a.J(512263065,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Lb.toString()),null)}XDn(){const Lb=this.va.presentation;
if(!Lb)throw Error.argumentNull("Presentation is null");this.CXl(Lb.slides||[])}CXl(Lb){for(const md of Lb){var Rc=Object(Y.a)(32,md);Rc?(Lb=Rc.Xb,(Rc=Object(Y.a)(974,Rc.Qg(this.jbd)))?(K.a.J(512263062,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - updating presence for {0}",Lb.toString()),Rc.Ufd(this.pR.Gwl(Lb))):K.a.J(512263063,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - thumbnailViewElement is null for slide {0}",Lb.toString())):K.a.J(512263064,
814,10,"ThumbnailNavigationPaneView : RefreshPresenceForThumbnails - could not cast slide to ISlideNode while updating presence for {0}",md.Xb.toString())}}pvj(){this.A3&&this.CJl&&(this.FVn()||this.Xad&&this.Xad.continueWith(()=>{this.Xad.result.logActivity("PresenceBubbleRendered",Oa.a.YDg,this.JIl)&&this.IEj++}))}FVn(){return this.IEj>=this.KIl}jBn(Lb){this.va.$v&&this.va.$v.equals(Lb.slideId)&&Lb.shapes&&(Lb.Psa?this.bel(Lb.shapes,Lb.user):this.yYl(Lb.shapes,Lb.user))}$Nn(Lb,Rc){Lb=Rc.cI;this.DDl(Lb.shapeNode)&&
(this.UKj.push(Lb),this.aoh||(this.aoh=new h.a(2,1,0,Object(v.a)(this,this.handlePendingShapePresenceUpdate,"handlePendingShapePresenceUpdate"),90,"69"),y.AFrameworkApplication.je.Qb(this.aoh)))}handlePendingShapePresenceUpdate(){this.aoh=null;for(const Lb of this.UKj){if(!this.DDl(Lb.shapeNode))return;this.EXl(Lb.shapeNode)}Array.clear(this.UKj)}EXl(Lb){const Rc=Object(Y.a)(284,Lb.tc(this.xe));if(Rc&&!Lb.get_smartArtModelId()){var md=this.pR.BVi(Lb);if(md)if(md.length){Lb=this.aZb.w$(Lb);Lb.akl();
for(const Zc of md)Lb.GJb(Zc),this.pvj()}else(md=this.aZb.k5(Lb))&&md.akl();this.Z0f.fSl(Rc)}}bel(Lb,Rc){var md=this.Awl();let Zc=!1;for(const ld of md){if(!Array.contains(Lb,ld.get_shapeId())||ld.get_smartArtModelId())continue;md=Object(Y.a)(284,ld.tc(this.xe));if(!md||ld.get_smartArtModelId())continue;const fe=this.aZb.w$(ld);fe?(md.isSelected&&(fe.Fze=!1),fe.GJb(Rc),this.pvj(),md.isSelected&&fe.$tg()):Zc=!0}Zc||K.a.J(512263060,814,50,"PresencePresenter::AddShapePresence succeeded")}yYl(Lb,Rc){var md=
this.Awl();for(const Zc of md)Array.contains(Lb,Zc.get_shapeId())&&(md=this.aZb.w$(Zc))&&md.Cdd(Rc)}Awl(){let Lb=null;this.va.Ga&&(Lb=this.va.Ga.xj());return Lb||[]}DDl(Lb){return!!this.va.Ga&&this.va.Ga.Xb.equals(Lb.slideId)}aOn(Lb,Rc){this.aZb.w$(Rc.cI.shapeNode).Izh(Rc.presenceUser)}fsn(Lb,Rc){(Rc.cI.isLocked||Rc.cI.gNe)&&(Lb=this.aZb.k5(Rc.cI.shapeNode))&&Lb.XHk()}gsn(Lb,Rc){(Lb=this.aZb.k5(Rc.cI.shapeNode))&&Lb.nPn()}asn(Lb,Rc){(Lb=this.aZb.k5(Rc.cI.shapeNode))&&Lb.pRb()}}Object(c.a)(rb,"PresencePresenter",
null,[]);class $b{constructor(Lb){this.lmg=Lb}NQb(Lb){return this.lmg.NQb(Lb)}x_a(Lb){return this.lmg.x_a(Lb)}}Object(c.a)($b,"PresenceUserInfoGetter",null,[1359,1303]);class ec{constructor(Lb=null){this.Op=Lb}bwl(Lb){if(!Lb||!Lb.value)return null;Lb=Lb.value;let Rc=Lb.userName;if(!Rc&&this.Op){let md;({editor:md}=this.Op.f0c(Lb.clientId)).returnValue&&(Rc=md.Name)}return Object.assign(new r.a,{clientId:Lb.clientId,chatThreadId:Lb.chatThreadId,chatThreadDiscoveryUri:Lb.chatThreadDiscoveryUri,inChat:Lb.inChat,
email:Lb.email,capabilities:new P.a(Lb.capabilities),userName:Rc})}}Object(c.a)(ec,"PresenceUtils",null,[1443]);var pc;(function(Lb){Lb[Lb.coauthHandlerResponse=0]="coauthHandlerResponse";Lb[Lb.popSessionResponse=1]="popSessionResponse";Lb[Lb.defaultFallback=2]="defaultFallback"})(pc||(pc={}));Object(c.b)("RtcDiscoverType",pc);class dd{constructor(Lb,Rc,md,Zc,ld,fe,Ac,R,za,X,lb,oc,Oc,sd,Ld,Qd){this.avi=Lb;this.sWg=Rc;this.rWg=md;this.jDd=Zc;this.XDe=ld;this.hNf=fe;this.Hfd=Ac;this.D1g=R;this.zdd=
za;this.Pqf=X;this.Nqf=lb;this.Oqe=oc;this.vbd=Oc;this.XBd=sd;this.Opl=Ld;this.xyi=Qd}T$m(){return String.format("[DRL-{0},SEND-{1},SELE-{2},EELE-{3},IUI-{4},IULE-{5},TUI-{6},TULE-{7},RELI-{8},DTL-{9},DEL-{10}, STF-{11}, MLD-{12}, DTL-{13}, ETR-{14}, ETCL-{15}]",this.avi,this.sWg,this.rWg,this.jDd,this.XDe,this.hNf,this.Hfd,this.D1g,this.zdd,this.Pqf,this.Nqf,this.Oqe,this.vbd,this.XBd,this.Opl,this.xyi)}}Object(c.a)(dd,"RttLockSettings",null,[]);var Ad=a(430);class Jb{constructor(Lb,Rc,md,Zc){this.rbg=
this.qbg=null;this.E8k=!1;this.Aen=Lb;this.Ia=Rc;this.Cj=md;this.eUa=Zc;this.VHe=new Date;this.ZIc=-1}get hb(){return this.Aen}get ylh(){return this.E8k}set ylh(Lb){this.E8k=Lb}iIm(){return 0<this.ZIc&&Date.now()>=this.ZIc}E2l(Lb){this.ZIc=Lb}PHf(){return""}QHf(){return""}hLe(Lb){this.qbg=Lb?this.PHf():this.QHf();this.rbg=new Date}Fei(){}Rei(){return!1}D0l(Lb,Rc){Lb=Lb||"";Rc=Rc||"";if(Lb.length!==Rc.length)return null;const md=[];for(let Zc=0;Zc<Lb.length;Zc+=1)Lb.charAt(Zc)!==Rc.charAt(Zc)&&md.push(Zc);
return 0<md.length?mb.a.HM("Length",Lb.length,"FirstDiffPos",md[0],"DiffCount",md.length):null}p8c(Lb){return V.a.replaceAll(Lb,"\u00a0"," ").trim()}}Object(c.a)(Jb,"ATextContentRecord",null,[]);var Bc=a(20),Mc=a(260);class ed extends Jb{constructor(Lb,Rc,md,Zc){super(Lb,Rc,md,Zc);this.QMl=Lb.Cz}get shapeNode(){return Object(Y.a)(426,this.hb)}ANn(){this.QMl=this.shapeNode.Cz}PHf(){const Lb=new f.a;var Rc=this.shapeNode.wI();for(const md of Rc)(Rc=this.Cj.text(md))&&0<Rc.length&&Lb.add(Rc);return Lb.toArray().join(" ")}QHf(){return this.Ia.Kfa(this.shapeNode)}Fei(){try{const Lb=
this.PHf()||"",Rc=this.qbg||"";if(Lb!==Rc){const md=this.p8c(Lb)===this.p8c(Rc),Zc=this.QMl||this.shapeNode.Cz;if(!md&&!Zc&&!this.shapeNode.Zc){const ld=mb.a.HM("Shape",this.shapeNode.Ql,"Start",Mc.a.Lf(this.VHe),"LastSnapshotTime",Mc.a.Lf(this.rbg),"EverEdit",this.ylh,"Type",this.getShapeType());ld.Expiration=-1<this.ZIc?(+new Date(this.ZIc)-+this.VHe).toString():null;const fe=Lb.length-Rc.length;fe?ld.TextLengthDelta=fe:ld.SameLengthDiffDetails=this.D0l(Lb,Rc);K.a.J(25539747,814,15,Bc.c(ld))}}}catch(Lb){K.a.J(25981901,
814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Lb)}}Rei(){try{const Lb=this.eUa.lCf(this.shapeNode);if(Lb&&0<Lb.length)return!1;const Rc=this.QHf()||"",md=this.qbg||"";if(Rc!==md&&0>Rc.indexOf(md)&&!(0<=this.p8c(Rc).indexOf(this.p8c(md))||this.shapeNode.Zc)){const Zc=mb.a.HM("Shape",this.shapeNode.Ql,"Start",Mc.a.Lf(this.VHe),"LastSnapshotTime",Mc.a.Lf(this.rbg),"TextLengthDelta",Rc.length-md.length,"Type",this.getShapeType());K.a.J(25981903,814,15,Bc.c(Zc))}}catch(Lb){K.a.J(25981905,814,
10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Lb)}return!0}getShapeType(){return this.shapeNode.Zc?"Table":this.shapeNode.rg?"SmartArt":this.shapeNode.Uq?"TextBox":this.shapeNode.pl?"PlaceHolder":this.shapeNode.Vsa?"Shape":"Unknown"}}Object(c.a)(ed,"ShapeContentRecord",Jb,[]);class Yc{constructor(Lb,Rc,md,Zc,ld,fe,Ac,R,za,X,lb,oc,Oc){this.O7d=this.XHe=null;this.vAa={};this.UMc={};this.pa=R;this.Oca=za;this.od=Lb;this.NA=Rc;this.ecn=md;this.Iz=Zc;this.va=ld;this.ih=fe;this.eUa=Ac;this.Ia=
X;this.Ac=lb;this.fQj=oc;this.GP=Oc;this.pa.Nye(Object(v.a)(this,this.Syg,"onPreSelectionChanged"));this.pa.QM(Object(v.a)(this,this.cCb,"onSetSelectionFinished"));this.Oca.Afl(Object(v.a)(this,this.Asn,"onTableCellViewElementLocked"));this.od.pel(Object(v.a)(this,this.Mtm,"beforeProcessInboundResponse"));this.NA.e$b(Object(v.a)(this,this.dsn,"onShapeViewElementOpenTextEditView"));this.NA.K4c(Object(v.a)(this,this.$rn,"onShapeViewElementCloseTextEditView"));this.NA.L1h(Object(v.a)(this,this.csn,"onShapeViewElementLocked"));
this.ecn.Vtd(Object(v.a)(this,this.zsn,"onSuccessfulInbound"));this.Iz.Am(Object(v.a)(this,this.Gh,"onPropertyChanged"));this.ih.aS(Object(v.a)(this,this.yR,"onActiveSlideChanged"))}dsn(Lb,Rc){Lb=Object(Y.a)(426,Object(Y.a)(Ad.a,Rc.cI).hb);Rc=this.fQj.yqi(Lb);this.vAa[Lb.id.toString()]=Rc;Rc.hLe(!0)}$rn(Lb,Rc){Lb=Object(Y.a)(426,Object(Y.a)(Ad.a,Rc.cI).hb).id.toString();Lb in this.vAa&&this.vAa[Lb].E2l(Date.now()+this.GP.jDd)}csn(Lb,Rc){Lb=Object(Y.a)(426,Object(Y.a)(Ad.a,Rc.cI).hb).id.toString();
Lb in this.vAa&&delete this.vAa[Lb]}Syg(){this.XHe=this.fnl}cCb(){this.O7d=this.fnl;if(!(!this.XHe&&!this.O7d||this.XHe&&this.O7d&&this.O7d.id.equals(this.XHe.id))){if(this.XHe){var Lb=this.XHe.id.toString();Lb in this.vAa&&this.vAa[Lb].E2l(Date.now()+this.GP.jDd)}this.O7d&&(Lb=this.fQj.yqi(this.O7d),this.vAa[this.O7d.id.toString()]=Lb,Lb.hLe(!0))}}get fnl(){var Lb=this.pa.Ua;if(!Lb||!Lb.mb||Lb.mb.nk)return null;Lb=Lb.mb;return Lb.Xa.node&&Lb.Xa.node.isConnected?this.Ac.mEa(Lb.Xa.node):null}Asn(Lb,
Rc){Lb=Rc.tableCellNode.id.toString();Lb in this.vAa&&delete this.vAa[Lb]}Mtm(){this.rYl();for(const Lb of Object.keys(this.vAa))this.vAa[Lb].hLe(!0)}zsn(){this.rYl();for(const Lb of Object.keys(this.vAa))this.vAa[Lb].Fei();for(const Lb of Object.keys(this.UMc))this.UMc[Lb].Rei()&&delete this.UMc[Lb]}Gh(Lb,Rc){if(Rc&&Rc.node&&Rc.property.id===ha.a.tq.id){Lb=Object(Y.a)(427,Rc.node);Rc=!Rc.node.loading;const md=this.Ac.mEa(Lb);if(md)this.RNl(md,Rc),this.SNl(md,Rc);else if(Lb=this.Ia.Mja(Lb))this.RNl(Lb,
Rc),this.SNl(Lb,Rc)}}yR(){this.UMc={}}rYl(){for(const Lb of Object.keys(this.vAa))this.vAa[Lb].iIm()&&delete this.vAa[Lb]}RNl(Lb,Rc){Lb=Lb.id.toString();if(Lb in this.vAa){Lb=this.vAa[Lb];const md=Object(Y.a)(ed,Lb);md&&md.ANn();Lb.hLe(!0);Rc&&(Lb.ylh=!0)}}SNl(Lb,Rc){var md=this.Ia.ln(Lb);md&&this.va.Ga&&this.va.Ga.sid===md.get_sid()&&this.va.Ga.cid===md.get_cid()&&(md=Lb.id.toString(),Rc?md in this.UMc&&delete this.UMc[md]:(Rc=Object(ta.a)(502,Lb)?this.eUa.EAf(Object(Y.a)(502,Lb)):this.eUa.lCf(Object(Y.a)(426,
Lb)))&&0<Rc.length&&(md in this.UMc?this.UMc[md].hLe(!1):(Lb=this.fQj.yqi(Lb),this.UMc[md]=Lb,Lb.hLe(!1))))}}Object(c.a)(Yc,"TextContentMonitor",null,[]);class ab extends Jb{constructor(Lb,Rc,md,Zc,ld){super(Lb,Rc,Zc,ld);this.Ac=md}get tableCellNode(){return Object(Y.a)(502,this.hb)}PHf(){const Lb=new f.a;this.Ac.ESc(this.tableCellNode,Rc=>{(Rc=this.Cj.text(Rc))&&0<Rc.length&&Lb.add(Rc)});return Lb.toArray().join(" ")}QHf(){const Lb=new f.a;this.Ac.ESc(this.tableCellNode,Rc=>{Rc.Ra(ha.a.tq)&&(Rc=
Rc.gb(ha.a.tq))&&0<Rc.length&&Lb.add(Rc)});return Lb.toArray().join(" ")}Fei(){try{const Lb=this.PHf()||"",Rc=this.qbg||"";if(Lb!==Rc&&this.p8c(Lb)!==this.p8c(Rc)){const md=mb.a.HM("TableCellNode",this.z3l+"/"+this.tableCellNode.Ql,"Start",Mc.a.Lf(this.VHe),"LastSnapshotTime",Mc.a.Lf(this.rbg),"EverEdit",this.ylh);md.Expiration=-1<this.ZIc?(+new Date(this.ZIc)-+this.VHe).toString():null;const Zc=Lb.length-Rc.length;Zc?md.TextLengthDelta=Zc:md.SameLengthDiffDetails=this.D0l(Lb,Rc);K.a.J(37748808,814,
15,Bc.c(md))}}catch(Lb){K.a.J(37748810,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Lb)}}Rei(){try{const Lb=this.eUa.EAf(this.tableCellNode);if(Lb&&0<Lb.length)return!1;const Rc=this.QHf()||"",md=this.qbg||"";if(Rc!==md&&0>Rc.indexOf(md)&&!(0<=this.p8c(Rc).indexOf(this.p8c(md)))){const Zc=mb.a.HM("TableCellNode",this.z3l+"/"+this.tableCellNode.Ql,"Start",Mc.a.Lf(this.VHe),"LastSnapshotTime",Mc.a.Lf(this.rbg),"TextLengthDelta",Rc.length-md.length);K.a.J(37748812,814,15,Bc.c(Zc))}}catch(Lb){K.a.J(37748814,
814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Lb)}return!0}get z3l(){const Lb=this.Ia.ln(this.tableCellNode);return Lb?Lb.Ql:"UnknownShape"}}Object(c.a)(ab,"TableCellContentRecord",Jb,[]);class jb{constructor(Lb,Rc,md,Zc){this.Ia=Lb;this.Ac=Rc;this.Cj=md;this.eUa=Zc}yqi(Lb){return Object(ta.a)(426,Lb)?new ed(Object(Y.a)(426,Lb),this.Ia,this.Cj,this.eUa):Object(ta.a)(502,Lb)?new ab(Object(Y.a)(502,Lb),this.Ia,this.Ac,this.Cj,this.eUa):null}}Object(c.a)(jb,"TextContentRecordFactory",
null,[1358]);var cc=a(863);class Hc{constructor(Lb,Rc,md,Zc,ld){this.xb=Lb;this.aZb=Rc;this.pa=md;this.Oca=Zc;this.cE=ld;this.lnh=!1}initialize(){this.pa.QM(Object(v.a)(this,this.cCb,"onSetSelectionFinished"));this.Oca.Gfl(Object(v.a)(this,this.eSl,"onTypingLockStatusChanged"))}dispose(){this.pa.ALe(Object(v.a)(this,this.cCb,"onSetSelectionFinished"));this.Oca.GZl(Object(v.a)(this,this.eSl,"onTypingLockStatusChanged"))}cCb(){var Lb=this.pa.hr();let Rc=null;for(const md of Lb)if(Lb=Object(Y.a)(Ga.TableCellNode,
md))if(Lb=Object(Y.a)(918,Lb.Qg(this.xb.Oa)))if(Rc=Lb.f$c)break;this.e$l(Rc)}eSl(Lb,Rc){this.e$l(Rc.hnl)}e$l(Lb=null){this.pa.z5()?this.mTn(Lb):this.jIn()}mTn(Lb=null){if(this.xb.editingView&&this.xb.editingView.Kl){const Rc=this.qul();Rc&&(this.aZb.w$(Rc.shapeNode).Izh(Lb),Lb&&(Rc.gNe=!0,this.cE.Hth(new cc.a(Rc)),Rc.gNe=!1));this.lnh||K.a.J(507843862,828,50,"TypingLockHandler:SuspectEditingView - ContentEditableView is switching to cell-lock mode");this.xb.editingView.disable(!1,14);this.lnh=!0}}jIn(){if(this.xb.editingView&&
this.xb.editingView.Kl){const Lb=this.qul();Lb&&Lb.shapeNode.Zc&&(this.aZb.w$(Lb.shapeNode).Izh(null),Lb.zDe());this.lnh&&K.a.J(507843861,828,50,"TypingLockHandler:ResumeEditingView - ContentEditableView is switching back to edit mode");this.xb.editingView.IUa();this.lnh=!1}}qul(){let Lb=null;const Rc=this.pa.ud();1===Rc.length&&(Lb=Object(Y.a)(284,Rc[0].tc(this.xb.Oa)));return Lb}}Object(c.a)(Hc,"TypingLockHandler",null,[1387,24]);var Vc=a(1197),Tc=a(284);class cd{constructor(){this.ooh=this.Sm=
this.Jab=this.Lnh=this.pR=this.$=this.le=null;this.m1f=0;this.Cph=null;this.eEj=!1;this.lmh=null;this.EEj=!1;this.nmg=uc.a("PresencePackage.RefactorInit");this.dbn=uc.a("PresencePackage.CheckSignalRLoadedBeforeRTC")}get name(){return"Presence"}azm(){this.$.register(r.a,"Common.PresenceUser").as("Common.IPresenceUser").ma();this.$.register(ec,"PowerpointPresence.PresenceUtils").as("Common.IPresenceConverter").ma().na(()=>new ec(this.$.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.eEj=!0}lc(Lb){try{K.a.J(509100485,
814,50,"PresencePackage::configure");this.m1f=(new Date).getTime();this.$!==Lb&&(this.$=Lb,this.Jab=this.$.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.Sm=this.Jab.oAb(1,this.name),this.eEj=!1,this.EEj=this.$.resolve("PowerPointWebEditor.IApplicationSettings").yKe);this.le=this.$.resolve("Common.AFrameworkApplication");const Rc=this.$.resolve("PowerPointWebEditor.IApplicationSettings");this.eEj||this.azm();if(this.dbn){K.a.J(508864333,814,50,"PresencePackage::configure; Check SignalR loaded");
const ld=this.$.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener");if(ld.kFe)K.a.J(508864332,814,50,"PresencePackage::configure; SignalR loaded early");else{K.a.J(508864331,814,15,"PresencePackage::configure; SignalR not loaded");ld.pBl(()=>{K.a.J(508864330,814,50,"PresencePackage::configure; SignalR loaded");this.lc(w.a.instance)});return}}const md=Rc.Bjl&&Rc.ODb?!1:Rc.Rh,Zc=this.TBm(this.$.resolve("PowerpointPresence.RtcParams"),this.$.resolve("Common.IPresenceUser"),md,Rc[Tc.a.B8]);Zc?
(this.$.register(1355,"Common.IRealtimeChannelBasic").ma().na(()=>Zc),this.$.register(1356,"AppRealtimeChannel.IRealtimeChannel").ma().na(()=>Zc),this.$ym(Rc),this.nmg&&this.init()):K.a.J(509100484,814,15,"PresencePackage::configure could not create rtc")}catch(Rc){K.a.J(508929377,814,10,"PresencePackage::configure; Initializing Presence failed: {0}",Rc)}}$ym(Lb){this.$.register(ja,"PowerpointPresence.PPTRtcProvider").as("Common.Interface.IRtcBasicProvider").ma().na(()=>new ja(this.$.resolve("Common.IRealtimeChannelBasic")));
this.$.register(Pa,"PowerpointPresence.EditorPresenceTracker").as("PowerpointPresence.IEditorPresenceTracker").ma().na(()=>new Pa(this.$.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.$.register(vc,"PowerpointPresence.PptRealtimeChannelMetrics").as("PowerpointPresence.IPptRealtimeChannelMetrics").ma().na(()=>new vc(this.$.resolve("PowerpointPresence.RtcParams"),this.$.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.$.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.$.resolve("PowerPointWebEditor.Core.INetworkState"),
N.a.getInstance(),Lb.iMe));this.$.register(eb,"PowerpointPresence.PresenceManager").as("PowerpointPresence.IPresenceManager").as("Common.IPresenceSender").as("PowerpointPresence.IPresenceUserManager").as("Common.IPresenceRemover").ma().na(()=>new eb(this.$.resolve("Common.IPresenceUser"),y.AFrameworkApplication.ga,this.$.resolve("AppRealtimeChannel.IRealtimeChannel"),this.$.resolve("PowerpointPresence.RtcParams"),this.le.Om,this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),
this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerpointPresence.IPresenceEventNotifier"),this.$.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.$.resolve("PowerPointWebEditor.ICoauthStateSetter"),Lb,this.$.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.$.resolve("PowerpointPresence.IEditorPresenceTracker"),
this.$.resolve("PowerpointPresence.IPresenceColorProvider"),this.$.resolve("PowerpointPresence.IPresenceEmailConverter"),this.$.resolve("PowerpointPresence.IPptRealtimeChannelMetrics"),this.$.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.$.resolve("PowerpointPresence.IPresencePerfLogger"),this.$.Na("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.$.resolve("PowerpointPresence.IPresencePrepCacheParser").B8c(),this.$.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),
this.$.resolve("PowerPointWebEditor.IPopWebService"),this.$.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.$.register(ia,"PowerpointPresence.PresenceCache").ma().na(()=>new ia(this.$.resolve("PowerpointPresence.IPresenceManager")));this.$.register(rb,"PowerpointPresence.PresencePresenter").ma().na(()=>new rb(this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerpointPresence.IPresenceManager"),
this.$.resolve("Common.DragInputManager"),this.$.resolve("PowerpointPresence.ICoauthStateChangesHandler"),this.$.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("Box4.IPageView").Oa,this.$.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Oa,this.$.resolve("PowerpointPresence.IPresenceEventHandlers"),Lb.zta));this.$.register(Na,"PowerPointWebEditor.PptWetChangeHandler").as("PowerPointWebEditor.IWetChangeHandler").ma().na(()=>
new Na(this.$.resolve("Common.IPresenceUser").clientId,Lb.g4l,this.$.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(10),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));const Rc=new dd(Lb.wol,Lb.sWg,Lb.rWg,Lb.jDd,Lb.XDe,Lb.hNf,Lb.Hfd,Lb.D1g,Lb.zdd,Lb.Pqf,Lb.Nqf,Lb.Oqe,Lb.vbd,Lb.XBd,Lb.hdc,Lb.gdc);this.$.register(Hc,"PowerpointPresence.TypingLockHandler").as("PowerpointPresence.ITypingLockHandler").ma().na(()=>new Hc(this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),
this.$.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource")));this.$.register(Qa,"PowerpointPresence.CoauthStateChangesHandler").as("PowerpointPresence.ICoauthStateChangesHandler").ma().na(()=>new Qa(L.App.ji,this.$.resolve("PowerpointPresence.IPresenceManager"),
this.$.resolve("Common.IPresenceUser").clientId,this.$.resolve("AppRealtimeChannel.IRealtimeChannel"),this.$.resolve("PowerPointWebEditor.IPPTWorkspace"),this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("Box4.ContentEditableViewEventSource"),this.$.resolve("PowerPointWebEditor.IViewElementHelper"),this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("PowerPointWebEditor.Graph.ITableReader"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(12),
Lb,Rc,this.$.resolve("PowerPointWebEditor.IWetChangeHandler"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.$.resolve("PowerpointPresence.ITypingLockHandler"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView").Oa,this.$.resolve("Box4.Graph.IGraphInstance").Sd(16),z.a.aG(w.a.instance.Na("Common.ISystemInitiatedFeedback"))));
this.$.register(1357,"PowerpointPresence.IPresencePawnFactory").ma().na(()=>new bb);this.$.register(1358,"PowerpointPresence.ITextContentRecordFactory").ma().na(()=>new jb(this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("PowerPointWebEditor.Graph.ITableReader"),this.$.resolve("Box4.IParagraphReader"),this.$.resolve("PowerPointWebEditor.IWetChangeHandler")));this.$.register(Yc,"PowerpointPresence.TextContentMonitor").ma().na(()=>new Yc(this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),O.a.instance,this.$.resolve("Box4.Graph.IGraphInstance").Sd(12),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.$.resolve("PowerPointWebEditor.IWetChangeHandler"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.$.resolve("PowerPointWebEditor.IShapeReader"),
this.$.resolve("PowerPointWebEditor.Graph.ITableReader"),this.$.resolve("PowerpointPresence.ITextContentRecordFactory"),Rc));this.$.register(l,"Common.App.Presence.AwayManager").ma().na(()=>this.oAm(this.$.resolve("Common.IPresenceUser"),this.$.resolve("Common.IRealtimeChannelBasic"),this.$.resolve("Common.IPresenceRemover"),this.$.resolve("Common.IPresenceConverter"),Lb.getBooleanAppSetting(Oa.a.ocd)));this.$.register(1359,"PowerPointWebEditor.IDelayedPresenceUserInfoGetter").ma().na(()=>new $b(this.$.resolve("AppRealtimeChannel.IRealtimeChannel")));
K.a.J(509100483,814,50,"PresencePackage::configurePostRTC; Setting Rtc configured");this.rfh().$5b("RTCConfigured")}$Rm(Lb){let Rc,md;Rc=0;if(Lb=this.$.resolve("PowerpointPresence.IPresencePrepCacheParser").swl())return md=this.$.resolve("PowerpointPresence.IPresencePrepCacheParser").joe(),{o0l:Lb,j0l:Rc,$ql:md};Rc=1;if(Lb=this.$.resolve("PowerPointWebEditor.ICoauthStateSetter").hvh)return md=this.$.resolve("PowerPointWebEditor.ICoauthStateSetter").joe,{o0l:Lb,j0l:Rc,$ql:md}}SBm(){const Lb=1E3*this.$.resolve("PowerPointWebEditor.IApplicationSettings").jMe;
0<Lb&&(this.Cph=new h.a(2,1,Lb,()=>{this.$.yb("AppRealtimeChannel.IRealtimeChannel")||K.a.J(509670485,828,10,"PresencePackage::createRtcDiscoveryTimeoutTask RTC Discovery Timed Out after {0} ms and attempted to fallback",Lb);this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").gpk(Object(v.a)(this,this.N0j,"onPopsRtcEndpointUrlReady"));this.$.yb("AppRealtimeChannel.IRealtimeChannel")||(this.lc(w.a.instance),this.nmg||this.init())},90,"111"),this.$.resolve("Common.ITaskManager").Qb(this.Cph))}TBm(Lb,
Rc,md,Zc){K.a.J(512360602,828,50,"PresencePackage::CreateRtcInstance; isPodsEnabled:{0}",md);Rc.clientId=Lb.clientId;var ld=null;Rc=null;const fe=N.a.getInstance();if(md){Rc=Zc+"rtc2";({o0l:Rc,j0l:md,$ql:Zc}=this.$Rm(Rc));ld=!this.$.resolve("PowerPointWebEditor.ICoauthStateGetter").amIAlone;const Ac=this.$.resolve("PowerPointWebEditor.ICoauthStateSetter").Xkh;K.a.J(512360601,828,15,"PresencePackage::CreateRtcInstance; Discovering RTC enabled; RtcDiscoverType:{0} fCoauthoring:{1} fDefaultConnectToRtc:{2} fPopsRtcConfigured:{3}",
pc[md],ld,Zc,Ac);if(2===md)return this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").jfl(Object(v.a)(this,this.N0j,"onPopsRtcEndpointUrlReady")),this.SBm(),null;if(!Zc&&!ld)return this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").Mah(Object(v.a)(this,this.EIe,"onCoauthStatusChanged")),null;ld=this.lAm(Lb,Rc,this.$.resolve("PowerPointWebEditor.IApplicationSettings"),fe)}return A.RealtimeChannel.createInstance(Lb.clientId,Lb.userSessionId,Lb.lMe,Lb.rI,Lb.wyk,3,Lb.IB,Rc,
ld,fe)}oAm(Lb,Rc,md,Zc,ld){const fe=new C.a;fe.vj(md);md=new C.a;md.vj(Rc);return new l(Lb,md.task,fe.task,Zc,this.$.resolve("Common.ITaskManager"),this.le.Om.Md.Xbh?6E4:this.le.Om.Md.h5c,Object(v.a)(this.le.Om.eS(),this.le.Om.eS().Cb,"processAction"),M.App.rJb.notificationBar,ld)}init(){K.a.J(509100482,814,50,"PresencePackage::init; initing presence");const Lb=this.$.resolve("PowerpointPresence.IPresencePerfLogger");Lb.Vh(21,cd.rmg);Lb.Vh(22,this.m1f);Lb.Vh(24,(new Date).getTime());this.$.resolve("PowerPointWebEditor.PresentationContext").isValid?
(K.a.J(509100481,814,50,"PresencePackage::init; Setting Presentation Id ready"),this.rfh().$5b("PresentationId")):this.$.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").abh(Object(v.a)(this,this.Ybd,"onPresentationIdReady"));this.$.resolve("PowerPointWebEditor.IAppBootCompletedListener").Uxa(()=>{K.a.J(509100480,814,50,"PresencePackage::init; Setting B2I Finished");this.rfh().$5b("B2IFinished")})}Ybd(){K.a.J(509100451,814,50,"PresencePackage::onPresentationIdReady; Setting Presentation Id ready");
this.rfh().$5b("PresentationId");this.$.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").wuh(Object(v.a)(this,this.Ybd,"onPresentationIdReady"))}N0j(){this.Cph&&this.$.resolve("Common.ITaskManager").li(this.Cph);this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").gpk(Object(v.a)(this,this.N0j,"onPopsRtcEndpointUrlReady"));this.$.yb("AppRealtimeChannel.IRealtimeChannel")||(this.lc(w.a.instance),this.nmg||this.init())}EIe(Lb,Rc){2!==Rc.FWj||this.$.yb("AppRealtimeChannel.IRealtimeChannel")||
(this.lc(w.a.instance),this.nmg||this.init());this.$.yb("AppRealtimeChannel.IRealtimeChannel")&&this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").kuh(Object(v.a)(this,this.EIe,"onCoauthStatusChanged"))}rfh(){this.ooh||(this.ooh=new Vc.a(Object(v.a)(this,this.dEe,"initInternal"),["PresentationId","B2IFinished","RTCConfigured"]));return this.ooh}dEe(){this.$.resolve("PowerpointPresence.IPresencePerfLogger").Vh(4,this.$.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource").fLe);this.$.resolve("PowerpointPresence.IPresencePerfLogger").Vh(23,
(new Date).getTime());this.W1m();this.l2m();this.ooh=null}l2m(){try{let Lb="";this.$.resolve("PowerPointWebEditor.IDelayedPresenceUserInfoGetter");Lb=this.Sm.qI("presencemanager");this.m2m();this.Sm.uI(Lb);this.$.resolve("PowerPointWebEditor.ICoauthStateSetter").E9c=!0;K.a.J(8958608,814,50,"PresencePackage::Init; Presence downloaded");L.App.sAe&&(Lb=this.Sm.qI("contentnotification"),Za.init(),this.Sm.uI(Lb));Lb=this.Sm.qI("resolve");this.$.resolve("PowerpointPresence.IPresencePerfLogger").lql();this.pR=
this.$.resolve("PowerpointPresence.IPresenceManager");this.$.resolve("Common.IPresenceConverter");this.$.resolve("Common.IRealtimeChannelBasic");this.le.Om.Md.Oql&&(K.a.J(512360600,814,50,"PresencePackage::Init; Refresh Peoples well after Rtc ready"),this.le.Om.eS().Cb(u.a.Dzb,2));this.$.resolve("PowerPointWebEditor.IWetChangeHandler");this.$.resolve("Common.Interface.IRtcBasicProvider");this.$.resolve("PowerpointPresence.ICoauthStateChangesHandler");this.$.resolve("PowerpointPresence.PresencePresenter");
this.$.resolve("PowerpointPresence.IPresencePawnFactory");this.$.resolve("Common.App.Presence.AwayManager");this.le.Om.Md.vDe&&this.$.resolve("PowerpointPresence.TextContentMonitor");this.Sm.uI(Lb);this.$.resolve("PowerpointPresence.IPresencePerfLogger").hql();this.$.resolve("PowerpointPresence.IPresencePrepCacheParser").HFl()}catch(Lb){K.a.J(512360599,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",Lb)}}dispose(){this.pR?this.pR.disconnect():K.a.J(512360598,814,10,"PresencePackage::Dispose; m_presenceManager is null.");
this.$.resolve("PowerpointPresence.IPresencePerfLogger").dispose()}m2m(){this.$.resolve("PowerpointPresence.PresenceManager").Hb();K.a.J(512360597,814,50,"PresencePackage::InitializePresenceManager; Presence Manager loaded and initialized")}lAm(Lb,Rc,md,Zc){let ld=Rc;ld=ld.endsWith("/")?ld+"findsession":ld+"/findsession";K.a.J(512360596,814,50,"PresencePackage::CreateAssignRtcMachineStrategy; Using rtc path: {0}; WacClusterId: {1} ",ld,Lb.rI.AFa);Rc=()=>D.FindSessionStrategy.hBm(Lb.userSessionId,
Lb.rI,ld,Lb.IB,y.AFrameworkApplication.buildVersion,Lb.clientId,cd.zHi(3,y.AFrameworkApplication.buildVersion),Zc,Lb.wyk,()=>{if(y.AFrameworkApplication.ui)return y.AFrameworkApplication.ui;const Ac=this.$.resolve("PowerPointWebEditor.PresentationContext").Nh.string;Ac||K.a.J(512360595,814,15,"CreateAssignRtcMachineStrategy - returning a null query string");return Ac},this.$.resolve("PowerpointPresence.IPresencePrepCacheParser").rwl());const fe=!!this.Lnh;return this.EEj||fe?this.lmh=new Gb(this.Lnh,
Rc,md,Zc,this.$.resolve("PowerpointPresence.IPresencePerfLogger")):Rc()}W1m(){var Lb;if(Lb=this.$.resolve("PowerPointWebEditor.IApplicationSettings").Scd?this.$.resolve("PowerpointPresence.IPresencePrepCacheParser").Ful():this.$.resolve("PowerPointWebEditor.Core.IFindRtcSessionSimpleStrategy").UBe)Lb=U.RtcUtils.deserialize(Lb,"PresencePackage","Deserialize existing FindSession response",!0),this.wsh(Lb)}wsh(Lb){if(Lb)try{this.Lnh=Object.assign(new F.a,{xUf:Lb[W.a.cFe],errorMessage:Lb[W.a.errorMessage],
Lkf:Lb[W.a.OJk],vbb:Lb[W.a.vbb],W7:Lb[W.a.W7],Dih:Lb[W.a.w_i],Rqh:Lb[W.a.b9d],Sqh:Lb[W.a.z_c],Uqh:Lb[W.a.n9d]}),this.EEj&&this.lmh&&(this.lmh.findSessionResponse=this.Lnh)}catch(Rc){K.a.J(512360594,828,10,"Exception caught while creating FindSessionResponse: {0}",Rc)}}static main(){cd.rmg=(new Date).getTime();const Lb=new cd;y.AFrameworkApplication.ga&&y.AFrameworkApplication.ga.getBooleanAppSetting("IsSyncConfigPresenceEnabled")?(Lb.lc(w.a.instance),Lb.$.yb("AppRealtimeChannel.IRealtimeChannel")&&
!Lb.nmg&&Lb.init()):B.a.instance.Fc(Lb)}static zHi(Lb,Rc){return String.format("{0}, {1}, {2}",cd.Jhf(H.a[Lb]),cd.Jhf("browser"),Rc)}static Jhf(Lb){return Lb?Lb.charAt(0).toLocaleUpperCase()+Lb.substring(1,Lb.length):Lb}}cd.rmg=0;Object(c.a)(cd,"PresencePackage",null,[3,4]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerpointPresence");window.g_hermesPresence1JS=new Date;Type.registerNamespace("Common.App.Presence");Type.registerNamespace("AppRealtimeChannel");cd.main()},
530:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);a=a(30);class c extends a.a{constructor(b){super();this._element=null;this.element=b}get element(){return this._element}set element(b){this._element=b}get visible(){return"visible"===this.element.style.visibility}set visible(b){this.element.style.visibility=b?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(b){this.element.dir=b?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(b){this.element.style.zIndex=
String(b)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(b){return this.element.ownerDocument.createElement(b)}q_(){return!0}static GAe(b,f){return b+(f?"Rtl":"")}}Object(x.a)(c,"BasePresenceControl",a.a,[24,62])},531:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c extends Sys.EventArgs{constructor(b,f){super();this.type=b;this.$g=f}}c.xI="InteractivityChanged";Object(x.a)(c,"InteractivityChangedEventArgs",
Sys.EventArgs,[])},706:function(x,G,a){a.r(G);a.d(G,"RtcUtils",function(){return e});x=a(0);var c=a(17),b=a(20),f=a(1131);class e{static Ddi(h,u=f.a.lTj){let m;try{m=b.c(h)}catch(n){throw h=String.format("Failed to JSON-serialize payload : {0}",n),c.ULS.sendTraceTag(508396173,500,10,h),Error.argument("payload",h);}if(m.length>u)throw h=String.format("Payload exceeds maximum length: {0} > {1}.",m.length,u),c.ULS.sendTraceTag(508396171,500,10,h),Error.argument("payload",h);return m}static deserialize(h,
u,m){if(!h)return null;if(Object.getType(h)!==String){var n=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",u,Object.getType(h).getName(),m);c.ULS.sendTraceTag(508396170,500,10,n);return null}n=null;try{n=b.a(h)}catch(l){h=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",u,l,m),c.ULS.sendTraceTag(508396168,500,10,h)}return n}static AIe(h){if(!h)return"";if("string"===
typeof h)return h.toString();try{return b.c(h)}catch(u){return h.toString()}}static Sql(h){let u,m,n;u=0;n=m=null;if(!h)return{l9i:u,m9i:m,oj:n};try{const l=h.source;l&&Object.getType(l)===String&&(n=l);const r=h.context;r&&(h=r,u=h.status?h.status:0,m=h.statusText?h.statusText:null)}catch(l){}return{l9i:u,m9i:m,oj:n}}}Object(x.a)(e,"RtcUtils",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.presence1.js.map