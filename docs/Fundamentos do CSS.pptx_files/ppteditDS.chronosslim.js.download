'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11,13],{1064:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.Image16by16Class="Image16by16Class";c.Image32by32Class="Image32by32Class";c.On="On";c.LabelText="LabelText";c.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";c.EnsureControlRoleIsButton="EnsureControlRoleIsButton";c.Visible="Visible";Object(x.a)(c,"SplitButtonCommandProperties",null,[])},1097:function(x,G,a){a.d(G,"a",function(){return c});
x=a(0);a=a(482);class c extends a.a{constructor(){super();this.SecondaryText=this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(x.a)(c,"IconGalleryButtonProps",a.a,[])},1116:function(x,G,a){a.d(G,"b",function(){return b});a.d(G,"a",function(){return f});a.d(G,"c",function(){return e});var c=a(5);a(98);a(249);a(273);const b=(h,u)=>{const m=[];if(h.length!==u.length)return m;for(let n=0;n<h.length;n++){const l={};l.key=u[n];l.text=h[n];l.type=
"AppComboBoxItem";m[n]=l}return m},f=(h,u,m,n,l)=>({["unitType"]:h,["unitPlaceholder"]:c.a.RCg(u),["minValue"]:m,["maxValue"]:n,["step"]:l}),e=h=>"1.00"===h?1:"1.50"===h?1.5:"2.00"===h?2:0},1123:function(x,G,a){a.d(G,"a",function(){return h});x=a(0);var c=a(3),b=a(40),f=a(563),e=a(305);class h{constructor(u,m,n,l,r,w,y,z,A,B,H,v){this.Mff=1;this.JMa=m;this.eo=u;this.hCj=n;this.Qi=A;this.UB=B;this.ef=H;this.oLc=z;this.wJc=r;this.xJc=l;this.Iza=w;this.Qi.addCssClass(this.eo,"prControl");this.eo.style.width=
this.Qi.Uc(m);this.tO=y.Zml();this.qGc=y.Yml();this.tO.LKb(u);this.qGc.LKb(u,m,m);this.Sad=v;this.z4b()}dispose(){this.N1g();this.clear();this.tO.dispose();this.qGc.dispose();this.Qi.removeCssClass(this.eo,"prControl")}get hCb(){return e.a.none}clear(){this.E$b();this.cAe();this.ZLe()}setZIndex(u){this.eo.style.zIndex=String(u)}Ssg(){this.Sad.ta.style.zIndex=String(this.Mff+f.a.Ora)}ZLe(){this.Sad.ta.style.zIndex="0"}jwh(u,m,n=null){u=this.oLc.Eni(this.JMa,this.JMa,this.hCj,u,"",n);this.tO.setImage(u,
m)}ptd(u,m){this.qGc.add(u,m)}cAe(){this.qGc.clear()}E$b(){this.tO.clear()}onClick(){return!0}z4b(){this.xJc&&this.UB.Zb(c.a.KP,this.eo,this.xJc);this.wJc&&this.UB.Zb(c.a.AR,this.eo,this.wJc);this.Iza?this.ef.Zb(c.a.click,this.eo,this.Iza):this.ef.Zb(c.a.click,this.eo,Object(b.a)(this,this.onClick,"onClick"));this.ef.Zb(c.a.doubleClick,this.eo,Object(b.a)(this,this.onClick,"onClick"))}N1g(){this.xJc&&this.UB.jc(c.a.KP,this.eo,this.xJc);this.wJc&&this.UB.jc(c.a.AR,this.eo,this.wJc);this.Iza?this.ef.jc(c.a.click,
this.eo,this.Iza):this.ef.jc(c.a.click,this.eo,Object(b.a)(this,this.onClick,"onClick"));this.ef.jc(c.a.doubleClick,this.eo,Object(b.a)(this,this.onClick,"onClick"))}}Object(x.a)(h,"ShapePawn",null,[739])},1168:function(x,G,a){a.d(G,"a",function(){return f});x=a(0);var c=a(5);class b{constructor(e,h){this.c8f=e;this.m_message=h}get aya(){return this.c8f}get message(){return this.m_message}}Object(x.a)(b,"CalloutNotificationError",null,[]);class f{constructor(e,h){this.D$c=e;this.qng=h}rW(e,h,u,m,
n,l,r,w,y,z,A,B,H,v){this.D$c.show(this.qng,null,!1,y,z,e,h,u,n,m,l,r,w,A,B,H,v)}drf(){this.D$c.dismiss()}Poe(e){if(!e)throw Error.argumentNull("CalloutNotificationMessageAttributes");const h=this.o5g(e);if(h&&h.aya)return h;this.rW(e.title,e.message,e.Q8c,e.sbb,e.R8c,e.gec,e.BFg,e.XOg,e.CFg,e.ZOg,!!e.timeoutInSeconds,e.timeoutInSeconds,e.GLf,e.Nsa);return new b(!1,null)}o5g(e){return c.a.rb(e.title)?new b(!0,"Invalid Title"):c.a.rb(e.message)?new b(!0,"Invalid Message"):e.Q8c&&c.a.rb(e.sbb)?new b(!0,
"Missing PrimaryButtonLabel"):e.R8c&&c.a.rb(e.gec)?new b(!0,"Missing SecondaryButtonLabel"):new b(!1,null)}}Object(x.a)(f,"CalloutNotificationAdapter",null,[809])},1206:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b,f=null,e=null,h=null){this.iconSet={};this.iconSet["default"]=b;this.iconSet.icon16=f;this.iconSet.icon24=e;this.iconSet.icon32=h}}Object(x.a)(c,"IconSetContainer",null,[])},1228:function(x,G,a){a.r(G);a.d(G,"ApplicationFeatureHelperPackage",function(){return Pa});
x=a(0);var c=a(17),b=a(1584),f=a(233),e=a(231),h;(function(ja){ja[ja.qsm=0]="applicationFeatureHelperHandler";ja[ja.mym=1]="cloudPolicySettings";ja[ja.Qrm=2]="alternateAuthToken"})(h||(h={}));Object(x.b)("ApplicationFeatureHelperRequestType",h);class u{constructor(){this.message=null;this.httpStatusCode=0}}Object(x.a)(u,"HttpRequstToPromiseRejectData",null,[]);var m=a(42),n=a(33),l=a(174),r=a(183),w=a(91),y=a(44);class z{constructor(ja,va){this.Ba=ja;this.$m=va}X9(ja,va,Ha,gb=null,Gb=null,Mb=null,
hb=null,Da=null){const Bb=h[Ha],Za=Bb+"RequestFailure";m.Health.instance.recordKpiUsage(Za,w.b.FailureBased,"jpittsdirects",null);return new Promise((mb,vb)=>{c.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",Bb);const sb=null!=hb?hb:this.Ba.Jc("ApplicationFeatureHelperRequestQueueTimeout",15E3),bc=null!=Da?Da:this.Ba.Jc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.$m.HZ(ja,1,null,this.DPb(Ha,gb),Mb,!1,1,yb=>{c.ULS.sendTraceTag(50622689,
3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Bb);try{if(void 0===yb||null===yb||void 0===yb.data||null===yb.data||void 0===yb.data.responseData||null===yb.data.responseData){m.Health.instance.recordKpiFailure(Za,"Invalid RequestSucceededEventArgs",!1,!0,null);const vc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",Bb);vb(this.Hfa(vc,yb))}else if(yb.data.Ze!==
l.a.bC){m.Health.instance.recordKpiFailure(Za,"HttpStatusCode_"+yb.data.Ze.toString(),!1,!0,null);const vc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",yb.data.Ze,Bb);vb(this.Hfa(vc,yb))}else{void 0!==Gb&&null!==Gb&&void 0!==yb.data.fk&&null!==yb.data.fk&&Gb(yb.data.fk);var uc=va(yb.data.responseData);if(uc)c.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",
Bb),mb(uc);else{m.Health.instance.recordKpiFailure(Za,"Parse Failure",!1,!0,null);const vc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",Bb);vb(this.Hfa(vc,yb))}}}catch(vc){m.Health.instance.recordKpiFailure(Za,"Unexpected Failure",!1,!0,null),uc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",vc,Bb),vb(this.Hfa(uc,yb))}},yb=>{var uc;if(yb.data){if(uc=y.a.xx())try{uc.set("useCommonDomain",
ja.toLowerCase().includes("common").toString())}catch(vc){c.ULS.sendTraceTag(507876040,3004,50,"Failed to set useCommonDomain")}m.Health.instance.recordKpiFailure(Za,"HttpStatusCode_"+yb.data.Ze.toString(),!1,!0,{extendedProperties:uc});uc=r.a.pQb(yb.data.responseData||"No Data");uc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",yb.data.Ze,uc,Bb)}else m.Health.instance.recordKpiFailure(Za,"Invalid RequestFailedEventArgs",
!1,!0,null),uc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",Bb);vb(this.Hfa(uc,yb))},null,void 0,void 0,sb,bc)})}Hfa(ja,va){const Ha=new u;Ha.message=ja;Ha.httpStatusCode=va&&va.data?va.data.Ze:-1;return Ha}DPb(ja,va){const Ha={};Ha["x-UserDataSignature"]=this.Ba.La("UserDataSignature");Ha["x-LicensingIsEnabled"]=this.Ba.getBooleanAppSetting("LicensingIsEnabled").toString();Ha["x-CacheIsEnabled"]=this.Ba.getBooleanAppSetting("LicensingRedisIsEnabled").toString();
Ha["x-OcpsIsEnabled"]=this.Ba.getBooleanAppSetting("OcpsIsEnabled").toString();Ha["x-LicensingAADIdIsEnabled"]=this.Ba.getBooleanAppSetting("LicensingAadIdIsEnabled").toString();0===ja&&(Ha["x-LicenseCheckOnTenantEnabled"]="true",Ha["x-SupportUserConsentDependentFeatures"]="true",Ha["x-AFHUserConsentGroupValue"]="0",Ha["x-UseShellServiceForUserConsentGroup"]="true",Ha["x-SMBUserLicensingEnabled"]="true",Ha["x-AFHPIPLComplianceEnabled"]=n.a.NV(window.location.href,"wd_afhpipl")||"false",Ha["x-ConsumerLicensingSNICertIsEnabled"]=
this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),Ha["x-MSGraphInLicensingIsEnabled"]=this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",!1).toString());if(va)for(const gb of va.keys)Ha[gb]=va.ha(gb);return Ha}}Object(x.a)(z,"HttpRequestToPromiseUtility",null,[]);var A=a(4),B;(function(ja){ja[ja.$Fl=0]="loki";ja[ja.ltm=1]="augloopACLP"})(B||(B={}));Object(x.b)("AlternateAuthSupportApp",B);var H=a(380),
v=a(20);class C{constructor(){this.Token=null;this.ExpirationTime=0}}Object(x.a)(C,"WacAlternateAuthToken",null,[]);class F{constructor(ja,va){this.VRk=3E5;this.Xce=Ha=>{let gb=null;({BD:gb}=v.d(Ha));return gb};if(void 0===ja||null===ja||void 0===va||null===va)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ba=ja;this.vfc=new b.a(f.a.Wn());this.Uda=new z(ja,va);void 0!==H.a.EWd&&null!==H.a.EWd&&void 0!==H.a.cEc&&null!==H.a.cEc&&0<H.a.cEc&&(ja=new C,ja.Token=H.a.EWd,ja.ExpirationTime=
H.a.cEc,this.vfc.K("loki",ja))}KIi(ja){let va=null;this.vfc.Ob(B[ja])&&(va=this.vfc.ha(B[ja]));return void 0===va||null===va||this.Cqj(va)?this.QCi(ja):Promise.resolve(va.Token)}Cqj(ja){return ja.ExpirationTime-Date.now()<this.VRk}QCi(ja){const va=new b.a(f.a.Wn());va.K("X-AlternateAuthApp",B[ja]);return(this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1)?Promise.race([this.Uda.X9(this.DT("/afhs/AlternateAuthHelperHandler.ashx",!0),this.Xce,2,va),this.Uda.X9(this.DT("/afhs/AlternateAuthHelperHandler.ashx",
!1),this.Xce,2,va)]):this.Uda.X9(this.DT("/afhs/AlternateAuthHelperHandler.ashx",this.Ba.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled"),this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseOwlOriginForAFHS",!1)),this.Xce,2,va)).then(Ha=>{c.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",B[ja]);this.vfc.K(B[ja],Ha);return Ha.Token},Ha=>{Ha=Object(e.a)(u,Ha);c.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
Ha.message,Ha.httpStatusCode);return null})}DT(ja,va,Ha=!1){ja=String.format("{0}{1}?{2}",Ha?"https://ffc-owl.officeapps.live.com":va?this.Ba.La("SuiteOrigin"):this.Ba.La("WebServiceBase"),ja,A.AFrameworkApplication.ui);this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddUserSessionIdForAFHS",!1)&&(ja+="&usid="+A.AFrameworkApplication.userSessionId);return ja}}Object(x.a)(F,"AlternateAuthHelper",null,[479]);var D=a(167);class N{constructor(ja,va,Ha){this.featureName=null;this.isEnabled=
!1;this.tierName=0;this.featureName=ja;this.isEnabled=va;this.tierName=Ha}}Object(x.a)(N,"FeatureStateChangeArgs",null,[]);var U=a(121),W=a(7),L=a(21),O=a(83),M;(function(ja){ja[ja.Enabled=0]="Enabled";ja[ja.Disabled=1]="Disabled"})(M||(M={}));Object(x.b)("FeatureState",M);var K=a(19),P=a(10),V=a(528);class Y{constructor(ja,va,Ha=null,gb=null,Gb=null){this.GJa=this.aT=this.a5e=this.HGa=this.hlc=null;this.Yce=Mb=>{(Mb=v.b(Mb))?(c.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),
c.ULS.sendTraceTag(50938594,3004,50,"{0}",Mb)):c.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return Mb.Features};this.O1i=()=>{c.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.GJa.then(Mb=>{this.TIg(Mb)}).catch(()=>{this.TIg({})})};this.Cge=Mb=>{try{Mb&&"Date"in Mb&&(this.aT=new Date(Mb.Date),c.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",
this.aT.toString()))}catch(hb){c.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",hb)}};this.Uda=new z(ja,va);this.Ba=ja;this.jNh=ja.Jc("LicensingMaxRetryAttempts",0);this.uGb=ja.getBooleanAppSetting("IsO365ConsumerHost");this.pmd=ja.getBooleanAppSetting("IsO365CommercialHost");this.Yld=ja.getBooleanAppSetting("PremiumUpsellIsEnabled");this.Tdb=!1;this.ond=0;this.XUe=Ha;this.m8e=gb;this.ya=Gb;this.GGa=ja.getBooleanAppSetting("LicensingIsEnabled");this.IWa=
ja.getBooleanAppSetting("OcpsIsEnabled")&&this.pmd;this.ysd=ja.getBooleanAppSetting("ShowPrivacyDialog")&&!!gb;this.fic=ja.getBooleanAppSetting("IsAnonymousUser");this.auc=new Promise(Mb=>{Mb(!1)});this.qRa=new Promise(Mb=>{Mb(!0)});this.FJa=new b.a(f.a.Wn());this.emc=!0;this.w1e=this.MPi();this.rTd()&&!this.fic?(void 0!==A.AFrameworkApplication.Ea&&null!==A.AFrameworkApplication.Ea&&(this.hlc=A.AFrameworkApplication.Ea.Rba,void 0!==this.hlc&&null!==this.hlc&&(this.HGa=this.hlc.lrb("WebServiceCall",
"ApplicationFeatureHelperService"))),this.GJa=this.hte()):this.GJa=new Promise(Mb=>{Mb({})});this.GJa.catch(Mb=>{Mb=Object(e.a)(u,Mb);c.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",Mb?Mb.httpStatusCode.toString():"Unknown")});this.emc&&this.isFeatureEnabled("FreemiumUpsell",!0).then(Mb=>{this.Tdb=Mb;return null})}MPi(){const ja=this.Ba.Tz("AllLicensedFeatures")?this.Ba.tF("AllLicensedFeatures"):[],va=new D.a;for(let Ha=0;Ha<ja.length;Ha++)va.add(ja[Ha]);
return va}rTd(){return this.pmd||this.uGb}hte(ja=0,va=!1){c.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",va);const Ha=y.a.xx();Ha&&(Ha.set("retryAttempt",ja.toString()),Ha.set("forceRefresh",va.toString()),Ha.set("isO365ConsumerHost",this.uGb.toString()),Ha.set("isO365CommercialHost",this.pmd.toString()),Ha.set("isFreemiumUpsellSettingEnabled",this.Yld.toString()),Ha.set("useCommonDomain",(this.Ba.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled")&&
0===ja).toString()),Ha.set("useRace",this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1).toString()));m.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",Ha);m.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",w.b.SuccessBased,"waclicensing",Ha);void 0!==this.HGa&&null!==this.HGa&&this.HGa.start();let gb=null;va&&(gb=new b.a(f.a.Wn()),gb.K("x-LicensingForceRefresh","true"));this.a5e=new Date;return(this.GGa?
this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1)?Promise.race([this.Uda.X9(this.DT("/afhs/ApplicationFeatureHelperHandler.ashx",!0),this.Yce,0,gb,this.Cge,["Date"]),this.Uda.X9(this.DT("/afhs/ApplicationFeatureHelperHandler.ashx",!1),this.Yce,0,gb,this.Cge,["Date"])]):this.Uda.X9(this.DT("/afhs/ApplicationFeatureHelperHandler.ashx",this.Ba.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled")&&0===ja,this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseOwlOriginForAFHS",
!1)),this.Yce,0,gb,this.Cge,["Date"]):Promise.resolve({})).then(Gb=>{const Mb={durationMs:this.PWg(),extendedProperties:Ha};Mb.extendedProperties&&Gb&&(Mb.extendedProperties.set("featureCount",L.a.count(Gb).toString()),Mb.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Gb).toString()),Mb.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Gb).toString()),"FreemiumUpsell"in Gb&&Mb.extendedProperties.set("isFreemiumUpsellEnabled",Gb.FreemiumUpsell.toString()),
this.aT&&Mb.extendedProperties.set("fromCache",(this.aT<this.a5e).toString()));m.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Mb);return Gb},Gb=>{const Mb=Object.assign({},{durationMs:this.PWg()}),hb=Object(e.a)(u,Gb);if(!hb)return c.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),m.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,
!0,Mb),new Promise((Da,Bb)=>{Bb(Gb)});Mb.extendedProperties=Ha;Mb.extendedProperties&&Mb.extendedProperties.set("status",hb.httpStatusCode.toString());m.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Mb);return 408===hb.httpStatusCode&&++ja<=this.jNh?this.hte(ja):new Promise((Da,Bb)=>{Bb(hb)})})}DT(ja,va,Ha=!1){va=String.format("{0}{1}",Ha?"https://ffc-owl.officeapps.live.com":va?this.Ba.La("SuiteOrigin"):this.Ba.La("WebServiceBase"),ja);this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddUserSessionIdForAFHS",
!1)&&(va+="?usid="+A.AFrameworkApplication.userSessionId);this.Ba.Tz("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ba.getBooleanAppSetting("ApplicationFeatureHelperHttpCachingEnabled")&&(ja=Y.qwc(this.Ba))&&0<ja.length&&(this.emc&&(ja+="ucbf"),va=new U.QueryStringBuilder(va),va.Zi("afhskey",ja),va=va.toString());return va}isFeatureEnabled(ja,va){if(!this.IWa&&!this.ysd&&!this.GGa)return this.qRa;c.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
ja);if("ConnectedServices"===ja){var Ha=this.IWa?this.XUe.IV("ControllerConnectedServicesEnabled"):this.qRa;const Mb=this.ysd?this.m8e.getSettings().then(hb=>2!==hb.GL,()=>va):this.qRa;return Ha.then(hb=>hb?Mb:this.auc)}if("FreemiumUpsell"===ja&&(!this.Yld||!this.uGb||this.fic))return this.auc;Ha=null;Ha=this.IWa?this.XUe.isFeatureEnabled(ja):this.qRa;let gb=null;gb=this.GGa?this.Mij(ja,va):this.qRa;let Gb=null;Gb=this.ysd?this.m8e.isFeatureEnabled(ja):this.qRa;return Ha.then(Mb=>Mb?Gb.then(hb=>hb?
gb:this.auc):this.auc).then(Mb=>{this.EYf(ja,Mb,!0);return Mb},()=>{this.EYf(ja,va,!1);return va})}EYf(ja,va,Ha){c.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",ja,va,Ha)}getFeatureTier(ja,va){if(!this.GGa)return new Promise(Ha=>{Ha(2)});c.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",ja);return this.GJa.then(Ha=>this.Cxc(ja,Ha,va),()=>va)}isFreemiumUpsellEnabled(){if(this.Yld&&this.uGb&&!this.fic){if(this.Tdb&&
2!==this.ond||!this.Tdb&&1!==this.ond)c.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.Tdb.toString()),this.ond=this.Tdb?2:1;return this.Tdb}return!1}fEl(){return Object(V.g)()&&this.uGb&&this.fic}launchUpsellExperience(ja,va=null){c.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",ja));var Ha=y.a.xx();Ha&&(Ha.set("experienceId",
ja),va&&Ha.set("campaignId",va));m.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",w.b.SuccessBased,"waclicensing",Ha);(Ha=K.a.instance.yb("Common.IInProductMessagingUIManager"))?Ha.Gsj(ja,this.O1i,va):(c.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),m.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ya.Qa(P.a.dCe,2,{["experience"]:ja}))}OCb(ja,va){if(!this.GGa)return null;if(!ja||!va)return c.ULS.sendTraceTag(594564813,
3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const Ha=O.a.create().toString();this.FJa.Ob(ja)||this.FJa.K(ja,new b.a(f.a.Wn()));this.FJa.ha(ja).add(Ha,va);c.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Ha,ja));return Ha}M4b(ja,va){this.GGa&&(ja&&this.FJa.Ob(ja)?va&&O.a.isValid(va)?this.FJa.ha(ja).Ob(va)?(c.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
va,ja)),this.FJa.ha(ja).remove(va)):c.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",va,ja)):c.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",va,ja)):c.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
ja)))}Cxc(ja,va,Ha){return this.emc?ja in va?va[ja].LicenseTier:Ha:ja in va?this.t5j(va[ja],Ha):Ha}t5j(ja,va){switch(ja.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return va}}TIg(ja){c.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const va=this.hte(0,!0);va.then(Ha=>{this.GJa=va;L.a.count(Ha)>L.a.count(ja)?m.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):m.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess",
"FeatureCountNotIncreased",!1,!0,null);for(const gb of this.FJa.keys)if(gb in Ha){const Gb=this.Cxc(gb,Ha,0);gb in ja?this.Cxc(gb,ja,0)!==Gb&&this.C$d(gb,!0,Gb):this.C$d(gb,!0,Gb)}else gb in ja&&this.C$d(gb,!1,this.Cxc(gb,ja,0))}).catch(Ha=>{m.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);c.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(Ha))})}C$d(ja,va,Ha){c.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
ja,va,Ha);va=new N(ja,va,Ha);Ha=this.FJa.ha(ja);for(const gb of Ha)try{gb.value(va)}catch(Gb){c.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",ja,gb.key,Gb.message))}}Lij(ja,va){if(this.GGa){const Ha=this.w1e.contains(ja);let gb=!0,Gb="",Mb=!1;return this.GJa.then(hb=>{ja in hb?(hb=hb[ja],Gb=M[hb.FeatureState],gb=1!==hb.FeatureState):gb=!Ha;this.PYf(ja,Ha,
Gb,Mb,va,gb);return gb},()=>{Mb=!0;Ha&&(gb=va);this.PYf(ja,Ha,Gb,Mb,va,gb);return gb})}return this.qRa}PYf(ja,va,Ha,gb,Gb,Mb){c.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",ja,va,gb,Ha,Gb,Mb)}Mij(ja,va){if(this.emc)return this.Lij(ja,va);if(this.GGa){if(this.w1e.contains(ja))return this.GJa.then(Ha=>ja in Ha,()=>va);c.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",
ja)}return this.qRa}PWg(){if(void 0!==this.HGa&&null!==this.HGa){const ja=this.HGa.nv;this.HGa.stop();return ja}return null}static qwc(ja){try{if(W.a.TNe){const va=ja.La("UserDataSignature").split(".");if(1<va.length){const Ha=window.self.atob(va[1]),gb=JSON.parse(Ha).LocalStorageKey;if(void 0!==gb&&null!==gb&&0<gb.length)return gb}}}catch(va){c.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",va.toString())}return null}}Object(x.a)(Y,"ApplicationFeatureHelper",null,[480]);
var ta=a(68);class fa{constructor(ja,va){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=ja.PolicySettings;ja=new Date;ja.setMinutes(ja.getMinutes()+va);this.ExpirationTime=ja.getTime()}}Object(x.a)(fa,"CloudPolicySettingsCacheData",null,[]);var Ta=a(508),ha=a(181),qa=a(103);class ra{static mVg(){return A.AFrameworkApplication.ga.getBooleanAppSetting("SideCarIsEnabled")?ra.eWc&&ra.mSd?new Promise(ja=>{ja(!0)}):new Promise((ja,va)=>{ra.eWc=qa.a.create(A.AFrameworkApplication.ga.La("SideCarUrl"));
ha.a.HL(ra.eWc);ra.eWc.lma((Ha,gb)=>{(ra.mSd=gb.succeeded)?ja(gb.succeeded):va(gb.succeeded)})}):new Promise(ja=>{ja(!1)})}}ra.mSd=!1;ra.eWc=null;Object(x.a)(ra,"SideCarLoader",null,[]);class I{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(x.a)(I,"CloudPolicySettingsData",null,[]);class ba{constructor(ja,va){this.hid=0;this.Kpc=null;this.e5j=Ha=>{let gb=null;({BD:gb}=v.d(Ha));Ha=!!gb;c.ULS.sendTraceTag(50622687,3004,Ha?50:10,"ParseCloudPolicySettingsResponse: Success={0}",
Ha);return gb};this.Dge=Ha=>{try{if(void 0!==Ha&&null!==Ha&&"CheckIn-Interval"in Ha){const gb=parseInt(Ha["CheckIn-Interval"]);void 0!==gb&&null!==gb&&0<gb&&(this.hid=gb)}}catch(gb){c.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",gb)}};this.Uda=new z(ja,va);this.Ba=ja;va=ja.La("HostAuthType");this.IWa=ja.getBooleanAppSetting("OcpsIsEnabled")&&ja.getBooleanAppSetting("IsO365CommercialHost")&&!(void 0===va||null===va)&&"aad"===va.toLowerCase();this.R2e=
v.b(ja.La("OcpsDefaultSettings")||"{}");this.$Gb=this.qwc();va=this.Ba.Tz("ServicesControlsMicrosoftControllerServicesList")?this.Ba.tF("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Kid=new D.a;for(let Ha=0;Ha<va.length;Ha++)this.Kid.add(va[Ha]);this.IWa&&!ja.getBooleanAppSetting("IsAnonymousUser")&&ja.getBooleanAppSetting("SideCarIsEnabled")?this.Kpc=this.qUk():this.Kpc=this.M0g(this.IWa,this.e5j);this.Kpc.then(()=>null).catch(Ha=>{Ha=Object(e.a)(u,Ha);c.ULS.sendTraceTag(50622685,
3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",Ha?Ha.httpStatusCode.toString():"Unknown")})}IV(ja,va=!0,Ha=!0){var gb;if(!this.IWa){const Bb=this;return new Promise(Za=>{Za(Bb.VPb(ja))})}const Gb=this,Mb=this,hb=this.Kpc.then(Bb=>{try{let Za=null;Bb.PolicySettings&&"unknown"in Bb.PolicySettings&&(Za=Bb.PolicySettings.unknown);if(Za){if(ja in Za&&void 0!==Za[ja]&&null!==Za[ja])return new Promise(vb=>{vb("0"!==Za[ja])});const mb=ja.toLowerCase();if(mb in Za&&void 0!==Za[mb]&&
null!==Za[mb])return new Promise(vb=>{vb("0"!==Za[mb])});if(Ha)return c.ULS.sendTraceTag(51512667,3004,50,"Policy"+ja+" not found, using default"),new Promise(vb=>{vb(Gb.VPb(ja))});c.ULS.sendTraceTag(508395746,3004,50,"Policy"+ja+" not found, returning PolicyNotConfigured error");return new Promise((vb,sb)=>{sb("PolicyNotConfigured")})}return new Promise(mb=>{mb(Gb.VPb(ja))})}catch(Za){return c.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+ja+" policy value. Error Message: {0}",Za.message),Gb.handleError(Za.toString(),
va,Gb.VPb(ja))}},Bb=>Mb.handleError(Bb,va,Mb.VPb(ja))),Da=null===(gb=A.AFrameworkApplication.ga)||void 0===gb?void 0:gb.getBooleanAppSetting("FixPolicyNotConfiguredUnhandledPromiseRejection");gb=Bb=>{c.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",ja,Bb);return Da?Bb:null};if(Da)return hb.then(gb);hb.then(gb);return hb}isFeatureEnabled(ja,va=!0){return this.Nij(ja,va)}Nij(ja,va=!0){var Ha;let gb=new Promise(hb=>{hb(!0)}),Gb="";"mso_sendASmile"===
ja?Gb="Enabled":"Survey"===ja||"FloodgateSurvey"===ja?Gb="SurveyEnabled":this.Kid.contains(ja)&&(Gb="ControllerConnectedServicesEnabled");""!==Gb&&(gb=this.IV(Gb,va));va=hb=>{c.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",ja,hb,Gb);return Mb?hb:null};const Mb=null===(Ha=A.AFrameworkApplication.ga)||void 0===Ha?void 0:Ha.getBooleanAppSetting("FixPolicyNotConfiguredUnhandledPromiseRejection");if(Mb)return gb.then(va);
gb.then(va);return gb}handleError(ja,va,Ha){return va?new Promise(gb=>{gb(Ha)}):new Promise((gb,Gb)=>{Gb(ja)})}M0g(ja,va){if(!ja)return Promise.resolve(new I);let Ha=!1,gb=null;if(ja=y.a.xx())ja.set("useCommonDomain",this.Ba.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled").toString()),ja.set("useRace",this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1).toString());m.Health.instance.recordKpiUsage("GetCloudPolicySettings",w.b.SuccessBased,"jpittsdirects",
ja);let Gb=this.hmf("GetCloudPolicySettings");return(new Promise((Mb,hb)=>{if(void 0!==this.$Gb&&null!==this.$Gb&&0<this.$Gb.length){const Da=this.$Tk();if(void 0!==Da&&null!==Da){Ha=!0;Mb(Da);return}}(this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1)?Promise.race([this.Uda.X9(this.DT("/afhs/CloudPolicySettings.ashx",!0),va,1,null,this.Dge,["CheckIn-Interval"],this.Ba.Jc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ba.Jc("CloudPolicySettingsRequestSentTimeout",
3E4)),this.Uda.X9(this.DT("/afhs/CloudPolicySettings.ashx",!1),va,1,null,this.Dge,["CheckIn-Interval"],this.Ba.Jc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ba.Jc("CloudPolicySettingsRequestSentTimeout",3E4))]):this.Uda.X9(this.DT("/afhs/CloudPolicySettings.ashx",this.Ba.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled"),this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseOwlOriginForAFHS",!1)),va,1,null,this.Dge,["CheckIn-Interval"],this.Ba.Jc("CloudPolicySettingsRequestQueueTimeout",
15E3),this.Ba.Jc("CloudPolicySettingsRequestSentTimeout",3E4))).then(Da=>{c.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.UUk(Da);Mb(Da);return Da},Da=>{hb(Da);return null})})).then(Mb=>{({kD:Gb,returnValue:gb}=this.INe(Gb));var hb=y.a.xx();hb&&(hb.set("FromCache",Ha.toString()),hb.set("useCommonDomain",this.Ba.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled").toString()),hb.set("useRace",this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",
!1).toString()));hb=Object.assign({},{durationMs:gb,extendedProperties:hb});m.Health.instance.recordKpiSuccess("GetCloudPolicySettings",hb);return Mb})}qUk(){return ra.mVg().then(()=>{c.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}DT(ja,va,Ha=!1){ja=String.format("{0}{1}",Ha?"https://ffc-owl.officeapps.live.com":va?this.Ba.La("SuiteOrigin"):this.Ba.La("WebServiceBase"),
ja);this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddUserSessionIdForAFHS",!1)&&(ja+="?usid="+A.AFrameworkApplication.userSessionId);return ja}VPb(ja){return ja in this.R2e?"0"!==this.R2e[ja]:!0}$Tk(){try{const ja=Ta.a.instance.getItem(this.$Gb);if(void 0===ja||null===ja)return c.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;c.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",
ja);const va=JSON.parse(ja);if(void 0===va||null===va)return c.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===va.ExpirationTime||null===va.ExpirationTime)return c.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(va.ExpirationTime)).getTime()<Date.now())return c.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),
null;const Ha=new I;Ha.PolicySettings=va.PolicySettings;Ha.ControllerConnectedServicesFeatureNames=new ta.a;this.Ba.Tz("ServicesControlsMicrosoftControllerServicesList")&&this.Ba.tF("ServicesControlsMicrosoftControllerServicesList");for(const gb of this.Kid)Ha.ControllerConnectedServicesFeatureNames.add(gb);c.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Ha}catch(ja){return c.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",
ja.toString()),null}}UUk(ja){try{if(void 0===ja||null===ja||void 0===ja.PolicySettings||null===ja.PolicySettings)c.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.hid)c.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const va=new fa(ja,this.hid),Ha=JSON.stringify(va);c.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Ha);Ta.a.instance.setItem(this.$Gb,
Ha);c.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(va){c.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",va.toString())}}qwc(){const ja=Y.qwc(this.Ba);return ja&&0<ja.length?"OCPS"+ja:null}hmf(ja){const va=K.a.instance.yb("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==va&&null!==va?va.wl("WebServiceCall",ja):null}INe(ja){if(void 0!==ja&&null!==ja){const va=ja.nv;ja.stop();return{returnValue:va,
kD:null}}return{returnValue:null,kD:ja}}}Object(x.a)(ba,"CloudPolicySettingsHelper",null,[477]);class Ga{constructor(){this.bsf=this.Z4g=this.GL=0;this.csf=this.$4g=this.jMb="";this.drd=this.MRa=2}clone(){const ja=new Ga;ja.GL=this.GL;ja.Z4g=this.Z4g;ja.bsf=this.bsf;ja.jMb=this.jMb;ja.$4g=this.$4g;ja.csf=this.csf;ja.MRa=this.MRa;ja.drd=this.src;return ja}get src(){return this.drd}serialize(ja=null){const va={};if(!ja||ja.contains(Ga.P4a))va[Ga.P4a]=this.GL;if(!ja||ja.contains(Ga.M0b))va[Ga.M0b]=this.jMb;
if(!ja||ja.contains(Ga.N0b))va[Ga.N0b]=this.MRa;return JSON.stringify(va)}static create(ja,va=null){const Ha=new Ga;Ha.drd=ja;void 0!==va&&null!==va&&(Ga.P4a in va&&(Ha.GL=va[Ga.P4a]),Ga.M0b in va&&(Ha.jMb=va[Ga.M0b]),Ga.N0b in va&&(Ha.MRa=va[Ga.N0b]));return Ha}static deserialize(ja,va){try{const Ha=JSON.parse(ja);if(void 0!==Ha&&null!==Ha)return Ga.create(va,Ha);c.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",ja);throw Error.argument("settingsData");
}catch(Ha){throw c.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",Ha.toString()),Ha;}}}Ga.P4a="CCS";Ga.M0b="CCSTime";Ga.N0b="OfficePrivacyRoamedNoticeShown";Object(x.a)(Ga,"UserPrivacySettings",null,[]);var Oa=a(48);class Ja{constructor(ja,va){if(void 0===ja||null===ja||void 0===va||null===va)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ba=ja;this.$m=va;this.Kqd=this.$d=null}DT(ja){var va=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Ba.appSettings.RoamingServiceHandlerWebServiceBase||"");va=new Sys.StringBuilder(va);va.append(ja);va.append("&");va.append(A.AFrameworkApplication.ui);return va.toString()}executeRequest(ja,va,Ha,gb=null){return this.$m.GHa(ja,va,gb,null,!1,2,null,Ha,"33",!1,null,6E4)}saveSettings(ja){return new Promise((va,Ha)=>{try{if(void 0===this.$d||null===this.$d||void 0===ja||null===ja)c.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),Ha("Can't determine setting changes to save");
else{var gb=this.$d.GL!==ja.GL;if(2===this.$d.src&&gb)this.wvk(ja),va(!0);else{var Gb=this.myk(ja);if(void 0===Gb||null===Gb||!Gb.length)c.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),Ha("No changes to save");else if(1===this.$d.src)va(this.f1g(Gb));else if(0===this.$d.src){c.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Gb);const Mb=this.executeRequest(this.DT("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
Gb);Mb.continueWith(()=>{if(Mb.In||Mb.vm)c.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),va(!1);else{var hb=Mb.result;void 0!==hb.Wi&&null!==hb.Wi&&void 0!==hb.Wi.data&&null!==hb.Wi.data&&hb.Wi.data.Ze===l.a.bC?(c.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),va(!0)):(c.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),va(!1))}})}}}}catch(Mb){c.ULS.sendTraceTag(50860930,3004,
10,"SaveUserPrivacySettings: Exception = {0}",Mb.toString()),va(!1)}})}myk(ja){if(void 0===this.$d||null===this.$d||void 0===ja||null===ja)throw Error.invalidOperation("User Privacy settings have not been initialized");const va=new ta.a;0===ja.src?(this.$d.GL!==ja.GL&&(va.add(Ga.P4a),va.add(Ga.M0b)),this.$d.MRa!==ja.MRa&&va.add(Ga.N0b)):1===ja.src&&this.$d.GL!==ja.GL&&va.add(Ga.P4a);return va.count?ja.serialize(va):(c.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.Kqd){const ja=this;this.Kqd=new Promise(va=>{try{ja.$d?va(ja.$d.clone()):ja.hUk().then(Ha=>{ja.$d=Ha;va(ja.$d.clone());return null},()=>{ja.fUk().then(Ha=>{ja.$d=Ha;va(ja.$d.clone());return null},()=>{ja.gUk().then(Ha=>{ja.$d=Ha;va(ja.$d.clone());return null},()=>{c.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");ja.$d=new Ga;va(ja.$d.clone());return null});return null});return null})}catch(Ha){c.ULS.sendTraceTag(50860932,
3004,10,"UserPrivacySettings GetSettings: Exception = {0}",Ha.toString()),ja.$d=new Ga,va(ja.$d.clone())}})}return this.Kqd}hUk(){return new Promise((ja,va)=>{try{const gb=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ba.getBooleanAppSetting("PrivacyDialogShouldCheckRoaming")||gb){var Ha=this.executeRequest(this.DT("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");Ha.continueWith(()=>{try{if(Ha.In||Ha.vm)c.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");
else{const Gb=Ha.result;if(Gb&&Gb.Wi&&Gb.Wi.data)if(Gb.Wi.data.Ze!==l.a.bC)c.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Gb.Wi.data.Ze);else{if(Gb.Wi.data.responseData){ja(Ja.parse(Gb.Wi.data.responseData,0));c.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Gb.Wi.data.responseData);return}c.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else c.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");va("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Gb){c.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Gb.toString()),va("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else c.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),va("Roaming should not be used")}catch(gb){c.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",gb.toString()),va("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}fUk(){return new Promise((ja,va)=>{try{const Ha=Oa.a.get("WacUPToggleState");let gb=null;void 0!==Ha&&null!==Ha&&0<Ha.length&&(gb=decodeURIComponent(Ha));if(void 0!==gb&&null!==gb&&0<gb.length){const Gb=Ja.parse(gb,1);c.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Gb.toString());ja(Gb)}else{const Gb=Ga.create(1),
Mb=new ta.a;Mb.add(Ga.P4a);const hb=Gb.serialize(Mb);this.f1g(hb)?(c.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",hb),ja(Gb)):(c.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",hb),va("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(Ha){c.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
Ha.toString()),va("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}gUk(){return new Promise(ja=>{try{var va=-1!==window.location.href.indexOf("&wdccsoff=1");const Ha=Ga.create(2);va?(Ha.GL=2,A.AFrameworkApplication.Eeh(),c.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Ha.toString())):(Ha.GL=1,c.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",Ha.toString()));ja(Ha)}catch(Ha){c.ULS.sendTraceTag(50967431,
3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",Ha.toString()),va=Ga.create(2),va.GL=1,ja(va)}})}wvk(ja){c.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===ja.GL?A.AFrameworkApplication.Eeh():A.AFrameworkApplication.Dpl();c.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",ja)}f1g(ja){try{c.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",ja);const va=
this.Ba.La("PrivacyCookieDomain")||"";if(!va||!va.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");c.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",ja);return Oa.a.LDk("WacUPToggleState",ja,Oa.a.b_,va)}catch(va){return c.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",va.toString()),!1}}isFeatureEnabled(ja){return this.getSettings().then(va=>{const Ha=this.Ba.Tz("ServicesControlsMicrosoftControllerServicesList")?
this.Ba.tF("ServicesControlsMicrosoftControllerServicesList"):[],gb=new D.a;for(let Gb=0;Gb<Ha.length;Gb++)gb.add(Ha[Gb]);return gb.contains(ja)?2!==va.GL:!0},()=>{c.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",ja);return!0})}static parse(ja,va){try{return c.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",ja,va),Ga.deserialize(ja,va)}catch(Ha){throw c.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Ha.toString()),
Ha;}}}Object(x.a)(Ja,"UserPrivacySettingsHelper",null,[478]);var Qa=a(118);class Pa{constructor(){this.Ha=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}lc(ja){this.Ha=ja;this.Ha.register(477,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ma().na(()=>new ba(A.AFrameworkApplication.ga,A.AFrameworkApplication.ye));this.Ha.register(478,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ma().na(()=>new Ja(A.AFrameworkApplication.ga,
A.AFrameworkApplication.ye));this.Ha.register(479,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ma().na(()=>new F(A.AFrameworkApplication.ga,A.AFrameworkApplication.ye));this.Ha.register(480,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ma().na(()=>new Y(A.AFrameworkApplication.ga,A.AFrameworkApplication.ye,this.Ha.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Ha.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
A.AFrameworkApplication.vb))}init(){A.AFrameworkApplication.ga.fg(()=>{const ja=this.Ha.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");A.AFrameworkApplication.ga.getBooleanAppSetting("LicensingIsEnabled")&&(ja.isFeatureEnabled("LicensingTestFeature",!1).then(va=>{c.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",va,A.AFrameworkApplication.ga.La("IsAnonymousUser"));return null}),
ja.getFeatureTier("LicensingTestFeature",0).then(va=>{c.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",va,A.AFrameworkApplication.ga.La("IsAnonymousUser"));return null}));this.Ha.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.NPk()})}dispose(){}NPk(){try{A.AFrameworkApplication.ga.getBooleanAppSetting("SideCarIsEnabled")&&ra.mVg().then(ja=>{c.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",ja);return ja})}catch(ja){}}static main(){Qa.a.instance.Fc(new Pa)}}Object(x.a)(Pa,"ApplicationFeatureHelperPackage",null,[3,4])},1347:function(x,G,a){a.d(G,"a",function(){return n});x=a(0);var c=a(231),b=a(40),f=a(61),e=a(10),h=a(248),u=a(1123),m=a(305);class n{constructor(l,r,w,y,z,A){this.fpd=this.DFc=null;this.gN=Object(c.a)(u.a,y.Ypi(l,r,w,Object(b.a)(this,this.P3,"onPointerOver"),Object(b.a)(this,this.O3,"onPointerOut"),
z));this.KJc=0;this.od=A;this.od.sE(Object(b.a)(this,this.JI,"onSessionEnd"));this.clear()}dispose(){this.gN.dispose();this.DFc=null}get hCb(){return this.fpd}setZIndex(l){this.gN.setZIndex(l)}$dl(l,r,w){this.fpd=l;this.DFc=r;this.gN.jwh("UnreadNotification_16x16x32",this.hCb,w)}clear(){this.gN.clear();this.fpd=m.a.none}Toe(){this.pRb();this.gN.ptd(this.hCb,this.prf);this.gN.Ssg()}pRb(){this.gN.cAe();this.gN.ZLe()}JI(){h.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.KJc);
0<this.KJc&&f.c(e.a.Oci)}get prf(){return this.DFc?this.DFc():""}P3(){this.Toe();h.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.KJc+=1;return!0}O3(){this.pRb();return!0}}Object(x.a)(n,"ShapeRevisionTrackingPawn",null,[739])},1349:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(b){this.COj=b}get Bec(){return this.COj}}Object(x.a)(c,"ShowHideNotesData",null,[])},1355:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.Id=null;
this.Enabled=!1;this.DisplayName=this.Name=null;this.Order=0;this.Tooltip=null;this.IsEndpointProtectionEnabled=!1;this.ParentId=null;this.RequiredDowngradeJustification=!1;this.Color=this.AutoLabelingSensitiveTypeIds=this.LabelActions=null;this.HasUserDefinedPermissions=!1;this.DefaultSublabelId=null;this.UDPVerifyUserPermissionConfigurable=this.UDPVerifyUserPermissionDefaultState=this.UDPRequestPermissionsConfigurable=this.UDPRequestPermissionsDefaultState=this.UDPAccessProgrammaticConfigurable=
this.UDPAccessProgrammaticDefaultState=this.UDPDocumentExpirationConfigurable=this.UDPDocumentExpirationDefaultState=!1;this.HasExtractForUser=!0;this.ParentName="";this.AppliesDynamicWatermarking=!1;this.Id=this.DynamicWatermarkResolvedString=this.DynamicWatermarkFormatString="";this.Enabled=!1;this.DisplayName=this.Name="";this.Order=0;this.Tooltip="";this.IsEndpointProtectionEnabled=!1;this.ParentId="";this.RequiredDowngradeJustification=!1;this.LabelActions=[];this.AutoLabelingSensitiveTypeIds=
[];this.Color="";this.HasUserDefinedPermissions=!1;this.DefaultSublabelId="";this.UDPVerifyUserPermissionConfigurable=this.UDPVerifyUserPermissionDefaultState=this.UDPRequestPermissionsConfigurable=this.UDPRequestPermissionsDefaultState=this.UDPAccessProgrammaticConfigurable=this.UDPAccessProgrammaticDefaultState=this.UDPDocumentExpirationConfigurable=this.UDPDocumentExpirationDefaultState=!1;this.HasExtractForUser=!0;this.ParentName="";this.AppliesDynamicWatermarking=!1;this.DynamicWatermarkResolvedString=
this.DynamicWatermarkFormatString=""}}Object(x.a)(c,"SensitivityLabel",null,[])},1494:function(x,G,a){a.d(G,"a",function(){return w});x=a(0);var c=a(4),b=a(83),f=a(39),e=a(40),h=a(20),u=a(295),m=a(248),n=a(397);class l{constructor(){this.TenantId=this.LoggableUserId=this.FileSource=this.ProviderId=this.UserId=this.UserName=null;this.EnableMacrosForProtectedFile=this.BrowserCacheAllowed=!1;this.ComplianceDomainPrefix=this.ServerDocId=null;this.IsCLPCoauthoringEnabled=this.IsO365CommercialHost=this.IsO365ConsumerHost=
!1}}Object(x.a)(l,"PodsInfo",null,[]);var r=a(284);class w{constructor(y,z,A,B,H,v,C){m.a.J(512262873,804,50,"Start PodsInfoSender::PodsInfoSender()");this.Fb=C;this.$p=y;this.nb=z;this.od=A;this.oR=B;this.ee=H;this.Tb=v;this.QGe=!1;this.Qad=0;this.Fb.fg(Object(e.a)(this,this.initialize,"initialize"))}initialize(){m.a.J(512262872,804,50,"Start PodsInfoSender::Initialize()");this.sendInfoToPods(null);this.od.VG(Object(e.a)(this,this.Oq,"onSessionRehydrated"));this.oR.a$b(Object(e.a)(this,this.$ab,
"onPodSessionRefreshed"));this.QGe=!0}dispose(){this.QGe&&(this.od.wka(Object(e.a)(this,this.Oq,"onSessionRehydrated")),this.oR.PUc(Object(e.a)(this,this.$ab,"onPodSessionRefreshed")),this.QGe=!1)}sendInfoToPods(){var y=this.Fb.La(r.a.$l),z=this.nb.podSessionId;const A=this.nb.rp,B=c.AFrameworkApplication.userSessionId,H=b.a.create().toString();m.a.J(512262871,804,50,"PodsInfoSender.SendInfoToPods: Send user info to Pods, correlation={0}",H);y=String.format("{0}PodHandler.ashx?action=SendUserInfo&PodSID={1}",
y,z);z={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};z["X-UserSessionId"]=B;z["X-CorrelationID"]=H;z["X-WacCluster"]=A;try{const v=Object.assign(new l,{UserName:this.Fb.La(u.a.ZSl),UserId:this.Fb.La(r.a.lPa),ProviderId:this.Fb.La(r.a.L2b),FileSource:this.Fb.La("FileSource"),LoggableUserId:this.Fb.La("LoggableUserId"),TenantId:this.Fb.La("TenantId"),BrowserCacheAllowed:this.Fb.getBooleanAppSetting(r.a.XJe),EnableMacrosForProtectedFile:c.AFrameworkApplication.eDd,ServerDocId:this.Fb.La("ServerDocId"),
ComplianceDomainPrefix:c.AFrameworkApplication.ga.La("ComplianceDomainPrefix"),IsO365CommercialHost:this.Fb.getBooleanAppSetting("IsO365CommercialHost"),IsO365ConsumerHost:this.Fb.getBooleanAppSetting("IsO365ConsumerHost"),IsCLPCoauthoringEnabled:this.Fb.getBooleanAppSetting("PPTClpSwitchEnabled")&&this.Fb.getBooleanAppSetting("SupportsOfficeClientCoauthoring")}),C=h.c(v);this.$p.rk(y,2,C,z,!1,1,Object(e.a)(this,this.Vrn,"onSendUserInfoSucceeded"),Object(e.a)(this,this.Urn,"onSendUserInfoFailed"),
null,void 0,void 0,void 0,void 0,n.a("6"))}catch(v){m.a.J(512262870,804,15,"PodsInfoSender.SendInfoToPods: error serializing user info {0}",v)}}Vrn(){m.a.J(512262869,804,50,"PodsInfoSender.OnSendUserInfoSucceeded");this.Qad=0}Urn(){m.a.J(512262868,804,50,"PodsInfoSender.OnSendUserInfoFailed");3>this.Qad?this.oIn():this.wVm()}oIn(){this.Qad++;m.a.J(512262867,804,50,"PodsInfoSender.RetryRequestOnFailure: Request failed - retrying (failures count: {0})",this.Qad);const y=new f.a(1,1,5E3,Object(e.a)(this,
this.sendInfoToPods,"sendInfoToPods"),90,"22");this.Tb.Qb(y)}wVm(){m.a.J(512262866,804,15,"PodsInfoSender.GiveUp: Request failed - giving up (failures count: {0})",this.Qad);this.ee.SK(307,null);this.Qad=0}Oq(){this.Qad=0;m.a.J(512262865,804,50,"PodsInfoSender.OnSessionRehydrated");this.sendInfoToPods(null)}$ab(){this.Qad=0;m.a.J(512262864,804,50,"PodsInfoSender.OnPodSessionRefreshed");this.sendInfoToPods(null)}}Object(x.a)(w,"PodsInfoSender",null,[])},1507:function(x,G,a){a.d(G,"a",function(){return c});
x=a(0);var c;(function(b){b[b.isEnabled=1]="isEnabled";b[b.execute=2]="execute";b[b.animation=3]="animation"})(c||(c={}));Object(x.b)("ActionBehavior",c)},1508:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);var c;(function(b){b.None="None";b.P6g="ButtonModel";b.q2k="CheckboxModel";b.s2k="ColorPickerModel";b.Q6g="ComboBoxModel";b.t2k="CompoundButtonModel";b.M2k="ErrorViewModel";b.vBh="GalleryModel";b.P2k="FileMenu";b.S6g="FlyoutAnchorModel";b.X2k="IconGalleryButtonModel";b.Y2k="InkButtonModel";
b.Z2k="InkFlyoutAnchorModel";b.b3k="InsertTableModel";b.a3k="InputBoxModel";b.d3k="LabelModel";b.m3k="PageNumberGalleryButtonModel";b.e3k="ListGalleryButtonModel";b.p2k="CharacterCodeGalleryButtonModel";b.S2k="FontStyleGalleryButtonModel";b.$2k="InkThicknessGalleryButtonModel";b.H3k="TableStyleGalleryButtonModel";b.o2k="ChangeColorsGalleryButtonModel";b.n3k="PeopleWell";b.pCh="PreviewGalleryModel";b.B3k="SliderModel";b.n9b="SpinButtonModel";b.C3k="SplitButtonModel";b.TellMe="TellMe";b.I3k="ToggleButtonModel";
b.D3k="StatefulSplitButtonModel";b.z2k="DocumentTitleModel";b.f3k="MRUCompoundButtonModel";b.j3k="NewBlankDocumentModel";b.v2k="CustomTemplateModel";b.r2k="CoauthorGallery";b.E3k="SyncStatus";b.o3k="PersonaButtonModel";b.R2k="FontPickerModel";b.i3k="MultiActionButtonModel";b.z3k="SearchBoxModel"})(c||(c={}));Object(x.b)("ModelType",c)},1516:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.handler=null}}Object(x.a)(c,"SetAnnotationResultCallbackParameters",null,[])},
1536:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c;(function(f){f[f.aOl=0]="multipleBrowsersImageClassName";f[f.yTl=1]="peopleImageClassName";f[f.zTl=4]="peopleImageClusterPath";f[f.$Nl=5]="multipleBrowserImageClusterPath";f[f.oTa=6]="imageDimension";f[f.rtl=8]="rtl";f[f.kCb=9]="pointerInputManager";f[f.BSa=10]="clickInputManager";f[f.vertical=11]="vertical";f[f.zIndex=12]="zIndex";f[f.W5c=13]="contextMenuInputManager";f[f.uAl=14]="imageDomElement";f[f.n$l=15]="useIdleTooltip";f[f.G$l=
16]="viewportBoundsCallback";f[f.usl=17]="flipHorizontalDirection";f[f.qsl=18]="fixRemoveFadeOutElementCrash";f[f.sAl=19]="ignoreEventOnExpandedTooltip";f[f.qBl=20]="ipWidthAdjustForFlyout"})(c||(c={}));Object(x.b)("PresenceTooltipSettingKeys",c);class b{constructor(){this.kP={}}get(f,e=null){f=c[f];return"number"===typeof e?(e=this.kP[f])?Number.parseInvariant(e.toString()):0:this.kP[f]}add(f,e){this.kP[c[f]]=e}eca(f,e){c[f]in this.kP||(this.kP[c[f]]=e)}remove(f){delete this.kP[c[f]]}}Object(x.a)(b,
"PresenceTooltipSettings",null,[])},1537:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);class c{constructor(f,e,h){this.Ofh=f;this.W8l=e;this.i0k=h}}Object(x.a)(c,"ThemeData",null,[]);class b{}b.Iec=[new c("2e142a2c-cd16-42d6-873a-c26d2a0506fa","OfficeTheme2023",4),new c("62f939b6-93af-4db8-9c6b-d6c7dfdc589f","OfficeTheme",4),new c("b8441adb-2e43-4af7-b97a-bd870242c6a8","Ion",4),new c("28cdc826-8792-45c0-861b-85eb3adeda33","Organic",4),new c("f226e7a2-7162-461c-9490-d27d9dc04e43","Frame",
4),new c("fc33163d-4339-46b1-8eed-24c834239d99","IonBoardroom",4),new c("789ec3fe-34fd-429c-9918-760025e6c145","Mesh",4),new c("5f128b03-dcca-4eeb-ab3b-cf2899314a46","Retrospect",8),new c("0507925b-6ac9-4358-8e18-c330545d08f8","Slice",4),new c("1306e473-ed32-493b-a2d0-240a757edd34","Savon",4),new c("98dff888-2449-4d28-977c-6306c017633e","Banded",4),new c("39ec5628-30ed-4578-acd8-9820edb8e15a","Quotable",4),new c("7acabc62-bf99-48cf-a9dc-4db89c7b13dc","WoodType",4),new c("5665723a-49ba-4b57-8411-a56f8f207965",
"Basis",4),new c("3577f8c9-a904-41d8-97d2-fd898f53f20e","Integral",8),new c("7cb32d59-10c0-40dd-b7bd-2e94284a981c","Wisp",4),new c("9697a71b-4ab7-4a1a-bd5b-bb2d22835b57","Dividend",4),new c("c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5","Celestial",4),new c("3388167b-a2eb-4685-9635-1831d9aef8c4","Parallax",4),new c("4c5440d6-04d2-4954-96cf-f251137069b2","Metropolitan",8),new c("c0c680cd-088a-49fc-a102-d699147f32b2","Facet",4),new c("ba0eb5a6-f2d4-4f82-977b-64adee4a2a69","View",4),new c("5156b0e4-0eb1-49fe-a26b-15f6f698aec6",
"Atlas",4),new c("025cb5fb-2dd3-45ee-b6f0-cc461540eb19","Madison",4)];Object(x.a)(b,"DesignManager_data",null,[])},1622:function(x,G,a){(function(c){a.d(G,"a",function(){return w});var b=a(69),f=a(0),e=a(251),h=a(257),u=a(248),m=a(1616),n=a(1617),l=a(250),r=a(51);class w{constructor(y,z,A,B,H,v,C,F,D,N,U){this.Mab=this.pS=null;this.Gje=(W,L,O,M,K)=>{this.actionId=W;this.pS=this.pa.lo();return this.Ywh(!0)?1===O?32:K?2===O&&(this.w_f.lDb(!0,!1),W={},u.a.J(508908313,m.a.Bcc,n.a.info,"PictureBackgroundActor::removePictureBackground triggered."),
this.TGm(W),this.tWm(this.pS,W))?(this.Rih(),32):16:16:(this.Rih(),8)};this.Ske=(W,L,O,M,K)=>{const P=this.pa.lo();if(!this.Ywh(!1))return this.Rih(),8;if(1===O)return 32;if(!K)return 16;u.a.J(508703427,m.a.Bcc,n.a.info,"PictureBackgroundActor::restorePictureBackground triggered.");this.w_f.lDb(!0,!1);this.Mab=this.va.Ga;L=this.Mb.Fd(15,void 0,()=>{this.pa.Rw();this.pa.Ti();this.Ma.Wd()},()=>{this.yv.zI=P;this.pa.selectShape(P,!0)});try{this.pS=P,L.rc(this.Mab),L.sc=W,this.pS.VAb=!1,this.Rih()}finally{L&&
L.dispose(),this.w_f.lDb(!1,!1)}return 32};if(!y)throw Error.argumentNull("actionManager");if(!z)throw Error.argumentNull("appOfflineSetter");if(!A)throw Error.argumentNull("selectionManager");if(!B)throw Error.argumentNull("imageManager");this.ia=y;this.w_f=z;this.pa=A;this.dL=B;this.xb=H;this.va=v;this.Mb=F;this.Ma=C;this.yv=D;this.G0m=N;this.DI=U}Hb(){this.ia.sa(e.a.Gje,h.a.application,this.Gje,4);this.ia.sa(e.a.Ske,h.a.application,this.Ske,4)}ve(){}tWm(y,z){return(y=this.Ak(y))&&y.Ki&&(y=y.Ki)?
y.yta("RemoveBackgroundAction",z):!1}Ak(y){return y?y.tc(this.xb.Oa):null}TGm(y){y.type="RemoveBackgroundPayload";y.useMask=!0;y.downsample=!0;var z=this.Grl(this.va.Ga,this.pS,13,-1),A=500,B=500;z&&z.Base64Data&&(B=this.Grl(this.va.Ga,this.pS,1,this.pS.Vg),A=new URL(z.Base64Data),y.originalUrl=A,A=B?B.Height:z.Height,B=B?B.Width:z.Width);z={};A=new URL(`data:image/svg+xml;base64, ${c.from(this.tFf(A,B)).toString("base64")}`,window.location.origin);z.url=A;z.renderAsSvg=!0;z.overlay=!0;z.cropToGeometry=
!0;y.placeholder=z;y.resultHandler=this.QAn.bind(this);y.updatePicture=l.a("FixForBGRPlaceholderRemovalOnError")}tFf(y,z){y=this.Y1b(`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet" style="width:100%;" viewBox="0 0 ${z} ${y}">
    <defs>
      <animateTransform repeatCount="indefinite" dur="1.3666667s" begin="0s" xlink:href="#_R_G_L_0_G_L_1_G_N_2_T_0"
      fill="freeze" attributeName="transform" from="54" to="414" type="rotate" additive="sum" keyTimes="0;0.9756098;1"
       values="54;414;414" keySplines="0.33 0 0.1 1;0 0 0 0" calcMode="spline" />
      <animateTransform repeatCount="indefinite" dur="1.3666667s" begin="0s" xlink:href="#_R_G_L_0_G_L_0_G_N_2_T_0"
      fill="freeze" attributeName="transform" from="54" to="414" type="rotate" additive="sum" keyTimes="0;0.9756098;1"
      values="54;414;414" keySplines="0.33 0 0.1 1;0 0 0 0" calcMode="spline" />
      <animate attributeType="XML" attributeName="opacity" dur="1s" from="0" to="1" xlink:href="#time_group" />
    </defs>
    <g id="_R_G">
      <rect width="100%" height="100%" fill="rgba(179,179,179,0.5)" filter='blur(12px)' />
      <g id="_R_G_L_1_G" transform=" translate(${z/2}, ${y/2})
     translate(0, 0)" />
      <g id="_R_G_L_0_G" transform=" translate(${z/2}, ${y/2})
     translate(-14, -14)">
        <g id="_R_G_L_0_G_L_1_G_N_2_T_0" transform=" translate(14, 14) scale(2, 2)">
          <g id="_R_G_L_0_G_L_1_G">
            <path id="_R_G_L_0_G_L_1_G_D_0_P_0" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"
             fill="none" stroke-width="3" stroke-opacity="1"
             d=" M0 -12 C6.62,-12 12,-6.62 12,0 C12,6.62 6.62,12 0,12 C-6.62,
             12 -12,6.62 -12,0 C-12,-6.62 -6.62,-12 0,-12z " />
          </g>
        </g>
        <g id="_R_G_L_0_G_L_0_G_N_2_T_0" transform=" translate(14, 14)">
          <g id="_R_G_L_0_G_L_0_G" transform=" rotate(3.724)
      scale(0.2, 0.2)">
            <path id="_R_G_L_0_G_L_0_G_D_0_P_0" fill="#C43E1C" fill-opacity="1" fill-rule="nonzero"
            d=" M-40.12 -128.87 C-40.12,-128.87 -47.25,-127.25 -55.5,-123 C-63.75,-118.75 -71.87,
            -114.75 -79.75,-108.62 C-87.62,-102.5 -92.37,-100.25 -99,-92.5 C-105.62,-84.75 -110.5,
            -79 -114.87,-71.75 C-119.25,-64.5 -124.75,-53.62 -127.12,-46.75 C-129.5,-39.87 -133.14,
            -27.1 -133.87,-20.37 C-134.87,-11.25 -135,-5.37 -135,1.5 C-135,8.38 -134.87,12 -134.5,
            16.5 C-134.12,21 -132.75,24.88 -132.75,24.88 C-132.75,24.88 -103.5,17.63 -103.5,
            17.63 C-103.5,17.63 -104.87,6 -104.87,-0.37 C-104.87,-6.75 -104.12,-14.37 -103.12,
            -20.37 C-102.12,-26.37 -100.37,-31.12 -98,-37.12 C-95.62,-43.12 -93.12,-49.37 -89.62,
            -55 C-86.12,-60.62 -83.12,-64.62 -78.5,-69.37 C-73.87,-74.12 -67.75,-80.12 -63.5,
            -83.37 C-59.25,-86.62 -51.25,-91.87 -46,-94.25 C-40.75,-96.62 -33.62,-99.12 -33.62,
            -99.12 C-33.62,-99.12 -40.12,-128.87 -40.12,-128.87z " />
            <path id="_R_G_L_0_G_L_0_G_D_1_P_0" stroke="#C43E1C" stroke-linecap="round" stroke-linejoin="round"
             fill="none" stroke-width="1" stroke-opacity="1" d=" M-40.12 -128.87 C-40.12,-128.87 -47.25,
             -127.25 -55.5,-123 C-63.75,-118.75 -71.87,-114.75 -79.75,-108.62 C-87.62,-102.5 -92.37,
             -100.25 -99,-92.5 C-105.62,-84.75 -110.5,-79 -114.87,-71.75 C-119.25,-64.5 -124.75,-53.62 -127.12,
             -46.75 C-129.5,-39.87 -133.14,-27.1 -133.87,-20.37 C-134.87,-11.25 -135,-5.37 -135,1.5 C-135,
             8.38 -134.87,12 -134.5,16.5 C-134.12,21 -132.75,24.88 -132.75,24.88 C-132.75,24.88 -103.5,17.63 -103.5,
             17.63 C-103.5,17.63 -104.87,6 -104.87,-0.37 C-104.87,-6.75 -104.12,-14.37 -103.12,-20.37 C-102.12,
             -26.37 -100.37,-31.12 -98,-37.12 C-95.62,-43.12 -93.12,-49.37 -89.62,-55 C-86.12,-60.62 -83.12,
             -64.62 -78.5,-69.37 C-73.87,-74.12 -67.75,-80.12 -63.5,-83.37 C-59.25,-86.62 -51.25,-91.87 -46,
             -94.25 C-40.75,-96.62 -33.62,-99.12 -33.62,-99.12 C-33.62,-99.12 -40.12,-128.87 -40.12,-128.87z " />
          </g>
        </g>
      </g>
    </g>
    <g id="time_group" />
  </svg>`);return this.V5b(y)}Y1b(y){y=(new DOMParser).parseFromString(y,"image/svg+xml");if(0!==y.querySelectorAll("parsererror").length)throw Error("The XML could not be read");return y.firstElementChild}V5b(y){return(new XMLSerializer).serializeToString(y)}QAn(y){var z,A,B,H;return Object(b.b)(this,void 0,void 0,function*(){const v=null!==(A=null===(z=y.opExecutionTimeInMs)||void 0===z?void 0:z.toFixed(2))&&void 0!==A?A:"";y.succeeded?(u.a.J(508921416,m.a.Bcc,n.a.info,`PictureBackgroundActor::processBackgroundRemovalResults Success. ExecutionTime: ${v} ms.`),
this.Btm=y.result.picture.url,yield this.QXm(this.actionId,this.Btm)):(this.w_f.lDb(!1,!1),this.GPn(),u.a.J(508921415,m.a.Bcc,n.a.error,`PictureBackgroundActor::processBackgroundRemovalResults Failed. Status: ${null!==(H=null===(B=y.error)||void 0===B?void 0:B.message)&&void 0!==H?H:"unknown"}, ExecutionTime: ${v} ms.`))})}QXm(y,z){return Object(b.b)(this,void 0,void 0,function*(){this.Mab=this.va.Ga;const A=this.Mb.Fd(15,void 0,()=>{this.pa.Rw();this.pa.Ti();this.Ma.Wd()},()=>{this.yv.zI=this.pS;
this.pa.selectShape(this.pS,!0)});try{A.rc(this.Mab),A.sc=y,l.a("PPTOImgSrcBgrAttr")?this.pS.Tja=z.href:this.pS.abc=z.href,this.pS.VAb=!0}finally{A&&A.dispose(),this.w_f.lDb(!1,!1)}})}Rih(){if(l.a("RemoveBgButtonExperienceImprovement"))if(r.c()){var y=this.Ywh(!0),z=this.Ywh(!1);y=[appChrome.actions.updateControlHiddenState("RestorePictureBackground",!z),appChrome.actions.updateControlHiddenState("RemovePictureBackground",z),appChrome.actions.updateControlEnabledDisabledState("RemovePictureBackground",
!y),appChrome.actions.updateControlEnabledDisabledState("RestorePictureBackground",!z)];appChrome.api.dispatch(y)}else u.a.J(508060246,m.a.Bcc,n.a.info,"HandleToggleRemoveBackgroundBehavior: appChrome not defined")}Ywh(y){var z,A,B;const H=this.pa.ud();return H?1==H.length&&(null===(z=H[0])||void 0===z?void 0:z.Kg)&&(null===(A=H[0])||void 0===A?void 0:A.aFe)&&(null===(B=H[0])||void 0===B?void 0:B.VAb)!==y:!1}Grl(y,z,A,B){const H=y?y.Xb:null;z=z.get_shapeId();y=this.G0m.w8c(H,z,A,y.io,y.ek,B);u.a.J(508908312,
m.a.Bcc,n.a.info,"PictureBackgroundActor::fetchImageData fetching image data.");({data:y}=this.dL.b9c.$dc(y));if(y)return y;u.a.J(508923986,m.a.Bcc,n.a.error,"PictureBackgroundActor::fetchImageData image data cannot be fetched for image id")}GPn(){this.DI.rW(ResourceStrings.l_UnexpectedBEHTitle,ResourceStrings.l_GenericErrorMessage,!1,null,!1,null,0,0,null,null,!0,w.xwd,!1,null)}}w.xwd=20;Object(f.a)(w,"PictureBackgroundActor",null,[743])}).call(this,a(218).Buffer)},1640:function(x,G,a){a.d(G,"a",
function(){return H});x=a(0);var c=a(231),b=a(530),f=a(531),e=a(40),h=a(3),u=a(22);class m extends b.a{constructor(v,C){super(v);this.Fm=null;this.Qla=C.get(8,!1);this.bGa=C.get(6,0);this.element=v;this.element.className=m.jFd;this.ksd=this.createElement("ul");this.element.appendChild(this.ksd);this.wu=C.get(10);this.wu.Zb(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.nI=C.get(9);this.nI.Zb(h.a.AR,this.element,Object(e.a)(this,this.O3,"onPointerOut"));this.nI.Zb(h.a.TH,this.element,
Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior"));this.uua=C.get(13);this.uua.Zb(this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior"))}nSa(v){this.addHandler(f.a.xI,v)}d6a(v){this.removeHandler(f.a.xI,v)}get users(){return this.Fm}dispose(){this.element&&(this.wu.jc(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.nI.jc(h.a.TH,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")),this.nI.jc(h.a.AR,this.element,
Object(e.a)(this,this.O3,"onPointerOut")),this.uua.jc(this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(v,C,F){this.hide();!v||0>=v.length||(this.Qla?this.element.style.right=C+"px":this.element.style.left=C+"px",this.element.style.top=F+"px",this.P_h(v),this.visible=!0)}P_h(v){this.Fm=v;u.a.wx(this.ksd);for(let C=v.length-1;0<=C;C--)this.h0(v[C])}h0(v){const C=document.createElement("li");C.style.backgroundColor=v.color;
C.style.height=this.bGa+"px";C.id="fly_"+v.clientId;C.style.lineHeight=this.bGa+"px";u.a.SA(C,v.userName);C.setAttribute("dir","auto");this.ksd.appendChild(C)}onClick(){this.hide();return!1}O3(v){this.raiseEvent(f.a.xI,new f.a(3,v));return!1}}m.jFd="prFlyout UIFont";Object(x.a)(m,"PresenceTooltipFlyoutControl",b.a,[]);var n=a(135);class l extends b.a{constructor(v,C,F){super(v);this.Lua=null;this.Fm=[];this.element.className="prGlyph";this.$d=C;this.veb=this.$d.get(9);this.rE=this.$d.get(10);this.uua=
this.$d.get(13);this.F8i();this.h0(F);this.$ld=!1}get KAa(){return this.Fm.length}get users(){return this.Fm}nSa(v){this.addHandler(f.a.xI,v)}d6a(v){this.removeHandler(f.a.xI,v)}dispose(){this.MVk();super.dispose()}h0(v){Array.add(this.Fm,v);2===this.KAa?this.Vxb(!0):1===this.KAa?this.Vxb(!1):this.Vxb(this.$ld)}Bqa(v){this.MDi(v)&&(1<this.KAa&&this.Vxb(!0),1===this.KAa?this.Vxb(!1):1>this.KAa&&this.hide())}show(){this.Vxb(2<=this.KAa);this.visible=!0}hide(){this.visible=!1}UOi(v){return v?this.$Af(0,
5):this.$Af(1,4)}MDi(v){for(let C=0;C<this.KAa;C++)if(this.Fm[C].clientId===v)return v=this.Fm[C],Array.removeAt(this.Fm,C),v;return null}Vxb(v){this.$ld!==v&&(this.Lua&&this.element.removeChild(this.Lua),this.Lua=this.UOi(v),this.element.appendChild(this.Lua),this.$ld=v);this.Lua.childNodes[0].style.backgroundColor=this.Fm[this.Fm.length-1].color}$Af(v,C){const F=this.$d.get(6,0),D=this.$d.get(14);return n.c(F,F,this.$d.get(v),this.$d.get(C),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,
D?D.cloneNode(!0):null)}P3(v){3!==v.yg&&this.raiseEvent(f.a.xI,new f.a(2,v));return!1}onClick(v){this.raiseEvent(f.a.xI,new f.a(1,v));return!0}O3(v){3!==v.yg&&this.raiseEvent(f.a.xI,new f.a(3,v));return!1}MVk(){this.element&&(this.veb.jc(h.a.TH,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")),this.veb.jc(h.a.KP,this.element,Object(e.a)(this,this.P3,"onPointerOver")),this.veb.jc(h.a.AR,this.element,Object(e.a)(this,this.O3,"onPointerOut")),this.rE.jc(h.a.doubleClick,
this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")),this.rE.jc(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.uua.jc(this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")))}F8i(){this.element&&(this.veb.Zb(h.a.TH,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")),this.veb.Zb(h.a.KP,this.element,Object(e.a)(this,this.P3,"onPointerOver")),this.veb.Zb(h.a.AR,this.element,Object(e.a)(this,
this.O3,"onPointerOut")),this.rE.Zb(h.a.doubleClick,this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")),this.rE.Zb(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.uua.Zb(this.element,Object(e.a)(this,this.q_,"stopPropagationAndPreventDefaultBehavior")))}}Object(x.a)(l,"PresenceTooltipGlyph",b.a,[]);var r=a(53);a(26);var w=a(94);class y extends b.a{constructor(v,C,F){super(v);this.Fm=[];this.kC=[];this.Dla=0;this.EIb=this.Cdb=!1;this.qTe=null;this.iia=
(D,N)=>{var U=Object(c.a)(l,D);U=U?this.$wf(U):-1;if(2===N.type||1===N.type&&-1!==U&&!this.wX[U].visible)this.YRc(D);else if(1===N.type)this.Ixa(),this.Cdb=!1;else if(3===N.type){if(this.Xuf(N.$g))return;this.Cdb||this.Ixa()}this.raiseEvent(f.a.xI,N)};this.cGb={};this.$d=F;this.Ym=F.get(8,!1);this.q4=F.get(11,!1);v=F.get(12,0);this.oTa=F.get(6,0);this.$kc=C;this.element.id=y.XFd();this.element.className=b.a.GAe("prControl",this.Ym);v&&(this.zIndex=v);this.rtl=this.Ym;this.Dme(C);this.j4=this.createElement("div");
this.j4.className=this.q4?"prContainerV":"prContainerHr";this.element.appendChild(this.j4);this.LXe=Array(this.Dla);for(C=0;C<this.Dla;C++)this.wX[C]=new m(this.createElement("div"),this.$d),this.wX[C].nSa(this.iia),this.element.appendChild(this.wX[C].element)}get DKe(){return w.a.clone(this.Fm)}getGlyph(v){return this.cGb[v]}get wX(){return this.LXe}get o9e(){return this.qTe}get aZc(){return this.oTa+2}get width(){return this.q4?this.aZc:this.$kc}get height(){return this.q4?this.$kc:this.aZc}nSa(v){this.addHandler(f.a.xI,
v)}d6a(v){this.removeHandler(f.a.xI,v)}dispose(){if(this.wX)for(const v of this.wX)v.d6a(this.iia),r.a.lE(v);r.a.hOg(this.kC);this.kC=this.LXe=null;super.dispose()}rDb(){this.Ixa();this.Uoe();this.visible=!0;this.Cdb=!1}Zoe(){!this.kC||1>this.kC.length||(this.Ixa(),this.visible=!0,this.Uoe(),this.YRc(this.kC[this.kC.length-1]),this.Cdb=!0)}Cec(){if(this.kC&&!(1>this.kC.length)){this.visible=!0;this.Uoe();var v=0;for(const C of this.kC)this.YRc(C,v++);this.Cdb=!1;this.EIb=!0}}hide(){this.visible=!1;
this.Ixa();for(let v=0;v<this.kC.length;v++)this.kC[v].hide();this.Cdb=!1}oif(){if(!this.EIb)return!1;let v=0;for(const C of this.wX)C.visible&&v++;return this.EIb=0<v&&(this.Fm.length<=this.Dla?v===this.Fm.length:v===this.Dla)}h0(v){if(!(0>=this.Dla)){v.clientId||(v.clientId=(y.kGb++).toString());if(v.clientId in this.cGb){var C=this.JJa(v.clientId);if(0<=C){C=this.Fm[C];if(C.color===v.color&&C.userName===v.userName)return;this.Bqa(v.clientId)}}C=this.oif();var F=0;if(this.Fm.length<this.Dla){var D=
new l(this.createElement("div"),this.$d,v);D.nSa(this.iia);this.Ym&&!this.q4&&0<this.Fm.length?this.j4.insertBefore(D.element,this.j4.firstChild):(this.j4.appendChild(D.element),F=this.kC.length);Array.add(this.kC,D)}else this.Ym&&!this.q4?D=this.kC[0]:(F=this.kC.length-1,D=this.kC[F]),D.h0(v);D.show();this.cGb[v.clientId]=D;Array.add(this.Fm,v);this.S2g(D,F);C&&this.Cec()}}Bqa(v){const C=this.oif();C&&this.Ixa();this.P4b(v);this.Fm.length>=this.Dla&&this.kC.length<this.Dla&&this.Eik();0>=this.Fm.length?
this.hide():C&&this.Cec()}V9d(){}P4b(v){var C=this.JJa(v);0>C||(v=this.Fm[C],Array.removeAt(this.Fm,C),C=this.cGb[v.clientId],delete this.cGb[v.clientId],C.Bqa(v.clientId),this.S2g(C),0>=C.KAa&&(this.j4.removeChild(C.element),Array.remove(this.kC,C),C.dispose()))}Dne(){}Eik(){var v=this.WRi();!v||1>=v.users.length||(v=Array.clone(this.Fm),v.forEach(C=>{this.P4b(C.clientId)}),v.forEach(C=>{this.h0(C)}))}JJa(v){for(let C=0;C<this.Fm.length;C++)if(this.Fm[C].clientId===v)return C;return-1}WRi(){return this.Ym&&
!this.q4?this.kC[0]:this.kC[this.kC.length-1]}position(v,C){this.element.style.top=C+"px";this.element.style.left=v+"px"}Uoe(){for(let v=0;v<this.kC.length;v++)this.kC[v].show()}Ixa(){for(let v=0;v<this.Dla;v++)this.wX[v].hide();this.EIb=!1}YRc(v,C=0){if(v)if(this.qTe=v,this.q4){const F=this.oTa;if(1<v.users.length)this.wX[C].show(v.users,F,this.height-this.oTa);else{const D=this.j4.children.length;for(let N=0;N<this.j4.children.length;N++)v.element===this.j4.children[N]&&this.wX[C].show(v.users,
F,this.height-(D-N)*this.aZc+2)}}else this.wX[C].show(v.users,this.width,0)}Xuf(v){v=y.JJd(v);let C=!1;for(const F of this.wX)if(u.a.RAb(F.element,v)){C=!0;break}return this.j4!==v&&u.a.RAb(this.j4,v)||C}S2g(v,C=0){const F=this.Sej(v);F&&0>=v.KAa?this.wX[C].hide():F?this.YRc(v):this.wX[C].hide()}$wf(v){let C=0;for(const F of this.kC){if(v===F)return C;C++}return-1}Sej(v){const C=this.$wf(v);return!!this.o9e&&v===this.o9e&&-1!==C&&this.wX[C].visible}Dme(v){this.Dla=v===this.oTa?1:Math.floor(v/this.aZc);
this.q4?(this.element.style.height=v+"px",this.element.style.width=this.oTa+"px"):(this.element.style.width=v+"px",this.element.style.height=this.oTa+"px")}static XFd(){return String.format("{0}-{1}","presencetooltip",y.kGb++)}static JJd(v){v=v.Sb.rawEvent;return v.relatedTarget||v.toElement}}y.kGb=0;Object(x.a)(y,"PresenceTooltipControl",b.a,[344,24]);var z=a(391),A=a(460),B=a(457);class H{constructor(v){this.$d=v;this.$d.eca(10,z.a.instance);this.$d.eca(9,B.a.instance);this.$d.eca(6,16);this.$d.eca(13,
A.a.instance)}Qdh(v,C){return new y(v,C,this.$d)}umf(v){return new y(v,16,this.$d)}}Object(x.a)(H,"PresenceTooltipFactory",null,[343])},1643:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);class c{}c.taskPaneWidth=330;Object(x.a)(c,"AppsForOfficeConstants",null,[]);class b{constructor(){this.showLoadingSpinner=!1;this.Cma=null;this.resizeMaxWidth=this.resizeMinWidth=0;this.dialogWidth=this.dialogHeight=this.ksc=this.dialogTop=this.osc=this.dialogLeft=null;this.taskPaneWidth=c.taskPaneWidth;
this.JB=this.sourceLocationOverrideResourceId=null;this.nonPersistedSettings={};this.onExtensionLaunchCallback=this.onTaskPaneClose=null;this.showResizeChatButton=this.isResizable=this.isModernPane=!1;this.sharedRuntimeId=null;this.isPaneAutoOpened=this.isPreload=!1;this.A6c=this.z6c=!0}}Object(x.a)(b,"FirstPartyAddInOptionalParameters",null,[])},1671:function(x,G,a){a.d(G,"a",function(){return u});x=a(0);var c=a(119),b=a(349),f=a(4),e=a(62),h=a(85);class u extends c.a{constructor(m,n=!1){super(m,
!1,n)}get nTd(){return!1}get Kja(){return h.a.y6c+"/modeless"}get BFe(){return null}set BFe(m){}get zFe(){return null}set zFe(m){}Dq(m,n=null,l=null){this.ema&&(l.isModal=!1);super.Dq(m,n,l)}hide(){if(f.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Ed)this.K9l(),f.AFrameworkApplication.Ea.yy.Cr(b.AFrame.EAa),super.hide()}hom(){const m=f.AFrameworkApplication.Ea.yy,n=f.AFrameworkApplication.Ea.Or;m.P7(this.Kja);m.zja(this.Kja);
n.gd(this.Kja).parent=b.AFrame.vl}DHa(){e.FocusManager.tV()&&(super.DHa(),this.hom(),f.AFrameworkApplication.Ea.yy.XW(b.AFrame.EAa))}Cje(){if(e.FocusManager.tV()&&!f.AFrameworkApplication.mi){const m=e.FocusManager.instance();m.qka(this.Kja);const n=m.x$(this.Kja);n&&n.nt.tZ(null);m.Ddd(this.Kja)}}kub(){"DL"===this.S9b||"DP"===this.S9b?super.kub():f.AFrameworkApplication.ga&&f.AFrameworkApplication.ga.getBooleanAppSetting("WacAutoFitNonModalDialogIsEnabled")?(this.K9l(),this.mhl()&&this.u5l(this.Ed.clientHeight,
this.Ed.clientWidth)):this.n7()}n7(){this.u5l(c.a.B5k,c.a.C5k)}u5l(m,n){if(this.zFe&&this.BFe){let l,r;l=h.a.zDg+this.BFe;r=h.a.yDg+this.zFe;l+m>this.pAb()&&(l=this.pAb()-m);r+n>this.rAb()&&(r=this.rAb()-n);this.Axh(l,r)}else super.n7()}DRi(m){if(!m)return null;m.endsWith("px")&&(m=m.substring(0,m.length-2));return h.a.rbc(m)?((m=parseInt(m))||(m=1),m):null}K9l(){if(this.Ed&&this.Ed.style){var m=this.DRi(this.Ed.style.top);m&&(this.BFe=m-h.a.zDg);if(m=f.AFrameworkApplication.isRtl?this.DRi(this.Ed.style.right):
this.DRi(this.Ed.style.left))this.zFe=m-h.a.yDg}}}Object(x.a)(u,"ModelessCustomDialog",c.a,[])},1676:function(x,G,a){function c(ka){const ib=localStorage.getItem(ka);if(null===ib)return null;let Rb;try{Rb=JSON.parse(ib)}catch(tc){return localStorage.removeItem(ka),null}return!Number.isInteger(Rb.expiration)&&Number.isNaN(Date.parse(Rb.expiration))||new Date(Rb.expiration)<=new Date?(localStorage.removeItem(ka),null):Rb.value}function b(ka,ib){return null!==ka&&null!==ib&&ka.toLowerCase().startsWith(ib.toLowerCase())&&
ka.length>ib.length&&"-"===ka.charAt(ib.length)}function f(ka,ib,Rb){if(void 0===ka||null===ka||1>ka.length)return-1;if(null===ib&&null===Rb)return-2;if(0===(null===ib||void 0===ib?void 0:ib.length)&&0===(null===Rb||void 0===Rb?void 0:Rb.length))return-1;let tc=-1,xc=-1;for(let Fd=0;Fd<ka.length;Fd+=1){var hd=ka[Fd].lang.toLowerCase();hd=0!==(null===ib||void 0===ib?void 0:ib.length)&&hd===(null===ib||void 0===ib?void 0:ib.toLowerCase());const Td=0!==(null===Rb||void 0===Rb?void 0:Rb.length)&&ka[Fd].label.toLowerCase()===
(null===Rb||void 0===Rb?void 0:Rb.toLowerCase());0>xc&&Td&&(xc=Fd);if(hd){if(Td)return Fd;tc=Fd}0>tc&&(b(ka[Fd].lang,ib)||b(ib,ka[Fd].lang))&&(tc=Fd)}return 0<tc?tc:0<xc?xc:0}function e(ka){if(!(void 0===ka||null===ka||1>ka.length)){var [ib,Rb]=[c("CaptionsLang"),c("CaptionsLabel")],tc=f(ka,ib,Rb);if(0<=tc&&tc<ka.length)return ka[tc].src}}a.r(G);var h=a(1228),u=a(4),m=a(0),n=a(17),l=a(693),r=a(33),w=a(52);class y{constructor(ka,ib){this.$m=ka;this.X_=ib}XF(ka,ib,Rb,tc=null){return this.nFm(ka,tc,
xc=>this.$m.GHa(xc,2,Rb,ib,!1,2,null,void 0,void 0,void 0,void 0,void 0,"2"))}nFm(ka,ib,Rb){const tc=!!ib&&""!==ib;let xc=ka;tc&&(xc=r.a.FJb(ka,"perfTag",ib));const hd=new Date;return l.a.then(Rb(xc),Fd=>{const Td=+new Date-+hd;if(!Fd||!Fd.Wi||!Fd.Wi.data)return Fd;tc&&Fd.Wi.data.request&&this.nKn(Fd.Wi.data.request.getResolvedUrl(),ib,Td);return Fd})}nKn(ka,ib,Rb){ka=this.X_.mSm(ka);if(ka.count&&(ka=w.last(ka))){const tc={Message:"Request durations for activities calls."};tc.PerfTag=ib;tc.CustomDuration=
Rb;tc.PerformanceDuration=ka.duration;n.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(tc))}}}Object(m.a)(y,"CatchUpNetworkingWrapper",null,[64]);var z=a(560);class A extends z.a{constructor(ka,ib){super(ka,ib)}Gn(){return 6}}Object(m.a)(A,"GetActivityFeedRequest",z.a,[]);class B extends z.a{constructor(ka,ib,Rb,tc,xc,hd){super(ka,ib);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=Rb;this.ActivityStatesToSet=tc;this.ActivityStatesToReset=
xc;this.ResetUnseenCount=hd}Gn(){return 7}}Object(m.a)(B,"UpdateActivityFeedStateRequest",z.a,[]);var H=a(174),v=a(791);class C{constructor(ka,ib,Rb){this.h$k=ka;this.Byb=ib;this.Cyb=Rb}wLm(ka){return l.a.then(this.Cyb.execute(new A(this.Byb(),null),(ib,Rb,tc)=>this.h$k.XF(ib,Rb,tc,"ActivityFeed"),ka),ib=>{if(!ib)return n.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!ib.Wi)return n.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;
ib=ib.Wi.data;if(!ib)return n.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(ib.Ze!==H.a.bC)return n.ULS.sendTraceTag(508929507,3012,10,"GetActivityFeed: Response status code {0}",ib.Ze),null;if(!ib.responseData)return n.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;ib=v.a.u6c(ib.responseData);return ib?ib:(n.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}XWn(ka,
ib,Rb,tc,xc){return l.a.then(this.Cyb.execute(new B(this.Byb(),null,ib,Rb,tc,xc),(hd,Fd,Td)=>this.h$k.XF(hd,Fd,Td,"UpdateActivityFeedState"),ka),hd=>{try{return hd.succeeded}catch(Fd){return n.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception {0}",Fd.message),!1}})}}Object(m.a)(C,"CatchUpRequestHandler",null,[345]);var F=a(178);class D{constructor(ka){this.Xxe=ka;this.u9k=new F.a}L9m(){this.h$m()}h$m(){if(this.Xxe){var ka=ib=>{this.u9k.contains("CatchUpChangesFeedback")||(this.u9k.add("CatchUpChangesFeedback"),
ib.logActivity("CatchUpChangesFeedback",null))};this.Xxe.execute(ib=>{window.setTimeout(()=>{ka(ib)},2E4)})}else n.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(m.a)(D,"FloodgateEventLogger",null,[]);var N=a(68);class U{constructor(ka){this.Bkm=ka}get duration(){return this.Bkm.duration}}Object(m.a)(U,"PerformanceResourceTimingWrapper",null,[]);class W{constructor(ka){this.X_=ka}mSm(ka){const ib=new N.a;if(!this.X_)return ib;ka=this.X_.getEntriesByName(ka,
"resource");if(!ka)return ib;for(const Rb of ka)ib.add(new U(Rb));return ib}}Object(m.a)(W,"PerformanceWrapper",null,[]);var L=a(118);class O{constructor(){this.Ha=null}get name(){return"Common.App.CatchUpActivity"}lc(ka){this.Ha=ka;this.Ha.register(y,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").ma().na(()=>new y(u.AFrameworkApplication.ye,new W(window.performance)));this.Ha.register(C,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").ma().na(()=>
new C(this.Ha.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>u.AFrameworkApplication.ui,new v.a));this.Ha.register(D,"Common.App.CatchUpActivity.FloodgateEventLogger").ma().na(()=>new D(this.Ha.Na("Common.ISystemInitiatedFeedback")))}init(){this.Ha.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.Ha.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){L.a.instance.Fc(new O)}}Object(m.a)(O,"CatchUpActivityPackage",null,[3,4]);
var M=a(151),K=a(40),P=a(63);class V{constructor(ka,ib,Rb){this.IIk=this.JIk=this.KIk=!1;this.iJk=!ka&&!ib;this.jJk=!ka&&!Rb;this.iJk||this.jJk||(this.KIk=!ka,this.JIk=!ib,this.IIk=!Rb)}}Object(m.a)(V,"RenameDisabledDialogInfo",null,[]);var Y=a(6);class ta extends P.a{constructor(ka,ib,Rb,tc,xc){super();this.RPk=[];this.yGa=new V(ka,ib,Rb);this.e4c=tc;this.d3c=xc;this.uk="RenameDisabledDialog";this.gf=0;this.Fg(1,Object(Y.a)("DialogClose"));this.kNn();this.UGn()}kNn(){if(this.yGa.iJk){let ka;ka=this.e4c?
this.d3c?Object(Y.a)("RenameFileRenameReadOnlyRecommended"):Object(Y.a)("RenameFileRenameNotEveryoneSupportsRename"):Object(Y.a)("RenameFileRenameDisabledCoauthFull");this.ZUg(ka)}else this.yGa.jJk?this.ZUg(Object(Y.a)("RenameFileRenameDisabledPermissionFull")):this.Hom();this.tah(this.RPk)}ZUg(ka){Array.add(this.RPk,ka)}Hom(){const ka=[];this.yGa.KIk||Array.add(ka,Object(Y.a)("RenameFileRenameDisabledSignIn"));this.yGa.JIk||Array.add(ka,Object(Y.a)("RenameFileRenameDisabledPermission"));this.yGa.IIk||
Array.add(ka,Object(Y.a)("RenameFileRenameDisabledCoauth"));0<ka.length&&Array.add(this.RPk,ka)}}Object(m.a)(ta,"ReactRenameDisabledDialogBase",P.a,[]);class fa extends ta{constructor(ka,ib,Rb,tc,xc){super(ka,ib,Rb,tc,xc)}UGn(){this.Abd(Object(Y.a)("RenameFileRenameDisabledTitle"),null,null,null,null,null)}}Object(m.a)(fa,"ReactRenameDisabledDialog",ta,[]);var Ta=a(119);class ha{static get Bl(){return Ta.a.xX(ha.Ny,Object(Y.a)("RenameFileRenameDisabled"),Object(Y.a)("RenameFileRenameDisabledSignIn"),
Object(Y.a)("RenameFileRenameDisabledPermission"),Object(Y.a)("RenameFileRenameDisabledCoauth"))}}ha.Ny="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(m.a)(ha,"RenameDisabledDialogHtml",null,[]);class qa extends Ta.a{constructor(ka,ib,Rb,tc,xc){super();this.yGa=new V(ka,ib,Rb);this.e4c=tc;this.d3c=xc;this.uk="RenameDisabledDialog";this.gf=0;this.Fg(1,Object(Y.a)("DialogClose"));this.Bl=ha.Bl;this.showDialog(Object(Y.a)("RenameFileRenameDisabledTitle"),null);this.Nqa("RenameRow")}Zab(){if(this.yGa.iJk){let ka;ka=this.e4c?this.d3c?Object(Y.a)("RenameFileRenameReadOnlyRecommended"):Object(Y.a)("RenameFileRenameNotEveryoneSupportsRename"):Object(Y.a)("RenameFileRenameDisabledCoauthFull");
qa.ZUg(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),ka)}else this.yGa.jJk?qa.ZUg(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Object(Y.a)("RenameFileRenameDisabledPermissionFull")):this.RYm()}RYm(){this.yGa.KIk&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.yGa.JIk&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.yGa.IIk&&
(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static ZUg(ka,ib,Rb){ka.style.display="none";ib.innerText=Rb}}Object(m.a)(qa,"RenameDisabledDialog",Ta.a,[]);var ra=a(5),I=a(41),ba=a(10);class Ga{constructor(ka,ib){this.Nnd=0;this.wkf=(Rb,tc,xc,hd,Fd)=>{if(1===xc)return this.ya.Cb(ba.a.WCb,1);Rb=ra.a.r$(this.Sgc.TM);Fd=(0,Fd.getNewDocumentTitle)();Fd.length>this.Nnd&&(Fd=Fd.substr(0,this.Nnd));if(32!==this.ya.Qa(ba.a.WCb,2,Fd))return this.fPe(Rb),8;this.fPe(Fd);return 32};
this.ya=ka;this.Sgc=ib}initialize(ka){if(!this.ya||!this.Sgc)return!1;this.Nnd=ka;this.Hb();return!0}Hb(){this.ya.za(ba.a.wkf,I.a.frame,this.wkf)}fPe(ka){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(ka))}static dH(){return new Ga(u.AFrameworkApplication.vb,u.AFrameworkApplication.Wz)}}Object(m.a)(Ga,"ReactRenameUIHandler",null,[1283]);var Oa=a(447),Ja=a(885),Qa=a(851),Pa=a(3),ja=a(72),va=a(457),Ha=a(366),gb=a(26),Gb=a(7),Mb=a(19);class hb{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,
Fb,Xb){this._initialized=!1;this._element=null;this.Nnd=0;this.ASh=this.kKh=!1;this.ya=ka;this.PEh=ib;this.yr=Rb;this.nI=tc;this.Sgc=xc;this.wbl=hd;this.t$g=Fd;this.JFh=Td;this.tja=na;this.k8k=$a;this.Ej=Fb;this.kLh=Xb}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(ka,ib,Rb){if(!(this.ya&&this.Sgc&&this.wbl&&this.t$g&&this.JFh&&ib)||0>=ka)return!1;this._element=ib;this._element.title=Rb;this._element.setAttribute(Ha.a.pi,Ha.a.BL);this._element.setAttribute("Unselectable",
"on");this.Nnd=ka;this.OO();return this._initialized=!0}OO(){this.PEh&&(this.PEh.Zb(Pa.a.blur,this._element,Object(K.a)(this,this.onBlur,"onBlur")),this.PEh.Zb(Pa.a.paste,this._element,Object(K.a)(this,this.frn,"onPaste")));this.yr.Zb(Pa.a.Lj,this._element,Object(K.a)(this,this.onKeyDown,"onKeyDown"));this.nI.Zb(Pa.a.TH,this._element,Object(K.a)(this,this.rta,"onPointerDown"));this.nI.Zb(Pa.a.BR,this._element,Object(K.a)(this,this.l1b,"onPointerUp"))}onBlur(){this.isActive&&!this.kKh&&(this.k8k||
this.JFh(this._element),this.Nkl(),this.bsi(!1));return this.kKh=!1}frn(){n.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(ka){return this.isActive?this.vqn(ka):this.wqn(ka)}vqn(ka){let ib=!1;switch(ka.Sb.keyCode){case Sys.UI.Key.enter:this.Nkl();this.bsi(this.Ej||this.kLh);ib=!0;break;case Sys.UI.Key.tab:this.k8k&&this.JFh(this._element);break;case Sys.UI.Key.esc:this.Ksk(),this.bsi(this.Ej||this.kLh),ib=!0}return ib}wqn(ka){let ib=!1;switch(ka.Sb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.o8l(this.kLh),
this.isActive&&this.t$g(this._element),ib=!0}return ib}rta(){this.isActive||(this.o8l(!1),this.isActive&&(this._element.focus(),this.t$g(this._element),this.ASh=!0));return!1}l1b(){return this.ASh?(this.t$g(this._element),this.ASh=!1,!0):!1}eFe(){return 32===this.ya.Cb(ba.a.WCb,1)}Nkl(){const ka=ra.a.r$(this.Sgc.TM);let ib=this._element.innerText.trim();ib.length>this.Nnd&&(ib=ib.substr(0,this.Nnd));ib!==ka&&""!==ib?32!==this.ya.Qa(ba.a.WCb,2,ib)?this.Ksk():this.fPe(ib):this.Ksk()}Ksk(){this.fPe(ra.a.r$(this.Sgc.TM))}fPe(ka){this._initialized&&
(this._element.innerText=ka,this.wbl())}o8l(ka){this.eFe()?this.isActive||(ka&&(this.kKh=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Ha.a.pi,Ha.a.Tbh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Oa.a.Usf),this.tja&&this.tja.execute(ib=>{ib.Qgk(!0)}),ka&&this._element.focus(),n.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ya.Cb(ba.a.rNe,
2)}bsi(ka){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Ha.a.pi,Ha.a.BL);Sys.UI.DomElement.removeCssClass(this._element,Oa.a.Usf);this.tja&&this.tja.execute(ib=>{ib.Qgk(!1)});ka&&(this._element.blur(),this._element.focus())}static Lbb(){Ja.a.Lbb(u.AFrameworkApplication.isRtl)}static dH(){return new hb(u.AFrameworkApplication.vb,Qa.a.instance,ja.a.instance,va.a.instance,u.AFrameworkApplication.Wz,hb.Lbb,gb.a.BJn,gb.a.Sfi,
Mb.a.instance.Na("Common.App.Header.HeaderEventSource"),Gb.a.YK,Gb.a.lk,Gb.a.zg)}}Object(m.a)(hb,"RenameUIHandler",null,[1283]);class Da{static get instance(){return u.AFrameworkApplication.Ea.Kb.eO?Da.Wa||(Da.Wa=Ga.dH()):Da.Wa||(Da.Wa=hb.dH())}}Da.Wa=null;Object(m.a)(Da,"RenameUIHandlerFactory",null,[]);var Bb=a(42),Za=a(44);class mb{constructor(){this.Gug=this.Hmn=this.VCm=null}}Object(m.a)(mb,"RenameMruEntryProperties",null,[]);var vb=a(153),sb=a(70),bc=a(647),yb;(function(ka){ka[ka.unknown=-1]=
"unknown";ka[ka.success=0]="success";ka[ka.I5n=1]="renameInvalidFileName";ka[ka.H5n=2]="renameInCoauthNotSupported";ka[ka.J5n=3]="renameNotSupportedInViewMode";ka[ka.permissionDenied=4]="permissionDenied";ka[ka.f6n=5]="serverCommunicationFailure";ka[ka.t3n=6]="fileNameTooLong"})(yb||(yb={}));Object(m.b)("CommonOperationResult",yb);var uc=a(91);class vc{constructor(ka,ib=!1){this.fileNameCandidate=ka;this.disableFailedActionDialog=ib}}Object(m.a)(vc,"RenameActionData",null,[]);var wc=a(51);class ub{constructor(ka,
ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb,Xb){this.ORb=()=>Da.instance.initialize(u.AFrameworkApplication.Yfh,u.AFrameworkApplication.bac,u.AFrameworkApplication.IZl||Object(Y.a)("RenameFileTooltip"))?32:8;this.rNe=()=>{const nc=this.uZn(),Nc=this.fnm();n.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.und,Nc,nc,this.e4c);u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.XV&&
u.AFrameworkApplication.ga.getBooleanAppSetting("ReactRenameDisabledDialogIsEnabled")?new fa(this.und,!Nc,!nc,this.e4c,this.d3c()):new qa(this.und,!Nc,!nc,this.e4c,this.d3c());return 32};this.WCb=(nc,Nc,yd,Ud,ie)=>{if(1===yd)return this.eFe();if(!u.AFrameworkApplication.QDd)return 8;if(8===this.eFe())return this.Gs.Cb(ba.a.rNe,2),8;n.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");nc=!1;ie instanceof vc&&(nc=ie.disableFailedActionDialog,ie=ie.fileNameCandidate);u.AFrameworkApplication.QDd(ie,
Object(K.a)(this,this.$yg,"onRenameFileSuccess"),nc?this.qon:this.Frn);u.AFrameworkApplication.DGn=!0;return 32};this.qon=nc=>{n.ULS.sendTraceTag(507655632,203,15,"OnAutoRenameFileFailure: {0}",{["Result"]:null!==nc&&void 0!==nc?nc:-1})};this.Frn=nc=>{n.ULS.sendTraceTag(507655631,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==nc&&void 0!==nc?nc:-1});const Nc=new P.a;Nc.gf=0;switch(nc){case 1:n.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Nc.OYc(Object(Y.a)("RenameFileInvalidNameTitle"),
Object(Y.a)("RenameFileInvalidName"),null);break;case 6:n.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Nc.OYc(Object(Y.a)("RenameFileInvalidNameTitle"),Object(Y.a)("RenameFileNameTooLong"),null);break;default:n.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==nc&&void 0!==nc?nc:-1}),Nc.OYc(Object(Y.a)("RenameFileGenericErrorTitle"),Object(Y.a)("RenameFileGenericError"),null)}u.AFrameworkApplication.k3().execute(yd=>{yd.sendMessage(sb.a.NIm,
{["FailureMessage"]:yb[nc]})});this.F_l()};this.TDn=(nc,Nc,yd)=>{if(1===yd)return this.eFe();if(!u.AFrameworkApplication.kac)return 8;u.AFrameworkApplication.kac(Object(K.a)(this,this.MIe,"onRefreshFilenameSuccess"),Object(K.a)(this,this.Yrh,"onRefreshFilenameFailure"),!1);return 32};this.crh=(nc,Nc,yd,Ud,ie)=>{if(1===yd)return u.AFrameworkApplication.ga.getBooleanAppSetting("UiHostSupportsMoveToFolder")?this.eFe():8;if(2===yd){if(!u.AFrameworkApplication.zPg)return Bb.Health.instance.recordKpiFailure("MoveToFolder",
"Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!ie)return Bb.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(ie[vb.a.g4m])if(ie[vb.a.i$l])if(nc=ie[vb.a.i$l].toLowerCase(),Nc=u.AFrameworkApplication.ga.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"),yd=u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Nc&&u.AFrameworkApplication.aab&&yd){const Be={};Be[vb.a.mUc]="1";Be[vb.a.documentUrl]=nc;
Be[vb.a.reason]=bc.a.nOg;Bb.Health.instance.recordKpiSuccess("MoveToFolder",null);u.AFrameworkApplication.k3().execute(oe=>{oe.sendMessage(sb.a.gZa,Be)})}else if(!u.AFrameworkApplication.aab&&yd)Bb.Health.instance.recordKpiSuccess("MoveToFolder",null),gb.a.jq(nc,gb.a.syb(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Bb.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Bb.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,
!1,null);else u.AFrameworkApplication.kac(Object(K.a)(this,this.MIe,"onRefreshFilenameSuccess"),Object(K.a)(this,this.Yrh,"onRefreshFilenameFailure"),!1),u.AFrameworkApplication.zPg(),Bb.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};this.r8k=ka;this.ya=ib;this.IEb=Rb;this.c9=tc;this.und=xc;this.fnm=hd;this.e4c=Fd;this.Scl=Td;this.olm=na;this.d3c=$a;this.Ba=Fb;this.nlm=Xb}Hb(){u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.eO||this.Gs.za(ba.a.ORb,I.a.frame,this.ORb);this.Gs.za(ba.a.rNe,
I.a.frame,this.rNe);this.Gs.za(ba.a.WCb,I.a.frame,this.WCb);this.Gs.sa(ba.a.SBe,I.a.frame,this.TDn,64);this.Gs.sa(ba.a.crh,I.a.frame,this.crh,64);this.Gs.za(ba.a.eOc,I.a.frame,Object(K.a)(this,this.eOc,"moveToFolder"));(u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||u.AFrameworkApplication.Ea&&(u.AFrameworkApplication.ga.getBooleanAppSetting("PostMessageEmbedded")||u.AFrameworkApplication.ga.getBooleanAppSetting("IsJsApi"))&&u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&u.AFrameworkApplication.k3().execute(ka=>{ka.Xt(sb.a.VNl);ka.jE(sb.a.VNl,ub.nDn);ka.Xt(sb.a.gDi);ka.jE(sb.a.gDi,ub.lDn)})}eFe(){return 0===this.nlm.TTi()?32:8}uZn(){return this.NZ?this.e4c?this.NZ.Srf:this.NZ.g$a:!0}$yg(ka,ib){ka?0!==ka.OperationResult?this.gyl(ka.OperationResult):(this.hKn(ib,ka.NewName),this.dXn(ka,Object(K.a)(u.AFrameworkApplication.Ea.Kb,u.AFrameworkApplication.Ea.Kb.tYk,"updateOpenInClientDocumentUrl")),u.AFrameworkApplication.ga.getBooleanAppSetting("DocumentNameInJewelInfoMenuIsEnabled")&&
u.AFrameworkApplication.Ea.Zf(),this.olm.l9l()):this.gyl(5)}hKn(ka,ib){const Rb={};Rb[vb.a.OIm]=ib;ka.sendMessage(sb.a.gDi,Rb)}dXn(ka,ib){this.nXn(ka);u.AFrameworkApplication.WAe=ka.DirectInvokeDavUrl;ib=ib(ka.EditDocInClientUrl);const Rb=new mb;Rb.Gug=this.c9.TM;Rb.VCm=ib;Rb.Hmn=ka.EditDocInClientUrl;this.Gs.Qa(ba.a.Duh,2,Rb)}gyl(ka){switch(ka){case 1:ka=new P.a,ka.gf=0,ka.m7(Object(Y.a)("RenameFileInvalidNameTitle"),Object(Y.a)("RenameFileInvalidName"),null),this.F_l()}}nXn(ka){this.c9.TM=ub.gsm(this.c9.TM,
ka.NewName);ka.BreadcrumbFolderName&&(this.c9.breadcrumbFolderName=ka.BreadcrumbFolderName);ka.BreadcrumbFolderUrl&&(this.c9.breadcrumbFolderUrl=ka.BreadcrumbFolderUrl);this.Scl(ka.NewName)}eOc(ka,ib,Rb,tc,xc){if(1===Rb)return u.AFrameworkApplication.ga.getBooleanAppSetting("UiHostSupportsMoveToFolder")?32:8;if(2===Rb){const hd={};ka=u.AFrameworkApplication.aab;ib=u.AFrameworkApplication.ga.getBooleanAppSetting("UiHostSupportsDocRebootFeatures");ka=(!ka||ka&&ib)&&u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1);hd[vb.a.gTn]=ka;xc&&xc.MoveButtonClickedTime&&(hd[vb.a.Jgn]=xc.MoveButtonClickedTime.getTime());u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.MoveFilePickerDarkModeSupported",!1)&&(ka={},Object(wc.a)("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(ka[vb.a.LTl]="Dark"),hd[vb.a.JTl]=ka);u.AFrameworkApplication.k3().execute(Fd=>{Fd.sendMessage(sb.a.eOc,hd)});xc&&xc.MoveButtonClickedTime&&((ka=Za.a.xx())&&ka.set("MovePostDuration",((new Date).getTime()-
xc.MoveButtonClickedTime.getTime()).toString()),Bb.Health.instance.recordKpiUsage("MoveToFolder",uc.b.FailureBased,"smartfio",ka));return 32}return 8}ZOn(ka,ib){return ka&&ib?ka!==this.c9.breadcrumbFolderName||ib!==this.c9.breadcrumbFolderUrl:!1}MIe(ka,ib){ka&&(ka.NewName!==ra.a.r$(this.c9.TM)||this.ZOn(ka.BreadcrumbFolderName,ka.BreadcrumbFolderUrl))&&this.$yg(ka,ib)}Yrh(){}F_l(){this.Scl(ra.a.r$(this.c9.TM))}get Gs(){return this.ya.value}get NZ(){return this.IEb.value}static get instance(){return ub.Wa||
(ub.Wa=ub.Yuc())}static Yuc(){return new ub(u.AFrameworkApplication.fFe,new M.a(()=>u.AFrameworkApplication.vb),new M.a(()=>u.AFrameworkApplication.NZ),u.AFrameworkApplication.Wz,u.AFrameworkApplication.a1,()=>u.AFrameworkApplication.Tue,u.AFrameworkApplication.HLe,Object(K.a)(Da.instance,Da.instance.fPe,"updateTitle"),Mb.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>u.AFrameworkApplication.YV,u.AFrameworkApplication.ga,Mb.a.instance.resolve("Common.IRenameProps"))}static gsm(ka,
ib){ka=ra.a.vI(ka);return ib+ka}static nDn(ka){const ib=ka.Values[vb.a.j5m];n.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ib);ib?u.AFrameworkApplication.vb.Qa(ba.a.crh,2,ka.Values):Bb.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static lDn(ka){u.AFrameworkApplication.vb.Qa(ba.a.WCb,2,ka.Values.NewName)}}ub.Wa=null;Object(m.a)(ub,"RenameActor",null,[]);var aa=a(576),Na=a(1298),ia=a(1269),wa=a(401);class pa{constructor(ka,
ib){this.ya=ka;this.sHh=ib}Hb(){this.ya.za(ba.a.VUg,I.a.frame,Object(K.a)(this,this.wQn,"showRenameDialogAction"))}wQn(ka,ib,Rb){ka=32;if(1===Rb)return wa.SessionStatusManager.instance.QKa||u.AFrameworkApplication.boa?8:32;2===Rb&&(32!==this.ya.Cb(ba.a.WCb,1)?(this.ya.Cb(ba.a.rNe,2),aa.a.instance.Yb(Na.a.Jja,{["Reason"]:ia.a.HZl}),ka=8):32===this.ya.Cb(ba.a.WUg,1)?this.ya.Cb(ba.a.WUg,2):this.sHh.value.create().nwb());return ka}}Object(m.a)(pa,"RenameDialogActor",null,[1252]);class Ea{constructor(ka,
ib,Rb){this.dialog=null;this.ya=ka;this.c9=ib;this.n8g=Rb}hSm(){const ka={};ka.nameInputProps={["type"]:"AppInputProps",["id"]:Ea.zwi,["label"]:Object(Y.a)("RenameDialogLabel"),["value"]:ra.a.r$(this.c9.TM),["maxLength"]:this.n8g};return ka}nwb(){const ka={["id"]:"RenameDialog",["bodyControls"]:this.hSm()};this.dialog=new Ta.a(!1,!1,!0);this.dialog.gf=1;this.dialog.uk="RenameDialog";this.dialog.Dq(Object(Y.a)("RenameDialogTitle"),Object(K.a)(this,this.CGn,"renameDialogHandler"),ka)}CGn(ka,ib){if(ib&&
1===ka){if(ib[Ea.zwi]&&(ka=ra.a.r$(this.c9.TM),ib=(ib[Ea.zwi]||"").trim(),ib!==ka&&""!==ib)){this.ya.Qa(ba.a.WCb,2,ib);return}aa.a.instance.Yb(Na.a.D6c,{["Reason"]:ia.a.Lrl})}}}Ea.zwi="txtDocumentName";Object(m.a)(Ea,"RenameDialog",null,[1284]);class La{constructor(ka){this.Sgc=null;this.n8g=0;this.ya=ka;this._initialized=!1}initialize(ka,ib){this.Sgc=ka;this.n8g=ib;this._initialized=!0}create(){return this._initialized?new Ea(this.ya,this.Sgc,this.n8g):null}}Object(m.a)(La,"RenameDialogFactory",
null,[1251]);var Aa=a(349),nb=a(61),Wa=a(39),ea=a(25),Kb=a(80);class kc{constructor(ka,ib){this.ya=ka;this.Je=ib}Hb(){this.ya.za(ba.a.WUg,I.a.frame,Object(K.a)(this,this.xQn,"showRenameFlyoutAction"))}xwm(){return wc.d("setDocumentTitleFlyoutOpened")&&u.AFrameworkApplication.Ea.Kb.eO}xQn(ka,ib,Rb){if(1===Rb)return this.xwm()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}qpm(){kc.t6m&&u.AFrameworkApplication.R$a&&ea.TaskManager.instance.Qb(new Wa.a(5,1,5E3,
()=>{32===this.ya.Cb(ba.a.WUg,1)&&this.Je&&this.Je.currentScope.name===Aa.AFrame.uT&&(nb.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ya.Cb(ba.a.WUg,2))}))}static get t6m(){kc.b9g&&null!=kc.b9g||(Kb.a.BI("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),kc.b9g=u.AFrameworkApplication.ga?u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return kc.b9g}}kc.b9g=null;Object(m.a)(kc,"RenameFlyoutActor",
null,[1249]);class ac{constructor(ka,ib,Rb,tc,xc){this.Qjf=null;this.IEb=xc;this.s8k=Rb;this.r8k=tc;this.hnm=ka;this.d3c=ib}get NZ(){return this.IEb.value}TTi(){if(!this.r8k())return 5;if(this.d3c())return 1;if(this.NZ){if(this.s8k&&!this.NZ.Srf)return 3;if(!this.s8k&&!this.NZ.g$a)return 4}return this.hnm()?0:2}}Object(m.a)(ac,"RenameProps",null,[1250]);var eb=a(92);class Hb{constructor(ka,ib,Rb,tc,xc,hd){this.rL=!1;this.QMh=new eb.a;this.Cwe=ib;this.Tid=Rb;this.yid=tc;this.Ba=xc;this.hva=hd}enable(){this.rL||
(this.l9l(),this.pMk(),this.rL=!0)}generateKey(ka,ib,Rb){return String.format("{0}/{1}/{2}",Rb,ka,ib)}PPm(){const ka=ra.a.r$(this.Cwe().TM);return this.generateKey(this.Cwe().breadcrumbFolderName,this.Cwe().breadcrumbFolderUrl,ka)}QPm(ka,ib,Rb){return ka&&ib?this.generateKey(ka,ib,Rb):Rb}HEm(ka,ib,Rb){return ka&&ka!==this.Cwe().breadcrumbFolderName||ib&&ib!==this.Cwe().breadcrumbFolderUrl?!0:Rb!==ra.a.r$(this.Cwe().TM)}l9l(){const ka=this.PPm();this.QMh.K(ka,new Date)}u6j(ka){this.yOn(ka)&&this.Cdl(ka)}yOn(ka){const ib=
this.yid();return ib?this.hva&&this.hva.P$a||!ib.Ckh||!u.AFrameworkApplication.kac?(this.y6l(ka),this.rL=!1):!0:!1}MRl(ka,ib,Rb,tc){const xc=this.HEm(ka,ib,Rb);ka=this.QPm(ka,ib,Rb);ib=this.QMh.Uh(ka).returnValue;xc&&!ib&&(this.iyl(tc),n.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Hxj));xc||this.QMh.K(ka,this.Tid())}}Object(m.a)(Hb,"ARenamedFileChecker",null,[1231]);class ua extends Hb{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td){super(ka,ib,Rb,tc,xc,hd);this.Gyl=(na,$a)=>{$a&&$a.Jug&&
$a.Enn&&($a.jUd("BreadcrumbDocName")||$a.jUd("BreadcrumbFolderName")||$a.jUd("BreadcrumbFolderUrl")||$a.jUd("DirectInvokeDAVUrl")||$a.jUd("EditDocInClientUrl"))&&(n.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Hxj),this.u6j($a))};this.Oal=xc;this.mlm=Fd;this.eld=Td}get Hxj(){return"RenamedFileCheckerUsingSettingsRefresh"}pMk(){this.Oal.Uah(this.Gyl)}y6l(){this.Oal.bpk(this.Gyl)}Cdl(ka){if(ka&&ka.Jug){const ib=ka.Jug;this.MRl(ib.La("BreadcrumbFolderName"),ib.La("BreadcrumbFolderUrl"),
ib.La("BreadcrumbDocName"),ka)}}iyl(ka){const ib={OperationResult:0,classId:1};ka=ka.Jug;ib.BreadcrumbFolderName=ka.La("BreadcrumbFolderName");ib.BreadcrumbFolderUrl=ka.La("BreadcrumbFolderUrl");ib.DirectInvokeDavUrl=ka.La("DirectInvokeDAVUrl");ib.EditDocInClientUrl=ka.La("EditDocInClientUrl");ka=ka.La("BreadcrumbDocName");ib.NewName=u.AFrameworkApplication.G6c?ka:ra.a.r$(ka);this.eld.execute(Rb=>{this.h3m(ib,Rb)})}h3m(ka,ib){this.mlm().$yg(ka,ib)}}Object(m.a)(ua,"RenamedFileCheckerUsingSettingsRefresh",
Hb,[]);class Va extends Hb{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a){super(ka,Rb,tc,xc,hd,na);this.M4e=this.Q9b=null;this.Fkm=ib;this.ya=Fd;this.ze=Td;$a&&$a.execute(Fb=>{this.ZEn(Fb)})}get Hxj(){return"RenamedFileCheckerUsingTask"}ZEn(ka){this.Q9b=ka;this.Q9b.G4c(Object(K.a)(this,this.bMd,"handleVisibilityChange"))}bMd(ka,ib){!this.rL||0!==ib.newState&&1!==ib.newState||this.M4e||(this.pMk(),this.u6j(this.M4e))}pMk(){this.M4e=new Wa.a(3,2,this.Fkm(),Object(K.a)(this,this.u6j,"performRenameFileCheckTick"),
89);this.ze.Qb(this.M4e)}y6l(ka){this.ze.li(ka)}Cdl(ka){this.Q9b&&2===this.Q9b.hca?this.yFn(ka):u.AFrameworkApplication.kac(Object(K.a)(this,this.MIe,"onRefreshFilenameSuccess"),Object(K.a)(this,this.Yrh,"onRefreshFilenameFailure"),!0)}yFn(ka){this.ze.li(ka);this.M4e=null}MIe(ka){ka&&this.MRl(ka.BreadcrumbFolderName,ka.BreadcrumbFolderUrl,ka.NewName,null)}iyl(){this.ya.Cb(ba.a.SBe,2)}Yrh(){}}Object(m.a)(Va,"RenamedFileCheckerUsingTask",Hb,[]);var Yb=a(62);class Cb{constructor(){this.Ba=this.Ha=null;
this.su=()=>{const ka=u.AFrameworkApplication.Ea.Kb.eO;u.AFrameworkApplication.fFe()&&Da.instance.initialize(u.AFrameworkApplication.Yfh,ka?null:u.AFrameworkApplication.bac,ka?null:u.AFrameworkApplication.IZl||Object(Y.a)("RenameFileTooltip"))&&(this.Ha.register(ac,"Common.App.Rename.RenameProps").as("Common.IRenameProps").na(()=>new ac(()=>u.AFrameworkApplication.Tue,()=>u.AFrameworkApplication.YV,u.AFrameworkApplication.HLe,u.AFrameworkApplication.fFe,new M.a(()=>u.AFrameworkApplication.NZ))).ma(),
ub.instance.Hb(),this.Ba.getBooleanAppSetting("RenameDialogIsEnabled")&&(this.Ha.resolve("Common.App.Rename.RenameDialogFactory").initialize(u.AFrameworkApplication.Wz,u.AFrameworkApplication.Yfh),this.Ha.resolve("Common.App.Rename.IRenameDialogActor").Hb()),this.Ha.resolve("Common.App.Rename.IRenameFlyoutActor").Hb(),u.AFrameworkApplication.HLe&&this.Ha.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Ha.resolve("Common.App.Rename.IRenameFlyoutActor").qpm())}}get name(){return"Common.App.RenameFile"}lc(ka){this.Ha=
ka;this.Ba=u.AFrameworkApplication.ga;this.Ha.register(pa,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").na(()=>new pa(u.AFrameworkApplication.vb,this.Ha.ge("Common.App.Rename.IRenameDialogFactory"))).ma();this.Ha.register(La,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").na(()=>new La(u.AFrameworkApplication.vb)).ma();this.Ha.register(1231,"Common.App.Rename.IRenamedFileChecker").na(()=>this.MBm()).ma();this.Ha.register(kc,
"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").na(()=>new kc(u.AFrameworkApplication.vb,Yb.FocusManager.instance())).ma()}MBm(){if(this.Ba.getBooleanAppSetting("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const ka=this.Ha.yb("Common.IRefreshableAppSettings");if(ka&&ka.O5m)return new ua(()=>ka.Jc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>u.AFrameworkApplication.Wz,()=>new Date,()=>u.AFrameworkApplication.NZ,ka,this.Ha.yb("Common.ISessionStatus"),()=>ub.instance,
this.Ha.Na("Postmessage.IHostPostmessenger"))}return new Va(()=>this.Ba.Jc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ba.Jc("RenamedFileCheckerPingIntervalInMs",12E4),()=>u.AFrameworkApplication.Wz,()=>new Date,()=>u.AFrameworkApplication.NZ,u.AFrameworkApplication.ga,u.AFrameworkApplication.vb,u.AFrameworkApplication.je,this.Ha.yb("Common.ISessionStatus"),this.Ha.Na("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ba.fg(this.su)}dispose(){}}Object(m.a)(Cb,"PackageManager",
null,[3,4]);var ca=a(20);const Ra=ka=>{try{return ca.a(ka)}catch(ib){}return null};class bb{constructor(ka,ib,Rb,tc,xc,hd){this.R8a=!1;this.mHa=null;this.dQh=!1;this.i7h=Fd=>{const Td=Fd.BO.task;Td.continueWith(()=>{this.mHa=Td.result;this.dQh&&(this.mHa.mvb(2,null,!0),this.dQh=!1);this.mHa.Zmc((na,$a)=>{2===$a.type&&this.Gs.Cb(ba.a.SBe,2)});this.mHa.Otd((na,$a)=>{2===$a.newState&&this.Gs.Cb(ba.a.SBe,2)});2===this.mHa.connectionState&&this.Gs.Cb(ba.a.SBe,2)})};this.MIe=Fd=>{this.R8a=!1;const Td=Ra(Fd.data.responseData);
Fd.data.state.vw(Td,this.i9k.value)};this.Brn=Fd=>{5!==Fd.data.status||this.R8a?this.cRl(Fd):(this.R8a=!0,this.Gql(Fd.data.state,!1))};this.cRl=Fd=>{Fd.data.state.SF(-1)};this.$yg=Fd=>{this.R8a=!1;const Td=Ra(Fd.data.responseData);Fd.data.state.vw(Td,this.i9k.value);this.FOl()};this.Grn=Fd=>{5!==Fd.data.status||this.R8a?this.jRl(Fd):(this.R8a=!0,this.Hql(Fd.data.state,!1))};this.jRl=Fd=>{Fd.data.state.SF(-1)};this.ya=ka;this.$m=ib;this.IEb=Rb;this.i9k=tc;this.Ba=xc;this.xjm=hd}init(ka,ib){ib&&ka.Na("Common.Interface.IRtcBasicProvider").execute(this.i7h)}kac(ka){this.Gql(ka,
!0)}Gql(ka,ib){const Rb=this.bvm(ka.w5l),tc={};tc[bb.lll]=bb.mll;this.h_l.rk(Rb,2,"",tc,!1,2,this.MIe,ib?this.Brn:this.cRl,ka)}QDd(ka){this.Hql(ka,!0)}Hql(ka,ib){const Rb=this.cvm(),tc={};tc[bb.lll]=bb.mll;tc[bb.XXm]=ra.a.Sj(ka.l_l);tc[bb.VXm]=this.xjm.value.Qjf;this.h_l.rk(Rb,2,"",tc,!1,2,this.$yg,ib?this.Grn:this.jRl,ka)}cvm(){return this.dil()}bvm(ka){let ib=this.dil();return ib=r.a.em(ib,bb.aYm,ka?"2":"1")}dil(){let ka=(this.Ba.value.appSettings.RenameWebServiceBase||"")+bb.WXm;ka=r.a.em(ka,bb.YXm,
ra.a.Sj(u.AFrameworkApplication.ui));this.NZ&&this.NZ.Ckh&&(ka=r.a.em(ka,bb.$Xm,"1"));return ka}FOl(){this.mHa?this.mHa.mvb(2,null,!0):this.dQh=!0}get Gs(){return this.ya.value}get h_l(){return this.$m.value}get NZ(){return this.IEb.value}static get instance(){return bb.Wa||(bb.Wa=bb.Yuc())}static Yuc(){return new bb(new M.a(()=>u.AFrameworkApplication.vb),new M.a(()=>u.AFrameworkApplication.ye),new M.a(()=>u.AFrameworkApplication.NZ),new M.a(()=>Mb.a.instance.resolve("Postmessage.IHostPostmessenger")),
new M.a(()=>u.AFrameworkApplication.ga),new M.a(()=>Mb.a.instance.resolve("Common.IRenameProps")))}}bb.lll="Content-Type";bb.mll="application/json; charset=utf-8";bb.WXm="renamehandler.ashx";bb.YXm="qs";bb.XXm="n";bb.$Xm="sl";bb.VXm="X-CoauthLockId";bb.aYm="u";bb.Wa=null;Object(m.a)(bb,"ExecuteRenameFileHandler",null,[]);class wb{constructor(){this.SF=this.vw=null;this.w5l=!1}}Object(m.a)(wb,"ExecuteRefreshFilenameData",null,[]);class Fa{constructor(){this.SF=this.vw=this.l_l=null}}Object(m.a)(Fa,
"ExecuteRenameFileData",null,[]);class rb{constructor(){this.Ha=null;this.qIh=bb.instance;this.su=()=>{u.AFrameworkApplication.fFe()&&(bb.instance.init(this.Ha,u.AFrameworkApplication.HLe),u.AFrameworkApplication.QDd=Object(K.a)(this,this.QDd,"executeRenameFile"),u.AFrameworkApplication.kac=Object(K.a)(this,this.kac,"executeRefreshFilename"),u.AFrameworkApplication.zPg=Object(K.a)(this,this.zPg,"sendFileNameAndLocationUpdateNotification"))}}get name(){return"Common.App.RenameFile.RenameExecutor"}lc(ka){this.Ha=
ka}init(){u.AFrameworkApplication.ga.fg(this.su)}QDd(ka,ib,Rb){const tc=new Fa;tc.l_l=ka;tc.vw=ib;tc.SF=Rb;this.qIh.QDd(tc)}kac(ka,ib,Rb){const tc=new wb;tc.vw=ka;tc.SF=ib;tc.w5l=Rb;this.qIh.kac(tc)}zPg(){this.qIh.FOl()}dispose(){}}Object(m.a)(rb,"PackageManager",null,[3,4]);class $b{constructor(ka,ib,Rb,tc,xc,hd){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=ka;this.WebAffinitizedUrl=
ib;this.PolicyCookie=Rb;this.PolicyCookieTTL=tc;this.WasServiceDown=xc;this.AffinitizedUrl=hd}}Object(m.a)($b,"SafeLinksData",null,[]);class ec{constructor(ka,ib){this.wyh=ka;this.kD=ib}}Object(m.a)(ec,"SafeLinksGetUrlReputationRequestData",null,[]);class pc{constructor(ka,ib,Rb,tc){this.aqn=xc=>{let hd="OnGetUrlReputationSuccessCallback: ",Fd=10;const Td=xc.data.state;try{const na=ca.b(xc.data.responseData).reputationResults[0],$a=na.navigateUrl.length,Fb=Td.wyh.length,Xb=na.navigateUrl===Td.wyh;
na.navigateUrl&&0<na.navigateUrl.length&&(Td.wyh=na.navigateUrl);hd+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",xc.data.Ze,na.verdict,Fb.toString(),$a.toString(),Xb.toString());Fd=50}catch(na){hd+=String.format("Exception {0}",na.message)}this.kyl(Td,hd,Fd)};this.$pn=xc=>{let hd="OnGetUrlReputationFailureCallback: ";const Fd=xc.data.state;try{hd+=String.format("HttpStatus {0}",xc.data.Ze)}catch(Td){hd+=String.format("Exception {0}",
Td.message)}this.kyl(Fd,hd,10)};this.Ba=ka;this.$m=ib;this.bim=Rb;pc.Un=tc}U0g(ka,ib,Rb){try{var tc=null;pc.Un&&(tc=pc.Un.wl("WebServiceCall","SafeLinksGetUrlReputation"));const xc=new ec(ib,tc);tc={};tc.AffinitizedUrl=ka;tc.TargetUrl=ib;tc.PolicyCookie=Rb;const hd=ca.c(tc);this.$m.rk(this.bim,2,hd,null,!1,2,this.aqn,this.$pn,xc,void 0,void 0,3E3,3E3,"36");return!0}catch(xc){n.ULS.sendTraceTag(588788033,378,10,xc.message)}return!1}kyl(ka,ib,Rb){ka.kD&&(ka.kD.stop(),ka.kD=null);n.ULS.sendTraceTag(588788034,
378,Rb,ib);gb.a.jq(ka.wyh,void 0,"noopener,noreferrer","SafeLinksNav")}}pc.Un=null;Object(m.a)(pc,"SafeLinksNavigationHelper",null,[]);var dd;(function(ka){ka[ka.f3n=0]="enabledByPolicy";ka[ka.zol=1]="disabledByPolicy";ka[ka.S2n=2]="disabled_GetPolicyFailure";ka[ka.T2n=3]="disabled_PendingGetPolicyRequest"})(dd||(dd={}));Object(m.b)("SafeLinksNavigationState",dd);var Ad=a(508),Jb=a(121),Bc=a(741),Mc=a(83);class ed{constructor(ka,ib,Rb,tc=!1,xc=null,hd=null){this.Ckd=this.Bkd=0;this.bSf=this.A8g=!1;
this.A3c=null;this.bxe=!0;this.w$g=null;this.ySm=na=>{let $a=H.a.bnn,Fb="";try{this.A8g=this.bSf=!1;var Xb=na.data.state;const rf=({kD:Xb}=this.INe(Xb)).returnValue,Vf=Object.assign({},{durationMs:rf});Bb.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Vf);n.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",na.data.Ze,na.data.responseData.length,rf);if(na.data.Ze!==H.a.bC)Fb="Unexpected httpStatus: "+
na.data.Ze.toString();else{Xb=null;try{Xb=ca.b(na.data.responseData)}catch(xg){Fb="Exception:"+xg.toString()+" deserializing response";return}if(Xb){var nc=Xb.IsSafeLinksEnabled;if(void 0===nc||null===nc||0>=nc.length)Fb="Invalid isSafeLinksEnabledString";else{n.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",nc);var Nc=ed.r5j(nc);if(void 0===Xb.WebAffinitizedUrl||null===Xb.WebAffinitizedUrl||0>=Xb.WebAffinitizedUrl.length)Fb="Invalid WebAffinitizedUrl";else if(void 0===
Xb.PolicyCookie||null===Xb.PolicyCookie||0>=Xb.PolicyCookie.length)Fb="Invalid PolicyCookie";else if(void 0===Xb.PolicyCookieTTL||null===Xb.PolicyCookieTTL)Fb="Invalid PolicyCookieTTL";else{var yd=Xb.WebAffinitizedUrl,Ud=Xb.PolicyCookie,ie=Xb.AffinitizedUrl,Be=new Date;Be.setMinutes(Be.getMinutes()+(5<Xb.PolicyCookieTTL?Xb.PolicyCookieTTL-5:0));var oe=new $b(nc,yd,Ud,Be.getTime(),!1,ie);this.e2l(oe);$a=na.data.Ze;this.A3c&&(Nc?(this.x8l(this.A3c),this.Ckd=this.Bkd=0):(n.ULS.sendTraceTag(26019602,
378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),Bb.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),gb.a.aCe(this.A3c)),this.A3c=null)}}}else Fb="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(rf){Fb="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+rf.toString()}finally{$a!==H.a.bC&&this.jyl($a,Fb)}};this.xSm=na=>{this.A8g=!1;let $a=500,Fb="";try{let Xb=na.data.state;const nc=({kD:Xb}=this.INe(Xb)).returnValue,
Nc=Object.assign({},{durationMs:nc});$a=na.data.Ze;Bb.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+$a.toString(),!1,!0,Nc);Fb="Request Failed, Status="+Bc.a[na.data.status]+" Duration: "+nc}catch(Xb){Fb="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+Xb.toString()}finally{this.jyl($a,Fb)}};n.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Ba=ka;this.$m=ib;this.LM=Rb;ed.Un=hd;this.onm=tc?this.Ba.La("SafeLinksHandlerWebServiceBase"):
this.Ba.La("WebServiceBase");this.inm=this.Ba.La("SafeLinksHashedUserId");this.l0n=this.Ba.La("SafeLinksWorkloadIdHeaderValue");this.r9g=this.Ba.Jc("SafeLinksMaxGetPolicyBootRetries",2);this.s9g=this.Ba.Jc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.S8g=this.Z5m();this.R8g=this.Y5m();ed.Zcl=this.Ba.La("UserPrincipalName")||"";ed.ycl=this.Ba.La("TenantId")||"";n.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.S8g,this.R8g);if(this.S8g&&
this.R8g){ib=(ka=this.Q7c())?ka.IsSafeLinksEnabled.toLowerCase():"";Rb=this.Anj();n.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",ib,Rb);var Fd=!ka||"unknown"===ib||ka.WasServiceDown||Rb,Td=Za.a.xx();Td&&(Td.set("shouldGetSafeLinksDataFromServer",Fd.toString()),Td.set("isSafeLinksEnabledCacheValue",ib.toString()));xc?(this.bxe=!1,xc.execute(na=>{na.isFeatureEnabled("MsoUrlreputation",!0).then($a=>{this.bxe=$a;Td.set("isUserLicensedForSafeLinks",
this.bxe.toString());Bb.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",uc.b.FailureBased,"jpittsdirects",Td);this.bxe&&Fd&&this.aih(!0);return null})})):(Bb.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",uc.b.FailureBased,"jpittsdirects",Td),Fd&&this.aih(!0))}}get appName(){return this.LM}get eAh(){return this.onm}get userId(){return this.inm}get uxl(){try{if(""===ed.yJh){const ka={};ka["X-AppName"]=this.appName;ka["X-AppVersion"]=u.AFrameworkApplication.buildVersion;ka.OS=this.Ba.La("PlatformNameAndVersion")||
"";const ib=JSON.stringify(ka);ed.yJh=window.self.btoa(ib)}}catch(ka){n.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",ka.message)}return ed.yJh}get ERm(){const ka=this.eAh?this.eAh+"/":"",ib=new Jb.QueryStringBuilder("SafeLinksHandler.ashx");ib.Zi("app",this.appName);this.Ba.getBooleanAppSetting("SafeLinksUseDebugHeader")&&ib.Zi("action","debug");this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&ib.Zi("s2satpop","1");this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&ib.Zi("s2se03","1");return String.format("{0}{1}&{2}",ka,ib.toString(),u.AFrameworkApplication.ui)}get OUm(){const ka=this.eAh?this.eAh+"/":"",ib=new Jb.QueryStringBuilder("SafeLinksHandler.ashx");ib.Zi("app",this.appName);this.Ba.getBooleanAppSetting("SafeLinksUseDebugHeader")&&ib.Zi("action","debug");this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&ib.Zi("s2satpop","1");this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",
!1)&&ib.Zi("s2saat","1");this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&ib.Zi("s2se03","1");this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&ib.Zi("sladpar",this.uxl);ib.Zi("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",ka,ib.toString(),u.AFrameworkApplication.ui)}get Amn(){ed.lSh||(ed.lSh=new pc(this.Ba,this.$m,this.OUm,ed.Un));return ed.lSh}U0g(ka){if(!ka)return n.ULS.sendTraceTag(593367827,378,10,
"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var ib=this.P4m(ka);n.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",ib,this.S8g,this.R8g,this.bxe);if(!(ib&&this.S8g&&this.R8g&&this.bxe))return!1;ib=0;const Rb=({state:ib}=this.YOn()).returnValue;n.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",dd[ib]);const tc=Za.a.xx();
tc&&tc.set("SafeLinksNavigationState",dd[ib]);Bb.Health.instance.recordKpiUsage("SafeLinksNavigations",uc.b.FailureBased,"jpittsdirects",tc);if(!Rb)return 2!==ib&&3!==ib||Bb.Health.instance.recordKpiFailure("SafeLinksNavigations",dd[ib],!1,!0,null),!1;n.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");if(this.fPn())return this.Anj()?!1:this.Amn.U0g(this.FLm(),ka,this.Xvl());if(!this.Anj())return this.x8l(ka),!0;this.A3c=ka;n.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");
this.bSf=!1;this.aih();return!0}P4m(ka){ka=ka.toLowerCase();const ib=this.Ba.tF("SafeLinksUnsupportedProtocols");if(ib)for(let Rb=0;Rb<ib.length;Rb++)if(ka.startsWith(ib[Rb]))return!1;return!0}aih(ka=!1){var ib=Za.a.xx();ib&&ib.set("isOnBootRequest",ka.toString());Bb.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",uc.b.SuccessBased,"jpittsdirects",ib);Bb.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",uc.b.FailureBased,"jpittsdirects",ib);ib=this.hmf("SafeLinksGetPolicy");
this.$m.rk(this.ERm,1,null,null,!0,2,this.ySm,this.xSm,ib,void 0,void 0,void 0,void 0,"23");this.bSf=ka;this.A8g=!0;ka?this.Bkd++:this.Ckd++}jyl(ka,ib=""){try{if(n.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",ka,ib),this.Bkd<this.r9g&&this.Ckd<this.s9g)this.aih(this.bSf);else{this.bSf=!1;n.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.Bkd,
this.Ckd,ka,ib);ib=null;const Rb=Za.a.xx();Rb&&(Rb.set("HttpStatus",ka.toString()),ib=Object.assign({},{extendedProperties:Rb}));Bb.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,ib);const tc=new $b("false","","",0,!0,"");this.e2l(tc);this.A3c&&(n.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),Bb.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),gb.a.aCe(this.A3c),this.A3c=null)}}catch(Rb){n.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",Rb.toString())}}x8l(ka){const ib=this.Xvl(),Rb=this.fVm(),tc={};tc.Url=ka;tc.SafeLinksCookie=ib;tc.CorrelationId=Mc.a.create().toString();tc.WorkloadId=this.l0n;tc.UserAgentInfo=Gb.a.Iy+"|"+this.appName;this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(tc.User=ed.Zcl,tc.TenantId=ed.ycl,tc.AdditionalProperties=this.uxl);n.ULS.sendTraceTag(23900187,
378,50,"Validating hyperlink with request correlation: {0}",tc.CorrelationId);gb.a.FDg(gb.a.syb(4),Rb,tc)}Z5m(){const ka=this.Ba.La("IsSafeLinksEnabledForUser");return ka?ed.r5j(ka):!1}Y5m(){const ka=this.Ba.tF("SafeLinksDisabledBrowsers");if(Gb.a.o3){if(this.Ba.Tz("SafeLinksForTeamsIsEnabled")&&this.Ba.getBooleanAppSetting("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(ka,"Electron"))return!1}else if(Array.contains(ka,Gb.a.Iy))return!1;return"officecomhwa"===(this.Ba.La(u.AFrameworkApplication.QI)||
"").toLowerCase()?!1:!0}fPn(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&Gb.a.u9c?!0:Gb.a.o3||Gb.a.wrj}YOn(){let ka;ka=0;const ib=this.Q7c(),Rb=ib?ib.IsSafeLinksEnabled:"";if(""!==Rb)return ib.WasServiceDown?(n.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===Rb.toLowerCase()?(n.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),
{returnValue:!1,state:1}):{returnValue:ed.r5j(Rb),state:ka};if(this.A8g)return ka=3,n.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:ka};if(this.Bkd>=this.r9g||this.Ckd>=this.s9g)return ka=2,n.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.Bkd,this.r9g,this.Ckd,this.s9g),{returnValue:!1,state:ka};n.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.r9g+this.s9g-(this.Bkd+this.Ckd));return{returnValue:!0,state:ka}}Xvl(){const ka=this.Q7c();return ka?ka.PolicyCookie:""}fVm(){const ka=this.Q7c();return ka?ka.WebAffinitizedUrl:""}FLm(){const ka=this.Q7c();return ka?ka.AffinitizedUrl:""}NOm(){const ka=new Date;try{const ib=this.Q7c();ka.setTime(ib?ib.PolicyCookieTTL:0)}catch(ib){n.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",ib)}return ka}Anj(){const ka=this.NOm();return!!ka&&ka.getTime()<
Date.now()}Q7c(){if(!this.w$g){const ka=Ad.a.instance.getItem(this.userId);if(!ka||""===ka)return null;this.w$g=JSON.parse(ka)}return this.w$g}e2l(ka){if(void 0===ka||null===ka)throw Error.argumentNull("safeLinksData");if(void 0===ka.IsSafeLinksEnabled||null===ka.IsSafeLinksEnabled||0>=ka.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.w$g=ka;ka.WasServiceDown||this.p0n(ka)}p0n(ka){ka=JSON.stringify(ka);Ad.a.instance.setItem(this.userId,ka)}hmf(ka){return void 0!==
ed.Un&&null!==ed.Un?ed.Un.wl("WebServiceCall",ka):null}INe(ka){if(void 0!==ka&&null!==ka){const ib=ka.nv;ka.stop();return{returnValue:ib,kD:null}}return{returnValue:null,kD:ka}}static r5j(ka){return"false"!==ka.toLowerCase()?!0:!1}}ed.Un=null;ed.lSh=null;ed.ycl="";ed.Zcl="";ed.yJh="";Object(m.a)(ed,"SafeLinksManager",null,[1213]);const Yc=ka=>{switch(ka){case 3:return"Word";case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},ab=ka=>{switch(ka){case 1:return"Edit";case 2:return"View";
case 3:return"InstantView";default:return"Unknown"}};var jb=a(492);class cc{constructor(){this.$=null}get name(){return"PowerPointSafeLinks"}lc(ka){this.$=ka}init(){u.AFrameworkApplication.ga.fg(Object(K.a)(this,this.su,"onFullAppSettingsReady"))}su(){const ka=this.$.resolve("PowerPointWebEditor.IApplicationSettings"),ib=ka?ka.Rh:!1;ka.vKe&&(this.$.register(ed,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ma().na(()=>new ed(u.AFrameworkApplication.ga,u.AFrameworkApplication.ye,
String.format("{0}-{1}",Yc(u.AFrameworkApplication.Ea.Kb.Im),ab(u.AFrameworkApplication.Ea.Kb.O4a)),ib)).ma(),this.$.yb("Common.App.SafeLinks.ISafeLinksManager"))}dispose(){}static main(){L.a.instance.Fc(jb.a(new cc,0))}}Object(m.a)(cc,"SafeLinksPackage",null,[3,4]);var Hc=a(73),Vc=a(27),Tc=a(1594),cd=a(181),Lb=a(295),Rc=a(249),md=a(21),Zc=a(28),ld=a(13),fe=a(231),Ac=a(1234);class R{constructor(ka,ib,Rb,tc,xc,hd){this.XS=ka;this._id=ib;this.JHh=tc;this.dhm=xc;this.ehm=hd;this.ejd=this.currentValue;
void 0!==Rb&&null!==Rb&&(this.currentValue=Rb)}get defaultValue(){return this.ejd}get lcid(){return this.XS}get id(){return this._id}get currentValue(){return(this.dhm||R.j6k)(this.JHh)}set currentValue(ka){(this.ehm||R.k6k)(this.JHh,ka)}get ig(){return this.JHh}static Pr(){R.j6k=()=>null;R.k6k=()=>{}}}R.j6k=null;R.k6k=null;Object(m.a)(R,"GrammarSettingOption",null,[1340]);R.Pr();class za{constructor(ka,ib,Rb){this.REi=ka;this.mwk=ib;this.Mmn=Rb}}Object(m.a)(za,"TwoLevelCacheKey",null,[]);var X=a(254),
lb=a(403),oc=a(46);class Oc extends Ta.a{constructor(ka,ib,Rb,tc){super();this.IRh=this.wva=this.V6k=this.AVe=null;this.ew=tc;this.SGh=ka;this.uk=Oc.id;this.kkm=()=>{this.AVe=Rb?md.a.$Xc(Rb):{};this.V6k=Rb?md.a.$Xc(Rb):{};const xc=this.kum(),hd=Oc.DAm(xc,Oc.zMe(Object(K.a)(this,this.CAm,"createCritiqueTypeSettingsTracker"))(Oc.Jym(Td=>this.AVe=Td)));hd(Rb||{});var Fd=Oc.zMe(Oc.FCm())(Td=>Td.cloneNode(!0));Oc.EAm(xc,Oc.qAm(Oc.PBm(ib),Oc.BAm(Fd))(Rb))(ka.toString());this.IRh=this.dvm();Fd=Td=>{if("click"===
Td.type||Td.keyCode===Zc.a.hv||Td.keyCode===Zc.a.Wue)this.AVe[ka.toString()]={},xc.reset(),Oc.zHn(hd)};ld.a.addHandler(this.Mdd,Pa.a.click,Fd);ld.a.addHandler(this.Mdd,Pa.a.Lj,Fd)};this.Bl=""}get Mdd(){return this.IRh}j7m(){var ka=Oc.Qmk(this.AVe),ib=Oc.Qmk(this.V6k);if(!ka&&!ib)return!1;let Rb;try{Rb=ka?Object(fe.a)(Object,ka[this.SGh.toString()]):{};var tc=ib?Object(fe.a)(Object,ib[this.SGh.toString()]):{}}catch(Fd){return n.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!Rb&&
!tc)return!1;Rb=Rb?Rb:{};tc=tc?tc:{};ka=String.format("language: {0}",this.SGh.toString());ib=!1;for(const Fd in Rb){var xc=Fd,hd=Rb[Fd];xc in tc&&tc[xc]===hd||(ib=!0,ka=String.format("{0}, [{1}, {2}]",ka,xc,hd))}for(const Fd in tc)tc=Fd,tc in Rb||(ib=!0,ka=String.format("{0}, [{1}, default]",ka,tc));ib&&n.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",ka);return ib}Dq(ka,ib,Rb){super.Dq(ka,ib,Rb);this.jDn()}Vma(ka){return ka.Dc.id===Oc.p_l?!1:super.Vma(ka)}GJn(){this.ew.Hw().nIe();
this.wva=this.ew.Hw().nt.Lma}jDn(){this.ew.Hw().scope.cG(Yb.FocusManager.instance().$3c);this.ew.Hw().scope.cG(Yb.FocusManager.instance().a4c);this.ew.Hw().scope.bindAction(Yb.FocusManager.instance().$3c,X.a.jDe);this.ew.Hw().scope.bindAction(Yb.FocusManager.instance().a4c,X.a.iDe);this.ew.Hw().scope.bindAction(ja.a.eb(Zc.a.Yba,0),X.a.lJf);this.ew.Hw().scope.bindAction(ja.a.eb(Zc.a.oja,0),X.a.kJf);this.ew.Hw().scope.bindAction(ja.a.eb(Zc.a.x_,0),X.a.lJf);this.ew.Hw().scope.bindAction(ja.a.eb(Zc.a.U3,
0),X.a.kJf)}get settings(){return Oc.Qmk(this.AVe)}Zab(){super.Zab();this.kkm()}kum(){const ka=Oc.zum(),ib=Oc.Vef("WACDialogRow",ka);this.lva.insertBefore(ib,this.lva.firstChild);return ka}CAm(ka){const ib=Ac.a.merge(null,ka);return Rb=>{Rb.currentValue===(ka&&ka[Rb.lcid]?ka[Rb.lcid][Rb.id]:null)||Rb.currentValue!==Rb.defaultValue?Oc.Ovl(ib,Rb.lcid)[Rb.id]=Rb.currentValue:delete Oc.Ovl(ib,Rb.lcid)[Rb.id];this.wva=this.hPm(Rb.ig);return ib}}hPm(ka){return ka?(ka=ka.getElementsByTagName(Sys.UI.DomElement.containsCssClass(ka,
Oc.b8m)?"select":"input"))?ka[0]:null:null}dispose(){this.Mdd&&(ld.a.Bmk(this.Mdd),this.IRh=null);super.dispose()}dvm(){const ka=document.createElement("input");ka.id=Oc.p_l;ka.type="reset";ka.setAttribute("form",Oc.Bsl);ka.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";ka.value=CommonUIStrings.l_ResetAll;const ib=Oc.Vef("GrammarSettingsDialogResetButtonContainer",ka),Rb=document.getElementById("WACDialogButtonPanel");Rb.parentNode.insertBefore(ib,Rb);return ka}static get bof(){return"CritiqueType"}static Jym(ka){return ib=>
Rb=>ka(ib(Rb))}static zMe(ka){return ib=>Rb=>ib(ka(Rb))}static Qmk(ka){const ib={};md.a.forEach(ka,(Rb,tc)=>{0<lb.a(tc).length&&(ib[Rb]=tc)},null);return ib}static zum(){const ka=document.createElement("form");ka.id=Oc.Bsl;Sys.UI.DomElement.addCssClass(ka,"WACDialogList");Sys.UI.DomElement.addCssClass(ka,Oc.OCm);return ka}static DAm(ka,ib){const Rb=Oc.JCn(ka,Pa.a.change);return tc=>{const xc=ib(tc);Rb(hd=>{hd=hd.target.parentNode;Sys.UI.DomElement.containsCssClass(hd,Oc.bof)&&xc(hd[Oc.ihl])})}}static JCn(ka,
ib){let Rb=null;return tc=>{Rb&&ld.a.removeHandler(ka,ib,Rb);ld.a.addHandler(ka,ib,tc);Rb=tc}}static Ovl(ka,ib){return ka[ib]=ka[ib]||{}}static zHn(ka){n.ULS.sendTraceTag(36489289,375,50,"User click reset all button");ka(null)}static PBm(ka){let ib=null;return Rb=>{ib=Rb;return ka.request(Number.parseInvariant(Rb)).CWRCo(tc=>ib===Rb?tc.result:null,Oc.jsi)}}static EAm(ka,ib){const Rb=Oc.kMm(tc=>Oc.uUn(tc.children));return tc=>{const xc=Rb(tc,ka);ka.innerHTML="";(xc?oc.Task.rF(xc):ib(tc)).continueWith(hd=>
{hd=hd.result;for(let Fd=0;Fd<hd.length;Fd++)ka.appendChild(hd[Fd])},Oc.jsi)}}static qAm(ka,ib){return Rb=>tc=>ka(tc).CWRCo(xc=>w.toArray(w.select(w.asEnumerable(xc.result),hd=>ib(Rb,hd,tc))),Oc.jsi)}static uUn(ka){const ib=[];for(let Rb=0;Rb<ka.length;Rb++)ib.push(ka[Rb]);return ib}static kMm(ka){const ib={};let Rb=null;return(tc,xc)=>{Rb&&!ib[Rb]&&(xc=ka(xc))&&(ib[Rb]=xc);Rb=tc;return ib[tc]}}static FCm(){const ka={};return ib=>{ka[ib.REi]=ka[ib.REi]||{};const Rb=ka[ib.REi];Rb[ib.mwk]=Rb[ib.mwk]||
ib.Mmn();return Rb[ib.mwk]}}static BAm(ka){return(ib,Rb,tc)=>{const xc=ka(new za(tc,Rb.Id,()=>Oc.sum(Rb)));xc.setAttribute("role","group");const hd=Oc.njl+Rb.Name;xc.setAttribute("aria-labelledby",hd);for(const Fd of Rb.CritiqueTypeInfoList){const Td=Oc.MKm(tc,Fd,ib,ka);xc.appendChild(Td);Td.setAttribute("aria-labelledby",hd)}return xc}}static MKm(ka,ib,Rb,tc){tc=tc(new za(ka,ib.Id,()=>ib.IsBinaryCritiqueType?Oc.qum(ib):Oc.Xum(ib)));ka=new R(ka,ib.Id,Rb&&Rb[ka]?Rb[ka][ib.Id]:null,tc,ib.IsBinaryCritiqueType?
xc=>xc.children[0].checked:xc=>xc.children[1].selectedIndex,ib.IsBinaryCritiqueType?(xc,hd)=>{xc.children[0].checked=hd}:(xc,hd)=>{xc.children[1].selectedIndex=hd});tc[Oc.ihl]=ka;return tc}static sum(ka){ka=Oc.tum(ka.Name);ka.className="WACWritingStylesDialogCategoryTitle";return Oc.Vef("CritiqueCategory",ka)}static qum(ka){const ib=Oc.uum();ib.id=ka.Id;0<ka.DefaultCritiqueValue&&ib.setAttribute("checked","checked");ka=Oc.Zhl(ka.Name,ka.Id);ka.className="WACDialogLabel";const Rb=Oc.Vef(Oc.bof,ib,
ka);Rb.appendChild(ib);Rb.appendChild(ka);return Rb}static Xum(ka){ka=Oc.Lum(ka.Id,ka.Name,Oc.$um(ka.CritiqueTypeValues,ka.DefaultCritiqueValue),ka.DefaultCritiqueValue);Sys.UI.DomElement.addCssClass(ka,Oc.bof);return ka}static $um(ka,ib){return w.toArray(w.Si(w.asEnumerable(ka||[]),(Rb,tc)=>{Rb=Oc.Zum(Rb,tc.toString());tc===ib&&Rb.setAttribute("selected","selected");return Rb}))}static Lum(ka,ib,Rb,tc){ib=Oc.Zhl(ib,ka);const xc=document.createElement("select");xc.id=ka;xc.className="WACDialogList";
Rb=Rb||[];for(ka=0;ka<Rb.length;ka++)xc.appendChild(Rb[ka]),tc===ka&&(Rb[ka].selected=!0);return Oc.Vef("GrammarSettingsDialogLabeledInlineList",ib,xc)}static Zum(ka,ib){const Rb=document.createElement("option");Rb.text=ka;Rb.value=ib;return Rb}static uum(){const ka=document.createElement("input");ka.type="checkbox";ka.className="WACDialogCheckBox";return ka}static Zhl(ka,ib){const Rb=document.createElement("label");Rb.innerText=ka;Rb.setAttribute("for",ib);return Rb}static tum(ka){const ib=document.createElement("div");
ib.innerText=ka;ib.id=Oc.njl+ka;return ib}static Vef(ka=null,...ib){const Rb=document.createElement("div");Rb.className=ka;for(const tc of ib)Rb.appendChild(tc);return Rb}}Oc.id="GrammarSettingsDialog";Oc.Bsl="CritiqueTypeSettings";Oc.OCm="CritiquesList";Oc.b8m="GrammarSettingsDialogLabeledInlineList";Oc.p_l="ResetButton";Oc.njl="WritingStylesCategory_";Oc.jsi=11;Oc.ihl="CritiqueType";Object(m.a)(Oc,"GrammarSettingsDialog",Ta.a,[]);var sd=a(55),Ld=a(481),Qd=a(1097),Id=a(257),he=a(459),xb=a(279),Sb=
a(341),Cc=a(267),qb=a(1181),Ob=a(248),Pb=a(251);class qc{constructor(){this.Color=null;this.Transparency=this.Scale=this.EffectDataPropType=this.Degree=0}}Object(m.a)(qc,"EffectDataInfo",null,[]);var Uc=a(1183);class pd{constructor(){this.EffectType=this.EffectId=0;this.FRemoveExisting=!1;this.ShapeIds=null}}Object(m.a)(pd,"AddAnimationInfo",null,[]);class Od{constructor(){this.TargetEffects=null}}Object(m.a)(Od,"DeleteAnimationInfo",null,[]);class be{constructor(){this.EffectNodeId=0;this.ShapeId=
null}}Object(m.a)(be,"TargetEffect",null,[]);class te{constructor(){this.EffectType=this.EffectId=0;this.IsReplaceShapeAnimations=!1;this.TargetEffects=null}}Object(m.a)(te,"ReplaceAnimationInfo",null,[]);class Le{constructor(){this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.ModifyAnimPropType=0;this.TargetEffects=null}}Object(m.a)(Le,"ModifyAnimationInfo",null,[]);class kf{constructor(){this.StartType=0;this.TargetEffects=null}}Object(m.a)(kf,"ChangeAnimationRelationshipInfo",
null,[]);var fg=a(495),pe=a(333),me=a(291);class Ke{constructor(){this.BuildType=0;this.TargetEffects=null}}Object(m.a)(Ke,"ChangeAnimationBuildTypeInfo",null,[]);class Ie{constructor(){this.IsLater=!1;this.TargetEffects=this.RefEffect=null}}Object(m.a)(Ie,"ReorderAnimationEffectsInfo",null,[]);var Ef=a(250),We=a(256),Ae=a(260),se=a(18),pf=a(1233),eg=a(435),pg=a(681);class ne{constructor(){this.effectId=this.effectType=0;this.labelText=this.Ik=this.effectData=this.pF=null}}Object(m.a)(ne,"AnimInfo",
null,[]);class sf{constructor(){this.Jw=this.labelText=this.Ik=this.id=null}}Object(m.a)(sf,"EffectOption",null,[]);class Ye extends sf{constructor(){super();this.value=null}}Object(m.a)(Ye,"EffectData",sf,[]);class Yd{constructor(ka){this.cVb=ka;Yd.kB||(Yd.kB=new pf.a,Yd.kB.add("FromBottom",Object.assign(new sf,{id:"FromBottom",Ik:Yd.Cl("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottom,Jw:CommonUIStrings.l_AnimationFromBottomKeytip})),Yd.kB.add("FromBottomLeft",
Object.assign(new sf,{id:"FromBottomLeft",Ik:Yd.Cl("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomLeft,Jw:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),Yd.kB.add("FromLeft",Object.assign(new sf,{id:"FromLeft",Ik:Yd.Cl("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromLeft,Jw:CommonUIStrings.l_AnimationFromLeftKeytip})),Yd.kB.add("FromTopLeft",Object.assign(new sf,{id:"FromTopLeft",Ik:Yd.Cl("AnimEffectPropFromTopLeft"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromTopLeft,Jw:CommonUIStrings.l_AnimationFromTopLeftKeytip})),Yd.kB.add("FromTop",Object.assign(new sf,{id:"FromTop",Ik:Yd.Cl("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTop,Jw:CommonUIStrings.l_AnimationFromTopKeytip})),Yd.kB.add("FromTopRight",Object.assign(new sf,{id:"FromTopRight",Ik:Yd.Cl("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopRight,Jw:CommonUIStrings.l_AnimationFromTopRightKeytip})),
Yd.kB.add("FromRight",Object.assign(new sf,{id:"FromRight",Ik:Yd.Cl("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromRight,Jw:CommonUIStrings.l_AnimationFromRightKeytip})),Yd.kB.add("FromBottomRight",Object.assign(new sf,{id:"FromBottomRight",Ik:Yd.Cl("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomRight,Jw:CommonUIStrings.l_AnimationFromBottomRightKeytip})),Yd.kB.add("ToBottom",Object.assign(new sf,{id:"ToBottom",Ik:Yd.Cl("AnimEffectPropFromTop"),
labelText:ResourceStrings.L_EffectOptionsDirectionToBottom,Jw:CommonUIStrings.l_AnimationFromBottomKeytip})),Yd.kB.add("ToBottomLeft",Object.assign(new sf,{id:"ToBottomLeft",Ik:Yd.Cl("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomLeft,Jw:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),Yd.kB.add("ToLeft",Object.assign(new sf,{id:"ToLeft",Ik:Yd.Cl("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToLeft,Jw:CommonUIStrings.l_AnimationFromLeftKeytip})),
Yd.kB.add("ToTopLeft",Object.assign(new sf,{id:"ToTopLeft",Ik:Yd.Cl("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopLeft,Jw:CommonUIStrings.l_AnimationFromTopLeftKeytip})),Yd.kB.add("ToTop",Object.assign(new sf,{id:"ToTop",Ik:Yd.Cl("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionToTop,Jw:CommonUIStrings.l_AnimationFromTopKeytip})),Yd.kB.add("ToTopRight",Object.assign(new sf,{id:"ToTopRight",Ik:Yd.Cl("AnimEffectPropFromBottomLeft"),
labelText:ResourceStrings.L_EffectOptionsDirectionToTopRight,Jw:CommonUIStrings.l_AnimationFromTopRightKeytip})),Yd.kB.add("ToRight",Object.assign(new sf,{id:"ToRight",Ik:Yd.Cl("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToRight,Jw:CommonUIStrings.l_AnimationFromRightKeytip})),Yd.kB.add("ToBottomRight",Object.assign(new sf,{id:"ToBottomRight",Ik:Yd.Cl("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomRight,Jw:CommonUIStrings.l_AnimationFromBottomRightKeytip})),
Yd.kB.add("Horizontal",Object.assign(new sf,{id:"Horizontal",Ik:Yd.Cl("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Jw:CommonUIStrings.l_AnimationHorizontalKeytip})),Yd.kB.add("HorizontalIn",Object.assign(new sf,{id:"HorizontalIn",Ik:Yd.Cl("AnimEffectPropHorizontalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalIn,Jw:CommonUIStrings.l_AnimationHorizontalInKeytip})),Yd.kB.add("HorizontalOut",Object.assign(new sf,{id:"HorizontalOut",Ik:Yd.Cl("AnimEffectPropHorizontalOut"),
labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalOut,Jw:CommonUIStrings.l_AnimationHorizontalOutKeytip})),Yd.kB.add("Vertical",Object.assign(new sf,{id:"Vertical",Ik:Yd.Cl("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Jw:CommonUIStrings.l_AnimationVerticalKeytip})),Yd.kB.add("VerticalIn",Object.assign(new sf,{id:"VerticalIn",Ik:Yd.Cl("AnimEffectPropVerticalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalIn,Jw:CommonUIStrings.l_AnimationVerticalInKeytip})),
Yd.kB.add("VerticalOut",Object.assign(new sf,{id:"VerticalOut",Ik:Yd.Cl("AnimEffectPropVerticalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalOut,Jw:CommonUIStrings.l_AnimationVerticalOutKeytip})),Yd.kB.add("LeftDown",Object.assign(new sf,{id:"LeftDown",Ik:Yd.Cl("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftDown,Jw:CommonUIStrings.l_AnimationLeftDownKeytip})),Yd.kB.add("LeftUp",Object.assign(new sf,{id:"LeftUp",Ik:Yd.Cl("AnimEffectPropFromBottomRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionLeftUp,Jw:CommonUIStrings.l_AnimationLeftUpKeytip})),Yd.kB.add("RightDown",Object.assign(new sf,{id:"RightDown",Ik:Yd.Cl("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightDown,Jw:CommonUIStrings.l_AnimationRightDownKeytip})),Yd.kB.add("RightUp",Object.assign(new sf,{id:"RightUp",Ik:Yd.Cl("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightUp,Jw:CommonUIStrings.l_AnimationRightUpKeytip})),
Yd.kB.add("In",Object.assign(new sf,{id:"In",Ik:Yd.Cl("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionIn,Jw:CommonUIStrings.l_AnimationInKeytip})),Yd.kB.add("InBottom",Object.assign(new sf,{id:"InBottom",Ik:Yd.Cl("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInToScreenBottom,Jw:CommonUIStrings.l_AnimationInToScreenBottomKeytip})),Yd.kB.add("InCenter",Object.assign(new sf,{id:"InCenter",Ik:Yd.Cl("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInCenter,
Jw:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),Yd.kB.add("InSlightly",Object.assign(new sf,{id:"InSlightly",Ik:Yd.Cl("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInSlightly,Jw:CommonUIStrings.l_AnimationInSlightlyKeytip})),Yd.kB.add("Out",Object.assign(new sf,{id:"Out",Ik:Yd.Cl("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOut,Jw:CommonUIStrings.l_AnimationOutKeytip})),Yd.kB.add("OutBottom",Object.assign(new sf,{id:"OutBottom",Ik:Yd.Cl("AnimEffectPropOut"),
labelText:ResourceStrings.L_EffectOptionsDirectionOutBottom,Jw:CommonUIStrings.l_AnimationOutFromScreenBottomKeytip})),Yd.kB.add("OutCenter",Object.assign(new sf,{id:"OutCenter",Ik:Yd.Cl("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutToScreenCenter,Jw:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),Yd.kB.add("OutSlightly",Object.assign(new sf,{id:"OutSlightly",Ik:Yd.Cl("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutSlightly,Jw:CommonUIStrings.l_AnimationOutSlightlyKeytip})),
Yd.kB.add("FloatUp",Object.assign(new sf,{id:"FloatUp",Ik:Yd.Cl("AnimEffectPropFloatUp"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatUp,Jw:CommonUIStrings.l_AnimationOutKeytip})),Yd.kB.add("FloatDown",Object.assign(new sf,{id:"FloatDown",Ik:Yd.Cl("AnimEffectPropFloatDown"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatDown,Jw:CommonUIStrings.l_AnimationDownKeytip})),Yd.kB.add("ObjectCenter",Object.assign(new sf,{id:"ObjectCenter",Ik:Yd.Cl("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,
Jw:CommonUIStrings.l_AnimationObjectCenterKeytip})),Yd.kB.add("SlideCenter",Object.assign(new sf,{id:"SlideCenter",Ik:Yd.Cl("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Jw:CommonUIStrings.l_AnimationSlideCenterKeytip})),Yd.kB.add("ObjectCenterOut",Object.assign(new sf,{id:"ObjectCenterOut",Ik:Yd.Cl("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Jw:CommonUIStrings.l_AnimationObjectCenterKeytip})),Yd.kB.add("SlideCenterOut",
Object.assign(new sf,{id:"SlideCenterOut",Ik:Yd.Cl("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Jw:CommonUIStrings.l_AnimationSlideCenterKeytip})),Yd.kB.add("Clockwise",Object.assign(new sf,{id:"Clockwise",Ik:Yd.Cl("AnimEffectPropClockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionClockwise,Jw:CommonUIStrings.l_AnimationClockWiseKeytip})),Yd.kB.add("CounterClockwise",Object.assign(new sf,{id:"CounterClockwise",Ik:Yd.Cl("AnimEffectPropCounterclockwise"),
labelText:ResourceStrings.L_EffectOptionsDirectionCounterClockwise,Jw:CommonUIStrings.l_AnimationCounterClockWiseKeytip})),Yd.kB.add("Across",Object.assign(new sf,{id:"Across",Ik:Yd.Cl("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionAcross,Jw:CommonUIStrings.l_AnimationAcrossKeytip})),Yd.kB.add("Up",Object.assign(new sf,{id:"Up",Ik:Yd.Cl("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionUp,Jw:CommonUIStrings.l_AnimationUpKeytip})),Yd.kB.add("Down",
Object.assign(new sf,{id:"Down",Ik:Yd.Cl("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionDown,Jw:CommonUIStrings.l_AnimationDownKeytip})),Yd.kB.add("GrowShrinkHorizontal",Object.assign(new sf,{id:"GrowShrinkHorizontal",Ik:Yd.Cl("AnimEffectPropGrowShrinkHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Jw:CommonUIStrings.l_AnimationHorizontalKeytip})),Yd.kB.add("GrowShrinkVertical",Object.assign(new sf,{id:"GrowShrinkVertical",Ik:Yd.Cl("AnimEffectPropGrowShrinkVertical"),
labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Jw:CommonUIStrings.l_AnimationVerticalKeytip})),Yd.kB.add("GrowShrinkBoth",Object.assign(new sf,{id:"GrowShrinkBoth",Ik:Yd.Cl("AnimEffectPropBoth"),labelText:ResourceStrings.L_EffectOptionsDirectionBoth,Jw:CommonUIStrings.l_AnimationBothKeytip})));Yd.oJa||(Yd.oJa=new pf.a,Yd.oJa.add("Spin_Quarter",Object.assign(new Ye,{id:"Spin_Quarter",Ik:Yd.Cl("AnimEffectPropQuarterSpin"),labelText:ResourceStrings.L_EffectOptionsSpinQuarter,value:"90",Jw:CommonUIStrings.l_AnimationQuarterSpinKeytip})),
Yd.oJa.add("Spin_Half",Object.assign(new Ye,{id:"Spin_Half",Ik:Yd.Cl("AnimEffectPropHalfSpin"),labelText:ResourceStrings.L_EffectOptionsSpinHalf,value:"180",Jw:CommonUIStrings.l_AnimationHalfSpinKeytip})),Yd.oJa.add("Spin_Full",Object.assign(new Ye,{id:"Spin_Full",Ik:Yd.Cl("AnimEffectPropFullSpin"),labelText:ResourceStrings.L_EffectOptionsSpinFull,value:"360",Jw:CommonUIStrings.l_AnimationFullSpinKeytip})),Yd.oJa.add("Spin_Two",Object.assign(new Ye,{id:"Spin_Two",Ik:Yd.Cl("AnimEffectPropTwoSpins"),
labelText:ResourceStrings.L_EffectOptionsSpinTwo,value:"720",Jw:CommonUIStrings.l_AnimationTwoSpinKeytip})),Yd.oJa.add("Transparency_25",Object.assign(new Ye,{id:"Transparency_25",Ik:Yd.Cl("AnimEffectPropTransparent25"),labelText:ResourceStrings.L_EffectOptionsTransparency25Percent,value:"0.75",Jw:CommonUIStrings.l_Animation25PerKeytip})),Yd.oJa.add("Transparency_50",Object.assign(new Ye,{id:"Transparency_50",Ik:Yd.Cl("AnimEffectPropTransparent50"),labelText:ResourceStrings.L_EffectOptionsTransparency50Percent,
value:"0.5",Jw:CommonUIStrings.l_Animation50PerKeytip})),Yd.oJa.add("Transparency_75",Object.assign(new Ye,{id:"Transparency_75",Ik:Yd.Cl("AnimEffectPropTransparent75"),labelText:ResourceStrings.L_EffectOptionsTransparency75Percent,value:"0.25",Jw:CommonUIStrings.l_Animation75PerKeytip})),Yd.oJa.add("Transparency_100",Object.assign(new Ye,{id:"Transparency_100",Ik:Yd.Cl("AnimEffectPropTransparent100"),labelText:ResourceStrings.L_EffectOptionsTransparency100Percent,value:"0.0",Jw:CommonUIStrings.l_Animation100PerKeytip})),
Yd.oJa.add("GrowShrink_Tiny",Object.assign(new Ye,{id:"GrowShrink_Tiny",Ik:Yd.Cl("AnimEffectPropTiny"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkTiny,value:"25",Jw:CommonUIStrings.l_AnimationTinyKeytip})),Yd.oJa.add("GrowShrink_Smaller",Object.assign(new Ye,{id:"GrowShrink_Smaller",Ik:Yd.Cl("AnimEffectPropSmaller"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkSmaller,value:"50",Jw:CommonUIStrings.l_AnimationSmallerKeytip})),Yd.oJa.add("GrowShrink_Larger",Object.assign(new Ye,{id:"GrowShrink_Larger",
Ik:Yd.Cl("AnimEffectPropLarger"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkLarger,value:"150",Jw:CommonUIStrings.l_AnimationLargerKeytip})),Yd.oJa.add("GrowShrink_Huge",Object.assign(new Ye,{id:"GrowShrink_Huge",Ik:Yd.Cl("AnimEffectPropHuge"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkHuge,value:"400",Jw:CommonUIStrings.l_AnimationHugeKeytip})));if(!Yd.nC)if(Yd.nC=new pf.a,Yd.nC.add("Existing",Object.assign(new ne,{effectType:-1,effectId:-1,Ik:Yd.Cl("AnimFxMultiple"),labelText:ResourceStrings.L_AnimationExisting,
pF:[],effectData:[]})),Yd.nC.add("None",Object.assign(new ne,{effectType:0,effectId:0,Ik:Yd.Cl("AnimFxNone"),labelText:ResourceStrings.L_AnimationNone,pF:[],effectData:[]})),Yd.nC.add("Appear",Object.assign(new ne,{effectType:0,effectId:1,Ik:Yd.Cl("AnimFxEntranceAppear"),labelText:ResourceStrings.L_AnimationAppear,pF:[],effectData:[]})),Yd.nC.add("FadeIn",Object.assign(new ne,{effectType:0,effectId:10,Ik:Yd.Cl("AnimFxEntranceFadeIn"),labelText:ResourceStrings.L_AnimationFade,pF:[],effectData:[]})),
this.cVb){Yd.nC.add("FlyIn",Object.assign(new ne,{effectType:0,effectId:2,Ik:Yd.Cl("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,pF:"FromBottom FromBottomLeft FromLeft FromTopLeft FromTop FromTopRight FromRight FromBottomRight".split(" "),effectData:[]}));Yd.nC.add("Wipe",Object.assign(new ne,{effectType:0,effectId:22,Ik:Yd.Cl("AnimFxEntranceWipeIn"),labelText:ResourceStrings.L_AnimationWipe,pF:["FromBottom","FromLeft","FromRight","FromTop"],effectData:[]}));Yd.nC.add("Zoom",Object.assign(new ne,
{effectType:0,effectId:53,Ik:Yd.Cl("AnimFxEntranceFadedZoom"),labelText:ResourceStrings.L_AnimationZoom,pF:["ObjectCenter","SlideCenter"],effectData:[]}));Yd.nC.add("Checkerboard",Object.assign(new ne,{effectType:0,effectId:5,Ik:Yd.Cl("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationCheckerboard,pF:["Across","Down"],effectData:[]}));Yd.nC.add("BasicZoom",Object.assign(new ne,{effectType:0,effectId:23,Ik:Yd.Cl("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBasicZoom,pF:"In InCenter InSlightly Out OutBottom OutSlightly".split(" "),
effectData:[]}));Yd.nC.add("Blinds",Object.assign(new ne,{effectType:0,effectId:3,Ik:Yd.Cl("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBlinds,pF:["Horizontal","Vertical"],effectData:[]}));let ib;Yd.nC.add("Box",(ib=new ne,ib.effectType=0,ib.effectId=4,ib.Ik=Yd.Cl("AnimFxEntranceShape"),ib.labelText=ResourceStrings.L_AnimationBox,ib.pF=["In","Out"],ib.effectData=[],ib));let Rb;Yd.nC.add("PeekIn",(Rb=new ne,Rb.effectType=0,Rb.effectId=12,Rb.Ik=Yd.Cl("AnimFxEntranceGeneric"),Rb.labelText=
ResourceStrings.L_AnimationPeekIn,Rb.pF=["FromBottom","FromLeft","FromRight","FromTop"],Rb.effectData=[],Rb));let tc;Yd.nC.add("Expand",(tc=new ne,tc.effectType=0,tc.effectId=55,tc.Ik=Yd.Cl("AnimFxEntranceGeneric"),tc.labelText=ResourceStrings.L_AnimationExpand,tc.pF=[],tc.effectData=[],tc));let xc;Yd.nC.add("GrowAndTurn",(xc=new ne,xc.effectType=0,xc.effectId=31,xc.Ik=Yd.Cl("AnimFxEntranceGrowAndTurn"),xc.labelText=ResourceStrings.L_AnimationGrowAndTurn,xc.pF=[],xc.effectData=[],xc));let hd;Yd.nC.add("RandomBars",
(hd=new ne,hd.effectType=0,hd.effectId=14,hd.Ik=Yd.Cl("AnimFxEntranceRandomBars"),hd.labelText=ResourceStrings.L_AnimationRandomBars,hd.pF=["Horizontal","Vertical"],hd.effectData=[],hd));let Fd;Yd.nC.add("RiseUp",(Fd=new ne,Fd.effectType=0,Fd.effectId=37,Fd.Ik=Yd.Cl("AnimFxEntranceGeneric"),Fd.labelText=ResourceStrings.L_AnimationRiseUp,Fd.pF=[],Fd.effectData=[],Fd));let Td;Yd.nC.add("Split",(Td=new ne,Td.effectType=0,Td.effectId=16,Td.Ik=Yd.Cl("AnimFxEntranceSplit"),Td.labelText=ResourceStrings.L_AnimationSplit,
Td.pF=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],Td.effectData=[],Td));let na;Yd.nC.add("Strips",(na=new ne,na.effectType=0,na.effectId=18,na.Ik=Yd.Cl("AnimFxEntranceGeneric"),na.labelText=ResourceStrings.L_AnimationStrips,na.pF=["LeftDown","LeftUp","RightDown","RightUp"],na.effectData=[],na));let $a;Yd.nC.add("Stretch",($a=new ne,$a.effectType=0,$a.effectId=17,$a.Ik=Yd.Cl("AnimFxEntranceGeneric"),$a.labelText=ResourceStrings.L_AnimationStretch,$a.pF=["Across","FromBottom","FromLeft",
"FromRight","FromTop"],$a.effectData=[],$a));let Fb;Yd.nC.add("Exit_Disappear",(Fb=new ne,Fb.effectType=1,Fb.effectId=1,Fb.Ik=Yd.Cl("AnimFxExitDisappear"),Fb.labelText=ResourceStrings.L_AnimationDisappear,Fb.pF=[],Fb.effectData=[],Fb));let Xb;Yd.nC.add("Exit_Fade",(Xb=new ne,Xb.effectType=1,Xb.effectId=10,Xb.Ik=Yd.Cl("AnimFxExitFadeOut"),Xb.labelText=ResourceStrings.L_AnimationFade,Xb.pF=[],Xb.effectData=[],Xb));let nc;Yd.nC.add("Exit_FlyOut",(nc=new ne,nc.effectType=1,nc.effectId=2,nc.Ik=Yd.Cl("AnimFxExitFlyOut"),
nc.labelText=ResourceStrings.L_AnimationFlyOut,nc.pF="ToBottom ToBottomLeft ToLeft ToTopLeft ToTop ToTopRight ToRight ToBottomRight".split(" "),nc.effectData=[],nc));let Nc;Yd.nC.add("Exit_Wipe",(Nc=new ne,Nc.effectType=1,Nc.effectId=22,Nc.Ik=Yd.Cl("AnimFxExitWipe"),Nc.labelText=ResourceStrings.L_AnimationWipe,Nc.pF=["FromBottom","FromLeft","FromRight","FromTop"],Nc.effectData=[],Nc));let yd;Yd.nC.add("Exit_Zoom",(yd=new ne,yd.effectType=1,yd.effectId=53,yd.Ik=Yd.Cl("AnimFxExitFadedZoom"),yd.labelText=
ResourceStrings.L_AnimationZoom,yd.pF=["ObjectCenterOut","SlideCenterOut"],yd.effectData=[],yd));let Ud;Yd.nC.add("Exit_Checkerboard",(Ud=new ne,Ud.effectType=1,Ud.effectId=5,Ud.Ik=Yd.Cl("AnimFxExitGeneric"),Ud.labelText=ResourceStrings.L_AnimationCheckerboard,Ud.pF=["Across","Up"],Ud.effectData=[],Ud));let ie;Yd.nC.add("Exit_BasicZoom",(ie=new ne,ie.effectType=1,ie.effectId=23,ie.Ik=Yd.Cl("AnimFxExitGeneric"),ie.labelText=ResourceStrings.L_AnimationBasicZoom,ie.pF="Out OutCenter OutSlightly In InBottom InSlightly".split(" "),
ie.effectData=[],ie));let Be;Yd.nC.add("Exit_Blinds",(Be=new ne,Be.effectType=1,Be.effectId=3,Be.Ik=Yd.Cl("AnimFxExitGeneric"),Be.labelText=ResourceStrings.L_AnimationBlinds,Be.pF=["Horizontal","Vertical"],Be.effectData=[],Be));let oe;Yd.nC.add("Exit_Box",(oe=new ne,oe.effectType=1,oe.effectId=4,oe.Ik=Yd.Cl("AnimFxExitShape"),oe.labelText=ResourceStrings.L_AnimationBox,oe.pF=["In","Out"],oe.effectData=[],oe));let rf;Yd.nC.add("Exit_PeekOut",(rf=new ne,rf.effectType=1,rf.effectId=12,rf.Ik=Yd.Cl("AnimFxExitGeneric"),
rf.labelText=ResourceStrings.L_AnimationPeekOut,rf.pF=["ToBottom","ToLeft","ToRight","ToTop"],rf.effectData=[],rf));let Vf;Yd.nC.add("Exit_RandomBars",(Vf=new ne,Vf.effectType=1,Vf.effectId=14,Vf.Ik=Yd.Cl("AnimFxExitRandomBars"),Vf.labelText=ResourceStrings.L_AnimationRandomBars,Vf.pF=["Horizontal","Vertical"],Vf.effectData=[],Vf));let xg;Yd.nC.add("Exit_Split",(xg=new ne,xg.effectType=1,xg.effectId=16,xg.Ik=Yd.Cl("AnimFxExitSplit"),xg.labelText=ResourceStrings.L_AnimationSplit,xg.pF=["HorizontalIn",
"HorizontalOut","VerticalIn","VerticalOut"],xg.effectData=[],xg));let qh;Yd.nC.add("Exit_Strips",(qh=new ne,qh.effectType=1,qh.effectId=18,qh.Ik=Yd.Cl("AnimFxExitGeneric"),qh.labelText=ResourceStrings.L_AnimationStrips,qh.pF=["LeftDown","LeftUp","RightDown","RightUp"],qh.effectData=[],qh));let k;Yd.nC.add("Exit_Stretchy",(k=new ne,k.effectType=1,k.effectId=17,k.Ik=Yd.Cl("AnimFxExitGeneric"),k.labelText=ResourceStrings.L_AnimationStretchy,k.pF=[],k.effectData=[],k));let E;Yd.nC.add("Exit_Zoom",(E=
new ne,E.effectType=1,E.effectId=53,E.Ik=Yd.Cl("AnimFxExitFadedZoom"),E.labelText=ResourceStrings.L_AnimationZoom,E.pF=["ObjectCenterOut","SlideCenterOut"],E.effectData=[],E));let S;Yd.nC.add("Emphasis_Spin",(S=new ne,S.effectType=2,S.effectId=8,S.Ik=Yd.Cl("AnimFxEmphasisSpin"),S.labelText=ResourceStrings.L_AnimationSpin,S.pF=["Clockwise","CounterClockwise"],S.effectData=["Spin_Quarter","Spin_Half","Spin_Full","Spin_Two"],S));let la;Yd.nC.add("Emphasis_Transparency",(la=new ne,la.effectType=2,la.effectId=
9,la.Ik=Yd.Cl("AnimFxEmphasisTransparency"),la.labelText=ResourceStrings.L_AnimationTransparency,la.pF=[],la.effectData=["Transparency_25","Transparency_50","Transparency_75","Transparency_100"],la));let sa;Yd.nC.add("Emphasis_GrowShrink",(sa=new ne,sa.effectType=2,sa.effectId=6,sa.Ik=Yd.Cl("AnimFxEmphasisGrowShrink"),sa.labelText=ResourceStrings.L_AnimationGrowShrink,sa.pF=["GrowShrinkHorizontal","GrowShrinkVertical","GrowShrinkBoth"],sa.effectData=["GrowShrink_Tiny","GrowShrink_Smaller","GrowShrink_Larger",
"GrowShrink_Huge"],sa));let pb;Yd.nC.add("Emphasis_FillColor",(pb=new ne,pb.effectType=2,pb.effectId=1,pb.Ik=Yd.Cl("AnimFxEmphasisChangeFillColor"),pb.labelText=ResourceStrings.L_AnimationFillColor,pb.pF=[],pb.effectData=[],pb));let Ib;Yd.nC.add("Emphasis_FontColor",(Ib=new ne,Ib.effectType=2,Ib.effectId=3,Ib.Ik=Yd.Cl("AnimFxEmphasisChangeFontColor"),Ib.labelText=ResourceStrings.L_AnimationFontColor,Ib.pF=[],Ib.effectData=[],Ib));let Wb;Yd.nC.add("Emphasis_LineColor",(Wb=new ne,Wb.effectType=2,Wb.effectId=
7,Wb.Ik=Yd.Cl("AnimFxEmphasisChangeLineColor"),Wb.labelText=ResourceStrings.L_AnimationLineColor,Wb.pF=[],Wb.effectData=[],Wb))}else Yd.nC.add("FlyIn",Object.assign(new ne,{effectType:0,effectId:2,Ik:Yd.Cl("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,pF:["FromBottom","FromLeft","FromTop","FromRight"],effectData:[]}))}nCe(ka,ib){let Rb=null;Yd.nC.forEach((tc,xc)=>{xc.effectType===ka&&xc.effectId===ib&&(Rb=xc);return!0});return Rb}lih(ka,ib){let Rb=null;Yd.nC.forEach((tc,xc)=>{xc.effectType===
ka&&xc.effectId===ib&&(Rb=tc);return!0});return Rb}Uhh(ka,ib,Rb,tc,xc){const hd=Object.assign(new eg.a,{Id:"MenuSectionEffectOptions"+Rb,ControlsId:"MenuSectionEffectOptionsDirection.Controls",DisplayMode:"Menu32",ControlList:[]});ka=this.nCe(ib,ka);if(!ka)return hd;if((ka=Yd.xOm(ka,Rb))&&ka.length)for(ib=0;ib<ka.length;ib++){const Fd=Yd.yOm(ka[ib],Rb),Td="AnimationEffectOptions"+("Direction"===Rb?"Direction":"Data")+Fd.id;Array.add(hd.ControlList,Object.assign(new pg.a,{Command:tc,Id:Fd.id,ExternalId:Td,
QueryCommand:xc}))}return hd}khh(ka){var ib;return(ib=Yd.nC.ha(ka))?(ka=ib.effectType,ib=ib.effectId,{returnValue:!0,effectType:ka,effectId:ib}):{returnValue:!1,effectType:-1,effectId:-1}}lhh(ka){let ib,Rb;ib=Yd.Cl("AnimFxMultiple");Rb=ResourceStrings.L_AnimationExisting;if(ka=Yd.nC.ha(ka))ib=ka.Ik,Rb=ka.labelText;return{image:ib,label:Rb}}vkh(ka,ib){if(0===ka){if(0!==ib&&1!==ib&&2!==ib&&10!==ib)return!0}else if(0<ka)return!0;return!1}rSd(ka,ib){return ka&&ib?this.cVb?(ib=ib.pSb()?ka.IsTrigger:ka.HasTrigger,
!!this.nCe(ka.EffectType,ka.EffectId)&&!ib):!ka.HasExisting:!0}ilh(ka){return ka?this.KEe(Array(ka)):!0}KEe(ka){if(!ka||!ka.length)return!0;for(const ib of ka)if(null==this.nCe(ib.EffectType,ib.EffectId))return!1;return!0}Slj(ka,ib){return ib&&ka&&this.cVb?ib.pSb()?!1:ka.HasMultiple:!1}fRf(ka){if(!ka||!ka.length)return!1;const ib=ka[0].EffectId,Rb=ka[0].EffectType;for(let tc=1;tc<ka.length;tc++){const xc=ka[tc];if(xc.EffectId!=ib||xc.EffectType!=Rb)return!0}return!1}XBl(ka){if(ka&&this.cVb&&2===ka.EffectType)switch(ka.EffectId){case 1:case 3:case 7:return!0}return!1}brj(ka){if(!ka)return!1;
if(2===ka.EffectType)switch(ka.EffectId){case 1:case 3:case 7:return!0}return!1}QNm(ka){ka=Yd.nC.ha(ka);return this.eCf(ka.pF[0])}NNm(ka){return(ka=Yd.nC.ha(ka))&&ka.effectData.length?this.VMi(ka.effectData[0]):""}eCf(ka){switch(ka){case "FromBottom":case "ToBottom":return 3;case "FromBottomLeft":case "ToBottomLeft":case "LeftDown":return 8;case "FromLeft":case "ToLeft":return 4;case "FromTopLeft":case "ToTopLeft":case "LeftUp":return 5;case "FromTop":case "ToTop":return 1;case "FromTopRight":case "ToTopRight":case "RightUp":return 6;
case "FromRight":case "ToRight":return 2;case "FromBottomRight":case "ToBottomRight":case "RightDown":return 7;case "Horizontal":case "Across":return 9;case "HorizontalIn":return 15;case "HorizontalOut":return 16;case "Vertical":case "Down":case "Up":return 10;case "VerticalIn":return 17;case "VerticalOut":return 18;case "In":case "ObjectCenter":return 11;case "InCenter":case "SlideCenter":return 22;case "InBottom":return 23;case "InSlightly":return 21;case "Out":case "ObjectCenterOut":return 12;
case "OutBottom":return 26;case "OutSlightly":return 24;case "OutCenter":case "SlideCenterOut":return 25;case "FloatUp":return 1;case "FloatDown":return 3;case "Clockwise":return 13;case "CounterClockwise":return 14;case "GrowShrinkHorizontal":return 27;case "GrowShrinkVertical":return 28;case "GrowShrinkBoth":return 29;default:return 0}}VMi(ka){return(ka=Yd.oJa.ha(ka))?ka.value:""}Rkl(ka,ib){return(ib=Yd.oJa.ha(ib))&&parseFloat(ka)===parseFloat(ib.value)?!0:!1}cVi(ka){switch(ka){case "AsOneObject":return 1;
case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}}mwm(ka){if(null===ka)throw Error.argumentNull("animation");const ib=this.nCe(ka.EffectType,ka.EffectId);return!!ib&&(0<ib.pF.length||0<ib.effectData.length||this.XBl(ka))}nwm(ka){if(!ka)return!1;const ib=this.nCe(ka.EffectType,ka.EffectId);return!!ib&&(0<ib.pF.length||0<ib.effectData.length||this.brj(ka))}owm(ka,ib,Rb){return this.rSd(Rb,ka)&&!this.Slj(Rb,ka)&&(this.mwm(Rb)||this.Wil(ka,ib,Rb)||this.Sbi(ka,
ib,Rb)||this.Uil(ka,ib,Rb)||this.Tbi(ka,Rb))}pwm(ka,ib,Rb){if(!(ka&&ib&&Rb&&Rb.length&&this.KEe(Rb)))return!1;ka=Yd.bml(ka,Rb);ib=this.Xil(ib,ka)||this.Zil(ib,ka)||this.Vil(ib,ka)||this.ajl(ka);let tc;this.fRf(Rb)||(tc=this.nwm(Rb[0]));return tc||ib}dSm(ka,ib,Rb){const tc=Object.assign(new eg.a,{Id:"MenuSectionEffectOptionsSequence",ControlsId:"MenuSectionEffectOptionsSequence.Controls",DisplayMode:"Menu32",ControlList:[]});this.Wil(ka,ib,Rb)&&Array.add(tc.ControlList,Object.assign(new pg.a,{Command:"1850236812",
Id:"AsOneObject",ExternalId:"AnimationEffectOptionsSequenceAsOneObject",QueryCommand:"1125291975"}));this.Uil(ka,ib,Rb)&&this.cVb&&Array.add(tc.ControlList,Object.assign(new pg.a,{Command:"2048458448",Id:"AllAtOnce",ExternalId:"AnimationEffectOptionsSequenceAllAtOnce",QueryCommand:"1125291975"}));this.Sbi(ka,ib,Rb)&&Array.add(tc.ControlList,Object.assign(new pg.a,{Command:"3467781846",Id:"ByParagraph",ExternalId:"AnimationEffectOptionsSequenceByParagraph",QueryCommand:"1125291975"}));this.Tbi(ka,
Rb)&&Array.add(tc.ControlList,Object.assign(new pg.a,{Command:"1486892994",Id:"OneByOne",ExternalId:"AnimationEffectOptionsSequenceOneByOne",QueryCommand:"1125291975"}));return tc}eSm(ka,ib,Rb){const tc=new eg.a;tc.Id="MenuSectionEffectOptionsSequence";tc.ControlsId="MenuSectionEffectOptionsSequence.Controls";tc.DisplayMode="Menu32";tc.ControlList=[];if(!(ka&&ka.length&&ib&&Rb&&Rb.length))return tc;ka=Yd.bml(ka,Rb);this.Xil(ib,ka)&&(Rb=new pg.a,Rb.Command="1850236812",Rb.Id="AsOneObject",Rb.ExternalId=
"AnimationEffectOptionsSequenceAsOneObject",Rb.QueryCommand="1125291975",tc.ControlList.push(Rb));this.Vil(ib,ka)&&(Rb=new pg.a,Rb.Command="2048458448",Rb.Id="AllAtOnce",Rb.ExternalId="AnimationEffectOptionsSequenceAllAtOnce",Rb.QueryCommand="1125291975",tc.ControlList.push(Rb));this.Zil(ib,ka)&&(ib=new pg.a,ib.Command="3467781846",ib.Id="ByParagraph",ib.ExternalId="AnimationEffectOptionsSequenceByParagraph",ib.QueryCommand="1125291975",tc.ControlList.push(ib));this.ajl(ka)&&(ib=new pg.a,ib.Command=
"1486892994",ib.Id="OneByOne",ib.ExternalId="AnimationEffectOptionsSequenceOneByOne",ib.QueryCommand="1125291975",tc.ControlList.push(ib));return tc}$5m(ka){let ib=!0,Rb=0;if(!ka)return!1;for(const tc of ka)if(ib)Rb=tc.EffectId,ib=!1;else if(tc.EffectId!==Rb)return!1;return!0}GQm(ka,ib,Rb){const tc={isEnabled:!1,Sth:null};if(!ka||!ib||!ib.length)return tc;for(var xc of ib)if(xc.IsTrigger)return tc;ka=Yd.nQm(ka);if(!ka.length||Yd.A3m(ka,ib))return tc;xc=ka.map(hd=>hd.EffectNodeId);ib=ib.map(hd=>hd.EffectNodeId).sort((hd,
Fd)=>hd-Fd);if(!Yd.f6m(ib,xc))return tc;if(Rb){Rb=xc.indexOf(ib[ib.length-1]);if(-1==Rb||Rb==xc.length-1)return tc;tc.isEnabled=!0;tc.Sth=Yd.Ywl(ka[Rb+1])}else{Rb=xc.indexOf(ib[0]);if(-1==Rb||0==Rb)return tc;tc.isEnabled=!0;tc.Sth=Yd.Ywl(ka[Rb-1])}return tc}USm(ka){const ib=[];if(!ka||!ka.animations||!ka.animations.Sequences)return ib;let Rb=0;for(const tc of ka.animations.Sequences)tc.Effects&&(ib.push({isTriggerSequence:tc.IsTriggerSeq,sequenceIndex:tc.SequenceIndex,description:tc.Description,animationCount:tc.Effects.length,
sequenceStartIndex:Rb}),Rb+=tc.Effects.length);return ib}OOm(ka,ib){const Rb=[];if(!ka||!ka.length)return Rb;const tc=new Map;if(Ef.a("DisableControlsInAnimationCardBasedOnShapeType")){if(null===ib||void 0===ib||!ib.length)return Rb;ib.forEach(Td=>{tc.set(Td.id.toString(),Td)})}ib=new Map;for(var xc of ka.filter(Td=>!Td.IsTrigger&&-1!==Td.GroupId)){var hd=`${xc.ShapeId}${","}${xc.GroupId}`;if(ib.has(hd)){var Fd=ib.get(hd);ib.set(hd,Fd+1)}else ib.set(hd,1)}xc=new Set;for(const Td of ka)ka=Yd.QAm(Td),
Ef.a("DisableControlsInAnimationCardBasedOnShapeType")&&(hd=tc.get(Td.ShapeId),this.CLn(ka,hd)),Td.IsTrigger||(-1===Td.GroupId?ka.IsGroupAnimation=0<xc.size:(ka.IsGroupAnimation=!0,hd=`${Td.ShapeId}${","}${Td.GroupId}`,0===xc.size&&(ka.IsFirstGroupAnimation=!0),xc.has(hd)||xc.add(hd),Fd=ib.get(hd),Fd--,ib.set(hd,Fd),0===Fd&&xc.delete(hd),0===xc.size&&(ka.IsLastGroupAnimation=!0)),ka.IsDraggable=!ka.IsGroupAnimation||ka.IsFirstGroupAnimation&&ka.IsLastGroupAnimation),Rb.push(ka);return Rb}CLn(ka,ib){const Rb=
this.nCe(ka.EffectType,ka.EffectId);Yd.yDl([ib])&&!Rb?ka.DisabledAnimationControls.push(0):Yd.Toj([ib])&&!Rb&&(ka.DisabledAnimationControls.push(1),ka.DisabledAnimationControls.push(2))}static QAm(ka){return Object.assign(Object.assign({},ka),{IsDraggable:!1,IsFirstGroupAnimation:!1,IsGroupAnimation:!1,IsLastGroupAnimation:!1,DisabledAnimationControls:[]})}static bml(ka,ib){const Rb=new Map;for(const tc of ka)Rb.set(tc.id.toString(),tc);ka=new Map;for(const tc of ib)ib=fg.a.Xf(tc.ShapeId),ib=Rb.get(ib.toString()),
ka.set(tc,ib);return ka}static Ywl(ka){const ib=new be;ib.EffectNodeId=ka.EffectNodeId;ib.ShapeId=ka.ShapeId;return ib}static f6m(ka,ib){if(!(ka&&ka.length&&ib&&ib.length)||ka.length>ib.length)return!1;const Rb=ka[ka.length-1],tc=ib.indexOf(ka[0]);return ib.indexOf(Rb)-tc+1==ka.length}static nQm(ka){const ib=[];if(!ka)return ib;ka=ka.animations;if(!ka||!ka.Sequences)return ib;for(const Rb of ka.Sequences[0].Effects)ib.push(Rb);return ib.sort((Rb,tc)=>Rb.EffectNodeId-tc.EffectNodeId)}static A3m(ka,
ib){if(!ka||!ib)return!1;const Rb=new Map;for(const tc of ka.filter(xc=>-1!==xc.GroupId))if(ka=`${tc.ShapeId}${","}${tc.GroupId}`,Rb.has(ka)){const xc=Rb.get(ka);Rb.set(ka,xc+1)}else Rb.set(ka,1);for(const tc of ib.filter(xc=>-1!==xc.GroupId))if(ib=`${tc.ShapeId}${","}${tc.GroupId}`,Rb.has(ib)&&1<Rb.get(ib))return!0;return!1}Wil(ka,ib,Rb){return 0!==Rb.SequenceId&&0!==Rb.EffectId&&this.rSd(Rb,ka)&&(ka.rg||2!==Rb.EffectType||1!==Rb.EffectId&&7!==Rb.EffectId)&&(ka.Lca||this.Tbi(ka,Rb)||this.Sbi(ka,
ib,Rb))}rwm(ka,ib,Rb){return ka&&0!==Rb.BuildType&&0!==Rb.EffectId&&this.ilh(Rb)&&(ka.rg||2!==Rb.EffectType||1!==Rb.EffectId&&7!==Rb.EffectId)&&(ka.Lca||this.$il(ka,Rb)||this.Yil(ka,ib,Rb))}Xil(ka,ib){for(const [Rb,tc]of ib)if(!this.rwm(tc,ka,Rb))return!1;return!0}Uil(ka,ib,Rb){return 0!==Rb.SequenceId&&!ka.Lca&&!ka.Zc&&0!==Rb.EffectId&&this.rSd(Rb,ka)&&(ka.rg||2!==Rb.EffectType||1!==Rb.EffectId&&7!==Rb.EffectId)&&(ka.pl||ka.rg||ka.isEditable&&0<ib.Kfa(ka).length)}qwm(ka,ib,Rb){return ka&&0!==Rb.BuildType&&
!ka.Lca&&!ka.Zc&&0!==Rb.EffectId&&this.ilh(Rb)&&(ka.rg||2!==Rb.EffectType||1!==Rb.EffectId&&7!==Rb.EffectId)&&(ka.pl||ka.rg||ka.isEditable&&0<ib.Kfa(ka).length)}Vil(ka,ib){for(const [Rb,tc]of ib)if(!this.qwm(tc,ka,Rb))return!1;return!0}Sbi(ka,ib,Rb){return 0!==Rb.SequenceId&&!ka.rg&&!ka.Lca&&!ka.Zc&&0!==Rb.EffectId&&this.rSd(Rb,ka)&&(2!==Rb.EffectType||1!==Rb.EffectId&&7!==Rb.EffectId)&&(ka.pl||ka.isEditable&&0<ib.Kfa(ka).length)}Yil(ka,ib,Rb){return ka&&0!==Rb.BuildType&&!ka.rg&&!ka.Lca&&!ka.Zc&&
0!==Rb.EffectId&&this.ilh(Rb)&&(2!==Rb.EffectType||1!==Rb.EffectId&&7!==Rb.EffectId)&&(ka.pl||ka.isEditable&&0<ib.Kfa(ka).length)}Zil(ka,ib){for(const [Rb,tc]of ib)if(!this.Yil(tc,ka,Rb))return!1;return!0}Tbi(ka,ib){return 0!==ib.SequenceId&&ka.rg&&0!==ib.EffectId&&this.rSd(ib,ka)}$il(ka,ib){return ka&&0!==ib.BuildType&&ka.rg&&0!==ib.EffectId&&this.ilh(ib)}ajl(ka){for(const [ib,Rb]of ka)if(!this.$il(Rb,ib))return!1;return!0}static Cl(ka){return xb.a.kde+"_"+ka+"_32x32x32"}static xOm(ka,ib){switch(ib){case "Direction":return ka.pF;
case "EffectData":return ka.effectData;default:return null}}static yOm(ka,ib){switch(ib){case "Direction":return Yd.kB.ha(ka);case "EffectData":return Yd.oJa.ha(ka);default:return null}}}Yd.kB=null;Yd.oJa=null;Yd.nC=null;Yd.yDl=ka=>{if(!ka||0==ka.length)return!1;for(const ib of ka)if(ib.n3)return!0;return!1};Yd.Toj=ka=>{if(!ka||0==ka.length)return!1;for(const ib of ka)if(1===ib.mediaType||2===ib.mediaType)return!0;return!1};Object(m.a)(Yd,"AnimationHelper",null,[1253]);var Lg=a(49);const Yg=(Pb.a.FB&
65535^Pb.a.FB>>>16)<<16,Ng="SetAnimation SetAnimationDuration SetAnimationDelay AnimationStart MoveAnimationEarlier MoveAnimationLater SetAnimationColorEffect SetAnimationDirection SetAnimationEffectData SetAnimationSequenceAllAtOnce SetAnimationSequenceAsOneObject SetAnimationSequenceByParagraph SetAnimationSequenceOneByOne SetAnimationColor".split(" ");class df{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb,Xb,nc,Nc,yd,Ud,ie,Be,oe,rf,Vf,xg,qh){this.Xbb="Existing";this.$Yc="ExistingInMenu";this.bLk=
"AnimationExisting";this.cLk="AnimationExistingInMenu";this.rob=this.ika=this.lza=!1;this.sKl=this.cXd=this.ymh=-1;this.Jad=!1;this.p2b=(k,E,S,la,sa)=>{k=this.ot.N1;E=this.pa.ys();if(!E||!k||!k.length)return 8;if(1===S)return 32;S=this.uQb(k,E);sa.MenuItems=this.num(k,E,S);return 32};this.uPa=(k,E,S,la,sa)=>{k=sa.queryResult;sa=sa.SourceControlId;la=E=-1;sa!==this.Xbb&&({effectType:la,effectId:E}=this.Xx.khh(sa));var pb=this.ot.N1;if(!this.pa.ys())return 8;if(1!==S)return 32;S=this.Xx.lhh(sa);var Ib=
S.label;if(sa===this.Xbb||sa===this.$Yc)Ib=ResourceStrings.L_ExistingButtonDescription;this.WFd(sa,S.image,S.label,k,Ib);let Wb=Ib=!1;const Gc=0==pb.length?0:pb[0].EffectId,kd=0==pb.length?0:pb[0].EffectType,Gd=!this.Xx.KEe(pb);pb=this.Xx.fRf(pb);Gd||pb||(Ib=E===Gc&&la===kd,Wb=this.Xx.vkh(kd,Gc));sa===this.Xbb?(Wb=this.BBn(this.Xbb,k,pb,Wb,Gd,S.image,kd,Gc),k.Dka(Gd||pb||Wb)):sa===this.$Yc?(Wb=df.zBn(k,pb,Gd,Wb),k.Dka(Gd||pb||Wb)):k.Dka(Ib);return 32};this.Hah=k=>{Ef.a("AddAnimationContextInInteractiveEvent")&&
(Ae.a.Xj("AnimationMarkerLocallyRenderTime",Date.now().toString()),k&&this.qFl(k,"isAnimationMarkerLocalRender","true"))};this.V1l=(k,E,S=!1)=>{var la,sa;let pb=void 0,Ib=void 0;const Wb=this.pa.ud();if(Wb&&Wb.length){var Gc=this.pa.ys();if(Gc.Bxa){var kd=Gc.aPb(Wb);0==(null===kd||void 0===kd?void 0:kd.length)&&(kd=null===(sa=null===(la=Gc.animations)||void 0===la?void 0:la.Sequences)||void 0===sa?void 0:sa[0].Effects,null===kd||void 0===kd?0:kd.length)&&(pb=kd[kd.length-1].ClickOrder+1)}else pb=
1;for(const Gd of Wb)pb?!Gd.Lca&&Gd.pl?(Ib="NodesIsPlaceHolderType",this.ot.eFa(!0,Gd,void 0)):this.ot.eFa(!0,Gd,pb):(Ib="NodesHaveSomeAnimation",(la=Gc.lAb(Gd))&&1==la.length&&la[0].EffectId==k&&!S||this.ot.eFa(!0,Gd,void 0));E&&Ib&&this.qFl(E,"reasonForBlankAnimationMarker",Ib)}};this.BDm=()=>{var k=this.pa.ud();if(k&&k.length){var E=this.pa.ys(),S=E.aPb(k);if(S&&0!=S.length){S=S[0].ClickOrder;k=k.map(sa=>sa.id.toString());var la=E.xj();for(const sa of la)if(la=E.lAb(sa))if(k.includes(sa.id.toString()))this.ot.ASa(sa);
else for(const pb of la)if(pb.ClickOrder>=S){this.ot.eFa(!0,sa,void 0,!1);break}}}};this.FB=(k,E,S,la,sa)=>{E=this.ot.N1;var pb=this.pa.ys();let Ib=!0;var Wb=this.getSelectedShapes();if(!Wb||!Wb.length)if(Ib=!1,Wb=this.uQb(E,pb),!Wb||!Wb.length)return Ef.a("StopFalseLoggingSetAnimation")||Ob.a.J(509677843,800,10,"AnimationActor::setAnimation: selected shapes info is null"),8;Ef.a("FixAddAnimationCrashForGroupedShape")&&(Wb=this.xul(Wb));if(!df.h6m(pb,Wb)||this.ubc(Wb))return 8;if(1===S)return la=
0<E.length&&!this.Xx.KEe(E),pb=Yd.yDl(Wb),la&&pb?8:k===Pb.a.YWc||k===Pb.a.Y5b?(Wb=0<E.length&&this.Xx.fRf(E),pb=!1,la||Wb||(pb=this.Xx.vkh(0<E.length?E[0].EffectType:-1,0<E.length?E[0].EffectId:-1)),k===Pb.a.Y5b&&(pb=la?!0:!1),la||Wb||pb?32:16):k===Pb.a.XWc?df.g6m(Wb)?32:16:32;S=sa.SourceControlId;if(!S)return 8;if(S===this.Xbb||S===this.$Yc||S===this.bLk||S===this.cLk)return 32;S=this.Xx.khh(S);Wb=df.YLm(Wb,S.effectId,S.effectType,Ib,E);!this.Aa.getBooleanAppSetting("LocalAnimationMarkerRendering")||
0!=(null===Wb||void 0===Wb?void 0:Wb.AnimationAction)&&3!=(null===Wb||void 0===Wb?void 0:Wb.AnimationAction)||(3==Wb.AnimationAction?this.BDm():this.V1l(S.effectId,k),this.Hah(k));this.Jad&&Wb&&!this.lza&&E&&0===E.length&&(this.Dec(!1),this.lza=!0);Wb&&this.xJa(pb,Wb,!0);la&&(la.KK=S.effectId,la.pca=S.effectType+100);return 32};this.TNl=(k,E,S)=>{const la=this.ot.N1;E=this.pa.ys();if(!E||!la||!la.length)return 8;var sa=this.uQb(la,E);if(!sa||!sa.length)return Ob.a.J(509670021,800,10,"AnimationActor::moveAnimationHandler: selected shapes info is null"),
8;if(this.ubc(sa))return 8;switch(k){case Pb.a.A9d:k=!1;break;case Pb.a.B9d:k=!0;break;default:return 8}sa=this.Xx.GQm(E,la,k);if(1===S)return sa.isEnabled?32:8;if(!sa.Sth)return Ob.a.J(509670020,800,10,"AnimationActor::moveAnimationHandler: move animation info ref target is null"),8;S=df.t_a(la);S=df.Dpi(S,sa.Sth,k);this.xJa(E,S,!0);return 32};this.H6a=(k,E,S,la,sa)=>{E=this.ot.N1;k=this.pa.ys();if(!k||!E||!E.length)return 8;var pb=this.uQb(E,k);if(!pb||!pb.length)return Ob.a.J(509677842,800,10,
"AnimationActor::setAnimationColor: selected shapes info is null"),8;if(this.ubc(pb))return 8;if(1===S)return 32;S=pe.Box4ColorHelper.RP(sa);if(!S)return Ob.a.J(509677841,800,10,"AnimationActor::setAnimationColor:  solid is null"),8;S=pe.Box4ColorHelper.Jub(S,k.Oe);if(!S)return Ob.a.J(509677840,800,10,"AnimationActor::setAnimationColor:  color is null"),8;sa=new Uc.a;sa.AnimationAction=1;pb=new Le;pb.TargetEffects=df.t_a(E);pb.ModifyAnimPropType=3;E=new qc;E.Color=[S.r,S.g,S.b];E.EffectDataPropType=
1;pb.EffectData=E;sa.ModifyAnimationInfo=pb;this.xJa(k,sa,!0);la&&(la.pca=1);return 32};this.lek=()=>{const k=this.ot.N1;var E=this.pa.ys();if(!E||!k||!k.length)return 8;E=this.uQb(k,E);return E&&E.length?this.Xx.pwm(E,this.Ia,k)?32:16:(Ob.a.J(509677839,800,10,"AnimationActor::queryEffectOptions: selected shapes info is null"),8)};this.W5b=(k,E,S,la,sa)=>{k=this.ot.N1;E=this.pa.ys();if(!E||!k||!k.length)return 8;var pb=this.uQb(k,E);if(!pb||!pb.length)return Ob.a.J(509677838,800,10,"AnimationActor::setAnimationDirection: selected shapes info is null"),
8;if(this.ubc(pb))return 8;if(1===S)return 32;S=this.Xx.eCf(sa.MenuItemId);sa=new Uc.a;sa.AnimationAction=1;pb=new Le;pb.TargetEffects=df.t_a(k);pb.ModifyAnimPropType=2;pb.Direction=S;sa.ModifyAnimationInfo=pb;this.xJa(E,sa,!0);la&&(la.pca=1);return 32};this.q3b=(k,E,S,la,sa)=>{k=this.ot.N1;if(!this.pa.ys()||!k||!k.length)return 8;E=sa.queryResult;sa=this.Xx.eCf(sa.MenuItemId);df.z3m(k)&&E.xg(k[0].Direction===sa);return 32};this.ZWc=(k,E,S,la,sa)=>{k=this.ot.N1;E=this.pa.ys();if(!E||!k||!k.length)return 8;
var pb=this.uQb(k,E);if(!pb||!pb.length)return Ob.a.J(509677652,800,10,"AnimationActor::setAnimationSequence: selected shapes info is null"),8;if(this.ubc(pb))return 8;if(1===S)return 32;S=sa.MenuItemId;sa=new Uc.a;sa.AnimationAction=5;pb=new Ke;pb.TargetEffects=df.t_a(k);pb.BuildType=df.wMm(S);sa.ChangeAnimationBuildTypeInfo=pb;this.xJa(E,sa,!0);la&&(la.pca=1);return 32};this.vPa=(k,E,S,la,sa)=>{k=this.ot.N1;if(!this.pa.ys()||!k||!k.length)return 8;E=sa.queryResult;sa=this.Xx.cVi(sa.MenuItemId);
df.x3m(k)&&E.xg(k[0].BuildType===sa);return 32};this.X5b=(k,E,S,la,sa)=>{E=this.ot.N1;k=this.pa.ys();if(!k||!E||!E.length)return 8;var pb=this.uQb(E,k);if(!pb||!pb.length)return Ob.a.J(509677837,800,10,"AnimationActor::setAnimationEffectData: selected shapes info is null"),8;if(this.ubc(pb))return 8;if(1===S)return 32;pb=sa.MenuItemId;S=new Uc.a;S.AnimationAction=1;sa=new Le;sa.TargetEffects=df.t_a(E);sa.ModifyAnimPropType=3;E=this.vOm(pb);if(!E)return Ob.a.J(509703439,800,15,"AnimationActor::setAnimationEffectData:  effect data info is null"),
16;sa.EffectData=E;S.ModifyAnimationInfo=sa;this.xJa(k,S,!0);la&&(la.pca=1);return 32};this.r3b=(k,E,S,la,sa)=>{k=this.ot.N1;if(!this.pa.ys()||!k||!k.length)return 8;sa.queryResult.xg(this.Xx.Rkl(df.wOm(k[0].EffectData),sa.MenuItemId));return 32};this.YKn=(k,E,S,la,sa)=>{E=this.ot.N1;k=this.pa.ys();if(!k||!E||!E.length)return 8;la=this.uQb(E,k);if(!la||!la.length)return Ob.a.J(509677836,800,10,"AnimationActor::setAnimationStartHandler: selected shape info is null"),8;if(this.ubc(la))return 8;if(1===
S)return 32;S=sa.CommandValueId;if(!S||!S.trim().length)return Ob.a.J(509703438,800,10,"AnimationActor::setAnimationStartHandler:  startoption value is null or empty"),16;S=df.BTm(S);if(3==S)return Ob.a.J(509703437,800,15,"AnimationActor::setAnimationStartHandler:  startoption value is invalid"),16;for(var pb of E)pb.StartType=S;pb=df.t_a(E);pb=df.gml(pb,S);this.xJa(k,pb,!1);return 32};this.vdc=(k,E,S,la,sa)=>{k=this.ot.N1;if(!this.pa.ys()||!k||!k.length)return df.Nyk(sa,3),32;E=k[0].StartType;S=
!0;for(const pb of k)if(E!=pb.StartType){S=!1;break}S?df.Nyk(sa,E):df.Nyk(sa,3);return 32};this.XKn=(k,E,S,la,sa)=>{k=this.pa.ys();E=this.ot.N1;if(!k||!E||!E.length)return 8;la=this.uQb(E,k);if(!la||!la.length)return Ob.a.J(509677835,800,10,"AnimationActor::setAnimationDurationHandler: selected shape info is null"),8;if(this.ubc(la))return 8;const pb=!this.Xx.KEe(E);if(Yd.Toj(la)&&pb)return 8;if(1===S)return 32;(S=Math.floor(1E3*sa.Number))||(S=10);for(var Ib of E)Ib.Duration=S;Ib=df.t_a(E);Ib=df.Pdh(Ib,
1,S);this.xJa(k,Ib,!1);return 32};this.pUa=(k,E,S,la,sa)=>{k=this.ot.N1;if(!this.pa.ys()||!k||!k.length)return this.EMe(sa,"0.00"),32;E=k[0].Duration;S=!0;for(const pb of k)if(E!=pb.Duration){S=!1;break}S?this.EMe(sa,Number(E/1E3).toFixed(2)):this.EMe(sa,"0.01");return 32};this.Nnm=(k,E,S)=>{if(!this.pa.ys())return 8;k=this.getSelectedShapes();if(!k||0==k.length)return Ob.a.J(507650054,800,10,"AnimationActor::addAnimationInContextMenuHandler: selected shape count is 0"),8;if(this.ubc(k))return 8;
if(1===S)return 32;this.qy.selectRibbonTabById("AnimationsTab");this.lza||(this.Dec(!1),this.lza=!0);this.h0i(20);return 32};this.qXm=(k,E,S)=>1==S?32:Sb.b("AnimationPaneActor::ShowHideAnimationPane PaneOpen:",this.lza.toString(),k,()=>{(this.lza=!this.lza)?this.Dec(!1):this.$7i();return 32});this.$cd=(k,E,S,la,sa)=>{sa&&sa.xg(this.lza);return 32};this.Dec=(k,E)=>{const S=this.ML();var la=Object(K.a)(this,this.RVm,"applyAnimationAction");S.onAnimationAction=la;la=Object(K.a)(this,this.TVm,"handleAnimationSelectionChangeFromPane");
S.onSelectionChange=la;S.onAnimationPreviewAction=this.gon;la=this.getSelectedShapes();S.isAddAnimationButtonDisabled=!la||!la.length;if(la=Ef.a("FixAnimationRibbonBugs")?this.ot.aR:this.pa.ys()){S.isZeroStateAnimationPane=!la.Bxa;S.isPreviewButtonOnCardDisabled=!0;S.isAnimationPreviewPlaying=this.rob;var sa=la.xj(),pb=la.aPb(sa);this.sKl=this.rQm(pb);pb=pb.sort((Wb,Gc)=>Wb.EffectNodeId-Gc.EffectNodeId);S.animations=this.Xx.OOm(pb,sa);S.previewSequenceIndex=this.ymh;S.previewClickOrder=this.cXd;Ef.a("FixScrollAndFocusDuringPreview")&&
this.ika&&this.rob?S.selectedAnimationNodeIds=[]:S.selectedAnimationNodeIds=this.ot.N1.map(Wb=>Wb.EffectNodeId);S.sequencesInfo=this.Xx.USm(la);var Ib={title:ResourceStrings.L_AnimationGalleryGroup,hideHeader:!1,width:S.paneWidth,location:2,contentProps:S,onOpen:()=>{},onClose:()=>{this.lza=!1;Ob.a.J(507888535,800,50,"AnimationActor::showAnimationPane: Animation pane closed using close button");this.iph&&this.rob&&(this.ia.Cb(Pb.a.mac,2),this.rob=!1)},isModernPane:!0};sd.a.Py().then(Wb=>{k?this.lza&&
(Wb.updateTaskPane(Cc.a.LXa,Ib),this.iph&&this.rob&&Wb.setSelectedTaskPane(Cc.a.LXa)):Wb.showTaskPane(Cc.a.LXa,Ib);if(E)try{E()}catch(Gc){Ob.a.J(508069954,800,10,"AnimationActor::showAnimationPane: Could not execute callback on pane open {0}",Gc)}return null}).catch(Wb=>{Ob.a.J(512500804,800,10,"AnimationActor::showAnimationPane exception: {0}",Wb.toString())})}else Ob.a.J(509642376,800,10,"AnimationActor::showAnimationPane: selected slide is null")};this.onSelectionChange=()=>{if(this.ot&&this.ot.Ysa&&
!this.rob){var k=this.ot.aR;k?(k=k.xj())&&k.length&&(this.ot.Z9l(),this.lza&&this.ot.zag&&this.Dec(!0)):Ob.a.J(509145116,800,10,"AnimationActor::onSelectionChange: current active slide is null")}};this.onActiveSlideDomReady=(k,E)=>{E&&this.ot&&((k=this.ot.aR)?(E=Object(fe.a)(32,E.Ga))&&k.Xb!==E.Xb&&(this.ot.mYn(E),this.lza&&this.Dec(!0)):Ob.a.J(509145115,800,10,"AnimationActor::onActiveSlideDomReady: current active slide is null"))};this.$rb=(k,E)=>{const S=this.va.Ga;S&&S.ZT&&(k=this.ot.aR)&&S===
k&&(E=E.cI)&&E.shapeNode&&this.ACc(k.Xb,E.shapeNode)&&this.ot.eFa(this.ot.Ysa)};this.V4a=(k,E)=>{E&&this.ot&&(this.ot.lYn(E.Brb),this.lza&&(this.ot.Ysa||this.$7i()))};this.n1b=(k,E)=>{E.Gx&&E.Gx.Id&&this.V2a==E.Gx.Id&&setTimeout(()=>{this.ot.eFa(!0)},0)};this.Fle=(k,E)=>{E&&E.revisionId&&(this.V2a=E.revisionId.toString())};this.Gh=(k,E)=>{if(E&&E.property===We.a.$ye&&this.ot&&this.ot.Ysa){k=!1;if(Ef.a("FixAnimationSelectionCachingIssue"))for(var S of Ng){const la=Ae.a.Vwc(S);if(la&&0<la.length){k=
!0;break}}S=this.ot.aR;S?this.nc.Cg(E.node)===S&&(this.ot.VMe(!1),this.ot.kYn(k),this.ot.VMe(!0),this.lza&&this.Dec(!0)):Ob.a.J(509145114,800,10,"AnimationActor::onPropertyChanged: current active slide is null")}};this.RVm=(k,E,S)=>{Ef.a("TrackAnimationPaneEvents")&&E&&S&&Lg.ActionManager.nE(E,S,void 0);if(Ef.a("FixAnimationPaneActionContextNullIssue"))switch(E=Ae.a.Fk("SetAnimation",1),E.kq=!0,k.actionType){case 0:Ae.a.FA(E,()=>{this.h0i()});break;case 2:Ae.a.FA(E,()=>{this.Byl(k)});break;case 1:Ae.a.FA(E,
()=>{this.dyl(k)});break;case 3:this.wyl(k);break;case 4:E.actionName="AnimationStart";Ae.a.FA(E,()=>{this.ayl(k)});break;case 5:break;case 6:this.Ayl(k);break;default:Ob.a.J(509642375,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}else switch(k.actionType){case 0:this.h0i();break;case 2:this.Byl(k);break;case 1:this.dyl(k);break;case 3:this.wyl(k);break;case 4:this.ayl(k);break;case 5:break;case 6:this.Ayl(k);break;default:Ob.a.J(508829901,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}};
this.TVm=k=>{const E=this.pa.ys();E&&k?(this.ot.VMe(!1),this.ot.usa(),this.ot.WZh(k,E),this.ot.VMe(!0)):Ob.a.J(509620888,800,10,"AnimationActor::handleAnimationSelectionChangeFromPane: slide or animation ids info is null")};this.wzj=(k,E,S,la=30)=>{k=[Object.assign(new se.a,{name:"CustomData1",int64:Yg+k}),Object.assign(new se.a,{name:"CustomData2",int64:Yg+E+100})];nb.d(Pb.a.FB,!0,void 0,0,void 0==la||null==la?30:la,S,k)};this.h0i=k=>{var E=Date.now(),S=this.getSelectedShapes();const la=this.pa.ys();
if(la&&S&&S.length){this.olj("AddMarkerLocallyFromAnimationPane")&&(this.V1l(10,void 0,!0),this.Hah());if(Ef.a("FixAddAnimationCrashForGroupedShape")){const sa=this.xul(S);S.length=0;S.push(...sa)}if(S=df.vtl(S,10,0,!1))this.xJa(la,S,!0),this.pad&&(E=Date.now()-E,this.wzj(10,0,E,k))}else Ob.a.J(509642374,800,10,"AnimationActor::applyAddAnimationFromPane: slide or shapes info is null")};this.Byl=k=>{var E=Date.now();if(k&&k.replaceAnimationInfo){var S=k.replaceAnimationInfo.effectId;k=k.replaceAnimationInfo.effectType;
var la=this.ot.N1,sa=this.pa.ys();if(sa&&la&&la.length){if(this.olj("ReplaceMarkerLocallyFromAnimationPane")&&(this.cXm(sa,la,S),this.Hah()),la=df.lwl(la,S,k))this.xJa(sa,la,!0),this.pad&&(E=Date.now()-E,this.wzj(S,k,E))}else Ob.a.J(509642372,800,10,"AnimationActor::applyReplaceAnimation: slide or animation info is null")}else Ob.a.J(509642373,800,10,"AnimationActor::applyReplaceAnimation: replace animation info is null")};this.cXm=(k,E,S)=>{if(k&&E&&E.length)for(const la of E)null!=la.ShapeId&&la.EffectId!==
S&&(E=k.v8c(fg.a.Xf(la.ShapeId)))&&this.ot.eFa(!0,E,void 0)};this.dyl=k=>{var E=Date.now();if(k&&k.deleteAnimationInfo){var S=this.pa.ys();k=k.deleteAnimationInfo.animationIds;S&&k&&k.length?(this.olj("DeleteMarkerLocallyFromAnimationPane")&&(this.eWm(S,k),this.Hah()),k=df.fUm(k),k=df.kml(k),this.xJa(S,k,!0),this.pad&&(E=Date.now()-E,this.wzj(0,0,E))):Ob.a.J(509616839,800,10,"AnimationActor::handleDeleteAnimation: slide or deleteAnimationIds is null/empty")}else Ob.a.J(509616840,800,10,"AnimationActor::handleDeleteAnimation: delete animation info is null")};
this.eWm=(k,E)=>{if(k&&E&&E.length){var S=new Map;for(var la of E)S.has(la.shapeId)?S.get(la.shapeId).push(la):S.set(la.shapeId,Array(la));E=E.map(sa=>sa.effectNodeId);E=this.nc.Ngh(E,k);1<E.length&&E.sort((sa,pb)=>sa.ClickOrder-pb.ClickOrder);E=E.length?E[0].ClickOrder:0;la=k.xj();for(const sa of la)la=k.aPb(Array(sa)),S.has(sa.id.toString())?la.length==S.get(sa.id.toString()).length?this.ot.ASa(sa):this.ot.eFa(!0,sa,void 0):la.length&&la[la.length-1].ClickOrder>E&&this.ot.eFa(!0,sa,void 0,!1)}};
this.ML=()=>({type:"AnimationPaneProps",paneWidth:qb.a,isAnimationPreviewEnabled:this.ika,forceDisablePreview:Ef.a("DisablePreviewInSvgMode")&&this.ika&&this.Nab.pta});this.cXn=()=>{if(this.lza)return this.Dec(!0),32};this.$7i=()=>{sd.a.Py().then(k=>{Ob.a.J(507888534,800,50,"AnimationActor::hideAnimationPane: Animation pane closed using animation pane button in the ribbon");k.hideTaskPane(Cc.a.LXa,2);return null}).catch(k=>{Ob.a.J(512500803,833,10,"AnimationActor::hideAnimationPane exception: {0}",
k.toString())})};this.WKn=(k,E,S,la,sa)=>{E=this.ot.N1;k=this.pa.ys();if(!k||!E||!E.length)return 8;la=this.uQb(E,k);if(!la||!la.length)return Ob.a.J(509677834,800,10,"AnimationActor::setAnimationDelayHandler: selected shapes info is null"),8;if(this.ubc(la))return 8;const pb=!this.Xx.KEe(E);if(Yd.Toj(la)&&pb)return 8;if(1===S)return 32;S=Math.floor(1E3*sa.Number);for(var Ib of E)Ib.Delay=S;Ib=df.t_a(E);Ib=df.Pdh(Ib,0,S);this.xJa(k,Ib,!1);return 32};this.oUa=(k,E,S,la,sa)=>{k=this.ot.N1;if(!this.pa.ys()||
!k||!k.length)return this.EMe(sa,"0.00"),32;E=k[0].Delay;S=!0;for(const pb of k)if(E!=pb.Delay){S=!1;break}S?this.EMe(sa,Number(E/1E3).toFixed(2)):this.EMe(sa,"0.00");return 32};this.num=(k,E,S)=>{var la;const sa=new Ld.a;sa.Id="AnimationMenuEffectOptions";sa.UpdateDynamically=!0;sa.Title=ResourceStrings.L_EffectOptions;sa.MenuSectionList=[];if(!this.Xx.fRf(k)){const pb=k[0];sa.MenuSectionList.push(this.Xx.Uhh(pb.EffectId,pb.EffectType,"Direction","2289594085","3782857737"));if(this.Xx.brj(pb))if(sa.MenuSectionList.push(he.f(E.Oe,
"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),sa.MenuSectionList.push(he.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)),this.y3m(k)){const Ib=null===(la=pb.EffectData)||void 0===la?void 0:la.Color;la=new me.a(me.a.evh(Ib));he.h(sa,la,E.Oe)}else he.h(sa,null,E.Oe);sa.MenuSectionList.push(this.Xx.Uhh(pb.EffectId,pb.EffectType,"EffectData","2949363495","4132852551"))}sa.MenuSectionList.push(this.Xx.eSm(S,
this.Ia,k));return sa};this.vOm=k=>{const E=new qc,S=this.Xx.VMi(k);return k.toLowerCase().startsWith("spin")?(E.Degree=parseFloat(S),E.EffectDataPropType=0,E):k.toLowerCase().startsWith("transparency")?(E.Transparency=parseFloat(S),E.EffectDataPropType=2,E):k.toLowerCase().startsWith("growshrink")?(E.Scale=parseFloat(S),E.EffectDataPropType=3,E):null};this.BBn=(k,E,S,la,sa,pb,Ib,Wb)=>{if(sa)return!1;if(S)return this.WFd(k,pb,ResourceStrings.L_AnimationMultiple,E,ResourceStrings.L_AnimationMultiple),
la;la&&(pb=this.Xx.lih(Ib,Wb),{image:pb,label:S}=this.Xx.lhh(pb),this.WFd(k,pb,S,E,S));return la};this.WFd=(k,E,S,la,sa)=>{let pb;pb=k===this.Xbb?"298832323":k===this.$Yc?"1264919631":"2676673376";E=E.substring((xb.a.kde+"_").length,E.length-6);const Ib=new Qd.a;Ib.Id=k;Ib.ExternalId="Animation"+k;Ib.Icon=E;Ib.Command=pb;Ib.QueryCommand="1852964326";Ib.LabelText=S;Ib.FullIconStyle={root:{width:"32px",height:"32px"}};Ib.PreviewIconStyle={root:{width:"24px",height:"24px"}};Ib.Alt=sa;la.Rwa=Ib};this.getSelectedShapes=
()=>{const k=[],E=this.pa.ud();if(!E)return k;for(const S of E)S.get_smartArtModelId()?k.push(this.Ia.ev(S)):S.wg?k.push(this.Ia.Dr(S)):k.push(S);return k};this.uQb=(k,E)=>{const S=[];if(!k||!k.length||!E)return S;const la=E.xj();if(!la||!la.length)return S;E=new Map;for(const sa of la)E.set(sa.id.toString(),sa);for(const sa of k){k=fg.a.Xf(sa.ShapeId);k=E.get(k.toString());if(!k)return[];S.push(k)}return S};this.xJa=(k,E,S)=>{Ae.a.Xj("AnimationCommandType",String(E.AnimationAction));const la=this.Mb.Fd(15,
void 0,()=>{this.pa.Rj();S&&this.Ma.Wd()});Ef.a("FixDesignerCrashViaSetUndoActionId")&&(la.sc=Pb.a.FB);try{la.rc(k),k.hsa=E}finally{la&&la.dispose()}};this.ubc=k=>{if(!k||0==k.length)return!1;for(const E of k)if(this.uc.Cd(E))return!0;return!1};this.EMe=(k,E)=>{k.queryResult.rda=E};this.Trm=(k,E)=>{this.rob=E.ABl;this.ymh=this.cXd=-1;Ef.a("FixScrollAndFocusDuringPreview")&&this.rob&&this.pa.Ti();!this.lza&&this.rob?(this.lza=!0,this.Dec(!1,()=>E.PPl("animationPaneOpened"))):this.Dec(!0,()=>E.PPl("animationPaneOpened"))};
this.gon=()=>{this.rob=!this.rob;if(Ef.a("AddPreviewFlowAdjustments"))if(this.rob){const k=Mc.a.create().toString();Ob.a.J(508043415,800,50,"AnimationActor::onAnimationPreviewFromPaneHandler - Initiating preview [previewId: {0}]",k);this.ia.Qa(Pb.a.S4c,2,{DAn:k})}else Ob.a.J(508043414,800,50,"AnimationActor::onAnimationPreviewFromPaneHandler - Ending preview"),this.ia.Cb(Pb.a.mac,2);else this.ia.Cb(this.rob?Pb.a.S4c:Pb.a.mac,2)};this.rQm=k=>{let E=0;for(let S=0;S<k.length;S++)0===k[S].SequenceIndex&&
(E=Math.max(E,k[S].ClickOrder));return E};this.Lwm=(k,E)=>{this.ymh=E.Urm;this.cXd=E.Sxm;k=Ef.a("FixAnimationRibbonBugs")?this.ot.aR:this.pa.ys();E=k.xj();k=k.aPb(E);(E=k.sort((la,sa)=>la.EffectNodeId-sa.EffectNodeId))&&0<E.length&&0===E[0].ClickOrder&&--this.cXd;this.Dec(!0);E=this.cXd==this.sKl;let S=0;for(let la=0;la<k.length;la++)k[la].SequenceIndex===this.ymh&&k[la].ClickOrder===this.cXd&&(S=Math.max(S,k[la].Delay+k[la].Duration));this.v$c&&this.v$c.RYc(S,E)};if(!ka)throw Error.argumentNull("actionManager");
if(!ib)throw Error.argumentNull("selectionManager");if(!Rb)throw Error.argumentNull("focusManager");if(!tc)throw Error.argumentNull("transactionFactory");if(!Vf)throw Error.argumentNull("applicationSettings");if(!xc)throw Error.argumentNull("animationHelper");if(!hd)throw Error.argumentNull("graphActionBlockingManager");if(!Fd)throw Error.argumentNull("shapeReader");if(!Td)throw Error.argumentNull("pathManager");if(!na)throw Error.argumentNull("effectSelectionManager");if(!$a)throw Error.argumentNull("viewElementEventHandler");
if(!Fb)throw Error.argumentNull("graphNodeEventHandlers");if(!Xb)throw Error.argumentNull("viewEventNotifier");if(!nc)throw Error.argumentNull("slideReader");if(!Nc)throw Error.argumentNull("graphTopologyManager");if(Ud){if(!yd)throw Error.argumentNull("ribbonUser");this.qy=yd;this.ucn=Ud}if(Ef.a("FixAnimationPaneVisibilityInViewMode")){if(!ie)throw Error.argumentNull("appFrame");this.Db=ie}if(!rf)throw Error.argumentNull("graphOperationEventHandler");if(Ef.a("DisablePreviewInSvgMode")&&Be&&!qh)throw Error.argumentNull("slideShowCoreHelper");
this.ia=ka;this.pa=ib;this.Ma=Rb;this.Mb=tc;this.Ldg=Td.Yp(xb.a.iJe);this.Xx=xc;this.uc=hd;this.Ia=Fd;this.ot=na;this.NA=$a;this.Iz=Fb;this.Ge=Xb;this.nc=nc;this.va=Nc;this.pad=Ef.a("AnimationPaneTelemetryEnabled");this.iph=Be;this.v$c=oe;this.ih=rf;this.Aa=Vf;this.Jad=xg;this.Nab=qh}Hb(){this.ia.sa(Pb.a.SHa,Id.a.application,this.YKn,4);this.ia.sa(Pb.a.vdc,Id.a.application,this.vdc,97);this.ia.sa(Pb.a.lec,Id.a.application,this.XKn,4);this.ia.sa(Pb.a.pUa,Id.a.application,this.pUa,97);this.ia.sa(Pb.a.mxh,
Id.a.application,this.qXm,4);this.ia.sa(Pb.a.$cd,Id.a.application,this.$cd,96);this.ia.sa(Pb.a.kec,Id.a.application,this.WKn,4);this.ia.sa(Pb.a.oUa,Id.a.application,this.oUa,97);this.ia.sa(Pb.a.uPa,Id.a.application,this.uPa,97);this.ia.sa(Pb.a.FB,Id.a.application,this.FB,13);this.ia.sa(Pb.a.XWc,Id.a.application,this.FB,13);this.ia.sa(Pb.a.YWc,Id.a.application,this.FB,5);this.ia.sa(Pb.a.Y5b,Id.a.application,this.FB,5);this.ia.sa(Pb.a.uhe,Id.a.application,this.lek,100);this.ia.sa(Pb.a.W5b,Id.a.application,
this.W5b,13);this.ia.sa(Pb.a.q3b,Id.a.application,this.q3b,97);this.ia.sa(Pb.a.X5b,Id.a.application,this.X5b,12);this.ia.sa(Pb.a.r3b,Id.a.application,this.r3b,96);this.ia.sa(Pb.a.sme,Id.a.application,this.ZWc,13);this.ia.sa(Pb.a.tme,Id.a.application,this.ZWc,13);this.ia.sa(Pb.a.ume,Id.a.application,this.ZWc,13);this.ia.sa(Pb.a.vme,Id.a.application,this.ZWc,13);this.ia.sa(Pb.a.vPa,Id.a.application,this.vPa,97);this.ia.sa(Pb.a.p2b,Id.a.application,this.p2b,96);this.ia.sa(Pb.a.H6a,Id.a.application,this.H6a,
12);this.ia.sa(Pb.a.A9d,Id.a.application,this.TNl,4);this.ia.sa(Pb.a.B9d,Id.a.application,this.TNl,4);this.ia.sa(Pb.a.o2g,Id.a.application,this.cXn,4);this.pa.QM(this.onSelectionChange);this.NA.Caf(this.onSelectionChange);this.NA.Fea(this.onActiveSlideDomReady);this.Iz.Am(this.Gh);this.Ge.c$b(this.V4a);Ef.a("ShowAnimationMarkerOnUndo")&&(this.ih.nma(this.n1b),this.ih.Qye(this.Fle));this.iph&&(this.Ge.jel(this.Trm),this.iph.dqm(this.Lwm),this.ika=!0);Ef.a("FixMarkersForShapeDeleteAndUndo")&&this.NA.J4c(this.$rb);
this.ucn&&this.ia.sa(Pb.a.vah,Id.a.application,this.Nnm,4);Ef.a("FixAnimationPaneVisibilityInViewMode")&&this.Db.PM(ka=>{this.Av(ka)})}ve(){}qFl(ka,ib,Rb){Ef.a("AddAnimationContextInInteractiveEvent")&&(ka=this.ia.DX(ka))&&Lg.ActionManager.$R(ka.interactive_uid,ib,Rb)}Av(ka){1===ka.mode&&this.lza&&this.$7i()}xul(ka){if(null===ka||void 0===ka||!ka.length)return[];const ib=new Set,Rb=[];ka.forEach(tc=>{ib.has(tc.id)||(ib.add(tc.id),Rb.push(tc))});return Rb}ACc(ka,ib){return ka&&ib?ka.equals(ib.slideId):
!1}olj(ka){return this.Aa.getBooleanAppSetting("LocalAnimationMarkerRendering")&&Ef.a(ka)}ayl(ka){var ib=Date.now();if(ka&&ka.changeAnimationRelationshipInfo){var Rb=this.ot.N1,tc=this.pa.ys();tc&&Rb&&Rb.length?(ka=ka.changeAnimationRelationshipInfo,Rb=df.t_a(Rb),Rb=df.gml(Rb,ka.startType),this.xJa(tc,Rb,!1),this.pad&&(ib=Date.now()-ib,nb.c(Pb.a.SHa,!0,void 0,0,30,ib))):Ob.a.J(509444173,800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: slide or selected animation info is null")}else Ob.a.J(509444174,
800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: change relationship info is null")}wyl(ka){const ib=Date.now();if(ka&&ka.modifyAnimationInfo){var Rb=this.ot.N1,tc=this.pa.ys();if(tc&&Rb&&Rb.length)if(Ef.a("FixAnimationPaneActionContextNullIssue")){var xc=Ae.a.Fk("SetAnimationDuration",1);0==ka.modifyAnimationInfo.modifyAnimationType&&(xc.actionName="SetAnimationDelay");xc.kq=!0;Ae.a.FA(xc,()=>{var hd=df.t_a(Rb);if(hd=df.cul(ka.modifyAnimationInfo,hd)){if(this.xJa(tc,hd,!1),this.pad){hd=
null;switch(ka.modifyAnimationInfo.modifyAnimationType){case 0:hd=Pb.a.kec;break;case 1:hd=Pb.a.lec}if(hd){const Fd=Date.now()-ib;nb.c(hd,!0,void 0,0,30,Fd)}}}else Ob.a.J(509444170,800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed")})}else if(xc=df.t_a(Rb),xc=df.cul(ka.modifyAnimationInfo,xc)){if(this.xJa(tc,xc,!1),this.pad){xc=null;switch(ka.modifyAnimationInfo.modifyAnimationType){case 0:xc=Pb.a.kec;break;case 1:xc=Pb.a.lec}if(xc){const hd=
Date.now()-ib;nb.c(xc,!0,void 0,0,30,hd)}}}else Ob.a.J(508829900,800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed");else Ob.a.J(509444171,800,10,"AnimationActor::handleModifyAnimation: slide or selected animation info is null")}else Ob.a.J(509444172,800,10,"AnimationActor::handleModifyAnimation: modify info is null")}Ayl(ka){const ib=Date.now(),Rb=ka.reorderAnimationInfo;if(ka&&Rb){var tc=this.ot.N1,xc=ka.reorderAnimationInfo.refAnimationId,
hd=this.pa.ys();if(hd&&tc&&tc.length&&xc)if(Ef.a("FixAnimationPaneActionContextNullIssue"))ka=Ae.a.Fk("MoveAnimationEarlier",1),ka.kq=!0,ka.actionName=xc.effectNodeId<tc[0].EffectNodeId?"MoveAnimationEarlier":"MoveAnimationLater",Ae.a.FA(ka,()=>{var Fd=new be;Fd.EffectNodeId=xc.effectNodeId;Fd.ShapeId=xc.shapeId;const Td=df.t_a(tc);Fd=df.Dpi(Td,Fd,Rb.isLater);this.xJa(hd,Fd,!0);this.pad&&(Fd=Date.now()-ib,nb.c(xc.effectNodeId<tc[0].EffectNodeId?Pb.a.A9d:Pb.a.B9d,!0,void 0,0,30,Fd))});else{ka=new be;
ka.EffectNodeId=xc.effectNodeId;ka.ShapeId=xc.shapeId;const Fd=df.t_a(tc);ka=df.Dpi(Fd,ka,Rb.isLater);this.xJa(hd,ka,!0);this.pad&&(ka=Date.now()-ib,nb.c(xc.effectNodeId<tc[0].EffectNodeId?Pb.a.A9d:Pb.a.B9d,!0,void 0,0,30,ka))}else Ob.a.J(509444168,800,10,"AnimationActor::handleReorderAnimation: slide, selected or ref animation info is null")}else Ob.a.J(509444169,800,10,"AnimationActor::handleReorderAnimation: reorder animation info is null")}static cul(ka,ib){switch(ka.modifyAnimationType){case 0:return df.Pdh(ib,
0,ka.delay);case 1:return df.Pdh(ib,1,ka.duration);default:return null}}y3m(ka){var ib;if(!(ka&&ka.length&&!this.Xx.fRf(ka)&&this.Xx.brj(ka[0])&&ka[0].EffectData&&ka[0].EffectData.Color))return!1;const Rb=null===(ib=ka[0].EffectData)||void 0===ib?void 0:ib.Color;for(const tc of ka){if(!tc.EffectData||!tc.EffectData.Color)return!1;ka=tc.EffectData.Color;if(ka[0]!=Rb[0]||ka[1]!=Rb[1]||ka[2]!=Rb[2])return!1}return!0}static gml(ka,ib){const Rb=new Uc.a;Rb.AnimationAction=4;const tc=new kf;tc.TargetEffects=
ka;tc.StartType=ib;Rb.ChangeAnimationRelationshipInfo=tc;return Rb}static Pdh(ka,ib,Rb){const tc=new Uc.a;tc.AnimationAction=1;const xc=new Le;xc.TargetEffects=ka;xc.ModifyAnimPropType=ib;1===ib?xc.Duration=Rb:xc.Delay=Rb;tc.ModifyAnimationInfo=xc;return tc}static Dpi(ka,ib,Rb){const tc=new Uc.a;tc.AnimationAction=6;const xc=new Ie;xc.TargetEffects=ka;xc.IsLater=Rb;xc.RefEffect=ib;tc.ReorderAnimationEffectsInfo=xc;return tc}static Nyk(ka,ib){let Rb="";switch(ib){case 0:Rb=ResourceStrings.l_AnimationStartOptionOnClick;
break;case 1:Rb=ResourceStrings.l_AnimationStartOptionWithPrevious;break;case 2:Rb=ResourceStrings.l_AnimationStartOptionAfterPrevious}ka.kX=Rb;ka.Z5b(!0)}}df.fUm=ka=>{const ib=[];if(!ka||!ka.length)return ib;for(const Rb of ka)ka=new be,ka.EffectNodeId=Rb.effectNodeId,ka.ShapeId=Rb.shapeId,ib.push(ka);return ib};df.wMm=ka=>{switch(ka){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}};df.YLm=(ka,ib,Rb,tc,xc)=>0==ib&&0==Rb?
df.ZNm(xc):tc?df.vtl(ka,ib,Rb,!0):df.lwl(xc,ib,Rb);df.lwl=(ka,ib,Rb)=>{const tc=new Uc.a;tc.AnimationAction=2;const xc=new te;if(!ka||!ka.length)return Ob.a.J(509703434,800,15,"AnimationActor::getReplaceAnimationCommandInfo:  animation info is null or empty"),null;xc.TargetEffects=df.t_a(ka);xc.EffectId=ib;xc.EffectType=Rb;tc.ReplaceAnimationInfo=xc;return tc};df.ZNm=ka=>ka&&ka.length?df.kml(df.t_a(ka)):(Ob.a.J(509703433,800,15,"AnimationActor::getDeleteAnimationCommandInfo:  animation info is null or empty"),
null);df.vtl=(ka,ib,Rb,tc)=>{const xc=new Uc.a;xc.AnimationAction=0;const hd=new pd;hd.EffectId=ib;hd.EffectType=Rb;hd.ShapeIds=[];hd.FRemoveExisting=tc;for(const Fd of ka)hd.ShapeIds.push(Fd.id.toString());xc.AddAnimationInfo=hd;return xc};df.kml=ka=>{const ib=new Uc.a;ib.AnimationAction=3;const Rb=new Od;Rb.TargetEffects=ka;ib.DeleteAnimationInfo=Rb;return ib};df.BTm=ka=>{switch(ka.toLocaleLowerCase()){case "on click":return 0;case "with previous":return 1;case "after previous":return 2}return 3};
df.t_a=ka=>{if(!ka||!ka.length)return null;const ib=[];for(const Rb of ka)ka=new be,ka.EffectNodeId=Rb.EffectNodeId,ka.ShapeId=Rb.ShapeId,ib.push(ka);return ib};df.h6m=(ka,ib)=>{if(!ka||!ib||!ib.length)return!1;for(const Rb of ib)if(Rb.OX||Rb.ht||Ef.a("FixAnimationRibbonBugs")?0:Rb.Zl)return!1;return!0};df.g6m=ka=>{if(!ka||!ka.length)return!1;for(const ib of ka)if(ib.Zc||ib.om||Ef.a("FixAnimationRibbonBugs")?0:ib.Zl)return!1;return!0};df.z3m=ka=>{if(!ka||!ka.length)return!1;const ib=ka[0].Direction;
for(let Rb=1;Rb<ka.length;Rb++)if(ka[Rb].Direction!=ib)return!1;return!0};df.x3m=ka=>{if(!ka||!ka.length)return!1;const ib=ka[0].BuildType;for(let Rb=1;Rb<ka.length;Rb++)if(ka[Rb].BuildType!=ib)return!1;return!0};df.wOm=ka=>{if(!ka)return"";switch(ka.EffectDataPropType){case 0:return ka.Degree.toString();case 3:return ka.Scale.toString();case 2:return ka.Transparency.toString()}return""};df.zBn=(ka,ib,Rb,tc)=>{Rb?(ka.dAb=ResourceStrings.L_AnimationExisting,tc&&(tc=!1)):ib&&(ka.dAb=ResourceStrings.L_AnimationMultiple);
return tc};Object(m.a)(df,"AnimationActor",null,[743]);class Pg{constructor(){this.BuildId=0;this.BuildIds=null;this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.EffectType=this.EffectId=0;this.HasTrigger=this.HasMultiple=this.HasExisting=!1;this.Id=null;this.IsTrigger=this.IsTextRangeType=!1;this.ParaRangeStart=this.ParaRangeEnd=0;this.RenderAnimationImage=!1;this.StartType=this.SequenceIndex=this.SequenceId=0}}Object(m.a)(Pg,"EditAnimationInfo",null,[]);var ig;(function(ka){ka[ka.invalid=
0]="invalid";ka[ka.basicBlockList=1]="basicBlockList";ka[ka.alternatingHexagons=2]="alternatingHexagons";ka[ka.pictureCaptionList=3]="pictureCaptionList";ka[ka.linedList=4]="linedList";ka[ka.verticalBulletList=5]="verticalBulletList";ka[ka.verticalBoxList=6]="verticalBoxList";ka[ka.verticalBracketList=7]="verticalBracketList";ka[ka.varyingWidthList=8]="varyingWidthList";ka[ka.tabList=9]="tabList";ka[ka.horizontalBulletList=10]="horizontalBulletList";ka[ka.squareAccentList=11]="squareAccentList";ka[ka.pictureAccentList=
12]="pictureAccentList";ka[ka.bendingPictureAccentList=13]="bendingPictureAccentList";ka[ka.stackedList=14]="stackedList";ka[ka.increasingCircleProcess=15]="increasingCircleProcess";ka[ka.pieProcess=16]="pieProcess";ka[ka.detailedProcess=17]="detailedProcess";ka[ka.groupedList=18]="groupedList";ka[ka.horizontalPictureList=19]="horizontalPictureList";ka[ka.continuousPictureList=20]="continuousPictureList";ka[ka.pictureStrips=21]="pictureStrips";ka[ka.verticalPictureList=22]="verticalPictureList";ka[ka.alternatingPictureBlocks=
23]="alternatingPictureBlocks";ka[ka.verticalPictureAccentList=24]="verticalPictureAccentList";ka[ka.titledPictureAccentList=25]="titledPictureAccentList";ka[ka.verticalBlockList=26]="verticalBlockList";ka[ka.verticalChevronList=27]="verticalChevronList";ka[ka.verticalAccentList=28]="verticalAccentList";ka[ka.verticalArrowList=29]="verticalArrowList";ka[ka.trapezoidList=30]="trapezoidList";ka[ka.descendingBlockList=31]="descendingBlockList";ka[ka.tableList=32]="tableList";ka[ka.segmentedProcess=33]=
"segmentedProcess";ka[ka.verticalCurvedList=34]="verticalCurvedList";ka[ka.pyramidList=35]="pyramidList";ka[ka.targetList=36]="targetList";ka[ka.hierarchyList=37]="hierarchyList";ka[ka.verticalCircleList=38]="verticalCircleList";ka[ka.tableHierarchy=39]="tableHierarchy";ka[ka.architectureLayout=40]="architectureLayout";ka[ka.basicProcess=41]="basicProcess";ka[ka.stepUpProcess=42]="stepUpProcess";ka[ka.stepDownProcess=43]="stepDownProcess";ka[ka.accentProcess=44]="accentProcess";ka[ka.pictureAccentProcess=
45]="pictureAccentProcess";ka[ka.alternatingFlow=46]="alternatingFlow";ka[ka.continuousBlockProcess=47]="continuousBlockProcess";ka[ka.increasingArrowsProcess=48]="increasingArrowsProcess";ka[ka.interconnectedBlockProcess=49]="interconnectedBlockProcess";ka[ka.continuousArrowProcess=50]="continuousArrowProcess";ka[ka.convergingText=51]="convergingText";ka[ka.processArrows=52]="processArrows";ka[ka.circleAccentTimeline=53]="circleAccentTimeline";ka[ka.basicTimeline=54]="basicTimeline";ka[ka.circleProcess=
55]="circleProcess";ka[ka.basicChevronProcess=56]="basicChevronProcess";ka[ka.chevronAccentProcess=57]="chevronAccentProcess";ka[ka.closedChevronProcess=58]="closedChevronProcess";ka[ka.chevronList=59]="chevronList";ka[ka.subStepProcess=60]="subStepProcess";ka[ka.phasedProcess=61]="phasedProcess";ka[ka.randomtoResultProcess=62]="randomtoResultProcess";ka[ka.verticalProcess=63]="verticalProcess";ka[ka.staggeredProcess=64]="staggeredProcess";ka[ka.processList=65]="processList";ka[ka.circleArrowProcess=
66]="circleArrowProcess";ka[ka.basicBendingProcess=67]="basicBendingProcess";ka[ka.repeatingBendingProcess=68]="repeatingBendingProcess";ka[ka.verticalBendingProcess=69]="verticalBendingProcess";ka[ka.ascendingPictureAccentProcess=70]="ascendingPictureAccentProcess";ka[ka.upwardArrow=71]="upwardArrow";ka[ka.descendingProcess=72]="descendingProcess";ka[ka.circularBendingProcess=73]="circularBendingProcess";ka[ka.equation=74]="equation";ka[ka.verticalEquation=75]="verticalEquation";ka[ka.funnel=76]=
"funnel";ka[ka.gear=77]="gear";ka[ka.arrowRibbon=78]="arrowRibbon";ka[ka.opposingArrows=79]="opposingArrows";ka[ka.convergingArrows=80]="convergingArrows";ka[ka.divergingArrows=81]="divergingArrows";ka[ka.basicCycle=82]="basicCycle";ka[ka.textCycle=83]="textCycle";ka[ka.blockCycle=84]="blockCycle";ka[ka.nondirectionalCycle=85]="nondirectionalCycle";ka[ka.continuousCycle=86]="continuousCycle";ka[ka.multidirectionalCycle=87]="multidirectionalCycle";ka[ka.segmentedCycle=88]="segmentedCycle";ka[ka.basicPie=
89]="basicPie";ka[ka.hexagonRadial=90]="hexagonRadial";ka[ka.radialCycle=91]="radialCycle";ka[ka.basicRadial=92]="basicRadial";ka[ka.divergingRadial=93]="divergingRadial";ka[ka.radialVenn=94]="radialVenn";ka[ka.cycleMatrix=95]="cycleMatrix";ka[ka.radialCluster=96]="radialCluster";ka[ka.organizationChart=97]="organizationChart";ka[ka.pictureOrganizationChart=98]="pictureOrganizationChart";ka[ka.nameandTitleOrganizationChart=99]="nameandTitleOrganizationChart";ka[ka.halfCircleOrganizationChart=100]=
"halfCircleOrganizationChart";ka[ka.circlePictureHierarchy=101]="circlePictureHierarchy";ka[ka.hierarchy=102]="hierarchy";ka[ka.labeledHierarchy=103]="labeledHierarchy";ka[ka.horizontalOrganizationChart=104]="horizontalOrganizationChart";ka[ka.horizontalMultiLevelHierarchy=105]="horizontalMultiLevelHierarchy";ka[ka.horizontalHierarchy=106]="horizontalHierarchy";ka[ka.horizontalLabeledHierarchy=107]="horizontalLabeledHierarchy";ka[ka.balance=108]="balance";ka[ka.circleRelationship=109]="circleRelationship";
ka[ka.hexagonCluster=110]="hexagonCluster";ka[ka.opposingIdeas=111]="opposingIdeas";ka[ka.plusandMinus=112]="plusandMinus";ka[ka.reverseList=113]="reverseList";ka[ka.counterbalanceArrows=114]="counterbalanceArrows";ka[ka.segmentedPyramid=115]="segmentedPyramid";ka[ka.nestedTarget=116]="nestedTarget";ka[ka.convergingRadial=117]="convergingRadial";ka[ka.radialList=118]="radialList";ka[ka.tabbedArc=119]="tabbedArc";ka[ka.basicTarget=120]="basicTarget";ka[ka.basicVenn=121]="basicVenn";ka[ka.linearVenn=
122]="linearVenn";ka[ka.stackedVenn=123]="stackedVenn";ka[ka.interconnectedRings=124]="interconnectedRings";ka[ka.basicMatrix=125]="basicMatrix";ka[ka.titledMatrix=126]="titledMatrix";ka[ka.gridMatrix=127]="gridMatrix";ka[ka.basicPyramid=128]="basicPyramid";ka[ka.invertedPyramid=129]="invertedPyramid";ka[ka.accentedPicture=130]="accentedPicture";ka[ka.circularPictureCallout=131]="circularPictureCallout";ka[ka.radialPictureList=132]="radialPictureList";ka[ka.snapshotPictureList=133]="snapshotPictureList";
ka[ka.spiralPicture=134]="spiralPicture";ka[ka.captionedPictures=135]="captionedPictures";ka[ka.bendingPictureCaption=136]="bendingPictureCaption";ka[ka.pictureFrame=137]="pictureFrame";ka[ka.bendingPictureSemiTransparentText=138]="bendingPictureSemiTransparentText";ka[ka.bendingPictureBlocks=139]="bendingPictureBlocks";ka[ka.bendingPictureCaptionList=140]="bendingPictureCaptionList";ka[ka.titledPictureBlocks=141]="titledPictureBlocks";ka[ka.pictureGrid=142]="pictureGrid";ka[ka.pictureAccentBlocks=
143]="pictureAccentBlocks";ka[ka.themePictureAccent=144]="themePictureAccent";ka[ka.themePictureGrid=145]="themePictureGrid";ka[ka.themePictureAlternatingAccent=146]="themePictureAlternatingAccent";ka[ka.alternatingPictureCircles=147]="alternatingPictureCircles";ka[ka.titlePictureLineup=148]="titlePictureLineup";ka[ka.pictureLineup=149]="pictureLineup";ka[ka.framedTextPicture=150]="framedTextPicture";ka[ka.bubblePictureList=151]="bubblePictureList";ka[ka.linearArrowProcessNumbered=152]="linearArrowProcessNumbered";
ka[ka.linearBlockProcessNumbered=153]="linearBlockProcessNumbered";ka[ka.basicLinearProcessNumbered=154]="basicLinearProcessNumbered";ka[ka.accentHomeChevronProcess=155]="accentHomeChevronProcess";ka[ka.basicProcessNew=156]="basicProcessNew";ka[ka.basicTimelineNew=157]="basicTimelineNew";ka[ka.chevronBlockProcess=158]="chevronBlockProcess";ka[ka.hexagonTimeline=159]="hexagonTimeline";ka[ka.horizontalActionList=160]="horizontalActionList";ka[ka.repeatingBendingProcessNew=161]="repeatingBendingProcessNew";
ka[ka.roundedRectangleTimeline=162]="roundedRectangleTimeline";ka[ka.verticalDownArrowProcess=163]="verticalDownArrowProcess";ka[ka.verticalHollowActionList=164]="verticalHollowActionList";ka[ka.verticalSolidActionList=165]="verticalSolidActionList";ka[ka.dropPinTimeline=166]="dropPinTimeline";ka[ka.horizontalLabelsTimeline=167]="horizontalLabelsTimeline";ka[ka.horizontalPathTimeline=168]="horizontalPathTimeline";ka[ka.iconLabelList=169]="iconLabelList";ka[ka.iconCircleList=170]="iconCircleList";
ka[ka.iconLabelDescriptionList=171]="iconLabelDescriptionList";ka[ka.iconVerticalSolidList=172]="iconVerticalSolidList";ka[ka.iconCircleLabelList=173]="iconCircleLabelList";ka[ka.iconCircleOutlineLabelList=174]="iconCircleOutlineLabelList";ka[ka.iconLeafLabelList=175]="iconLeafLabelList";ka[ka.iconLeafOutlineLabelList=176]="iconLeafOutlineLabelList";ka[ka.centeredIconLabelDescriptionList=177]="centeredIconLabelDescriptionList"})(ig||(ig={}));Object(m.b)("SmartArtLayout",ig);var ji;(function(ka){ka[ka.title=
0]="title";ka[ka.body=1]="body";ka[ka.centerTitle=2]="centerTitle";ka[ka.subTitle=3]="subTitle";ka[ka.slideNum=5]="slideNum";ka[ka.footer=6]="footer";ka[ka.object=8]="object";ka[ka.graph=9]="graph";ka[ka.table=10]="table";ka[ka.clipArt=11]="clipArt";ka[ka.orgChart=12]="orgChart";ka[ka.media=13]="media";ka[ka.picture=15]="picture";ka[ka.cameo=16]="cameo"})(ji||(ji={}));Object(m.b)("PlaceholderType",ji);class Ca{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a){this.Xbb="Existing";this.$Yc="ExistingInMenu";
this.bLk="AnimationExisting";this.cLk="AnimationExistingInMenu";this.ia=ka;this.mr=ib;this.pa=Rb;this.Ldg=$a.Yp(xb.a.iJe);this.Mb=xc;this.Ma=tc;this.Xx=hd;this.uc=Fd;this.vcn=Td.UJe;this.Ia=na;this.oIj=Ef.a("SetAnimationTelemetryCustomDataEnabled")}Hb(){this.ia.sa(Pb.a.uPa,Id.a.application,Object(K.a)(this,this.uPa,"queryAnimationGallery"),97);this.ia.sa(Pb.a.mth,Id.a.application,Object(K.a)(this,this.mth,"queryMoreAnimationGallery"),96);this.ia.sa(Pb.a.FB,Id.a.application,Object(K.a)(this,this.FB,
"setAnimation"),5|(this.oIj?8:0));this.ia.sa(Pb.a.XWc,Id.a.application,Object(K.a)(this,this.FB,"setAnimation"),5|(this.oIj?8:0));this.ia.sa(Pb.a.YWc,Id.a.application,Object(K.a)(this,this.FB,"setAnimation"),5);this.ia.sa(Pb.a.Y5b,Id.a.application,Object(K.a)(this,this.FB,"setAnimation"),5);this.ia.sa(Pb.a.uhe,Id.a.application,Object(K.a)(this,this.lek,"queryEffectOptions"),100);this.ia.sa(Pb.a.W5b,Id.a.application,Object(K.a)(this,this.W5b,"setAnimationDirection"),5);this.ia.sa(Pb.a.q3b,Id.a.application,
Object(K.a)(this,this.q3b,"queryAnimationDirection"),97);this.ia.sa(Pb.a.X5b,Id.a.application,Object(K.a)(this,this.X5b,"setAnimationEffectData"),4);this.ia.sa(Pb.a.r3b,Id.a.application,Object(K.a)(this,this.r3b,"queryAnimationEffectData"),96);this.ia.sa(Pb.a.sme,Id.a.application,Object(K.a)(this,this.ZWc,"setAnimationSequence"),5);this.ia.sa(Pb.a.tme,Id.a.application,Object(K.a)(this,this.ZWc,"setAnimationSequence"),5);this.ia.sa(Pb.a.ume,Id.a.application,Object(K.a)(this,this.ZWc,"setAnimationSequence"),
5);this.ia.sa(Pb.a.vme,Id.a.application,Object(K.a)(this,this.ZWc,"setAnimationSequence"),5);this.ia.sa(Pb.a.vPa,Id.a.application,Object(K.a)(this,this.vPa,"queryAnimationSequence"),97);this.ia.sa(Pb.a.yLg,Id.a.application,Object(K.a)(this,this.Fia,"reorderAnimation"),4);this.ia.sa(Pb.a.zLg,Id.a.application,Object(K.a)(this,this.Fia,"reorderAnimation"),4);this.ia.sa(Pb.a.p2b,Id.a.application,Object(K.a)(this,this.p2b,"populateAnimationEffectOptions"),96);this.ia.sa(Pb.a.H6a,Id.a.application,Object(K.a)(this,
this.H6a,"setAnimationColor"),4)}ve(){}p2b(ka,ib,Rb,tc,xc){ka=this.Pjb();ib=this.pa.ys();if(!ib||!ka)return 8;if(1===Rb)return 32;Rb=Ca.ixa(ib,ka);if(!Rb||0===Rb.EffectId)return 16;xc.MenuItems=this.mum(Rb,ib,ka);return 32}uPa(ka,ib,Rb,tc,xc){ka=xc.queryResult;xc=xc.SourceControlId;var hd=tc=-1;xc!==this.Xbb&&({effectType:hd,effectId:tc}=this.Xx.khh(xc));ib=this.Pjb();var Fd=this.pa.ys();if(!Fd||!ib)return 8;if(1!==Rb)return 32;const {image:Td,label:na}=this.Xx.lhh(xc);Rb=na;if(xc===this.Xbb||xc===
this.$Yc)Rb=ResourceStrings.L_ExistingButtonDescription;this.WFd(xc,Td,na,ka,Rb);var $a=Ca.ixa(Fd,ib);Rb=$a?$a.EffectId:0;const Fb=$a?$a.EffectType:0,Xb=!this.Xx.rSd($a,ib);$a=this.Xx.Slj($a,ib);this.vcn&&(Fd=Fd?Fd.p_a(ib):null,$a=$a&&!this.Xx.$5m(Fd));tc=!Xb&&!$a&&tc===Rb&&hd===Fb;hd=Xb?!1:this.Xx.vkh(Fb,Rb);xc===this.Xbb||xc===this.$Yc?(hd=xc===this.Xbb?this.CBn(this.Xbb,ka,$a,hd,Td,Fb,Rb):Ca.ABn(ka,$a,hd),ka.Dka(Xb||$a||hd)):ib&&ka.Dka(tc);return 32}CBn(ka,ib,Rb,tc,xc,hd,Fd){Rb?this.WFd(ka,xc,
ResourceStrings.L_AnimationMultiple,ib,ResourceStrings.L_AnimationMultiple):tc&&(xc=this.Xx.lih(hd,Fd),{image:xc,label:Rb}=this.Xx.lhh(xc),this.WFd(ka,xc,Rb,ib,Rb));return tc}WFd(ka,ib,Rb,tc,xc){let hd;hd=ka===this.Xbb?"298832323":ka===this.$Yc?"1264919631":"2676673376";ib=ib.substring((xb.a.kde+"_").length,ib.length-6);ka=Object.assign(new Qd.a,{Id:ka,ExternalId:"Animation"+ka,Icon:ib,Command:hd,QueryCommand:"1852964326",LabelText:Rb,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",
height:"24px"}},Alt:xc});tc.Rwa=ka}mth(ka,ib){if(ib.contextId!==Id.a.application)return 2;ka=this.Pjb();return!this.pa.ys()||!ka||ka.OX||ka.ht||ka.Zl?8:this.uc.Cd(ka)?16:32}FB(ka,ib,Rb,tc,xc){ib=this.Pjb();var hd=this.pa.ys();if(!hd||!ib||ib.OX||ib.ht||ib.Zl)return 8;if(this.uc.Cd(ib))return 16;var Fd=Ca.ixa(hd,ib);const Td=Fd?Fd.EffectId:-1,na=Fd?Fd.EffectType:-1;if(1===Rb)return ka===Pb.a.YWc||ka===Pb.a.Y5b?(tc=this.Xx.vkh(na,Td),hd=!!Fd&&!this.Xx.rSd(Fd,ib),ka===Pb.a.Y5b&&(tc=hd?!0:!1),ib=!!Fd&&
this.Xx.Slj(Fd,ib),ib=hd||ib,tc||ib?32:16):ka===Pb.a.XWc?ib.Zc||ib.om||ib.Zl?16:32:32;ka=xc.SourceControlId;if(!ka)return 8;if(ka===this.Xbb||ka===this.$Yc||ka===this.bLk||ka===this.cLk)return 32;const {effectType:$a,effectId:Fb}=this.Xx.khh(ka);Rb=this.Xx.QNm(ka);xc=this.Xx.NNm(ka);tc&&this.oIj&&(tc.KK=Fb,tc.pca=$a);Fd=ib.pSb()?Ca.IGf(hd,ib):Fd;Fd||(Fd=new Pg,Fd.Id=ib.id.toString(),Fd.BuildIds=[hd.M6c+1],Fd.HasTrigger=!1,Fd.BuildId=hd.M6c+1,Fd.SequenceIndex=0,Fd.IsTextRangeType=!1);Fd.HasExisting=
!1;Fd.HasMultiple=!1;Fd.EffectType=$a;Fd.SequenceId=1;Fd.EffectId=Fb;Fd.Direction=Rb;Fd.EffectData=xc;Fd.IsTrigger=!1;this.pvf(hd,ib,Fd);n.ULS.sendTraceTag(512500802,800,50,"AnimationActorLegacy.SetAnimation: Effect={0}, SlideId.Sid={1}, ShapeId={2}",ka,hd.Xb.sid,ib.id);this.R$m(hd);return 32}H6a(ka,ib,Rb,tc,xc){ib=this.mr.presentation;if(!ib)throw Error.argumentNull("Presentation is null");ka=this.Pjb();if(!ka)return 8;ib=Object(fe.a)(32,ib.QB(ka.slideId));if(!ib)return 8;tc=Ca.ixa(ib,ka);if(!(tc&&
xc&&ib&&ka))return 8;if(this.uc.Cd(ka))return 16;if(1===Rb)return 32;Rb=pe.Box4ColorHelper.RP(xc);Rb=pe.Box4ColorHelper.Jub(Rb,ib.Oe);if(!Rb)return 8;tc.EffectData=String.format("{0},{1},{2}",Rb.r.toString(16),Rb.g.toString(16),Rb.b.toString(16));this.pvf(ib,ka,tc);return 32}lek(){const ka=this.Pjb();var ib=this.pa.ys();return ib&&ka?this.uc.Cd(ka)?16:(ib=Ca.ixa(ib,ka))&&this.Xx.owm(ka,this.Ia,ib)?32:16:8}Fia(ka,ib,Rb){ib=this.Pjb();const tc=this.pa.ys();if(!tc||!ib)return 8;if(this.uc.Cd(ib))return 16;
const xc=Ca.IGf(tc,ib);let hd;switch(ka){case Pb.a.yLg:hd=!1;break;case Pb.a.zLg:hd=!0;break;default:return 8}let Fd=!1;if(ib&&(Fd=!!xc&&!xc.HasTrigger&&1===xc.BuildIds.length)){let Td=!1,na=!1;({lhf:Td,nhf:na}=Ca.twm(tc,xc));Fd=hd?na&&Fd:Td&&Fd}if(1===Rb)return Fd?32:8;if(Fd){Rb=this.Mb.Fd(15,void 0,()=>{this.pa.Rj();this.Ma.Wd()});try{Rb.rc(tc),Rb.sc=ka,tc.Fia(ib,hd)}finally{Rb&&Rb.dispose()}}return 32}W5b(ka,ib,Rb,tc,xc){ka=this.Pjb();ib=this.pa.ys();if(!ib||!ka)return 8;if(1===Rb)return 32;if(this.uc.Cd(ka))return 16;
Rb=Ca.IGf(ib,ka);if(!Rb)return 8;xc=xc.MenuItemId;Rb.Direction=this.Xx.eCf(xc);this.pvf(ib,ka,Rb);n.ULS.sendTraceTag(512500801,800,50,"AnimationActorLegacy.SetAnimationDirection: Effect={0}, EffectDirection={1}, SlideId.Sid={2}, ShapeId={3}",this.Xx.lih(Rb.EffectType,Rb.EffectId),xc,ib.sid,ka.id);return 32}q3b(ka,ib,Rb,tc,xc){ib=this.Pjb();tc=this.pa.ys();if(!tc||!ib)return 8;ka=xc.queryResult;xc=this.Xx.eCf(xc.MenuItemId);ib=Ca.ixa(tc,ib);1===Rb&&ib&&ka.xg(ib.Direction===xc);return 32}ZWc(ka,ib,
Rb,tc,xc){ka=xc.MenuItemId;ib=this.Pjb();tc=this.pa.ys();if(!tc||!ib)return 8;if(1===Rb)return 32;if(this.uc.Cd(ib))return 16;Rb=Ca.IGf(tc,ib);if(!Rb)return 8;Rb.SequenceId=this.Xx.cVi(ka);this.pvf(tc,ib,Rb);return 32}vPa(ka,ib,Rb,tc,xc){ka=this.Pjb();ib=this.pa.ys();if(!ib||!ka)return 8;ka=Ca.ixa(ib,ka);ib=xc.queryResult;xc=this.Xx.cVi(xc.MenuItemId);1===Rb&&ka&&ib.xg(ka.SequenceId===xc);return 32}X5b(ka,ib,Rb,tc,xc){ka=this.Pjb();ib=this.pa.ys();if(!ib||!ka)return 8;if(1===Rb)return 32;if(this.uc.Cd(ka))return 16;
Rb=Ca.IGf(ib,ka);if(!Rb)return 8;if(!xc)return 2;Rb.EffectData=this.Xx.VMi(xc.MenuItemId);this.pvf(ib,ka,Rb);return 32}r3b(ka,ib,Rb,tc,xc){ka=this.Pjb();ib=this.pa.ys();if(!ib||!ka)return 8;ka=Ca.ixa(ib,ka);1===Rb&&ka&&xc.queryResult.xg(this.Xx.Rkl(ka.EffectData,xc.MenuItemId));return 32}pvf(ka,ib,Rb){const tc=this.Mb.Fd(15,void 0,()=>{this.pa.Rj();this.Ma.Wd()});try{tc.rc(ka),ka.uec(ib,Rb)}finally{tc&&tc.dispose()}}mum(ka,ib,Rb){const tc=Object.assign(new Ld.a,{Id:"AnimationMenuEffectOptions",UpdateDynamically:!0,
Title:ResourceStrings.L_EffectOptions,MenuSectionList:[]});Array.add(tc.MenuSectionList,this.Xx.Uhh(ka.EffectId,ka.EffectType,"Direction","2289594085","3782857737"));this.Xx.XBl(ka)&&(Array.add(tc.MenuSectionList,he.f(ib.Oe,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),Array.add(tc.MenuSectionList,he.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)));Array.add(tc.MenuSectionList,
this.Xx.Uhh(ka.EffectId,ka.EffectType,"EffectData","2949363495","4132852551"));Array.add(tc.MenuSectionList,this.Xx.dSm(Rb,this.Ia,ka));return tc}R$m(ka){if(ka){var ib=ka.xj(),Rb=String.format("{0}#{1}",ka.sid,ka.cid);if(ib&&0<ib.length)for(const tc of ib)if(ib=ka.xKa(tc)){const xc=ib.EffectId,hd=ib.EffectType,Fd=ib.Direction,Td=this.Xx.lih(hd,xc),na=this.Ia.uhh(tc),$a=Ca.eTm(tc,na);n.ULS.sendTraceTag(512500800,800,50,"Slide animation info: Effect={0}, EffectID={1}, EffectType={2}, Direction={3}, Len={4}, ShapeType={5}, ShapeSubType={6}, SeqID={7}, SlideID={8}, ShapeID={9}",
Td,xc,hd,Fd,tc.wI().length,na,$a,ib.SequenceId,Rb,tc.id)}}}Pjb(){const ka=this.pa.lo();return ka?ka.get_smartArtModelId()?this.Ia.ev(ka):ka.wg?this.Ia.Dr(ka):ka:null}static ABn(ka,ib,Rb){ib?ka.dAb=ResourceStrings.L_AnimationMultiple:(ka.dAb=ResourceStrings.L_AnimationExisting,Rb&&(Rb=!1));return Rb}static twm(ka,ib){let Rb,tc;if(!ib)return{lhf:!1,nhf:!1};const xc=ka.mBe,hd=ka.M6c,Fd=ib.BuildIds[0];tc=Rb=!0;0===ib.StartType?Rb=Fd>xc?!0:!1:tc=Fd<hd?!0:!1;if(Fd===xc||Fd===hd){if(!Fd)return{lhf:!1,nhf:tc};
for(const Td of ka.GQ)if(Td.Id!==ib.Id)for(const na of Td.BuildIds)if(0===ib.StartType){if(na>=Fd)return tc=!0,{lhf:Rb,nhf:tc}}else if(na===Fd)return Rb=!0,{lhf:Rb,nhf:tc};0===ib.StartType?tc=!1:Rb=!1}return{lhf:Rb,nhf:tc}}static ixa(ka,ib){return ka&&ib?ka.ixa(ib):null}static IGf(ka,ib){return ka&&ib?ka.xKa(ib):null}static eTm(ka,ib){return 24===ib?ig[ka.smartArtInfo.SmartArtLayout]:1===ib?ka.shapeType.toString():14===ib?ji[ka.placeholderType]:"Unknown"}}Object(m.a)(Ca,"AnimationActorLegacy",null,
[743]);var cb=a(2);class Eb{constructor(ka,ib,Rb,tc,xc){this.zh=null;this.ya=ka;this.C2c=ib;this.fim=Rb;this.yQh=tc;this.Ba=xc;this.yQh.init();this.C2c.init()}Hb(){this.ya.sa(X.a.NQc,Id.a.application,Object(K.a)(this,this.NQc,"openGrammarSettings"),1028);this.ya.za(X.a.jDe,I.a.frame,Object(K.a)(this,this.Txl,"grammarDialogTabFocusHandler"));this.ya.za(X.a.iDe,I.a.frame,Object(K.a)(this,this.Txl,"grammarDialogTabFocusHandler"));this.ya.za(X.a.lJf,I.a.frame,Object(K.a)(this,this.Sxl,"grammarDialogOptionFocusHandler"));
this.ya.za(X.a.kJf,I.a.frame,Object(K.a)(this,this.Sxl,"grammarDialogOptionFocusHandler"))}NQc(ka,ib,Rb,tc,xc){ka=this.oul();if(1===Rb)return this.yQh.request(ka).result&&this.yQh.request(ka).result.length?6===this.C2c.feb.status?32:8:8;this.zh=this.fim(ka,this.C2c.feb.result);this.zh.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,hd=>{n.ULS.sendTraceTag(36489285,375,50,"User click button of {0}",1===hd?"OK":0===hd?"Cancel":"");1===hd&&(this.zh.j7m()?(n.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),
this.C2c.saveSettings(this.zh.settings)):n.ULS.sendTraceTag(36508631,375,50,"User click OK with but not update setting"))});ka=Rb="";xc&&(Rb+=xc.SourceControlId,ka+=xc.Alt);n.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+Rb+", Alt: "+ka);return 32}oul(){return parseInt(this.Ba.La("Lcid")||"1033")}Txl(ka){if(!this.zh)return 2;var ib=this.zh.ew.Hw().nt.Lma;if(ib===this.zh.IS&&ka===X.a.jDe||ib===this.zh.Mdd&&ka===X.a.iDe)this.zh.wva?this.zh.ew.Hw().nt.tZ(this.zh.wva):
this.zh.GJn();else if(Sys.UI.DomElement.containsCssClass(ib,Oc.bof)||ib.parentNode&&Sys.UI.DomElement.containsCssClass(ib.parentNode,Oc.bof))ib=null,ka===X.a.jDe?ib=this.zh.Mdd:ka===X.a.iDe&&(ib=this.zh.IS),this.zh.ew.Hw().nt.tZ(ib);else if(ka===X.a.jDe)this.zh.ew.Hw().I9d();else if(ka===X.a.iDe)this.zh.ew.Hw().C9d();else return 2;return 32}Sxl(ka){if(!this.zh)return 2;let ib=this.zh.ew.Hw().nt.Lma;if(ib===this.zh.IS||ib===this.zh.Mdd||ib===this.zh.F7)return 2;ka===X.a.kJf&&this.zh.ew.Hw().I9d();
ka===X.a.lJf&&this.zh.ew.Hw().C9d();ib=this.zh.ew.Hw().nt.Lma;ib===this.zh.Mdd?this.zh.ew.Hw().C9d():ib===this.zh.IS?this.zh.ew.Hw().I9d():this.zh.wva=ib;return 32}}Object(m.a)(Eb,"GrammarSettingsActor",null,[]);class fc extends Eb{constructor(ka,ib,Rb,tc,xc,hd,Fd){super(ka,ib,Rb,tc,cb.AFrameworkApplication_AppSettingsManager.ga);this.ob=xc;this.KIj=hd;this.Ia=Fd}oul(){let ka=parseInt(cb.AFrameworkApplication_AppSettingsManager.ga.La("Lcid")||"1033");if(this.ob.D5(this.ob.Ua)){var ib=this.ob.ud();
ib&&1===ib.length&&(ib=this.Ia.f_a(ib[0]),0<ib&&(ka=ib))}else this.ob.Ua.mb&&(ib=this.KIj.HCe(this.ob.Wj),0<ib&&(ka=ib));return ka}}Object(m.a)(fc,"EditorSettingsActor",Eb,[]);var Ec=a(278),Ya=a(488),Ub=a(357),rc=a(596),fd=a(421),Cd=a(302);class Jd{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb,Xb){this.cif=null;this.LLl=this.Vad=!1;this.xXm=(nc,Nc,yd)=>{this.cif=this.va.Ga;nc=this.pa.mg();if(!nc||!nc.length)return 16;for(const Ud of nc)if(!Ud||this.uc.Cd(Ud)||Ec.a.Ax(Ud.Xb))return 16;if(1===yd)return 32;
this.vxh(!1);return 32};this.AXm=(nc,Nc,yd)=>{nc=this.va.Ga;if(!nc||this.uc.Cd(nc))return 8;if(1===yd)return 32};this.zXm=(nc,Nc,yd,Ud,ie)=>{var Be;if(!this.Aa.dda)return 8;if(null===ie||void 0===ie||!ie.OriginalUrl)return Ob.a.J(508675585,822,10,"FormatBackgroundActor::handleSlidesPictureFromStockImages : Image Url is absent."),8;this.cif=this.va.Ga;Nc=this.pa.mg().filter(oe=>!!oe);if(Nc.every(oe=>this.uc.Cd(oe)))return Ob.a.J(508650910,822,10,"FormatBackgroundActor::handleSlidesPictureFromStockImages : SlideNode is blocked."),
8;if(null===Nc||void 0===Nc||!Nc.length)return Ob.a.J(508678344,822,10,"FormatBackgroundActor::handleSlidesPictureFromStockImages: selected slides are empty"),16;if(1===yd)return 32;yd=this.Mb.Fd(15,void 0,()=>{this.Ma.Wd();this.pa.Ti()});try{yd.rc(this.cif);yd.sc=nc;yd.XC[fd.a.S9a]=fd.a.MQc;for(const oe of Nc)if(oe.xze=ie.OriginalUrl,this.LLl){const rf=oe.oa(We.a.CQa,void 0),Vf=(null===(Be=ie.OriginalUrl.match(/\.([a-z]+)$/i))||void 0===Be?void 0:Be[1])||"",xg=this.$Gn(ie.OriginalUrl,"thumbnails/xlarge."+
Vf);this.Ewl(xg,oe.io,oe.ek,!1,Vf).then(qh=>{const k=oe.Qg(this.Rza.oI.Oa);void 0!=k&&(oe.setValue(We.a.CQa,qh),k.iL(Cd.a.nF),k.draw(Cd.a.nF,{},!1),oe.setValue(We.a.CQa,rf),qh=null===Ae.a||void 0===Ae.a?void 0:Ae.a.Vwc("FormatBackgroundPictureFromStockImagesUpload"),qh.length&&qh[0].TE("BGImageFromStockImageLocalDrawComplete",null===Ae.a||void 0===Ae.a?void 0:Ae.a.AA().toString()))}).catch(qh=>{Ob.a.J(507606749,822,15,"FormatBackgroundActor::handleSlidesPictureFromStockImages : "+qh.message);oe.setValue(We.a.CQa,
rf)})}}finally{return null===yd||void 0===yd?void 0:yd.dispose(),32}};this.vXm=(nc,Nc,yd)=>{var Ud;Nc=this.pa.mg();if(!Nc||!Nc.length)return Ob.a.J(509362200,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides are empty"),8;for(const ie of Nc)if(!ie||this.uc.Cd(ie))return Ob.a.J(509362199,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides is blocked"),8;if(!this.mOn(Nc))return Ob.a.J(509362198,822,50,"FormatBackgroundActor::handleSlidesBackgroundReset: The selected slide follow master background"),
8;if(1===yd)return 32;null===(Ud=Ae.a.Ab)||void 0===Ud?void 0:Ud.Ya("SlideCount",Nc.length.toString());yd=this.Mb.Fd(15,void 0,()=>{this.Ma.Wd();this.pa.Ti()});try{yd.rc(this.va.Ga);yd.sc=nc;for(const ie of Nc)ie.Ydc=!0}finally{yd&&yd.dispose()}return 32};this.uXm=(nc,Nc,yd)=>{Nc=this.va.Ga;const Ud=this.pa.Ae();if(!Ud||!Ud.length)return Ob.a.J(508045471,822,10,"FormatBackgroundActor::handleSlidesBackgroundApplyFromPictureThisSlide: no shape selected"),8;if(!Nc||this.uc.Cd(Nc))return Ob.a.J(508073822,
822,10,"FormatBackgroundActor::handleSlidesBackgroundApplyFromPictureThisSlide: current slide is blocked"),8;if(1===yd)return 32;yd=this.Mb.Fd(15,void 0,()=>{this.Ma.Wd();this.pa.Ti()});try{yd.rc(Nc),yd.sc=nc,Nc.YMe=Ud[0].get_shapeId()}finally{null===yd||void 0===yd?void 0:yd.dispose()}return 32};this.tXm=(nc,Nc,yd)=>{var Ud=this.va.Ga;Nc=this.pa.Ae();if(!Nc||!Nc.length)return Ob.a.J(508045470,822,10,"FormatBackgroundActor::handleSlidesBackgroundApplyFromPictureAllSlides: no shape selected"),8;if(!Ud||
this.uc.Cd(Ud))return 16;if(1===yd)return 32;yd=Ud.Xb;Ud=this.Rza.Qf;if(!Ud)return Ob.a.J(508073821,822,10,"FormatBackgroundActor::handleSlidesBackgroundApplyFromPictureThisSlide: Presentation Node is null"),8;const ie=this.Mb.Fd(15,void 0,()=>{this.Ma.Wd();this.pa.Ti()});try{ie.rc(Ud),ie.sc=nc,Ud.xec=Nc[0].get_shapeId(),Ud.Fec=yd}finally{null===ie||void 0===ie?void 0:ie.dispose()}return 32};this.ia=ka;this.Ma=ib;this.uc=Rb;this.pa=tc;this.Mb=xc;this.Rza=hd;this.va=Fd;this.nR=Td;this.PEa=na;this.YIj=
$a;this.ee=Fb;this.Aa=Xb;this.Vad=this.Aa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSlideBGImageInlineEnabled",!1)&&Ef.a("SetLocalBGInlineEnabled");this.LLl=this.Aa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSlideBGImageInlineEnabled",!1)&&Ef.a("StockImageInlineSlideBGEnabled")}Hb(){this.ia.sa(Pb.a.l$,Id.a.application,Object(K.a)(this,this.BXm,"handleSlidesSolidFill"),4);this.ia.sa(Pb.a.x7c,Id.a.application,this.AXm,4);this.ia.sa(Pb.a.w7c,Id.a.application,
this.xXm,4);this.ia.sa(Pb.a.Nyf,Id.a.application,this.zXm,4);this.ia.sa(Pb.a.v7c,Id.a.application,Object(K.a)(this,this.wXm,"handleSlidesFinalizePicture"),4);this.ia.sa(Pb.a.NOb,Id.a.application,Object(K.a)(this,this.WVm,"handleApplyAll"),4);this.ia.sa(Pb.a.Acd,Id.a.application,Object(K.a)(this,this.UWm,"handlePopulateFillMenu"),96);this.ia.sa(Pb.a.kIe,Id.a.application,Object(K.a)(this,this.HWm,"handleMoreFormatBackgroundColors"),96);this.ia.sa(Pb.a.cSc,Id.a.application,Object(K.a)(this,this.IWm,
"handleMoreFormatBackgroundColorsResponse"),4);this.ia.sa(Pb.a.POb,Id.a.application,this.vXm,4);this.Aa.MEe&&(this.ia.sa(Pb.a.IFd,Id.a.application,this.uXm,4),this.ia.sa(Pb.a.HFd,Id.a.application,this.tXm,4))}ve(){}UWm(ka,ib,Rb,tc,xc){tc=this.va.Ga;if(!tc||this.uc.Cd(tc))return 16;if(1===Rb)return 32;if(!xc)return Ob.a.J(512500616,822,10,"HandlePopulateFillMenu requires actionData"),8;Rb=tc.Oe;if(!Rb)return Ob.a.J(512500615,822,10,"HandlePopulateFillMenu failed to get theme information from slide"),
8;ka=this.Rza.Qf.mca;ib=Object.assign(new Ld.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});Array.add(ib.MenuSectionList,he.f(Rb,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors","3049223287",1));Array.add(ib.MenuSectionList,he.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors","3049223287",!1));Ef.a("BackgroundColorHighlightFix")&&(tc=Ub.a.parse(tc.cS),tc=pe.Box4ColorHelper.Lja(tc.QCa(),Rb),he.h(ib,tc,Rb));ka&&0<ka.length?
(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),Array.add(ib.MenuSectionList,he.c(ka,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors","1912773268",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));Array.add(ib.MenuSectionList,he.a("More Format Background Color","Color.Menu.Controls","3938657252",ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors",
"MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));xc.MenuItems=ib;return 32}BXm(ka,ib,Rb,tc,xc){ib=this.pa.mg();if(!ib||!ib.length)return 16;for(const hd of ib)if(!hd||this.uc.Cd(hd))return 16;if(1===Rb)return 32;Rb=Jd.qsb(xc);if(!Rb)return 8;Ae.a.Ab&&Ae.a.Ab.Ya("SlideCount",ib.length.toString());xc=this.Mb.Fd(15,void 0,()=>{this.Ma.Wd();this.pa.Ti()});try{xc.rc(this.va.Ga);xc.sc=ka;for(const hd of ib)hd.uzb=Rb}finally{xc&&xc.dispose()}return 32}$Gn(ka,
ib){return ka.replace(/\/([^/]+)(\.[a-z]+)$/i,`/${ib}`)}WVm(ka,ib,Rb){ib=this.va.Ga;if(!ib||this.uc.Cd(ib))return 16;if(1===Rb)return 32;Rb=ib.Xb;ib=this.Rza.Qf;if(!ib)return 8;const tc=this.Mb.Fd(15,void 0,()=>{this.Ma.Wd();this.pa.Ti()});try{tc.rc(ib),tc.sc=ka,ib.nzb=Rb}finally{tc&&tc.dispose()}return 32}h4m(){return this.ia.Bz(Pb.a.v7c)}mOn(ka){const ib=this.Rza.Qf;if(!ib)return Ob.a.J(509362197,822,10,"FormatBackgroundActor::shouldEnableResetBackground: Current presentation is null"),!1;for(const tc of ka)if((ka=
tc.cS)&&-1==ka.indexOf("/BgSource/ContentMaster")&&-1==ka.indexOf("/BgSource/MainMaster")){var Rb=ib.esl(tc.lj,tc.en);if(!Rb)return Ob.a.J(509362196,822,50,"FormatBackgroundActor::shouldEnableResetBackground: Slide master for current slide is null"),!0;Rb=Rb.cS;if(!Rb||!ka.match(Rb))return!0}return!1}wXm(ka,ib,Rb,tc,xc){ib=this.pa.mg();if(!ib||!ib.length)return 16;for(const Fd of ib){if(!Fd||!Fd.isConnected)return 16;if(this.Vad){const Td=Fd.gb(We.a.CQa);ib=xc.lzc;void 0!=ib?this.Ewl(ib,Fd.io,Fd.ek).then(na=>
{var $a,Fb;Fd.setValue(We.a.CQa,na);na=null===(Fb=null===($a=this.Rza)||void 0===$a?void 0:$a.oI)||void 0===Fb?void 0:Fb.Oa;void 0!=na&&($a=Fd.Qg(na),void 0!=$a&&$a&&($a.iL(Cd.a.nF),$a.draw(Cd.a.nF,{},!1),Fd.setValue(We.a.CQa,Td),this.h4m&&(Ae.a.Xj("FormatBackgroundFinalizePictureED",(new Date).toString()),Ae.a.Xj("FormatBackgroundFinalizePictureTickCount",Ae.a.AA().toString()))))}).catch(na=>{Fd.setValue(We.a.CQa,Td);Ob.a.J(512500611,822,10,`Unable to resize image blob: Error = ${na}`)}):Ob.a.J(507606726,
822,10,"Unable to get image data for set image inline")}}if(1===Rb)return 32;this.PEa.xde=new Date;const hd=Ae.a.Ab;this.nR.Wxh(xc,Fd=>{Ae.a.yJ(hd,()=>{this.yXm(Fd,ka)})},Fd=>{this.hLf(Fd.error)});this.va.Ga===this.cif&&(this.Ma.Wd(),this.pa.Ti());return 32}j_n(ka){if(ka)try{const ib=new URL(ka);if("blob:"===ib.protocol||"data:"===ib.protocol)return ka}catch(ib){throw Ob.a.J(507606724,810,10,`ContentBlockingIndicatorView::getMediaUrl URL conversion exception: ${ib}`),ib;}}Ewl(ka,ib,Rb,tc=!0,xc=""){return new Promise((hd,
Fd)=>{const Td=new Image,na=document.createElement("canvas"),$a=na.getContext("2d"),Fb=tc?ka.split(";")[0]:"image/"+xc,Xb=ib/Rb;tc||(Td.crossOrigin="anonymous");Ef.a("EnableBGImageCropToSlideAspectRatio")?Td.onload=function(){var nc=Td.width;const Nc=Td.height;let yd,Ud;nc/Nc>Xb?(yd=Nc*Xb,Ud=Nc):(yd=nc,Ud=nc/Xb);na.width=yd;na.height=Ud;$a.drawImage(Td,(nc-yd)/2,(Nc-Ud)/2,yd,Ud,0,0,yd,Ud);nc=na.toDataURL(Fb,1);hd(nc)}:Td.onload=function(){na.width=ib;na.height=Rb;$a.drawImage(Td,0,0,na.width,na.height);
const nc=na.toDataURL(Fb,1);hd(nc)};Td.onerror=function(nc){Ob.a.J(507609863,822,10,"Could not load image. isBase64: "+tc+". "+nc);Fd(Error("Could not load image. isBase64: "+tc+". "+nc))};tc?void 0!=this.j_n(ka)&&(Td.src=ka):Td.src=ka})}HWm(ka,ib,Rb,tc,xc){ka=this.va.Ga;if(!ka||this.uc.Cd(ka))return Ob.a.J(507605699,822,10,"HandleMoreFormatBackgroundColors: currentSlide is null"),16;if(this.Aa.mH&&Ef.a("MoreColorBackgroundForMultipleSlidesEnabled")?1>this.pa.mg().length:1!==this.pa.mg().length)return 16;
if(1===Rb)return this.ia.Qa(Pb.a.renderColorPicker,1,xc);Rb=Ub.a.parse(ka.cS);if(!Rb)return 8;xc=Rb.QCa();Rb=null;xc&&(Rb=pe.Box4ColorHelper.Dsa(xc));xc={};xc.currentColor=Rb;xc.handleCommand=Pb.a.cSc;return this.ia.Qa(Pb.a.renderColorPicker,2,xc)}IWm(ka,ib,Rb,tc,xc){if(1===Rb)return this.ia.Qa(Pb.a.l$,Rb,xc);if(!xc)return Ob.a.J(512500609,822,10,"HandleMoreFormatBackgroundColorsResponse: actionData is null"),16;ka=this.ia.Qa(Pb.a.l$,Rb,xc);32===ka&&this.ia.Qa(Pb.a.dsa,Rb,xc);return ka}vxh(ka){this.YIj?
rc.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.nR&&(this.nR.byb=1,this.nR.Cdk(ka))}yXm(ka,ib){this.PEa.qcd=new Date;(ka=ka.result)?this.Qwm(ka,ib):(ib=Object.assign(new Ya.a,{Code:94}),this.hLf(ib))}Qwm(ka,ib){const Rb=this.pa.mg(),tc=this.Mb.Fd(15);try{tc.rc(this.cif);tc.sc=ib;for(const xc of Rb)xc.zF=ka.ItemId}finally{tc&&tc.dispose()}if(ka=Ae.a.Ab)ka.actionName="FormatBackgroundPicture",ka.Ya("PictureUploadStart",Ae.a.Lf(this.PEa.xde)),ka.Ya("PictureUploadDurationMS",
(+this.PEa.qcd-+this.PEa.xde).toString())}hLf(ka){this.PEa.qcd=new Date;this.ee.SK(ka.Code,ib=>{ib.zD=1;ib.Z9a=ka.ExtraErrorParam;return!1})}static qsb(ka){return Ub.a.parse(ka.Color)}}Object(m.a)(Jd,"FormatBackgroundActor",null,[743]);var Rd=a(286),Me=a(253),lf=a(586),yf=a(252),ff=a(342);const jf=ka=>{let ib=ka.isBold?"b:1;":"";ib+=ka.isItalic?"i:1;":"";ib+=ka.isUnderline?"u:1;":"";ib+=ka.JA?"s:1;":"";ib+=ka.isSuperscript?"sup:1;":"";return ib+=ka.ZC?"sub:1;":""},Nf=(ka,ib,Rb)=>{let tc=null;for(var xc,
hd=Me.ParagraphReader.text(ka),Fd=0;ka.Za&&Fd<ka.Za.length;){var Td=ka.Za.ha(Fd),na=Td.cp;xc=Fd<ka.Za.length-1?ka.Za.ha(Fd+1).cp:Me.ParagraphReader.textLength(ka);if(-1!==ib&&xc<=ib)Fd++;else{if(-1!==Rb&&na>Rb)break;var $a="";Td.formatting?$a=jf(Td.formatting.cache):(Td=lf.c(ka.Za,Td.cp).Y9c)&&($a=jf(Td.cache));Td=na;-1!==ib&&(Td=Math.max(ib,na));na=xc;-1!==Rb&&(na=Math.min(Rb,xc));na=ra.a.substring(hd,Td,na);0<na.length&&(xc=document.createElement("span"),xc.setAttribute("style",$a),xc.innerText=
na,tc||(tc=document.createElement("p")),tc.appendChild(xc));Fd++}}if(tc&&Me.ParagraphReader.WV(ka)){ib=tc;Rb=ib.setAttribute;Fd=new yf.GraphIterator;Fd.set(ka);Fd.pc(11);Fd.ug(11);hd="";if(ka.gg.dv(Fd))switch(Fd=ka.gg.dv(Fd),ka=Me.ParagraphReader.P1b(ka),$a=Fd.bW,Fd.listType){case 0:switch(Fd.listStyle){case 1:hd="decimal";break;case 2:hd="loweralpha";break;case 3:hd="lowerroman";break;case 4:hd="upperalpha";break;case 5:hd="upperroman";break;default:hd="decimal"}hd=String.format("lt:{0};in:{1};li:{2}",
hd,ka,$a);break;case 1:switch(Fd.listStyle){case 1:hd="disc";break;case 2:hd="circle";break;case 3:hd="square";break;default:hd="disc"}hd=String.format("lt:{0};in:{1}",hd,ka)}Rb.call(ib,"style",hd)}return tc},og=ka=>{if(ka){var ib;(ib=Mb.a.instance.resolve("PowerPointWebEditor.Graph.ITableReader"))?ib=ib.NQ(ka):(Ob.a.J(512500561,822,10,"ImmersiveReader: TableReader is null."),ib=null);if(ib){ka=null;ib=ib.r_a();for(let Rb=0;Rb<ib.length;Rb++){const tc=Tg(Object(fe.a)(Rd.AParagraphNode,ib[Rb].zac));
ka=Ce(tc,ka)}return ka}ka=Array.isArray(ka.wI())?ka.wI():null;return Tg(ka&&0<ka.length?ka[0]:null)}return null},Tg=ka=>{let ib=null;for(;ka;){const Rb=Nf(ka,-1,-1);ib=Ce(Rb,ib);ka=Me.ParagraphReader.Ana(ka,!1,!0,!1)}return ib},Ce=(ka,ib)=>{ka&&(ib||(ib=document.createElement("div")),ib.appendChild(ka));return ib},vf=ka=>{const ib=Object.assign(new ff.a,{Source:6});Mb.a.instance.resolve("PowerPointWebEditor.IErrorHandler").Zr(ib,ka,Rb=>{Rb.zD=1;Rb.NDa=0;Rb.title=ResourceStrings.L_ImmersiveReaderErrorDialogTitle;
Rb.message=ResourceStrings.L_ImmersiveReaderErrorDialogMessage;return!1})};class Eg{constructor(ka,ib,Rb,tc,xc){this.pJl=!1;this.Iph="";if(!ka)throw Error.argumentNull("actionManager");if(!ib)throw Error.argumentNull("focusManager");if(!Rb)throw Error.argumentNull("pptSelectionManager");if(!xc)throw Error.argumentNull("appSettingsManager");this.ia=ka;this.Ma=ib;this.ob=Rb;const hd=new Date;tc("immersiveReader").then(()=>{this.pJl=!0;Ob.a.J(512500569,822,50,"ImmersiveReader: Loaded SDK successfully. Duration (ms): {0}",
+new Date-+hd)}).catch(Fd=>{const Td=+new Date-+hd;Ob.a.J(512500568,822,10,"ImmersiveReader: Failed to load SDK. Duration (ms): {0}, Exception: {1} ",Td,Fd.toString());const na=new Map;na.set("JSLoadDurationInMs",Td.toString());na.set("Exception",Fd.toString());Bb.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","JSLoadFailed",!1,!0,{extendedProperties:na})})}Hb(){this.ia.za(Pb.a.hNd,Id.a.view,Object(K.a)(this,this.AAl,"immersiveReaderHandler"));this.ia.za(Pb.a.ZDe,Id.a.view,Object(K.a)(this,
this.AAl,"immersiveReaderHandler"))}ve(){this.Ma.gd(Cc.a.sX).bindAction(ja.a.eb(Zc.a.g2c,ja.a.Ke|4),Pb.a.hNd)}KLm(ka){let ib="";for(ka=Object(fe.a)(Rd.AParagraphNode,ka.node);ka;){const Rb=Me.ParagraphReader.Ana(ka,!0,!0,!1);if(Rb)ka=Rb;else break}for(;ka;)ib+="\n"+Me.ParagraphReader.text(ka),ka=Me.ParagraphReader.Ana(ka,!1,!0,!1);return ib}Fum(){var ka=this.ob.mg();let ib=null;if(!ka)return null;for(const Rb of ka)if(ka=Rb.AQb())for(const tc of ka)ka=og(tc),ib=Ce(ka,ib);return ib}Eum(){let ka=null;
var ib=this.ob.Ua;if(!ib)return null;for(const xc of ib)if(xc)for(ib=0;ib<xc.length;ib++){var Rb=xc.ha(ib),tc=null;if(Rb.contextId===Id.a.outline||Rb.contextId===Id.a.ng)if(Me.ParagraphReader.me(Rb.node)){for(Rb=Object(fe.a)(Rd.AParagraphNode,Rb.node);Rb;)if(tc=Me.ParagraphReader.Ana(Rb,!0,!0,!1))Rb=tc;else break;tc=Tg(Rb)}else tc=og(Object(fe.a)(426,Rb.node));else Rb.contextId!==Id.a.endOfParagraph&&Me.ParagraphReader.me(Rb.node)&&(tc=Nf(Object(fe.a)(Rd.AParagraphNode,Rb.node),Rb.Va,Rb.Ib));ka=Ce(tc,
ka)}return ka}Hum(){let ka;return(ka=this.ob.Rt()?this.Fum():this.Eum())?ka.innerHTML:""}nUm(){let ka="";const ib=this.ob.Ua.mb;if(ib)for(let Rb=0;Rb<ib.length;Rb++){const tc=ib.ha(Rb),xc=tc.Va,hd=tc.Ib-xc;let Fd;if(Me.ParagraphReader.me(tc.node))switch(Fd=tc.node.characterData,tc.contextId){case Id.a.paragraph:ka+=Fd+"\r";break;case Id.a.textRange:0<hd&&(ka+=Fd.substr(xc,hd));break;case Id.a.endOfParagraph:ka+="\r";break;case Id.a.ng:ka+=this.KLm(tc)}}return ka}Ksj(){const ka=new XMLHttpRequest,
ib=Mb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;var Rb=Mb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").$l;Rb=String.format("{0}PodHandler.ashx?action=ImmersiveReaderAuthToken&PodSID={1}",Rb,ib);ka.open("GET",Rb,!0);const tc=Mc.a.create().toString();ka.setRequestHeader("X-UserSessionId",u.AFrameworkApplication.userSessionId);ka.setRequestHeader("X-CorrelationID",tc);ka.setRequestHeader("X-WacCluster",Mb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").rp);
let xc=null;const hd=new Map;ka.onreadystatechange=()=>{var Fd;if(4===ka.readyState)if(200===ka.status){var Td=+new Date-+xc;Ob.a.J(512500567,822,50,"ImmersiveReader: auth token received. Duration (ms): {0}",Td);hd.set("AuthTokenDurationInMs",Td.toString());Td=ka.responseText.replace('"',"");const Fb=new Date;var na=Ef.a("EnableSendingHTMLToIR")?[{["content"]:this.Iph,["mimeType"]:"text/html"}]:[{["content"]:this.Iph}];na={["title"]:ResourceStrings.L_ImmersiveReaderDialogTitle,["chunks"]:na};var {["launchAsync"]:$a}=
window.immersiveReader;if(Ef.a("EnableUseUpdatedImmersiveReaderVersion")){const {["v0_7_1"]:{["launchAsync"]:Xb,["CookiePolicy"]:nc}}=window.immersiveReader;na=Object.assign({},na);$a={["uiLang"]:null===(Fd=this.Fb)||void 0===Fd?void 0:Fd.appSettings.UICulture,["cookiePolicy"]:nc.Enable,["allowFullscreen"]:!0};Xb(Td,na,$a).then(Nc=>{Nc=Nc?Nc.sessionId:"";const yd=+new Date-+Fb,Ud=+new Date-+xc;Ob.a.J(508695828,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",
yd,Nc);hd.set("LaunchAsyncDurationInMs",yd.toString());hd.set("IRResponseSessionId",Nc);hd.set("UserPerceivedDurationInMs",Ud.toString());Bb.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",{extendedProperties:hd})}).catch(Nc=>{vf(ib);const yd=+new Date-+Fb,Ud=+new Date-+xc;Ob.a.J(508695827,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",yd,Nc);hd.set("LaunchAsyncDurationInMs",yd.toString());hd.set("ErrorJson",Nc.toString());hd.set("UserPerceivedDurationInMs",
Ud.toString());Bb.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,{extendedProperties:hd})})}else $a(Td,null,na,null).then(Xb=>{Xb=(Xb=Object(fe.a)(Object,Xb))?Xb.sessionId:"";const nc=+new Date-+Fb,Nc=+new Date-+xc;Ob.a.J(512500566,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",nc,Xb);hd.set("LaunchAsyncDurationInMs",nc.toString());hd.set("IRResponseSessionId",Xb);hd.set("UserPerceivedDurationInMs",
Nc.toString());Bb.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",{extendedProperties:hd})}).catch(Xb=>{vf(ib);const nc=+new Date-+Fb,Nc=+new Date-+xc;Ob.a.J(512500565,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",nc,Xb);hd.set("LaunchAsyncDurationInMs",nc.toString());hd.set("ErrorJson",Xb.toString());hd.set("UserPerceivedDurationInMs",Nc.toString());Bb.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,{extendedProperties:hd})})}else vf(ib),
Fd=+new Date-+xc,Ob.a.J(512500564,822,10,"ImmersiveReader: Request for auth token failed. Duration (ms): {0}, statusCode:{1}, CorrelationId: {2}",Fd,ka.status,tc),hd.set("CorrelationId",tc),hd.set("StatusCode",ka.status.toString()),hd.set("UserPerceivedDurationInMs",Fd.toString()),Bb.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","RequestForAuthTokenFailed",!1,!0,{extendedProperties:hd});else Ob.a.J(512500563,822,15,"Immersive Reader auth token request in progress. CorrelationId: {0}, Request Status: {1}",
tc,ka.status)};xc=new Date;Ob.a.J(512500562,822,50,"Begin request for ImmersiveReader auth token. StartTime: {0}, CorrelationId: {1}",xc.getTime(),tc);Rb=new Map;Rb.set("CorrelationId",tc);Rb.set("Info","RequestingAuthToken");Bb.Health.instance.recordKpiUsage("ImmersiveReaderTriggered",uc.b.SuccessBased,null,Rb);ka.send(null)}AAl(ka,ib,Rb){if(1===Rb||6===this.ia.vs){if(!this.pJl)return 8;this.Iph=Ef.a("EnableSendingHTMLToIR")?this.Hum():this.nUm();if(""===this.Iph)return 8}2===Rb&&this.Ksj();return 32}}
Object(m.a)(Eg,"ImmersiveReaderActor",null,[743]);var hf=a(1266),Qh=a(1175);class hi{constructor(ka){this.customData=null;this.eEa=ka}}Object(m.a)(hi,"PropertySetChangedState",null,[]);class Vg{static SAn(ka,ib,Rb){if(ka&&ib){var tc=new hi(ib),xc=(hd,Fd,Td)=>{Rb.RAn(hd,Fd,Td,tc)};ka=new Qh.a(ib,ka);ka.L4c=xc;ka.H5c=xc;ka.Gdd=xc;ka.eda()}}}Object(m.a)(Vg,"PropertySetChangedManager",null,[]);class uh{constructor(ka){this.Wkm=ka}RAn(ka,ib,Rb,tc){const xc=this.Wkm[ka.id.toString()];xc&&xc(ka,ib,Rb,tc)}}
Object(m.a)(uh,"PropertyChangedProcessor",null,[]);var Eh=a(1265),Bh=a(652),ag=a(273),zf=a(719),Df=a(98),$f=a(1116);class Kg{constructor(){this.Sdk=this.Plh=this.Ijh=null}}Object(m.a)(Kg,"ParagraphDialogResults",null,[]);class ug extends Ta.a{constructor(ka,ib,Rb){super(void 0,void 0,!0);this.qab=null;if(null===ka)throw Error.argumentNull("properties");this.sBb=ka.clone();this.apb=ka.clone();this.q8=Rb;this.ia=ib;this.Hdn=new M.a(Object(K.a)(this,this.JBm,"createPropertyChangedHandlers"))}Qoe(){this.uk=
"ParagraphDialog";const ka={};ka.bodyControls=this.gAf();this.Dq(ResourceStrings.L_ParagraphDialogTitle,Object(K.a)(this,this.Bqf,"dialogResultHandler"),ka)}Bqf(ka,ib){1===ka&&(this.fYn(ib),ka=Object.assign(new Kg,{Ijh:this.sBb,Plh:this.apb,Sdk:this.Hdn}),this.ia.Qa(Pb.a.Qhi,2,ka));this.dispose()}gAf(){this.qab=ug.VBf();const ka={};this.Yym(ka);this.Tym(ka);var ib=$f.a("Inch",3,0,56,.1);const Rb=$f.a("Character",2,0,56,.1);ib=[ib,Rb];this.czm(ka,ib);this.Vym(ka,ib);ib=[$f.a("Point",5,0,1584,1)];this.Wym(ka,
ib);this.Sym(ka,ib);this.Zym(ka);return ka}fYn(ka){this.$Wn(ka);this.AYn(ka);this.kXn(ka);this.lXn(ka);this.YWn(ka);this.PXn(ka)}JBm(){const ka={};ka[ag.a.qG.id.toString()]=Object(K.a)(this.q8,this.q8.N7m,"justificationChangedHandler");ka[ag.a.Jce.id.toString()]=Object(K.a)(this.q8,this.q8.JSl,"paraIndentLeftChangedHandler");ka[ag.a.Kce.id.toString()]=Object(K.a)(this.q8,this.q8.JSl,"paraIndentLeftChangedHandler");ka[ag.a.pFa.id.toString()]=Object(K.a)(this.q8,this.q8.mLk,"specialIndentChangedHandler");
ka[ag.a.Kpe.id.toString()]=Object(K.a)(this.q8,this.q8.mLk,"specialIndentChangedHandler");ka[ag.a.Lpe.id.toString()]=Object(K.a)(this.q8,this.q8.mLk,"specialIndentChangedHandler");ka[ag.a.Fz.id.toString()]=Object(K.a)(this.q8,this.q8.$8m,"lineSpacingChangedHandler");ka[ag.a.Pce.id.toString()]=Object(K.a)(this.q8,this.q8.LSl,"paraSpacingAfterChangedHandler");ka[ag.a.Oce.id.toString()]=Object(K.a)(this.q8,this.q8.LSl,"paraSpacingAfterChangedHandler");ka[ag.a.Rce.id.toString()]=Object(K.a)(this.q8,this.q8.NSl,
"paraSpacingBeforeChangedHandler");ka[ag.a.Qce.id.toString()]=Object(K.a)(this.q8,this.q8.NSl,"paraSpacingBeforeChangedHandler");return ka}Zym(ka){var ib=ug.fQm(this.sBb),Rb="multiple"===ib;ka.lineSpacingComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:$f.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,
Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["selectedKey"]:ib,["allowFreeForm"]:!1};ib=0;let tc=!1;this.sBb.Ra(ag.a.Fz)&&Rb&&(ib=this.sBb.gb(ag.a.Fz),0<=ib&&(tc=!0));Rb=[$f.a("none",0,0,9.99,.5)];Rb={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",
["validUnits"]:Rb,["numberFormatInfo"]:this.qab,["validReservedValues"]:[""]};Rb.value=tc?ib:"";ka.atSpinButtonProps=Rb}Sym(ka,ib){const Rb=ug.Ntl(this.sBb,ag.a.Pce,ag.a.Oce);ka.afterSpacingSpinButtonProps=ug.Cwh(Rb,{["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:zf.a.nzd(5),["validUnits"]:ib,["numberFormatInfo"]:this.qab,["validReservedValues"]:[""]})}Wym(ka,
ib){const Rb=ug.Ntl(this.sBb,ag.a.Rce,ag.a.Qce);ka.beforeSpacingSpinButtonProps=ug.Cwh(Rb,{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:zf.a.nzd(5),["validUnits"]:ib,["numberFormatInfo"]:this.qab,["validReservedValues"]:[""]})}Vym(ka,ib){const {ASl:Rb,BSl:tc}=ug.Uul(this.sBb,ag.a.Kce,ag.a.Jce,!1);ib={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:zf.a.nzd(tc),["validUnits"]:ib,["numberFormatInfo"]:this.qab,["validReservedValues"]:[""]};ib=ug.Cwh(Rb,ib);ka.beforeTextSpinButtonProps=ib}czm(ka,ib){const Rb={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,
["showLabel"]:!0,["options"]:$f.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["allowFreeForm"]:!1},tc=this.sBb.Ra(ag.a.pFa)?this.sBb.gb(ag.a.pFa):-1;ug.ODl(tc)?Rb.selectedKey=tc.toString():Rb.defaultSelectedKey="";ka.specialIndentationComboBoxProps=Rb;const {ASl:xc,BSl:hd}=ug.Uul(this.sBb,ag.a.Lpe,ag.a.Kpe,1!==tc&&2!==tc);ib={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:zf.a.nzd(hd),["validUnits"]:ib,["numberFormatInfo"]:this.qab};ib=ug.Cwh(xc,ib);ka.bySpinButtonProps=ib}Tym(ka){const ib={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:$f.b([Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,
Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified],["1","2","3","6"]),["allowFreeForm"]:!1},Rb=this.sBb.Ra(ag.a.qG)?this.sBb.gb(ag.a.qG):0;ug.$4m(Rb)?ib.selectedKey=Rb.toString():ib.defaultSelectedKey="";ka.alignmentComboBoxProps=ib}Yym(ka){ka.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};ka.indentationLabelProps=
{["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};ka.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"}}PXn(ka){if(ka.lineSpacingComboBoxProps){var ib=ka.lineSpacingComboBoxProps;const Rb=ib.selectedKey?ib.selectedKey.toString():"";ib=$f.c(Rb);"multiple"===Rb&&(ka=ka.atSpinButtonProps)&&(ib=parseFloat(ka.value.toString()));
this.apb.setValue(ag.a.Fz,ib);this.apb.setValue(ag.a.b1,2)}}YWn(ka){if(ka.afterSpacingSpinButtonProps){ka=ka.afterSpacingSpinButtonProps;var ib=zf.a.izd(ka.unitType.toString().toLowerCase());""!==ka.value.toString()&&(ib=4===ib?2:4,this.apb.setValue(ag.a.Pce,parseInt(ka.value.toString())),this.apb.setValue(ag.a.Oce,ib))}}lXn(ka){if(ka.beforeSpacingSpinButtonProps){ka=ka.beforeSpacingSpinButtonProps;var ib=zf.a.izd(ka.unitType.toString().toLowerCase());""!==ka.value.toString()&&(ib=4===ib?2:4,this.apb.setValue(ag.a.Rce,
parseInt(ka.value.toString())),this.apb.setValue(ag.a.Qce,ib))}}kXn(ka){if(ka.beforeTextSpinButtonProps){var ib=ka.beforeTextSpinButtonProps;ka=zf.a.izd(ib.unitType.toString().toLowerCase());if(""!==ib.value.toString()){ib=parseFloat(ib.value.toString());let Rb;2===ka?Rb=2:(Rb=1,ib=zf.a.lVk(ib,ka));this.apb.setValue(ag.a.Kce,ib);this.apb.setValue(ag.a.Jce,Rb)}}}AYn(ka){var ib=ka.bySpinButtonProps,Rb=ka.didChangeSpecialIndentationComboBoxValue;if(ib&&""!==ib.value.toString()||Rb)if(ka.specialIndentationComboBoxProps&&
(ka=ka.specialIndentationComboBoxProps,Rb=-1,ka.selectedKey&&(ka=ka.selectedKey.toString(),Rb=parseInt(ka)),ug.ODl(Rb)&&this.apb.setValue(ag.a.pFa,Rb)),ib){ka=parseFloat(ib.value.toString());ib=zf.a.izd(ib.unitType.toString().toLowerCase());if(0>ka||isNaN(ka))ka=0;2===ib?Rb=2:(Rb=1,ka=zf.a.lVk(ka,ib));this.apb.setValue(ag.a.Lpe,ka);this.apb.setValue(ag.a.Kpe,Rb)}}$Wn(ka){ka.alignmentComboBoxProps&&(ka=ka.alignmentComboBoxProps,ka.selectedKey&&(ka=parseInt(ka.selectedKey.toString()),0<=ka&&this.apb.setValue(ag.a.qG,
ka)))}static Ntl(ka,ib,Rb){if(ka.Ra(ib)&&ka.Ra(Rb)){Rb=ka.gb(Rb);if(2!==Rb&&4!==Rb)return Number.NaN;ka=ka.gb(ib);2===Rb&&(ka*=ug.dwn);return ka}return Number.NaN}static Cwh(ka,ib){ib.value=isNaN(ka)?"":ka;return ib}static VBf(){return{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}static Uul(ka,ib,Rb,tc){let xc=3;Ef.a("BySpinButtonDefaultvalueFix")&&tc?ib=0:ka.Ra(ib)&&ka.Ra(Rb)&&!tc?
(ib=ka.gb(ib),2===ka.gb(Rb)?xc=2:ib=zf.a.A$l(ib,xc)):ib=Number.NaN;return{ASl:ib,BSl:xc}}static $4m(ka){return 1===ka||2===ka||3===ka||6===ka}static ODl(ka){return 1===ka||2===ka||0===ka}static fQm(ka){if(ug.kYm(ka)){ka=ka.gb(ag.a.Fz);var ib="multiple";Df.a.cA(ka,1)?ib="1.00":Df.a.cA(ka,1.5)?ib="1.50":Df.a.cA(ka,2)&&(ib="2.00");return ib}}static kYm(ka){return ka.Ra(ag.a.Fz)&&ka.Ra(ag.a.b1)&&2===ka.gb(ag.a.b1)?!0:!1}}ug.dwn=72;Object(m.a)(ug,"ReactParagraphDialog",Ta.a,[]);class rh{constructor(ka,
ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb){this.xDj=[];this.ia=ka;this.pa=ib;this.kka=Rb;this.uha=tc;this.Mb=xc;this.Cj=hd;this.yNa=Fd;this.Ia=Td;this.q8=na;this.tha=$a;this.BMl=Fb}Hb(){this.ia.sa(Pb.a.fBb,Id.a.application,Object(K.a)(this,this.Ytn,"paragraphDialogHandler"),4);this.ia.sa(Pb.a.Qhi,Id.a.application,Object(K.a)(this,this.Fym,"commitParagraphDialogHandler"),4);this.ia.sa(Pb.a.qth,Id.a.view,Bh.a.Bta,96);this.ia.sa(Pb.a.ith,Id.a.view,Bh.a.Bta,96);this.ia.sa(Pb.a.wth,Id.a.view,Bh.a.Bta,96);this.ia.sa(Pb.a.xth,
Id.a.view,Bh.a.Bta,96);this.ia.sa(Pb.a.vth,Id.a.view,Bh.a.Bta,96);this.ia.sa(Pb.a.uth,Id.a.view,Bh.a.Bta,96);this.ia.sa(Pb.a.jth,Id.a.view,Bh.a.Bta,96);this.ia.sa(Pb.a.kth,Id.a.view,Bh.a.Bta,96);this.ia.za(Pb.a.jsh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.Mxh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.Djh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.Pxh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.Oxh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.ksh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.lsh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.hsh,Id.a.view,Bh.a.m5);
this.ia.za(Pb.a.Nxh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.gsh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.nsh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.msh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.Qxh,Id.a.view,Bh.a.m5);this.ia.za(Pb.a.QGg,Id.a.paragraph,Object(K.a)(this,this.URm,"getPropertiesForParagraphDialog"));this.ia.za(Pb.a.QGg,Id.a.view,this.tha);this.ia.ue(Pb.a.QGg,96)}ve(){}Ytn(ka,ib,Rb){if(this.pa.Rt()||this.pa.z5())return 16;ka=this.pa.ud();if(!this.Ia.j3(ka,!0).length&&!this.pa.coa())return 16;if(1===Rb)return 32;
this.BMl&&Ob.a.J(508360609,820,50,"Setting Paragraph properties from: {0}, IsDialogLancherButton: {1}",this.ia.vs,"PptRibbon.Home"===this.ia.Zgb);Array.clear(this.xDj);this.ia.Cb(Pb.a.QGg,2);return(Rb=hf.a.GCe(this.xDj))?((new ug(Rb,this.ia,this.q8)).Qoe(),32):16}Fym(ka,ib,Rb,tc,xc){if(1===Rb)return 32;if(!(xc&&xc.Ijh&&xc.Plh&&xc.Sdk))return 16;ib=this.pa.ys();this.q8.f1m();Rb=this.Mb.qe(15);try{Rb.rc(ib),Rb.sc=ka,xc.Ijh.equals(xc.Plh)||this.jym(),Vg.SAn(xc.Ijh,xc.Plh,new uh(xc.Sdk.value))}finally{Rb&&
Rb.dispose()}if(this.BMl){const {Ecm:hd,Fcm:Fd,Hcm:Td,Gcm:na,Dcm:$a,Icm:Fb}=this.q8.HTn();Ob.a.J(25040909,820,50,"IsJustificationChanged: {0}, IsLnSpacChanged: {1}, IsSpaceBeforeChanged: {2}, IsSpaceAfterChanged: {3}, IsIndentLeftChanged: {4}, IsSpecialIndentChanged: {5}",hd,Fd,Td,na,$a,Fb)}Ae.a.SP(!0,!0);return 32}URm(ka,ib,Rb){if(1===Rb)return 32;ib=ib.node;ka=new Eh.a;ka.setValue(ag.a.qG,this.Cj.BJ(ib));Rb=this.kka.jTa(ib);ka.setValue(ag.a.b1,Rb.unit);ka.setValue(ag.a.Fz,Rb.value);Rb=this.kka.MV(ib);
ka.setValue(ag.a.Qce,Rb.er.unit);ka.setValue(ag.a.Rce,Rb.er.value);ka.setValue(ag.a.Oce,Rb.dr.unit);ka.setValue(ag.a.Pce,Rb.dr.value);Rb=this.uha.u$(ib);ka.setValue(ag.a.Jce,1);ka.setValue(ag.a.Kce,Rb.mL);ib=this.yNa.lTa(ib);ka.setValue(ag.a.pFa,ib.specialIndentType);ka.setValue(ag.a.Kpe,ib.unit);ka.setValue(ag.a.Lpe,ib.value);this.xDj.push(ka);return 32}jym(){if(this.pa.pG()){var ka=this.pa.ud();ka=this.Ia.j3(ka);for(const ib of ka)ib.Csa()}}}Object(m.a)(rh,"ParagraphDialogActor",null,[743]);var gh;
(function(ka){ka[ka.unspecified=-1]="unspecified";ka[ka.none=0]="none";ka[ka.left=1]="left";ka[ka.center=2]="center";ka[ka.right=3]="right";ka[ka.inner=4]="inner";ka[ka.outer=5]="outer";ka[ka.both=6]="both";ka[ka.distribute=7]="distribute";ka[ka.margin=8]="margin";ka[ka.highKashida=9]="highKashida";ka[ka.lowKashida=10]="lowKashida";ka[ka.mediumKashida=11]="mediumKashida";ka[ka.numTab=12]="numTab";ka[ka.thaiDistribute=13]="thaiDistribute";ka[ka.start=14]="start";ka[ka.end=15]="end"})(gh||(gh={}));
Object(m.b)("Justification",gh);var Mh=a(850);class Rh{constructor(){this.value=this.unit=0}}Object(m.a)(Rh,"ParagraphSpacingCommandData",null,[]);class Ch{constructor(){this.Z5l=this.KSl=this.MSl=this.OSl=!1}}Object(m.a)(Ch,"PptPropertySetChangedState",null,[]);class ih{constructor(ka){this.Mpj=this.skj=this.Kpj=this.Lpj=this.nlj=this.Qkj=!1;this.Kag={};this.ia=ka;this.k1m()}N7m(ka,ib,Rb){Rb&&(ka=this.Kag[gh[Rb]],void 0!==ka&&null!==ka&&(this.ia.Cb(ka,2),this.Qkj=!0))}$8m(ka,ib,Rb){void 0!==Rb&&
null!==Rb&&(this.ia.Qa(Pb.a.mka,2,Rb),this.nlj=!0)}NSl(ka,ib,Rb,tc){void 0!==Rb&&null!==Rb&&(ka=ih.Ugh(tc),!ka.OSl&&null!==tc&&tc.eEa.Ra(ag.a.Qce)&&tc.eEa.Ra(ag.a.Rce)&&(ib=tc.eEa.gb(ag.a.Rce),tc=tc.eEa.gb(ag.a.Qce),ka.OSl=!0,this.ia.Qa(Pb.a.zUa,2,Object.assign(new Rh,{value:ib,unit:tc})),this.Lpj=!0))}LSl(ka,ib,Rb,tc){void 0!==Rb&&null!==Rb&&(ka=ih.Ugh(tc),!ka.MSl&&null!==tc&&tc.eEa.Ra(ag.a.Oce)&&tc.eEa.Ra(ag.a.Pce)&&(ib=tc.eEa.gb(ag.a.Pce),tc=tc.eEa.gb(ag.a.Oce),ka.MSl=!0,this.ia.Qa(Pb.a.yUa,2,
Object.assign(new Rh,{value:ib,unit:tc})),this.Kpj=!0))}JSl(ka,ib,Rb,tc){void 0!==Rb&&null!==Rb&&(ib=ih.Ugh(tc),!ib.KSl&&null!==tc&&tc.eEa.Ra(ag.a.Jce)&&tc.eEa.Ra(ag.a.Kce)&&(ka=tc.eEa.gb(ag.a.Kce),tc=tc.eEa.gb(ag.a.Jce),ib.KSl=!0,ib=new Mh.a,ib.unit=tc,ib.value=ka,this.ia.Qa(Pb.a.Dca,2,ib),this.skj=!0))}mLk(ka,ib,Rb,tc){void 0!==Rb&&null!==Rb&&(Rb=ih.Ugh(tc),!Rb.Z5l&&null!==tc&&tc.eEa.Ra(ag.a.Kpe)&&tc.eEa.Ra(ag.a.Lpe)&&(ib=0,tc.eEa.Ra(ag.a.pFa)&&(ib=tc.eEa.gb(ag.a.pFa)),ka=tc.eEa.gb(ag.a.Lpe),tc=
tc.eEa.gb(ag.a.Kpe),Rb.Z5l=!0,Rb=0,1===ib?Rb=Pb.a.Sbb:2===ib?Rb=Pb.a.Tbb:0===ib&&(Rb=Pb.a.Ubb),ib=new Mh.a,ib.unit=tc,ib.value=ka,this.ia.Qa(Rb,2,ib),this.Mpj=!0))}HTn(){return{Ecm:this.Qkj,Fcm:this.nlj,Hcm:this.Lpj,Gcm:this.Kpj,Dcm:this.skj,Icm:this.Mpj}}f1m(){this.Mpj=this.skj=this.Kpj=this.Lpj=this.nlj=this.Qkj=!1}k1m(){this.Kag.left=X.a.leftJustify;this.Kag.center=X.a.centerJustify;this.Kag.right=X.a.rightJustify;this.Kag.both=X.a.fullJustify}static Ugh(ka){ka.customData||(ka.customData=new Ch);
return ka.customData}}Object(m.a)(ih,"ParagraphLevelPropertyChangedHandlers",null,[1227]);var Mi=a(700),Oi=a(94),Ti=a(180),xi=a(48),uj=a(522),Ma=a(258),jc=a(264),Lc=a(288),gd=a(345);class Md{constructor(ka,ib){this.zBe=ka;this.Ji=ib}}Object(m.a)(Md,"DoNotCheckCritiqueTypeActionData",null,[]);var Kd=a(134);class ye{sLb(ka){return(ka=Object(fe.a)(Md,ka))?Object(Kd.a)(uj.a,ka.Ji):!1}bsh(ka,ib){if(ib=Object(fe.a)(Md,ib)){const Rb=ib.Ji;Rb&&(Rb.d8a(ka,ib.zBe),n.ULS.sendTraceTag(507843939,375,50,"Don't check this critique for whole doc finished, removed errors count: {0}",
ib.zBe))}}}Object(m.a)(ye,"DoNotCheckCritiqueTypeCallback",null,[1518]);var Se=a(78),Pe=a(263);class Qf extends Se.a{constructor(ka,ib,Rb,tc,xc,hd,Fd){super();this.JQj=null;this.init(ka);this.ym("WholePresentationOperation");this.J$a(u.AFrameworkApplication.vb,ib,Rb,tc,xc);this.j5d=0;this.SMl=Fd;this.TIl=hd;this.HTa=xc;this.XZf=ib;this.sLb()?1===this.behavior&&(this.Ds=32,this.Gba()):(this.Ds=8,this.Gba())}run(){0===this.j5d&&this.HSg();1===this.j5d&&this.XFg();2===this.j5d&&this.dZg();3===this.j5d&&
this.Fxf()}sLb(){return this.SMl.sLb(this.HTa)}bsh(){this.SMl.bsh(this.XZf,this.HTa)}HSg(){this.JQj=new Pe.GraphTransaction(3);this.JQj.rc(this.TIl.node);this.j5d=1}XFg(){this.yD||this.nec(this.TIl.RF);1!==this.tbb()&&(this.j5d=2)}dZg(){this.bsh();this.JQj.dispose();this.j5d=3}Fxf(){this.Gba()}}Object(m.a)(Qf,"WholePresentationOperation",Se.a,[]);var sg=a(269);class Bf{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb,Xb){this.Oyc=!1;this.ia=ka;this.iGl=ib;this.EH=Rb;this.Mb=tc;this.yYd=xc;this.va=hd;
this.Ia=Fd;this.Haa=Fb;this.KIj=Td;this.UJ=na;this.ob=Xb;this.Z6d=$a.Lwh;this.Kcn=$a.sKe;this.Acn=$a.odc;this.b2m()}get o6c(){return this.EH.T$a?this.yYd.instance:null}Hb(){this.ia.sa(Pb.a.queryLanguage,sg.a.application,Object(K.a)(this,this.queryLanguage,"queryLanguage"),96);this.ia.sa(Pb.a.jcd,sg.a.application,Object(K.a)(this,this.utn,"openPPTLanguageDialogView"),4);this.EH.Hkh&&this.ia.sa(X.a.TDe,Id.a.ng,Object(K.a)(this,this.TDe,"ignoreProofingError"),4);this.EH.IEe&&(this.Kcn?(this.ia.za(X.a.Gsc,
Id.a.paragraph,Object(K.a)(this,this.Mol,"doNotCheckThisCritiqueTypeForNode")),this.ia.za(X.a.Gsc,Id.a.section,Object(K.a)(this,this.Mol,"doNotCheckThisCritiqueTypeForNode")),this.ia.iT(X.a.Gsc,Id.a.ng,Object(K.a)(this,this.lFm,"doNotCheckThisCritiqueTypeForWholeDoc"),4),this.ia.sa(Pb.a.cBe,Id.a.ng,Object(K.a)(this,this.cBe,"doNotCheckThisCritiqueTypeForCurrentSlide"),4)):this.ia.sa(X.a.Gsc,Id.a.ng,Object(K.a)(this,this.cBe,"doNotCheckThisCritiqueTypeForCurrentSlide"),4));this.Acn&&(this.ia.sa(Pb.a.UKe,
sg.a.application,Object(K.a)(this,this.UKe,"queryHideProofingErrors"),100),this.ia.sa(Pb.a.fjh,sg.a.application,Object(K.a)(this,this.EUn,"toggleHideProofingErrors"),4))}ve(){}b2m(){this.Oyc=Bf.m8i;n.ULS.sendTraceTag(508694594,375,50,"Initialized with hide proofing errors: {0}",this.Oyc);this.Oyc&&this.jzl(this.Oyc)}UKe(ka,ib,Rb,tc,xc){if(1===Rb)return 32;if(!xc)return 8;xc[Mi.a.On]=this.Oyc;return 32}EUn(ka,ib,Rb,tc,xc){if(1===Rb)return 32;if(!(xc&&Mi.a.On in xc))return 8;this.Oyc=xc[Mi.a.On];Bf.m8i=
this.Oyc;this.jzl(this.Oyc);n.ULS.sendTraceTag(508694593,375,50,"User hide proofing errors: {0}",this.Oyc);return 32}Mol(ka,ib,Rb,tc,xc){if(!ib)return 8;ka=ib.node;if(!ka)return 8;if(ib.contextId===Id.a.section&&!ka.oa(gd.a.LEe,!1))return 32;if(ib.contextId===Id.a.paragraph&&ka.oa(gd.a.Ica,!1)){ib=Object(fe.a)(Md,xc);if(!ib)return 8;xc=ib.Ji;if(!xc)return 8;ib.zBe+=this.uYl(ka,xc.typeId,xc.lcid)}return 2}lFm(ka,ib,Rb,tc,xc){var hd=this.CNm();hd=new Md(0,hd);this.ia.Sh(Rb,Pb.a.cBe,tc,!1,xc,hd);Rb=
jc.a.create(Object(fe.a)(Lc.a,this.va.presentation));n.ULS.sendTraceTag(508694592,375,50,"User click do not check this critique for whole doc with behavior: {0}",tc);return new Qf(ka,ib,tc,xc,hd,Rb,new ye)}cBe(ka,ib,Rb,tc,xc){ka=Object(fe.a)(Md,xc);if(!ka)return 8;tc=ka.Ji;if(!tc)return 8;if(1===Rb)return 32;if(!ib.node)return 8;n.ULS.sendTraceTag(508694563,375,50,"Don't check this critique triggerred, language id: {0}, critique type id: {1}",tc.lcid,tc.typeId);ka.zBe+=this.JFn(tc.typeId,tc.lcid);
this.o6c&&this.o6c.qol(tc.lcid.toString(),tc.typeId);return 32}TDe(ka,ib,Rb){if(1===Rb)return 32;n.ULS.sendTraceTag(508694562,375,50,"Ignore proofing error triggerred");Rb=this.UJ.gKa(ib);if(!Rb||!Rb.Ji)return 8;ib=ib.node;var tc=this.va.Ga;if(!ib||!tc)return 8;tc=this.Mb.qe(Bf.IUm(Rb));Ef.a("FixDesignerCrashViaSetUndoActionId")&&(tc.sc=ka);try{tc.rc(ib),this.UJ.KBa(ib,[Rb],!0),ib.setValue(Ma.a.xdh,!0)}finally{tc&&tc.dispose()}Rb.Ji.d8a(ka,1);this.ob.d1a()||Ae.a.SP(!0,!1);n.ULS.sendTraceTag(508694561,
375,50,"Ignore proofing error action succeeded");return 32}jzl(ka){this.Haa.cNe=ka}CNm(){var ka=this.ob.Ua.mb;if(!ka)return null;ka=this.UJ.gKa(ka.Xa);if(!ka||!ka.Ji)return null;ka=Object(fe.a)(uj.a,ka.Ji);return!ka||0>=ka.lcid?null:ka}JFn(ka,ib){const Rb=new Date;if(!this.va.Ga)return 0;const tc=this.va.Ga.xj();if(!tc)return 0;let xc=0,hd=0;const Fd=this.Mb.qe(3);try{Fd.rc(this.va.Ga);for(const Td of tc)this.Ia.VH(Td,na=>{++hd;na.Ra(Ma.a.tq)&&na.oa(gd.a.Ica,!1)&&(xc+=this.uYl(na,ka,ib))})}finally{Fd&&
Fd.dispose()}n.ULS.sendTraceTag(508694560,375,50,"Remove proofing error take time(ms): {0}, scanned paragraph count: {1}, scanned shape count: {2}, removed errors count: {3}",+new Date-+Rb,hd,tc.length,xc);return xc}uYl(ka,ib,Rb){const tc=this.UJ.oG(ka,xc=>{xc=Object(fe.a)(uj.a,xc.Ji);return!!xc&&xc.typeId===ib&&xc.lcid===Rb});if(Oi.a.rb(tc))return 0;this.UJ.KBa(ka,tc);return tc.length}queryLanguage(ka,ib,Rb,tc,xc){xc.ooc=this.YPm();return 32}YPm(){let ka=u.AFrameworkApplication.lcid;if(this.ob.D5(this.ob.Ua)){var ib=
this.ob.ud();if(1<ib.length||1!==ib.length)return"";ib=this.Ia.f_a(ib[0]);0<ib&&(ka=ib)}else this.ob.Ua.mb&&(ib=this.KIj.HCe(this.ob.Wj),0<ib&&(ka=ib));return Ti.a.Ne(ka)?Ti.a.Ne(ka).displayName:Ti.a.Ne(u.AFrameworkApplication.lcid).displayName}m6m(){const ka=this.ob.ud();return 1===ka.length&&ka[0].G9c}utn(ka,ib,Rb){if(2!==Rb)return 32;this.Z6d&&this.ob.D5(this.ob.Ua)&&this.m6m()?(n.ULS.sendTraceTag(508694558,806,50,"Set proofing language on shape level."),this.iGl.value.getInstance(!0).PYc()):this.ob.Ua.mb&&
(n.ULS.sendTraceTag(508694557,806,50,"Set proofing language in text edit view."),this.iGl.value.getInstance(!1).PYc());return 32}static get m8i(){const ka=xi.a.get("PowerPointHideProofingErrors");return ka?"true"===ka.toLowerCase():!1}static set m8i(ka){xi.a.n_("PowerPointHideProofingErrors",ka.toString(),30)||n.ULS.sendTraceTag(508694556,375,10,"Failed to set cookie for hide proofing errors to {0}",ka.toString())}static IUm(ka){return 1===ka.Ji.proofingType?15:3}}Object(m.a)(Bf,"ProofingActor",null,
[743]);var Wf=a(45),Xf=a(680);class Xa{constructor(ka,ib){this.Oe=ka.toLowerCase();this.variant=ib}}Object(m.a)(Xa,"ThemeVariant",null,[]);var T=a(1537);class Ba{w7m(ka){return!Ba.DCe(Ba.l_n)||ka>Ba.i0k?!0:!1}static DCe(ka){return(ka=document.getElementById(ka))?ka:null}static kFl(){const ka=Mb.a.instance.Na("Common.ISystemInitiatedFeedback");null!=ka&&(n.ULS.sendTraceTag(508614482,813,50,"ThemeHelper::TriggerFpsForNewDefaultTheme Floodgate survey triggered"),ka.execute(ib=>{ib.logActivity("NewDefaultThemeActivity",
"EnablePPTONewThemeFloodgateSurvey")}))}}Ba.l_n="PptRibbon.Design.ThemeVariants-MaxSize";Ba.i0k=4;Object(m.a)(Ba,"ThemeHelper",null,[1248]);class kb{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb,Xb,nc,Nc){this.jnh=null;this.knh=0;this.nIl=this.inh=!1;this.eKl=null;this.Oze=new Xa("",0);this.jqh={["ThemesOfficeTheme"]:"62f939b6-93af-4db8-9c6b-d6c7dfdc589f",["ThemesIon"]:"b8441adb-2e43-4af7-b97a-bd870242c6a8",["ThemesAtlas"]:"5156b0e4-0eb1-49fe-a26b-15f6f698aec6",["ThemesMadison"]:"025cb5fb-2dd3-45ee-b6f0-cc461540eb19",
["ThemesOrganic"]:"28cdc826-8792-45c0-861b-85eb3adeda33",["ThemesFrame"]:"f226e7a2-7162-461c-9490-d27d9dc04e43",["ThemesIonBoardroom"]:"fc33163d-4339-46b1-8eed-24c834239d99",["ThemesMesh"]:"789ec3fe-34fd-429c-9918-760025e6c145",["ThemesRetrospect"]:"5f128b03-dcca-4eeb-ab3b-cf2899314a46",["ThemesSlice"]:"0507925b-6ac9-4358-8e18-c330545d08f8",["ThemesSavon"]:"1306e473-ed32-493b-a2d0-240a757edd34",["ThemesBanded"]:"98dff888-2449-4d28-977c-6306c017633e",["ThemesQuotable"]:"39ec5628-30ed-4578-acd8-9820edb8e15a",
["ThemesWoodType"]:"7acabc62-bf99-48cf-a9dc-4db89c7b13dc",["ThemesBasis"]:"5665723a-49ba-4b57-8411-a56f8f207965",["ThemesIntegral"]:"3577f8c9-a904-41d8-97d2-fd898f53f20e",["ThemesWisp"]:"7cb32d59-10c0-40dd-b7bd-2e94284a981c",["ThemesDividend"]:"9697a71b-4ab7-4a1a-bd5b-bb2d22835b57",["ThemesCelestial"]:"c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",["ThemesParallax"]:"3388167b-a2eb-4685-9635-1831d9aef8c4",["ThemesMetropolitan"]:"4c5440d6-04d2-4954-96cf-f251137069b2",["ThemesFacet"]:"c0c680cd-088a-49fc-a102-d699147f32b2",
["ThemesViewTheme"]:"ba0eb5a6-f2d4-4f82-977b-64adee4a2a69"};this.ia=ka;this.Ma=ib;this.uc=Rb;this.pa=xc;this.Mb=tc;this.$b=Fd;this.va=Td;this.oc=na;this.Ken=$a;this.W2d=Fb;this.AJl=Xb;this.ycn=nc;kb.N$h=Nc.Jc("NewThemeFloodgateSurveyDelayTime",3E5);nc&&(this.jqh.ThemesOfficeTheme2023="2e142a2c-cd16-42d6-873a-c26d2a0506fa",Nc.uda&&Nc.uda!=kb.Qvm||Wf.a.get_instance().$i(8,()=>{window.setTimeout(()=>{Ba.kFl()},kb.N$h)}))}Hb(){this.ia.sa(Pb.a.Mv,sg.a.application,Object(K.a)(this,this.Myl,"handleThemeChange"),
4);this.ia.sa(Pb.a.iYa,sg.a.application,Object(K.a)(this,this.Myl,"handleThemeChange"),4);this.ia.sa(Pb.a.XKe,sg.a.application,Object(K.a)(this,this.XKe,"queryMoreThemeGallery"),96);this.ia.sa(Pb.a.nth,sg.a.application,Object(K.a)(this,this.nth,"queryMoreVariantGallery"),96);this.ia.sa(Pb.a.vy,sg.a.application,Object(K.a)(this,this.vy,"queryThemes"),97);this.ia.sa(Pb.a.hdd,sg.a.application,Object(K.a)(this,this.hdd,"queryThemeVariants"),97);this.ia.sa(Pb.a.wJe,sg.a.application,Object(K.a)(this,this.wJe,
"populateVariantGallery"),96)}ve(){}vy(ka,ib,Rb,tc,xc){xc&&xc.Bw&&(ka=this.jqh[xc.Bw]===this.Avc().Oe,xc.Q5a.xg(ka));return 32}hdd(ka,ib,Rb,tc,xc){if(xc&&xc.Bw){ka=this.Avc();ib=ka.Oe;Rb=xc.Bw;try{var hd=Number.parseInvariant(Rb.substring(Rb.length-1,Rb.length))}catch(Fd){hd=0}xc=xc.Q5a;xc.xg(ka.variant===hd);hd=kb.otl(Rb,hd,ib);xc.Rwa=hd}return 32}XKe(ka,ib,Rb){if(ib.contextId!==Id.a.application)return 2;ka=this.pa.ys();var tc=this.Avc();ib=kb.$Ce(tc.Oe);tc=tc.variant-1;return this.uc.Cd(ka)?16:
1!==Rb||(n.ULS.sendTraceTag(512499972,801,50,"ThemeActor.QueryMoreThemeGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",ib,tc),this.oc.hl())?32:8}nth(ka,ib,Rb){if(ib.contextId!==Id.a.application)return 2;var tc=this.pa.ys();ib=this.Avc();ka=kb.$Ce(ib.Oe);ib=ib.variant-1;if(this.uc.Cd(tc))return 16;if(1===Rb)if(Rb=kb.CIf(this.Avc().Oe),tc=this.Ken.w7m(Rb),Rb&&tc)n.ULS.sendTraceTag(512499971,801,50,"ThemeActor.QueryMoreVariantGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",
ka,ib);else return 16;return 32}Myl(ka,ib,Rb,tc,xc){ib=this.pa.mg();tc=this.va.Ga;if(!tc||ka===Pb.a.iYa&&this.Avc()===this.Oze||this.uc.Cd(tc))return 16;if(1===Rb)return 32;Rb=Object(fe.a)(String,xc);if(null===Rb)return 8;xc=this.jqh[Rb];return ka===Pb.a.Mv?this.Zun(tc,xc,ib):ka===Pb.a.iYa?this.$un(tc,Rb,ib):8}Zun(ka,ib,Rb){var tc;if(!ka)return 16;Object(Ef.a)("AddThemeIdInChangeThemeContext)")&&Ae.a.Xj("ThemeId",ib);1>=this.Tll()||this.AJl&&Rb&&1<Rb.length?(this.r5h(ka,ib,0,!1,Rb),n.ULS.sendTraceTag(512499968,
801,50,"ThemeActor.PerformChangeTheme: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",kb.$Ce(ib),0,ka.Xb.sid)):(this.jnh=ib,this.knh=0,this.inh=!1,ka=new P.a,ka.gf=1,ka.m7(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,Object(K.a)(this,this.ujl,"changeThemeHandler")));this.ycn&&this.jqh.ThemesOfficeTheme2023==ib&&window.setTimeout(()=>{Ba.kFl()},kb.N$h);(null===(tc=u.AFrameworkApplication.ga)||void 0===tc?0:tc.getBooleanAppSetting("SlideLayoutIconsOptimizationsEnabled"))&&
this.fUl();return 32}fUl(){const ka=new Wa.a(0,1,0,()=>{this.ia.Qa(Pb.a.auh,2,null)},223);u.AFrameworkApplication.je.Qb(ka)}$un(ka,ib,Rb){var tc;if(!ka)return 16;const xc=this.Avc();let hd;try{if(hd=Number.parseInvariant(ib.substring(7,ib.length))-1,0>hd||hd>kb.CIf(xc.Oe))hd=-1}catch(Fd){hd=-1}1>=this.Tll()||Rb&&1<Rb.length?(this.r5h(ka,xc.Oe,hd,!0,Rb),n.ULS.sendTraceTag(512499939,801,50,"ThemeActor.PerformChangeVariant: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",kb.$Ce(xc.Oe),hd,ka.Xb.sid)):
(this.jnh=xc.Oe,this.knh=hd,this.inh=!0,ka=new P.a,ka.gf=1,ka.m7(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,Object(K.a)(this,this.ujl,"changeThemeHandler")));(null===(tc=u.AFrameworkApplication.ga)||void 0===tc?0:tc.getBooleanAppSetting("SlideLayoutIconsOptimizationsEnabled"))&&this.fUl();return 32}Avc(){let ka=null;var ib=this.va.Ga;if(ib){ib=ib.lj;const tc=this.oc.KL();if(tc&&ib)for(var Rb of tc)if(Rb.Id===ib){ka=Rb;break}}if(!ka)return this.nIl?this.eKl:this.Oze;
if(Object(Ef.a)("EnableNonEmptyGuidFixForThemeActor")){if(!ka.ThemeFamilyId||kb.$Ce(ka.ThemeFamilyId)===kb.Iil)return this.Oze}else if(!ka.ThemeFamilyId||ka.ThemeFamilyId===kb.Lvm)return this.Oze;Rb="5156b0e4-0eb1-49fe-a26b-15f6f698aec6"===ka.ThemeFamilyId||"025cb5fb-2dd3-45ee-b6f0-cc461540eb19"===ka.ThemeFamilyId;return!this.W2d&&Rb?this.Oze:new Xa(ka.ThemeFamilyId,ka.VariantIndex+1)}Tll(){const ka=this.oc.KL();let ib=0;if(ka)for(const Rb of ka)Rb.InContent&&(ib+=1);return ib}ujl(ka){const ib=this.va.Ga;
if(ib){var Rb=this.jnh,tc=this.knh,xc=this.inh;this.jnh=null;this.knh=-1;this.inh=!1;1===ka&&(this.r5h(ib,Rb,tc,xc,null),n.ULS.sendTraceTag(512499936,801,50,"ThemeActor.ChangeThemeHandler: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",kb.$Ce(Rb),tc,ib.Xb.sid))}}r5h(ka,ib,Rb,tc,xc){this.eKl=(this.nIl=tc)?new Xa(ib,0):this.Oze;var hd=Object(Ef.a)("ThemeRemoveSelectionFocusPostOB");const Fd=()=>{this.Ma.Wd();this.pa.Ti()};hd=this.Mb.Fd(15,void 0,hd?void 0:Fd,hd?Fd:void 0,!0);try{if(hd.rc(ka),hd.sc=
tc?Pb.a.iYa:Pb.a.Mv,this.AJl&&xc)for(const Td of xc)Td.setValue(We.a.JZg,ib),Td.setValue(We.a.yda,Rb),Td.setValue(We.a.Pgl,1<xc.length);else ka.setValue(We.a.JZg,ib),ka.setValue(We.a.yda,Rb)}finally{hd&&hd.dispose()}this.uc.boc(this.$b.Qf,ka,"ChangeTheme")}wJe(ka,ib,Rb,tc,xc){if(1===Rb)return 32;ka=Math.max(kb.CIf(this.Avc().Oe),4);ib=this.Avc().Oe;xc.MenuItems=kb.fSm(ka,ib);return 32}static CIf(ka){for(let ib=0;ib<T.a.Iec.length;++ib)if(T.a.Iec[ib].Ofh===ka)return T.a.Iec[ib].i0k;return 0}static $Ce(ka){for(let ib=
0;ib<T.a.Iec.length;++ib)if(T.a.Iec[ib].Ofh===ka)return T.a.Iec[ib].W8l;return kb.Iil}static vIm(ka){let ib="";for(let Rb=0;Rb<T.a.Iec.length;++Rb)T.a.Iec[Rb].Ofh===ka&&(ib=T.a.Iec[Rb].W8l.replace(" ",""));return ib}static fSm(ka,ib){const Rb=Object.assign(new Ld.a,{Id:"PptRibbon.Design.ThemeVariants.Anchor.Menu",MenuSectionList:[]});var tc=Object.assign(new eg.a,{Id:"PptRibbon.Design.ThemeVariants.MenuSection",DisplayMode:"Size85by48",ControlList:[]});Array.add(Rb.MenuSectionList,tc);const xc=Object.assign(new Xf.a,
{Id:"PptRibbon.Design.ThemeVariants.Gallery",ExternalId:"MoreVariantsSection",ExternalGalleryId:"MoreVariantsGallery",Type:4,Width:4,ElementDimensions:"Size85by48",GalleryItems:[]});Array.add(tc.ControlList,xc);for(tc=1;tc<=ka;++tc)Array.add(xc.GalleryItems,kb.otl("Variant"+tc,tc,ib));return Rb}static otl(ka,ib,Rb){Rb=!kb.CIf(Rb)||ib>kb.CIf(Rb)?"EmptyVariantsGallery_85x48x8":String.format("ThemeVariantGallery{0}{1}_85x48x24",kb.vIm(Rb),ib);return Object.assign(new Qd.a,{Id:ka,ExternalId:ka,Icon:Rb,
Alt:String.format(ResourceStrings.L_ThemeVariantAlt,ib),PreviewIconStyle:{root:{width:"49px",height:"28px",margin:"-2px"}},FullIconStyle:{root:{width:"85px",height:"48px"}},Command:"2759977169",QueryCommand:"1425701611"})}}kb.Lvm="00000000-0000-0000-0000-000000000000";kb.Iil="Unsupported Theme";kb.Qvm="blankNew";kb.N$h=3E5;Object(m.a)(kb,"ThemeActor",null,[743]);class Ab{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb){this.ia=ka;this.$b=ib;this.va=Rb;this.pa=xc;this.Ma=hd;this.Mb=tc;this.bE=Fd;this.uc=
Td;this.KJl=na.UCl;this.eu=na.mH;this.e3d=na.dDl;this.Ldg=$a.Yp(xb.a.iJe);this.xb=Fb}Hb(){this.e3d?(this.KJl?(this.ia.sa(Pb.a.hk,Id.a.application,Object(K.a)(this,this.bNn,"setSlidesTransitionGalleryExceptExisting"),5),this.ia.sa(Pb.a.xk,Id.a.application,Object(K.a)(this,this.QBn,"querySlidesTransitionGalleryExceptExisting"),97),this.ia.sa(Pb.a.b7a,Id.a.application,Object(K.a)(this,this.cNn,"setSlidesTransitionGalleryExisting"),5),this.ia.sa(Pb.a.Rvb,Id.a.application,Object(K.a)(this,this.dNn,"setSlidesTransitionGalleryExistingInMenu"),
5),this.ia.sa(Pb.a.T5a,Id.a.application,Object(K.a)(this,this.RBn,"querySlidesTransitionGalleryExisting"),97),this.ia.sa(Pb.a.eub,Id.a.application,Object(K.a)(this,this.SBn,"querySlidesTransitionGalleryExistingInMenu"),97)):(this.ia.sa(Pb.a.hk,Id.a.application,Object(K.a)(this,this.KCk,"setSlidesTransitionGallery"),5),this.ia.sa(Pb.a.xk,Id.a.application,Object(K.a)(this,this.Nek,"querySlidesTransitionGallery"),97),this.ia.sa(Pb.a.b7a,Id.a.application,Object(K.a)(this,this.KCk,"setSlidesTransitionGallery"),
5),this.ia.sa(Pb.a.Rvb,Id.a.application,Object(K.a)(this,this.KCk,"setSlidesTransitionGallery"),5),this.ia.sa(Pb.a.T5a,Id.a.application,Object(K.a)(this,this.Nek,"querySlidesTransitionGallery"),97),this.ia.sa(Pb.a.eub,Id.a.application,Object(K.a)(this,this.Nek,"querySlidesTransitionGallery"),97)),this.ia.sa(Pb.a.oDb,Id.a.application,Object(K.a)(this,this.aNn,"setSlidesTransitionEffectOption"),5),this.ia.sa(Pb.a.zie,Id.a.application,Object(K.a)(this,this.OBn,"querySlidesTransitionEffectOption"),97),
this.ia.sa(Pb.a.l4b,Id.a.application,Object(K.a)(this,this.PBn,"querySlidesTransitionEffectOptionsAnchor"),100),this.ia.sa(Pb.a.XRc,Id.a.application,Object(K.a)(this,this.Dwn,"populateSlidesTransitionEffectOptions"),96),this.ia.sa(Pb.a.CPa,Id.a.application,Object(K.a)(this,this.NBn,"querySlidesTransitionDuration"),97),this.ia.sa(Pb.a.Vbb,Id.a.application,Object(K.a)(this,this.$Mn,"setSlidesTransitionDuration"),5)):(this.KJl?(this.ia.sa(Pb.a.hk,Id.a.application,Object(K.a)(this,this.tNn,"setTransitionGalleryExceptExisting"),
5),this.ia.sa(Pb.a.xk,Id.a.application,Object(K.a)(this,this.ZBn,"queryTransitionGalleryExceptExisting"),97),this.ia.sa(Pb.a.b7a,Id.a.application,Object(K.a)(this,this.uNn,"setTransitionGalleryExisting"),5),this.ia.sa(Pb.a.Rvb,Id.a.application,Object(K.a)(this,this.vNn,"setTransitionGalleryExistingInMenu"),5),this.ia.sa(Pb.a.T5a,Id.a.application,Object(K.a)(this,this.T5a,"queryTransitionGalleryExisting"),97),this.ia.sa(Pb.a.eub,Id.a.application,Object(K.a)(this,this.eub,"queryTransitionGalleryExistingInMenu"),
97)):(this.ia.sa(Pb.a.hk,Id.a.application,Object(K.a)(this,this.rDk,"setTransitionGallery"),5),this.ia.sa(Pb.a.xk,Id.a.application,Object(K.a)(this,this.xk,"queryTransitionGallery"),97),this.ia.sa(Pb.a.b7a,Id.a.application,Object(K.a)(this,this.rDk,"setTransitionGallery"),5),this.ia.sa(Pb.a.Rvb,Id.a.application,Object(K.a)(this,this.rDk,"setTransitionGallery"),5),this.ia.sa(Pb.a.T5a,Id.a.application,Object(K.a)(this,this.xk,"queryTransitionGallery"),97),this.ia.sa(Pb.a.eub,Id.a.application,Object(K.a)(this,
this.xk,"queryTransitionGallery"),97)),this.ia.sa(Pb.a.oDb,Id.a.application,Object(K.a)(this,this.sNn,"setTransitionEffectOption"),5),this.ia.sa(Pb.a.zie,Id.a.application,Object(K.a)(this,this.YBn,"queryTransitionEffectOption"),97),this.ia.sa(Pb.a.l4b,Id.a.application,Object(K.a)(this,this.l4b,"queryTransitionEffectOptionsAnchor"),100),this.ia.sa(Pb.a.XRc,Id.a.application,Object(K.a)(this,this.XRc,"populateTransitionEffectOptions"),96),this.ia.sa(Pb.a.CPa,Id.a.application,Object(K.a)(this,this.CPa,
"queryTransitionDuration"),97),this.ia.sa(Pb.a.Vbb,Id.a.application,Object(K.a)(this,this.Vbb,"setTransitionDuration"),5));this.ia.sa(Pb.a.Qvb,Id.a.application,Object(K.a)(this,this.Qvb,"setTransitionApplyAll"),4);this.ia.sa(Pb.a.Cdc,Id.a.application,Object(K.a)(this,this.Cdc,"queryTransitionApplyAll"),96)}ve(){}XRc(ka,ib,Rb,tc,xc){if(this.eu&&1!==this.pa.mg().length)return 16;if(1===Rb)return 32;ka=(ka=this.va.Ga)?ka.xA:null;if(!ka)return 16;if(!xc)return 8;ka=this.bE.bDe(ka);ka.next&&(xc.MenuItems=
this.hil(ka));return 32}xk(ka,ib,Rb,tc,xc){if(!xc)return 8;ka=xc.queryResult;xc=xc.SourceControlId;ib=this.bE.nEa(xc);if(!ib)return 8;ka.SJa=Ab.KHi(ib.Ef,ib.tf,this.Ldg);ib=this.va.Ga;if(!ib)return 16;1===Rb&&((Rb=ib.xA)?(Rb=this.bE.z8c(Rb),ka.Dka(!Rb&&"TransitionExisting"===xc||Rb===xc)):ka.Dka("TransitionNone"===xc));return 32}ZBn(ka,ib,Rb,tc,xc){if(!xc||ka!==Pb.a.xk)return 8;ka=xc.queryResult;xc=xc.SourceControlId;ib=this.bE.nEa(xc);if(!ib)return 8;tc=ib.Ef.split("_")[1]+"_24";ib=Ab.G7c(xc,xc,
tc,"2024601249","149145197",ib.tf,ib.tf);ka.Rwa=ib;ib=this.va.Ga;if(!ib)return 16;1===Rb&&((Rb=ib.xA)?(Rb=this.bE.z8c(Rb),ka.Dka(Rb===xc)):ka.Dka("TransitionNone"===xc));return 32}T5a(ka,ib,Rb,tc,xc){if(!xc||ka!==Pb.a.T5a)return 8;ka=xc.queryResult;xc=xc.SourceControlId;if(!xc||"TransitionExisting"!==xc)return 16;ib=this.bE.nEa(xc);if(!ib)return 8;tc=ib.Ef.split("_")[1]+"_24";ib=Ab.G7c(xc,xc,tc,"3752636652","3476251476",ib.tf,ib.tf);ka.Rwa=ib;ib=this.va.Ga;if(!ib)return 16;if(1===Rb&&(Rb=ib.xA)){Rb=
this.bE.z8c(Rb);ib=this.bE.vlh(Rb,this.bE.DCe());if(Rb&&!ib){tc=this.bE.nEa(Rb);if(!tc)return 8;const hd=tc.Ef.split("_")[1]+"_24";xc=Ab.G7c(xc,xc,hd,"3752636652","3476251476",tc.tf,tc.tf);ka.Rwa=xc}ka.Dka(!Rb||!!Rb&&!ib)}return 32}eub(ka,ib,Rb,tc,xc){if(!xc||ka!==Pb.a.eub)return 8;ka=xc.queryResult;xc=xc.SourceControlId;if(!xc||"TransitionExistingInMenu"!==xc)return 16;ib=this.bE.nEa(xc);if(!ib)return 8;tc=ib.Ef.split("_")[1]+"_24";xc=Ab.G7c(xc,xc,tc,"4036532528","2831233208",ib.tf,ib.tf);ka.Rwa=
xc;xc=this.va.Ga;if(!xc)return 16;1===Rb&&(Rb=xc.xA)&&(Rb=this.bE.z8c(Rb),ka.Dka(!Rb));return 32}l4b(ka,ib,Rb){ka=this.va.Ga;if(!ka)return 16;ka=this.bE.bDe(ka.xA);return!ka||!ka.next||this.eu&&1!==this.pa.mg().length?16:1===Rb?32:8}rDk(ka,ib,Rb,tc,xc){if(!xc)return 8;ib=xc.SourceControlId;xc=ka===Pb.a.b7a||ka===Pb.a.Rvb;tc=this.va.Ga;if(!tc||this.uc.Cd(tc)||this.eu&&1!==this.pa.mg().length)return 16;var hd=tc.xA;const Fd=!!this.bE.y8c(hd);if(xc&&(!hd||Fd))return 16;if(1===Rb)return 32;hd=this.bE.nEa(ib);
if(!hd)return 8;if(!xc&&2===Rb&&ib){Ae.a.Xj("SlideCount","1");Rb=this.Mb.Fd(15,void 0,()=>{this.pa.Rj();this.Ma.Wd()});try{Rb.rc(tc),Rb.sc=ka,tc.xA=hd.wf}finally{Rb&&Rb.dispose()}n.ULS.sendTraceTag(512499935,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",ib,hd.next||"null",tc.Xb.sid)}return 32}tNn(ka,ib,Rb,tc,xc){if(!xc)return 8;ib=xc.SourceControlId;tc=this.va.Ga;if(!tc)return 16;if(ka!==Pb.a.hk)return 8;if(this.uc.Cd(tc)||
this.eu&&1!==this.pa.mg().length)return 16;if(1===Rb)return 32;xc=this.bE.nEa(ib);if(!xc)return 8;if(2===Rb&&ib){Ae.a.Xj("SlideCount","1");Rb=this.Mb.Fd(15,void 0,()=>{this.pa.Rj();this.Ma.Wd()});try{Rb.rc(tc),Rb.sc=ka,tc.xA=xc.wf}finally{Rb&&Rb.dispose()}n.ULS.sendTraceTag(512499934,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",ib,xc.next||"null",tc.Xb.sid)}return 32}uNn(ka,ib,Rb,tc,xc){if(!xc)return 8;ib=this.va.Ga;if(!ib)return 16;
if(ka!==Pb.a.b7a)return 8;if(this.eu&&1!==this.pa.mg().length)return 16;if(1!==Rb)return 8;ka=ib.xA;Rb=!!this.bE.y8c(ka);ib=this.bE.bDe(ka);ib=this.bE.vlh(ib?ib.parent:null,this.bE.DCe());return ka&&!Rb||!ib?32:16}vNn(ka,ib,Rb,tc,xc){if(!xc)return 8;ib=this.va.Ga;if(!ib)return 16;if(ka!==Pb.a.Rvb)return 8;if(this.eu&&1!==this.pa.mg().length)return 16;if(1!==Rb)return 8;ka=ib.xA;Rb=!!this.bE.y8c(ka);return!ka||Rb?16:32}Qvb(ka,ib,Rb){ib=this.va.Ga;if(!ib||this.uc.Cd(ib)||this.eu&&1!==this.pa.mg().length)return 16;
if(1===Rb)return 32;Ae.a.Xj("SlideCount","1");Rb=this.$b.Qf;const tc=this.Mb.Fd(15,void 0,()=>{this.pa.Rj();this.Ma.Wd()});try{tc.rc(Rb),tc.sc=ka,Rb.ozb=ib.Xb}finally{tc&&tc.dispose()}n.ULS.sendTraceTag(512499933,801,50,"TransitionActor: Command=SetTransitionApplyAll");return 32}Cdc(ka,ib,Rb,tc,xc){ka=this.va.Ga?!0:!1;if(!xc)return 8;xc=xc.queryResult;xc.SJa=Ab.KHi("pegal_TransitionNewsFlash_32x32x32",ResourceStrings.L_TransitionApplyAll,this.Ldg);xc.Dka(ka);return ka?32:16}sNn(ka,ib,Rb,tc,xc){if(!xc)return 8;
ib=xc.MenuItemId;if(this.eu&&1!==this.pa.mg().length)return 16;if(1===Rb)return 32;Rb=this.va.Ga;if(!Rb||this.uc.Cd(Rb))return 16;tc=Rb?Rb.xA:null;xc=this.bE.nEa(ib);if(!tc||!xc||!xc.wf)return 16;tc.TransitionType=xc.wf.TransitionType;tc.Direction=xc.wf.Direction;tc.Duration=xc.wf.Duration;Ae.a.Xj("SlideCount","1");const hd=this.Mb.Fd(15,void 0,()=>{this.pa.Rj();this.Ma.Wd()});try{hd.rc(Rb),hd.sc=ka,Rb.xA=tc}finally{hd&&hd.dispose()}n.ULS.sendTraceTag(512499932,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",
xc.parent,ib,Rb.Xb.sid);return 32}YBn(ka,ib,Rb,tc,xc){if(!xc)return 8;ka=xc.queryResult;xc=xc.MenuItemId;ib=this.va.Ga;if(!ib)return 16;1===Rb&&ka.xg(this.bE.y8c(ib.xA)===xc);return 32}CPa(ka,ib,Rb,tc,xc){ka=this.va.Ga;if(!ka)return 16;if(!xc)return 8;ka=ka.xA;if(xc=xc.queryResult)xc.rda=ka?(ka.Duration/1E3).toString():"0";return 32}Vbb(ka,ib,Rb,tc,xc){ib=this.va.Ga;if(!ib||this.uc.Cd(ib))return 16;if(!xc)return 8;if(this.eu&&1!==this.pa.mg().length)return 16;tc=Math.floor(1E3*xc.Number);xc=ib.xA;
if(!xc)return 16;Ae.a.Ab&&(Ae.a.Ab.actionName="SetTransitionDuration");if(1===Rb)return"TransitionNone"===this.bE.z8c(xc)?16:32;if(2===Rb){xc.Duration=tc;const hd=this.Ma.currentScope;Ae.a.Xj("SlideCount","1");Rb=this.Mb.Fd(15,void 0,()=>{this.pa.Rj();!hd||hd.name!==Cc.a.kh&&hd.name!==Cc.a.jL||this.Ma.Wd()});try{Rb.rc(ib),Rb.sc=ka,ib.xA=xc}finally{Rb&&Rb.dispose()}}return 32}Dwn(ka,ib,Rb,tc,xc){if(1===Rb)return 32;if(!xc)return 8;ib=this.pa.mg();if(!ib||!ib.length)return 16;ka=ib[0].xA;if(!ka)return 16;
ka=this.bE.bDe(ka);if(1<ib.length)for(const hd of ib){ib=hd.xA;if(!ib)return 16;ib=this.bE.bDe(ib);if(ka.parent!==ib.parent)return 16}ka.next&&(xc.MenuItems=this.hil(ka));return 32}Nek(ka,ib,Rb,tc,xc){if(!xc)return 8;ka=xc.queryResult;xc=xc.SourceControlId;ib=this.bE.nEa(xc);if(!ib)return 8;ka.SJa=Ab.KHi(ib.Ef,ib.tf,this.Ldg);ib=this.pa.mg();if(!ib||!ib.length)return 16;1===Rb&&(Rb="",({x8b:Rb}=this.E6c(ib)).returnValue&&ka.Dka(!Rb&&"TransitionExisting"===xc||Rb===xc));return 32}QBn(ka,ib,Rb,tc,xc){if(!xc||
ka!==Pb.a.xk)return 8;ka=xc.queryResult;xc=xc.SourceControlId;ib=this.bE.nEa(xc);if(!ib)return 8;tc=ib.Ef.split("_")[1]+"_24";ib=Ab.G7c(xc,xc,tc,"2024601249","149145197",ib.tf,ib.tf);ka.Rwa=ib;ib=this.pa.mg();if(!ib||!ib.length)return 16;1===Rb&&(Rb="",({x8b:Rb}=this.E6c(ib)).returnValue&&ka.Dka(Rb===xc));return 32}RBn(ka,ib,Rb,tc,xc){if(!xc||ka!==Pb.a.T5a)return 8;ka=xc.queryResult;xc=xc.SourceControlId;if(!xc||"TransitionExisting"!==xc)return 16;ib=this.bE.nEa(xc);if(!ib)return 8;tc=ib.Ef.split("_")[1]+
"_24";ib=Ab.G7c(xc,xc,tc,"3752636652","3476251476",ib.tf,ib.tf);ka.Rwa=ib;ib=this.pa.mg();if(!ib||!ib.length)return 16;if(1===Rb&&(Rb="",({x8b:Rb}=this.E6c(ib)).returnValue)){ib=this.bE.vlh(Rb,this.bE.DCe());if(Rb&&!ib){tc=this.bE.nEa(Rb);if(!tc)return 8;const hd=tc.Ef.split("_")[1]+"_24";xc=Ab.G7c(xc,xc,hd,"3752636652","3476251476",tc.tf,tc.tf);ka.Rwa=xc}ka.Dka(!Rb||!!Rb&&!ib)}return 32}SBn(ka,ib,Rb,tc,xc){if(!xc||ka!==Pb.a.eub)return 8;ka=xc.queryResult;xc=xc.SourceControlId;if(!xc||"TransitionExistingInMenu"!==
xc)return 16;ib=this.bE.nEa(xc);if(!ib)return 8;tc=ib.Ef.split("_")[1]+"_24";xc=Ab.G7c(xc,xc,tc,"4036532528","2831233208",ib.tf,ib.tf);ka.Rwa=xc;xc=this.pa.mg();if(!xc||!xc.length)return 16;1===Rb&&(Rb="",({x8b:Rb}=this.E6c(xc)).returnValue&&ka.Dka(!Rb));return 32}PBn(ka,ib,Rb){ka=this.pa.mg();if(!ka||!ka.length)return 16;ib=this.bE.bDe(ka[0].xA);return!ib||!ib.next||1<ka.length&&!this.E6c(ka).returnValue?16:1===Rb?32:8}KCk(ka,ib,Rb,tc,xc){if(!xc)return 8;ib=xc.SourceControlId;xc=ka===Pb.a.b7a||ka===
Pb.a.Rvb;tc=this.pa.mg();if(!tc||!tc.length)return 16;for(var hd of tc)if(this.uc.Cd(hd))return 16;hd="";const Fd=({x8b:hd}=this.E6c(tc)).returnValue;if(xc&&(!Fd||hd))return 16;if(1===Rb)return 32;hd=this.bE.nEa(ib);if(!hd)return 8;if(!xc&&2===Rb&&ib){Ae.a.Xj("SlideCount",tc.length.toString());Rb=this.Mb.Fd(15,void 0,()=>{this.pa.Rj();this.Ma.Wd()});try{Rb.rc(this.$b.Qf);Rb.sc=ka;for(const Td of tc)Td.xA=hd.wf}finally{Rb&&Rb.dispose()}n.ULS.sendTraceTag(512499931,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",
ib,hd.next||"null")}return 32}bNn(ka,ib,Rb,tc,xc){if(!xc)return 8;ib=xc.SourceControlId;if(ka!==Pb.a.hk)return 8;tc=this.pa.mg();if(!tc||!tc.length)return 16;for(var hd of tc)if(this.uc.Cd(hd))return 16;if(1===Rb)return 32;hd=this.bE.nEa(ib);if(!hd)return 8;if(2===Rb&&ib){Ae.a.Xj("SlideCount",tc.length.toString());Rb=this.Mb.Fd(15,void 0,()=>{this.pa.Rj();this.Ma.Wd()},()=>{1===this.xb.Ri&&this.Ma.lm(Cc.a.Lz,!0)});try{Rb.rc(this.$b.Qf);Rb.sc=ka;for(const Fd of tc)Fd.xA=hd.wf}finally{Rb&&Rb.dispose()}n.ULS.sendTraceTag(512499930,
801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",ib,hd.next||"null")}return 32}cNn(ka,ib,Rb,tc,xc){if(!xc)return 8;ib=this.pa.mg();if(!ib||!ib.length)return 16;if(ka!==Pb.a.b7a||1!==Rb)return 8;tc="";ka=({x8b:tc}=this.E6c(ib)).returnValue;Rb=!!tc;ib=tc&&0<tc.length?this.bE.nEa(tc):null;ib=this.bE.vlh(ib?ib.parent:null,this.bE.DCe());return!ka||Rb&&ib?16:32}dNn(ka,ib,Rb,tc,xc){if(!xc)return 8;ib=this.pa.mg();if(!ib||!ib.length)return 16;if(ka!==
Pb.a.Rvb||1!==Rb)return 8;ka="";return!({x8b:ka}=this.E6c(ib)).returnValue||ka?16:32}aNn(ka,ib,Rb,tc,xc){if(!xc)return 8;ib=xc.MenuItemId;if(1===Rb)return 32;Rb=this.pa.mg();if(!Rb||!Rb.length)return 16;tc=Ef.a("NoTransitionForEffectCmdFixEnabled");for(var hd of Rb){if(this.uc.Cd(hd))return 16;xc=hd.xA;if(!tc&&!xc)return 16}hd=this.bE.nEa(ib);if(!hd||!hd.wf)return 16;Ae.a.Xj("SlideCount",Rb.length.toString());xc=this.Mb.Fd(15,void 0,()=>{this.pa.Rj();this.Ma.Wd()});try{xc.rc(this.$b.Qf);xc.sc=ka;
for(const Fd of Rb){const Td=!tc||Fd.xA?Fd.xA:hd.wf;Td.TransitionType=hd.wf.TransitionType;Td.Direction=hd.wf.Direction;Td.Duration=hd.wf.Duration;Fd.xA=Td}}finally{xc&&xc.dispose()}n.ULS.sendTraceTag(512499929,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}",hd.parent,ib);return 32}OBn(ka,ib,Rb,tc,xc){if(!xc)return 8;ka=xc.queryResult;xc=xc.MenuItemId;ib=this.pa.mg();if(!ib||!ib.length)return 16;1===Rb&&(Rb="",({x8b:Rb}=this.oFm(ib)).returnValue&&
ka.xg(Rb===xc));return 32}NBn(ka,ib,Rb,tc,xc){if(!xc)return 8;ka=this.pa.mg();if(!ka||!ka.length)return 16;if(xc=xc.queryResult)ka=Ab.vTm(ka),xc.rda=ka;return 32}$Mn(ka,ib,Rb,tc,xc){if(!xc)return 8;ib=this.pa.mg();if(!ib||!ib.length)return 16;for(const hd of ib)if(this.uc.Cd(hd))return 16;xc=Math.floor(1E3*xc.Number);for(const hd of ib)if(!hd.xA)return 16;Ae.a.Ab&&(Ae.a.Ab.actionName="SetTransitionDuration");if(1===Rb){for(const hd of ib)if("TransitionNone"===this.bE.z8c(hd.xA))return 16;return 32}if(2===
Rb){const hd=this.Ma.currentScope;Ae.a.Xj("SlideCount",ib.length.toString());Rb=this.Mb.Fd(15,void 0,()=>{this.pa.Rj();!hd||hd.name!==Cc.a.kh&&hd.name!==Cc.a.jL||this.Ma.Wd()});try{Rb.rc(this.$b.Qf);Rb.sc=ka;for(const Fd of ib){const Td=Fd.xA;Td.Duration=xc;Fd.xA=Td}}finally{Rb&&Rb.dispose()}}return 32}E6c(ka){let ib;ib="";if(!ka||!ka.length)return{returnValue:!1,x8b:ib};ib=this.bE.z8c(ka[0].xA);let Rb=!0;if(1<ka.length)for(const tc of ka)if(ka=this.bE.z8c(tc?tc.xA:null),ib!==ka){Rb=!1;break}Rb||
(ib="");return{returnValue:Rb,x8b:ib}}oFm(ka){let ib;ib="";if(!ka||!ka.length)return{returnValue:!1,x8b:ib};ib=this.bE.y8c(ka[0].xA);let Rb=!0;if(1<ka.length)for(const tc of ka)if(ka=this.bE.y8c(tc?tc.xA:null),ib!==ka){Rb=!1;break}Rb||(ib="");return{returnValue:Rb,x8b:ib}}hil(ka){const ib=Object.assign(new Ld.a,{Id:"TransitionMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_TransitionEffectOptions,MenuSectionList:[]}),Rb=Object.assign(new eg.a,{Id:"MenuSectionEffectOptions",ControlsId:"MenuSectionEffectOptions.Controls",
DisplayMode:"Menu32",ControlList:[]});Array.add(ib.MenuSectionList,Rb);let tc=null;for(ka=({key:tc}=this.bE.Evl(ka)).returnValue;ka;)Array.add(Rb.ControlList,Object.assign(new pg.a,{Command:"961566706",Id:tc,ExternalId:"TransitionEffectOptions"+tc,QueryCommand:"3535869262"})),{key:tc,returnValue:ka}=this.bE.Evl(ka);return ib}static vTm(ka){let ib;if(!ka||!ka.length)return"0";const Rb=ka[0].xA;ib=Rb?(Rb.Duration/1E3).toString():"0";let tc=!0;if(1<ka.length)for(const xc of ka)if((ka=xc?xc.xA:null)||
Rb){if(!ka&&Rb||ka&&!Rb){tc=!1;break}if(ib!==(ka.Duration/1E3).toString()){tc=!1;break}}tc||(ib="0");return ib}static KHi(ka,ib,Rb){ka=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',ka,Rb);ib=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',ib);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',ka,ib)}static G7c(ka,ib,Rb,tc,xc,hd,Fd){return Object.assign(new Qd.a,
{Id:ka,ExternalId:ib,Icon:Rb,Command:tc,QueryCommand:xc,LabelText:hd,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Fd})}}Object(m.a)(Ab,"TransitionActor",null,[743]);class ic{constructor(ka,ib,Rb,tc,xc,hd,Fd){this.MD=null;this.PNk=!1;this.VTa=Rb;this.pa=ka;(this.G2a=tc)&&xc.execute(Td=>{this.MD=Td});this.ra=Fd;this.ia=ib;this.B2a=hd}selectShape(){this.pa&&!this.pa.Y0(this.ra)&&this.pa.selectShape(this.ra,!0)}onVolumeChanged(ka){const ib=
{ActionFromPlayer:!0};.2>=ka?(ib.SourceControlId="SetVolumeLow",this.ia.Qa(Pb.a.Ced,2,ib)):.2<ka&&.8>ka?(ib.SourceControlId="SetVolumeMedium",this.ia.Qa(Pb.a.Ded,2,ib)):.8<=ka&&(ib.SourceControlId="SetVolumeHigh",this.ia.Qa(Pb.a.Bed,2,ib));this.selectShape()}onPlayToggled(ka){const ib={ActionFromPlayer:!0};ka?this.ia.Qa(Pb.a.g5c,2,ib):this.ia.Qa(Pb.a.tzb,2,ib);this.selectShape()}onMuteToggled(ka){if(ka)this.ia.Qa(Pb.a.Eed,2,{ActionFromPlayer:!0,SourceControlId:"SetVolumeMute"});else this.onVolumeChanged(this.ra.media.vlmField);
this.selectShape()}onPlayerReadyStateChanged(ka){ka&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1))}onMouseHoverStateChanged(ka){ka||this.pa.lFe(this.ra)||(ka=this.ZM())&&ka.showHidePlayer(!1)}onPlayerClicked(){this.G2a&&this.ia.Cb(Pb.a.KDb,2)}onPlayerError(ka){Ob.a.J(512497820,822,10,"AudioLibraryCallback::OnPlayerError Error Message: {0}",ka);ka&&-1<ka.indexOf("PIPELINE_ERROR_READ")&&this.VTa.ICe(this.B2a.podSessionId,this.ra).then(ib=>{const Rb=this.ZM();
Rb&&Rb.setAudioSrc(ib)})}onKeyDown(ka){ka===Zc.a.gyb?(ka=this.ZM())&&ka.removeFocusFromPlayer():ka===Zc.a.vu&&(this.PNk=!0)}onBlur(){const ka=this.ZM();ka&&(this.PNk?ka.setFocusOnPlayer():ka.removeFocusFromPlayer());this.PNk=!1}ZM(){return this.G2a&&this.MD?this.MD.ZM(this.ra):null}}Object(m.a)(ic,"AudioLibraryCallback",null,[1279]);class zc{constructor(ka,ib,Rb,tc,xc,hd){this.VTa=ka;this.pa=ib;this.ia=Rb;this.G2a=tc;this.knb=hd;this.B2a=xc}mAm(ka){return new ic(this.pa,this.ia,this.VTa,this.G2a,
this.knb,this.B2a,ka)}}Object(m.a)(zc,"AudioLibraryCallbackFactory",null,[1229]);class Fc{constructor(ka,ib,Rb,tc){this.volume=ka;this.mute=ib;this.repeat=Rb;this.rewind=tc}}Object(m.a)(Fc,"MediaProperties",null,[]);class lc{constructor(ka,ib,Rb,tc){this.Xan=ka;this.lJj=ib;this.VTa=Rb;this.B2a=tc}createAudioManager(ka,ib,Rb){return new Promise((tc,xc)=>{this.lJj("audioPlayback").then(()=>{window.self.audioPlayback?(Ob.a.J(512497818,801,50,"audio script is loaded successfully"),tc(this.nAm(ka,ib,Rb))):
(Ob.a.J(512497819,801,10,"Audio script is loaded successfully but AudioPlayback namespace cannot be found"),xc("Audio script is loaded successfully but AudioPlayback namespace cannot be found"))}).catch(hd=>{Ob.a.J(512497817,801,10,"Failed to load audio script "+hd.toString());xc("Failed to load audio script ")})})}nAm(ka,ib,Rb){const tc=ib.media;let xc=null;tc&&(xc=new Fc(tc.vlmField,tc.mteField,tc.repeatField,tc.rewindField));const hd=audioPlayback.pptAudioFactoryGlobal.createAudioManager(ka,Rb,
this.Xan.mAm(ib),xc);this.VTa.ICe(this.B2a.podSessionId,ib).then(Fd=>{hd&&hd.setAudioSrc(Fd)});return hd}}Object(m.a)(lc,"AudioManagerFactory",null,[1230]);var nd=a(1641);class vd{constructor(){this.aGe=new nd.a}NXl(ka,ib){ib&&this.aGe.K(ib.id,ka)}wzh(ka){ka&&this.aGe.Ob(ka.id)&&(this.aGe.ha(ka.id).dispose(),this.aGe.remove(ka.id))}ZM(ka){return ka&&this.aGe.Ob(ka.id)?this.aGe.ha(ka.id):null}}Object(m.a)(vd,"AudioManagerStore",null,[1228]);class od{constructor(){this.Duration=this.Direction=0;this.IsManualAdvance=
!1;this.TransitionType=0}}Object(m.a)(od,"EditTransitionInfo",null,[]);class Bd{constructor(){this.next=this.parent=this.wf=this.k_=this.Ef=this.tf=null}}Object(m.a)(Bd,"Transition",null,[]);class Wd{}Wd.none=0;Wd.LJm=5;Wd.MJm=4;Wd.kUn=1;Wd.FVm=1;Wd.Rtm=2;Wd.Rib=0;Wd.D7c=1;Wd.Muc=2;Wd.gCe=3;Wd.Dgh=4;Wd.Cgh=5;Wd.Ggh=6;Wd.Fgh=7;Wd.Mih=2;Wd.m9c=1;Wd.yVm=1;Wd.mil=0;Wd.svm=1;Wd.rvm=2;Wd.AVm=0;Wd.zVm=1;Wd.Qxl=2;Wd.GVm=3;Wd.y_i=0;Wd.UIf=1;Wd.Lih=0;Wd.qLd=1;Wd.Stm=1;Wd.xhl=0;Wd.T5l=2;Wd.sRn=0;Wd.mUn=3;Wd.lUn=
1;Wd.wheel=1;Wd.b0l=29;Wd.Usl=0;Wd.dKm=1;Wd.jKm=2;Wd.rKm=3;Wd.Tsl=8;Wd.cKm=9;Wd.iKm=10;Wd.qKm=11;Wd.Vsl=12;Wd.gKm=13;Wd.lKm=14;Wd.uKm=15;Wd.Wsl=4;Wd.hKm=5;Wd.mKm=6;Wd.vKm=7;Wd.kKm=0;Wd.sKm=1;Wd.nKm=2;Wd.eKm=3;Wd.Ssl=4;Wd.tKm=5;Wd.oKm=6;Wd.fKm=7;Object(m.a)(Wd,"TransitionEffectOptions",null,[]);class ce{}ce.none=0;ce.cut=0;ce.random=1;ce.blinds=2;ce.checker=3;ce.Gqc=4;ce.dissolve=5;ce.fade=6;ce.B0c=7;ce.Uhk=8;ce.gAh=9;ce.wipe=10;ce.y3l=11;ce.split=13;ce.SNn=17;ce.TNn=18;ce.wedge=19;ce.push=20;ce.mhi=
21;ce.ggl=23;ce.wheel=26;ce.x3l=27;ce.$5g=28;ce.eMe=29;ce.Qxc=30;ce.bNg=39;ce.ANk=42;ce.flip=43;ce.Ata=44;ce.Y_n=47;ce.FCi=48;ce.$wi=49;ce.YCm=50;ce.g1k=51;ce.CAn=52;ce.ZJm=53;ce.RCm=54;ce.e6j=55;ce.GSl=56;ce.h4j=57;ce.o3h=58;ce.w3j=59;ce.morph=60;ce.pan=36;ce.qHi=38;ce.zli=37;ce.Kwi=33;ce.window=34;ce.lyf=32;ce.zoom=31;ce.w0n=22;Object(m.a)(ce,"TransitionTypes",null,[]);class db{constructor(ka,ib){let Rb=0;this.Of=new pf.a;this.Cdn=ib;this.Of.K("TransitionExisting",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionExisting,
Ef:db.Yf("TransitionFlash"),parent:"TransitionExisting"}));this.Of.K("TransitionExistingInMenu",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionExisting,Ef:db.Yf("TransitionFlash"),parent:"TransitionExisting"}));this.Of.K("TransitionNone",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionNone,Ef:db.Yf("TransitionNone"),wf:Object.assign(new od,{TransitionType:ce.none,Direction:Wd.Rtm,Duration:0,IsManualAdvance:!0}),parent:"TransitionNone"}));this.Of.K("TransitionFade",Object.assign(new Bd,
{tf:ResourceStrings.L_TransitionFade,Ef:db.Yf("TransitionFadeSmoothly"),wf:Object.assign(new od,{TransitionType:ce.ggl,Direction:Wd.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeSmoothly"}));this.Of.K("TransitionFadeSmoothly",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionSmoothly,k_:CommonUIStrings.l_TransitionFadeSmoothlyKeytip,Ef:db.Yf("TransitionFadeSmoothly"),wf:Object.assign(new od,{TransitionType:ce.ggl,Direction:Wd.none,Duration:700,IsManualAdvance:!0}),
parent:"TransitionFade",next:"TransitionFadeThroughBlack"}));this.Of.K("TransitionFadeThroughBlack",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionThroughBlack,k_:CommonUIStrings.l_TransitionFadeThroughBlackKeytip,Ef:db.Yf("TransitionFadeThroughBlack"),wf:Object.assign(new od,{TransitionType:ce.fade,Direction:Wd.none,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionFade"}));let tc=[];if(ka){tc=ka.toLowerCase().split(",");for(let xc=0;xc<tc.length;xc++)tc[xc]=tc[xc].trim()}Array.contains(tc,
"push")||(this.Of.K("TransitionPush",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionPush,Ef:db.Yf("TransitionPushUp"),wf:Object.assign(new od,{TransitionType:ce.push,Direction:Wd.D7c,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromBottom"})),this.Of.K("TransitionPushFromBottom",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromBottom,k_:CommonUIStrings.l_TransitionPushFromBottomKeytip,Ef:db.Yf("TransitionPushUp"),wf:Object.assign(new od,{TransitionType:ce.push,
Direction:Wd.D7c,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromLeft"})),this.Of.K("TransitionPushFromLeft",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromLeft,k_:CommonUIStrings.l_TransitionPushFromLeftKeytip,Ef:db.Yf("TransitionPushRight"),wf:Object.assign(new od,{TransitionType:ce.push,Direction:Wd.Muc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromRight"})),this.Of.K("TransitionPushFromRight",Object.assign(new Bd,
{tf:ResourceStrings.L_TransitionFromRight,k_:CommonUIStrings.l_TransitionPushFromRightKeytip,Ef:db.Yf("TransitionPushLeft"),wf:Object.assign(new od,{TransitionType:ce.push,Direction:Wd.Rib,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromTop"})),this.Of.K("TransitionPushFromTop",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromTop,k_:CommonUIStrings.l_TransitionPushFromTopKeytip,Ef:db.Yf("TransitionPushDown"),wf:Object.assign(new od,{TransitionType:ce.push,
Direction:Wd.gCe,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush"})));Array.contains(tc,"cut")||(this.Of.K("TransitionCut",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionCut,Ef:db.Yf("TransitionCut"),wf:Object.assign(new od,{TransitionType:ce.cut,Direction:Wd.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutNone"})),this.Of.K("TransitionCutNone",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionNone,k_:CommonUIStrings.l_TransitionCutNoneKeytip,Ef:db.Yf("TransitionCut"),
wf:Object.assign(new od,{TransitionType:ce.cut,Direction:Wd.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutThroughBlack"})),this.Of.K("TransitionCutThroughBlack",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionThroughBlack,k_:CommonUIStrings.l_TransitionCutThroughBlackKeytip,Ef:db.Yf("TransitionCutThroughBlack"),wf:Object.assign(new od,{TransitionType:ce.cut,Direction:Wd.kUn,Duration:500,IsManualAdvance:!0}),parent:"TransitionCut"})));Array.contains(tc,"wipe")||
(this.Of.K("TransitionWipe",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionWipe,Ef:db.Yf("TransitionWipeLeft"),wf:Object.assign(new od,{TransitionType:ce.wipe,Direction:Wd.Rib,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromRight"})),this.Of.K("TransitionWipeFromRight",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromRight,k_:CommonUIStrings.l_TransitionWipeFromRightKeytip,Ef:db.Yf("TransitionWipeLeft"),wf:Object.assign(new od,{TransitionType:ce.wipe,
Direction:Wd.Rib,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTop"})),this.Of.K("TransitionWipeFromTop",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromTop,k_:CommonUIStrings.l_TransitionWipeFromTopKeytip,Ef:db.Yf("TransitionWipeDown"),wf:Object.assign(new od,{TransitionType:ce.wipe,Direction:Wd.gCe,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromLeft"})),this.Of.K("TransitionWipeFromLeft",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromLeft,
k_:CommonUIStrings.l_TransitionWipeFromLeftKeytip,Ef:db.Yf("TransitionWipeRight"),wf:Object.assign(new od,{TransitionType:ce.wipe,Direction:Wd.Muc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottom"})),this.Of.K("TransitionWipeFromBottom",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromBottom,k_:CommonUIStrings.l_TransitionWipeFromBottomKeytip,Ef:db.Yf("TransitionWipeUp"),wf:Object.assign(new od,{TransitionType:ce.wipe,Direction:Wd.D7c,Duration:1E3,IsManualAdvance:!0}),
parent:"TransitionWipe",next:"TransitionWipeFromTopRight"})),this.Of.K("TransitionWipeFromTopRight",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromTopRight,k_:CommonUIStrings.l_TransitionWipeFromTopRightKeytip,Ef:db.Yf("TransitionStripsLeftDown"),wf:Object.assign(new od,{TransitionType:ce.gAh,Direction:Wd.Ggh,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomRight"})),this.Of.K("TransitionWipeFromBottomRight",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromBottomRight,
k_:CommonUIStrings.l_TransitionWipeFromBottomRightKeytip,Ef:db.Yf("TransitionStripsLeftUp"),wf:Object.assign(new od,{TransitionType:ce.gAh,Direction:Wd.Dgh,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopLeft"})),this.Of.K("TransitionWipeFromTopLeft",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromTopLeft,k_:CommonUIStrings.l_TransitionWipeFromTopLeftKeytip,Ef:db.Yf("TransitionStripsRightDown"),wf:Object.assign(new od,{TransitionType:ce.gAh,Direction:Wd.Fgh,
Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomLeft"})),this.Of.K("TransitionWipeFromBottomLeft",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromBottomLeft,k_:CommonUIStrings.l_TransitionWipeFromBottomLeftKeytip,Ef:db.Yf("TransitionStripsRightUp"),wf:Object.assign(new od,{TransitionType:ce.gAh,Direction:Wd.Cgh,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe"})));Array.contains(tc,"morph")||(this.Of.K("TransitionMorph",Object.assign(new Bd,
{tf:ResourceStrings.L_TransitionMorph,Ef:db.Yf("TransitionByObject"),wf:Object.assign(new od,{TransitionType:ce.morph,Direction:Wd.mil,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"})),this.Of.K("TransitionMorphByObject",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionByObject,k_:CommonUIStrings.l_TransitionMorphObjectsKeytip,Ef:db.Yf("TransitionByObject"),wf:Object.assign(new od,{TransitionType:ce.morph,Direction:Wd.mil,Duration:2E3,IsManualAdvance:!0}),
parent:"TransitionMorph",next:"TransitionMorphByWord"})),this.Of.K("TransitionMorphByWord",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionByWord,k_:CommonUIStrings.l_TransitionMorphWordsKeytip,Ef:db.Yf("TransitionByWord"),wf:Object.assign(new od,{TransitionType:ce.morph,Direction:Wd.svm,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByChar"})),this.Of.K("TransitionMorphByChar",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionByChar,k_:CommonUIStrings.l_TransitionMorphCharactersKeytip,
Ef:db.Yf("TransitionByChar"),wf:Object.assign(new od,{TransitionType:ce.morph,Direction:Wd.rvm,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph"})));Array.contains(tc,"split")||(this.Of.K("TransitionSplit",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionSplit,Ef:db.Yf("TransitionSplitOutVertical"),wf:Object.assign(new od,{TransitionType:ce.split,Direction:Wd.Qxl,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalOut"})),this.Of.K("TransitionSplitVerticalOut",
Object.assign(new Bd,{tf:ResourceStrings.L_TransitionVerticalOut,k_:CommonUIStrings.l_TransitionSplitVerticalOutKeytip,Ef:db.Yf("TransitionSplitOutVertical"),wf:Object.assign(new od,{TransitionType:ce.split,Direction:Wd.Qxl,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalIn"})),this.Of.K("TransitionSplitHorizontalIn",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionHorizontalIn,k_:CommonUIStrings.l_TransitionSplitHorizontalInKeytip,Ef:db.Yf("TransitionSplitInHorizontal"),
wf:Object.assign(new od,{TransitionType:ce.split,Direction:Wd.zVm,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalOut"})),this.Of.K("TransitionSplitHorizontalOut",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionHorizontalOut,k_:CommonUIStrings.l_TransitionSplitHorizontalOutKeytip,Ef:db.Yf("TransitionSplitOutHorizontal"),wf:Object.assign(new od,{TransitionType:ce.split,Direction:Wd.AVm,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalIn"})),
this.Of.K("TransitionSplitVerticalIn",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionVerticalIn,k_:CommonUIStrings.l_TransitionSplitVerticalInKeytip,Ef:db.Yf("TransitionSplitInVertical"),wf:Object.assign(new od,{TransitionType:ce.split,Direction:Wd.GVm,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit"})));if(!Array.contains(tc,"randombars")){this.Of.K("TransitionRandomBars",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionRandomBars,Ef:db.Yf("TransitionRandomBarsVertical"),wf:Object.assign(new od,
{TransitionType:ce.Uhk,Direction:Wd.qLd,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsVertical"}));this.Of.K("TransitionRandomBarsVertical",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionVertical,k_:CommonUIStrings.l_TransitionRandomBarsVerticalKeytip,Ef:db.Yf("TransitionRandomBarsVertical"),wf:Object.assign(new od,{TransitionType:ce.Uhk,Direction:Wd.qLd,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsHorizontal"}));
let xc,hd;this.Of.K("TransitionRandomBarsHorizontal",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionHorizontal,hd.k_=CommonUIStrings.l_TransitionRandomBarsHorizontalKeytip,hd.Ef=db.Yf("TransitionRandomBarsHorizontal"),hd.wf=(xc=new od,xc.TransitionType=ce.Uhk,xc.Direction=Wd.Lih,xc.Duration=1E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionRandomBars",hd))}if(!Array.contains(tc,"shape")){let xc,hd;this.Of.K("TransitionShape",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionShape,hd.Ef=db.Yf("TransitionShapeCircle"),
hd.wf=(xc=new od,xc.TransitionType=ce.x3l,xc.Direction=Wd.none,xc.Duration=800,xc.IsManualAdvance=!0,xc),hd.parent="TransitionShape",hd.next="TransitionShapeCircle",hd));let Fd,Td;this.Of.K("TransitionShapeCircle",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionCircle,Td.k_=CommonUIStrings.l_TransitionShapeCircleKeytip,Td.Ef=db.Yf("TransitionShapeCircle"),Td.wf=(Fd=new od,Fd.TransitionType=ce.x3l,Fd.Direction=Wd.none,Fd.Duration=800,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionShape",Td.next="TransitionShapeDiamond",
Td));let na,$a;this.Of.K("TransitionShapeDiamond",($a=new Bd,$a.tf=ResourceStrings.L_TransitionDiamond,$a.k_=CommonUIStrings.l_TransitionShapeDiamondKeytip,$a.Ef=db.Yf("TransitionShapeDiamond"),$a.wf=(na=new od,na.TransitionType=ce.SNn,na.Direction=Wd.none,na.Duration=800,na.IsManualAdvance=!0,na),$a.parent="TransitionShape",$a.next="TransitionShapePlus",$a));let Fb,Xb;this.Of.K("TransitionShapePlus",(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionPlus,Xb.k_=CommonUIStrings.l_TransitionShapePlusKeytip,
Xb.Ef=db.Yf("TransitionShapePlus"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.TNn,Fb.Direction=Wd.none,Fb.Duration=1E3,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionShape",Xb.next="TransitionShapeIn",Xb));let nc,Nc;this.Of.K("TransitionShapeIn",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionIn,Nc.k_=CommonUIStrings.l_TransitionShapeInKeytip,Nc.Ef=db.Yf("TransitionBoxIn"),Nc.wf=(nc=new od,nc.TransitionType=ce.y3l,nc.Direction=Wd.UIf,nc.Duration=1200,nc.IsManualAdvance=!0,nc),Nc.parent="TransitionShape",
Nc.next="TransitionShapeOut",Nc));let yd,Ud;this.Of.K("TransitionShapeOut",(Ud=new Bd,Ud.tf=ResourceStrings.L_TransitionOut,Ud.k_=CommonUIStrings.l_TransitionShapeOutKeytip,Ud.Ef=db.Yf("TransitionBoxOut"),Ud.wf=(yd=new od,yd.TransitionType=ce.y3l,yd.Direction=Wd.y_i,yd.Duration=1200,yd.IsManualAdvance=!0,yd),Ud.parent="TransitionShape",Ud))}if(!Array.contains(tc,"reveal")){let xc,hd;this.Of.K("TransitionReveal",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionReveal,hd.Ef=db.Yf("TransitionRevealSmoothlyFromRight"),
hd.wf=(xc=new od,xc.TransitionType=ce.bNg,xc.Direction=Wd.T5l,xc.Duration=3400,xc.IsManualAdvance=!0,xc),hd.parent="TransitionReveal",hd.next="TransitionRevealSmoothlyFromRight",hd));let Fd,Td;this.Of.K("TransitionRevealSmoothlyFromRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionSmoothlyFromRight,Td.Ef=db.Yf("TransitionRevealSmoothlyFromRight"),Td.wf=(Fd=new od,Fd.TransitionType=ce.bNg,Fd.Direction=Wd.T5l,Fd.Duration=3400,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionReveal",Td.next="TransitionRevealSmoothlyFromLeft",
Td));let na,$a;this.Of.K("TransitionRevealSmoothlyFromLeft",($a=new Bd,$a.tf=ResourceStrings.L_TransitionSmoothlyFromLeft,$a.Ef=db.Yf("TransitionRevealSmoothlyFromLeft"),$a.wf=(na=new od,na.TransitionType=ce.bNg,na.Direction=Wd.sRn,na.Duration=3400,na.IsManualAdvance=!0,na),$a.parent="TransitionReveal",$a.next="TransitionRevealFromRight",$a));let Fb,Xb;this.Of.K("TransitionRevealFromRight",(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionThroughBlackFromRight,Xb.Ef=db.Yf("TransitionRevealFromRight"),
Xb.wf=(Fb=new od,Fb.TransitionType=ce.bNg,Fb.Direction=Wd.mUn,Fb.Duration=3400,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionReveal",Xb.next="TransitionRevealFromLeft",Xb));let nc,Nc;this.Of.K("TransitionRevealFromLeft",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionThroughBlackFromLeft,Nc.Ef=db.Yf("TransitionRevealFromLeft"),Nc.wf=(nc=new od,nc.TransitionType=ce.bNg,nc.Direction=Wd.lUn,nc.Duration=3400,nc.IsManualAdvance=!0,nc),Nc.parent="TransitionReveal",Nc))}if(!Array.contains(tc,"cover")){let xc,
hd;this.Of.K("TransitionCover",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionCover,hd.Ef=db.Yf("TransitionCoverLeft"),hd.wf=(xc=new od,xc.TransitionType=ce.Gqc,xc.Direction=Wd.Rib,xc.Duration=1E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionCover",hd.next="TransitionCoverFromRight",hd));let Fd,Td;this.Of.K("TransitionCoverFromRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionFromRight,Td.Ef=db.Yf("TransitionCoverLeft"),Td.wf=(Fd=new od,Fd.TransitionType=ce.Gqc,Fd.Direction=Wd.Rib,Fd.Duration=1E3,
Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionCover",Td.next="TransitionCoverFromTop",Td));let na,$a;this.Of.K("TransitionCoverFromTop",($a=new Bd,$a.tf=ResourceStrings.L_TransitionFromTop,$a.Ef=db.Yf("TransitionCoverDown"),$a.wf=(na=new od,na.TransitionType=ce.Gqc,na.Direction=Wd.gCe,na.Duration=1E3,na.IsManualAdvance=!0,na),$a.parent="TransitionCover",$a.next="TransitionCoverFromLeft",$a));let Fb,Xb;this.Of.K("TransitionCoverFromLeft",(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionFromLeft,Xb.Ef=
db.Yf("TransitionCoverRight"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.Gqc,Fb.Direction=Wd.Muc,Fb.Duration=1E3,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionCover",Xb.next="TransitionCoverFromBottom",Xb));let nc,Nc;this.Of.K("TransitionCoverFromBottom",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionFromBottom,Nc.Ef=db.Yf("TransitionCoverUp"),Nc.wf=(nc=new od,nc.TransitionType=ce.Gqc,nc.Direction=Wd.D7c,nc.Duration=1E3,nc.IsManualAdvance=!0,nc),Nc.parent="TransitionCover",Nc.next="TransitionCoverFromTopRight",
Nc));let yd,Ud;this.Of.K("TransitionCoverFromTopRight",(Ud=new Bd,Ud.tf=ResourceStrings.L_TransitionFromTopRight,Ud.Ef=db.Yf("TransitionCoverLeftDown"),Ud.wf=(yd=new od,yd.TransitionType=ce.Gqc,yd.Direction=Wd.Ggh,yd.Duration=1E3,yd.IsManualAdvance=!0,yd),Ud.parent="TransitionCover",Ud.next="TransitionCoverFromBottomRight",Ud));let ie,Be;this.Of.K("TransitionCoverFromBottomRight",(Be=new Bd,Be.tf=ResourceStrings.L_TransitionFromBottomRight,Be.Ef=db.Yf("TransitionCoverLeftUp"),Be.wf=(ie=new od,ie.TransitionType=
ce.Gqc,ie.Direction=Wd.Dgh,ie.Duration=1E3,ie.IsManualAdvance=!0,ie),Be.parent="TransitionCover",Be.next="TransitionCoverFromTopLeft",Be));let oe,rf;this.Of.K("TransitionCoverFromTopLeft",(rf=new Bd,rf.tf=ResourceStrings.L_TransitionFromTopLeft,rf.Ef=db.Yf("TransitionCoverRightDown"),rf.wf=(oe=new od,oe.TransitionType=ce.Gqc,oe.Direction=Wd.Fgh,oe.Duration=1E3,oe.IsManualAdvance=!0,oe),rf.parent="TransitionCover",rf.next="TransitionCoverFromBottomLeft",rf));let Vf,xg;this.Of.K("TransitionCoverFromBottomLeft",
(xg=new Bd,xg.tf=ResourceStrings.L_TransitionFromBottomLeft,xg.Ef=db.Yf("TransitionCoverRightUp"),xg.wf=(Vf=new od,Vf.TransitionType=ce.Gqc,Vf.Direction=Wd.Cgh,Vf.Duration=1E3,Vf.IsManualAdvance=!0,Vf),xg.parent="TransitionCover",xg))}if(!Array.contains(tc,"uncover")){let xc,hd;this.Of.K("TransitionUncover",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionUncover,hd.Ef=db.Yf("TransitionUncoverLeft"),hd.wf=(xc=new od,xc.TransitionType=ce.B0c,xc.Direction=Wd.Rib,xc.Duration=750,xc.IsManualAdvance=!0,xc),
hd.parent="TransitionUncover",hd.next="TransitionUncoverFromRight",hd));let Fd,Td;this.Of.K("TransitionUncoverFromRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionFromRight,Td.Ef=db.Yf("TransitionUncoverLeft"),Td.wf=(Fd=new od,Fd.TransitionType=ce.B0c,Fd.Direction=Wd.Rib,Fd.Duration=750,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionUncover",Td.next="TransitionUncoverFromTop",Td));let na,$a;this.Of.K("TransitionUncoverFromTop",($a=new Bd,$a.tf=ResourceStrings.L_TransitionFromTop,$a.Ef=db.Yf("TransitionUncoverDown"),
$a.wf=(na=new od,na.TransitionType=ce.B0c,na.Direction=Wd.gCe,na.Duration=750,na.IsManualAdvance=!0,na),$a.parent="TransitionUncover",$a.next="TransitionUncoverFromLeft",$a));let Fb,Xb;this.Of.K("TransitionUncoverFromLeft",(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionFromLeft,Xb.Ef=db.Yf("TransitionUncoverRight"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.B0c,Fb.Direction=Wd.Muc,Fb.Duration=750,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionUncover",Xb.next="TransitionUncoverFromBottom",Xb));let nc,Nc;
this.Of.K("TransitionUncoverFromBottom",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionFromBottom,Nc.Ef=db.Yf("TransitionUncoverUp"),Nc.wf=(nc=new od,nc.TransitionType=ce.B0c,nc.Direction=Wd.D7c,nc.Duration=750,nc.IsManualAdvance=!0,nc),Nc.parent="TransitionUncover",Nc.next="TransitionUncoverFromTopRight",Nc));this.Of.K("TransitionUncoverFromTopRight",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromTopRight,Ef:db.Yf("TransitionUncoverLeftDown"),wf:Object.assign(new od,{TransitionType:ce.B0c,
Direction:Wd.Ggh,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomRight"}));this.Of.K("TransitionUncoverFromBottomRight",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromBottomRight,Ef:db.Yf("TransitionUncoverLeftUp"),wf:Object.assign(new od,{TransitionType:ce.B0c,Direction:Wd.Dgh,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromTopLeft"}));this.Of.K("TransitionUncoverFromTopLeft",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromTopLeft,
Ef:db.Yf("TransitionUncoverRightDown"),wf:Object.assign(new od,{TransitionType:ce.B0c,Direction:Wd.Fgh,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomLeft"}));this.Of.K("TransitionUncoverFromBottomLeft",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromBottomLeft,Ef:db.Yf("TransitionUncoverRightUp"),wf:Object.assign(new od,{TransitionType:ce.B0c,Direction:Wd.Cgh,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover"}))}if(!Array.contains(tc,
"menusectionexciting")){if(!Array.contains(tc,"fallover")){this.Of.K("TransitionFallOver",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFallOver,Ef:db.Yf("TransitionFallOverLeft"),wf:Object.assign(new od,{TransitionType:ce.FCi,Direction:Wd.none,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionFallOver",next:"TransitionFallOverLeft"}));let xc,hd;this.Of.K("TransitionFallOverLeft",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionGoLeft,hd.Ef=db.Yf("TransitionFallOverLeft"),hd.wf=(xc=new od,xc.TransitionType=
ce.FCi,xc.Direction=Wd.none,xc.Duration=2E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionFallOver",hd.next="TransitionFallOverRight",hd));let Fd,Td;this.Of.K("TransitionFallOverRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionGoRight,Td.Ef=db.Yf("TransitionFallOverRight"),Td.wf=(Fd=new od,Fd.TransitionType=ce.FCi,Fd.Direction=Wd.m9c,Fd.Duration=2E3,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionFallOver",Td))}if(!Array.contains(tc,"drape")){let xc,hd;this.Of.K("TransitionDrape",(hd=new Bd,hd.tf=
ResourceStrings.L_TransitionDrape,hd.Ef=db.Yf("TransitionDrapeLeft"),hd.wf=(xc=new od,xc.TransitionType=ce.$wi,xc.Direction=Wd.none,xc.Duration=2E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionDrape",hd.next="TransitionDrapeLeft",hd));let Fd,Td;this.Of.K("TransitionDrapeLeft",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionGoLeft,Td.Ef=db.Yf("TransitionDrapeLeft"),Td.wf=(Fd=new od,Fd.TransitionType=ce.$wi,Fd.Direction=Wd.none,Fd.Duration=2E3,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionDrape",Td.next=
"TransitionDrapeRight",Td));let na,$a;this.Of.K("TransitionDrapeRight",($a=new Bd,$a.tf=ResourceStrings.L_TransitionGoRight,$a.Ef=db.Yf("TransitionDrapeRight"),$a.wf=(na=new od,na.TransitionType=ce.$wi,na.Direction=Wd.m9c,na.Duration=2E3,na.IsManualAdvance=!0,na),$a.parent="TransitionDrape",$a))}if(!Array.contains(tc,"curtains")){let xc,hd;this.Of.K("TransitionCurtains",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionCurtains,hd.Ef=db.Yf("TransitionCurtains"),hd.wf=(xc=new od,xc.TransitionType=ce.YCm,
xc.Direction=Wd.none,xc.Duration=6E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionCurtains",hd))}if(!Array.contains(tc,"wind")){let xc,hd;this.Of.K("TransitionWind",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionWind,hd.Ef=db.Yf("TransitionWindRight"),hd.wf=(xc=new od,xc.TransitionType=ce.g1k,xc.Direction=Wd.none,xc.Duration=2E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionWind",hd.next="TransitionWindRight",hd));let Fd,Td;this.Of.K("TransitionWindRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionGoRight,
Td.Ef=db.Yf("TransitionWindRight"),Td.wf=(Fd=new od,Fd.TransitionType=ce.g1k,Fd.Direction=Wd.none,Fd.Duration=2E3,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionWind",Td.next="TransitionWindLeft",Td));let na,$a;this.Of.K("TransitionWindLeft",($a=new Bd,$a.tf=ResourceStrings.L_TransitionGoLeft,$a.Ef=db.Yf("TransitionWindLeft"),$a.wf=(na=new od,na.TransitionType=ce.g1k,na.Direction=Wd.m9c,na.Duration=2E3,na.IsManualAdvance=!0,na),$a.parent="TransitionWind",$a))}if(!Array.contains(tc,"prestige")){let xc,
hd;this.Of.K("TransitionPrestige",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionPrestige,hd.Ef=db.Yf("TransitionPrestige"),hd.wf=(xc=new od,xc.TransitionType=ce.CAn,xc.Direction=Wd.none,xc.Duration=2E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionPrestige",hd))}if(!Array.contains(tc,"fracture")){let xc,hd;this.Of.K("TransitionFracture",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionFracture,hd.Ef=db.Yf("TransitionFracture"),hd.wf=(xc=new od,xc.TransitionType=ce.ZJm,xc.Direction=Wd.none,xc.Duration=
2E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionFracture",hd))}if(!Array.contains(tc,"crush")){let xc,hd;this.Of.K("TransitionCrush",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionCrush,hd.Ef=db.Yf("TransitionCrush"),hd.wf=(xc=new od,xc.TransitionType=ce.RCm,xc.Direction=Wd.none,xc.Duration=2E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionCrush",hd))}if(!Array.contains(tc,"peeloff")){let xc,hd;this.Of.K("TransitionPeelOff",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionPeelOff,hd.Ef=db.Yf("TransitionPeelOffLeft"),
hd.wf=(xc=new od,xc.TransitionType=ce.e6j,xc.Direction=Wd.none,xc.Duration=1250,xc.IsManualAdvance=!0,xc),hd.parent="TransitionPeelOff",hd.next="TransitionPeelOffLeft",hd));let Fd,Td;this.Of.K("TransitionPeelOffLeft",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionGoLeft,Td.Ef=db.Yf("TransitionPeelOffLeft"),Td.wf=(Fd=new od,Fd.TransitionType=ce.e6j,Fd.Direction=Wd.none,Fd.Duration=1250,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionPeelOff",Td.next="TransitionPeelOffRight",Td));let na,$a;this.Of.K("TransitionPeelOffRight",
($a=new Bd,$a.tf=ResourceStrings.L_TransitionGoRight,$a.Ef=db.Yf("TransitionPeelOffRight"),$a.wf=(na=new od,na.TransitionType=ce.e6j,na.Direction=Wd.m9c,na.Duration=1250,na.IsManualAdvance=!0,na),$a.parent="TransitionPeelOff",$a))}if(!Array.contains(tc,"pagecurl")){let xc,hd;this.Of.K("TransitionPageCurl",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionPageCurl,hd.Ef=db.Yf("TransitionTwoPageCurlFromRight"),hd.wf=(xc=new od,xc.TransitionType=ce.h4j,xc.Direction=Wd.none,xc.Duration=1250,xc.IsManualAdvance=
!0,xc),hd.parent="TransitionPageCurl",hd.next="TransitionPageCurlDoubleLeft",hd));let Fd,Td;this.Of.K("TransitionPageCurlDoubleLeft",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionEffectOptionDoubleLeft,Td.Ef=db.Yf("TransitionTwoPageCurlFromRight"),Td.wf=(Fd=new od,Fd.TransitionType=ce.h4j,Fd.Direction=Wd.none,Fd.Duration=1250,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionPageCurl",Td.next="TransitionPageCurlDoubleRight",Td));let na,$a;this.Of.K("TransitionPageCurlDoubleRight",($a=new Bd,$a.tf=ResourceStrings.L_TransitionEffectOptionDoubleRight,
$a.Ef=db.Yf("TransitionTwoPageCurlFromLeft"),$a.wf=(na=new od,na.TransitionType=ce.h4j,na.Direction=Wd.m9c,na.Duration=1250,na.IsManualAdvance=!0,na),$a.parent="TransitionPageCurl",$a.next="TransitionPageCurlSingleLeft",$a));let Fb,Xb;this.Of.K("TransitionPageCurlSingleLeft",(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionEffectOptionSingleLeft,Xb.Ef=db.Yf("TransitionPageCurlFromRight"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.GSl,Fb.Direction=Wd.none,Fb.Duration=1250,Fb.IsManualAdvance=!0,Fb),Xb.parent=
"TransitionPageCurl",Xb.next="TransitionPageCurlSingleRight",Xb));let nc,Nc;this.Of.K("TransitionPageCurlSingleRight",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionEffectOptionSingleRight,Nc.Ef=db.Yf("TransitionPageCurlFromLeft"),Nc.wf=(nc=new od,nc.TransitionType=ce.GSl,nc.Direction=Wd.m9c,nc.Duration=1250,nc.IsManualAdvance=!0,nc),Nc.parent="TransitionPageCurl",Nc))}if(!Array.contains(tc,"airplane")){let xc,hd;this.Of.K("TransitionAirplane",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionAirplane,hd.Ef=
db.Yf("TransitionAirplaneRight"),hd.wf=(xc=new od,xc.TransitionType=ce.o3h,xc.Direction=Wd.none,xc.Duration=1250,xc.IsManualAdvance=!0,xc),hd.parent="TransitionAirplane",hd.next="TransitionAirplaneRight",hd));let Fd,Td;this.Of.K("TransitionAirplaneRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionGoRight,Td.Ef=db.Yf("TransitionAirplaneRight"),Td.wf=(Fd=new od,Fd.TransitionType=ce.o3h,Fd.Direction=Wd.none,Fd.Duration=1250,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionAirplane",Td.next="TransitionAirplaneLeft",
Td));let na,$a;this.Of.K("TransitionAirplaneLeft",($a=new Bd,$a.tf=ResourceStrings.L_TransitionGoLeft,$a.Ef=db.Yf("TransitionAirplaneLeft"),$a.wf=(na=new od,na.TransitionType=ce.o3h,na.Direction=Wd.m9c,na.Duration=1250,na.IsManualAdvance=!0,na),$a.parent="TransitionAirplane",$a))}if(!Array.contains(tc,"origami")){let xc,hd;this.Of.K("TransitionOrigami",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionOrigami,hd.Ef=db.Yf("TransitionOrigamiRight"),hd.wf=(xc=new od,xc.TransitionType=ce.w3j,xc.Direction=
Wd.none,xc.Duration=3250,xc.IsManualAdvance=!0,xc),hd.parent="TransitionOrigami",hd.next="TransitionOrigamiRight",hd));let Fd,Td;this.Of.K("TransitionOrigamiRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionGoRight,Td.Ef=db.Yf("TransitionOrigamiRight"),Td.wf=(Fd=new od,Fd.TransitionType=ce.w3j,Fd.Direction=Wd.none,Fd.Duration=3250,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionOrigami",Td.next="TransitionOrigamiLeft",Td));let na,$a;this.Of.K("TransitionOrigamiLeft",($a=new Bd,$a.tf=ResourceStrings.L_TransitionGoLeft,
$a.Ef=db.Yf("TransitionOrigamiLeft"),$a.wf=(na=new od,na.TransitionType=ce.w3j,na.Direction=Wd.m9c,na.Duration=3250,na.IsManualAdvance=!0,na),$a.parent="TransitionOrigami",$a))}Array.contains(tc,"dissolve")||this.Of.K("TransitionDissolve",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionDissolve,Ef:db.Yf("TransitionDissolve"),wf:Object.assign(new od,{TransitionType:ce.dissolve,Direction:Wd.none,Duration:1200,IsManualAdvance:!0}),parent:"TransitionDissolve"}));Array.contains(tc,"checker")||(this.Of.K("TransitionChecker",
Object.assign(new Bd,{tf:ResourceStrings.L_TransitionChecker,Ef:db.Yf("TransitionCheckerboardAcross"),wf:Object.assign(new od,{TransitionType:ce.checker,Direction:Wd.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromLeft"})),this.Of.K("TransitionCheckerFromLeft",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromLeft,Ef:db.Yf("TransitionCheckerboardAcross"),wf:Object.assign(new od,{TransitionType:ce.checker,Direction:Wd.none,Duration:2500,IsManualAdvance:!0}),
parent:"TransitionChecker",next:"TransitionCheckerFromTop"})),this.Of.K("TransitionCheckerFromTop",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromTop,Ef:db.Yf("TransitionCheckerboardDown"),wf:Object.assign(new od,{TransitionType:ce.checker,Direction:Wd.yVm,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker"})));if(!Array.contains(tc,"blinds")){this.Of.K("TransitionBlinds",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionBlinds,Ef:db.Yf("TransitionBlindsVertical"),wf:Object.assign(new od,
{TransitionType:ce.blinds,Direction:Wd.xhl,Duration:1600,IsManualAdvance:!0}),parent:"TransitionBlinds",next:"TransitionBlindsVertical"}));let xc,hd;this.Of.K("TransitionBlindsVertical",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionVertical,hd.Ef=db.Yf("TransitionBlindsVertical"),hd.wf=(xc=new od,xc.TransitionType=ce.blinds,xc.Direction=Wd.xhl,xc.Duration=1600,xc.IsManualAdvance=!0,xc),hd.parent="TransitionBlinds",hd.next="TransitionBlindsHorizontal",hd));let Fd,Td;this.Of.K("TransitionBlindsHorizontal",
(Td=new Bd,Td.tf=ResourceStrings.L_TransitionHorizontal,Td.Ef=db.Yf("TransitionBlindsHorizontal"),Td.wf=(Fd=new od,Fd.TransitionType=ce.blinds,Fd.Direction=Wd.Stm,Fd.Duration=1600,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionBlinds",Td))}if(!Array.contains(tc,"wheel")){let xc,hd;this.Of.K("TransitionWheel",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionWheel,hd.Ef=db.Yf("TransitionWheelClockwise1"),hd.wf=(xc=new od,xc.TransitionType=ce.wheel,xc.Direction=Wd.wheel,xc.Duration=1E3,xc.IsManualAdvance=
!0,xc),hd.parent="TransitionWheel",hd.next="TransitionWheelClockwise",hd));let Fd,Td;this.Of.K("TransitionWheelClockwise",(Td=new Bd,Td.tf=ResourceStrings.l_TransitionWheelClockWise,Td.Ef=db.Yf("TransitionWheelClockwise1"),Td.wf=(Fd=new od,Fd.TransitionType=ce.wheel,Fd.Direction=Wd.wheel,Fd.Duration=1E3,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionWheel",Td.next="TransitionWheelCounterclockwise",Td));let na,$a;this.Of.K("TransitionWheelCounterclockwise",($a=new Bd,$a.tf=ResourceStrings.l_TransitionWheelCounterClockWise,
$a.Ef=db.Yf("TransitionWheelCounterclockwise1"),$a.wf=(na=new od,na.TransitionType=ce.Y_n,na.Direction=Wd.wheel,na.Duration=1E3,na.IsManualAdvance=!0,na),$a.parent="TransitionWheel",$a.next="TransitionWheelWedge",$a));let Fb,Xb;this.Of.K("TransitionWheelWedge",(Xb=new Bd,Xb.tf=ResourceStrings.l_TransitionWheelWedge,Xb.Ef=db.Yf("TransitionWedge"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.wedge,Fb.Direction=Wd.none,Fb.Duration=1E3,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionWheel",Xb))}if(!Array.contains(tc,
"ripple")){let xc,hd;this.Of.K("TransitionRipple",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionRipple,hd.Ef=db.Yf("TransitionRipple"),hd.wf=(xc=new od,xc.TransitionType=ce.eMe,xc.Direction=Wd.b0l,xc.Duration=1400,xc.IsManualAdvance=!0,xc),hd.parent="TransitionRipple",hd.next="TransitionRippleCenter",hd));let Fd,Td;this.Of.K("TransitionRippleCenter",(Td=new Bd,Td.tf=ResourceStrings.L_EffectOptionsDirectionCenter,Td.Ef=db.Yf("TransitionRipple"),Td.wf=(Fd=new od,Fd.TransitionType=ce.eMe,Fd.Direction=
Wd.b0l,Fd.Duration=1400,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionRipple",Td.next="TransitionRippleBottomLeft",Td));let na,$a;this.Of.K("TransitionRippleBottomLeft",($a=new Bd,$a.tf=ResourceStrings.L_TransitionFromBottomLeft,$a.Ef=db.Yf("TransitionRippleBottomLeft"),$a.wf=(na=new od,na.TransitionType=ce.eMe,na.Direction=Wd.Cgh,na.Duration=1500,na.IsManualAdvance=!0,na),$a.parent="TransitionRipple",$a.next="TransitionRippleBottomRight",$a));let Fb,Xb;this.Of.K("TransitionRippleBottomRight",(Xb=
new Bd,Xb.tf=ResourceStrings.L_TransitionFromBottomRight,Xb.Ef=db.Yf("TransitionRippleBottomRight"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.eMe,Fb.Direction=Wd.Dgh,Fb.Duration=1500,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionRipple",Xb.next="TransitionRippleTopRight",Xb));let nc,Nc;this.Of.K("TransitionRippleTopRight",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionFromTopRight,Nc.Ef=db.Yf("TransitionRippleTopRight"),Nc.wf=(nc=new od,nc.TransitionType=ce.eMe,nc.Direction=Wd.Ggh,nc.Duration=1500,nc.IsManualAdvance=
!0,nc),Nc.parent="TransitionRipple",Nc.next="TransitionRippleTopLeft",Nc));let yd,Ud;this.Of.K("TransitionRippleTopLeft",(Ud=new Bd,Ud.tf=ResourceStrings.L_TransitionFromTopLeft,Ud.Ef=db.Yf("TransitionRippleTopLeft"),Ud.wf=(yd=new od,yd.TransitionType=ce.eMe,yd.Direction=Wd.Fgh,yd.Duration=1500,yd.IsManualAdvance=!0,yd),Ud.parent="TransitionRipple",Ud))}if(!Array.contains(tc,"glitter")){let xc,hd;this.Of.K("TransitionGlitter",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionGlitter,hd.Ef=db.Yf("TransitionGlitterHexagonLeft"),
hd.wf=(xc=new od,xc.TransitionType=ce.Qxc,xc.Direction=Wd.Ssl,xc.Duration=3900,xc.IsManualAdvance=!0,xc),hd.parent="TransitionGlitter",hd.next="TransitionGlitterHexagonLeft",hd));let Fd,Td;this.Of.K("TransitionGlitterHexagonLeft",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionHexagonsFromLeft,Td.Ef=db.Yf("TransitionGlitterHexagonLeft"),Td.wf=(Fd=new od,Fd.TransitionType=ce.Qxc,Fd.Direction=Wd.Ssl,Fd.Duration=3900,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionGlitter",Td.next="TransitionGlitterHexagonTop",
Td));let na,$a;this.Of.K("TransitionGlitterHexagonTop",($a=new Bd,$a.tf=ResourceStrings.L_TransitionHexagonsFromTop,$a.Ef=db.Yf("TransitionGlitterHexagonTop"),$a.wf=(na=new od,na.TransitionType=ce.Qxc,na.Direction=Wd.tKm,na.Duration=3900,na.IsManualAdvance=!0,na),$a.parent="TransitionGlitter",$a.next="TransitionGlitterHexagonRight",$a));let Fb,Xb;this.Of.K("TransitionGlitterHexagonRight",(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionHexagonsFromRight,Xb.Ef=db.Yf("TransitionGlitterHexagonRight"),Xb.wf=
(Fb=new od,Fb.TransitionType=ce.Qxc,Fb.Direction=Wd.oKm,Fb.Duration=3900,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionGlitter",Xb.next="TransitionGlitterHexagonBottom",Xb));let nc,Nc;this.Of.K("TransitionGlitterHexagonBottom",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionHexagonsFromBottom,Nc.Ef=db.Yf("TransitionGlitterHexagonBottom"),Nc.wf=(nc=new od,nc.TransitionType=ce.Qxc,nc.Direction=Wd.fKm,nc.Duration=3900,nc.IsManualAdvance=!0,nc),Nc.parent="TransitionGlitter",Nc.next="TransitionGlitterDiamondLeft",
Nc));let yd,Ud;this.Of.K("TransitionGlitterDiamondLeft",(Ud=new Bd,Ud.tf=ResourceStrings.L_TransitionDiamondsFromLeft,Ud.Ef=db.Yf("TransitionGlitterDiamondLeft"),Ud.wf=(yd=new od,yd.TransitionType=ce.Qxc,yd.Direction=Wd.kKm,yd.Duration=3900,yd.IsManualAdvance=!0,yd),Ud.parent="TransitionGlitter",Ud.next="TransitionGlitterDiamondTop",Ud));let ie,Be;this.Of.K("TransitionGlitterDiamondTop",(Be=new Bd,Be.tf=ResourceStrings.L_TransitionDiamondsFromTop,Be.Ef=db.Yf("TransitionGlitterDiamondTop"),Be.wf=(ie=
new od,ie.TransitionType=ce.Qxc,ie.Direction=Wd.sKm,ie.Duration=3900,ie.IsManualAdvance=!0,ie),Be.parent="TransitionGlitter",Be.next="TransitionGlitterDiamondRight",Be));let oe,rf;this.Of.K("TransitionGlitterDiamondRight",(rf=new Bd,rf.tf=ResourceStrings.L_TransitionDiamondsFromRight,rf.Ef=db.Yf("TransitionGlitterDiamondRight"),rf.wf=(oe=new od,oe.TransitionType=ce.Qxc,oe.Direction=Wd.nKm,oe.Duration=3900,oe.IsManualAdvance=!0,oe),rf.parent="TransitionGlitter",rf.next="TransitionGlitterDiamondBottom",
rf));let Vf,xg;this.Of.K("TransitionGlitterDiamondBottom",(xg=new Bd,xg.tf=ResourceStrings.L_TransitionDiamondsFromBottom,xg.Ef=db.Yf("TransitionGlitterDiamondBottom"),xg.wf=(Vf=new od,Vf.TransitionType=ce.Qxc,Vf.Direction=Wd.eKm,Vf.Duration=3900,Vf.IsManualAdvance=!0,Vf),xg.parent="TransitionGlitter",xg))}if(!Array.contains(tc,"vortex")){let xc,hd;this.Of.K("TransitionVortex",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionVortex,hd.Ef=db.Yf("TransitionVortexFromLeft"),hd.wf=(xc=new od,xc.TransitionType=
ce.$5g,xc.Direction=Wd.Muc,xc.Duration=4E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionVortex",hd.next="TransitionVortexFromLeft",hd));let Fd,Td;this.Of.K("TransitionVortexFromLeft",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionFromLeft,Td.Ef=db.Yf("TransitionVortexFromLeft"),Td.wf=(Fd=new od,Fd.TransitionType=ce.$5g,Fd.Direction=Wd.Muc,Fd.Duration=4E3,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionVortex",Td.next="TransitionVortexFromTop",Td));let na,$a;this.Of.K("TransitionVortexFromTop",($a=
new Bd,$a.tf=ResourceStrings.L_TransitionFromTop,$a.Ef=db.Yf("TransitionVortexFromTop"),$a.wf=(na=new od,na.TransitionType=ce.$5g,na.Direction=Wd.gCe,na.Duration=4E3,na.IsManualAdvance=!0,na),$a.parent="TransitionVortex",$a.next="TransitionVortexFromRight",$a));let Fb,Xb;this.Of.K("TransitionVortexFromRight",(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionFromRight,Xb.Ef=db.Yf("TransitionVortexFromRight"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.$5g,Fb.Direction=Wd.Rib,Fb.Duration=4E3,Fb.IsManualAdvance=
!0,Fb),Xb.parent="TransitionVortex",Xb.next="TransitionVortexFromBottom",Xb));let nc,Nc;this.Of.K("TransitionVortexFromBottom",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionFromBottom,Nc.Ef=db.Yf("TransitionVortexFromBottom"),Nc.wf=(nc=new od,nc.TransitionType=ce.$5g,nc.Direction=Wd.D7c,nc.Duration=4E3,nc.IsManualAdvance=!0,nc),Nc.parent="TransitionVortex",Nc))}Array.contains(tc,"switch")||(this.Of.K("TransitionSwitch",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionSwitch,Ef:db.Yf("TransitionSwitchRight"),
wf:Object.assign(new od,{TransitionType:ce.ANk,Direction:Wd.Mih,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchRight"})),this.Of.K("TransitionSwitchRight",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionGoRight,Ef:db.Yf("TransitionSwitchRight"),wf:Object.assign(new od,{TransitionType:ce.ANk,Direction:Wd.Mih,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchLeft"})),this.Of.K("TransitionSwitchLeft",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionGoLeft,
Ef:db.Yf("TransitionSwitchLeft"),wf:Object.assign(new od,{TransitionType:ce.ANk,Direction:Wd.none,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch"})));if(!Array.contains(tc,"flip")){this.Of.K("TransitionFlip",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFlip,Ef:db.Yf("TransitionFlipRight"),wf:Object.assign(new od,{TransitionType:ce.flip,Direction:Wd.Mih,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipRight"}));this.Of.K("TransitionFlipRight",Object.assign(new Bd,
{tf:ResourceStrings.L_TransitionGoRight,Ef:db.Yf("TransitionFlipRight"),wf:Object.assign(new od,{TransitionType:ce.flip,Direction:Wd.Mih,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipLeft"}));let xc,hd;this.Of.K("TransitionFlipLeft",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionGoLeft,hd.Ef=db.Yf("TransitionFlipLeft"),hd.wf=(xc=new od,xc.TransitionType=ce.flip,xc.Direction=Wd.none,xc.Duration=1250,xc.IsManualAdvance=!0,xc),hd.parent="TransitionFlip",hd))}if(!Array.contains(tc,
"galleryicon")){let xc,hd;this.Of.K("TransitionGalleryIcon",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionGallery,hd.Ef=db.Yf("TransitionGalleryRight"),hd.wf=(xc=new od,xc.TransitionType=ce.qHi,xc.Direction=Wd.Rib,xc.Duration=1600,xc.IsManualAdvance=!0,xc),hd.parent="TransitionGalleryIcon",hd.next="TransitionGalleryIconFromRight",hd));let Fd,Td;this.Of.K("TransitionGalleryIconFromRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionFromRight,Td.Ef=db.Yf("TransitionGalleryRight"),Td.wf=(Fd=new od,Fd.TransitionType=
ce.qHi,Fd.Direction=Wd.Rib,Fd.Duration=1600,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionGalleryIcon",Td.next="TransitionGalleryIconFromLeft",Td));let na,$a;this.Of.K("TransitionGalleryIconFromLeft",($a=new Bd,$a.tf=ResourceStrings.L_TransitionFromLeft,$a.Ef=db.Yf("TransitionGalleryLeft"),$a.wf=(na=new od,na.TransitionType=ce.qHi,na.Direction=Wd.Muc,na.Duration=1600,na.IsManualAdvance=!0,na),$a.parent="TransitionGalleryIcon",$a))}if(!Array.contains(tc,"cube")){let xc,hd;this.Of.K("TransitionCube",
(hd=new Bd,hd.tf=ResourceStrings.L_TransitionCube,hd.Ef=db.Yf("TransitionCubeFromRight"),hd.wf=(xc=new od,xc.TransitionType=ce.Ata,xc.Direction=Wd.Usl,xc.Duration=1200,xc.IsManualAdvance=!0,xc),hd.parent="TransitionCube",hd.next="TransitionCubeFromRight",hd));let Fd,Td;this.Of.K("TransitionCubeFromRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionFromRight,Td.Ef=db.Yf("TransitionCubeFromRight"),Td.wf=(Fd=new od,Fd.TransitionType=ce.Ata,Fd.Direction=Wd.Usl,Fd.Duration=1200,Fd.IsManualAdvance=!0,
Fd),Td.parent="TransitionCube",Td.next="TransitionCubeFromBottom",Td));let na,$a;this.Of.K("TransitionCubeFromBottom",($a=new Bd,$a.tf=ResourceStrings.L_TransitionFromBottom,$a.Ef=db.Yf("TransitionCubeFromBottom"),$a.wf=(na=new od,na.TransitionType=ce.Ata,na.Direction=Wd.dKm,na.Duration=1200,na.IsManualAdvance=!0,na),$a.parent="TransitionCube",$a.next="TransitionCubeFromLeft",$a));let Fb,Xb;this.Of.K("TransitionCubeFromLeft",(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionFromLeft,Xb.Ef=db.Yf("TransitionCubeFromLeft"),
Xb.wf=(Fb=new od,Fb.TransitionType=ce.Ata,Fb.Direction=Wd.jKm,Fb.Duration=1200,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionCube",Xb.next="TransitionCubeFromTop",Xb));let nc,Nc;this.Of.K("TransitionCubeFromTop",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionFromTop,Nc.Ef=db.Yf("TransitionCubeFromTop"),Nc.wf=(nc=new od,nc.TransitionType=ce.Ata,nc.Direction=Wd.rKm,nc.Duration=1200,nc.IsManualAdvance=!0,nc),Nc.parent="TransitionCube",Nc))}if(!Array.contains(tc,"doors")){let xc,hd;this.Of.K("TransitionDoors",
(hd=new Bd,hd.tf=ResourceStrings.L_TransitionDoors,hd.Ef=db.Yf("TransitionDoorsVertical"),hd.wf=(xc=new od,xc.TransitionType=ce.Kwi,xc.Direction=Wd.qLd,xc.Duration=1400,xc.IsManualAdvance=!0,xc),hd.parent="TransitionDoors",hd.next="TransitionDoorsVertical",hd));let Fd,Td;this.Of.K("TransitionDoorsVertical",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionVertical,Td.Ef=db.Yf("TransitionDoorsVertical"),Td.wf=(Fd=new od,Fd.TransitionType=ce.Kwi,Fd.Direction=Wd.qLd,Fd.Duration=1400,Fd.IsManualAdvance=!0,
Fd),Td.parent="TransitionDoors",Td.next="TransitionDoorsHorizontal",Td));let na,$a;this.Of.K("TransitionDoorsHorizontal",($a=new Bd,$a.tf=ResourceStrings.L_TransitionHorizontal,$a.Ef=db.Yf("TransitionDoorsHorizontal"),$a.wf=(na=new od,na.TransitionType=ce.Kwi,na.Direction=Wd.Lih,na.Duration=1400,na.IsManualAdvance=!0,na),$a.parent="TransitionDoors",$a))}if(!Array.contains(tc,"box")){let xc,hd;this.Of.K("TransitionBox",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionBox,hd.Ef=db.Yf("TransitionBoxFromRight"),
hd.wf=(xc=new od,xc.TransitionType=ce.Ata,xc.Direction=Wd.Tsl,xc.Duration=1600,xc.IsManualAdvance=!0,xc),hd.parent="TransitionBox",hd.next="TransitionBoxFromRight",hd));let Fd,Td;this.Of.K("TransitionBoxFromRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionFromRight,Td.Ef=db.Yf("TransitionBoxFromRight"),Td.wf=(Fd=new od,Fd.TransitionType=ce.Ata,Fd.Direction=Wd.Tsl,Fd.Duration=1600,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionBox",Td.next="TransitionBoxFromBottom",Td));let na,$a;this.Of.K("TransitionBoxFromBottom",
($a=new Bd,$a.tf=ResourceStrings.L_TransitionFromBottom,$a.Ef=db.Yf("TransitionBoxFromBottom"),$a.wf=(na=new od,na.TransitionType=ce.Ata,na.Direction=Wd.cKm,na.Duration=1600,na.IsManualAdvance=!0,na),$a.parent="TransitionBox",$a.next="TransitionBoxFromLeft",$a));let Fb,Xb;this.Of.K("TransitionBoxFromLeft",(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionFromLeft,Xb.Ef=db.Yf("TransitionBoxFromLeft"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.Ata,Fb.Direction=Wd.iKm,Fb.Duration=1600,Fb.IsManualAdvance=!0,Fb),
Xb.parent="TransitionBox",Xb.next="TransitionBoxFromTop",Xb));let nc,Nc;this.Of.K("TransitionBoxFromTop",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionFromTop,Nc.Ef=db.Yf("TransitionBoxFromTop"),Nc.wf=(nc=new od,nc.TransitionType=ce.Ata,nc.Direction=Wd.qKm,nc.Duration=1600,nc.IsManualAdvance=!0,nc),Nc.parent="TransitionBox",Nc))}if(!Array.contains(tc,"comb")){let xc,hd;this.Of.K("TransitionComb",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionComb,hd.Ef=db.Yf("TransitionCombHorizontal"),hd.wf=(xc=new od,
xc.TransitionType=ce.mhi,xc.Direction=Wd.none,xc.Duration=1E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionComb",hd.next="TransitionCombHorizontal",hd));let Fd,Td;this.Of.K("TransitionCombHorizontal",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionHorizontal,Td.Ef=db.Yf("TransitionCombHorizontal"),Td.wf=(Fd=new od,Fd.TransitionType=ce.mhi,Fd.Direction=Wd.Lih,Fd.Duration=1E3,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionComb",Td.next="TransitionCombVertical",Td));let na,$a;this.Of.K("TransitionCombVertical",
($a=new Bd,$a.tf=ResourceStrings.L_TransitionVertical,$a.Ef=db.Yf("TransitionCombVertical"),$a.wf=(na=new od,na.TransitionType=ce.mhi,na.Direction=Wd.qLd,na.Duration=1E3,na.IsManualAdvance=!0,na),$a.parent="TransitionComb",$a))}if(!Array.contains(tc,"zoom")){let xc,hd;this.Of.K("TransitionZoom",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionZoom,hd.Ef=db.Yf("TransitionZoomIn"),hd.wf=(xc=new od,xc.TransitionType=ce.zoom,xc.Direction=Wd.UIf,xc.Duration=900,xc.IsManualAdvance=!0,xc),hd.parent="TransitionZoom",
hd.next="TransitionZoomIn",hd));let Fd,Td;this.Of.K("TransitionZoomIn",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionIn,Td.Ef=db.Yf("TransitionZoomIn"),Td.wf=(Fd=new od,Fd.TransitionType=ce.zoom,Fd.Direction=Wd.UIf,Fd.Duration=900,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionZoom",Td.next="TransitionZoomOut",Td));let na,$a;this.Of.K("TransitionZoomOut",($a=new Bd,$a.tf=ResourceStrings.L_TransitionOut,$a.Ef=db.Yf("TransitionZoomOut"),$a.wf=(na=new od,na.TransitionType=ce.zoom,na.Direction=Wd.y_i,
na.Duration=900,na.IsManualAdvance=!0,na),$a.parent="TransitionZoom",$a.next="TransitionZoomAndRotate",$a));let Fb,Xb;this.Of.K("TransitionZoomAndRotate",(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionZoomAndRotate,Xb.Ef=db.Yf("TransitionNewsFlash"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.w0n,Fb.Direction=Wd.none,Fb.Duration=1500,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionZoom",Xb))}if(!Array.contains(tc,"random")){let xc,hd;this.Of.K("TransitionRandom",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionRandom,
hd.Ef=db.Yf("TransitionRandom"),hd.wf=(xc=new od,xc.TransitionType=ce.random,xc.Direction=Wd.FVm,xc.Duration=1500,xc.IsManualAdvance=!0,xc),hd.parent="TransitionRandom",hd))}}if(!Array.contains(tc,"menusectiondynamiccontent")){if(!Array.contains(tc,"pan")){let xc,hd;this.Of.K("TransitionPan",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionPan,hd.Ef=db.Yf("TransitionPanFromBottom"),hd.wf=(xc=new od,xc.TransitionType=ce.pan,xc.Direction=Wd.D7c,xc.Duration=1300,xc.IsManualAdvance=!0,xc),hd.parent="TransitionPan",
hd.next="TransitionPanFromBottom",hd));this.Of.K("TransitionPanFromBottom",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromBottom,Ef:db.Yf("TransitionPanFromBottom"),wf:Object.assign(new od,{TransitionType:ce.pan,Direction:Wd.D7c,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromLeft"}));this.Of.K("TransitionPanFromLeft",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromLeft,Ef:db.Yf("TransitionPanFromLeft"),wf:Object.assign(new od,{TransitionType:ce.pan,
Direction:Wd.Muc,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromRight"}));this.Of.K("TransitionPanFromRight",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromRight,Ef:db.Yf("TransitionPanFromRight"),wf:Object.assign(new od,{TransitionType:ce.pan,Direction:Wd.Rib,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromTop"}));this.Of.K("TransitionPanFromTop",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionFromTop,Ef:db.Yf("TransitionPanFromTop"),
wf:Object.assign(new od,{TransitionType:ce.pan,Direction:Wd.gCe,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan"}))}if(!Array.contains(tc,"conveyor")){this.Of.K("TransitionConveyor",Object.assign(new Bd,{tf:ResourceStrings.L_TransitionConveyor,Ef:db.Yf("TransitionConveyorRight"),wf:Object.assign(new od,{TransitionType:ce.zli,Direction:Wd.Rib,Duration:1600,IsManualAdvance:!0}),parent:"TransitionConveyor",next:"TransitionConveyorFromRight"}));let xc,hd;this.Of.K("TransitionConveyorFromRight",
(hd=new Bd,hd.tf=ResourceStrings.L_TransitionFromRight,hd.Ef=db.Yf("TransitionConveyorRight"),hd.wf=(xc=new od,xc.TransitionType=ce.zli,xc.Direction=Wd.Rib,xc.Duration=1600,xc.IsManualAdvance=!0,xc),hd.parent="TransitionConveyor",hd.next="TransitionConveyorFromLeft",hd));let Fd,Td;this.Of.K("TransitionConveyorFromLeft",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionFromLeft,Td.Ef=db.Yf("TransitionConveyorLeft"),Td.wf=(Fd=new od,Fd.TransitionType=ce.zli,Fd.Direction=Wd.Muc,Fd.Duration=1600,Fd.IsManualAdvance=
!0,Fd),Td.parent="TransitionConveyor",Td))}if(!Array.contains(tc,"rotate")){let xc,hd;this.Of.K("TransitionRotate",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionRotate,hd.Ef=db.Yf("TransitionRotateLeft"),hd.wf=(xc=new od,xc.TransitionType=ce.Ata,xc.Direction=Wd.Wsl,xc.Duration=2E3,xc.IsManualAdvance=!0,xc),hd.parent="TransitionRotate",hd.next="TransitionRotateFromRight",hd));let Fd,Td;this.Of.K("TransitionRotateFromRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionFromRight,Td.Ef=db.Yf("TransitionRotateLeft"),
Td.wf=(Fd=new od,Fd.TransitionType=ce.Ata,Fd.Direction=Wd.Wsl,Fd.Duration=2E3,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionRotate",Td.next="TransitionRotateFromBottom",Td));let na,$a;this.Of.K("TransitionRotateFromBottom",($a=new Bd,$a.tf=ResourceStrings.L_TransitionFromBottom,$a.Ef=db.Yf("TransitionRotateTop"),$a.wf=(na=new od,na.TransitionType=ce.Ata,na.Direction=Wd.hKm,na.Duration=2E3,na.IsManualAdvance=!0,na),$a.parent="TransitionRotate",$a.next="TransitionRotateFromLeft",$a));let Fb,Xb;this.Of.K("TransitionRotateFromLeft",
(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionFromLeft,Xb.Ef=db.Yf("TransitionRotateRight"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.Ata,Fb.Direction=Wd.mKm,Fb.Duration=2E3,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionRotate",Xb.next="TransitionRotateFromTop",Xb));let nc,Nc;this.Of.K("TransitionRotateFromTop",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionFromTop,Nc.Ef=db.Yf("TransitionRotateBottom"),Nc.wf=(nc=new od,nc.TransitionType=ce.Ata,nc.Direction=Wd.vKm,nc.Duration=2E3,nc.IsManualAdvance=!0,nc),
Nc.parent="TransitionRotate",Nc))}if(!Array.contains(tc,"window")){let xc,hd;this.Of.K("TransitionWindow",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionWindow,hd.Ef=db.Yf("TransitionWindowVertical"),hd.wf=(xc=new od,xc.TransitionType=ce.window,xc.Direction=Wd.qLd,xc.Duration=1500,xc.IsManualAdvance=!0,xc),hd.parent="TransitionWindow",hd.next="TransitionWindowVertical",hd));let Fd,Td;this.Of.K("TransitionWindowVertical",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionVertical,Td.Ef=db.Yf("TransitionWindowVertical"),
Td.wf=(Fd=new od,Fd.TransitionType=ce.window,Fd.Direction=Wd.qLd,Fd.Duration=1500,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionWindow",Td.next="TransitionWindowHorizontal",Td));let na,$a;this.Of.K("TransitionWindowHorizontal",($a=new Bd,$a.tf=ResourceStrings.L_TransitionHorizontal,$a.Ef=db.Yf("TransitionWindowHorizontal"),$a.wf=(na=new od,na.TransitionType=ce.window,na.Direction=Wd.Lih,na.Duration=1500,na.IsManualAdvance=!0,na),$a.parent="TransitionWindow",$a))}if(!Array.contains(tc,"orbit")){let xc,
hd;this.Of.K("TransitionOrbit",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionOrbit,hd.Ef=db.Yf("TransitionOrbitFromRight"),hd.wf=(xc=new od,xc.TransitionType=ce.Ata,xc.Direction=Wd.Vsl,xc.Duration=1600,xc.IsManualAdvance=!0,xc),hd.parent="TransitionOrbit",hd.next="TransitionOrbitFromRight",hd));let Fd,Td;this.Of.K("TransitionOrbitFromRight",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionFromRight,Td.Ef=db.Yf("TransitionOrbitFromRight"),Td.wf=(Fd=new od,Fd.TransitionType=ce.Ata,Fd.Direction=Wd.Vsl,Fd.Duration=
1600,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionOrbit",Td.next="TransitionOrbitFromBottom",Td));let na,$a;this.Of.K("TransitionOrbitFromBottom",($a=new Bd,$a.tf=ResourceStrings.L_TransitionFromBottom,$a.Ef=db.Yf("TransitionOrbitFromBottom"),$a.wf=(na=new od,na.TransitionType=ce.Ata,na.Direction=Wd.gKm,na.Duration=1600,na.IsManualAdvance=!0,na),$a.parent="TransitionOrbit",$a.next="TransitionOrbitFromLeft",$a));let Fb,Xb;this.Of.K("TransitionOrbitFromLeft",(Xb=new Bd,Xb.tf=ResourceStrings.L_TransitionFromLeft,
Xb.Ef=db.Yf("TransitionOrbitFromLeft"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.Ata,Fb.Direction=Wd.lKm,Fb.Duration=1600,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionOrbit",Xb.next="TransitionOrbitFromTop",Xb));let nc,Nc;this.Of.K("TransitionOrbitFromTop",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionFromTop,Nc.Ef=db.Yf("TransitionOrbitFromTop"),Nc.wf=(nc=new od,nc.TransitionType=ce.Ata,nc.Direction=Wd.uKm,nc.Duration=1600,nc.IsManualAdvance=!0,nc),Nc.parent="TransitionOrbit",Nc))}if(!Array.contains(tc,
"flythrough")){let xc,hd;this.Of.K("TransitionFlyThrough",(hd=new Bd,hd.tf=ResourceStrings.L_TransitionFlyThrough,hd.Ef=db.Yf("TransitionFlyThroughIn"),hd.wf=(xc=new od,xc.TransitionType=ce.lyf,xc.Direction=Wd.UIf,xc.Duration=800,xc.IsManualAdvance=!0,xc),hd.parent="TransitionFlyThrough",hd.next="TransitionFlyThroughIn",hd));let Fd,Td;this.Of.K("TransitionFlyThroughIn",(Td=new Bd,Td.tf=ResourceStrings.L_TransitionIn,Td.Ef=db.Yf("TransitionFlyThroughIn"),Td.wf=(Fd=new od,Fd.TransitionType=ce.lyf,Fd.Direction=
Wd.UIf,Fd.Duration=800,Fd.IsManualAdvance=!0,Fd),Td.parent="TransitionFlyThrough",Td.next="TransitionFlyThroughOut",Td));let na,$a;this.Of.K("TransitionFlyThroughOut",($a=new Bd,$a.tf=ResourceStrings.L_TransitionOut,$a.Ef=db.Yf("TransitionFlyThroughOut"),$a.wf=(na=new od,na.TransitionType=ce.lyf,na.Direction=Wd.y_i,na.Duration=800,na.IsManualAdvance=!0,na),$a.parent="TransitionFlyThrough",$a.next="TransitionFlyThroughInWithBounce",$a));let Fb,Xb;this.Of.K("TransitionFlyThroughInWithBounce",(Xb=new Bd,
Xb.tf=ResourceStrings.L_TransitionInWithBounce,Xb.Ef=db.Yf("TransitionFlyThroughIn"),Xb.wf=(Fb=new od,Fb.TransitionType=ce.lyf,Fb.Direction=Wd.LJm,Fb.Duration=900,Fb.IsManualAdvance=!0,Fb),Xb.parent="TransitionFlyThrough",Xb.next="TransitionFlyThroughOutWithBounce",Xb));let nc,Nc;this.Of.K("TransitionFlyThroughOutWithBounce",(Nc=new Bd,Nc.tf=ResourceStrings.L_TransitionOutWithBounce,Nc.Ef=db.Yf("TransitionFlyThroughOut"),Nc.wf=(nc=new od,nc.TransitionType=ce.lyf,nc.Direction=Wd.MJm,nc.Duration=900,
nc.IsManualAdvance=!0,nc),Nc.parent="TransitionFlyThrough",Nc))}}this.Of.forEach((xc,hd)=>{xc===hd.parent&&++Rb;return!0})}y8c(ka){let ib=null;ka?this.Of.forEach((Rb,tc)=>{tc.wf&&tc.wf.TransitionType===ka.TransitionType&&tc.wf.Direction===ka.Direction&&(ib=Rb);return!0}):ib="TransitionNone";return ib}nEa(ka){return this.Of.ha(ka)}bDe(ka){return(ka=this.y8c(ka))?this.Of.ha(this.Of.ha(ka).parent):null}z8c(ka){return(ka=this.y8c(ka))?this.Of.ha(ka).parent:null}Evl(ka){let ib,Rb=null;ib=null;ka&&ka.next&&
(ib=ka.next,Rb=this.nEa(ib));return{returnValue:Rb,key:ib}}DCe(){var ka=[db.yKm,db.NCn,db.OCn];for(const ib of ka)if(ka=document.getElementById(ib))return ka;return null}vlh(ka,ib){return ka&&ib&&ib.childNodes?ka.startsWith(db.zKm)?ib.contains(document.getElementById(this.Cdn?ka+"-PreviewButton":ka)):!1:!ib&&ka?"TransitionExisting"===ka||"TransitionNone"===ka||"TransitionMorph"===ka||"TransitionCut"===ka||"TransitionFade"===ka||"TransitionPush"===ka||"TransitionWipe"===ka:!1}static Yf(ka){return xb.a.kde+
"_"+ka+"_32x32x32"}}db.yKm="PptRibbon.Transition.Gallery-MaxSize-1-0";db.NCn="Transitions";db.OCn="Transitions-previewWrapper";db.zKm="Transition";Object(m.a)(db,"TransitionHelper",null,[1247]);var gc=a(383),Dc=a(284),Ua=a(1622),Nb=a(1185),hc=a(866),Qc=a(865);class $c{constructor(ka,ib,Rb,tc,xc,hd){this.Hzh=(Fd,Td,na,$a,Fb)=>{if(1===na)return 32;if(!Fb)return Ob.a.J(508045068,822,10,"PictureEffectActor::updatePictureEffects actionData is null"),16;Td=this.ob.ud();if(1!=(null===Td||void 0===Td?void 0:
Td.length))return 16;Td=Td[0];$a=new Nb.a(Td.R6.brightness,Td.R6.contrast,Td.R6.saturation,Td.R6.transparency);if(2===na){na=Fb.Number;Fb=Fb.IsChanged;switch(Fd){case Pb.a.ROe:$a.c2l(na);break;case Pb.a.TOe:$a.g2l(na);break;case Pb.a.aPe:$a.U2l(na);break;case Pb.a.gPe:$a.pDb(na)}if(this.la.Ruc){const Xb={};Xb.value=na;this.sWm(Td,Fd,Xb)}this.la.Ruc||(Td.R6=$a,this.la.RFd&&this.Yte(Td));!Fb&&this.la.RFd||this.vHm($a,Td,Fd)}return 32};this.$Xn=(Fd,Td,na,$a,Fb)=>{if(1===na)return 32;if(!Fb)return Ob.a.J(508045067,
822,10,"PictureEffectActor::updatePictureReflectionEffects actionData is null"),16;Td=this.ob.ud();if(1!=(null===Td||void 0===Td?void 0:Td.length))return 16;Td=Td[0];$a=new hc.a(Td.Cv.transparency,Td.Cv.size,Td.Cv.blur,Td.Cv.distance,Td.Cv.hasReflection);if(2===na){na=Fb.IsChanged;if(Fb.hasOwnProperty("effectType")&&1===Fb.effectType){const Xb=Fb[15],nc=Fb[16],Nc=Fb[17],yd=Fb[18];$a.pwh(Fb[19]);$a.pDb(Xb);$a.aXc(Nc);$a.mh(nc);$a.hXc(yd)}Td.Cv=$a;this.Yte(Td);na&&this.wHm(Td,Fd)}return 32};this.aYn=
(Fd,Td,na,$a,Fb)=>{if(1===na)return 32;if(!Fb)return Ob.a.J(508045066,822,10,"PictureEffectActor::updatePictureShadowEffects actionData is null"),16;Td=this.ob.ud();if(1!=(null===Td||void 0===Td?void 0:Td.length))return 16;Td=Td[0];$a=new Qc.a(Td.lp.color,Td.lp.transparency,Td.lp.size,Td.lp.blur,Td.lp.angle,Td.lp.distance,Td.lp.hasShadow,Td.lp.colorInfo);if(2===na){na=Fb.IsChanged;if(Fb.hasOwnProperty("effectType")&&0===Fb.effectType){const Xb=Fb[8],nc=Fb[9],Nc=Fb[10],yd=Fb[11],Ud=Fb[12],ie=Fb[13],
Be=Fb[20];$a.wwh(Fb[14]);$a.setColor(Xb);$a.pDb(nc);$a.mh(Nc);$a.aXc(yd);$a.Uvh(Ud);$a.hXc(ie);$a.Yvh(Be)}Td.lp=$a;this.Yte(Td);na&&this.xHm(Td,Fd)}return 32};if(!ka)throw Error.argumentNull("actionManager");if(!ib)throw Error.argumentNull("selectionManager");if(!Rb)throw Error.argumentNull("pageView");if(!tc)throw Error.argumentNull("focusManager");if(!xc)throw Error.argumentNull("transactionFactory");if(!hd)throw Error.argumentNull("appSettings");this.ia=ka;this.ob=ib;this.xb=Rb;this.Ma=tc;this.Mb=
xc;this.la=hd}Hb(){this.ia.sa(Pb.a.ROe,Id.a.application,this.Hzh,4);this.ia.sa(Pb.a.TOe,Id.a.application,this.Hzh,4);this.ia.sa(Pb.a.aPe,Id.a.application,this.Hzh,4);this.ia.sa(Pb.a.gPe,Id.a.application,this.Hzh,4);this.ia.sa(Pb.a.Fwh,Id.a.application,this.aYn,4);this.ia.sa(Pb.a.Tth,Id.a.application,this.$Xn,4)}ve(){}sWm(ka,ib,Rb){if(Rb&&(ka=this.Ak(ka))&&ka.Ki&&(ka=ka.Ki))switch(ib){case Pb.a.ROe:ka.yta("ChangePictureBrightness",Rb);break;case Pb.a.TOe:ka.yta("ChangePictureContrast",Rb);break;case Pb.a.aPe:ka.yta("ChangePictureSaturation",
Rb);break;case Pb.a.gPe:ka.yta("ChangePictureTransparency",Rb)}}Yte(ka){var ib;null===(ib=this.Ak(ka).Ki)||void 0===ib?void 0:ib.handleShapeNodeGC2ModelSync()}Ak(ka){return null===ka||void 0===ka?void 0:ka.tc(this.xb.Oa)}vHm(ka,ib,Rb){const tc=this.Mb.Fd(15,void 0,()=>{this.ob.Rj()});try{tc.rc(ib),tc.sc=Rb,this.la.Ruc&&(ib.R6=ka)}finally{null===tc||void 0===tc?void 0:tc.dispose()}}xHm(ka,ib){const Rb=this.Mb.Fd(15,void 0,()=>{this.ob.Rj()});try{Rb.rc(ka),Rb.sc=ib}finally{null===Rb||void 0===Rb?void 0:
Rb.dispose()}}wHm(ka,ib){const Rb=this.Mb.Fd(15,void 0,()=>{this.ob.Rj()});try{Rb.rc(ka),Rb.sc=ib}finally{null===Rb||void 0===Rb?void 0:Rb.dispose()}}}Object(m.a)($c,"PictureEffectsActor",null,[743]);class Hd{constructor(ka,ib,Rb,tc,xc,hd){this.S4c=(Fd,Td,na,$a,Fb)=>{var Xb=(Fd=null===(Xb=this.va.Ga)||void 0===Xb?void 0:Xb.Xb)?this.Ub.Wk(Fd):void 0;if(3!=this.ia.mode)return 8;if(Ef.a("DisablePreviewInSvgMode")&&this.Nab.pta){var nc=[appChrome.actions.updateControlHiddenState("AnimationPreview",!0)];
appChrome.api.dispatch(nc);Ob.a.J(507884371,822,50,"PreviewActor: hide animationPreview buttons in svg mode");return 2}if(1===na)return(null===Xb||void 0===Xb?0:Xb.Bxa)?32:8;if(null===Xb||void 0===Xb||!Xb.Bxa)return 8;na=null!==(nc=null===Fb||void 0===Fb?void 0:Fb.DAn)&&void 0!==nc?nc:Mc.a.create().toString();Ob.a.J(508065501,822,50,"PreviewActor: animationPreview function is called [previewId: {0}]",na);this.wHe.bck(Xb.sid,Xb.ph,na);return 32};this.mac=(Fd,Td,na)=>{if(1===na)return this.wHe.h3d?
32:8;Ob.a.J(508065500,822,50,"PreviewActor: exitAnimationPreview function is called");this.wHe.ofh();return 32};this.yOe=(Fd,Td,na)=>{var $a=(Fd=null===($a=this.va.Ga)||void 0===$a?void 0:$a.Xb)?this.Ub.Wk(Fd):null;Fd=(null===$a||void 0===$a?0:$a.mTa)?this.PRm(Fd):null;if(3!=this.ia.mode)return 8;if(Ef.a("DisablePreviewInSvgMode")&&this.Nab.pta)return na=[appChrome.actions.updateControlHiddenState("TransitionPreview",!0)],appChrome.api.dispatch(na),Ob.a.J(507884370,822,50,"PreviewActor: hide transitionPreview buttons in svg mode"),
2;if(1===na)return(null===$a||void 0===$a?0:$a.mTa)&&Fd?32:8;if(!Fd)return 8;na=Mc.a.create().toString();Ob.a.J(508065503,822,50,"PreviewActor: transitionPreview function is called [previewId: {0}]",na);this.wHe.ick(Fd.sid,Fd.ph,$a.sid,$a.ph,na);return 32};this.GBe=(Fd,Td,na)=>{if(1===na)return this.wHe.h3d?32:8;Ob.a.J(508065502,822,50,"PreviewActor: exitTransitionPreview function is called");this.wHe.ofh();return 32};if(!ka)throw Error.argumentNull("actionManager");if(!ib)throw Error.argumentNull("previewManager");
if(!Rb)throw Error.argumentNull("graphTopologyManager");if(!tc)throw Error.argumentNull("presReader");if(!hd)throw Error.argumentNull("slideShowCoreHelper");this.ia=ka;this.wHe=ib;this.va=Rb;this.Ub=tc;this.D3d=xc;this.Nab=hd}ve(){}Hb(){this.ia.za(Pb.a.S4c,Id.a.view,this.S4c);this.ia.sa(Pb.a.mac,Id.a.view,this.mac,2052);this.D3d&&(this.ia.za(Pb.a.yOe,Id.a.view,this.yOe),this.ia.sa(Pb.a.GBe,Id.a.view,this.GBe,2052))}PRm(ka){let ib=null;for(const Rb of this.Ub.ZJa()){if(Rb.sid==ka.sid&&Rb.cid==ka.cid)return ib;
Rb.ol||(ib=Rb)}return null}}Object(m.a)(Hd,"PreviewActor",null,[743]);class $d{constructor(){this.Sm=this.$=null}get name(){return"PowerPointWebEditor.Advanced"}lc(ka){this.$=ka;this.Sm=this.$.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder").oAb(0,this.name);this.$.register(1227,"PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers").ma().na(()=>new ih(this.$.resolve("Common.IActionManagerExtended")));if(this.$.resolve("PowerPointWebEditor.IApplicationSettings").NN){const ib=gc.a(this.$);
this.$.register(1228,"PowerPointWebEditor.IAudioManagerStore").ma().na(()=>new vd);this.$.register(1229,"PowerPointWebEditor.IAudioLibraryCallbackFactory").ma().na(()=>new zc(this.$.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("Common.IActionManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings").NN,this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.$.Na("PowerPointWebEditor.IAudioManagerStore")));
this.$.register(1230,"PowerPointWebEditor.IAudioManagerFactory").ma().na(()=>new lc(this.$.resolve("PowerPointWebEditor.IAudioLibraryCallbackFactory"),ib,this.$.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.$.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.$.resolve("PowerPointWebEditor.IAudioManagerFactory");this.$.resolve("PowerPointWebEditor.IAudioManagerStore")}}init(){let ka=this.Sm.qI("resolve");var ib=this.$.resolve("Common.AFrameworkApplication");const Rb=this.$.resolve("PowerPointWebEditor.IApplicationContext"),
tc=Rb.Md;ib=ib.nj;const xc=this.$.resolve("Common.IActionManagerExtended"),hd=this.$.resolve("PowerPointWebEditor.IFocusManager");ib=ib.Pd;const Fd=this.$.resolve("Common.Transaction.ITransactionFactory"),Td=this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),na=this.$.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),$a=this.$.resolve("PowerPointWebEditor.PictureContext"),Fb=this.$.resolve("PowerPoint.IPathManager");var Xb=this.$.resolve("PowerPointWebEditor.IPresentationReader");
const nc=this.$.resolve("PowerPointWebEditor.IShapeReader"),Nc=this.$.resolve("PowerPointWebEditor.IPictureUploader"),yd=this.$.ge("PowerPointWebEditor.IPPTLanguageDialogFactory"),Ud=this.$.resolve("Box4.IParagraphReader");this.Sm.uI(ka);ka=this.Sm.qI("regactors");Xb=[new rh(xc,Td,this.$.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),this.$.resolve("Box4.IParagraphIndentationReader"),this.$.resolve("Common.Transaction.ITransactionFactory"),Ud,this.$.resolve("PowerPointWebEditor.IPPTParagraphReader"),
nc,this.$.resolve("PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers"),Rc.App.EDb.e6c(12),tc.fOe),new kb(xc,hd,na,Fd,Td,Fb,ib,this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Xb,new Ba,tc.Pkh,this.$.resolve("Common.IAppSettingsManager").getBooleanAppSetting("ChangingThemeSelectedSlidesEnabled"),this.$.resolve("Common.IAppSettingsManager").getBooleanAppSetting("EnableDefaultThemeRefresh"),this.$.resolve("PowerPointWebEditor.IApplicationSettings")),new Ab(xc,ib,this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Fd,Td,hd,new db(tc.kRa,null===tc||void 0===tc?void 0:tc.getBooleanAppSetting("AppGalleryPreviewButtonIdIsEnabled")),na,tc,Fb,this.$.resolve("PowerPointWebEditor.View.IPPTPageView"))];tc.fKb?Xb.push(new df(xc,Td,hd,Fd,new Yd(tc.Gcf),na,nc,Fb,this.$.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(8),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.$.resolve("PowerPointWebEditor.ISlideReader"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.IRibbonUser"),tc.s4c,this.$.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),tc.isAnimationPreviewEnabled?this.$.resolve("PowerPointWebEditor.IPreviewFrame"):null,tc.isAnimationPreviewEnabled?this.$.resolve("PowerPointWebEditor.AnimationPreviewToast"):null,this.$.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),
tc.pSl,tc.isAnimationPreviewEnabled?this.$.resolve("PowerPointWebEditor.ISlideShowCoreHelper"):null)):Xb.push(new Ca(xc,this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Td,hd,Fd,new Yd(tc.Gcf),na,this.$.resolve("PowerPointWebEditor.IApplicationSettings"),nc,Fb));tc.Dcd&&Xb.push(new Jd(xc,hd,na,Td,Fd,ib,this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Nc,$a,u.AFrameworkApplication.a1,this.$.resolve("PowerPointWebEditor.IErrorHandler"),tc));tc.ync&&Xb.push(new $c(xc,
Td,this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("PowerPointWebEditor.IApplicationSettings")));tc.cAb&&u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.PictureBGREnabled",!1)&&Xb.push(new Ua.a(xc,this.$.resolve("PowerPointWebEditor.Core.IAppOfflineSetter"),Td,this.$.resolve("PowerPointWebEditor.Image.IImageManager"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("PowerPointWebEditor.IRibbonChangeManager"),this.$.resolve("PowerPointWebEditor.IImageIdHelper"),this.$.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));tc.isAnimationPreviewEnabled&&Xb.push(new Hd(xc,this.$.resolve("PowerPointWebEditor.IPreviewManager"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.$.resolve("PowerPointWebEditor.IPresentationReader"),tc.wlh,this.$.resolve("PowerPointWebEditor.ISlideShowCoreHelper")));for(const ie of Xb)ie.Hb(),ie.ve();this.Sm.uI(ka);u.AFrameworkApplication.ga.fg(()=>{ka=this.Sm.qI("regfullactors");const ie=[],Be=this.$.resolve("Box4.Proofing.IProofingFeatureConfiguration");Be.T$a=this.$.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Dc.a.ztb);Rb.Md.CCb&&ie.push(new Bf(xc,yd,Be,this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.Na("Box4.Proofing.ICritiqueTypeSettings"),
this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("Box4.ILanguageReader"),this.$.resolve("Box4.Proofing.IErrorRangeEditor"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("Box4.IProofingManager"),Td));this.$.resolve("PowerPointWebEditor.IApplicationSettings").bbc&&ie.push(new Eg(xc,hd,Td,gc.a(this.$),this.$.resolve("Common.IAppSettingsManager")));for(const oe of ie)oe.Hb(),oe.ve();Be.T$a&&
(new fc(xc,this.$.resolve("Box4.Proofing.ICritiqueTypeSettings"),(oe,rf)=>new Oc(oe,this.$.resolve("Box4.Proofing.IProofingConfigV2Manager"),rf,this.$.resolve("Common.IFocusManager")),this.$.resolve("Box4.Proofing.IProofingConfigV2Manager"),Td,this.$.resolve("Box4.ILanguageReader"),nc)).Hb();this.Sm.uI(ka)})}dispose(){}}Object(m.a)($d,"AdvancedPackage",null,[3,4]);class ue{get container(){return Mb.a.instance.resolve("PowerPointWebEditor.IRibbonPane").ta}}Object(m.a)(ue,"PPTFloatPaneContainer",null,
[1189]);class Fe{constructor(ka,ib,Rb=null){this.u8d=new pf.a(0);this.qcd=null;this.xde=this.qcd=Rc.App.ep;this.xEj=ka;this.KMl=1E3*ib;this.RIl=Rb||(()=>(new Date).getTime())}Qtm(ka){this.xEj&&this.u8d.add(ka,(new Date).getTime())}Ypl(ka){this.xEj&&(this.u8d.remove(ka),this.QUn(this.RIl()-this.KMl))}QUn(ka){if(this.u8d.count){var ib=[];this.u8d.forEach((Rb,tc)=>{tc<ka&&ib.push(Rb);return!0});for(const Rb of ib)this.u8d.remove(Rb)}}get qCl(){return this.xde<=this.qcd}Pyl(){if(!this.xEj||!this.u8d.count)return!1;
let ka=!1;const ib=this.RIl();this.u8d.forEach((Rb,tc)=>ib-tc<this.KMl?(ka=!0,!1):!0);return ka}}Object(m.a)(Fe,"PictureContext",null,[1223]);var cf=a(1196),Ee=a(860);class xe{constructor(){this.ABb=this.uJj=this.oKl=this.pKl=!1;this.Sm=this.Jab=this.rHe=this.vKl=this.$=null;this.X1f=[new $d];this.Vca=[]}get name(){return"PowerPointWebEditor.Chronos"}lc(ka){this.$=ka;this.Jab=this.$.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.Sm=this.Jab.oAb(0,this.name);for(let ib=0;ib<this.X1f.length;++ib)Array.add(this.Vca,
jb.a(this.X1f[ib],0));for(const ib of this.Vca)ib.lc(ka);xe.Xym(ka);this.$.register(Fe,"PowerPointWebEditor.PictureContext").as("PowerPointWebEditor.IPictureContext").ma().na(()=>new Fe(this.$.resolve("PowerPointWebEditor.IApplicationSettings").ZJe,this.$.resolve("PowerPointWebEditor.IApplicationSettings").Kcd))}acd(ka,ib){ka=Hc.a.instance;for(let tc=0;tc<ib.entries.length;tc++){var Rb=ib.entries[tc];Rb.url=r.a.removeParameter(Rb.url,u.AFrameworkApplication.BV);const xc=r.a.hda(Rb.url);let hd=!1;
if("about:blank"===Rb.url||xc.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===xc&&"2"===r.a.NV(Rb.url,"u")||this.ABb&&(hd=xc.endsWith("PowerPoint.ashx"))&&Rb.url.endsWith("ib=1"))Rb.behavior=1;else{if(hd||xc.endsWith("PowerPoint.ashx")||xc.endsWith("GetUpdates")||xc.endsWith("images.ashx")||xc.endsWith("GetThumb"))Rb.behavior=2;if(!this.pKl&&xc.endsWith("PowerPoint.ashx")&&"true"===r.a.NV(Rb.url,Lb.a.SSl))Rb=Rb.ZB,ka.kc(Vc.a.Kki,parseInt(String(Rb.fetchStart))),ka.kc(Vc.a.wzm,parseInt(String(Rb.responseStart))),
ka.kc(Vc.a.rzm,parseInt(String(Rb.responseEnd-Rb.responseStart))),this.pKl=!0;else if(!this.oKl&&xc.endsWith("PowerPoint.ashx")&&"true"===r.a.NV(Rb.url,"dSlide")){this.oKl=!0;Rb=Rb.ZB;ka.kc("SlideImageFetchStart",parseInt(String(Rb.fetchStart)));ka.kc("SlideImageResponseStart",parseInt(String(Rb.responseStart)));ka.kc("SlideImageDownloadDuration",parseInt(String(Rb.responseEnd-Rb.responseStart)));let Fd;({transferSize:Fd}=xe.G8l(Rb)).returnValue&&ka.kc("SlideImageSize",Fd)}else if(!this.uJj&&xc.endsWith("images.ashx")&&
"true"===r.a.NV(Rb.url,"minimalboot")&&r.a.NV(Rb.url,"index")===this.vKl){this.uJj=!0;Rb=Rb.ZB;ka.kc("MBootFetchStart",parseInt(String(Rb.fetchStart)));ka.kc("MBootResponseStart",parseInt(String(Rb.responseStart)));ka.kc("MBootDownload",parseInt(String(Rb.responseEnd-Rb.responseStart)));let Fd;({transferSize:Fd}=xe.G8l(Rb)).returnValue&&ka.kc("MBootSize",Fd)}}}}rMn(){const ka=window.self.FirstSlideRequestIndex;void 0===ka||null===ka?this.uJj=!0:this.vKl=ka.toString()}init(){Ob.a.J(512497358,809,50,
"ChronosPackage::Init");const ka=this.$.resolve("PowerPointWebEditor.IApplicationSettings"),ib=this.$.resolve("Common.ITaskManager");for(var Rb of this.Vca)this.Sm.qI(Rb.name),Rb.init(),this.Sm.uI(Rb.name);this.$.resolve("Common.IAppSettingsManager").fg(()=>{if(ka.Ode){const tc=this.Sm.qI("animationpreview");this.Q1m();this.Sm.uI(tc)}});this.$.resolve("Common.IActionManagerExtended").Bia(this.$.resolve("PowerPointWebEditor.IPasteFloatieHelper"));Rb=Mb.a.instance.resolve("Box4.IProofingManager");if(null!==
Rb){const tc=this.Sm.qI("proofingresume");Rb.resume();this.Sm.uI(tc)}if(ka.Usa||!ka.BTa)Rb=this.Sm.qI("loaddelayedres"),this.$.resolve("PowerPointWebEditor.IPresentationResourcesManager").Uxh(),this.Sm.uI(Rb);this.rMn();this.ABb=ka.jCb;Rb=this.$.resolve("Common.NetworkTiming.IResourceTimingLogger");Rb.lc(30,0);Rb.Nah(Object(K.a)(this,this.acd,"onResourceTimingEntriesAvailable"));Rb.activate();ka.Q$a&&(this.rHe=window.self.PerfMeterData,void 0!==this.rHe&&null!==this.rHe&&(ib.Qb(new Wa.a(3,2,6E4,Object(K.a)(this,
this.collectPerfMeterData,"collectPerfMeterData"),90,"67")),Ob.a.J(512497357,809,50,"CollectPerfMeterData task started"),this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler").sE(()=>{this.collectPerfMeterData(null)})));this.$.resolve("Common.IActionManagerExtended").Bia(this.$.resolve("Box4.ITextPasteFloatieManager"));ka.b$a&&this.$.resolve("Common.IActionManagerExtended").Bia(this.$.resolve("PowerPointWebEditor.EditSurfaceLayoutManager"));this.d9m()}d9m(){Ob.a.J(512497356,809,50,"Start to download chronos1 js file");
this.$.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").tca("pptedit.chronos1",null,null,()=>a.e(5).then(a.bind(null,1675)))}collectPerfMeterData(){if(0<this.rHe.length){const ka=[];for(const ib of this.rHe)ka.push({["Id"]:ib.Id,["Value"]:ib.Value.toFixed(2),["Start"]:ib.Start.toFixed(2),["Duration"]:ib.Duration.toFixed(2)});Ob.a.J(512497355,813,50,JSON.stringify(ka));this.rHe.length=0}}dispose(){for(var ka of this.Vca)ka.dispose();ka=this.$.resolve("Common.NetworkTiming.IResourceTimingLogger");
ka.deactivate(!0);ka.muh(Object(K.a)(this,this.acd,"onResourceTimingEntriesAvailable"))}Q1m(){const ka=Tc.a.create("pptedit.animationpreview",null,()=>a.e(29).then(a.bind(null,1692)));try{cd.a.HL(ka)}catch(ib){Ob.a.J(512497354,809,10,"ChronosPackage::InitializeAnimationPreview - Failed to download animationpreview script, Exception: {0}",ib.toString())}}static Xym(ka){ka.register(1189,"Common.IFloatPaneContainer").ma().na(()=>new ue)}static G8l(ka){ka=parseInt(String(cf.a(ka,"transferSize")));return{returnValue:!ka.toString().startsWith("NaN"),
transferSize:ka}}static main(){u.AFrameworkApplication.mi&&Gb.a.zg?Ob.a.J(512497353,809,15,"Firefox attempts to load chronos package when App is disposing"):(Hc.a.instance.kc(Ee.a.Zch,(new Date).getTime()),L.a.instance.Fc(jb.a(new xe,0)))}}Object(m.a)(xe,"ChronosPackage",null,[3,4]);class cg{constructor(ka,ib,Rb,tc,xc,hd,Fd){this.OHe=this.Ysa=!1;this.va=ka;this.nc=ib;this.Iz=Rb;this.NA=tc;this.u$c=hd;this.Ge=xc;this.aR=this.va.Ga;this.Lc=Fd}initialize(){this.Iz.Am(Object(K.a)(this,this.Gh,"onPropertyChanged"));
this.Ge.c$b(Object(K.a)(this,this.V4a,"onRibbonTabSwitched"));this.NA.Fea(Object(K.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.NA.J4c(Object(K.a)(this,this.$rb,"onShapeViewElementAdded"));this.NA.vfl(Object(K.a)(this,this.ARl,"onShapesAllSelected"))}dispose(){this.Iz.Pq(Object(K.a)(this,this.Gh,"onPropertyChanged"));this.Ge.Uje(Object(K.a)(this,this.V4a,"onRibbonTabSwitched"));this.NA.b6a(Object(K.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.NA.CLe(Object(K.a)(this,
this.$rb,"onShapeViewElementAdded"));this.NA.wZl(Object(K.a)(this,this.ARl,"onShapesAllSelected"))}Gh(ka,ib){ib.property===We.a.F7c&&this.Ysa&&this.nc.Cg(ib.node)===this.aR&&this.eFa(this.Ysa)}V4a(ka,ib){if(this.Ysa=!!ib.Brb&&0<=ib.Brb.indexOf("Animation"))this.OHe=!0;this.eFa(this.Ysa)}$rb(ka,ib){(ka=this.va.Ga)&&ka.ZT&&ka===this.aR&&(ib=ib.cI)&&ib.shapeNode&&this.aR&&this.ACc(this.aR.Xb,ib.shapeNode)&&this.eFa(this.Ysa)}ACc(ka,ib){return ka&&ib?ka.equals(ib.slideId):!1}onActiveSlideDomReady(ka,
ib){(ka=Object(fe.a)(32,ib.Ga))&&this.aR&&this.aR.Xb!==ka.Xb&&(this.aR=ka,this.eFa(this.Ysa))}ARl(){this.avb()}avb(){if(this.Ysa&&this.aR&&this.aR.Bxa&&this.OHe){var ka=this.aR.xj();if(ka&&0<ka.length)for(const ib of ka)ib&&ib.pSb()&&(ka=this.u$c.w$(ib))&&(ka.bjf(),ka.avb(!0))}}eFa(ka){if(this.OHe&&this.aR&&this.aR.ZT&&this.Lc.Yc&&this.Lc.Yc.vbf){var ib=this.aR.xj();if(ib&&0<ib.length)for(const Rb of ib)Rb&&(ib=this.u$c.w$(Rb))&&(ib.visible=ka,ib.aje())}}}Object(m.a)(cg,"AnimationMarkerManagerLegacy",
null,[24]);var Gg=a(30),Of=a(274);class ch{constructor(ka,ib){this.height=ka;this.top=ib}}Object(m.a)(ch,"ParagraphProperties",null,[]);var vg=a(268),jg=a(285),sh=a(336),Zh=a(358),ae=a(385),Wi=a(365),ci=a(484),Fi=a(275);class hh{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb,Xb,nc,Nc,yd,Ud,ie,Be){this.zcg=this.BP=this.JHe=this.Rm=this.mc=!1;this.ua=new Gg.a;this.qdg=this.Xe=1;this.ic=this.IC=this.VB=this.hi=this.Eb=this.Rb=null;this.fh=!1;this.kd=null;this.xo=(oe,rf)=>{rf&&(oe=rf.yA,rf=this.nc.Cg(this.ra),
null!==oe&&void 0!==oe&&oe.zd&&rf&&oe.zd.id===rf.id&&this.updateZoom())};this.xq=oe=>{oe&&this.Soa?(this.Rb=new sh.a,this.Rb.Zv("AnimationMarkerView"),this.Soa.appendChild(this.Rb.ta),this.Eb=new Wi.a,this.Eb.gk(0),this.Rb.appendChild(this.Eb.viewport),this.hi=new Zh.a,this.hi.gk(1),this.hi.setVisibility(!1),this.Eb.appendChild(this.hi),this.VB=new sh.a,this.VB.Zv("ShapeAnimationMarkerContainer"),this.VB.ta.id=this.ra.id.toString(),this.VB.mh(20,this.Rb.ta.clientHeight),this.VB.gk(1),this.Rb.appendChild(this.VB),
this.IC=new sh.a,this.IC.Zv("TextAnimationMarkerContainer"),this.IC.ta.id=this.ra.id.toString(),this.IC.mh(20,this.Rb.ta.clientHeight),this.IC.gk(1),this.Rb.appendChild(this.IC),this.Lg.Zb(Pa.a.gv,this.VB.ta,this.PH),this.Lg.Zb(Pa.a.uy,this.VB.ta,this.PH),this.Lg.Zb(Pa.a.gv,this.IC.ta,this.PH),this.Lg.Zb(Pa.a.uy,this.IC.ta,this.PH),this.Lg.Zb(Pa.a.JU,this.VB.ta,this.D8c),this.Lg.Zb(Pa.a.JU,this.IC.ta,this.D8c),this.Lg.Zb(Pa.a.mouseDown,this.VB.ta,this.D8c),this.Lg.Zb(Pa.a.mouseDown,this.IC.ta,this.D8c),
this.ef.Zb(Pa.a.click,this.IC.ta,this.Qih),this.ef.Zb(Pa.a.click,this.VB.ta,this.Qih),this.setVisibility()):Ob.a.J(509682581,800,10,"AnimationMarkerView: {0} is null",oe?"m_markerViewParentElement":"parent")};this.YZ=()=>!0;this.D8c=oe=>{if(!oe&&!oe.Dc.id.startsWith(xb.a.eKb)&&!oe.Dc.id.startsWith("overlappedMarker"))return Ob.a.J(509682580,800,50,"AnimationMarkerView:handleAnimationMarkerClick source element is not marker"),!1;oe.eventName==Pa.a.JU&&this.g0j(oe);oe=oe.Sb;oe.preventDefault();oe.stopPropagation();
return!0};this.Qih=oe=>{oe=oe.Sb;oe.preventDefault();oe.stopPropagation();return!0};this.setSelection=()=>{};this.setVisibility=()=>{let oe=this.mc&&!this.BP;this.ra&&this.ra.isHiddenShape&&(oe=!1);this.Rb&&this.Rb.he(oe);this.VB&&this.VB.he(oe);this.IC&&this.IC.he(oe)};this.avb=oe=>{if(this.M0a()){this.JHe=oe;oe=[this.VB.ta.childNodes,this.IC.ta.childNodes];for(const rf of oe)for(oe=0;rf&&oe<rf.length;oe++)this.iPg(rf[oe],this.JHe)}};this.IJn=oe=>{if(this.M0a()){var rf=[this.VB.ta.childNodes,this.IC.ta.childNodes];
for(const Vf of rf)for(rf=0;Vf&&rf<Vf.length;rf++){const xg=this.oCe(Vf[rf]);if(!Ef.a("FixAnimationMarkerAttributeNullCrash")||xg)for(const qh of oe)xg.includes(qh)&&this.iPg(Vf[rf],!0)}}};this.oCe=oe=>{if(!oe||!this.ra)return null;oe=oe.getAttribute("AnimProps");if(!oe||!oe.toString()||!oe.toString().trim().length)return null;oe=oe.toString().split(" ");if(!oe||!oe.length)return null;const rf=[];for(const Vf of oe){if(!Vf||!Vf.trim().length)return null;rf.push(Number.parseInvariant(Vf.trim()))}return rf};
this.M0a=()=>{const oe=!!this.ra&&!!this.Soa&&!!this.VB&&!!this.IC;oe||Ob.a.J(509682579,800,10,"AnimationMarkerView: the containers are not exist.");return oe};this.upc=()=>{this.ASa(!0);this.ASa(!1)};this.ASa=oe=>{if(this.Lg&&this.ef&&this.M0a()&&(oe=oe?this.IC.ta:this.VB.ta)&&oe.childNodes&&0<oe.childNodes.length){const rf=oe.childNodes;for(const Vf=0;Vf<rf.length;)oe.removeChild(rf[Vf])}};this.GXh=()=>{if(this.M0a()){var oe=this.nc.Cg(this.ra);if(oe){var rf=oe.lAb(this.ra);if(rf&&rf.length){var Vf=
!1;oe=!1;var xg=[];for(var qh of rf)qh.IsTextRangeType?oe=!0:(Vf=!0,xg.push(qh));this.zcg=Vf&&oe;this.Pxb(!0);this.Pxb(!1);this.ASa(!1);0<xg.length&&(qh=0,xg.sort((k,E)=>k.EffectNodeId-E.EffectNodeId),(qh=Ef.a("FixOverlappedAnimationMarkers")?this.osf(xg,this.ij.YF(this.ra.wt.Xc,this.Xe),this.ij.YF(this.ra.wt.xd-this.ra.wt.Xc,this.Xe),!1,-1):this.Wol(xg,this.ij.YF(this.ra.wt.Xc,this.Xe),this.ij.YF(this.ra.wt.xd-this.ra.wt.Xc,this.Xe),!1))||Ob.a.J(509682577,800,10,"AnimationMarkerView: no shape marker is rendered"));
oe?this.Wzi():this.ASa(!0)}else this.upc()}else Ob.a.J(509682578,800,10,"AnimationMarkerView::addAnimationMarkers: slideNode is null")}};this.Wzi=()=>{const oe=new Wa.a(2,1,0,this.ensureTextIsRenderedAndDrawMarkers,90,"26");this.Tb.Qb(oe)};this.ensureTextIsRenderedAndDrawMarkers=()=>{this.Rm||(this.XDj(),this.ysf())};this.ysf=()=>{this.ASa(!0);if(this.y7i()){var oe=this.AVi();if(oe&&oe.length){var rf;if(({top:rf}=this.YVi()).returnValue){var Vf=0;for(let qh=0;qh<oe.length;qh++){var xg=this.nc.Cg(this.ra);
if(!xg){Ob.a.J(509682574,800,10,"AnimationMarkerView:drawTextAnimationMarkers slide node is null.");return}(xg=xg.LCe(this.ra,qh))&&0<xg.length&&oe[qh]&&(xg.sort((k,E)=>k.EffectNodeId-E.EffectNodeId),Vf=Ef.a("FixOverlappedAnimationMarkers")?Vf+this.osf(xg,oe[qh].top-rf,oe[qh].height,!0,qh):Vf+this.Wol(xg,oe[qh].top-rf,oe[qh].height,!0))}Vf||Ob.a.J(509682573,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Ob.a.J(509682575,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Ob.a.J(509682576,
800,50,"AnimationMarkerView: the paragrph view is not rendered")}};this.AVi=()=>{const oe=[];var rf=yf.GraphIterator.pb(this.ra);rf=this.un.oca(rf,rf.currentNode);for(var Vf;rf.moveNext();)(Vf=rf.currentNode)&&this.Cj.me(Vf)&&Vf&&(Vf=Vf.tc(this.yB))&&Vf.htmlElement&&(Vf=this.rKa(Vf.htmlElement))&&Vf.height&&oe.push(Vf);return oe};this.rKa=oe=>{if(!oe)return Ob.a.J(509682570,800,10,"AnimationMarkerView:getParagraphProperties paragraph is null"),null;oe=oe.querySelectorAll(".TextRun");if(!oe||!oe.length)return null;
let rf=0,Vf=0;let xg,qh=!1;for(let E=0;E<oe.length&&oe[E];E++){var k=oe[E].getClientRects();({top:k,bottom:xg}=this.NDi(k)).returnValue&&(E?(rf=rf>k?k:rf,Vf=Vf<xg?xg:Vf):(rf=k,Vf=xg),qh=!0)}if(qh)return new ch(Vf-rf,rf);Ob.a.J(509682569,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null};this.QP=()=>{this.UPj(this.Rb.ta,!0)};this.y7i=()=>{var oe=this.nc.Cg(this.ra);if(!oe)return Ob.a.J(509682567,800,10,"AnimationMarkerView::hasTextAnimations: slideNode is null"),!1;
oe=oe.lAb(this.ra);if(!oe||!oe.length)return!1;for(const rf of oe)if(rf.IsTextRangeType)return!0;return!1};this.Pxb=oe=>{if(this.M0a()){var rf=oe?this.VB.ta:this.IC.ta,Vf,xg;rf&&({x:Vf,y:xg}=this.zQi(oe)).returnValue&&(rf.style.position=jg.a.absolute,rf.style.left=vg.a.Uc(Vf),rf.style.zIndex="20000",oe?rf.style.top=vg.a.Uc(xg):this.ysf())}};this.g0j=oe=>{if(this.ua&&oe&&this.Ma&&oe.Dc){var rf=Ef.a("FixOverlappedAnimationMarkers")?oe.Dc.id.startsWith("overlappedMarker")&&oe.Dc.parentElement?oe.Dc.parentElement:
oe.Dc:oe.Dc.id.startsWith("overlappedMarker")&&oe.Dc.offsetParent?oe.Dc.offsetParent:oe.Dc;(rf=this.oCe(rf))?(oe.ctrlKey?this.ot.SVm(rf,this.nc.Cg(this.ra)):(this.ot.VMe(!1),this.ot.usa(),this.ot.VMe(!0),this.ot.WZh(rf,this.nc.Cg(this.ra))),this.ua.raiseEvent("OnMarkerClick",oe),this.Ma.Wd()):Ob.a.J(509682566,800,10,"AnimationMarkerView: failed to parse the animation properties.")}};this.Km=()=>{this.Eb&&(this.f1c(),this.Eb.Km())};this.f1c=()=>{if(this.ra&&this.hi){var oe=this.ra.wt.points;oe=hh.PHa(oe,
this.dxc());this.hi.ox(oe)}};this.dxc=()=>{let oe=xb.a.O5b;this.ra.rg||!this.ra.F5&&!this.ra.pl||(oe+=6);return oe};this.Qt=()=>{this.Eb&&this.qdg!==this.Xe&&this.aje();return null};this.Vu=()=>{};this.Kz=()=>{};this.Yi=oe=>{this.qdg=this.Xe;this.Xe=oe};this.setZIndex=oe=>{this.Eb&&this.Eb.AG(oe)};this.draw=()=>{this.aje()};this.LDn=(oe,rf=!0)=>{this.Rb&&this.Soa&&this.mc&&!this.BP&&this.Onm(oe,rf);this.updateZoom();this.setVisibility()};this.Onm=(oe,rf=!0)=>{this.M0a()&&(this.nc.Cg(this.ra)?(this.Pxb(!0),
this.Pxb(!1),this.ASa(!0),this.ASa(!1),this.JFm(oe,rf)):Ob.a.J(507881296,800,10,"AnimationMarkerView::addAnimationMarkers: slideNode is null"))};this.aje=()=>{this.Rb&&this.Soa&&this.mc&&!this.BP&&(this.upc(),this.GXh());this.updateZoom();this.setVisibility()};this.PH=oe=>{if(!this.ua||!oe)return!1;this.ua.raiseEvent("OnSelectionAreaHover",oe);oe.eventName===Pa.a.gv?this.Q6a(oe.Dc,"animMarkerHovered",1):oe.eventName===Pa.a.uy&&this.Q6a(oe.Dc,"animMarkerHovered",2);return!0};this.iPg=(oe,rf)=>{oe?
rf?(this.Q6a(oe,"animMarkerUnselected",2),this.Q6a(oe,"animMarkerSelected",1)):(this.Q6a(oe,"animMarkerSelected",2),this.Q6a(oe,"animMarkerUnselected",1)):Ob.a.J(509682565,800,10,"AnimationMarkerView:selectMarker domElement is null")};this.Q6a=(oe,rf,Vf)=>{const xg=this.Vih(oe);switch(Vf){case 0:oe.setAttribute(jg.a.oYa,rf);xg&&oe.lastChild.setAttribute(jg.a.oYa,rf);break;case 1:Sys.UI.DomElement.addCssClass(oe,rf);xg&&Sys.UI.DomElement.addCssClass(oe.lastChild,rf);break;case 2:Sys.UI.DomElement.removeCssClass(oe,
rf),xg&&Sys.UI.DomElement.removeCssClass(oe.lastChild,rf)}};this.Vih=oe=>!!oe&&!!oe.lastChild&&!!oe.lastChild.id&&"overlappedMarker"===oe.lastChild.id;this.setPosition=()=>{};this.LP=oe=>{this.BP=oe;this.BP||(this.KB(),this.avb(!0));this.setVisibility()};this.vP=()=>null;this.hD=()=>{};this.iL=()=>[];this.hG=()=>{};this.KR=()=>{};this.KB=()=>{!this.Rm&&this.Soa&&(this.Pxb(!0),this.Pxb(!1))};this.beh=()=>{const oe=new ae.a;oe.mh(10,10);oe.ta.setAttribute(jg.a.oYa,"pointer-events-none");oe.AUa("0 0 2048 2048");
const rf=new Zh.a;rf.Bka("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");rf.mN("#E67E22");rf.GB("#FFFF00");rf.Mw(5);oe.appendChild(rf);return oe.ta};if(!ka)throw Error.argumentNull("shapeNode");if(!ib)throw Error.argumentNull("slideReader");if(!Rb)throw Error.argumentNull("traverserFactory");if(!tc)throw Error.argumentNull("paragraphReader");
if(!Fd)throw Error.argumentNull("activeSlideViewManager");if(!Td)throw Error.argumentNull("mouseInputManager");if(!na)throw Error.argumentNull("clickInputManager");if(!$a)throw Error.argumentNull("focusManagers");if(!yd)throw Error.argumentNull("effectSelectionManager");if(!Xb)throw Error.argumentNull("pptUnitConversion");this.ra=ka;this.nc=ib;this.un=Rb;this.Cj=tc;this.yB=hd;this.UPj=xc;this.Soa=Fd.Yc?Fd.Yc.vbf:null;this.LOj=Fd.Yc?Fd.Yc.xNe:null;this.Lg=Td;this.ef=na;this.Ma=$a;this.Tb=Fb;this.h2a=
nc;this.XDj=Nc;this.ij=Xb;this.ot=yd;this.ic=Ud;this.kd=Be;(this.fh=ie.getBooleanAppSetting(Fi.a.tI))&&this.ic.TSa&&this.kd.qSa(this.xo)}dispose(){this.Rm||(this.h2a(),this.Rm=!0,this.mc=!1,this.upc(),this.ef&&this.VB&&this.ef.jc(Pa.a.click,this.VB.ta,this.Qih),this.Lg&&this.VB&&(this.Lg.jc(Pa.a.gv,this.VB.ta,this.PH),this.Lg.jc(Pa.a.uy,this.VB.ta,this.PH),this.Lg.jc(Pa.a.JU,this.VB.ta,this.D8c),this.Lg.jc(Pa.a.mouseDown,this.VB.ta,this.D8c)),this.fh&&this.ic.TSa&&this.kd.VCb(this.xo),this.VB=null,
this.ef&&this.IC&&this.ef.jc(Pa.a.click,this.IC.ta,this.Qih),this.Lg&&this.IC&&(this.Lg.jc(Pa.a.gv,this.IC.ta,this.PH),this.Lg.jc(Pa.a.uy,this.IC.ta,this.PH),this.Lg.jc(Pa.a.JU,this.IC.ta,this.D8c),this.Lg.jc(Pa.a.mouseDown,this.IC.ta,this.D8c)),this.Ma=this.Cj=this.ra=this.un=this.nc=this.ij=this.ot=this.Eb=this.hi=this.Soa=this.Rb=this.IC=null)}get visible(){return this.mc}set visible(ka){this.mc=ka}get rr(){return this.Eb}get Yn(){return this.hi}get Yd(){return this.Rb}YVi(){return this.getClientRects(this.LOj)}getClientRects(ka){let ib,
Rb;ib=Rb=0;if(!ka)return Ob.a.J(509682572,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:ib,top:Rb};ka=ka.getClientRects();if(!ka||!ka.length||!ka[0])return Ob.a.J(509682571,800,10,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:ib,top:Rb};Rb=Math.round(ka[0].top);ib=Math.round(ka[0].left);return{returnValue:!0,left:ib,top:Rb}}NDi(ka){let ib,Rb;ib=Rb=0;if(!ka||!ka.length||!ka[0])return Ob.a.J(509682568,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),
{returnValue:!1,top:ib,bottom:Rb};ib=ka[0].top;Rb=ka[0].bottom;for(let tc=1;tc<ka.length&&ka[tc];tc++)ib=ka[tc].top>ib?ib:ka[tc].top,Rb=ka[tc].bottom<Rb?Rb:ka[tc].bottom;return{returnValue:!0,top:ib,bottom:Rb}}Wol(ka,ib,Rb,tc){if(!this.M0a()||!ka||!ka.length)return 0;const xc=tc?this.IC.ta:this.VB.ta;Rb=(Rb=Math.floor(this.ij.Nr(Rb)/21))?Rb:1;let hd=0,Fd=null,Td=null,na=!0,$a=!1;for(let nc=0;nc<ka.length;nc++){const Nc=ka[nc];var Fb=new sh.a;Fb.ta.id=xb.a.eKb+Nc.ClickOrder;Fb.mh(20,16);Fb.gk(1);if(Nc.IsTrigger){var Xb=
this.beh();Fb.ta.appendChild(Xb)}else Fb.ta.innerText=Nc.ClickOrder.toString();let yd=Xb=!1;nc<Rb?(tc&&(Fb.ta.style.position=jg.a.absolute,Fb.ta.style.top=vg.a.Uc(this.ij.Nr(ib)+21*hd)),$a=this.ot.qAe(Nc.EffectNodeId),Fb.ta.setAttribute(jg.a.oYa,$a?"animMarkerSelected":"animMarkerUnselected"),xc.appendChild(Fb.ta),hd++):nc===Rb?(na=na&&Nc.EffectId===Fd.EffectId,Xb=!0,yd=Fd.IsTrigger):na=na&&Nc.EffectId===Fd.EffectId;Xb&&Td.ta.appendChild(this.jch(yd,na,$a));Fd=Nc;Td||(Td=Fb);tc?(Fb=[],(Xb=this.oCe(Td.ta))&&
Fb.push(...Xb),Fb.push(Nc.EffectNodeId),Td.ta.setAttribute("AnimProps",Fb.join(" "))):Fb.ta.setAttribute("AnimProps",Nc.EffectNodeId)}this.QP();return hd}osf(ka,ib,Rb,tc){var xc;if(!this.M0a()||!ka||!ka.length)return 0;const hd=tc?this.IC.ta:this.VB.ta;Rb=(Rb=Math.floor(this.ij.Nr(Rb)/21))?Rb:1;let Fd=0,Td=null,na=new sh.a,$a=!0,Fb=!1,Xb=!1;for(let Ud=0;Ud<ka.length;Ud++){var nc=ka[Ud],Nc=new sh.a;Nc.ta.id=xb.a.eKb+nc.ClickOrder;Nc.mh(20,16);Nc.gk(1);if(nc.IsTrigger){var yd=this.beh();Nc.ta.appendChild(yd)}else Nc.ta.innerText=
nc.ClickOrder.toString();Ud<Rb?(tc&&(Nc.ta.style.position=jg.a.absolute,Nc.ta.style.top=vg.a.Uc(this.ij.Nr(ib)+21*Fd)),Nc.ta.setAttribute("AnimProps",nc.EffectNodeId),Fb=this.ot.qAe(nc.EffectNodeId),Nc.ta.setAttribute(jg.a.oYa,Fb?"animMarkerSelected":"animMarkerUnselected"),hd.appendChild(Nc.ta),Fd++):Ud===Rb&&na.ta?($a=$a&&nc.EffectId===Td.EffectId,Xb=!0,yd=Td.IsTrigger,Xb&&na.ta.appendChild(this.jch(yd,$a,Fb))):$a=$a&&nc.EffectId===Td.EffectId;if(Xb){Nc=[];(yd=this.oCe(na.ta))&&Nc.push(...yd);Nc.push(nc.EffectNodeId);
na.ta.setAttribute("AnimProps",Nc.join(" "));if(Ef.a("FixAnimationMarkerOverlapSelectionIssue"))for(const ie of Nc){if(Fb=this.ot.qAe(ie))break}else Fb=this.ot.qAe(nc.EffectNodeId);na.ta.setAttribute(jg.a.oYa,Fb?"animMarkerSelected":"animMarkerUnselected");(nc=na.ta.lastElementChild)&&(null===(xc=null===nc||void 0===nc?void 0:nc.id)||void 0===xc?0:xc.startsWith("overlappedMarker"))&&nc.setAttribute(jg.a.oYa,"overlappedMarker "+(Fb?"animMarkerSelected":"animMarkerUnselected"))}else na=Nc,Td=nc}this.QP();
return Fd}jch(ka,ib,Rb){const tc=new sh.a;tc.ta.id="overlappedMarker";Ef.a("FixOverlappedAnimationMarkers")?tc.ta.style.marginTop="-13px":tc.ta.style.marginTop=ka?"3px":"-13px";tc.ta.setAttribute(jg.a.oYa,"overlappedMarker "+(Rb?"animMarkerSelected":"animMarkerUnselected"));ib&&this.Q6a(tc.ta,"SameEffectOverlapped",1);return tc.ta}zQi(ka){var ib,Rb;let tc;var xc=tc=0;if(!this.ra)return{returnValue:!1,x:xc,y:tc};var hd=Object(fe.a)(284,this.ra.tc(this.yB));if(!hd)return{returnValue:!1,x:xc,y:tc};hd=
hd.Zt();if(!hd)return{returnValue:!1,x:xc,y:tc};xc=20/(null!==(Rb=null===(ib=this.ic)||void 0===ib?void 0:ib.RE)&&void 0!==Rb?Rb:ci.a.D7);xc=ka?hd.Ic-(this.zcg?2*xc+21:xc+15):hd.Ic-xc-15;tc=hd.Xc;return{returnValue:!0,x:xc,y:tc}}JFm(ka,ib=!0){if(this.M0a()){var Rb=this.VB.ta,tc=new sh.a;tc.ta.id=xb.a.eKb+ka;tc.mh(20,16);tc.gk(1);ka&&(tc.ta.innerText=ka.toString());tc.ta.setAttribute(jg.a.oYa,ka?"animMarkerSelected":ib?"animMarkerBlank":"animMarkerUnselected Shimmer");Rb.appendChild(tc.ta);this.QP()}}updateZoom(){var ka,
ib,Rb;this.fh&&null!==(ka=this.ic)&&void 0!==ka&&ka.TSa&&!this.Rm&&this.Soa&&(this.Pxb(!0),this.Pxb(!1),ka=this.nc.Cg(this.ra),this.Rqa(null===(ib=this.VB)||void 0===ib?void 0:ib.ta,1/this.ic.oxc(ka)),this.Rqa(null===(Rb=this.IC)||void 0===Rb?void 0:Rb.ta,1/this.ic.oxc(ka)))}Rqa(ka,ib){ka&&ib&&(ka.style.transform=`scale(${ib})`,ka.style.transformOrigin="right")}}hh.PHa=(ka,ib)=>[new Of.a(ka[0]._x-ib,ka[0]._y-ib),new Of.a(ka[1]._x+ib,ka[1]._y-ib),new Of.a(ka[2]._x+ib,ka[2]._y+ib),new Of.a(ka[3]._x-
ib,ka[3]._y+ib)];Object(m.a)(hh,"AnimationMarkerView",null,[1215,760,301,24]);class wf{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb,Xb,nc,Nc){this.voh=this.JHe=this.Rm=this.mc=!1;this.G$c=this.T0f=-1;this.zcg=this.BP=!1;this.ua=new Gg.a;this.qdg=this.Xe=1;this.IC=this.VB=this.hi=this.Eb=this.Rb=null;this.ra=ka;this.nc=ib;this.un=Rb;this.Cj=tc;this.yB=hd;this.UPj=xc;this.Soa=Fd.Yc?Fd.Yc.vbf:null;this.LOj=Fd.Yc?Fd.Yc.xNe:null;this.Lg=Td;this.ef=na;this.Ma=$a;this.Tb=Fb;this.h2a=nc;this.XDj=Nc;this.ij=
Xb}dispose(){this.Rm||(this.h2a(),this.Rm=!0,this.mc=!1,this.bjf(),this.upc(),this.Lg&&this.VB&&(this.Lg.jc(Pa.a.gv,this.VB.ta,Object(K.a)(this,this.PH,"onSelectionAreaHover")),this.Lg.jc(Pa.a.uy,this.VB.ta,Object(K.a)(this,this.PH,"onSelectionAreaHover"))),this.VB=null,this.Lg&&this.IC&&(this.Lg.jc(Pa.a.gv,this.IC.ta,Object(K.a)(this,this.PH,"onSelectionAreaHover")),this.Lg.jc(Pa.a.uy,this.IC.ta,Object(K.a)(this,this.PH,"onSelectionAreaHover"))),this.Eb=this.hi=this.Soa=this.Rb=this.IC=null)}get visible(){return this.mc}set visible(ka){this.mc=
ka}get rr(){return this.Eb}get Yn(){return this.hi}get Yd(){return this.Rb}xq(ka){ka&&this.Soa?(this.Rb=new sh.a,this.Rb.Zv("AnimationMarkerView"),this.Soa.appendChild(this.Rb.ta),this.Eb=new Wi.a,this.Eb.gk(0),this.Rb.appendChild(this.Eb.viewport),this.hi=new Zh.a,this.hi.gk(1),this.hi.setVisibility(!1),this.Eb.appendChild(this.hi),this.VB=new sh.a,this.VB.Zv("ShapeAnimationMarkerContainer"),this.VB.ta.id=this.ra.id.toString(),this.VB.mh(20,this.Rb.ta.clientHeight),this.VB.gk(1),this.Rb.appendChild(this.VB),
this.IC=new sh.a,this.IC.Zv("TextAnimationMarkerContainer"),this.IC.ta.id=this.ra.id.toString(),this.IC.mh(20,this.Rb.ta.clientHeight),this.IC.gk(1),this.Rb.appendChild(this.IC),this.Lg.Zb(Pa.a.gv,this.VB.ta,Object(K.a)(this,this.PH,"onSelectionAreaHover")),this.Lg.Zb(Pa.a.uy,this.VB.ta,Object(K.a)(this,this.PH,"onSelectionAreaHover")),this.Lg.Zb(Pa.a.gv,this.IC.ta,Object(K.a)(this,this.PH,"onSelectionAreaHover")),this.Lg.Zb(Pa.a.uy,this.IC.ta,Object(K.a)(this,this.PH,"onSelectionAreaHover")),this.setVisibility()):
Ob.a.J(509682564,800,10,"AnimationMarkerView: {0} is null",ka?"m_markerViewParentElement":"parent")}YZ(ka){let ib=!1;ka&&ka.Dc.id.startsWith(xb.a.eKb)||ka.Dc.id.startsWith("overlappedMarker")?(this.g0j(ka),ib=!0):(this.bjf(),this.avb(!0));return ib}setSelection(ka){if(ka&&!this.voh||!ka)this.avb(ka),this.bjf()}setVisibility(){let ka=this.mc&&!this.BP;this.ra&&this.ra.isHiddenShape&&(ka=!1);this.Rb&&this.Rb.he(ka);this.VB&&this.VB.he(ka);this.IC&&this.IC.he(ka)}avb(ka){if(this.M0a()){this.JHe=ka;ka=
[this.VB.ta.childNodes,this.IC.ta.childNodes];for(const ib of ka)for(ka=0;ib&&ka<ib.length;ka++)this.iPg(ib[ka],this.JHe)}}oCe(ka){if(!ka||!this.ra)return null;ka=ka.getAttribute("AnimProps");if(!ka||!ka.toString()||!ka.toString().trim().length)return null;ka=ka.toString().split(" ");if(!ka||4!==ka.length)return null;const ib=[];for(const Rb of ka){if(!Rb||!Rb.trim().length)return null;ib.push(Number.parseInvariant(Rb.trim()))}return ib}M0a(){const ka=!!this.ra&&!!this.Soa&&!!this.VB&&!!this.IC;ka||
Ob.a.J(509682563,800,10,"AnimationMarkerView: the containers are not exist.");return ka}upc(){this.ASa(!0);this.ASa(!1)}ASa(ka){if(this.Lg&&this.ef&&this.M0a()&&(ka=ka?this.IC.ta:this.VB.ta)&&ka.childNodes&&0<ka.childNodes.length){const ib=ka.childNodes;for(const Rb=0;Rb<ib.length;)ka.removeChild(ib[Rb])}}GXh(){if(this.M0a()){var ka=this.Ctl(this.ra);if(ka&&ka.length){var ib=!1,Rb=!1,tc=[];for(const xc of ka)xc.IsTextRangeType?Rb=!0:(ib=!0,tc.push(xc));this.zcg=ib&&Rb;this.Pxb(!0);this.Pxb(!1);this.ASa(!1);
0<tc.length&&(Ob.a.J(509682562,800,50,"AnimationMarkerView: draw shape animation markers."),this.osf(tc,this.ij.YF(this.ra.wt.Xc,this.Xe),this.ij.YF(this.ra.wt.xd-this.ra.wt.Xc,this.Xe),!1,-1)||Ob.a.J(509682561,800,10,"AnimationMarkerView: no shape marker is rendered"));Rb?this.Wzi():this.ASa(!0);if(!Rb&&-1!==this.G$c||-1!==this.G$c&&-1===this.G$c&&!ib)this.Tfi(),this.avb(!0)}else this.upc()}}Wzi(){const ka=new Wa.a(2,1,0,Object(K.a)(this,this.ensureTextIsRenderedAndDrawMarkers,"ensureTextIsRenderedAndDrawMarkers"),
90,"26");this.Tb.Qb(ka)}ensureTextIsRenderedAndDrawMarkers(){this.Rm||(this.XDj(),this.ysf())}ysf(){this.ASa(!0);if(this.y7i(this.ra)){var ka=this.AVi();if(ka&&ka.length){var ib;if(({top:ib}=this.YVi()).returnValue){var Rb=0;Ob.a.J(509682530,800,50,"AnimationMarkerView: draw paragraph animation markers.");for(let xc=0;xc<ka.length;xc++){var tc=this.nc.Cg(this.ra);if(!tc)return;(tc=tc.r8c(this.ra,xc))&&0<tc.length&&ka[xc]&&(Rb+=this.osf(tc,ka[xc].top-ib,ka[xc].height,!0,xc))}Rb||Ob.a.J(509682529,800,
10,"AnimationMarkerView: no paragraph marker is rendered.")}else Ob.a.J(509682531,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Ob.a.J(509682560,800,50,"AnimationMarkerView: the paragrph view is not rendered")}}AVi(){const ka=[];var ib=yf.GraphIterator.pb(this.ra);ib=this.un.oca(ib,ib.currentNode);for(var Rb;ib.moveNext();)(Rb=ib.currentNode)&&this.Cj.me(Rb)&&Rb&&(Rb=Rb.tc(this.yB))&&Rb.htmlElement&&(Rb=this.rKa(Rb.htmlElement))&&Rb.height&&ka.push(Rb);return ka}YVi(){return this.getClientRects(this.LOj)}getClientRects(ka){let ib,
Rb;ib=Rb=0;if(!ka)return Ob.a.J(509682528,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:ib,top:Rb};ka=ka.getClientRects();if(!ka||!ka.length||!ka[0])return Ob.a.J(509682527,800,50,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:ib,top:Rb};Rb=Math.round(ka[0].top);ib=Math.round(ka[0].left);return{returnValue:!0,left:ib,top:Rb}}rKa(ka){if(!ka)return Ob.a.J(509682526,800,10,"AnimationMarkerView: paragraph is null"),null;ka=ka.querySelectorAll(".TextRun");
if(!ka||!ka.length)return null;let ib=0,Rb=0;let tc,xc=!1;for(let Fd=0;Fd<ka.length&&ka[Fd];Fd++){var hd=ka[Fd].getClientRects();({top:hd,bottom:tc}=this.NDi(hd)).returnValue&&(Fd?(ib=ib>hd?hd:ib,Rb=Rb<tc?tc:Rb):(ib=hd,Rb=tc),xc=!0)}if(xc)return new ch(Rb-ib,ib);Ob.a.J(509682525,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null}NDi(ka){let ib,Rb;ib=Rb=0;if(!ka||!ka.length||!ka[0])return Ob.a.J(509682524,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),
{returnValue:!1,top:ib,bottom:Rb};ib=ka[0].top;Rb=ka[0].bottom;for(let tc=1;tc<ka.length&&ka[tc];tc++)ib=ka[tc].top>ib?ib:ka[tc].top,Rb=ka[tc].bottom<Rb?Rb:ka[tc].bottom;return{returnValue:!0,top:ib,bottom:Rb}}osf(ka,ib,Rb,tc,xc){if(!this.M0a()||!ka||!ka.length)return 0;const hd=tc?this.IC.ta:this.VB.ta;Rb=(Rb=Math.floor(this.ij.Nr(Rb)/21))?Rb:1;let Fd=0,Td=null,na=new sh.a,$a=!1,Fb=!1;const Xb=xc===this.G$c&&ka.length<this.T0f+1;for(let Nc=0;Nc<ka.length;Nc++){const yd=ka[Nc],Ud=new sh.a;Ud.ta.id=
xb.a.eKb+yd.BuildId;Ud.mh(20,16);Ud.gk(1);if(yd.IsTrigger){var nc=this.beh();Ud.ta.appendChild(nc)}else Ud.ta.innerText=yd.BuildId.toString();let ie=nc=!1;Nc<Rb?(tc&&(Ud.ta.style.position=jg.a.absolute,Ud.ta.style.top=vg.a.Uc(this.ij.Nr(ib)+21*Fd)),Ud.ta.setAttribute("AnimProps",String.format("{0} {1} {2} {3}",Nc,xc,yd.BuildId,yd.EffectId)),Fb=this.JHe||Xb&&ka.length-1===Nc||this.voh&&this.T0f===Nc&&this.G$c===xc,Ud.ta.setAttribute(jg.a.oYa,Fb?"animMarkerSelected":"animMarkerUnselected"),hd.appendChild(Ud.ta),
Fd++):Nc===Rb&&na.ta?($a=$a&&yd.EffectId===Td.EffectId,nc=!0,ie=Td.IsTrigger):$a=$a&&yd.EffectId===Td.EffectId;nc&&na.ta.appendChild(this.jch(ie,$a,Fb));na=Ud;Td=yd}this.QP();return Fd}jch(ka,ib,Rb){const tc=new sh.a;tc.ta.id="overlappedMarker";tc.ta.style.marginTop=ka?"3px":"-13px";tc.ta.setAttribute(jg.a.oYa,"overlappedMarker "+(Rb?"animMarkerSelected":"animMarkerUnselected"));ib&&this.Q6a(tc.ta,"SameEffectOverlapped",1);return tc.ta}QP(){this.UPj(this.Rb.ta,!0)}Ctl(ka){if(!ka)return null;const ib=
this.nc.Cg(ka);return ib?ib.p_a(ka):null}y7i(ka){ka=this.Ctl(ka);if(!ka||!ka.length)return!1;for(const ib of ka)if(ib.IsTextRangeType)return!0;return!1}Pxb(ka){if(this.M0a()){var ib=ka?this.VB.ta:this.IC.ta,Rb,tc;ib&&({x:Rb,y:tc}=this.zQi(ka)).returnValue&&(ib.style.position=jg.a.absolute,ib.style.left=vg.a.Uc(Rb),ib.style.zIndex="20000",ka?ib.style.top=vg.a.Uc(tc):this.ysf())}}zQi(ka){let ib,Rb;ib=Rb=0;if(!this.ra)return{returnValue:!1,x:ib,y:Rb};var tc=Object(fe.a)(284,this.ra.tc(this.yB));if(!tc)return{returnValue:!1,
x:ib,y:Rb};tc=tc.Zt();if(!tc)return{returnValue:!1,x:ib,y:Rb};ib=ka?tc.Ic-(this.zcg?61:35):tc.Ic-20-15;Rb=tc.Xc;return{returnValue:!0,x:ib,y:Rb}}g0j(ka){if(this.ua&&ka&&this.Ma&&ka.Dc){var ib=ka.Dc.id.startsWith("overlappedMarker")&&ka.Dc.offsetParent?ka.Dc.offsetParent:ka.Dc;this.hLn(ib);this.Vih(ib)&&!this.a6m(ib)&&this.Tfi();this.avb(!1);this.iPg(ib,!0);this.ua.raiseEvent("OnMarkerClick",ka);this.Ma.Wd()}}bjf(){this.voh=!1;this.G$c=this.T0f=-1;this.Tfi()}hLn(ka){(ka=this.oCe(ka))?(this.voh=!0,
this.T0f=ka[0],this.G$c=ka[1],this.ra.$Ba=this.T0f,this.ra.VPa=this.G$c):Ob.a.J(509682523,800,10,"AnimationMarkerView: failed to parse the animation properties.")}Tfi(){this.ra&&(this.ra.$Ba=-1,this.ra.VPa=-1)}Km(){this.Eb&&(this.f1c(),this.Eb.Km())}f1c(){if(this.ra&&this.hi){var ka=this.ra.wt.points;ka=wf.PHa(ka,this.dxc());this.hi.ox(ka)}}dxc(){let ka=xb.a.O5b;this.ra.rg||!this.ra.F5&&!this.ra.pl||(ka+=6);return ka}Qt(){this.Eb&&this.qdg!==this.Xe&&this.aje();return null}Vu(){}Kz(){}Yi(ka){this.qdg=
this.Xe;this.Xe=ka}setZIndex(ka){this.Eb&&this.Eb.AG(ka)}draw(){this.aje()}aje(){this.Rb&&this.Soa&&this.mc&&!this.BP&&this.GXh();this.setVisibility()}PH(ka){if(!this.ua||!ka)return!1;this.ua.raiseEvent("OnSelectionAreaHover",ka);ka.eventName===Pa.a.gv?this.Q6a(ka.Dc,"animMarkerHovered",1):ka.eventName===Pa.a.uy&&this.Q6a(ka.Dc,"animMarkerHovered",2);return!0}iPg(ka,ib){ka&&(ib?(this.Q6a(ka,"animMarkerUnselected",2),this.Q6a(ka,"animMarkerSelected",1)):(this.Q6a(ka,"animMarkerSelected",2),this.Q6a(ka,
"animMarkerUnselected",1)))}Q6a(ka,ib,Rb){const tc=this.Vih(ka);switch(Rb){case 0:ka.setAttribute(jg.a.oYa,ib);tc&&ka.lastChild.setAttribute(jg.a.oYa,ib);break;case 1:Sys.UI.DomElement.addCssClass(ka,ib);tc&&Sys.UI.DomElement.addCssClass(ka.lastChild,ib);break;case 2:Sys.UI.DomElement.removeCssClass(ka,ib),tc&&Sys.UI.DomElement.removeCssClass(ka.lastChild,ib)}}Vih(ka){return!!ka&&!!ka.lastChild&&!!ka.lastChild.id&&"overlappedMarker"===ka.lastChild.id}a6m(ka){return!!ka&&!!ka.lastChild&&!!ka.lastChild.id&&
0<=ka.lastChild.className.indexOf("SameEffectOverlapped")}setPosition(){}LP(ka){(this.BP=ka)?this.bjf():(this.KB(),this.avb(!0));this.setVisibility()}vP(){return null}hD(){}iL(){return[]}hG(){}KR(){}KB(){!this.Rm&&this.Soa&&(this.Pxb(!0),this.Pxb(!1))}beh(){const ka=new ae.a;ka.mh(10,10);ka.ta.setAttribute(jg.a.oYa,"pointer-events-none");ka.AUa("0 0 2048 2048");const ib=new Zh.a;ib.Bka("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");
ib.mN("#E67E22");ib.GB("#FFFF00");ib.Mw(5);ka.appendChild(ib);return ka.ta}static PHa(ka,ib){return[new Of.a(ka[0]._x-ib,ka[0]._y-ib),new Of.a(ka[1]._x+ib,ka[1]._y-ib),new Of.a(ka[2]._x+ib,ka[2]._y+ib),new Of.a(ka[3]._x-ib,ka[3]._y+ib)]}}Object(m.a)(wf,"AnimationMarkerViewLegacy",null,[1214,760,301,24]);var qg=a(664),Lh=a(1507),dh=a(1508),wg=a(389);class bg{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td){this.OHe=this.Ysa=!1;this.N1=[];this.Hph=new Set;this.zag=!0;if(!ka)throw Error.argumentNull("actionManager");
if(!ib)throw Error.argumentNull("graphTopologyManager");if(!Rb)throw Error.argumentNull("slideReader");if(!tc)throw Error.argumentNull("viewEventNotifier");if(!xc)throw Error.argumentNull("animationMarkerViewManager");if(!hd)throw Error.argumentNull("activeSlideViewManager");if(!Fd)throw Error.argumentNull("selectionManager");if(!Td)throw Error.argumentNull("activeAppFrame");this.ia=ka;this.va=ib;this.nc=Rb;this.u$c=xc;this.Ge=tc;this.aR=this.va.Ga;this.Lc=hd;this.pa=Fd;this.j8f=Ef.a("FixAnimationRibbonCrashIssue");
this.Db=Td}initialize(){}dispose(){this.ia=this.Hph=this.N1=this.aR=this.nc=this.pa=this.Ge=null}VMe(ka){this.zag=ka}Z9l(){if(!this.j8f||this.aR){var ka=this.pa.ud();this.K5c();var ib=this.aR.xj(),Rb=new Set;if(this.j8f){if(!ib)return;if(ka)for(const tc of ka)Rb.add(tc.id)}else for(const tc of ka)Rb.add(tc.id);for(const tc of ib)Rb.has(tc.id)?this.b_h(tc):this.Qnk(tc)}}kYn(ka){this.eFa(this.Ysa);Ef.a("FixAnimationSelectionCachingIssue")?this.oYn(ka):this.$9l();Ef.a("FixAnimationRibbonControlsRefreshLogic")?
this.lkk():this.Ge.WH(new wg.a(7))}SVm(ka,ib){if(ib&&ka&&ka.length){var Rb=this.qAe(ka[0]);this.zag=!1;Rb?(ib=this.N1.filter(tc=>!ka.includes(tc.EffectNodeId)),this.K5c(),this.usa(),this.XZh(ib)):(ib=this.nc.Ngh(ka,ib),this.IYh(ib),ib=Object.assign([],this.N1),this.K5c(),this.usa(),this.XZh(ib));this.zag=!0;this.ia.Qa(Pb.a.o2g,Lh.a.execute,null)}}usa(){const ka=this.pa.ud();this.pa.usa(ka)}WZh(ka,ib){ib&&ka&&(this.K5c(),ka=this.nc.Ngh(ka,ib),this.XZh(ka),Ef.a("FixRedundantSelectionChange")?this.zag&&
this.ia.Qa(Pb.a.o2g,Lh.a.execute,null):this.ia.Qa(Pb.a.o2g,Lh.a.execute,null))}qAe(ka){return this.Hph.has(ka)}lYn(ka){if(this.Ysa=!!ka&&0<=ka.indexOf("Animation"))this.OHe=!0;this.eFa(this.Ysa);this.Ysa?(this.Z9l(),Ef.a("FixAnimationRibbonControlsRefreshLogic")?this.lkk():this.Ge.WH(new wg.a(7))):this.K5c()}mYn(ka){this.aR=ka;this.K5c();this.eFa(this.Ysa)}oYn(ka){if(!this.j8f||this.aR)if(ka)this.$9l();else if((ka=this.pa.ud())&&ka.length){var ib=this.aR.xj();if(ib&&ib.length){this.K5c();var Rb=new Set;
for(const tc of ka)Rb.add(tc.id);for(const tc of ib)Rb.has(tc.id)?this.b_h(tc):this.Qnk(tc)}}}$9l(){if(!this.j8f||this.aR){var ka=this.pa.ud();this.K5c();var ib=this.aR.xj();if(ib&&ib.length)if(ka&&ka.length){var Rb=new Set;for(const tc of ka)Rb.add(tc.id);for(const tc of ib)Rb.has(tc.id)?this.b_h(tc):this.Qnk(tc)}else ka=this.aR.aPb(ib),ka.length&&(ka=ka.filter(tc=>tc.IsModifiedPreviously).map(tc=>tc.EffectNodeId),this.WZh(ka,this.aR))}}XZh(ka){if(ka&&this.aR){this.IYh(ka);if(Ef.a("RefreshMarkersInsteadOfComputeEffectSelection"))this.eFa(this.Ysa);
else{var ib=this.aR.xj();if(!ib||!ib.length)return;ka=new Map;for(var Rb of this.N1){var tc=fg.a.Xf(Rb.ShapeId);if(!tc){Ob.a.J(509620887,800,10,"EffectSelectionManager::addSelectedEffectHelper:  shape guid is null");return}tc=tc.toString();ka.has(tc)||ka.set(tc,new Set);tc=ka.get(tc);null===tc||void 0===tc?void 0:tc.add(Rb.EffectNodeId)}for(const xc of ib)if(Rb=this.u$c.w$(xc))Rb.avb(!1),ib=xc.id.toString(),(ib=ka.has(ib)?ka.get(ib):null)&&ib.size&&Rb.IJn(Array.from(ib))}Ef.a("FixAnimationRibbonControlsRefreshLogic")?
this.lkk():this.Ge.WH(new wg.a(7))}}lkk(){const ka={};ka.SetAnimationDuration=dh.a.n9b;ka.SetAnimationDurationMLR=dh.a.n9b;ka.SetAnimationDelay=dh.a.n9b;ka.SetAnimationDelayMLR=dh.a.n9b;ka.AnimationStart=dh.a.Q6g;ka.AnimationStartMLR=dh.a.Q6g;ka.MoveEarlier=dh.a.P6g;ka.MoveLater=dh.a.P6g;ka.AnimationEffectOptions=dh.a.S6g;ka.AnimationEffectOptionsMLR=dh.a.S6g;ka.Animations=dh.a.pCh;ka.AnimationGallery=dh.a.vBh;this.Db.nD(ka)}b_h(ka){if(ka){var ib=this.nc.Cg(ka);ib&&(ib=ib.lAb(ka),this.IYh(ib),ka=
this.u$c.w$(ka),this.j8f&&!ka||ka.avb(!0))}}Qnk(ka){ka&&(ka=this.u$c.w$(ka))&&ka.avb(!1)}IYh(ka){if(ka&&ka.length)for(const ib of ka)this.qAe(ib.EffectNodeId)||(this.N1.push(ib),this.Hph.add(ib.EffectNodeId))}aml(ka,ib,Rb,tc=!1,xc=!0){if(ib=this.u$c.w$(ib))ib.visible=ka,tc?ib.LDn(Rb,xc):ib.aje()}ASa(ka){ka&&(ka=this.u$c.w$(ka))&&ka.upc()}eFa(ka,ib=null,Rb,tc=!0){if(this.OHe&&this.aR&&this.aR.ZT&&this.Lc.Yc&&this.Lc.Yc.vbf)if(ib)this.aml(ka,ib,Rb,!0,tc);else if((ib=this.aR.xj())&&ib.length)for(const xc of ib)this.aml(ka,
xc)}K5c(){this.Hph.clear();this.N1.length=0}}Object(m.a)(bg,"EffectSelectionManager",null,[1212,24]);class vh{constructor(){this.$=null;this.qad=!1}get name(){return"PowerPointWebEditor.Animations"}lc(ka){this.$=ka;(this.qad=this.$.resolve("PowerPointWebEditor.IApplicationContext").Md.fKb)?(this.$.register(738,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>").ma().na(()=>new qg.a((ib,Rb)=>{let tc=null;const xc=Object(fe.a)(284,ib.tc(this.$.resolve("Box4.IPageView").Oa));
xc&&!xc.isDisposed&&xc.ta&&(tc=new hh(ib,this.$.resolve("PowerPointWebEditor.ISlideReader"),this.$.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.$.resolve("Box4.IParagraphReader"),Object(K.a)(xc,xc.QP,"takeOwnershipOfSubtree"),this.$.resolve("Box4.IPageView").Oa,this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.$.resolve("Common.MouseInputManager"),this.$.resolve("Common.IClickInputManager"),this.$.resolve("PowerPointWebEditor.IFocusManager"),u.AFrameworkApplication.je,
this.$.resolve("PowerPointWebEditor.IPPTUnitConversion"),Rb,()=>{xc.uJa()},this.$.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager"),this.$.resolve("PowerPointWebEditor.IZoomContext"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")),tc.xq(xc.ta),tc.setZIndex(4),tc.visible=!1,xc.QP(tc.Yd.ta,!0),xc.hzb(tc,4));return tc})),this.$.register(bg,"PowerPointWebEditor.Animations.IEffectSelectionManager").ma().na(()=>
new bg(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.$.resolve("PowerPointWebEditor.ISlideReader"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>"),this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),this.$.resolve("Box4.IAppFrame")))):
(this.$.register(738,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>").ma().na(()=>new qg.a((ib,Rb)=>{let tc=null;const xc=Object(fe.a)(284,ib.tc(this.$.resolve("Box4.IPageView").Oa));xc&&!xc.isDisposed&&xc.ta&&(tc=new wf(ib,this.$.resolve("PowerPointWebEditor.ISlideReader"),this.$.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.$.resolve("Box4.IParagraphReader"),Object(K.a)(xc,xc.QP,"takeOwnershipOfSubtree"),this.$.resolve("Box4.IPageView").Oa,
this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.$.resolve("Common.MouseInputManager"),this.$.resolve("Common.IClickInputManager"),this.$.resolve("PowerPointWebEditor.IFocusManager"),u.AFrameworkApplication.je,this.$.resolve("PowerPointWebEditor.IPPTUnitConversion"),Rb,()=>{xc.uJa()}),tc.xq(xc.ta),tc.setZIndex(4),tc.visible=!1,xc.QP(tc.Yd.ta,!0),xc.hzb(tc,4));return tc})),this.$.register(cg,"PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").ma().na(()=>new cg(this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.$.resolve("PowerPointWebEditor.ISlideReader"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(8),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.$.resolve("PowerPointWebEditor.View.IViewEventSource"),this.$.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>"),this.$.resolve("PowerPointWebEditor.IActiveSlideViewManager"))))}init(){this.qad?this.$.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").initialize():
this.$.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").initialize()}dispose(){this.qad?this.$.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").dispose():this.$.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").dispose()}static main(){L.a.instance.Fc(jb.a(new vh,0))}}Object(m.a)(vh,"PPTWebEditorAnimationsPackage",null,[3,4]);var fi=a(1168),Jg=a(323);class Dg{constructor(ka,ib,Rb,tc,xc){this.ia=ka;this.Ma=ib;this.UEj=Rb;this.oc=tc;this.Iab=
xc}Hb(){this.ia.za(Pb.a.find,Id.a.view,Object(K.a)(this,this.findText,"findText"));this.ia.za(Pb.a.find,Id.a.notes,Object(K.a)(this,this.findText,"findText"));this.ia.za(Pb.a.find,Id.a.ng,Object(K.a)(this,this.findText,"findText"));this.ia.za(ba.a.dEi,Id.a.view,Object(K.a)(this,this.dEi,"findInDocument"));this.ia.ue(Pb.a.find,0);this.ia.za(Pb.a.Dqa,Id.a.view,Object(K.a)(this,this.Dqa,"replaceText"));this.ia.za(Pb.a.Dqa,Id.a.notes,Object(K.a)(this,this.Dqa,"replaceText"));this.ia.za(Pb.a.Dqa,Id.a.ng,
Object(K.a)(this,this.Dqa,"replaceText"));this.ia.ue(Pb.a.Dqa,4)}ve(){const ka=[this.Ma.gd(Ef.a("FindReplaceInNewThumbnail")?Cc.a.Lz:Jg.a.rP),this.Ma.gd(Jg.a.lsa),this.Ma.gd(Cc.a.kh),this.Ma.gd(Cc.a.sX)];for(const ib of ka)ib.bindAction(ja.a.eb(Zc.a.fua,ja.a.Ke),Pb.a.find),ib.bindAction(ja.a.eb(Zc.a.p9b,ja.a.Ke),Pb.a.Dqa)}findText(ka,ib,Rb){return ib.contextId!==Id.a.view&&ib.contextId!==Id.a.notes&&ib.contextId!==Id.a.ng?2:1===Rb?this.oc.hl()?32:8:Ef.a("FindReplaceInNewThumbnail")&&1===this.Iab.Ri?
2:2===Rb?(this.UEj.o6l(ib),Ob.a.J(539773087,820,50,"FindTextDialog is initialized."),32):8}Dqa(ka,ib,Rb){return ib.contextId!==Id.a.view&&ib.contextId!==Id.a.notes&&ib.contextId!==Id.a.ng?2:1===Rb?this.oc.hl()?32:8:Ef.a("FindReplaceInNewThumbnail")&&1===this.Iab.Ri?2:2===Rb?(this.UEj.nSn(ib),Ob.a.J(539773088,820,50,"ReplaceTextDialog is initialized."),32):8}dEi(ka,ib,Rb,tc,xc){if(ib.contextId!==Id.a.view&&ib.contextId!==Id.a.notes&&ib.contextId!==Id.a.ng)return 2;if(1===Rb)return 32;if(2===Rb){if(!xc)return 8;
ka=xc.CommandValueId||"";Ob.a.J(539773089,820,50,"Find. ActionData QueryLength: {0}",ka.length);this.UEj.eSn(ib,ka);Ob.a.J(539773090,820,50,"FindTextDialog is initialized from Search Box.");return 32}return 8}}Object(m.a)(Dg,"FindReplaceTextActor",null,[743]);var fj=a(1671);class kj extends fj.a{constructor(ka,ib,Rb){super(!1,!0);this.gEj=!1;this.Fph=null;this.fHe=!1;this.YHl=this.EIl=null;this.TEj=!0;this.eFj=this.fFj=this.dFj=!1;this.oZb=null;this.sph=!1;this.sNj=!0;this.aMl=this.gIj=!1;this.hLl=
this.jLl=null;this.uKl=0;this.Ma=ka;this.Lnb=ib;this.Ien="FindReplaceTextDialog";this.JEa=ResourceStrings.l_FindTextTitle;Rb&&(this.JEa=ResourceStrings.l_ReplaceTextTitle);this.iIj=Rb;this.nGa=!1}nwb(){this.Dq(this.JEa,this.Lnb,this.gjb());this.gEj=!1}dispose(){super.dispose();this.gEj=!0}QEm(){this.dFj=this.TEj=!1;this.o8a(this.JEa,this.Lnb,this.gjb())}Hpl(ka){ka&&(this.Ma.gh(Aa.AFrame.EAa),this.dFj=!0);this.TEj=!0;this.o8a(this.JEa,this.Lnb,this.gjb())}cjh(){this.hide()}rLn(ka){this.Fph=ka.searchString;
this.fHe=ka.matchCase;this.oZb=ka.replaceString}isDisposed(){return this.gEj}sed(ka,ib){this.YHl=ka;this.uKl=ib;this.aMl=0===ib;this.o8a(this.JEa,this.Lnb,this.gjb())}ewh(ka){this.EIl=ka;this.o8a(this.JEa,this.Lnb,this.gjb())}rwh(ka){this.jLl=ka;this.o8a(this.JEa,this.Lnb,this.gjb())}bCk(ka){this.hLl=ka;this.o8a(this.JEa,this.Lnb,this.gjb())}get ged(){return this.Fph}set ged(ka){this.Fph=ka}get matchCase(){return this.fHe}set matchCase(ka){this.fHe=ka}get wqk(){return this.oZb}set wqk(ka){this.oZb=
ka}DGm(ka){ka&&(this.Ma.gh(Aa.AFrame.EAa),this.fFj=!0);this.sph=!0;this.o8a(this.JEa,this.Lnb,this.gjb())}$ui(){this.fFj=this.sph=!1;this.o8a(this.JEa,this.Lnb,this.gjb())}CGm(ka){ka&&(this.Ma.gh(Aa.AFrame.EAa),this.eFj=!0);this.sNj=!0;this.o8a(this.JEa,this.Lnb,this.gjb())}SEm(){this.eFj=this.sNj=!1;this.o8a(this.JEa,this.Lnb,this.gjb())}qTn(){this.JEa=ResourceStrings.l_ReplaceTextTitle;this.iIj=!0;this.sph=!1;this.o8a(this.JEa,this.Lnb,this.gjb());this.Ma.gh(Aa.AFrame.EAa)}BGm(){this.gIj=!0;this.o8a(this.JEa,
this.Lnb,this.gjb())}sMm(){return{["searchString"]:this.Fph,["findNextButtonAriaLabel"]:this.EIl,["errorMessage"]:this.YHl,["findNextButtonIsEnabled"]:this.TEj,["focusFindNextButton"]:this.dFj,["focusDialog"]:Object(K.a)(this,this.OJm,"focusDialog"),["isReplaceActive"]:this.iIj,["replaceButtonIsEnabled"]:this.sph,["replaceAllButtonIsEnabled"]:this.sNj,["showMessageAsError"]:this.aMl,["messageStatus"]:this.uKl,["focusReplaceButton"]:this.fFj,["focusReplaceAllButton"]:this.eFj,["replaceButtonAriaLabel"]:this.jLl,
["replaceAllButtonAriaLabel"]:this.hLl,["readOnlyModeEnabled"]:this.gIj}}gjb(){return{["id"]:this.Ien,["bodyControls"]:this.sMm(),["isModal"]:!1}}OJm(){this.Ma.gh(Aa.AFrame.EAa)}}Object(m.a)(kj,"ReactFindReplaceTextDialog",fj.a,[1236]);class ng{constructor(ka){this.Ma=ka}getInstance(ka,ib){return new kj(this.Ma.value,ka,ib)}}Object(m.a)(ng,"FindReplaceTextDialogFactory",null,[1192]);class Oh{constructor(){this.dcb=this.DDb=this.paragraphIndex=this.kFa=this.slideIndex=0}reset(){this.slideIndex=this.kFa=
this.paragraphIndex=0;this.DDb=this.dcb=-1}clone(){const ka=new Oh;ka.slideIndex=this.slideIndex;ka.kFa=this.kFa;ka.paragraphIndex=this.paragraphIndex;ka.DDb=this.DDb;ka.dcb=this.dcb;return ka}}Object(m.a)(Oh,"TextPosition",null,[]);class Tf{constructor(){this.LIj=this.Ymh=null;this.zCa=new Oh;this.qC=new Oh;this.state=this.slideCount=0;this.Tze=this.HAi=!1;this.pattern=this.Hof=this.Jof=null;this.matchCase=!1;this.reset()}reset(){this.slideCount=0;this.zCa.reset();this.qC.reset();this.state=0;this.Tze=
this.HAi=!1;this.LIj=this.O$b=this.Hof=this.Jof=null}get O$b(){return this.Ymh}set O$b(ka){if(this.Ymh=ka)this.LIj=this.Ymh}get f8m(){return this.LIj}}Object(m.a)(Tf,"FindContext",null,[]);var Kh=a(265),wi=a(293);class Uf{constructor(){this.ShouldMatchCase=!1}}Object(m.a)(Uf,"MatchTextInfo",null,[]);class Ci{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.OldStr=this.NewStr=this.MatchTxtInfo=null}}Object(m.a)(Ci,"ReplaceAllTextInfo",null,[]);var Ai=a(1349),Ii=a(337),gj=a(820),Ag=a(487);
class Og{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb,Xb,nc,Nc,yd,Ud,ie,Be,oe,rf,Vf,xg,qh){this.YJc=this.AC=this.EI=null;this.ei=new Tf;this.oZb=this.z1="";this.Vbg=!1;this.DHe=this.k5d=0;this.CHe=Date.now();this.rph=-1;this.SEj=0;this.hph=-1;this.ia=ka;this.N4f=ib;this.Ma=Rb;this.Nq=tc;this.oc=xc;this.Ia=hd;this.gq=Fd;this.jcc=Td;this.xb=na;this.Tb=$a;this.$b=Fb;this.va=Xb;this.Pb=nc;this.Mb=Ud;this.Ge=Nc;this.Kr=yd;this.xH=ie;this.aOa=Be;this.iKl=oe;this.e6d=rf;this.ydn=Vf;this.DI=qh;this.iLl=xg}o6l(ka){this.EI=
ka;this.AC=this.iKl.value.getInstance(Object(K.a)(this,this.csl,"findReplaceTextDialogResultHandler"),!1);this.z1&&(this.AC.ged=this.z1,this.hph=-1);this.AC.nwb();3!=this.ia.mode&&this.AC.BGm();this.J9c()&&this.Yui()}eSn(ka,ib){this.J9c()||(this.z1=ib);this.o6l(ka);this.J9c()||(this.AC.ged=this.z1,this.AC.nwb(),this.USk(ib,!1))}nSn(ka){this.EI=ka;this.AC=this.iKl.value.getInstance(Object(K.a)(this,this.csl,"findReplaceTextDialogResultHandler"),!0);this.z1&&(this.AC.ged=this.z1);this.AC.nwb();this.J9c()&&
this.Yui()}csl(ka,ib){if(ib)switch(this.AC.rLn(ib),ka){case 1:this.Con();break;case 2:this.Don();break;case 3:this.Eon(this.AC.wqk);break;default:this.tPn(),this.clearSelection(),this.ei.reset(),this.AC.cjh()}else Ob.a.J(512496416,820,10,"Got null control value for findreplace dialog")}Oyl(){return this.ei.Jof&&this.xXh!==this.ei.Jof.ph}USk(ka,ib){this.rol();if(0===this.ei.state||3===this.ei.state||ka!==this.z1||ib!==this.Vbg||this.Oyl())this.g1m(ka,ib),this.hph=-1;this.ei.Tze=!1;this.Mrh()}get xXh(){return this.va.Ga?
this.va.Ga.ph:0}g1m(ka,ib){const Rb=ka===this.z1&&3===this.ei.state&&!this.Oyl(),tc=this.ei.zCa.clone();this.ei.reset();this.z1=ka;this.Vbg=ib;Rb?this.ei.zCa=tc.clone():(this.ei.zCa.slideIndex=this.xXh,this.fPm());this.ei.qC=this.ei.zCa.clone()}Mrh(){this.rJm(this.z1,this.Vbg)?4!==this.ei.state&&this.setSelection():(n.ULS.sendTraceTag(539829126,820,50,"Text not found"),this.Ftf())}rJm(ka,ib){var Rb=this.va.presentation;if(!Rb)throw Error.argumentNull("Presentation is null");if(Rb=Rb.slides||[],Rb.length){this.ei.slideCount=
Rb.length;const tc=Rb.length+this.ei.zCa.slideIndex;for(;this.ei.qC.slideIndex<=tc;){const xc=this.ei.qC.slideIndex%Rb.length,hd=this.tJm(Rb[xc],ka,ib,this.ei.qC.slideIndex===tc?this.ei.zCa.kFa:Og.kTj);if(hd&&(this.ei.Jof=this.oc.Wk(hd.Xb)))return!0;if(7===this.ei.state)return this.ei.Tze&&(Ob.a.J(512496414,820,50,"call into PerformBackendFind recursively."),this.ei.state=0),this.Yun(Rb[xc]?Rb[xc].Xb:null,ka,ib);if(3===this.ei.state)break;let Fd;(Fd=this.ei.qC).slideIndex=Fd.slideIndex+1;this.ei.qC.kFa=
0}}else this.ei.state=1;return!1}tJm(ka,ib,Rb,tc){if(!ka)return null;var xc=this.oc.Wk(ka.Xb),hd=this.Pb.Hc(xc);xc=xc.AQb()||[];(hd=hd.Bb(27))&&xc.push(hd);if(!xc.length)return this.ei.state=7,null;for(;this.ei.qC.kFa<=Math.min(xc.length-1,tc);){if(this.ei.Hof=this.sJm(xc[this.ei.qC.kFa],ib,Rb,this.ei.qC.kFa===tc?this.ei.zCa.paragraphIndex:Og.kTj))return ka;let Fd;(Fd=this.ei.qC).kFa=Fd.kFa+1;this.ei.qC.paragraphIndex=0}return null}sJm(ka,ib,Rb,tc){if(!this.gq.S$a(ka)&&ka.Cz)return null;const xc=
wi.a.createInstance(ka);let hd=0;for(;xc.moveNext()&&this.ei.qC.paragraphIndex<=tc;){const Fd=xc.currentNode;if(Me.ParagraphReader.me(Fd)&&hd++===this.ei.qC.paragraphIndex){if(this.ei.O$b=this.pJm(Fd,ib,Rb,this.ei.qC.paragraphIndex===tc?this.ei.zCa.DDb:Og.kTj))return ka;let Td;(Td=this.ei.qC).paragraphIndex=Td.paragraphIndex+1;this.ei.qC.DDb=this.ei.qC.dcb=-1}}return null}pJm(ka,ib,Rb,tc){if(!Me.ParagraphReader.me(ka))return null;let xc=ka.f8c();if(!xc.length)return null;xc=xc.substring(0,Math.min(xc.length,
tc));return this.uJm(xc,Math.max(0,this.ei.qC.dcb),ib,Rb)?ka:null}uJm(ka,ib,Rb,tc){let xc=ka,hd=Rb;tc||(xc=ka.toLowerCase(),hd=Rb.toLowerCase());ka=xc.indexOf(hd,-1===ib?0:ib);if(-1!==ka)return this.ei.qC.DDb=ka,this.ei.qC.dcb=ka+hd.length,this.ei.state=2,this.ei.HAi=!0;this.ei.state=1;return!1}fPm(){var ka=Ii.b(this.EI);ka=ka?ka.Jb:null;if(!ka||!ka.Ua)n.ULS.sendTraceTag(512496411,820,50,"There could be no slide at all");else if(ka.Ua.mb){var ib=ka.Ua.mb.Xa;if(Me.ParagraphReader.me(ib.node)){ka=Object(fe.a)(427,
ib.node);this.ei.zCa.DDb=ib.Va;this.ei.zCa.dcb=ib.Va;const Rb=this.Ia.Mja(ib.node);Rb?(this.ei.zCa.kFa=Rb.get_zIndex()-1,this.ei.zCa.paragraphIndex=this.Qvl(ka)):this.gq.$Pb(ib.node)&&(ib=this.va.Ga?this.va.Ga.AQb():null,this.ei.zCa.kFa=ib?ib.length:0,this.ei.zCa.paragraphIndex=this.Qvl(ka))}else this.Ia.ATa(ib.node)&&(this.ei.zCa.kFa=ib.node.get_zIndex()-1)}}Qvl(ka){ka=this.Pb.Hc(ka);if(!ka.v_(Rb=>10===Rb.type||60===Rb.type||16===Rb.type))return 0;ka.wc();const ib=ka.Wp;ka.wc();return Math.max(0,
ka.fTa(ib))}gOl(){const ka=this.va.presentation;if(!ka)throw Error.argumentNull("Presentation is null");return this.ei.zCa.slideIndex||this.ei.zCa.kFa?this.ei.qC.slideIndex<(ka.slides||[]).length:!1}Rxl(){const ka=this.va.presentation;if(!ka)throw Error.argumentNull("Presentation is null");this.ei.qC.slideIndex=ka.slides?ka.slides.length:0;this.ei.Tze=!1;this.Mrh()}rkh(){return this.AC.isDisposed()}son(ka){if(!this.rkh()){Ob.a.J(512496409,820,50,"OnBackendFindSucceeded");var ib=Ec.a.empty;({slideId:ib}=
Ec.a.iUk(ka));(ka=this.oc.s$a(ib))?(ib=ka.slideIndex,ib>this.ei.zCa.slideIndex&&ib<this.ei.qC.slideIndex?this.Ftf():this.$b.Ga!==ka?(this.Nq.Fea(Object(K.a)(this,this.DIe,"onActiveSlideDomChanged")),this.$b.Ga=ka):(this.ei.state=5,this.ei.Tze=!0,this.ei.qC.slideIndex=this.ei.qC.slideIndex>ib?ib+this.ei.slideCount:ib,this.ei.qC.kFa=0,this.ei.qC.paragraphIndex=0,this.ei.qC.DDb=-1,this.ei.qC.dcb=-1,this.Mrh())):this.gOl()?this.Rxl():this.Ftf()}}DIe(){Ob.a.J(512496408,820,50,"OnActiveSlideDomChanged");
this.Nq.b6a(Object(K.a)(this,this.DIe,"onActiveSlideDomChanged"));this.rkh()||this.YJc||(this.YJc=new Wa.a(3,1,0,Object(K.a)(this,this.P0j,"onPostActiveSlideDomChangedTask"),90,"30"),this.Tb.Qb(this.YJc))}P0j(){Ob.a.J(512496407,820,50,"OnPostActiveSlideDomChangedTask");this.YJc=null;if(!this.rkh())if(4===this.ei.state){const ka=this.xXh;this.ei.qC.slideIndex=this.ei.qC.slideIndex>ka?ka+this.ei.slideCount:ka;this.ei.state=5;this.ei.Tze=!0;this.Mrh()}else 2===this.ei.state?this.setSelection():this.Ftf()}ron(){this.rkh()||
(Ob.a.J(512496406,820,50,"OnBackendFindFailed"),this.gOl()?this.Rxl():this.Ftf())}Yun(ka,ib,Rb){Ob.a.J(512496405,820,50,"PerformBackendFind");this.N4f.findText(ib,Rb,ka.toString(),Object(K.a)(this,this.son,"onBackendFindSucceeded"),Object(K.a)(this,this.ron,"onBackendFindFailed"));this.ei.state=4;return!0}Ftf(){this.ei.state=this.ei.HAi?3:1;Ob.a.J(512496404,820,50,"End of Find: {0}",this.ei.state);this.clearSelection();this.sed(0,"")}getShapeType(ka){return ka.Uq?ResourceStrings.L_TextBox:ka.om?ResourceStrings.l_Chart:
ka.Zc?ResourceStrings.L_Table:ka.rg?ResourceStrings.L_SmartArt:ka.Zl?ResourceStrings.L_Media:ka.Kg?ResourceStrings.l_Picture:ka.pl?ResourceStrings.l_Placeholder:ResourceStrings.l_ShapeObject}setSelection(){var ka=this.ei.O$b,ib=this.ei.Jof;if(this.$b.Ga!==ib)this.Nq.Fea(Object(K.a)(this,this.DIe,"onActiveSlideDomChanged")),this.$b.Ga=ib;else{ka=Kh.SelectionFactory.Y7(ka,this.ei.qC.DDb,this.ei.qC.dcb);if(this.gq.S$a(this.ei.Hof))this.ia.Qa(Pb.a.zQa,2,new Ai.a(!0)),this.Ma.gh(Jg.a.lsa),this.jcc.setSelection(ka),
this.sed(this.ei.qC.slideIndex%this.oc.hl()+1,ResourceStrings.l_NotesPaneType);else{ib=this.ei.Hof;const Rb=this.ei.Hof.Qg(this.xb.Oa);if(Rb)if(Rb.isLocked){let tc;(tc=this.ei.qC).kFa=tc.kFa+1;this.ei.qC.paragraphIndex=0;this.ei.qC.DDb=0;this.ei.qC.dcb=0;Rb.twb()}else this.ydn&&ib.rg?(this.Ge.Ith(new Ag.a(ib)),this.aOa.setSelection(ka)):(this.Ma.gh(Cc.a.kh),this.xb.setSelection(ka));this.sed(this.ei.qC.slideIndex%this.oc.hl()+1,this.getShapeType(ib))}Ob.a.J(512496402,820,50,"Find Text: {0}/{1}/{2}/({3},{4} )",
this.ei.qC.slideIndex,this.ei.qC.kFa,this.ei.qC.paragraphIndex,this.ei.qC.DDb,this.ei.qC.dcb);this.myi()}}clearSelection(){var ka=Ii.b(this.EI);if(ka=ka?ka.Jb:null){var ib=this.ei.f8m;ib&&(ib=Kh.SelectionFactory.Ig(ib,0),ka.setSelection(ib))}else Ob.a.J(512496401,820,10,"Find Replace Text: Selection manager received as null when clearing selection")}sed(ka,ib){const Rb=new Sys.StringBuilder,tc=new Sys.StringBuilder;let xc=!1;ka!=this.hph?(this.hph=ka,this.SEj=1):this.SEj++;switch(this.ei.state){case 1:xc=
!0;Rb.append(ResourceStrings.l_FindTextNotFound);break;case 3:Rb.append(ResourceStrings.l_FindTextFindOver);break;case 6:xc=!0;Rb.append(ResourceStrings.l_FindTextFindAgain);break;case 2:tc.append(String.format(ResourceStrings.l_FindTextMessageWithCount,this.SEj,ka,ib));break;default:Ob.a.J(512496400,820,50,"Find Text: {0}",this.ei.state)}this.qMn(Rb.toString(),xc,tc.toString());this.myi()}CVn(ka){ka=this.cHn(ka);32===ka&&this.USk(this.z1,this.Vbg);16===ka&&(this.AC.sed(ResourceStrings.l_ReplaceTextErrorMessage,
0),this.AC.$ui(),this.AC.Hpl(!0))}cHn(ka){return Ae.a.gvf("SingleReplaceAction",Pb.a.Dqa,()=>{ka||(ka="",Ob.a.J(512496399,820,50,"Replacing with empty string"));var ib=this.ei.O$b;if(!ib)return Ob.a.J(512496398,820,10,"ParagraphNode not set in findContext"),16;var Rb=this.ei.qC.DDb;const tc=this.ei.qC.dcb;if(-1===Rb||-1===tc)return Ob.a.J(512496397,820,10,"Invalid start or end position of current text selection."),16;const xc=this.Kr.qe(15);Ef.a("FixDesignerCrashViaSetUndoActionId")&&(xc.sc=Pb.a.Dqa);
xc.hd(ib);this.xH.replaceTextRange(jc.a.createTextRange(ib,Rb,tc),ka,!0,!1,Pb.a.Dqa);ib=Rb+ka.length;Rb=ib!==this.ei.qC.dcb;this.ei.qC.dcb=ib;xc.dispose();Rb&&this.setSelection();return 32})}myi(){this.AC.Hpl(1===this.k5d);this.Lpl();this.AC.CGm(3===this.k5d)}Lpl(){this.ei.O$b?this.AC.DGm(2===this.k5d):this.AC.$ui()}rol(){this.AC.QEm();this.AC.$ui();this.AC.SEm()}qMn(ka,ib,Rb){2===this.k5d?(this.AC.rwh(ResourceStrings.l_ReplaceTextReplaced+". "+Rb),this.AC.ewh("")):(this.AC.ewh(Rb),this.AC.rwh(""));
this.AC.bCk("");this.AC.sed(ka,ib?0:1)}CHm(ka,ib){const Rb=Ae.a.Fk("FindNext");Rb.Ya("CommandId",ka.toString());Rb.Ya("IsReadOnlyModeEnabled",this.AC.gIj.toString());try{ib()}finally{Rb.finish(!0)}}Con(){ra.a.rb(this.AC.ged)||this.CHm(Pb.a.find,()=>{Ob.a.J(512496396,820,50,"Find Text Started");this.k5d=1;this.USk(this.AC.ged,this.AC.matchCase);return 32})}Don(){this.AC.iIj?(Ob.a.J(512496394,820,50,"Replace Text Started"),this.k5d=2,this.CVn(this.AC.wqk)):(this.AC.qTn(),Ob.a.J(512496395,820,50,"Find dialog switched to replace dialog"),
this.Lpl())}Eon(ka){this.J9c()?Ob.a.J(512496393,820,10,"ReplaceAll Already in progress. ReplaceAllStartTime:{0}, Time diff:{1}",this.DHe,Date.now()-this.DHe):ra.a.rb(this.AC.ged)||(Ef.a("FixReplaceAllTimeOutError")&&(this.va.presentation.f6a=-16),this.z1=this.AC.ged,this.oZb=ka?ka:"",this.DHe=Date.now(),this.k5d=3,this.Yui(),this.YIm(this.va.Ga,this.z1,this.oZb,this.Vbg),0<this.iLl&&(this.rph=window.setTimeout(()=>{this.kRl()},this.iLl)),16===this.replaceAll()&&(this.CHe=Date.now(),this.bkl(),this.kRl()))}replaceAll(){return Ae.a.gvf("ReplaceAllAction",
Pb.a.Dqa,()=>{Ob.a.J(512496392,820,50,"ReplaceAll Text Started");const ka=this.va.presentation;if(ka){const ib=this.Mb.Fd(15);Ef.a("FixDesignerCrashViaSetUndoActionId")&&(ib.sc=Pb.a.Dqa);try{ib.rc(ka),this.e6d.Am(Object(K.a)(this,this.Jbe,"onPresentationPropertyChange")),ka.XCb=Object.assign(new Ci,{NewStr:this.oZb,OldStr:this.z1,ActiveSlideCid:this.va.Ga.cid,ActiveSlideSid:this.va.Ga.sid,MatchTxtInfo:Object.assign(new Uf,{ShouldMatchCase:this.AC.matchCase})})}finally{ib&&ib.dispose()}return 32}return 16})}YIm(ka,
ib,Rb,tc){if(ka){ka=this.oc.Wk(ka.Xb);var xc=this.Pb.Hc(ka);ka=ka.AQb()||[];(xc=xc.Bb(27))&&ka.push(xc);if(ka.length)for(xc=0;xc<=ka.length-1;)this.wJm(ka[xc],ib,Rb,tc),xc++}else Ob.a.J(512496391,820,50,"slide must not be null.")}wJm(ka,ib,Rb,tc){if(this.gq.S$a(ka)||!ka.Cz)for(ka=wi.a.createInstance(ka);ka.moveNext();){const xc=ka.currentNode;if(!Me.ParagraphReader.me(xc))continue;let hd=null;(hd=this.qJm(xc,ib,tc))&&hd.characterData.replace(ib,Rb)}}qJm(ka,ib,Rb){if(!Me.ParagraphReader.me(ka))return Ob.a.J(512496390,
820,50,"node must be ParagraphNode"),null;const tc=ka.f8c();return tc.length?this.vJm(tc,ib,Rb)?ka:null:null}vJm(ka,ib,Rb){let tc=ka,xc=ib;Rb||(tc=ka.toLowerCase(),xc=ib.toLowerCase());return-1!==tc.indexOf(xc,0)?!0:!1}Jbe(ka,ib){if(!this.J9c())Ob.a.J(512496389,820,50,"ReplaceAll Not Iniitated");else if(ib.property===We.a.KLe){this.bkl();ka=Object(fe.a)(571,ib.node);if(-1!==ka.f6a){var Rb=2;if(0===ka.f6a){ib=ResourceStrings.l_FindTextNotFound;var tc=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchMessage;
Rb=0;var xc=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchTitle}else 1===ka.f6a?(ib=String.format(ResourceStrings.l_ReplaceAllSuccessSingular,ka.f6a,this.z1,this.oZb),tc=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessageSingular,ka.f6a,this.z1,this.oZb)):(ib=String.format(ResourceStrings.l_ReplaceAllSuccessPlural,ka.f6a,this.z1,this.oZb),tc=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessagePlural,ka.f6a,this.z1,this.oZb)),xc=ResourceStrings.l_ReplaceAllCalloutNotificationSuccessTitle}else xc=
ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,ib=tc=ResourceStrings.l_ReplaceAllErrorMessage,Rb=0,Ob.a.J(512496388,820,10,"Invalid ReplaceAllTextCount");this.CHe=Date.now();Ob.a.J(512496387,820,50,"Time taken for Replace All operation in ms: {0}",this.CHe-this.DHe);this.Gpl(ib,Rb);this.e6d.Pq(Object(K.a)(this,this.Jbe,"onPresentationPropertyChange"));this.AC.isDisposed()&&this.HHk(xc,tc,10);ka.f6a=-16}}J9c(){return this.DHe>this.CHe}Yui(){var ka=String.format(ResourceStrings.l_ReplaceAllInProgress,
this.z1);this.AC.sed(ka,3);ka=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceAllTextReplaceAll,this.z1);this.AC.bCk(ka);ka=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceTextReplace,this.z1);this.AC.rwh(ka);ka=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_FindTextFindNext,this.z1);this.AC.ewh(ka);this.rol()}Gpl(ka,ib){this.AC.sed(ka,ib);this.AC.bCk(ka);
this.AC.rwh("");this.AC.ewh("");this.myi()}tPn(){if(this.J9c()){var ka=String.format(ResourceStrings.l_ReplaceAllInProgress,this.z1);this.HHk(ResourceStrings.l_ReplaceAllCalloutNotificationProgressTitle,ka,1024)}}HHk(ka,ib,Rb){this.DI?(this.DI.drf(),Ob.a.J(512496385,820,50,"Callout notification called for Replace All operation"),ka=Object.assign(new gj.a,{title:ka,message:ib,timeoutInSeconds:Rb}),ka=this.DI.Poe(ka),ka.aya&&Ob.a.J(512496384,820,10,"Error in callout notification: Error:{0}",ka.message)):
Ob.a.J(512496386,820,10,"Find Replace Text: m_calloutNotification adapter is null.")}kRl(){let ka=!1;this.J9c()&&(ka=!0,this.CHe=Date.now());Ob.a.J(512496355,820,10,"Error returned in replace all operation. ReplaceAll Timeout: {0}, Time taken in ms: {1}",ka,this.CHe-this.DHe);this.Gpl(ResourceStrings.l_ReplaceAllErrorMessage,0);this.e6d.Pq(Object(K.a)(this,this.Jbe,"onPresentationPropertyChange"));this.AC.isDisposed()&&this.HHk(ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,ResourceStrings.l_ReplaceAllErrorMessage,
10);this.va.presentation.f6a=-16}bkl(){-1!==this.rph&&(window.clearTimeout(this.rph),this.rph=-1)}}Og.kTj=1024;Object(m.a)(Og,"FindReplaceTextHandler",null,[1193]);class aj{constructor(ka){this.rKl=this.kMl=null;this.fHe=!1;this.Yca=ka}findText(ka,ib,Rb,tc,xc){this.rKl=ka;this.fHe=ib;this.kMl=Rb;this.Yca.YM(tc,xc,null)}get oSn(){return this.kMl}get matchCase(){return this.fHe}get a9d(){return this.rKl}}Object(m.a)(aj,"FindTextManager",null,[1191]);var Qj=a(578),sj=a(312);class mi extends sj.a{constructor(){super();
this.MatchText=null;this.MatchCase=!1;this.SlideID=null}Gn(){return 54}static Nkf(ka,ib,Rb){const tc=new mi;tc.SlideID=Rb;tc.MatchText=ka;tc.MatchCase=ib;return tc}}Object(m.a)(mi,"FindTextRequest",sj.a,[]);class Wj extends Qj.a{constructor(ka,ib,Rb,tc){super();this.nBb=this.KBb=null;this.rU=this.paa=!1;this.B1f=null;this.ee=Rb;this.pmh=!1;this.N4f=ib;this.nb=tc;this.hq=ka;this.enabled=2;this.hq.register(this)}YM(ka,ib){this.pmh=!0;this.KBb=ka;this.nBb=ib;this.hq.Aba()}forceOutbound(){}Cxa(){return this.pmh&&
!this.paa}$N(){return!1}G_a(){return this.pe&&2===this.pe.status?!0:this.Cxa()}c5b(){if(1===this._state)this.B1f=this.nb.podSessionId,this.pe.wK=mi.Nkf(this.N4f.value.a9d,this.N4f.value.matchCase,this.N4f.value.oSn),this.pe.status=1,this._state=3;else if(3===this._state&&this.pe&&2===this.pe.status){if(2!==this.pe.statusCode)this.iN();else{if(!this.pe.yw||1!==this.pe.yw.length){this.iN();return}const ka=this.pe.yw[0];0===ka.StatusCode?(this.O6(),this.KBb&&this.KBb(ka.SlideID)):(this.iN(ka),124===
ka.StatusCode&&this.ee.Zr(ka.ServerError,this.B1f))}this.B1f=null}}iN(ka=null){this.pmh=!1;this._state=1;Ob.a.J(507843426,824,15,"FindTextRequest failed. OperationResult:{0}, RequestStatus:{1}, HttpStatusCode:{2}, IsLastReplicationFailed:{3}, PodSessionId:{4}",ka?ka.StatusCode:-1,this.pe?Bc.a[this.pe.statusCode]:"NULL",this.pe?this.pe.httpStatusCode:-1,this.rU,this.B1f||"NULL");this.rU=!0;this.nBb&&this.nBb(-1,-1)}O6(){this.pmh=!1;this._state=1;Ob.a.J(507843425,818,this.rU?15:50,"FindTextRequest succeeded. IsLastReplicationFailed:{0}, PodSessionId:{1}",
this.rU,this.B1f||"NULL");this.rU=!1}dispose(){this.paa||(1===this._state&&this.hq.unregister(this),this.paa=!0)}}Object(m.a)(Wj,"FindTextReplicator",Qj.a,[24]);class Ff{constructor(){this.$=null}get name(){return"PowerPointWebEditor.FindText"}lc(ka){this.$=ka;this.$.register(1191,"PowerPointWebEditor.IFindTextManager").ma().na(()=>new aj(new Wj(this.$.resolve("PowerPointWebEditor.IPPTReplicationScheduler"),this.$.ge("PowerPointWebEditor.IFindTextManager"),this.$.resolve("PowerPointWebEditor.IErrorHandler"),
this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"))));this.$.register(1192,"PowerPointWebEditor.IFindReplaceTextDialogFactory").ma().na(()=>new ng(this.$.ge("PowerPointWebEditor.IFocusManager")));const ib=new fi.a(this.$.resolve("Common.App.CalloutNotification.ICalloutNotification"),this.$.resolve("PowerPointWebEditor.IRibbonPane").ta);this.$.register(1193,"PowerPointWebEditor.IFindReplaceTextHandler").ma().na(()=>new Og(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IFindTextManager"),
this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("PowerPointWebEditor.IShapeReader"),this.$.resolve("PowerPointWebEditor.Graph.INotesReader"),this.$.resolve("PowerPointWebEditor.INotesView"),this.$.resolve("Box4.IPageView"),this.$.resolve("Common.ITaskManager"),this.$.resolve("PowerPointWebEditor.IPPTWorkspace"),this.$.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.$.resolve("Box4.Graph.IGraphIteratorFactory"),this.$.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.$.resolve("Box4.Graph.IGraphTransactionFactory"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("Box4.ICharacterPropertiesEditor"),this.$.resolve("PowerPointWebEditor.ISmartArtTextView"),this.$.ge("PowerPointWebEditor.IFindReplaceTextDialogFactory"),this.$.resolve("Box4.Graph.IGraphInstance").Sd(7),this.$.resolve("PowerPointWebEditor.IApplicationSettings").wS,
this.$.resolve("Common.IAppSettingsManager").Jc("ReplaceAllClientTimeoutMS",0),ib))}init(){const ka=new Dg(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("PowerPointWebEditor.IFindReplaceTextHandler"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("PowerPointWebEditor.View.IPPTPageView"));ka.Hb();ka.ve()}dispose(){}static main(){L.a.instance.Fc(jb.a(new Ff,0))}}Object(m.a)(Ff,"PPTWebEditorFindTextPackage",
null,[3,4]);class oi{constructor(ka){this.Aa=ka}get eze(){return"PowerPoint"}get Mch(){return"c551d75c-10b1-4de2-83cc-cce22d7c06bd"}get version(){return 1}get currentVersion(){return 0}get cCl(){return this.Aa.AJe}get NUd(){return this.Aa.CJe}get tlh(){return this.Aa.BJe}get tsl(){return"Microsoft.Office.Server.Powerpoint.Web.IWacPptEditorFirstRunExperienceUISettings"}get Yqh(){return 24}get gvh(){return 4E3}get jle(){return this.Aa.dZ||""}}Object(m.a)(oi,"FirstRunExperienceLauncherSettings",null,
[1222]);class Fj{constructor(ka){this.HIl=ka}MPn(ka){this.HIl&&this.HIl.lxh(ka)}}Object(m.a)(Fj,"FirstRunExperienceManager",null,[1190]);class bj{constructor(){this.$=null}get name(){return"PowerPointWebEditor.FirstRunExperience"}lc(ka){if(!ka)throw Error.argumentNull("container");this.$=ka;this.$.register(1190,"PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager").ma().na(()=>new Fj(this.$.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher")))}init(){this.$.resolve("Common.IAppSettingsManager").fg(()=>
{this.lxh()})}dispose(){}lxh(){var ka=this.$.resolve("PowerPointWebEditor.IApplicationSettings");if(!ka)throw Error.argumentNull("appSettings");const ib=this.$.resolve("PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager");ib&&(ka=new oi(ka),ib.MPn(ka))}static main(){L.a.instance.Fc(new bj)}}Object(m.a)(bj,"PPTWebEditorFirstRunExperiencePackage",null,[3,4]);var Hg=a(85),rg=a(8);let Jj=!1;class uk extends Ta.a{constructor(ka,ib){if(!ka)throw Error.argumentNull("actionManager");if(!ib)throw Error.argumentNull("applicationSettings");
Ef.a("ReliabilityErrorFixPart1")&&(Jj=Hg.a.lF?!0:!1);super(!1,!1,!0);this.Gs=ka;this.YCn=(Rb,tc)=>{1===Rb?(Ef.a("ReliabilityErrorFixPart2")&&Ob.a.J(507601554,846,15,"TrimVideoDialog::reactTrimVideoDialogHandler ok button clicked"),this.p$f&&this.Sen===Math.floor(1E3*tc.trimStartTime)&&this.Qen===Math.floor(1E3*tc.trimEndTime)?Ob.a.J(507603072,846,15,`TrimVideoDialog::reactTrimVideoDialogHandler Exit trim dialog without trimming in time ${Date.now()-tc.okButtonClickTime} ms`):this.Gs.Qa(Pb.a.FOe,2,
{trimStart:tc.trimStartTime,trimEnd:tc.trimEndTime,QOl:tc.okButtonClickTime})):(Ef.a("ReliabilityErrorFixPart2")&&Ob.a.J(507601553,846,15,`TrimVideoDialog::reactTrimVideoDialogHandler ${Rb}`),this.hide())};this.p$f=Ef.a("ReliabilityErrorFixPart1");this.Aa=ib}get pEm(){return"TrimVideoDialog"}KAb(ka,ib,Rb,tc,xc,hd,Fd,Td){const na=ResourceStrings.L_TrimVideoDialogTitle,$a={};$a.videoSrcUrl=ka;$a.defaultCaptionsUrl=Td;$a.videoName=ib;$a.startTime=Rb;$a.endTime=tc;$a.posterFrame=xc;$a.videoDuration=hd;
$a.aspectRatio=Fd;this.gf=1;this.Fg(1,ResourceStrings.L_TrimVideoDialogTrimButton);ka={["id"]:this.pEm,["bodyControls"]:$a};this.xbn=Date.now();this.p$f&&(this.Sen=Rb,this.Qen=tc);this.Dq(na,this.YCn,ka)}dispose(){this.p$f&&Jj?Ob.a.J(507603043,846,15,"TrimVideoDialog::dispose deleted oldDialog"):Ef.a("KustoTelemetryEnabled")&&Ob.a.J(507913753,846,15,`TrimVideoDialog::dispose Time spent on dialog: ${Date.now()-this.xbn}ms`);super.dispose();if((!this.p$f||!Jj)&&Ef.a("ExtraInfoLoggingEnabled")){const ka=
rg.a.Ot();Ob.a.J(508049218,846,15,`TrimVideoDialog::dispose. Printing stack trace: ${ka}`);if(this.Aa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TrimVideoDialogCrashEnabled",!1)&&!ka.includes("dismissOnCancel")&&!ka.includes("dismissOnOk"))throw Error("Trim video dialog gets closed abruptly");}this.p$f&&(Jj=!1)}}Object(m.a)(uk,"TrimVideoDialog",Ta.a,[]);var ai=a(305);class mh{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td){this.t6d=!1;this.JQn=(na,$a,Fb)=>{na=this.pa.iDb();const Xb=this.pa.lo();
$a=(null===Xb||void 0===Xb?void 0:Xb.rq)&&!(null===Xb||void 0===Xb?0:Xb.Zl);if(1!=na||!$a)return Ob.a.J(508367065,846,10,"Selected shape for video object is not valid"),8;if(1===Fb)return 32;try{na=Fb=void 0;$a=0;this.wbn=Date.now();if(Ef.a("FastTrimVideoDialogRendering")){const nc=this.Ak(Xb),Nc=null===nc||void 0===nc?void 0:nc.Lva;Nc&&({u0k:Fb,duration:$a,psi:na}=this.getVideoData(Nc))}Fb?this.smi(Fb,Xb,$a,na):Ef.a("PositionSliderThumbsCorrectly")?this.VTa.Axl(this.nb.podSessionId,Xb).then(nc=>
{if(nc&&nc.src){let Nc=nc.dur;if(nc.dur<nc.trimStart||nc.dur<nc.trimEnd||nc.dur-nc.trimEnd<nc.trimStart)Ob.a.J(508053698,846,15,`LocalVideoTrimDialogActor::showTrimVideoDialog duration less than trimStart: ${nc.dur<nc.trimStart}, duration less than trimEnd:  ${nc.dur<nc.trimEnd}, trimEnd less than trimStart: ${nc.dur-nc.trimEnd>nc.trimStart}`),Nc=0;let yd=void 0;Ef.a("VideoOOBClosedCaptionsInTrimVideoEnabled")&&void 0!==nc.tracksInfo&&null!==nc.tracksInfo&&(yd=e(nc.tracksInfo.trackLst));this.smi(nc.src,
Xb,Nc,yd);if(this.t6d)return Ob.a.J(508339986,846,50,"LocalVideoTrimDialogActor::showTrimVideoDialog initialized the Trim video dialog"),32}else return nc||Ob.a.J(507898065,846,10,"LocalVideoTrimDialogActor::showTrimVideoDialog getVideoResponseAsync response is null"),this.ehf(),8}).catch(nc=>{Ob.a.J(507898064,846,10,`LocalVideoTrimDialogActor::showTrimVideoDialog unable to launch the trim video dialog: ${nc}`);if(this.t6d)return this.ehf(),8}):this.VTa.ICe(this.nb.podSessionId,Xb).then(nc=>{if(nc)this.smi(nc,
Xb,0,void 0);else return this.ehf(),8}).catch(nc=>{Ob.a.J(507898066,846,10,`LocalVideoTrimDialogActor::showTrimVideoDialog unable to launch the trim video dialog: ${nc}`);if(this.t6d)return this.ehf(),8});if(!this.t6d)return Ob.a.J(507594531,846,50,"LocalVideoTrimDialogActor::showTrimVideoDialog initialized the Trim video dialog"),32}catch(nc){if(this.t6d)return Ob.a.J(507594560,846,10,`LocalVideoTrimDialogActor::showTrimVideoDialog exception: ${nc}`),this.ehf(),8}};if(!ka)throw Error.argumentNull("actionManager");
if(!ib)throw Error.argumentNull("selectionManager");if(!Rb)throw Error.argumentNull("mediaLocalRequestHelper");if(!tc)throw Error.argumentNull("sessionInfoOwner");if(!xc)throw Error.argumentNull("videoManagerStore");if(!hd)throw Error.argumentNull("appSettings");if(!Fd)throw Error.argumentNull("pageView");if(!Td)throw Error.argumentNull("calloutNotificationAdapter");this.ia=ka;this.pa=ib;this.VTa=Rb;this.nb=tc;this.PY=xc;this.la=hd;this.xb=Fd;this.DI=Td;this.t6d=Ef.a("ReliabilityErrorFixPart1")}ve(){}Hb(){this.ia.za(Pb.a.Wlh,
sg.a.application,this.JQn)}smi(ka,ib,Rb,tc){const xc=ib.shapeName;xc||Ob.a.J(508351048,846,15,"Selected video shape name is null or empty");const hd=new uk(this.ia,this.la),Fd=ib.media.trmStrtField,Td=ib.media.trmEndField,na=this.GRm(ib);let $a=0;Ef.a("PortraitVideoFixEnabled")&&($a=ib.yve/ib.AMd);Ef.a("ReliabilityErrorFixPart3")&&Ob.a.J(507598984,846,15,`TrimVideoDialog::createAndShowTrimVideoDialog video type: ${0>$a?"Portrait":"normal"}`);Ef.a("StopVideoOnCanvasUponTrimDialogLaunchEnabled")&&this.KSn(ib);
hd.KAb(ka,xc,Fd,Td,na,Rb,$a,tc);Ef.a("KustoTelemetryEnabled")&&Ob.a.J(507913754,846,15,`TrimVideoDialog::createAndShowTrimVideoDialog Time taken to launch the dialog: ${Date.now()-this.wbn}ms`)}Ak(ka){return null===ka||void 0===ka?void 0:ka.tc(this.xb.Oa)}KSn(ka){if(this.la.dTa&&this.la.z$a){const ib=this.Ak(ka);ib&&ib.Ki?(ka=ib.Ki,this.t6d?null===ka||void 0===ka?void 0:ka.sLe():null===ka||void 0===ka?void 0:ka.setSelected(!1)):(ka=this.PY.Lsa(ka),null===ka||void 0===ka?void 0:ka.stopPlaying())}}GRm(ka){ka=
this.Ak(ka);ka=null===ka||void 0===ka?void 0:ka.Lva;return ka?(ka=this.HRm(ka)||ka.getAttribute(ai.a.HAb))?ka.toString():"":""}HRm(ka){ka=ka.querySelectorAll("image");for(let ib=0;ib<ka.length;ib++){const Rb=ka[ib].getAttribute("href");if(Rb)try{const tc=new URL(Rb);if("blob:"===tc.protocol||"data:"===tc.protocol)return Rb}catch(tc){Ob.a.J(508073949,846,10,`LocalVideoTrimDialogActor::getPosterFrameData URL conversion exception: ${tc}`)}}return null}getVideoData(ka){ka=Array.from(ka.querySelectorAll("video"));
for(const Rb of ka){ka=Rb.getAttribute("src");if(Ef.a("VideoOOBClosedCaptionsInTrimVideoEnabled")){var ib=[];const tc=Array.from(Rb.querySelectorAll('track[kind="captions"]'));for(const xc of tc)ib.push({lang:xc.srclang,label:xc.label,src:xc.src,id:"",name:""});ib=e(ib)}else ib=void 0;if(ka)try{return 2<=Rb.readyState?{u0k:ka,duration:1E3*Rb.duration,psi:ib}:{u0k:ka,duration:0,psi:ib}}catch(tc){Ob.a.J(508035600,846,10,`LocalVideoTrimDialogActor::getVideoData exception: ${tc}`)}}return{u0k:void 0,
duration:0,psi:void 0}}ehf(){if(Ef.a("VideoSrcLoadingErrorCalloutEnabled")){const ka=Object.assign(new gj.a,{title:ResourceStrings.l_SomethingWentWrongCalloutTitle,message:ResourceStrings.errorMessage_CannotInsertOnlineVideo,timeoutInSeconds:5});this.DI.Poe(ka).aya&&Ob.a.J(508056770,846,10,"Error while launching callout notification");Ob.a.J(508056771,846,10,"Could not get the video src url")}}}Object(m.a)(mh,"LocalVideoTrimDialogActor",null,[743]);class tg{get name(){return"PowerPointWebEditor.TrimVideoDialog"}lc(ka){this.$=
ka}init(){if(this.$){var ka=this.$.resolve("Common.IActionManagerExtended");const ib=this.$.resolve("PowerPointWebEditor.IPptSelectionManager"),Rb=this.$.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),tc=this.$.resolve("PowerPointWebEditor.ISessionInfoOwner"),xc=this.$.resolve("PowerPointWebEditor.IVideoManagerStore"),hd=this.$.resolve("PowerPointWebEditor.View.IPPTPageView"),Fd=this.$.resolve("PowerPointWebEditor.IApplicationSettings"),Td=this.$.resolve("PowerPointWebEditor.ICalloutNotificationAdapter");
ka=new mh(ka,ib,Rb,tc,xc,Fd,hd,Td);ka.Hb();ka.ve()}else Ob.a.J(508367064,846,10,"Container is not available")}dispose(){}static main(){L.a.instance.Fc(new tg)}}Object(m.a)(tg,"PPTWebEditorTrimVideoDialogPackage",null,[3,4]);class Kj extends Ta.a{constructor(ka){super(!1,!1,!0);this.gen=ka;this.gbn=this.gen.eOn}KAb(){this.Dq(ResourceStrings.l_KeyboardShortcutsDialogHeader,this.U7m,{["id"]:"KeyboardShortcutsDialog",["bodyControls"]:{renderOverrideShortcutsSection:!1,defaultCheckbox:!0,prioritySection:"section2"},
["shortcuts"]:this.gbn})}U7m(){}}Object(m.a)(Kj,"KeyboardShortcutsDialog",Ta.a,[]);class ek{constructor(ka,ib,Rb){this.$Pn=(tc,xc,hd)=>{if(1==hd)return 32;(new Kj(this.Mcn)).KAb();return 32};if(!ka)throw Error.argumentNull("actionManager");if(!ib)throw Error.argumentNull("keyboardshortcutsCollection");if(!Rb)throw Error.argumentNull("focusManager");this.ia=ka;this.Mcn=ib;this.Ma=Rb}ve(){const ka=this.Ma.gd(Aa.AFrame.vl);Aa.AFrame.kk(ka,ja.a.eb(Zc.a.F8a,5),Pb.a.BWf)}Hb(){this.ia.za(Pb.a.BWf,sg.a.application,
this.$Pn)}}Object(m.a)(ek,"KeyboardShortCutsActor",null,[743]);class gi{constructor(ka){this.Zra=ka}get Do(){return this.Zra?"\u2318":"Ctrl"}get jDa(){return this.Zra?"Option":"Alt"}get uzl(){return this.Do+"+K"}get j_m(){return Ef.a("AdditionsToShortcutsDialogFix")?this.Do+"+"+(this.Zra?"Shift":"Alt")+"+M":this.Do+"+"+this.jDa+"+M"}get szl(){return this.Do+"+X"}get rzl(){return this.Do+"+C"}get Dzl(){return this.Do+"+V"}get l_m(){return this.Do+"+Shift+V"}get qzl(){return this.Do+"+B"}get CZm(){return this.Do+
"+I"}get d0m(){return this.Do+"+U"}get e0m(){return this.Do+"+Z"}get p_m(){return this.Do+"+Y"}get AZm(){return this.Do+"+Shift+>"}get W_m(){return this.Do+"+Shift+<"}get tzl(){return this.Do+"+F"}get s_m(){return this.Do+"+H"}get Y_m(){return this.Do+"+Shift+-"}get Z_m(){return this.Do+"+Shift+PlusSign"}get lZm(){return this.Do+"+D"}get R_m(){return this.Do+"+F10"}get $Zm(){return"\u2191"+ResourceStrings.l_OrStringShortcutsDialog+"\u2193"+ResourceStrings.l_OrStringShortcutsDialog+"\u2190"+ResourceStrings.l_OrStringShortcutsDialog+
"\u2192"}get EZm(){return"\u2190"}get t_m(){return"\u2192"}get D8i(){return"\u2191"}get A8i(){return"\u2193"}get eZm(){return"Delete"}get Bzl(){return"Page Down"}get Czl(){return"Page Up"}get X8c(){return"Tab"}get MMd(){return"Shift+Tab"}get B8i(){return"Esc"}get n_m(){return this.Do+"+P"}get w_m(){return this.jDa+"+Q"}get vzl(){return this.Do+"+M"}get Jzl(){return this.Do+"+PlusSign"}get g0m(){return this.Do+"+\u2193"}get Kzl(){return this.Do+"+-"}get h0m(){return this.Do+"+\u2191"}get Izl(){return Ef.a("AdditionsToShortcutsDialogFix")?
this.Zra?this.Do+"+Shift+Enter":this.Do+"+F5":this.Do+"+F5"}get X_m(){return this.Do+"+Shift+F5"}get zzl(){return"N"}get Azl(){return"Page Down"}get Ezl(){return"P"}get Fzl(){return"Page Up"}get c0m(){return"J"}get I_m(){return"Enter"}get J_m(){return"F2"}get nZm(){return"F2"}get B_m(){return"Ctrl+"+ResourceStrings.l_ClickStringShortcutsDialog}get C_m(){return"Shift+"+ResourceStrings.l_ClickStringShortcutsDialog}get y_m(){return ResourceStrings.l_ClickStringShortcutsDialog+"+"+ResourceStrings.l_DragTheMouseShortcutsDialog}get z_m(){return"Shift+"+
ResourceStrings.l_DragTheMouseShortcutsDialog}get A_m(){return"Ctrl+"+ResourceStrings.l_DragTheMouseShortcutsDialog}get C8i(){return this.Do+"+A"}get S_m(){return Ef.a("AdditionsToShortcutsDialogFix")?this.Zra?"\u2318+Shift+Alt+B":this.Do+"+[":this.Do+"+["}get Hzl(){return Ef.a("AdditionsToShortcutsDialogFix")?this.Zra?"\u2318+Shift+Alt+F":this.Do+"+]":this.Do+"+]"}get WYm(){return this.Zra?"\u2318+Shift+F":this.Do+"+Shift+]"}get T_m(){return this.Do+"+Shift+["}get zZm(){return this.Do+"+G"}get f0m(){return this.Do+
"+Shift+G"}get VYm(){return this.Do+"+\u2191"+ResourceStrings.l_OrStringShortcutsDialog+this.Do+"+\u2193"+ResourceStrings.l_OrStringShortcutsDialog+this.Do+"+\u2190"+ResourceStrings.l_OrStringShortcutsDialog+this.Do+"+\u2192"}get v_m(){return this.jDa+"+\u2192"}get u_m(){return this.jDa+"+\u2190"}get yZm(){return"Type+G+,+\u2190"+ResourceStrings.l_OrStringShortcutsDialog+"\u2192+,+Enter"}get c_m(){return"Tab"}get e_m(){return"Shift+Tab"}get d_m(){return"\u2193"}get f_m(){return"\u2191"}get ljh(){return"Enter"}get UYm(){return"Tab"}get sZm(){return"\u2193"}get wZm(){return"\u2191"}get pZm(){return"\u2192"}get ZYm(){return"\u2190"}get tZm(){return"\u2193"}get vZm(){return"\u2191"}get wzl(){return this.jDa+
"+F12"}get IZm(){return"Tab"}get mZm(){return"Type+Tab+,+Enter+,+\u2193"}get m_m(){return this.Do+"+Enter"}get F_m(){return"Shift+\u2192"}get E_m(){return"Shift+\u2190"}get G_m(){return"Shift+"+this.Do+"+\u2190"}get H_m(){return"Shift+"+this.Do+"+\u2192"}get Q_m(){return"Shift+\u2191"}get x_m(){return"Shift+\u2193"}get O_m(){return"Shift+"+this.Do+"+\u2191"}get L_m(){return"Shift+"+this.Do+"+\u2193"}get N_m(){return this.Zra?"Shift+"+this.Do+"+\u2190":"Shift+Home"}get K_m(){return this.Zra?"Shift+"+
this.Do+"+\u2192":"Shift+End"}get P_m(){return this.Zra?"Shift+"+this.Do+"+Fn\u2190":"Shift+"+this.Do+"+Home"}get M_m(){return this.Zra?"Shift+"+this.Do+"+Fn\u2192":"Shift+"+this.Do+"+End"}get fZm(){return this.Zra?"Delete":"Backspace"}get gZm(){return this.Zra?"Fn+Delete":"Delete"}get hZm(){return this.Zra?this.Do+"+Delete":this.Do+"+Backspace"}get iZm(){return this.Do+"+Delete"}get NZm(){return"\u2192"}get MZm(){return"\u2190"}get yzl(){return this.Do+"+\u2192"}get xzl(){return"Ctrl+\u2190"}get PZm(){return"\u2191"}get OZm(){return"\u2193"}get a_m(){return this.Zra?
this.Do+"+\u2192":"End"}get g_m(){return this.Zra?this.Do+"+\u2190":"Home"}get i_m(){return this.Do+"+\u2191"}get HZm(){return this.Do+"+\u2193"}get b_m(){return this.Zra?this.Do+"+Fn\u2192":this.Do+"+End"}get h_m(){return this.Zra?this.Do+"+Fn\u2190":this.Do+"+Home"}get XYm(){return this.Do+"+E"}get DZm(){return this.Do+"+J"}get $_m(){return"Shift+F3"}get q_m(){return this.Do+"+Space"}get o_m(){return this.jDa+"+Shift+\u2190"}get jZm(){return this.jDa+"+Shift+\u2192"}get dZm(){return"Type+*+,+Spacebar"}get aZm(){return"Type+-+,+Spacebar"}get bZm(){return"Type+>+,+Spacebar"}get cZm(){return"Type+<+,+>+,+Spacebar"}get ZZm(){return this.Do+
"+\u2191"}get SZm(){return this.Do+"+\u2193"}get XZm(){return this.Do+"+Shift+\u2191"}get YZm(){return this.Do+"+Shift+\u2193"}get WZm(){return this.Do+"+\u2191"}get TZm(){return this.Do+"+\u2193"}get UZm(){return this.Do+"+Shift+\u2191"}get VZm(){return this.Do+"+Shift+\u2193"}get KZm(){return this.Do+"+F6"}get LZm(){return this.Do+"+F6"}get FZm(){return"Shift+"+this.Do+"+F6"}get rZm(){return"\u2190"+ResourceStrings.l_OrStringShortcutsDialog+"\u2192"}get GZm(){return"\u2190"+ResourceStrings.l_OrStringShortcutsDialog+
"\u2192"}get kZm(){return Ef.a("AdditionsToShortcutsDialogFix")?(this.Zra?"Ctrl":this.jDa)+"+.":this.Zra?this.jDa+"+Ctrl":this.jDa+"+."+ResourceStrings.l_OrStringShortcutsDialog+this.jDa+"+\u229e"}get a0m(){return"Type+"+this.jDa+"+.+,+Z+,+R"+ResourceStrings.l_OrStringShortcutsDialog+"Type+"+this.jDa+"+\u229e+,+Z+,+R"}get RZm(){return this.Do+"+Shift+F"}get QZm(){return"Ctrl+Shift+B"}get JZm(){return"\u2191"+ResourceStrings.l_OrStringShortcutsDialog+"\u2193"}get qZm(){return"+ ("+ResourceStrings.l_OnNumericKeypadOnlyShortcutsDialog+
")"+ResourceStrings.l_OrStringShortcutsDialog+"\u2192"}get $Ym(){return"- ("+ResourceStrings.l_OnNumericKeypadOnlyShortcutsDialog+")"+ResourceStrings.l_OrStringShortcutsDialog+"\u2190"}get TYm(){return"Ctrl+Enter"+ResourceStrings.l_OrStringShortcutsDialog+"Ctrl+Space"}get r_m(){return"F2"}get oZm(){return this.jDa+"+Shift+9"}get YYm(){return this.jDa+"+Shift+1"}get i0m(){return this.Do+"+"+this.jDa+"+O"}get k_m(){return this.jDa+"+Shift+A"}get b0m(){return this.Do+"+\\"}get D_m(){return this.Do+"+Shift+Click"}get BZm(){return"Ctrl"}get Gzl(){return"Enter"+
ResourceStrings.l_OrStringShortcutsDialog+"Space"}get uZm(){return this.zzl+ResourceStrings.l_OrStringShortcutsDialog+this.Azl+ResourceStrings.l_OrStringShortcutsDialog+this.t_m+ResourceStrings.l_OrStringShortcutsDialog+this.A8i+ResourceStrings.l_OrStringShortcutsDialog+"Enter"+ResourceStrings.l_OrStringShortcutsDialog+"Space"}get xZm(){return this.Ezl+ResourceStrings.l_OrStringShortcutsDialog+this.Fzl+ResourceStrings.l_OrStringShortcutsDialog+this.EZm+ResourceStrings.l_OrStringShortcutsDialog+this.D8i+
ResourceStrings.l_OrStringShortcutsDialog+"Backspace"}get V_m(){return"T"}get U_m(){return this.jDa+"+J"}}Object(m.a)(gi,"KeyboardShortcutsMapping",null,[]);class Di{constructor(ka){this.TLl=[];this.vad=!1;this.Aa=ka;this.vad=Gb.a.Ck;this.Df=new gi(this.vad);this.bCm()}get eOn(){return this.TLl}bCm(){this.nom();this.Xnm();this.kom();this.Eom();this.ipm();this.opm();this.tpm();this.xpm();this.Apm();this.apm();Ef.a("AdditionsToShortcutsDialogFix")&&this.$nm()}nom(){this.kg(ResourceStrings.l_BoldShortcutDescription,
this.Df.qzl,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_CutShortcutDescription,this.Df.szl,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_CopyShortcutDescription,this.Df.rzl,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_PasteShortcutDescription,this.Df.Dzl,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_InsertHyperLinkShortcutDescription,this.Df.uzl,
ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_UndoShortcutDescription,this.Df.e0m,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_RedoShortcutDescription,this.Df.p_m,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_DeleteShortcutDescription,this.Df.eZm,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_OpenFindShortcutDescription,this.Df.tzl,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);
this.kg(ResourceStrings.l_MoveShapeShortcutDescription,this.Df.$Zm,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_NextSlideShortcutDescription,this.Df.Bzl,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_PreviousSlideShortcutDescription,this.Df.Czl,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_MoveInTaskPaneShortcutDescription,this.Df.X8c+ResourceStrings.l_OrStringShortcutsDialog+this.Df.MMd,
ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_ExitSlideShowViewShortcutDescription,this.Df.B8i,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_PrintShortcutDescription,this.Df.n_m,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.kg(ResourceStrings.l_SearchActionShortcutDescription,this.Df.w_m,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.vad||this.kg(ResourceStrings.l_InsertNewSlideShortcutDescription,
this.Df.vzl,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);Ef.a("AdditionsToShortcutsDialogFix")&&this.kg(ResourceStrings.l_HideTooltipShortcutDescription,this.Df.BZm,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog)}tpm(){this.kg(ResourceStrings.l_NextSlideShortcutDescription,this.Df.Bzl,ResourceStrings.l_SlidesSectionInDialog);this.kg(ResourceStrings.l_PreviousSlideShortcutDescription,this.Df.Czl,ResourceStrings.l_SlidesSectionInDialog);this.kg(ResourceStrings.l_ShowOrHideThumbnailPaneShortcutDescription,
this.Df.b0m,ResourceStrings.l_SlidesSectionInDialog);Ef.a("AdditionsToShortcutsDialogFix")?(this.kg(ResourceStrings.l_ZoomInShortcutDescription,this.Df.Jzl,ResourceStrings.l_SlidesSectionInDialog),this.kg(ResourceStrings.l_ZoomOutShortcutDescription,this.Df.Kzl,ResourceStrings.l_SlidesSectionInDialog)):(this.kg(ResourceStrings.l_ZoomInShortcutDescription,this.Df.Jzl+ResourceStrings.l_OrStringShortcutsDialog+this.Df.g0m,ResourceStrings.l_SlidesSectionInDialog),this.kg(ResourceStrings.l_ZoomOutShortcutDescription,
this.Df.Kzl+ResourceStrings.l_OrStringShortcutsDialog+this.Df.h0m,ResourceStrings.l_SlidesSectionInDialog));this.Aa.getBooleanAppSetting(Fi.a.W6c)&&this.kg(ResourceStrings.l_ZoomToFitWindow,this.Df.i0m,ResourceStrings.l_SlidesSectionInDialog);this.vad||(this.kg(ResourceStrings.l_InsertNewSlideShortcutDescription,this.Df.vzl,ResourceStrings.l_SlidesSectionInDialog),this.kg(ResourceStrings.l_MoveSlideUpShortcutDescription,this.Df.ZZm,ResourceStrings.l_SlidesSectionInDialog),this.kg(ResourceStrings.l_MoveSlideDownShortcutDescription,
this.Df.SZm,ResourceStrings.l_SlidesSectionInDialog),this.kg(ResourceStrings.l_MoveSlideToBegShortcutDescription,this.Df.XZm,ResourceStrings.l_SlidesSectionInDialog),this.kg(ResourceStrings.l_MoveSlideToEndShortcutDescription,this.Df.YZm,ResourceStrings.l_SlidesSectionInDialog),this.kg(ResourceStrings.l_MoveSlideSectionUpShortcutDescription,this.Df.WZm,ResourceStrings.l_SlidesSectionInDialog),this.kg(ResourceStrings.l_MoveSlideSectionDownShortcutDescription,this.Df.TZm,ResourceStrings.l_SlidesSectionInDialog),
this.Aa.getBooleanAppSetting("SectionExtremityMoveEnabled")&&(this.kg(ResourceStrings.l_MoveSlideSectionToBegShortcutDescription,this.Df.UZm,ResourceStrings.l_SlidesSectionInDialog),this.kg(ResourceStrings.l_MoveSlideSectionToEndShortcutDescription,this.Df.VZm,ResourceStrings.l_SlidesSectionInDialog)))}apm(){Ef.a("AdditionsToShortcutsDialogFix")?(this.kg(ResourceStrings.l_StartingFromBeginningShortcutDescription,this.Df.Izl,ResourceStrings.l_PresentingSectionInDialog),this.kg(ResourceStrings.l_StartFromCurrentSlideShortcutDescription,
this.Df.X_m,ResourceStrings.l_PresentingSectionInDialog),this.kg(ResourceStrings.l_NextSlideInFullViewShortcutDescription,this.Df.uZm,ResourceStrings.l_PresentingSectionInDialog)):(this.vad||this.kg(ResourceStrings.l_StartSlideShowShortcutDescription,this.Df.Izl,ResourceStrings.l_PresentingSectionInDialog),this.kg(ResourceStrings.l_NextSlideInFullViewShortcutDescription,this.Df.zzl+ResourceStrings.l_OrStringShortcutsDialog+this.Df.Azl+ResourceStrings.l_OrStringShortcutsDialog+this.Df.A8i,ResourceStrings.l_PresentingSectionInDialog),
this.kg(ResourceStrings.l_PreviousSlideInFullViewShortcutDescription,this.Df.Ezl+ResourceStrings.l_OrStringShortcutsDialog+this.Df.Fzl+ResourceStrings.l_OrStringShortcutsDialog+this.Df.D8i,ResourceStrings.l_PresentingSectionInDialog));Ef.a("AdditionsToShortcutsDialogFix")&&(this.kg(ResourceStrings.l_PreviousSlideInFullViewShortcutDescription,this.Df.xZm,ResourceStrings.l_PresentingSectionInDialog),this.kg(ResourceStrings.l_ShowOrHideToolbarShortcutDescription,this.Df.V_m,ResourceStrings.l_PresentingSectionInDialog),
this.kg(ResourceStrings.l_MoveFocusToNextInToolbarShortcutDescription,this.Df.X8c,ResourceStrings.l_PresentingSectionInDialog),this.kg(ResourceStrings.l_MoveFocusToPrevInToolbarShortcutDescription,this.Df.MMd,ResourceStrings.l_PresentingSectionInDialog),this.kg(ResourceStrings.l_InvokeItemInToolbarShortcutDescription,this.Df.Gzl,ResourceStrings.l_PresentingSectionInDialog),this.kg(ResourceStrings.l_MoveFocusToNextItemOnSlideShortcutDescription,this.Df.X8c,ResourceStrings.l_PresentingSectionInDialog),
this.kg(ResourceStrings.l_MoveFocusToPrevItemOnSlideShortcutDescription,this.Df.MMd,ResourceStrings.l_PresentingSectionInDialog),this.kg(ResourceStrings.l_InvokeItemInFocusShortcutDescription,this.Df.ljh,ResourceStrings.l_PresentingSectionInDialog),this.kg(ResourceStrings.l_MoveFocusToBackInGridShortcutDescription,this.Df.KZm,ResourceStrings.l_PresentingSectionInDialog),this.kg(ResourceStrings.l_ShowOrHideTheClosedCaptionsMenuForAvideoShortcutDescription,this.Df.U_m,ResourceStrings.l_PresentingSectionInDialog));
this.kg(ResourceStrings.l_GoToInFullViewShortcutDescription,this.Df.yZm,ResourceStrings.l_PresentingSectionInDialog);this.kg(ResourceStrings.l_TurnCaptionsShortcutDescription,this.Df.c0m,ResourceStrings.l_PresentingSectionInDialog);this.kg(ResourceStrings.l_ExitSlideshowShortcutDescription,this.Df.B8i,ResourceStrings.l_PresentingSectionInDialog)}opm(){this.kg(ResourceStrings.l_CutObjOrTextShortcutDescription,this.Df.szl,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_CopyObjOrTextShortcutDescription,
this.Df.rzl,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_PasteObjOrTextShortcutDescription,this.Df.Dzl,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_DuplicateObjShortcutDescription,this.Df.lZm,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_PasteTextShortcutDescription,this.Df.l_m,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_MoveLeftToRightShortcutDescription,this.Df.X8c,ResourceStrings.l_ShapesandObjectsSectionInDialog);
this.kg(ResourceStrings.l_SelectEditPlaceHolderShortcutDescription,this.Df.I_m+ResourceStrings.l_OrStringShortcutsDialog+this.Df.J_m,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_EndEditTextPlaceHolderShortcutDescription,this.Df.nZm,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_SelectMultipleSingleObjShortcutDescription,this.Df.B_m+ResourceStrings.l_OrStringShortcutsDialog+this.Df.C_m,ResourceStrings.l_ShapesandObjectsSectionInDialog);
this.kg(ResourceStrings.l_SelectMultipleObjShortcutDescription,this.Df.y_m+ResourceStrings.l_OrStringShortcutsDialog+this.Df.z_m+ResourceStrings.l_OrStringShortcutsDialog+this.Df.A_m,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_SelectAllObjOnPageShortcutDescription,this.Df.C8i,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_SelectAllTextInTextBoxShortcutDescription,this.Df.C8i,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_InsertHyperLinkInTextBoxShortcutDescription,
this.Df.uzl,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_SendObjBackOneShortcutDescription,this.Df.S_m,ResourceStrings.l_ShapesandObjectsSectionInDialog);Ef.a("AdditionsToShortcutsDialogFix")?this.kg(ResourceStrings.l_BringTheObjectForwardOnePositionShortcutDescription,this.Df.Hzl,ResourceStrings.l_ShapesandObjectsSectionInDialog):this.kg(ResourceStrings.l_SendObjForwardOneShortcutDescription,this.Df.Hzl,ResourceStrings.l_ShapesandObjectsSectionInDialog);Ef.a("AdditionsToShortcutsDialogFix")&&
(this.kg(ResourceStrings.l_BringTheObjectToTheFrontShortcutDescription,this.Df.WYm,ResourceStrings.l_ShapesandObjectsSectionInDialog),this.kg(ResourceStrings.l_SendTheObjectToTheBackShortcutDescription,this.Df.T_m,ResourceStrings.l_ShapesandObjectsSectionInDialog));this.kg(ResourceStrings.l_GroupSelectedObjShortcutDescription,this.Df.zZm,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_UngroupSelectedShortcutDescription,this.Df.f0m,ResourceStrings.l_ShapesandObjectsSectionInDialog);
this.kg(ResourceStrings.l_AdjustDimensionsShortcutDescription,this.Df.VYm,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_RotateClockwiseShortcutDescription,this.Df.v_m,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_RotateCounterClockShortcutDescription,this.Df.u_m,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.kg(ResourceStrings.l_SelectObjLowerZOrderShortcutDescription,this.Df.D_m,ResourceStrings.l_ShapesandObjectsSectionInDialog)}Apm(){this.kg(ResourceStrings.l_SelectOneLeftCharShortcutDescription,
this.Df.E_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SelectOneRightCharShortcutDescription,this.Df.F_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SelectOneWordLeftShortcutDescription,this.Df.G_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SelectOneWordRightShortcutDescription,this.Df.H_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SelectOneLineUpShortcutDescription,this.Df.Q_m,ResourceStrings.l_TextEditingSectionInDialog);
this.kg(ResourceStrings.l_SelectOneLineDownShortcutDescription,this.Df.x_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SelectToParagraphBegShortcutDescription,this.Df.O_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SelectToParagraphEndShortcutDescription,this.Df.L_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SelectToLineBegShortcutDescription,this.Df.N_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SelectToLineEndShortcutDescription,
this.Df.K_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SelectToPlaceHolderBegShortcutDescription,this.Df.P_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SelectToPlaceHolderEndShortcutDescription,this.Df.M_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SelelctAllInPlaceHolderShortcutDescription,this.Df.C8i,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_DeleteOneCharLeftShortcutDescription,this.Df.fZm,
ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_DeleteOneCharRightShortcutDescription,this.Df.gZm,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_DeleteOneWordLeftShortcutDescription,this.Df.hZm,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_DeleteOneWordRightShortcutDescription,this.Df.iZm,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_MoveOneCHarLeftShortcutDescription,this.Df.MZm,ResourceStrings.l_TextEditingSectionInDialog);
this.kg(ResourceStrings.l_MoveOneCharRightShortcutDescription,this.Df.NZm,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_MoveOneWordLeftShortcutDescription,this.Df.xzl,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_MoveOneWordRightShortcutDescription,this.Df.yzl,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_MoveOneLineUpShortcutDescription,this.Df.PZm,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_MoveOneLineDownShortcutDescription,
this.Df.OZm,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_MoveToEndOfLineShortcutDescription,this.Df.a_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_MoveToBegOfLineShortcutDescription,this.Df.g_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_MoveUpOneParaShortcutDescription,this.Df.i_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_MoveDownOneParaShortcutDescription,this.Df.HZm,ResourceStrings.l_TextEditingSectionInDialog);
this.kg(ResourceStrings.l_MoveToTextBoxEndShortcutDescription,this.Df.b_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_MoveToTextBoxBegShortcutDescription,this.Df.h_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_IncreaseFontShortcutDescription,this.Df.AZm,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_DecreaseFontShortcutDescription,this.Df.W_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_BoldShortcutDescription,
this.Df.qzl,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_ApplyItalicShortcutDescription,this.Df.CZm,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_ApplyUnderlineShortcutDescription,this.Df.d0m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_CenterParaShortcutDescription,this.Df.XYm,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_JustifyParaShortcutDescription,this.Df.DZm,ResourceStrings.l_TextEditingSectionInDialog);
this.kg(ResourceStrings.l_ApplySubscriptShortcutDescription,this.Df.Y_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_ApplySuperscriptShortcutDescription,this.Df.Z_m,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_SwitchCasesShortcutDescription,this.Df.$_m,ResourceStrings.l_TextEditingSectionInDialog);this.vad||(this.kg(ResourceStrings.l_RemoveFormattingShortcutDescription,this.Df.q_m,ResourceStrings.l_TextEditingSectionInDialog),this.kg(ResourceStrings.l_PromoteParaShortcutDescription,
this.Df.o_m,ResourceStrings.l_TextEditingSectionInDialog),this.kg(ResourceStrings.l_DemoteParaShortcutDescription,this.Df.jZm,ResourceStrings.l_TextEditingSectionInDialog));this.kg(ResourceStrings.l_CreateRoundBulletListShortcutDescription,this.Df.dZm,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_CreateHyphensListShortcutDescription,this.Df.aZm,ResourceStrings.l_TextEditingSectionInDialog);this.kg(ResourceStrings.l_CreateListArrowShortcutDescription,this.Df.bZm,ResourceStrings.l_TextEditingSectionInDialog);
this.kg(ResourceStrings.l_CreateListDiamondShortcutDescription,this.Df.cZm,ResourceStrings.l_TextEditingSectionInDialog)}xpm(){this.kg(ResourceStrings.l_MoveToNextCellShortcutDescription,this.Df.c_m,ResourceStrings.l_TablesSectionInDialog);this.kg(ResourceStrings.l_MoveToPrevCellShortcutDescription,this.Df.e_m,ResourceStrings.l_TablesSectionInDialog);this.kg(ResourceStrings.l_MoveToNextRowShortcutDescription,this.Df.d_m,ResourceStrings.l_TablesSectionInDialog);this.kg(ResourceStrings.l_MoveToPrevRowShortcutDescription,
this.Df.f_m,ResourceStrings.l_TablesSectionInDialog);this.kg(ResourceStrings.l_StartNewParaShortcutDescription,this.Df.ljh,ResourceStrings.l_TablesSectionInDialog);this.kg(ResourceStrings.l_AddNewRowShortcutDescription,this.Df.UYm,ResourceStrings.l_TablesSectionInDialog)}Xnm(){Ef.a("AdditionsToShortcutsDialogFix")&&this.kg(ResourceStrings.l_NewCommentShortcutDescription,this.Df.j_m,ResourceStrings.l_CommentsSectionInDialog);this.kg(ResourceStrings.l_NextCommentShortcutDescription,this.Df.sZm,ResourceStrings.l_CommentsSectionInDialog);
this.kg(ResourceStrings.l_PrevCommentShortcutDescription,this.Df.wZm,ResourceStrings.l_CommentsSectionInDialog);this.kg(ResourceStrings.l_ExpandCommentShortcutDescription,this.Df.pZm,ResourceStrings.l_CommentsSectionInDialog);this.kg(ResourceStrings.l_CollapseCommentShortcutDescription,this.Df.ZYm,ResourceStrings.l_CommentsSectionInDialog);this.kg(ResourceStrings.l_NextReplyInCommentShortcutDescription,this.Df.tZm,ResourceStrings.l_CommentsSectionInDialog);this.kg(ResourceStrings.l_PrevReplyInCommentShortcutDescription,
this.Df.vZm,ResourceStrings.l_CommentsSectionInDialog);Ef.a("AdditionsToShortcutsDialogFix")&&(this.kg(ResourceStrings.l_MoveFocusToNextInCommentShortcutDescription,this.Df.X8c,ResourceStrings.l_CommentsSectionInDialog),this.kg(ResourceStrings.l_MoveFocusToPreviousInCommentShortcutDescription,this.Df.MMd,ResourceStrings.l_CommentsSectionInDialog),this.kg(ResourceStrings.l_MoveFocusFromCommentToAnchorShortcutDescription,this.Df.wzl,ResourceStrings.l_CommentsSectionInDialog),this.kg(ResourceStrings.l_MoveFocusFromAnchorToCommentShortcutDescription,
this.Df.wzl,ResourceStrings.l_CommentsSectionInDialog));this.kg(ResourceStrings.l_FocusReplyShortcutDescription,this.Df.IZm,ResourceStrings.l_CommentsSectionInDialog);this.kg(ResourceStrings.l_EditCommentShortcutDescription,this.Df.mZm,ResourceStrings.l_CommentsSectionInDialog);this.kg(ResourceStrings.l_PostCommentShortcutDescription,this.Df.m_m,ResourceStrings.l_CommentsSectionInDialog)}kom(){this.kg(ResourceStrings.l_FindAndReplaceShortcutDescription,this.Df.tzl,ResourceStrings.l_FindandReplaceSectionInDialog);
Ef.a("AdditionsToShortcutsDialogFix")&&this.kg(ResourceStrings.l_ReplaceShortcutDescription,this.Df.s_m,ResourceStrings.l_FindandReplaceSectionInDialog)}Eom(){this.kg(ResourceStrings.L_KeyboardNavigationMoveForwardShortcutDescription,this.Df.LZm,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.kg(ResourceStrings.L_KeyboardNavigationMoveBackwardShortcutDescription,this.Df.FZm,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.kg(ResourceStrings.l_DiffRibbonTabShortcutDescription,this.Df.rZm,
ResourceStrings.l_KeyboardNavigationSectionInDialog);this.kg(ResourceStrings.l_RibbonOptionShortcutDescription,this.Df.ljh,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.kg(ResourceStrings.l_MoveRibbonOptionsShortcutDescription,this.Df.GZm,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.kg(ResourceStrings.l_MoveRibbonFeatureGroupsShortcutDescription,this.Df.xzl+ResourceStrings.l_OrStringShortcutsDialog+this.Df.yzl,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.kg(ResourceStrings.l_MoveInTaskPaneShortcutDescription,
this.Df.X8c+ResourceStrings.l_OrStringShortcutsDialog+this.Df.MMd,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.vad||this.kg(ResourceStrings.L_SwitchBetweenRibbonsShortcutDescription,this.Df.a0m,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.kg(ResourceStrings.l_DisplayRibbonAccessShortcutDescription,this.Df.kZm,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.kg(ResourceStrings.l_OpenShortcutDialogShortcutDescription,this.Df.k_m,ResourceStrings.l_KeyboardNavigationSectionInDialog)}ipm(){Ef.a("AdditionsToShortcutsDialogFix")&&
this.kg(ResourceStrings.l_ShowOrHideSelectionPaneShortcutDescription,this.Df.R_m,ResourceStrings.l_SelectionPaneSectionInDialog);this.vad||this.kg(ResourceStrings.l_MoveItemForwardShortcutDescription,this.Df.RZm,ResourceStrings.l_SelectionPaneSectionInDialog);Ef.a("AdditionsToShortcutsDialogFix")&&(this.kg(ResourceStrings.l_MoveSelectedItemBackwardShortcutDescription,this.Df.QZm,ResourceStrings.l_SelectionPaneSectionInDialog),this.kg(ResourceStrings.l_SelectItemInFocusShortcutDescription,this.Df.Gzl,
ResourceStrings.l_SelectionPaneSectionInDialog));this.kg(ResourceStrings.l_MoveFocusSingleShortcutDescription,this.Df.JZm,ResourceStrings.l_SelectionPaneSectionInDialog);this.kg(ResourceStrings.l_ExpandFocusGroupShortcutDescription,this.Df.qZm,ResourceStrings.l_SelectionPaneSectionInDialog);this.kg(ResourceStrings.l_CollapseFocusGroupShortcutDescription,this.Df.$Ym,ResourceStrings.l_SelectionPaneSectionInDialog);Ef.a("AdditionsToShortcutsDialogFix")&&this.kg(ResourceStrings.l_AddOrRemoveItemInFocusShortcutDescription,
this.Df.TYm,ResourceStrings.l_SelectionPaneSectionInDialog);this.kg(ResourceStrings.l_RenameFocusItemShortcutDescription,this.Df.r_m,ResourceStrings.l_SelectionPaneSectionInDialog);this.kg(ResourceStrings.l_ExpandGroupsShortcutDescription,this.Df.oZm,ResourceStrings.l_SelectionPaneSectionInDialog);Ef.a("AdditionsToShortcutsDialogFix")&&this.kg(ResourceStrings.l_CollapseAllShortcutDescription,this.Df.YYm,ResourceStrings.l_SelectionPaneSectionInDialog)}$nm(){this.kg(ResourceStrings.l_MoveThroughElementsWithOnly1StopOnTheCardListDescription,
this.Df.X8c+ResourceStrings.l_OrStringShortcutsDialog+this.Df.MMd,ResourceStrings.l_Copilot);this.kg(ResourceStrings.l_MoveThroughTheCardsInTheCardListShortcutDescription,this.Df.D8i+ResourceStrings.l_OrStringShortcutsDialog+this.Df.A8i,ResourceStrings.l_Copilot);this.kg(ResourceStrings.l_NavigateIntoACardShortcutDescription,this.Df.ljh,ResourceStrings.l_Copilot);this.kg(ResourceStrings.l_MoveThroughTheElementsWithinACardShortcutDescription,this.Df.X8c+ResourceStrings.l_OrStringShortcutsDialog+this.Df.MMd,
ResourceStrings.l_Copilot);this.kg(ResourceStrings.l_NavigateOutOfACardShortcutDescription,this.Df.B8i,ResourceStrings.l_Copilot)}kg(ka,ib,Rb){this.TLl.push({description:ka,shortcut:ib,section:Rb,overrideBrowserShortcut:""})}}Object(m.a)(Di,"KeyboardShortcutsCollection",null,[]);class ak{get name(){return"PowerPointWebEditor.KeyboardShortcutsDialog"}lc(ka){this.$=ka;const ib=this.$.resolve("PowerPointWebEditor.IApplicationSettings");ka.register(Di,"PowerPointWebEditor.KeyboardShortcutsCollection").ma().na(()=>
new Di(ib))}init(){if(this.$){const ka=new ek(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.KeyboardShortcutsCollection"),this.$.resolve("PowerPointWebEditor.IFocusManager"));ka.Hb();ka.ve()}else n.ULS.sendTraceTag(508367313,334,50,"PPTWebEditorKeyboardShortcutsDialogPackage.init Empty container while intializing")}dispose(){}static main(){L.a.instance.Fc(new ak)}}Object(m.a)(ak,"PPTWebEditorKeyboardShortcutsDialogPackage",null,[3,4]);var Rj=a(139);class Lf{constructor(){this.flyoutAnchorTarget=
this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(m.a)(Lf,"CatchUpConfiguration",null,[]);class Sh{constructor(){this.recentChangesManager=this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=
this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(m.a)(Sh,"SharedControllerFactoryParameters",null,[]);const Nh=(ka,ib)=>{if(!ka)throw Error.create(String.format("Argument {0} is null.",ib));},Fk=ka=>{if(!ka.navigationId)return Ob.a.J(507843593,3012,10,"CreateNavigationData: navigation id is missing."),null;try{const ib=window.atob(ka.navigationId);return ib&&""!==ib?{["NavigationId"]:ib}:null}catch(ib){return Ob.a.J(507843592,
3012,10,"CreateNavigationData: decoding navigation id failed.",ib),null}};class bk{constructor(ka){Nh(ka,"ActivityContentManager.IActionManagerExtended");this.ia=ka}doesContentExist(ka){if(!ka)return Ob.a.J(508039179,3012,10,"DoesContentExist: activity is null."),!1;switch(ka.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 12:return(ka=Fk(ka))?32===this.ia.Qa(ba.a.dBe,2,ka):!1;default:return!1}}}Object(m.a)(bk,"ActivityContentManager",null,[1148]);class Uh{constructor(ka){this.Gs=
ka}shouldShowEmptyExperienceButton(){return u.AFrameworkApplication.ZVf()}getExplanationText(){return""}getCommandName(){return ResourceStrings.L_FileHistory}onButtonClick(){this.Gs.Qa(ba.a.Xed,2,null)}onInviteOthersButtonClick(){this.Gs.Qa(ba.a.dEa,2,null)}}Object(m.a)(Uh,"EmptyCatchUpBehaviorManager",null,[1151]);class Ge{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(m.a)(Ge,"Person",null,[]);var Hf=a(1032),Bg=a(404),qk=a(369);
class Oj extends sj.a{constructor(ka){super();this.StartTime=null;this.StartTime=ka}Gn(){return 93}}Object(m.a)(Oj,"GetFileRevisionHistoryRequest",sj.a,[]);class Hk{constructor(ka,ib,Rb){this.ProviderId=this.UserId=this.UserName=null;this.UserName=ka;this.UserId=ib;this.ProviderId=Rb}}Object(m.a)(Hk,"Author",null,[]);const Hi=(ka,ib)=>ka&&ib?ka.providerIdField===ib.ProviderId?ka.userIdField===ib.UserId:ka.userNameField===ib.UserName:!1;var nh=a(420);class Pf{constructor(ka,ib,Rb){this.Tnh=this.vXd=
null;this.qm=ka;this.vYd=Rb;this.vYd.Eel(Object(K.a)(this,this.VPl,"onFileRevisionHistoryReady"));ib.fg(()=>{this.vXd=new Hk(ib.La("UserName"),ib.La(Dc.a.lPa),ib.La(Dc.a.L2b))})}dispose(){this.vYd.QYl(Object(K.a)(this,this.VPl,"onFileRevisionHistoryReady"));this.vXd=null}UOm(ka,ib,Rb){ka&&Rb&&(this.Tnh=Rb,ka=new nh.a(new Oj(ka),tc=>{this.LFl(tc,ib);this.$bd(tc)},tc=>{this.LFl(tc,ib);return this.bbb(tc)}),this.qm.Qb(ka))}VPl(ka,ib){ka=null;const Rb=[];ra.a.rb(ib.Jwf)||(({Jwf:ib}=this.WVn(ib.Jwf)).returnValue?
qk.b(ib.fileRevisionEntriesField,tc=>this.y5m(tc.changesDataField),tc=>{Rb.push(tc.changesDataField)}):ka="ErrorGetFileRevisionHistoryParseJsonException");this.WZj(Rb,ka)}$bd(ka){let ib=null;ka.ServerError&&0!==ka.ServerError.Code?ib=Bg.a[ka.ServerError.Code]:0!==ka.StatusCode&&(ib=Hf.a[ka.StatusCode]);ib&&this.WZj(null,ib)}bbb(ka){Ob.a.J(512262998,811,15,"OnGetFileRevisionAuthorNamesFailed() - "+ka.toString());this.WZj(null,"ErrorGetFileRevisionHistoryFailed");return!0}WZj(ka,ib){this.Tnh&&(ka=this.xLm(ka),
this.Tnh(ka,ib),this.Tnh=null)}WVn(ka){let ib;ib=null;try{ib=Sys.Serialization.JavaScriptSerializer.deserialize(ka)}catch(Rb){Ob.a.J(512262997,811,10,"TryParseFileRevisionList() - Exception: "+Rb)}return{returnValue:!!ib,Jwf:ib}}y5m(ka){return!Hi(ka,this.vXd)}LFl(ka,ib){ka.PBa&&ib.km("GetAuthorNamesRequestInvokedTime",ka.PBa);ib.Ya("GetAuthorNamesRequestCorrelationId",ka.Wh)}xLm(ka){if(!ka)return[];const ib=Array(ka.length);for(let tc=0;tc<ka.length;tc++){var Rb=ka[tc];Rb=Object.assign(new Ge,{displayName:Rb.userNameField,
id:Rb.userIdField,provider:Rb.providerIdField});ib[tc]=Rb}return ib}}Object(m.a)(Pf,"FileRevisionHistoryService",null,[1180,24]);class Q{constructor(ka,ib){Nh(ka,"FlyoutFocus.IF6Manager");Nh(ib,"FlyoutFocus.IFocusManagerHelper");this.qj=ka;this.eR=ib}initialize(){this.eR.pTa(Cc.a.Uoc,Cc.a.vl,null,Object(K.a)(this,this.PJm,"focusOnFirstFlyoutItem"),()=>{},!0)}enableF6Focus(){this.qj.XW(Cc.a.Uoc)}disableF6Focus(){this.qj.Cr(Cc.a.Uoc)}PJm(){const ka=document.getElementById("flyoutItem0");ka&&(Ob.a.J(570730465,
3012,50,"Focused on the catch-up flyout via ctrl+F6"),ka.focus())}}Object(m.a)(Q,"FlyoutFocus",null,[1178]);class xa{constructor(ka,ib,Rb,tc){this.Imh=null;this.YGl=this.boh=this.OGe=this.m8f=!1;Nh(ib,"FlyoutRibbonButton.IActionManagerExtended");Nh(Rb,"FlyoutRibbonButton.IFocusManager");Nh(tc,"FlyoutRibbonButton.FloodgateEventLogger");this.Db=ka;this.ia=ib;this.Ma=Rb;this.Xbn=tc;this.Ybn=new Date}initialize(){u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&Ef.a("DelayRegisterCatchUpActions")||this.Hb()}registerButtonClickedEvent(ka){this.Imh&&Ob.a.J(507843654,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.Imh=ka.buttonClickedCallback}onFlyoutInitialized(){this.m8f&&Ob.a.J(507843653,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const ka=(new Date).getTime()-this.Ybn.getTime();Ob.a.J(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",ka);this.m8f=
!0;nb.c(ba.a.Fwm,!0,nb.e,0,0,ka);u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Ef.a("DelayRegisterCatchUpActions")&&this.Hb();u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)||this.Db&&this.Db.Zf()}logFlightTriggers(){}onFlyoutVisibilityChanged(ka){this.OGe!==ka.flyoutIsVisible&&(this.OGe=ka.flyoutIsVisible,this.Db&&this.Db.Zf(!0),this.OGe&&this.YGl?this.Ma.gh(Cc.a.Uoc):this.OGe||
this.Ma.gh(Cc.a.vl),this.OGe||this.Xbn.L9m())}Hb(){this.ia.za(ba.a.g_g,I.a.frame,Object(K.a)(this,this.Fsn,"onToggleCatchUpFlyout"));this.ia.sa(ba.a.Xek,I.a.frame,Object(K.a)(this,this.trn,"onQueryToggleCatchUpFlyout"),96)}Fsn(ka,ib,Rb){ka=u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1);if(1===Rb)return ka||this.m8f?(this.boh||(this.boh=!0,Ob.a.J(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(ka&&!this.m8f)return Ob.a.J(507647624,
3012,15,"Flyout isn't initialized yet."),8;if(!this.Imh)return 8;this.YGl=!0;this.Imh();return 32}trn(ka,ib,Rb,tc,xc){xc[Mi.a.Visible]=!0;xc[Mi.a.On]=this.OGe&&this.m8f;return 32}}Object(m.a)(xa,"FlyoutRibbonButton",null,[1179]);const ob=ka=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+ka)};class Qb{constructor(ka,ib,Rb,tc,xc,hd){Nh(ka,"PowerPointActivityNavigationManager.IActionManagerExtended");Nh(ib,"PowerPointActivityNavigationManager.IPresentationReader");
Nh(Rb,"PowerPointActivityNavigationManager.IThumbnailNavigationPaneView");Nh(tc,"PowerPointActivityNavigationManager.IRibbonUser");Nh(hd,"PowerPointActivityNavigationManager.IActivityContentManager");this.ia=ka;this.oc=ib;this.Jf=Rb;this.qy=tc;this.Vdn=xc;this.Han=hd}navigateToActivity(ka){if(ka.fromSummaryString)return this.YLn(),this.EVm(),this.DVm(),this.vPn(),Promise.resolve(1);ka=ka.activity;if(!ka)return Ob.a.J(508039178,3012,10,"NavigateToActivity: activity is null."),Promise.resolve(8);if(!ka.navigationId)return Ob.a.J(508039177,
3012,10,"NavigateToActivity: navigation id is null."),Promise.resolve(4);if(!this.Han.doesContentExist(ka))return Promise.resolve(2);switch(ka.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 12:ka=Fk(ka);if(!ka)return Promise.resolve(5);ka=this.ia.Qa(ba.a.lAe,2,ka);return Promise.resolve(32===ka?1:6);default:return Promise.resolve(7)}}YLn(){const ka=this.oc.jn;ka?ka.pac=!0:Ob.a.J(508039176,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}EVm(){this.qy.selectRibbonTabById(this.Vdn)}DVm(){var ka=
this.oc.jn;if(ka&&ka.slides){var ib=null;for(const Rb of ka.slides)if(Rb&&(ka=this.oc.Wk(Rb.Xb))&&ka.isUnread){ib=ka;break}ib?this.Jf.x8(ib.ph):Ob.a.J(508039174,3012,15,"PowerPointActivityNavigationManager: Could not find any unread slides.")}else Ob.a.J(508039175,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}vPn(){this.ia.Qa(Pb.a.qDb,2,{InvokeSource:1,ShowRevisionTrackingStatus:3})}}Object(m.a)(Qb,"PowerPointActivityNavigationManager",null,[1149]);var mc=a(880);class yc{constructor(){this.collectionId=
this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(m.a)(yc,"ActivityFeedEntry",null,[]);const Sc=(ka,ib)=>ib.QUd?w.toArray(w.select(w.asEnumerable(ka),Rb=>{if(!Rb||!Rb.activityFeedItemPayload)return Rb;const tc=JSON.parse(Rb.activityFeedItemPayload);var xc=tc.actor;if(!xc||xc.pictureUrl)return Rb;const hd=xc.userPrincipalName||xc.email;if(!hd)return Rb;xc=ib.LMb(hd,xc.provider,u.AFrameworkApplication.ui,0);if(!xc)return Rb;tc.actor.pictureUrl=xc;return Object.assign(new yc,
{id:Rb.id,type:Rb.type,collectionId:Rb.collectionId,activityState:Rb.activityState,activityFeedItemPayload:JSON.stringify(tc),timestamp:Rb.timestamp})})):ka,wd=(ka,ib)=>{const Rb=new Map,tc=new Map;for(const xc of ka){if(!xc||!xc.activityFeedItemPayload)continue;ka=JSON.parse(xc.activityFeedItemPayload).actor;if(!ka)continue;const hd=ka.email||ka.userPrincipalName;hd&&!tc.has(hd)&&tc.set(hd,new mc.a(hd,null,ka.name))}tc.forEach(xc=>{const hd=ib.w_a(xc,6);Rb.set(xc.UserId,hd)});return Rb};class zd{constructor(){this.collectionId=
this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(m.a)(zd,"ActivityFeedItem",null,[]);class Pd{constructor(){this.personaColorMap=this.activityFeedItems=null}}Object(m.a)(Pd,"ActivityFeedPayload",null,[]);class Je{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(m.a)(Je,"ActivityRequestPayload",null,[]);var ge=a(812);class tb{constructor(){this.activityFeedItemId=
this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(m.a)(tb,"Activity",null,[]);class Kc{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a){this.jf=this.SIj=null;Nh(ka,"PowerPointActivityRequestManager.IJsonpHelperManager");Nh(ib,"PowerPointActivityRequestManager.PowerPointWaterlineUpdater");Nh(Rb,"PowerPointActivityRequestManager.IFileRevisionHistoryService");Nh(tc,"PowerPointActivityRequestManager.IAppSettingsManager");
Nh(xc,"PowerPointActivityRequestManager.IApplicationSettings");Nh(hd,"PowerPointActivityRequestManager.IActionManagerExtended");Nh(Fd,"PowerPointActivityRequestManager.ICatchUpRequestHandler");Nh(Td,"PowerPointActivityRequestManager.IUserProfilePictureUtilsV2");Nh(na,"PowerPointActivityRequestManager.IPeopleColorUtils");this.Ooa=ka;this.dfn=ib;this.Tbn=Rb;this.Fb=tc;this.ia=hd;this.Mmh=Fd;this.Edn=Td;this.F5d=na;this.ILl=$a}requestWYWAActivities(){return new Promise((ka,ib)=>{this.jf=Ae.a.Fk("ShowWYWACallout",
2);this.dfn.lIn(Rb=>{Rb=this.hBn(Rb);Kc.isExpectedError(Rb)?ka(Kc.keh):Rb?(Ob.a.J(509223009,3012,10,"OnReadRoamingSucceeded() - Error: {0}",Rb),ib(Rb)):this.Tbn.UOm(this.SIj,this.jf,(tc,xc)=>{xc&&(Ob.a.J(509223008,3012,10,"GetFileRevisionAuthorNamesAsync() - Error: {0}",xc),ib(xc));ka(Kc.Gzm(tc))})},Rb=>{const tc=!!Rb.data&&Kc.w4m(Rb.data.Ze);Rb=this.Ooa.LV(Rb);Ob.a.J(509223007,3012,tc?50:10,"OnReadRoamingFailed() - Error: {0}",Rb);tc?ka(Kc.keh):ib(Rb)})})}requestActivities(){return Promise.resolve(Kc.keh)}requestRelevantActivities(){return Promise.resolve(Kc.keh)}requestActivityFeed(){return this.Mmh?
ge.b(this.Mmh.wLm(this.ILl)).then(ka=>{ka=Kc.ZUn(ka);return{activityFeedItems:Sc(ka,this.Edn),personaColorMap:wd(ka,this.F5d)}}):Promise.resolve(Object.assign(new Pd,{activityFeedItems:[]}))}updateActivityState(ka){return this.Mmh?ge.b(this.Mmh.XWn(this.ILl,ka.itemIds,ka.activityStatesToSet||0,ka.activityStatesToReset||0,ka.resetUnseenCount)):Promise.resolve(!1)}hBn(ka){ka=ka.data.responseData;if(!ka)return"ErrorReadRoamingEmptyResponseBody";let ib;try{ib=JSON.parse(ka)}catch(Rb){return Rb.toString()}ka=
null;if(!ib.Error){if(!ib.Timestamp)throw Error.create("response.Error and response.Timestamp are empty");ka=ib.Timestamp}this.SIj=this.DYn(ka);Ob.a.J(509223006,3012,100,"Timestamp for retrieving activities: "+this.SIj);return ib.Error}DYn(ka){const ib={};var Rb=this.Fb.Jc("AppWaterlineOverrideTimestampValue",0);return Rb?(ka=new Date(1E3*Rb),ib.timestamp=ka,this.ia.Qa(Pb.a.sNe,2,ib),ka.format("yyyy-MM-ddTHH:mm:ssZ")):ka?(Rb=this.Fb.Jc("AppWaterlineOverrideDaysValue",0))?(ka=new Date(+new Date(ka)-
+new Date(864E5*Rb)),ib.timestamp=ka,this.ia.Qa(Pb.a.sNe,2,ib),ka.format("yyyy-MM-ddTHH:mm:ssZ")):ka:null}static Gzm(ka){return ka?Object.assign(new Je,{actors:ka}):null}static ZUn(ka){const ib=[];if(!ka)return ib;for(const Rb of ka)ib.push(Object.assign(new zd,{id:Rb.id,type:Rb.type,collectionId:Rb.collectionId,activityState:Rb.activityState,activityFeedItemPayload:Rb.activityFeedItemPayload,timestamp:Rb.timestamp}));return ib}static isExpectedError(ka){return"ErrorDocNotInRoamingList"===ka||"ErrorLastViewedDocListIsEmpty"===
ka}static w4m(ka){return 403===ka}}Kc.keh=Object.assign(new Je,{activities:[],actors:[],hasMore:!1,highWaterline:"",lowWaterline:"",wywaWaterline:""});Object.assign(new Je,{activities:[Object.assign(new tb,{activityId:"activityId1",type:3,actors:[Object.assign(new Ge,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new tb,{activityId:"activityId2",type:4,actors:[Object.assign(new Ge,
{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId2"})]});Object.assign(new Pd,{activityFeedItems:[Object.assign(new zd,{id:"FeedItemId1",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"1","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a1","navigationId":"n1","commentThreadId":"1","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"kat.larsson@microsoft.com","userPrincipalName":"klarsson@microsoft.com","name":"Kat Larsson","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()}),Object.assign(new zd,{id:"FeedItemId2",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"2","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a2","navigationId":"n2","commentThreadId":"2","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"frankie.smith@microsoft.com","userPrincipalName":"fsmith@microsoft.com","name":"Frankie Smith","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()})]});Object(m.a)(Kc,"PowerPointActivityRequestManager",null,[1150]);var ad=a(397);class id{constructor(ka,ib,Rb,tc,xc,hd){this.xBb=!1;this.hKl=null;this.od=ka;this.$p=ib;this.Wdn=Rb;this.Ooa=tc;this.Tb=xc;this.NHe=hd}initialize(){this.od&&(this.od.i9a(Object(K.a)(this,this.Xab,"onBeforeSessionEnd")),this.od.sE(Object(K.a)(this,this.JP,"onSessionClosed")));this.oJn()}lIn(ka,ib){const Rb=this.qwl("getPPTDocLastViewedTimestamp");this.XF(Rb,1,ka,ib)}Xab(){this.pam()}JP(){this.xBb=
!0}oJn(){if(this.Tb){var ka=new Wa.a(3,2,3E4,Object(K.a)(this,this.yHn,"requestWriteWaterline"),90,"29");this.Tb.Qb(ka)}}yHn(){!this.xBb&&3E4<+Ae.a.yDc-+this.hKl&&(this.pam(),this.hKl=Ae.a.yDc)}pam(){const ka=this.qwl("savePPTDocLastViewedTimestamp");this.NHe.getBooleanAppSetting("SendBeaconOnRoamingRequestsIsEnabled")?this.$p.lda(ka,""):this.XF(ka,2,Object(K.a)(this,this.Vsn,"onWriteWaterlineSucceeded"),Object(K.a)(this,this.Usn,"onWriteWaterlineFailed"))}Vsn(ka){let ib=null;try{const Rb=ka.data.responseData;
ib=Rb?JSON.parse(Rb).Error:"ErrorWriteRoamingEmptyResponseBody"}catch(Rb){ib="ErrorWriteRoamingParseJsonResponseException",Ob.a.J(507843781,3012,10,"OnWriteRoamingSucceeded() - Exception: "+Rb)}finally{ib&&this.WFl(ib)}Ob.a.J(507843780,3012,50,"OnWriteRoamingSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+ka.data.zr-+ka.data.WC,+ka.data.qq-+ka.data.WC)}Usn(ka){this.WFl("ErrorReadRoamingFailed");Ob.a.J(507843779,3012,10,"OnWriteRoamingFailed() - Failure message: {0}",this.Ooa.LV(ka))}qwl(ka){return this.Wdn+
String.format("RoamingServiceHandler.ashx?action={0}&{1}",ka,u.AFrameworkApplication.ui)}XF(ka,ib,Rb,tc){const xc={};xc["X-StatelessPopsAffinityRoutingEnabled"]=this.NHe.getBooleanAppSetting("PPTStatelessPOPSRequestAffinityEnabled").toString();this.$p.rk(ka,ib,null,xc,!1,1,Rb,tc,null,void 0,void 0,void 0,void 0,ad.a("5"))}WFl(ka){Ob.a.J(507843778,811,50,ka)}}Object(m.a)(id,"PowerPointWaterlineUpdater",null,[]);class ud{get name(){return"PowerPointWebEditor.Activity"}get Xej(){return u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)}init(){this.$.resolve("Common.IAppSettingsManager").fg(Object(K.a)(this,this.yDm,"delayedInit"))}lc(ka){this.$=ka}dispose(){this.$=this.Lmh=null}lOn(ka){return!ka||ka.getBooleanAppSetting("IsAnonymousUser")?!1:ka.getBooleanAppSetting("PPTCatchUpFlyoutIsEnabled")}yDm(){const ka=this.$.resolve("Common.IAppSettingsManager");this.lOn(ka)&&(ob("Begin"),this.AFm(),this.d$m())}AFm(){Wf.a.get_instance().$i(7,()=>{ob("ScriptDownload");gc.a(this.$)("catchUpActivity").catch(()=>{Ob.a.J(512262995,3012,10,
"Failed to download catch-up script")}).then(()=>this.Z0m()).catch(()=>{Ob.a.J(512262994,3012,10,"Failed to initialize shared catch-up code")})})}d$m(){Ob.a.J(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.Xej&&Ob.a.J(526718752,3012,50,"ActivityFeedData is enabled")}Z0m(){const ka=new Pf(this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.$.resolve("Common.IAppSettingsManager"),this.$.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler")),ib=this.$.resolve("Common.AFrameworkApplication");
this.$.register(id,"PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").ma().na(()=>new id(this.$.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),u.AFrameworkApplication.ye,this.$.resolve("PowerPointWebEditor.IApplicationSettings").dZ,this.$.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.$.resolve("Common.ITaskManager"),this.$.resolve("Common.IAppSettingsManager")));this.$.register(1148,"Common.App.CatchUpActivity.IActivityContentManager").ma().na(()=>new bk(this.$.resolve("Common.IActionManagerExtended"),
this.$.resolve("PowerPointWebEditor.IApplicationSettings")));this.$.register(1149,"Common.App.CatchUpActivity.IActivityNavigationManager").ma().na(()=>new Qb(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.$.resolve("PowerPointWebEditor.IRibbonUser"),xb.a.dXl,this.$.resolve("Common.App.CatchUpActivity.IActivityContentManager")));let Rb=null;this.$.resolve("PowerPointWebEditor.IApplicationSettings").Rh&&
(Rb=this.$.resolve("Common.IAppSettingsManager").La(Dc.a.B8)+"p");this.$.register(1150,"Common.App.CatchUpActivity.IActivityRequestManager").ma().na(()=>new Kc(this.$.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.$.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater"),ka,this.$.resolve("Common.IAppSettingsManager"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler"),
this.$.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.$.resolve("Common.App.People.IPeopleColorUtils"),Rb));this.$.register(xa,"PowerPointWebEditor.Activity.FlyoutRibbonButton").as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ma().na(()=>new xa(ib.nj,u.AFrameworkApplication.vb,this.$.resolve("PowerPointWebEditor.IFocusManager"),this.$.resolve("Common.App.CatchUpActivity.FloodgateEventLogger")));this.$.register(Q,"PowerPointWebEditor.Activity.FlyoutFocus").as("Common.App.CatchUpActivity.IFlyoutFocus").ma().na(()=>
new Q(this.$.resolve("Common.IF6Manager"),this.$.resolve("PowerPointWebEditor.View.IFocusManagerHelper")));this.$.register(1151,"Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ma().na(()=>new Uh(this.$.resolve("Common.IActionManagerExtended")));this.Lmh=catchUpActivity.FactoryGlobal.getPowerPointCatchUpAppInstance(Object.assign(new Sh,{activityContentManager:this.$.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.$.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),
activityRequestManager:this.$.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),dataCulture:u.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.Xej?this.$.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutFocus:this.$.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),flyoutRibbonButton:this.$.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),uiCulture:u.AFrameworkApplication.uiCulture,ulsLogger:new Rj.a}));if(!this.Lmh)return Promise.reject("Failure to create CatchUpApp");
this.$.resolve("PowerPointWebEditor.Activity.FlyoutRibbonButton").initialize();this.$.resolve("PowerPointWebEditor.Activity.FlyoutFocus").initialize();this.Lmh.setWebpackPublicPath(u.AFrameworkApplication.bra);ob("InitializeCatchUpApp");return this.Lmh.initialize(Object.assign(new Lf,{activityFeedDataEnabled:this.Xej,featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0})).then(()=>{this.$.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").initialize()})}static main(){L.a.instance.Fc(jb.a(new ud,
0))}}Object(m.a)(ud,"PPTWebEditorActivityPackage",null,[3,4]);var ke=a(1494);class of extends Sys.EventArgs{constructor(ka,ib){super();this.shape=ka;this.pac=ib}}Object(m.a)(of,"ShowHideStateChangedEventArgs",Sys.EventArgs,[]);class Yf{constructor(ka,ib,Rb,tc,xc,hd,Fd){this.jf=null;this.ia=ka;this.va=ib;this.ZTa=Rb;this.zph=tc;this.Ub=xc;this.Ad=hd;this.FHe=Fd}dispose(){this.jf&&(this.jf=null)}ve(){}Hb(){this.ia.za(Pb.a.eIe,sg.a.application,Object(K.a)(this,this.EWm,"handleMarkAsRead"));this.ia.za(Pb.a.qDb,
sg.a.application,Object(K.a)(this,this.rXm,"handleShowHideChanges"));this.ia.sa(Pb.a.cLe,Id.a.application,Object(K.a)(this,this.$Wm,"handleQueryShowHideChanges"),96);this.ia.sa(Pb.a.sNe,sg.a.application,Object(K.a)(this,this.sXm,"handleShowRevisionTrackingWithUrlOverrides"),96)}EWm(ka,ib,Rb,tc,xc){if(1===Rb)return this.Ub.hl()?32:8;ka=new Date;if(!xc)throw Error.argumentNull("actionData is null");if(xc.SlideNode){if(xc=Object(fe.a)(32,xc.SlideNode))Ob.a.J(509654912,804,50,String.format("HandleMarkAsRead: Mark slide {0} as read",
xc.slideIndex+1)),this.ZTa.gWf?this.ZTa.Oqh(xc,!0):(xc.loa=ka,this.ZTa.zkk(xc))}else this.fSj(ka);return 32}fSj(ka){const ib=this.va.presentation;if(!ib)throw Error.argumentNull("Presentation is null");this.jf=Ae.a.Fk("MarkActivitiesAsRead",1);Ob.a.J(509654883,804,50,"MarkAllSlidesAsRead: User marks slides as read via Ribbon button");this.ZTa.gWf?this.ZTa.fSj():(qk.b(ib.slides||[],null,Rb=>{if(Rb=Object(fe.a)(32,Rb))Rb.loa=ka}),this.ZTa.yXl())}rXm(ka,ib,Rb,tc,xc){if(1===Rb)return this.Ub.hl()?32:
8;const hd=this.Ub.jn;ka=this.va.Ga;if(!(hd&&ka&&ka.isConnected&&xc))return 16;Rb=ib=!1;switch(xc.ShowRevisionTrackingStatus){case 0:Rb=ib=!1;break;case 2:ib=!0;Rb=!1;break;case 3:Rb=ib=!0;break;case 1:ib=hd.pac&&!this.ZTa.hgi?!0:!hd.pac;Rb=!0;break;default:return 8}if(this.ZTa.hgi&&!Rb)return 32;xc=xc.InvokeSource;hd.pac=ib;this.ZTa.hgi=ib&&Rb;Rb&&this.FHe.H$m(xc,ib);xc=ka.xj();qk.b(xc,null,Fd=>{this.zph.yCn(new of(Fd,hd.pac))});this.Ad.WH(new wg.a(1));return 32}$Wm(ka,ib,Rb,tc,xc){ka=this.Ub.jn;
if(!ka)return 16;xc.xg(ka.pac);return 32}sXm(ka,ib,Rb,tc,xc){ka=this.va.presentation;if(!xc||!ka||!ka.slides)return 8;xc=xc.timestamp;if(!xc)return 8;for(const hd of ka.slides)Object(fe.a)(32,hd).loa=xc;this.ZTa.Akk(ka.slides);return 32}}Object(m.a)(Yf,"RevisionTrackingActor",null,[743,24]);class If{constructor(ka){this.backgroundColor=this.foregroundColor=null;ka&&ka.isInHighContrastMode&&ka.highContrastColors?(this.foregroundColor=ka.highContrastColors.foregroundTextColor||"#006BFF",this.backgroundColor=
ka.highContrastColors.backgroundColor||"#006BFF"):this.backgroundColor=this.foregroundColor="#006BFF"}}Object(m.a)(If,"RevisionTrackingColorProvider",null,[]);class Jf{constructor(){this.ua=new Gg.a}zCn(ka){this.ua.raiseEvent("SlideUSC",ka)}Oye(ka){this.ua.addHandler("SlideUSC",ka)}Buh(ka){this.ua.removeHandler("SlideUSC",ka)}xCn(ka){this.ua.raiseEvent("ShapeUSC",ka)}Oqm(ka){this.ua.addHandler("ShapeUSC",ka)}wGn(ka){this.ua.removeHandler("ShapeUSC",ka)}yCn(ka){this.ua.raiseEvent("ShowHideSC",ka)}Qqm(ka){this.ua.addHandler("ShowHideSC",
ka)}xGn(ka){this.ua.removeHandler("ShowHideSC",ka)}}Object(m.a)(Jf,"RevisionTrackingEventSource",null,[1181,1182,1183]);class Th extends Sys.EventArgs{constructor(ka,ib){super();this.shape=ka;this.slide=ib}}Object(m.a)(Th,"ShapeUnreadStateChangedEventArgs",Sys.EventArgs,[]);class yh{constructor(){this.cid=this.sid=0}}Object(m.a)(yh,"Slide",null,[]);class yi{constructor(ka,ib){this.dt=this.mk=null;this.mk=Object.assign(new yh,{sid:ka.sid,cid:ka.cid});this.dt=ib}}Object(m.a)(yi,"SlideLastViewedVersion",
null,[]);class Xi{constructor(){this.v=0;this.lv=this.defLv=null;this.v=1}}Object(m.a)(Xi,"SlideLastViewedVersions",null,[]);class Fh extends Sys.EventArgs{constructor(ka){super();this.slide=ka}}Object(m.a)(Fh,"SlideUnreadStateChangedEventArgs",Sys.EventArgs,[]);class Gi{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb,Xb,nc,Nc,yd,Ud){this.JYd=this.vXd=null;this.GIl=!1;this.HGj=null;this.Aoh=0;this.FIc=this.dbg=null;this.VKj=[];this.jph=null;this.Jph=!1;this.rdc=null;this.p6i=this.o6i=this.hgi=!1;Ob.a.J(512262749,
804,50,"Start RevisionTrackingManager::RevisionTrackingManager()");this.LNj=ka;this.va=ib;this.Tb=Rb;this.nc=tc;this.Ub=xc;this.kd=hd;this.Zqg=Fd;this.od=Td;this.zi=na;this.zph=Fb;this.OLl=$a;this.Fb=nc;this.gfn=Xb.$Je;this.MJl=Xb.qDl;this.XLl=!0;this.gL=!1;this.YKc=new pf.a;this.od.Ztd(Object(K.a)(this,this.ZEa,"onSessionAccessTokenExpired"));u.AFrameworkApplication.DE&&this.od.Sye(Object(K.a)(this,this.fbb,"onWopiTokenRefreshed"));this.Fb.fg(()=>{this.o6i=!0;this.initialize();this.yXl();this.o6i=
!1});this.FHe=Nc;this.xb=yd;this.qen=Ud}get gWf(){return Ef.a("WriteSlideLastViewedVersionsOnRead")}dispose(){this.vXd&&(this.kd.b6a(Object(K.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.kd.CLe(Object(K.a)(this,this.$rb,"onShapeViewElementAdded")),this.Zqg.nuh(Object(K.a)(this,this.ube,"onMarkedUndo")),this.od.Vje(Object(K.a)(this,this.Xab,"onBeforeSessionEnd")),this.od.F8(Object(K.a)(this,this.JP,"onSessionClosed")),this.od.wka(Object(K.a)(this,this.Oq,"onSessionRehydrated")),
this.zi.xZl(Object(K.a)(this,this.DRl,"onSlideChangesDataChanged")),this.zi.oZl(Object(K.a)(this,this.ZQl,"onPresentationLastModifiedTimeReceived")),this.MJl&&this.OLl.Pq(Object(K.a)(this,this.uRl,"onShapePropertyChanged")),this.od.xuh(Object(K.a)(this,this.ZEa,"onSessionAccessTokenExpired")))}initialize(){Ob.a.J(512262748,804,50,"Start RevisionTrackingManager::Initialize()");this.HGj=new Date;this.Aoh=this.HGj.getTime();this.bLn();this.kd.Fea(Object(K.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));
this.kd.J4c(Object(K.a)(this,this.$rb,"onShapeViewElementAdded"));this.Zqg.Fye(Object(K.a)(this,this.ube,"onMarkedUndo"));this.od.i9a(Object(K.a)(this,this.Xab,"onBeforeSessionEnd"));this.od.sE(Object(K.a)(this,this.JP,"onSessionClosed"));this.od.VG(Object(K.a)(this,this.Oq,"onSessionRehydrated"));this.zi.wfl(Object(K.a)(this,this.DRl,"onSlideChangesDataChanged"));this.zi.lfl(Object(K.a)(this,this.ZQl,"onPresentationLastModifiedTimeReceived"));this.MJl&&this.OLl.Am(Object(K.a)(this,this.uRl,"onShapePropertyChanged"));
this.rdc=this.va.Ga;this.JYd=this.SNm();this.getSlideLastViewedVersions();const ka=new Wa.a(3,2,this.gfn,()=>{this.getSlideLastViewedVersions()},90,"12");this.Tb.Qb(ka)}onActiveSlideDomReady(ka,ib){ka=Object(fe.a)(32,ib.Ga);this.rdc&&ka!==this.rdc&&this.lFk()&&(this.rdc.isConnected&&(this.rdc.isUnread&&this.Oqh(this.rdc,!0),!this.gWf&&this.rdc.changesData&&(this.rdc.loa=this.rdc.changesData.dtField)),ka&&ka.isUnread&&this.FXl(ka));this.rdc=ka;this.Aoh=Date.now()}ube(ka,ib){ib.actionId!==X.a.Wja&&
ib.t9c&&(ka=this.va.Ga)&&ka.isConnected&&ka.isUnread&&this.lFk()&&this.Oqh(ka,!0)}Xab(){this.lFk()&&this.WWn();this.oAh()}JP(){this.FHe.log();this.gL=!0}Oq(){this.gL=!1;this.dbg&&this.n9l(this.dbg)}n9l(ka){var ib=this.va.presentation;if(!ib)throw Error.argumentNull("Presentation is null");ib=ib.slides||[];0<ib.length&&(this.vYn(ib,ka),this.Akk(ib))}xrn(ka){this.p6i=!0;Ob.a.J(512262747,804,50,"OnReceiveLastViewedVersionInfo()");ka&&(this.YKc=new pf.a,this.forEach(ka.lv,tc=>{const xc=tc.mk.sid;(!this.YKc.Ob(xc)||
this.YKc.ha(xc).dt<tc.dt)&&this.YKc.K(xc,tc)}));const ib=Ae.a.yDc;let Rb=!1;this.FIc&&this.LNj.bVd&&ib!==this.FIc&&(this.dbg&&ca.c(this.jtl())===ca.c(this.dbg)||(Rb=!0));ka&&ka.defLv&&(this.JYd=ka.defLv,this.XLl=!1,ka.lv&&0<ka.lv.length&&this.n9l(ka));Rb&&this.oAh();this.FIc=Ae.a.yDc;this.p6i=!1}DRl(ka,ib){this.forEach(ib.slides,Rb=>{this.vgj(Rb.changesData)||(this.va.Ga&&Rb.Xb!==this.va.Ga.Xb||this.vYm(Object(fe.a)(32,Rb)))&&this.zkk(Object(fe.a)(32,Rb))})}ZQl(ka,ib){this.XLl&&(this.JYd=ib.zVl)}uRl(ka,
ib){ka=ib.property;ib=Object(fe.a)(426,ib.node);ka===We.a.bec&&(ka=this.nc.Cg(ib),ka===this.va.Ga&&ka.isUnread&&ib.changesData.dtField<=ka.changesData.dtField&&(Ob.a.J(512262746,804,50,"Trying to highlight a shape in active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.Aoh),this.ykk(this.va.Ga,ib)))}$rb(ka,ib){ka=ib.cI.shapeNode;this.va.Ga.isUnread&&this.ACc(this.va.Ga.Xb,ka)&&!this.vgj(ka.changesData)&&(this.VKj.push(ka),this.jph||(this.jph=new Wa.a(2,1,0,Object(K.a)(this,
this.tryHighlightInsertedShapes,"tryHighlightInsertedShapes"),90,"13"),this.Tb.Qb(this.jph)))}getSlideLastViewedVersions(){this.gL||this.Jph||this.LNj.getSlideLastViewedVersionInfo(Object(K.a)(this,this.xrn,"onReceiveLastViewedVersionInfo"))}oAh(){if(!this.gL&&!this.Jph){var ka=this.jtl();this.LNj.putSlideLastViewedVersionInfo(ka);this.dbg=ka}}jtl(){const ka=this.va.presentation;if(!ka)throw Error.argumentNull("Presentation is null");const ib=Object.assign(new Xi,{defLv:this.JYd}),Rb=[];this.forEach(ka.slides||
[],tc=>{tc=tc.Xb;const xc=this.Ub.Wk(tc);xc&&xc.loa&&(!tc.cid&&this.YKc.Ob(tc.sid)?tc=Ec.a.Yq(tc.sid,this.YKc.ha(tc.sid).mk.cid):tc.cid&&this.YKc.Ob(tc.sid)&&tc.cid!==this.YKc.ha(tc.sid).mk.cid&&Ob.a.J(512262745,804,50,"The same sid {0} has different cid. Roaming cid:{1}, Slide node cid:{2}",tc.sid,this.YKc.ha(tc.sid),tc.cid),Rb.push(new yi(tc,xc.loa)))});ib.lv=Rb;return ib}vYn(ka,ib){const Rb=ib.lv;this.forEach(ka,tc=>{const xc=Object(fe.a)(32,tc);this.forEach(Rb,hd=>{xc&&this.Hsm(xc,hd.mk)&&(!xc.loa||
xc.loa<hd.dt)&&(xc.loa=hd.dt)})})}Hsm(ka,ib){return ka.cid&&ib.cid?ka.sid===ib.sid&&ka.cid===ib.cid:ka.sid===ib.sid}Akk(ka){this.forEach(ka,ib=>{this.zkk(Object(fe.a)(32,ib))})}yXl(){var ka=this.va.presentation;if(!ka)throw Error.argumentNull("Presentation is null");ka=ka.slides||[];0<ka.length&&this.Akk(ka)}FXl(ka){this.J$l(ka,ib=>{this.ykk(ka,ib)})}zkk(ka){if(ka&&ka.isConnected&&ka.changesData){const ib=this.lkh(ka.changesData,this.Ihh(ka));ib!==ka.isUnread&&(this.fNl(ka,ib),this.bWn(),ka===this.va.Ga&&
this.FXl(ka))}}ykk(ka,ib){if(ib&&ib.isConnected&&ib.Ra(We.a.bec)){const Rb=this.lkh(ib.changesData,this.Ihh(ka));this.eNl(ka,ib,Rb)}}eNl(ka,ib,Rb){Rb!==ib.isUnread&&(Ob.a.J(512262744,804,50,"Shape unread state changed: {0} -> {1}",ib.isUnread,Rb),ib.isUnread=Rb,this.zph.xCn(new Th(ib,ka)))}fNl(ka,ib){ib!==ka.isUnread&&(Ob.a.J(512262743,804,50,"Slide unread state changed: {0} -> {1}, SlideId={2}",ka.isUnread,ib,ka.Xb.toString()),ka.isUnread=ib,this.zph.zCn(new Fh(ka)))}Oqh(ka,ib){if(this.gWf){if(!ka)throw Error.argumentNull("ISlideNode is null");
this.uYn(ka);Ob.a.J(509654915,804,50,"MarkSlideAsRead - SlideId={0}, isUnread={1}, writeToRoaming={2}",ka.Xb.toString(),ka.isUnread,ib);if(!ka.isUnread)return!1}this.J$l(ka,Rb=>{this.eNl(ka,Rb,!1)});this.fNl(ka,!1);this.gWf&&ib&&this.oAh();return!0}fSj(){const ka=this.va.presentation;if(!ka)throw Error.argumentNull("Presentation is null");let ib=!1;this.forEach(ka.slides,Rb=>{Rb=this.Oqh(Object(fe.a)(32,Rb),!1);ib||(ib=Rb)});Ob.a.J(509654914,804,50,"MarkAllSlidesAsRead - requiresWriteToRoaming={0}",
ib);ib&&this.oAh()}J$l(ka,ib){ka&&(ka=ka.xj(),this.forEach(ka,Rb=>{ib(Rb)}))}forEach(ka,ib){qk.b(ka,null,ib)}vgj(ka){return Hi(ka,this.vXd)}lkh(ka,ib){return!!ka&&!!ka.dtField&&!this.vgj(ka)&&ka.dtField>ib}SNm(){const ka=this.Ub.jn;if(ka&&ka.hFg)return ka.hFg;Ob.a.J(512262742,808,50,"GetDefaultLastViewedTime - No PresLastModifiedTime");return new Date}Y3m(ka){const ib=Object(fe.a)(32,this.qen.hih(ka));return ib&&ib.isUnread&&ka&&this.lkh(ka.changesData,this.Ihh(ib))}bLn(){this.vXd=new Hk(this.Fb.La("UserName"),
this.Fb.La(Dc.a.lPa),this.Fb.La(Dc.a.L2b))}uYn(ka){ka.loa=ka&&ka.changesData?ka.changesData.dtField:this.JYd}WWn(){const ka=this.va.Ga;ka&&(ka.loa=ka.changesData?ka.changesData.dtField:this.JYd)}Ihh(ka){return ka.loa||this.JYd}bWn(){this.GIl||(this.GIl=!0,Ob.a.J(512262741,804,50,"First revision tracking view render completed!"))}vYm(ka){return ka.isConnected&&ka.changesData&&ka.changesData.dtField?ka.changesData.dtField<=this.HGj&&this.lkh(ka.changesData,this.Ihh(ka)):!1}ACc(ka,ib){return ka.equals(ib.slideId)}tryHighlightInsertedShapes(){Ob.a.J(512262740,
804,50,"Trying to highlight inserted shapes on active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.Aoh);this.jph=null;const ka=this.va.Ga;if(ka&&ka.isUnread){const ib=ka.Xb;for(const Rb of this.VKj)this.ACc(ib,Rb)&&this.ykk(ka,Rb)}Array.clear(this.VKj)}ZEa(){this.Jph=!0}fbb(ka,ib){try{ib.FVf?(Ob.a.J(512262739,804,50,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh succeeded."),this.Jph=!1):Ob.a.J(512262738,804,15,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh failed.")}catch(Rb){Ob.a.J(512262737,
804,10,"RevisionTrackingManager::OnWopiTokenRefreshed Exception: {0}",Rb)}}lFk(){return 1!==this.xb.Ri}}Object(m.a)(Gi,"RevisionTrackingManager",null,[]);class Bj{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb){this.va=ka;this.Ub=ib;this.JNj=Rb;this.kd=tc;this.lpa=xc;this.Ia=hd;this.pCj=Fd;this.jbd=Td;this.xe=na;this.vBb=$a;this.Ccn=Fb;this.QKl=!1;this.kd.SJb(Object(K.a)(this,this.nSl,"onVisibleThumbnailRangeChanged"));this.kd.Daf(Object(K.a)(this,this.dbb,"onThumbnailRefresh"));this.kd.sfl(Object(K.a)(this,
this.tRl,"onShapePresenceStateChanged"));this.kd.Bfl(Object(K.a)(this,this.VRl,"onThumbnailPresenceStateChanged"));this.kd.$el(Object(K.a)(this,this.hsn,"onShapeViewElementShowRevisionTrackingHint"));this.kd.Xel(Object(K.a)(this,this.bsn,"onShapeViewElementHideRevisionTrackingHint"));this.lpa.Oye(Object(K.a)(this,this.bsb,"onSlideUnreadStateChanged"));this.lpa.Oqm(Object(K.a)(this,this.zRl,"onShapeUnreadStateChanged"));this.lpa.Qqm(Object(K.a)(this,this.BRl,"onShowHideStateChanged"))}dispose(){this.kd.Cuh(Object(K.a)(this,
this.nSl,"onVisibleThumbnailRangeChanged"));this.kd.FLe(Object(K.a)(this,this.dbb,"onThumbnailRefresh"));this.kd.uZl(Object(K.a)(this,this.tRl,"onShapePresenceStateChanged"));this.kd.AZl(Object(K.a)(this,this.VRl,"onThumbnailPresenceStateChanged"));this.lpa.Buh(Object(K.a)(this,this.bsb,"onSlideUnreadStateChanged"));this.lpa.wGn(Object(K.a)(this,this.zRl,"onShapeUnreadStateChanged"));this.lpa.xGn(Object(K.a)(this,this.BRl,"onShowHideStateChanged"))}nSl(){const ka=this.va.presentation;if(!ka)throw Error.argumentNull("Presentation is null");
qk.b(ka.slides||[],null,ib=>{(ib=this.Ub.Wk(ib.Xb))&&ib.isUnread&&this.lJk(ib)})}dbb(ka,ib){ka=this.Ub.Wk(ib.RQk);ka.isUnread&&this.lJk(ka)}bsb(ka,ib){ka=ib.slide;ka.isUnread?this.lJk(ka):this.OFn(ka)}zRl(ka,ib){ka=ib.shape;ib=ib.slide;ka&&(ka.isUnread?ib===this.va.Ga&&this.dJk(ka):this.Rnk(ka))}tRl(ka,ib){ka=ib.shape;ka.xF?this.Rnk(ka):ka.isUnread&&this.dJk(ka,!0)}VRl(ka,ib){ka=ib.slide;ka.xF&&!this.t4l?this.RFn(ka):ka.isUnread&&this.HQn(ka)}BRl(ka,ib){ka=ib.shape;ib.pac&&ka.isUnread?this.dJk(ka):
this.Rnk(ka)}get t4l(){return this.Ccn}lJk(ka){ka&&ka.isConnected&&this.Lzh(ka,()=>{})}OFn(ka){ka&&ka.isConnected&&this.Lzh(ka,()=>{})}HQn(ka){ka.xF&&!this.t4l||this.Lzh(ka,Object(K.a)(this,this.gpm,"addRevisionTrackingPawnForThumbnail"))}RFn(ka){this.Lzh(ka,()=>{})}u4l(){const ka=this.Ub.jn;return!this.vBb||this.vBb&&ka.pac}dJk(ka,ib=!1){this.u4l()&&!ka.xF&&ka.Ra(We.a.bec)&&(Object(fe.a)(284,ka.tc(this.xe))?(this.JNj.w$(ka).display(()=>this.Ia.s8c(ka)),this.UVn(),Ob.a.J(507843140,804,50,"ShowShapeRevisionTrackingView(), IsTriggeredByPresenceUpdate={0}",
ib)):Ob.a.J(507843139,804,50,"ShowShapeRevisionTrackingView() failed, no shape view element created"))}Rnk(ka){const ib=this.JNj.k5(ka);ib?ib.dismiss():this.u4l()&&ka.isUnread&&Ob.a.J(507843138,804,50,"RemoveShapeRevisionTrackingView() failed, a revision tracking view is expected but not found")}Lzh(ka,ib){ka&&((ka=Object(fe.a)(974,ka.Qg(this.jbd)))?ib(ka):Ob.a.J(507843137,804,50,"UpdateThumbnailRevisionTrackingView() failed, no thumbnail view element found"))}gpm(){}hsn(ka,ib){this.a$l(ib.cI.shapeNode,
!0)}bsn(ka,ib){this.a$l(ib.cI.shapeNode,!1)}a$l(ka,ib){(ka=this.JNj.k5(ka))&&(ib?ka.Toe():ka.pRb())}UVn(){this.QKl||(this.QKl=!0,nb.c(ba.a.Gwm))}}Object(m.a)(Bj,"RevisionTrackingPresenter",null,[]);class ck{Iml(){const ka=new ae.a;ka.mh(10,10);ka.AUa("0 0 10 10");ka.ta.setAttribute("class","ModernRevisionTrackingIconSVG");const ib=new Zh.a;ib.Bka("M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0");ib.ta.setAttribute("class","ModernRevisionTrackingIconPath");ka.appendChild(ib);return ka.ta}}Object(m.a)(ck,"RevisionTrackingSVGProvider",
null,[1147]);class Ph{constructor(){this.Bph=this.mqh=this.lqh=this.fKj=0}aan(){this.mqh+=1}H$m(ka,ib){switch(ka){case 2:ib&&(this.lqh+=1);break;case 0:ib?(this.Bph+=1,Ob.a.J(39068549,804,50,"HandleShowHideChanges: User enables detailed highlight via Ribbon button")):Ob.a.J(39068551,804,50,"HandleShowHideChanges: User disables detailed highlight via Ribbon button");break;case 1:ib&&(this.fKj+=1)}}log(){Ob.a.J(39068553,804,15,"WYWA Notification Clicks:{0}; Thumbnail Revision Tracking Pawn Clicks: {1}; Thumbnail Revision Tracking Pawn Hovers: {2}; Show Hide Changes Ribbon Clicks:{3};",
this.fKj,this.lqh,this.mqh,this.Bph);0<this.lqh+this.mqh+this.Bph&&nb.c(ba.a.Oci)}}Object(m.a)(Ph,"RevisionTrackingTelemetry",null,[]);var qj=a(1536),Ik=a(1640),kk=a(135),cj=a(849);class Bk{constructor(ka,ib,Rb,tc,xc){this.sXd=null;this.Rad=ka;this.FHe=ib;this.zc=xc;this.$b=Rb;this.pa=tc;this.Rad.nSa(Object(K.a)(this,this.iia,"onInteractivityChanged"))}dispose(){this.Rad&&this.Rad.dispose();this.sXd=this.Rad=null}display(ka,ib){this.sXd||(this.sXd=new cj.a);this.sXd.color=ka;this.sXd.userName=ib;
this.Rad.h0(this.sXd)}dismiss(){this.Rad.Bqa(this.sXd.clientId)}Toe(){this.Rad.Cec()}pRb(){this.Rad.rDb()}iia(ka,ib){ka={InvokeSource:2,ShowRevisionTrackingStatus:null};1===ib.type?(this.$b.Ga!==this.zc?(this.zc&&(this.$b.Ga=this.zc,this.pa.Rw()),ka.ShowRevisionTrackingStatus=3):ka.ShowRevisionTrackingStatus=1,u.AFrameworkApplication.vb.Qa(Pb.a.qDb,2,ka)):2===ib.type?this.zc&&this.$b.Ga===this.zc&&(ka.ShowRevisionTrackingStatus=2,u.AFrameworkApplication.vb.Qa(Pb.a.qDb,2,ka),this.FHe.aan()):3===ib.type&&
this.zc&&this.$b.Ga===this.zc&&(ka.ShowRevisionTrackingStatus=0,u.AFrameworkApplication.vb.Qa(Pb.a.qDb,2,ka))}}Object(m.a)(Bk,"ThumbnailRevisionTrackingPawn",null,[1201,24]);a(512);class ul{constructor(ka,ib,Rb,tc,xc,hd){this.Qi=ka;ka=kk.e("pegal","UnreadNotification_16x16x32");ib=ib.Yp("pegal.png");Rb=Rb.Iml();this.ECm(u.AFrameworkApplication.isRtl,ka,ib,Rb);this.FHe=tc;this.$b=xc;this.pa=hd}Uc(ka){return this.Qi.Uc(ka)}ECm(ka,ib,Rb,tc){const xc=new qj.a;xc.add(1,ib);xc.add(4,Rb);xc.add(6,16);xc.add(8,
ka);xc.add(12,2);xc.add(11,!1);xc.add(14,tc);new Ik.a(xc)}}Object(m.a)(ul,"RevisionTrackingThumbnailGadgetsFactory",null,[1146]);class Ug{constructor(ka,ib,Rb){this.oS=this.AH=!0;this.$p=ka;this.Ooa=ib;this.la=Rb}get bVd(){return this.AH}getSlideLastViewedVersionInfo(ka){if(this.oS){Ob.a.J(507843075,824,50,"GetSlideLastViewedVersionInfo(), Start sending read request to FE at [{0}]",JSON.stringify(new Date));var ib=this.la.dZ+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPPTSlideLastViewedMetadata",
u.AFrameworkApplication.ui),Rb={};Rb["X-StatelessPopsAffinityRoutingEnabled"]=this.la.oba.toString();this.$p.rk(ib,1,null,Rb,!1,2,Object(K.a)(this,this.eqn,"onGetVersionInfoSucceeded"),Object(K.a)(this,this.dqn,"onGetVersionInfoFailed"),ka,void 0,void 0,void 0,void 0,ad.a("12"));this.oS=!1}else Ob.a.J(507843076,824,50,"Response of previous get roaming request is not back yet.")}putSlideLastViewedVersionInfo(ka){if(this.AH){Ob.a.J(507843073,824,50,"PutSlideLastViewedVersionInfo(), Start sending write request to FE");
var ib=ca.c(ka),Rb=this.la.uKe;if(ib.length>Rb)Ob.a.J(507843072,824,50,"Roaming data size is bigger than the limitation, won't write to roaming service, slideNum={0}, dataSize={1}, sizeLimitation={2}",ka.lv.length,ib.length,Rb);else{Rb=this.la.dZ+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePPTSlideLastViewedMetadata",u.AFrameworkApplication.ui);if(u.AFrameworkApplication.ga.getBooleanAppSetting("SendBeaconOnRoamingRequestsIsEnabled"))this.$p.lda(Rb,ib);else{const tc={};tc["X-StatelessPopsAffinityRoutingEnabled"]=
this.la.oba.toString();this.$p.rk(Rb,2,ib,tc,!1,2,Object(K.a)(this,this.srn,"onPutVersionInfoSucceeded"),Object(K.a)(this,this.rrn,"onPutVersionInfoFailed"),ka.lv.length,void 0,void 0,void 0,void 0,ad.a("13"))}this.AH=!1}}else Ob.a.J(507843074,824,50,"Response of previous write roaming request is not back yet.")}dispose(){}eqn(ka){this.oS=!0;let ib=0;try{let Rb=null;ka.data.responseData&&0<ka.data.responseData.trim().length&&(ib=ka.data.responseData.length,Rb=JSON.parse(ka.data.responseData,Object(K.a)(this,
this.L7m,"jsonDateReviver")));const tc=ka.data.state;tc(Rb)}catch(Rb){Ob.a.J(507843043,824,10,"OnGetVersionInfoSucceeded catched exception: {0}",Rb.toString())}ka=String.format("OnGetVersionInfoSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",ib,JSON.stringify(ka.data.WC),JSON.stringify(ka.data.qq),JSON.stringify(ka.data.zr));Ob.a.J(507843042,824,50,ka)}dqn(ka){this.oS=!0;ka=this.Ooa.LV(ka);Ob.a.J(507843041,824,50,"OnGetVersionInfoFailed: Web service failed with {0}",
ka)}srn(ka){this.AH=!0;Ob.a.J(507843040,824,50,"OnPutVersionInfoSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+ka.data.zr-+ka.data.WC,+ka.data.qq-+ka.data.WC)}rrn(ka){this.AH=!0;const ib=this.Ooa.LV(ka);Ob.a.J(507843039,824,50,"OnPutVersionInfoFailed: Web service failed with {0}, NumSlides={1}",ib,ka.data.state)}L7m(ka,ib){return"dt"===ka||"defLv"===ka?new Date(ib):ib}}Object(m.a)(Ug,"RoamingCacheProxy",null,[1145,24]);var cl=a(1347);class Vk{constructor(ka,ib,Rb){this.Yo=ka;this.Aph=Object(fe.a)(cl.a,
this.Yo.B3l);this.pCj=ib;this.Een=Rb;this.Yo.LCl=!0}display(ka){let ib;ib=this.Een.Iml();this.Aph.$dl(this.pCj.backgroundColor,ka,ib);this.Yo.QOe(this.pCj.foregroundColor);this.Yo.setVisibility()}dismiss(){this.Aph.clear();this.Yo.QOe(ai.a.none);this.Yo.setVisibility()}xq(ka){this.Yo.xq(ka)}KR(ka){this.Yo.KR(ka)}Qt(){return this.Yo.Qt()}YZ(ka){return this.Yo.sSb(ka)}hD(ka){this.Yo.hD(ka)}dispose(){this.Yo.dispose()}hG(){this.Yo.hG()}vP(ka){return this.Yo.vP(ka)}iL(ka){return this.Yo.iL(ka)}draw(ka,
ib){this.Yo.draw(ka,ib)}get visible(){return this.Yo.visible}set visible(ka){this.Yo.visible=ka}setPosition(ka,ib){this.Yo.setPosition(ka,ib)}Yi(ka){this.Yo.Yi(ka)}Vu(ka){this.Yo.Vu(ka)}Kz(ka){this.Yo.Kz(ka)}setZIndex(ka){this.Yo.setZIndex(ka)}LP(ka,ib){this.Yo.LP(ka,ib)}Toe(){this.Aph.Toe()}pRb(){this.Aph.pRb()}setSelection(){}}Object(m.a)(Vk,"ShapeRevisionTrackingView",null,[1177,760,301,24]);class Ni{constructor(){this.$=null;this.vBb=this.MHc=this.Tca=this.yab=!1}get name(){return"PowerPointWebEditor.RevisionTracking"}init(){}lc(ka){this.$=
ka;ka.resolve("Common.IAppSettingsManager").fg(()=>{this.Tca=ka.resolve("PowerPointWebEditor.IApplicationContext").Md.Rh;this.MHc=ka.resolve("PowerPointWebEditor.IApplicationContext").Md.aDl;this.yab=ka.resolve("PowerPointWebEditor.IApplicationContext").Md.llh;this.vBb=ka.resolve("PowerPointWebEditor.IApplicationContext").Md.tTf;this.register();this.resolve()})}dispose(){this.yab&&(this.$.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").dispose(),this.$.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").dispose(),
this.$.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").dispose())}register(){const ka=this.$;this.Tca&&this.MHc&&ka.register(ke.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>new ke.a(u.AFrameworkApplication.ye,ka.resolve("PowerPointWebEditor.ISessionInfoOwner"),ka.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),ka.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),ka.resolve("PowerPointWebEditor.IErrorHandler"),ka.resolve("Common.ITaskManager"),ka.resolve("Common.IAppSettingsManager")));
this.yab&&(ka.register(Ph,"RevisionTrackingTelemetry").ma().na(()=>new Ph),ka.register(Gi,"PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").ma().na(()=>new Gi(ka.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy"),ka.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ka.resolve("Common.ITaskManager"),ka.resolve("PowerPointWebEditor.ISlideReader"),ka.resolve("PowerPointWebEditor.IPresentationReader"),ka.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
ka.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),ka.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),ka.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),ka.resolve("Box4.Graph.IGraphInstance").Sd(10),ka.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource"),ka.resolve("PowerPointWebEditor.IApplicationSettings"),ka.resolve("Common.IAppSettingsManager"),ka.resolve("RevisionTrackingTelemetry"),ka.resolve("PowerPointWebEditor.View.IPPTPageView"),
ka.resolve("PowerPointWebEditor.Graph.SlideNodeHelper"))),ka.register(Bj,"PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").ma().na(()=>new Bj(ka.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ka.resolve("PowerPointWebEditor.IPresentationReader"),ka.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>"),ka.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),ka.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),
ka.resolve("PowerPointWebEditor.IShapeReader"),ka.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),ka.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Oa,ka.resolve("Box4.IPageView").Oa,ka.resolve("PowerPointWebEditor.IApplicationSettings").tTf,ka.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Fi.a.itb))),ka.register(1145,"PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").ma().na(()=>new Ug(u.AFrameworkApplication.ye,ka.resolve("PowerPointWebEditor.IJsonpHelperManager"),
ka.resolve("PowerPointWebEditor.IApplicationSettings"))),ka.register(1146,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory").ma().na(()=>new ul(ka.resolve("PowerPoint.IBrowserHelperManager"),ka.resolve("PowerPoint.IPathManager"),ka.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider"),ka.resolve("RevisionTrackingTelemetry"),ka.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),ka.resolve("PowerPointWebEditor.IPptSelectionManager"))),ka.register(Jf,
"PowerPointWebEditor.RevisionTracking.RevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers").ma().na(()=>new Jf),ka.register(738,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>").ma().na(()=>new qg.a((ib,Rb)=>{let tc=null;const xc=Object(fe.a)(284,
ib.tc(ka.resolve("Box4.IPageView").Oa));xc&&!xc.isDisposed&&(ib=ka.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").Zpi(ka.resolve("PowerPointWebEditor.IPptSelectionManager"),(hd,Fd,Td)=>ka.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").WBm(hd,Fd,Td,ka.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),ib,Rb,xc.Jqa,ka.resolve("PowerPointWebEditor.IZoomContext"),ka.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),ka.resolve("PowerPointWebEditor.IApplicationSettings")),
tc=new Vk(ib,ka.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),ka.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider")),tc.xq(xc.Jqa),xc.hzb(tc,1),tc.visible=xc.TK||xc.Ho);return tc})),ka.register(If,"PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider").ma().na(()=>new If(ka.resolve("Common.Utils.IHighContrastDetector"))),ka.register(1147,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider").ma().na(()=>new ck),
this.Tca&&this.vBb&&ka.register(Yf,"PowerPointWebEditor.RevisionTracking.RevisionTrackingActor").ma().na(()=>new Yf(ka.resolve("Common.IActionManagerExtended"),ka.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ka.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),ka.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier"),ka.resolve("PowerPointWebEditor.IPresentationReader"),ka.resolve("PowerPointWebEditor.View.IViewEventSource"),ka.resolve("RevisionTrackingTelemetry"))))}resolve(){this.Tca&&
this.MHc&&this.$.resolve("PowerPointWebEditor.PodsInfoSender");if(this.yab&&(this.$.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter"),this.$.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.$.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory"),this.vBb)){const ka=this.$.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingActor");ka.Hb();ka.ve()}}static main(){L.a.instance.Fc(jb.a(new Ni,0))}}Object(m.a)(Ni,
"PPTWebEditorRevisionTrackingPackage",null,[3,4]);var Pi=a(524),Gj=a(387),vk=a(329);class Qi{constructor(ka){this.gfb=[X.a.YNe,X.a.ZNe,X.a.$Ne,X.a.aOe,X.a.bOe];this.S5k=ka}hhh(ka){return this.S5k?this.S5k.ghh(ka.Xa):null}create(ka){return ka?(ka=this.crc(ka))?vk.m(ka):"":""}JAm(ka){ka=ka.suggestions;if(!ka||!ka.count)return null;ka=({Fnl:ib}=this.ACm(ka)).returnValue;var ib=Qi.fBm(ib);const Rb=Object.assign(new Pi.a,{ExternalId:"DictationCorrectionMenu",Command:"798637440",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsFlyoutTitle,
Image16by16Class:kk.e(u.AFrameworkApplication.iS,Qi.EEm),Image16by16:u.AFrameworkApplication.jp,Menu:Object.assign(new Ld.a,{ExternalId:"DictationCorrectionSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,MenuSectionList:[]})});ka&&Array.add(Rb.Menu.MenuSectionList,ka);Array.add(Rb.Menu.MenuSectionList,ib);return Rb}ACm(ka){let ib;const Rb=Object.assign(new eg.a,{Id:"DictationCorrectionSuggestions",ControlList:[],ControlsId:"DictationCorrectionSuggestionsControls",Title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle});
ib=null;for(let tc=0,xc=Math.min(this.gfb.length,ka.count);tc<xc;++tc){if(!ib&&""===ka.ha(tc).suggestion){ib=this.gfb[tc].toString();continue}const hd=Object.assign(new Gj.a,{ExternalId:"btnDictationCorrectionSuggestion"+tc,Command:this.gfb[tc].toString(),LabelText:ka.ha(tc).suggestion});Array.add(Rb.ControlList,hd)}return Rb.ControlList.length?{returnValue:Rb,Fnl:ib}:{returnValue:null,Fnl:ib}}crc(ka){if(ka=this.JAm(ka)){const ib=Object.assign(new eg.a,{Id:"DictationCorrectionSection",ControlList:[],
ControlsId:"DictationCorrectionSection"});Array.add(ib.ControlList,ka);return ib}return null}static fBm(ka){const ib=Object.assign(new eg.a,{Id:"DictationCorrectionIgnoreSuggestionSection",ControlList:[],ControlsId:"DictationCorrectionIgnoreSuggestionSectionControls"}),Rb=Object.assign(new Gj.a,{ExternalId:"btnIgnoreDictationCorrectionSuggestion",Command:"421768503",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsIgnoreSuggetion});Array.add(ib.ControlList,Rb);ka&&(ka=Object.assign(new Gj.a,{ExternalId:"btnDeleteDictationCorrectionSuggestion",
Command:ka,LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsDeleteSuggetion}),Array.add(ib.ControlList,ka));return ib}}Qi.EEm="Insertaudio_16x16x32";Object(m.a)(Qi,"DictationCorrectionContextMenuManager",null,[1171]);var Hj=a(594);class mj{constructor(ka,ib){this.U7g=null;this.Vr=ka;this.fla=ib}get key(){return"DICTATIONCORRECTION"}get Eja(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle}reset(ka){this.Vr.me(ka.node)?this.U7g=ka.node:this.U7g=null}e0c(ka){let ib;ib=null;if(!this.U7g)return{returnValue:!1,
EXa:ib};ka=this.fla.gOm(this.U7g,ka);if(!ka)return{returnValue:!1,EXa:ib};ib=Object.assign(new Hj.a,{fda:this.key,dS:ka,description:this.tBf()});return{returnValue:!0,EXa:ib}}tBf(){return u.AFrameworkApplication.ga&&u.AFrameworkApplication.ga.getBooleanAppSetting("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}}Object(m.a)(mj,"DictationCorrectionDetailsProvider",null,[1196,784]);var Xj=a(857),$h=a(43);class tf{constructor(ka,ib,Rb=-1){this.TriggerType=
"click";this.TreatedInUX="true";this.PhraseId=ka.dvn;this.CorrectionId=ka.id;switch(ib){case 0:this.EditType="alternate";this.AlternateId=Rb;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:n.ULS.sendTraceTag(51246608,394,10,"Invalid CorrectionEditType value")}}}Object(m.a)(tf,"CorrectionEvent",null,[]);class yj{constructor(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=null}}Object(m.a)(yj,"CorrectionTelemetry",
null,[]);class vj{constructor(){this.Id="Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}}Object(m.a)(vj,"CorrectionsSessionTelemetry",null,[]);class jl{constructor(){this.uja=!1;this.DDh=this.SMh=0}start(){this.uja||(this.uja=!0,this.SMh=this.getTime())}stop(){this.uja&&(this.DDh+=this.getTime()-this.SMh,this.uja=!1)}get nv(){return this.DDh+(this.uja?this.getTime()-this.SMh:0)}getTime(){return(new Date).getTime()}}Object(m.a)(jl,"DictationCorrectionsSessionTimer",
null,[]);class ri{constructor(){this.StartTime="";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}}Object(m.a)(ri,"SessionInfo",null,[]);class Wk{constructor(){this.FinalText="";this.PhraseIds=null}}Object(m.a)(Wk,"TextInfo",null,[]);var kl=a(84);class tj{constructor(ka){this.s$k=this.MOh=this.NOh=0;this.Sem="Office.Voice.Online.DictationCorrectionsSession";this.Gqd=null;this.Pxe=Object.assign(new ri,{TextInfo:[new Wk]});this.a7k=ka}startSession(){this.Gqd||(this.Pxe.StartTime=
(new Date).toISOString(),this.Gqd=new jl);this.Gqd.start()}pauseSession(){this.Gqd.stop()}endSession(){this.Gqd.stop();var ka=new kl.a;ka.name=this.Sem;ka.samplingPolicy=2;ka.durationMs=this.Gqd.nv;ka.dataFields=[];Array.add(ka.dataFields,Object.assign(new se.a,{name:"CorrectionSessionId",string:this.jec}));Array.add(ka.dataFields,Object.assign(new se.a,{name:"StartTime",string:this.Pxe.StartTime}));Array.add(ka.dataFields,Object.assign(new se.a,{name:"NumberOfCorrectionsMarked",int64:this.NOh}));
Array.add(ka.dataFields,Object.assign(new se.a,{name:"NumberOfCorrectionsMade",int64:this.MOh}));Array.add(ka.dataFields,Object.assign(new se.a,{name:"NumberOfCorrectionsDismissed",int64:this.s$k}));$h.a.sendActivityEvent(ka);if(Rc.App.hJa&&0<Rc.App.hJa.ITl.length){this.Pxe.AlternateEditCount=this.MOh;this.Pxe.Duration=Math.floor(this.Gqd.nv/1E3);this.Pxe.TextInfo[0].PhraseIds=Rc.App.hJa.ITl;var ib=new vj;ib.ClientSessionId=this.jec;ib.SessionInfo=this.Pxe;if(ka=this.a7k())ib=ca.c(ib),ka.tFl(ib)}}lpn(ka){this.NOh+=
ka}KPl(ka,ib,Rb=-1){0===ib?this.MOh++:1===ib&&this.s$k++;var tc=new yj;tc.ClientSessionId=this.jec;tc.CorrectionEvents=[new tf(ka,ib,Rb)];if(ka=this.a7k())tc=ca.c(tc),ka.tFl(tc)}get jec(){return Rc.App.hJa?Rc.App.hJa.jec:""}}Object(m.a)(tj,"DictationCorrectionsTelemetry",null,[]);var Mk=a(261),hj=a(259);class ll{constructor(ka,ib,Rb){this.psa=ka;this.Ib=ib;this.Gja=Rb}}Object(m.a)(ll,"DictationCorrectionRange",null,[]);var ml=a(543);class Cj{constructor(ka,ib,Rb){this.vHa=this.OM=null;this.jpn=(tc,
xc)=>{this.P7g.uFn(xc.Pll)};this.ipn=(tc,xc)=>{this.T9g.add(xc.Ztn);this.OM&&this.OM.lpn(xc.Lfn);this.P7g.dom(xc.Pll)};this.swe=ka;this.tgc=ib;this.T9g=new ml.a(new Xj.a);this.P7g=Rb;this.z4b()}Yjh(ka){this.tgc.qsc&&Me.ParagraphReader.me(ka)&&this.T9g.contains(ka.id)&&this.swe.Yjh(ka)}cSn(){this.tgc.qsc=!0;this.OM=new tj(()=>this.vHa);this.OM.startSession()}ASn(){this.tgc.qsc=!1;var ka=Rc.App.Vb.Pd.An.Zg;if(ka){ka=ka.Ch;for(const ib of this.T9g){const Rb=ka.we(ib);Rb&&Me.ParagraphReader.me(Rb)&&this.swe.Exm(Rb)}}this.P7g.clear();
this.T9g.clear();this.OM.endSession()}E_l(ka){if(this.tgc.qsc){var ib=ka.oa(hj.a.Beh,null);if(!Oi.a.rb(ib)){var Rb=new N.a,tc=Math.min(ib.length,ka.Za.length);for(let xc=0;xc<tc;xc++){const hd=this.P7g.pNm(ib[xc]);if(hd){const Fd=ka.Za.ha(xc).cp;Rb.add(new ll(Fd,Fd+hd.source.length,hd))}}this.swe.Bfn(ka,Rb)}}}UOe(ka,ib){if(!ib)return!1;if(!this.tgc.qsc||!ka)return ib.add(null),!1;ib.add(ka.rC?ka.rC.Gja.key:null);return!!ka.rC}N0l(ka,ib){this.tgc.qsc&&ib&&w.AT(ib,Rb=>!!Rb)?ka.ie(hj.a.Beh,ib.toArray()):
ka.removeProperty(hj.a.Beh)}UXl(ka){this.vHa=ka}z4b(){this.swe.Tpm(this.ipn);ld.a.addHandler(window.self,Pa.a.blur,()=>{this.OM&&this.tgc.qsc&&this.OM.pauseSession()});ld.a.addHandler(window.self,Pa.a.focus,()=>{this.OM&&this.tgc.qsc&&this.OM.startSession()});this.swe.Upm(this.jpn)}hpn(ka,ib){this.OM&&this.OM.KPl(ka,0,ib)}kpn(ka){this.OM&&this.OM.KPl(ka,1)}gOm(ka,ib){if(!this.tgc.qsc)return null;ka=jc.a.yj(ka,ib);return this.swe.ghh(ka)}}Object(m.a)(Cj,"DictationCorrectionManager",null,[1170]);var dj=
a(233);class Rg extends Sys.EventArgs{constructor(ka,ib){super();this.Ztn=ka;this.Lfn=ib?ib.count:0;this.Pll=ib}}Object(m.a)(Rg,"DictationCorrectionMarkerEventArgs",Sys.EventArgs,[]);class Ri{constructor(ka,ib,Rb,tc,xc){this.Dkm=ka;this._id=ib;this.ugm=tc;this.klc=xc;this.jC=Rb;this.W8a=String.format("{0}_{1}",ka,ib)}get dvn(){return this.Dkm}get id(){return this._id}get source(){return this.jC}get confidence(){return this.ugm}get suggestions(){return this.klc}get key(){return this.W8a}lgn(ka){this.suggestions.addRange(ka.suggestions)}}
Object(m.a)(Ri,"DictationCorrectionDetails",null,[]);class Yi{constructor(ka,ib,Rb){this.mo=ka;this.Ggm=ib;this.jkm=Rb}get Gja(){return this.Ggm}get D_j(){return this.jkm}get Pe(){return this.mo}Nd(ka){return new Yi(ka||this.Pe,this.Gja,this.D_j)}}Object(m.a)(Yi,"DictationCorrectionObject",null,[157]);class ma{constructor(ka,ib){this.source=ka;this.suggestion=ib}}Object(m.a)(ma,"DictationCorrectionSuggestion",null,[]);class Sa{constructor(ka){this.SWm=(ib,Rb)=>{const tc=Rb.Pe;for(var xc=ib.Za.mAb(tc.cp)+
1;xc<ib.Za.length;xc++){const hd=ib.Za.ha(xc);if(hd.isDictationCorrectionEnd){let Fd;this.PJg(ib,(Fd=new N.a,Fd.add(new ll(tc.cp,hd.cp,Rb.Gja)),Fd));break}}};this.Jh=ka;this.kb=new Gg.a}Tpm(ka){this.kb.addHandler("ADCM",ka)}Upm(ka){this.kb.addHandler("RDCM",ka)}Bfn(ka,ib){this.Gfn(ka,ib)}Gfn(ka,ib){if(ka&&ib&&ib.count&&(ib=Sa.d_n(ka,ib))&&ib.count){this.Hxm(ka,ib);var Rb=new N.a;for(var tc of ib)Rb.add(tc.psa),Rb.add(tc.Ib);ka.xBe(Rb);for(const xc of ib)tc=ka.Za.zX(xc.psa),tc.rC=new Yi(tc,xc.Gja,
this.SWm),tc.isFromErrorRangeSplit=!0,tc=ka.Za.zX(xc.Ib),tc.isDictationCorrectionEnd=!0,tc.isFromErrorRangeSplit=!0;0<ib.count&&this.kb.raiseEvent("ADCM",new Rg(ka.id,ib))}}vul(ka){const ib=new N.a;if(ka){let Rb=null,tc=-1;for(let xc=0;xc<ka.Za.length;xc++){const hd=ka.Za.ha(xc);hd.rC?(tc=hd.cp,Rb=hd.rC.Gja):hd.isDictationCorrectionEnd&&(Rb?ib.add(new ll(tc,hd.cp,Rb)):n.ULS.sendTraceTag(593285261,394,10,"Correction range end with no start."),Rb=null)}}return ib}PJg(ka,ib){if(ka&&ib&&ib.count){for(const Rb of ib){let tc=
ka.Za.zX(Rb.psa);tc&&(tc.rC=null);if(tc=ka.Za.zX(Rb.Ib))tc.isDictationCorrectionEnd=!1}this.kb.raiseEvent("RDCM",new Rg(ka.id,ib))}}Exm(ka){if(ka)for(let ib=0;ib<ka.Za.length;ib++){const Rb=ka.Za.ha(ib);Rb.rC&&(Rb.rC=null);Rb.isDictationCorrectionEnd&&(Rb.isDictationCorrectionEnd=!1)}}ghh(ka){if(!ka||!Mk.SelectionEditor.Tj(ka)&&!Mk.SelectionEditor.Wg(ka))return null;const ib=ka.node,Rb=ka.Va;ka=ka.Ib;let tc=0,xc=null;for(let hd=0;hd<ib.Za.length;hd++){const Fd=ib.Za.ha(hd);if(Fd.rC&&Rb>=Fd.cp)xc=
Fd.rC,tc=Fd.cp;else if(xc&&Fd.isDictationCorrectionEnd){if(ka<=Fd.cp)return new ll(tc,Fd.cp,xc.Gja);xc=null}}return null}e_n(ka,ib,Rb){if(!ka)return!1;ka=Me.ParagraphReader.text(ka);return Sa.z$l(ka,ib.source,Rb)}Yjh(ka){if(ka){var ib=this.vul(ka);if(ib&&0<ib.count){const Rb=new N.a,tc=Me.ParagraphReader.text(ka);for(const xc of ib)Sa.y$l(tc,xc)||Rb.add(xc);this.PJg(ka,Rb)}}}Hxm(ka,ib){ib.ha(0);ib.ha(ib.count-1);const Rb=this.vul(ka);let tc=0,xc=0;const hd=new N.a;for(;xc<ib.count&&tc<Rb.count;){const Fd=
ib.ha(xc),Td=Rb.ha(tc);Fd.Ib<Td.psa?xc++:(Td.Ib>Fd.psa&&hd.add(Td),tc++)}this.PJg(ka,hd)}wsn(ka,ib){(ka=Rc.App.Vb.Pd.An.Zg)&&(ib=ka.Ch.we(fg.a.Xf(ib.nodeId)))&&Me.ParagraphReader.me(ib)&&this.vFn(ib)}vFn(ka){if(ka){var ib=0,Rb=!1,tc=!1,xc=new N.a;for(let hd=0;hd<ka.Za.length;hd++){const Fd=ka.Za.ha(hd);Fd.rC&&(ib=hd,Rb=!0);Rb&&(Fd.np||Fd.aL)&&(tc=!0);Fd.isDictationCorrectionEnd&&Rb&&(Rb=!1,tc&&(tc=ka.Za.ha(ib),tc.rC&&tc.rC.Gja&&xc.add(new ll(tc.cp,Fd.cp,tc.rC.Gja)),tc.rC=null,tc=Fd.isDictationCorrectionEnd=
!1))}this.kb.raiseEvent("RDCM",new Rg(ka.id,xc))}}static d_n(ka,ib){if(!ib.count)return ib;ib.Sc((tc,xc)=>tc.psa!==xc.psa?tc.psa-xc.psa:tc.Ib-xc.Ib);ka=Me.ParagraphReader.text(ka);const Rb=new N.a;for(let tc=0;tc<ib.count;tc++){const xc=ib.ha(tc);if(xc.psa>ka.length||xc.Ib>ka.length)break;if(!Sa.y$l(ka,xc))continue;if(!Rb.count){Rb.add(xc);continue}const hd=Rb.ha(Rb.count-1);xc.psa>hd.Ib?Rb.add(xc):hd.psa===xc.psa&&hd.Ib===xc.Ib&&hd.Gja.lgn(xc.Gja)}return Rb}static z$l(ka,ib,Rb){if(Rb+ib.length<=
ka.length){for(let tc=0;tc<ib.length;tc++)if(ib.charAt(tc)!==ka.charAt(tc+Rb))return!1;return!0}return!1}static y$l(ka,ib){return!ka||ib.psa>ka.length||ib.Ib>ka.length||!ib.Gja||!ib.Gja.source?!1:Sa.z$l(ka,ib.Gja.source,ib.psa)}}Object(m.a)(Sa,"DictationCorrectionRangeEditor",null,[1169]);class Zb{constructor(){this.qsc=!1}}Object(m.a)(Zb,"DictationCorrectionSettings",null,[]);var Wc=a(75);class rd{constructor(){this.a7e=new Wc.ScriptSharpLegacyMap}dom(ka){if(ka&&ka.count)for(const ib of ka)ib.Gja?
(ka=ib.Gja.key,this.a7e.Ob(ka)||this.a7e.add(ka,ib.Gja)):n.ULS.sendTraceTag(593285260,394,10,"Correction details is null.")}uFn(ka){if(ka&&ka.count)for(const ib of ka)ib.Gja?this.a7e.remove(ib.Gja.key):n.ULS.sendTraceTag(593285259,394,10,"Correction details is null.")}pNm(ka){if(!ka)return null;let ib;return({value:ib}=this.a7e.Uh(ka)).returnValue?ib:null}clear(){this.a7e=new Wc.ScriptSharpLegacyMap}}Object(m.a)(rd,"DictationCorrectionStorage",null,[1195]);class ee{constructor(ka,ib,Rb,tc,xc,hd,Fd){this.iAe=
(Td,na,$a,Fb,Xb)=>{if(2===$a){na=this.Nc.Ua.mb;if(!na)return 2;na=this.ff.fm(na,!0,!1);return this.ya.Sh(na.Xa,Td,$a,!1,Fb,Xb)}return 32};this.Jh=ka;this.cWe=ib;this.fla=Rb;this.ya=tc;this.Nc=xc;this.ff=hd;this.zl=Fd}Hb(){this.ya.za(X.a.YNe,Id.a.ng,Object(K.a)(this,this.TYg,"takeSuggestedDictationCorrectionAction"));this.ya.za(X.a.ZNe,Id.a.ng,Object(K.a)(this,this.TYg,"takeSuggestedDictationCorrectionAction"));this.ya.za(X.a.$Ne,Id.a.ng,Object(K.a)(this,this.TYg,"takeSuggestedDictationCorrectionAction"));
this.ya.za(X.a.aOe,Id.a.ng,Object(K.a)(this,this.TYg,"takeSuggestedDictationCorrectionAction"));this.ya.za(X.a.bOe,Id.a.ng,Object(K.a)(this,this.TYg,"takeSuggestedDictationCorrectionAction"));this.ya.za(X.a.XNe,Id.a.ng,Object(K.a)(this,this.XNe,"takeIgnoreSuggestedDictationCorrection"));this.ya.za(X.a.YNe,Id.a.view,this.iAe);this.ya.za(X.a.ZNe,Id.a.view,this.iAe);this.ya.za(X.a.$Ne,Id.a.view,this.iAe);this.ya.za(X.a.aOe,Id.a.view,this.iAe);this.ya.za(X.a.bOe,Id.a.view,this.iAe);this.ya.za(X.a.XNe,
Id.a.view,this.iAe);this.ya.ue(X.a.YNe,96);this.ya.ue(X.a.ZNe,96);this.ya.ue(X.a.$Ne,96);this.ya.ue(X.a.aOe,96);this.ya.ue(X.a.bOe,96);this.ya.ue(X.a.XNe,96)}tsm(ka,ib,Rb){const tc=this.zl.qe(15);try{tc.hd(ka);let xc;this.cWe.PJg(ka,(xc=new N.a,xc.add(ib),xc));const hd=ib.Gja.suggestions.ha(Rb);if(this.cWe.e_n(ka,hd,ib.psa)){const Fd=jc.a.createTextRange(ka,ib.psa,ib.psa+hd.source.length);this.Jh.replaceTextRange(Fd,hd.suggestion);this.fla.hpn(ib.Gja,Rb)}else n.ULS.sendTraceTag(50946527,394,100,"Failed to apply Suggestion")}finally{tc&&
tc.dispose()}}TYg(ka,ib,Rb){2===Rb&&ib.il&&(Rb=this.cWe.ghh(ib))&&this.tsm(ib.node,Rb,this.qNm(ka));return 32}XNe(ka,ib,Rb){if(2===Rb&&ib.il&&(ka=this.cWe.ghh(ib))){let tc;this.cWe.PJg(ib.node,(tc=new N.a,tc.add(ka),tc));this.fla.kpn(ka.Gja)}return 32}qNm(ka){switch(ka){case X.a.YNe:return 0;case X.a.ZNe:return 1;case X.a.$Ne:return 2;case X.a.aOe:return 3;case X.a.bOe:return 4;default:return-1}}}Object(m.a)(ee,"DictationCorrectionsActor",null,[1194]);var De=a(455),Af=a(276);class mg{constructor(){this.T5k=
this.Ha=null}get name(){return"Box4.DictationCorrections"}lc(ka){this.Ha=ka;this.Ha.register(1169,"Box4.DictationCorrections.IDictationCorrectionRangeEditor").ma().na(()=>new Sa(this.Ha.resolve("Box4.ICharacterPropertiesEditor")));this.Ha.register(1170,"Box4.DictationCorrections.IDictationCorrectionManager").ma().na(()=>new Cj(this.Ha.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),new Zb,new rd));this.Ha.register(1171,"Box4.DictationCorrections.IDictationCorrectionContextMenuManager").ma().na(()=>
new Qi(this.Ha.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor")))}init(){this.Ha.resolve("Box4.DictationCorrections.IDictationCorrectionManager");this.T5k=new ee(this.Ha.resolve("Box4.ICharacterPropertiesEditor"),this.Ha.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Ha.resolve("Box4.DictationCorrections.IDictationCorrectionManager"),u.AFrameworkApplication.vb,Af.a.instance,De.a.instance,this.Ha.resolve("Box4.Graph.IGraphTransactionFactory"));this.T5k.Hb();
this.mEn(this.Ha.Na("Box4.Accessibility.IAccessibilityContextManager"),this.Ha.resolve("Box4.IParagraphReader"),this.Ha.resolve("Box4.DictationCorrections.IDictationCorrectionManager"));const ka=this.Ha.yb("Box4.Proofing.IErrorRangeEditor"),ib=this.Ha.yb("Box4.DictationCorrections.IDictationCorrectionRangeEditor");u.AFrameworkApplication.ga.getBooleanAppSetting("WacBox4DictationFloatieIsEnabled")&&ka&&ib&&ka.Cel(Object(K.a)(ib,ib.wsn,"onSpellingErrorRangesChangedEventHandler"));Rc.App.Vb.Zf()}dispose(){}mEn(ka,
ib,Rb){ka&&ka.execute(tc=>{tc.Y5a(new mj(ib,Rb))})}}Object(m.a)(mg,"DictationCorrectionsPackageManager",null,[3,4]);a(1585);a(898);var dg=a(853);class Zg{constructor(ka,ib,Rb,tc=null,xc=null){this.mo=ka;this.xL=ib;this.bjm=Rb;this._id=tc;this.GKh=xc}get Pe(){return this.mo}get type(){return this.xL}get Dk(){return this.bjm}get id(){return this._id}get intent(){return this.GKh}Nd(ka){return new Zg(ka,this.type,this.Dk,this.id,this.intent)}toString(){return String.format("Type = {0}, IsStart = {1}, Id = {2}",
this.type,this.Dk,this.id?this.id.toString():"<null>")}}Object(m.a)(Zg,"IntentObject",null,[157]);a(854);class Gh{constructor(ka,ib,Rb,tc=null,xc=null){dg.a(ka);this.xL=ka;this.NTe=ib;this.QWe=Rb;this._id=tc;this.GKh=xc}get type(){return this.xL}get begin(){return this.NTe}get end(){return this.QWe}get id(){return this._id}get intent(){return this.GKh}toString(){return String.format("Type = {0}, Begin = {1}, End = {2}, Id = {3}",this.type,this.begin,this.end,this.id?this.id.toString():"<null>")}}
Object(m.a)(Gh,"IntentRange",null,[162]);a(525);a(175);a(176);class wh{constructor(ka){this.Jh=ka}}Object(m.a)(wh,"IntentRangeEditor",null,[1167]);class Ji{constructor(){this.Ha=null}get name(){return"Box4.Intent"}lc(ka){this.Ha=ka;this.Ha.register(wh,"Box4.Intent.IntentRangeEditor").as("Box4.Intent.IIntentRangeEditor").ma().na(()=>new wh(this.Ha.resolve("Box4.ICharacterPropertiesEditor")))}init(){this.Ha.resolve("Box4.IProofingManager")}dispose(){}static main(){L.a.instance.Fc(new Ji)}}Object(m.a)(Ji,
"PackageManager",null,[3,4]);var bi=a(1643),ni=a(1064),eh=a(429),nj=a(1206),Al=a(884),dl=a(926);class Zi{}Zi.productionLanguages="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-IN en-AU".split(" ");Zi.previewLanguages="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");Zi.K_n="en-US en-CA en-GB en-AU en-IN en-NZ".split(" ");
Zi.otm=["en-US","en-CA","en-GB","en-AU","en-IN"];Zi.ptm="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");Zi.nDm="en-US";Zi.uEm="btnStartDictation";Zi.FEm="btnDictationFloatieToggle";Zi.CEm="Dictation";Zi.GEm="DictationFloatieToggle";Zi.iol="Insertaudio_32x32x32";Zi.hol=
"Insertaudio_16x16x32";Zi.BEm="JotInsertAudioRecordingShort_32x32x32";Zi.AEm="JotInsertAudioRecordingShort_16x16x32";Zi.NRn="speechOn.wav";Zi.MRn="speechOff.wav";Object(m.a)(Zi,"DictationConstants",null,[]);class Sj{constructor(ka){this.P8k=ka;this.J2c=(ka=Ti.a.Ne(ka))?ka.displayName:this.P8k;this.XS=ka?ka.LCID:Sj.O8m}get Glh(){return this.P8k}get displayName(){return this.J2c}get LCID(){return this.XS}}Sj.O8m=1033;Object(m.a)(Sj,"DictationLanguage",null,[]);class Ei{constructor(ka,ib,Rb,tc,xc,hd,
Fd,Td,na){this.h9g=null;this.j7k=!1;this.Fyb=null;this.kye=!1;this.RKe=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;Nc&&($a=!!u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.Cx,this.Fyb?Nc[$a?Mi.a.On:ni.a.On]=this.Fyb.isVisible():(Xb=this.O8a.tna(),Xb=(Fb=2===Xb)||1===Xb,$a?(Nc[Mi.a.On]=Xb,Nc[eh.a.IconSet]=Fb?(new nj.a("JotInsertAudioRecordingShort_20")).iconSet:u.AFrameworkApplication.Ea.Kb.lFa?(new nj.a("InsertAudio_32")).iconSet:(new nj.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet):
(Nc[ni.a.On]=Xb,Fb?(Nc[ni.a.Image32by32Class]=kk.d(Zi.BEm),Nc[ni.a.Image16by16Class]=kk.d(Zi.AEm)):(Nc[ni.a.Image32by32Class]=kk.d(Zi.iol),Nc[ni.a.Image16by16Class]=kk.d(Zi.hol)))));return 32};this.pse=($a,Fb,Xb,nc,Nc)=>{if(2===Xb){if(!this.Fyb||(null===Nc||void 0===Nc?0:Nc.gol))return this.WAi(Nc);this.J7l()}return 32};this.i_g=($a,Fb,Xb)=>2!==Xb?32:this.WAi(void 0);this.zee=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;this.nwn(Nc,$a===X.a.J7j);return 32};this.tth=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;
Nc&&(($a=Nc.MenuItemId)&&$a===this.Co.QIa?(Nc[Mi.a.On]=!0,this.h9g=Nc.SourceControlId):Nc[Mi.a.On]=!1);return 32};this.gth=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;Nc&&(Nc[Al.a.Value]=(new Sj(this.Co.QIa)).displayName);return 32};this.awh=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;Nc&&($a=Nc.SourceControlId,this.h9g!==$a&&(this.Co.QIa=Nc.MenuItemId,this.J9l(this.h9g),this.J9l($a),this.h9g=$a,2===this.O8a.tna()&&this.QQa()));return 32};this.bwh=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;if(Nc){$a=Nc.MenuItemId;
if(this.Co.QIa!==$a){this.Co.QIa=$a;if(this.Fyb)this.Fyb.onDictationLanguageChanged($a);2===this.O8a.tna()&&this.QQa()}this.jXk()}return 32};this.showHelpPane=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;$a=this.Dfm.value;if(!$a)return 0;Nc&&(Nc={},Nc.query="AssetID="+(this.Co.dZn?Ei.jim:Ei.TJh),Nc=Object.assign(new bi.a,{nonPersistedSettings:Nc}),$a.mFa(Ei.SJh,Nc));return 32};this.DUn=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return this.Co.Jfj?32:8;Nc&&this.Co&&(this.Co.useAutoPunctuation=Nc[Mi.a.On]);2===this.O8a.tna()&&
this.QQa();this.jXk();return 32};this.GUn=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return this.Co.urj?32:8;Nc&&this.Co&&(this.Co.lPe=Nc[Mi.a.On]);2===this.O8a.tna()&&(this.O8a.QQa(),this.VOe());this.z9l();return 32};this.WBn=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;Nc&&this.Co&&(Nc[Mi.a.On]=this.Co.useAutoPunctuation);return 32};this.XBn=($a,Fb,Xb,nc,Nc)=>{if(1===Xb)return 32;Nc&&this.Co&&(Nc[Mi.a.On]=this.Co.lPe);return 32};this.mpn=($a,Fb,Xb)=>{2===Xb&&this.mfh();return 32};this.grn=($a,Fb,Xb)=>{2===Xb&&this.Co.Rsa&&
2===this.O8a.tna()&&this.QQa();return 32};this.Epn=($a,Fb,Xb)=>{2===Xb&&this.Co.Rsa&&this.mfh();return 32};this.GIe=($a,Fb,Xb)=>{2===Xb&&(this.Co.Rsa?this.mfh():this.QQa());return 32};this.Fpn=($a,Fb,Xb)=>{2===Xb&&this.QQa();return 32};this.ppn=($a,Fb,Xb)=>{2===Xb&&this.VOe();return 32};this.qpn=($a,Fb,Xb)=>{2===Xb&&(this.O8a.QQa(),this.VOe());return 32};this.opn=($a,Fb,Xb,nc,Nc)=>{2===Xb&&Nc&&($a=Ti.a.Ne(this.Co.QIa),this.yf.rec(this.eQ.xs(Nc),$a.LCID,Nc.Ib));return 32};this.npn=($a,Fb,Xb)=>{2===
Xb&&this.QQa();return 32};this.spn=($a,Fb,Xb)=>{2===Xb&&this.QQa();return 32};this.rpn=($a,Fb,Xb)=>2===Xb&&this.Co&&this.Co.n4m?this.Co.Rsa&&this.Fyb&&!this.Fyb.isVisible()?(this.J7l(),32):this.WAi(void 0):32;this.ya=ka;this.fla=Rc.App.ecb;this.a8g=Rc.App.hJa;this.O8a=Rb;this.p$g=ib;this.yf=tc;this.eQ=xc;this.Co=Fd;this.Je=na;this.Co.Rsa&&(this.Fyb=hd);this.Dfm=Td}Hb(){this.ya.sa(X.a.zee,Id.a.view,this.zee,96);this.ya.sa(X.a.awh,Id.a.view,this.awh,1028);this.ya.sa(X.a.tth,Id.a.view,this.tth,96);this.ya.sa(X.a.pse,
Id.a.view,this.pse,1028);this.ya.sa(X.a.RKe,Id.a.view,this.RKe,96);this.ya.sa(X.a.Gui,Id.a.view,this.GIe,64);this.ya.sa(X.a.Jui,Id.a.view,this.GIe,64);this.ya.sa(X.a.Mui,Id.a.view,this.ppn,64);this.ya.sa(X.a.Nui,Id.a.view,this.qpn,64);this.ya.sa(X.a.Kui,Id.a.view,this.opn,64);this.ya.sa(X.a.Iui,Id.a.view,this.npn,64);this.ya.sa(X.a.Pui,Id.a.view,this.Fpn,64);this.ya.sa(X.a.Lui,Id.a.view,this.spn,64);this.ya.sa(X.a.J7j,Id.a.view,this.zee,96);this.ya.sa(X.a.bwh,Id.a.view,this.bwh,1028);this.ya.sa(X.a.gth,
Id.a.view,this.gth,96);this.ya.sa(X.a.lol,Id.a.view,this.showHelpPane,96);this.ya.sa(X.a.mol,Id.a.view,this.showHelpPane,96);this.ya.sa(X.a.kol,Id.a.view,this.DUn,96);this.ya.sa(X.a.lWl,Id.a.view,this.WBn,96);this.ya.sa(X.a.nol,Id.a.view,this.GUn,96);this.ya.sa(X.a.mWl,Id.a.view,this.XBn,96);this.ya.sa(X.a.i_g,Id.a.view,this.i_g,1028);this.ya.sa(X.a.Hui,Id.a.view,this.mpn,1028);this.ya.sa(X.a.jol,Id.a.view,this.grn,96);this.ya.sa(X.a.fol,Id.a.view,this.Epn,96);const ka=ja.a.eb(Zc.a.w$l,1);this.Je.gd(Aa.AFrame.vl).bindAction(ka,
X.a.Oui);this.ya.sa(X.a.Oui,Id.a.view,this.rpn,1028)}fhh(){return u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.Cx?this.Co.Rsa?Zi.GEm:Zi.CEm:this.Co.Rsa?Zi.FEm:Zi.uEm}com(){const ka=Object.assign(new eg.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",ControlList:[]}),ib=Object.assign(new pg.a,{Id:"DictationLanguageList_"+this.fhh(),ExternalId:"DictationLanguageList_"+this.fhh(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,
Command:"1394650145",MenuItemId:this.fhh(),QueryCommand:"2417470717",Image16by16Class:kk.d(Zi.hol),Image32by32Class:kk.d(Zi.iol),Visible:!0,AriaLabel:Ha.a.chl});Array.add(ka.ControlList,ib);return ka}nwn(ka,ib){ka.MenuItems=Object.assign(new Ld.a,{Id:ib?"DictationSettingsLanguageList":"DictationLanguageList",MenuSectionList:[],UpdateDynamically:!0});if(!ib){var Rb=this.com();Array.add(ka.MenuItems.MenuSectionList,Rb)}Rb=this.Co.fWl;0<Rb.length&&(Rb=Ei.Vdh(Rb,"dictationProdcutionLanguages","",ib),
Array.add(ka.MenuItems.MenuSectionList,Rb));Rb=this.Co.EVl;0<Rb.length&&(ib=Ei.Vdh(Rb,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,ib),Array.add(ka.MenuItems.MenuSectionList,ib));ka.PopulationXML=vk.l(ka.MenuItems);this.j7k=!0}VOe(){const ka=this.p$g.value;if(ka){const ib=this.fhh();if(u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.Cx){const Rb={};Rb[ib]=this.Co.Rsa?"ToggleButtonModel":"SplitButtonModel";this.j7k&&!this.Co.Rsa&&(Rb["DictationLanguageList_"+
ib]="ToggleButtonModel");ka.O0c(Rb)}this.jXk();this.z9l()}}jXk(){if(this.Co.Rsa){const ka=this.p$g.value;u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.Cx&&ka.O0c({DictationSettingsAutoPunctuation:"CheckboxModel"})}}z9l(){if(this.Co.Rsa){const ka=this.p$g.value;u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.Cx&&ka.O0c({DictationSettingsVoiceCommands:"CheckboxModel"})}}J9l(ka){const ib=this.p$g.value;if(ib&&u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.Cx){const Rb=
{};Rb[ka]="ToggleButtonModel";ib.O0c(Rb)}}J7l(){this.kye||(this.kye=!0,this.Fyb.isVisible()?(this.mfh(),this.kye=!1):this.showFloatie(),this.VOe())}showFloatie(){this.Fyb.showFloatie((new Sj(this.Co.QIa)).displayName).then(()=>{0===this.O8a.tna()&&this.O8a.Upe(void 0).then(()=>{this.kye=!1}).catch(ka=>{this.kye=!1;n.ULS.sendTraceTag(577901849,394,10,"Failed to start dictation {0}",ka)});this.Co.VQf&&this.fla&&this.fla.cSn();this.a8g&&this.a8g.startSession()}).catch(()=>{this.kye=!1})}WAi(ka){const ib=
this.O8a.tna();if(1===ib||3===ib)return 1;0===ib?this.Upe(null===ka||void 0===ka?void 0:ka.gol):this.QQa();return 32}mfh(){const ka=this.O8a.tna();1!==ka&&(this.Fyb&&this.Fyb.hideFloatie(),this.fla&&this.fla.ASn(),0!==ka&&this.QQa(),this.a8g&&this.a8g.endSession(),this.VOe())}QQa(){this.O8a.QQa();this.VOe()}Upe(ka){this.O8a.Upe(ka).then(()=>{}).catch(ib=>{n.ULS.sendTraceTag(577901848,394,10,"Failed to start dictation {0}",ib)})}static createInstance(ka,ib,Rb,tc,xc,hd,Fd,Td){return Ei.Wa||(Ei.Wa=new Ei(u.AFrameworkApplication.vb,
ka,ib,Rb,tc,xc,hd,Fd,Td))}static Vdh(ka,ib,Rb,tc){Rb=Object.assign(new eg.a,{DisplayMode:"Menu",Title:Rb,Id:ib,ControlsId:"ctr"+ib,ControlList:[]});for(const xc of ka){ka=ib+"_"+xc.Glh;const hd=xc.displayName,Fd=xc.Glh;tc?(ka=Object.assign(new dl.a,{Id:ka,ExternalId:ka,LabelText:hd,Command:"3662249320",MenuItemId:Fd,Visible:!0}),Array.add(Rb.ControlList,ka)):(ka=Object.assign(new pg.a,{Id:ka,ExternalId:ka,LabelText:hd,Command:"2863762275",MenuItemId:Fd,QueryCommand:"2739750502",Visible:!0,AriaLabel:Ha.a.lvd}),
Array.add(Rb.ControlList,ka))}return Rb}}Ei.Wa=null;Ei.SJh="FA000000012";Ei.TJh="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";Ei.jim="78766431-0933-4603-abf5-5bcc1dee9dda";Object(m.a)(Ei,"DictationActor",null,[1197]);var oj=a(425),fk=a(1322),zk=a(339);class nl{constructor(ka,ib){this.DVa=null;this.pDa=!1;this.D2c=null;this.Ygm=ka;this.Co=ib}isVisible(){return this.pDa}dkh(){return this.pDa&&!!this.DVa}aHm(){if(this.DVa)return!0;this.DVa=this.Ygm.value;if(!this.DVa)return!1;this.DVa.h6n(X.a.i_g);this.DVa.g6n(X.a.Hui);
ld.a.addHandler(window.self,Pa.a.resize,()=>{this.UXm()});const ka=Yb.FocusManager.instance().gd(zk.AppFrame.W$b);ka.G9(ib=>{this.JJm(ib)});ka.lSa((ib,Rb)=>{this.IJm(Rb)});ka.$V=!0;ka.Hsk=!0;oj.a.instance.P7(zk.AppFrame.W$b,!0);oj.a.instance.Cr(zk.AppFrame.W$b);return!0}JJm(ka){this.dkh()&&ka.name!==Aa.AFrame.FR&&this.DVa.focus()}IJm(ka){this.dkh()&&ka.name!==Aa.AFrame.FR&&this.DVa.blur()}showFloatie(ka){return this.pDa?Promise.resolve(null):this.aHm()?new Promise((ib,Rb)=>{this.DVa.a4n().then(()=>
{this.DVa.showDictationFloatie(this.l$a(),!1,ka,this.Co.useAutoPunctuation);this.D2c=ka;this.pDa=!0;oj.a.instance.XW(zk.AppFrame.W$b);ib(null)}).catch(()=>{Rb("failed to intialize the floatie")})}):Promise.reject("Unable to find the dictation floatie controller")}hideFloatie(){this.dkh()&&(this.DVa.dismissDictationFloatie(),oj.a.instance.Cr(zk.AppFrame.W$b),this.pDa=!1)}showDictationWarning(ka){this.dkh()&&this.DVa.showDictationWarning(ka)}onDictationLanguageChanged(ka){this.D2c=ka}l$a(){var ka=Rc.App.Vb.VSa.getBoundingClientRect();
const ib=ka.left+ka.width/2-44;ka=ka.top+ka.height-70;return Object.assign(new fk.a,{x:ib,y:ka})}UXm(){this.pDa&&this.DVa&&(this.DVa.dismissDictationFloatie(),this.DVa.showDictationFloatie(this.l$a(),!1,this.D2c,this.Co.useAutoPunctuation))}}Object(m.a)(nl,"DictationFloatieManager",null,[]);class Ck{constructor(){this.pHb=this.rjc=0;this.i8g=null;this.Lyb=!0;this.a7g="";this.Co=this.Qr=null;this.sjc=this.Syb=this.S2c=this.xz=this.Mm=0;this.gIh=this.nVa="";this.H4e=this.gVe=0;this.CIh=this.XIh=this.WIh=
!1;this.RTh="";this.Y3e=this.dYe=this.Un=this.N8a=null;this.PGh=this.w9g=this.v9g=this.tVh=this.Ecl=this.asd=this.Zrd=0}set fzm(ka){this.nVa=ka}get jec(){return Rc.App.hJa?Rc.App.hJa.jec:""}get Gfd(){return Rc.App.hJa?Rc.App.hJa.Gfd:""}set Gfd(ka){Rc.App.hJa&&(Rc.App.hJa.Gfd=ka)}onFragment(ka){this.S2c||(this.S2c=(new Date).getTime());this.dYe&&(this.dYe.stop(),this.Zrd+=this.dYe.nv,this.dYe.start());this.rjc++;this.sjc+=ka.split(" ").length}onFinalPhrase(ka){this.S2c||(this.S2c=(new Date).getTime());
this.Y3e&&(this.Y3e.stop(),this.asd+=this.Y3e.nv,this.Y3e.start());this.sjc=0;this.pHb++;this.Syb+=ka.split(" ").length}onConnectionStarted(ka){this.gVe=(new Date).getTime();this.fzm=ka;this.Un&&(this.dYe=this.Un.wl("WebServiceCall","FragmentResponse"),this.Y3e=this.Un.wl("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.H4e=(new Date).getTime()}onMicrophoneError(ka){this.onCustomError("MicrophoneError",ka)}onCustomError(ka,ib=null){this.Lyb=!1;this.i8g=ka;this.setEndReason(ib||ka)}setEndReason(ka){this.gIh=
ka}onTextInsertionError(){this.onCustomError("FailedToInsertText")}onTextInserted(ka,ib){this.PGh=ib;ka?(this.tVh+=ib,ib>this.w9g&&(this.w9g=ib)):(this.Ecl=ib,ib>this.v9g&&(this.v9g=ib))}onFocusLost(){this.WIh=!0}onFocusLostWhileStarting(){this.XIh=!0}onFailedToStartTurn(){this.CIh=!0}onSpeechSessionStarted(ka){this.RTh=ka}setDictationLatency(ka){this.N8a=ka}endActivity(){}onCommandCalled(){}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(){}setCurFinalResultAnnotationResponseTime(){}calculateMaxAndMinFinalResultUserPerceivedLatency(){}setCurPartialResultAnnotationResponseTime(){}calculateMaxAndMinPartialResultUserPerceivedLatency(){}setFirstAudioChunkStartTime(){}setMicrophoneWarmUpLatency(){}getDictationStartTime(){}}
Object(m.a)(Ck,"AbstractDictationSessionTelemetry",null,[1232]);class Ak{}Ak.seen="Seen";Ak.V7l="Tried";Ak.xEl="Kept";Object(m.a)(Ak,"FunnelStatus",null,[]);class Pk{constructor(){this.dataFields=this.name=null}}Object(m.a)(Pk,"Contract",null,[]);class vl extends Ck{constructor(ka,ib){super();this.i5k=this.h5k=this.w4k=!1;this.PNh=this.LNh=this.hRh=0;this.gOh=this.fOh=2147483647;this.sVh=this.qVh=0;this.Co=ka;this.Mm=(new Date).getTime();this.Un=ib;this.Gfd=Mc.a.create().toString();this.Qr=new kl.a;
this.Qr.dataFields=[];this.a7g="Office.Voice.Online.ALDictationSession"}onFinalResultAnnotationResponse(ka,ib,Rb){ka=ka+this.PGh-(this.hRh+(ib+Rb)/1E4);this.qVh+=ka;this.LNh<ka&&(this.LNh=ka);this.fOh>ka&&(this.fOh=ka)}onPartialResultAnnotationResponse(ka,ib,Rb){ka=ka+this.PGh-(this.hRh+(ib+Rb)/1E4);this.sVh+=ka;this.PNh<ka&&(this.PNh=ka);this.gOh>ka&&(this.gOh=ka)}setRecordingStartTime(ka){this.hRh=ka}onCommandCalled(){this.h5k=!0}onAugloopError(ka){this.Lyb=!1;this.w4k=!0;this.i8g=ka}onCommandError(){this.i5k=
!0}endActivity(){this.Syb+=this.sjc;this.xz=(new Date).getTime();this.Qr.succeeded=this.Lyb;this.Qr.durationMs=this.xz-this.Mm;Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"Success",bool:this.Lyb}));this.Lyb||Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"error",string:this.i8g}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"SessionID",string:this.jec}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"SpeechSessionID",string:this.RTh}));Array.add(this.Qr.dataFields,
Object.assign(new se.a,{name:"TurnID",string:this.Gfd}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"NumberOfWords",int64:0<this.sjc?this.sjc+this.Syb:this.Syb}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"NumberOfFragments",int64:this.rjc}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"NumberOfFinalPhrases",int64:this.pHb}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"Language",string:this.Co.QIa}));Array.add(this.Qr.dataFields,Object.assign(new se.a,
{name:"connectionID",string:this.nVa}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"IsUsingFloatie",bool:this.Co.Rsa}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"UseAutoPunctuation",bool:this.Co.useAutoPunctuation}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"EndReason",string:this.gIh}));this.S2c&&Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"TimeToGetFirstResult",
int64:this.S2c-this.gVe}));this.Lyb&&(Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"TimeToStartRecording",int64:this.H4e-this.Mm})),Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"TimeToOpenConnection",int64:this.gVe-this.H4e})));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"FocusLost",bool:this.WIh}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"FocusLostWhileStarting",bool:this.XIh}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"FailedToStartTurn",
bool:this.CIh}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"MaxTimeToInsertFragment",int64:this.v9g}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"MaxTimeToInsertPhrase",int64:this.w9g}));var ka=Ak.seen;this.Lyb&&0<this.Syb&&(ka=0<this.pHb?Ak.xEl:Ak.V7l);Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"DictationFunnel",contract:Object.assign(new Pk,{name:"Office.System.Funnel",dataFields:[Object.assign(new se.a,{name:"Name",string:"Dictation"}),Object.assign(new se.a,
{name:"State",string:ka})]})}));this.Qr.name=this.a7g;this.Qr.samplingPolicy=2;Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"AugloopFailed",bool:this.w4k}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"CommandsUsed",bool:this.h5k}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"CommandsFailed",bool:this.i5k}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.LNh}));Array.add(this.Qr.dataFields,Object.assign(new se.a,
{name:"MinFinalResultUserPerceivedLatency",int64:this.fOh}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"MaxPartialResultUserPerceivedLatency",int64:this.PNh}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.gOh}));ka=0<this.pHb?this.qVh/this.pHb:0;const ib=0<this.rjc?this.sVh/this.rjc:0;Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"AverageFinalResultUserPerceivedLatency",double:ka}));Array.add(this.Qr.dataFields,
Object.assign(new se.a,{name:"AveragePartialResultUserPerceivedLatency",double:ib}));$h.a.sendActivityEvent(this.Qr)}}Object(m.a)(vl,"AugloopDictationTelemetry",Ck,[]);var Bl=a(379);class Zf{constructor(ka){this.Hcb=ka}play(){this.Hcb.play()}pause(){this.Hcb.pause()}get paused(){return this.Hcb.paused}get currentTime(){return this.Hcb.currentTime}set currentTime(ka){this.Hcb.currentTime=ka}get duration(){return this.Hcb.duration}get error(){const ka=this.Hcb.error;return ka?ka.code:0}get readyState(){return this.Hcb.readyState}get src(){return this.Hcb.getAttribute("src")}set src(ka){this.Hcb.setAttribute("src",
ka)}get preload(){return this.Hcb.getAttribute("preload")}set preload(ka){this.Hcb.setAttribute("preload",ka)}get ig(){return this.Hcb}}Object(m.a)(Zf,"AudioElement",null,[]);class Ki{constructor(){this.SOh=this.ROh=this.asd=this.Zrd=this.CHh=0}onAudioData(){this.CHh||(this.CHh=(new Date).getTime())}onFragment(ka){this.Zrd+=this.ixl(ka);this.ROh++}irn(ka){this.asd+=this.ixl(ka);this.SOh++}Ltl(){return this.SOh?this.asd/this.SOh:0}lMm(){return this.ROh?this.Zrd/this.ROh:this.Ltl()}ixl(ka){if(!ka)return 0;
const ib=(new Date).getTime();let Rb=null;return({BD:Rb}=ca.d(ka)).returnValue?ib-this.CHh-(Rb.Offset+Rb.Duration)/1E4:0}}Object(m.a)(Ki,"DictationLatency",null,[]);class Xg{constructor(ka,ib){this.mdb=0;this.PTh=this.QTh=null;this.E0e=!1;this.z9g=null;this.U8g=!1;this.N8a=this.OM=null;this.ZPl=()=>{if(1===this.mdb){if(this.OM)this.OM.onFocusLostWhileStarting()}else 2===this.mdb&&(this.bWk(),this.sja.onFocusLost())};this.sja=ib;this.Iyb=ka}onFinalText(ka,ib){if(2===this.mdb){var Rb=ka.size;if(1!==
Rb&&(n.ULS.sendTraceTag(51442337,394,10,"Final text mapping has invalid size of {0}",Rb),!Rb))return;ib=ib.get("JsonResult");this.N8a&&this.N8a.irn(ib);this.sja.onFinalPhrase(ka.values().next().value,ib)}}onFragmentText(ka,ib){if(2===this.mdb){var Rb=ka.size;if(1!==Rb&&(n.ULS.sendTraceTag(51442338,394,10,"Fragment text mapping has invalid size of {0}",Rb),!Rb))return;ib=ib.get("JsonResult");if(this.N8a)this.N8a.onFragment(ib);this.sja.onFragment(ka.values().next().value)}}onError(ka){if(0!==this.mdb&&
3!==this.mdb&&"ErrorNone"!==ka){this.mdb=3;switch(ka){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.sja.Inn(ka);break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.sja.Qon(ka);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.sja.jN(ka);break;case "ErrorInitialSilenceTimeout":this.sja.oqn(ka);
break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.sja.onMicrophoneError(ka);break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.sja.x_j("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.sja.x_j("NotFoundError");break;case "ErrorAudioNotReadableError":this.sja.x_j("NotReadableError");
break;default:this.sja.Lsn(ka)}this.mdb=0}}onSpeechRecognitionStarted(ka){window.self.document.hasFocus()?(this.mdb=2,this.E0e=!1,this.sja.onRecordingStarted(),this.sja.onConnectionStarted(ka),this.QTh||(this.QTh=Object.assign(new Zf(document.createElement("audio")),{src:Bl.a.box4Image(Zi.NRn)})),this.QTh.play()):(this.bWk(),this.sja.onFocusLost())}onSpeechEnd(){this.bWk();0!==this.tna()&&(this.mdb=3,this.sja.Arn(),this.mdb=0,this.PTh||(this.PTh=Object.assign(new Zf(document.createElement("audio")),
{src:Bl.a.box4Image(Zi.MRn)})),this.PTh.play())}onAudioData(ka){if(this.N8a)this.N8a.onAudioData();if(this.Iyb){var ib=0;for(const Rb of ka)ib+=Math.pow(Rb,2);ka=Math.sqrt(ib/ka.length)>Xg.ERn;!this.E0e&&ka?(this.E0e=!0,this.z9g=null):this.E0e&&!ka&&(this.z9g?(new Date).getTime()>=this.z9g+Xg.qgn&&(this.E0e=!1):this.z9g=(new Date).getTime())}}onSpeechSessionStarted(ka){this.sja.onSpeechSessionStarted(ka)}onEventUpdate(ka){if(this.Iyb&&"QualityStatusUpdate"===ka.eventName)switch(ka.shortCode){case 13:case 2:this.Iyb.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);
break;case 3:case 4:this.Iyb.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;case 8:case 6:case 7:this.Iyb.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}Zed(ka,ib){this.sja.jtc(!1);this.sja.q2=ka;this.sja.DBl=ib;this.rEn();this.OM=ka;this.mdb=1;this.N8a=new Ki;this.OM&&this.OM.setDictationLatency(this.N8a)}tna(){return this.mdb}rEn(){this.U8g||(ld.a.addHandler(window.self,Pa.a.blur,this.ZPl),this.U8g=!0)}bWk(){this.U8g&&(ld.a.removeHandler(window.self,
Pa.a.blur,this.ZPl),this.U8g=!1)}}Xg.ERn=350;Xg.qgn=350;Object(m.a)(Xg,"FrontdoorSpeechClientObserver",null,[1233]);class el extends Xg{constructor(ka,ib){super(ka,ib);this.V2c=new Xg(ka,ib)}onFinalText(ka,ib){this.V2c.onFinalText(ka,ib)}onFragmentText(ka,ib){this.V2c.onFragmentText(ka,ib)}onError(ka){this.V2c.onError(ka)}onSpeechRecognitionStarted(ka){this.V2c.onSpeechRecognitionStarted(ka)}onSpeechEnd(){this.V2c.onSpeechEnd()}onAudioData(ka){this.V2c.onAudioData(ka)}Zed(ka,ib){this.V2c.Zed(ka,ib)}tna(){return this.V2c.tna()}}
Object(m.a)(el,"AugloopFrontdoorSpeechObserverAbstractDecorator",Xg,[]);class Dj extends el{constructor(ka,ib,Rb){super(ka,ib);this.Nc=Rb}onFinalText(ka,ib){super.onFinalText(ka,ib)}onFragmentText(ka,ib){if(this.apj())super.onFragmentText(ka,ib)}onError(ka){super.onError(ka)}onSpeechRecognitionStarted(ka=null){const ib=Mc.a.create().toString();super.onSpeechRecognitionStarted(ka?ka:ib)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(ka){super.onAudioData(ka)}Zed(ka,ib){super.Zed(ka,ib)}tna(){return super.tna()}apj(){const ka=
this.Nc.Ua.mb.Xa;return ka.Ib!==ka.Va?!1:!0}}Object(m.a)(Dj,"AugloopFrontdoorSpeechObserverDecorator",el,[]);class Sg{constructor(ka){this.edl=ka}onVoiceCommand(ka){this.edl.onVoiceCommand(ka)}setDictationSessionTelemetry(ka){this.edl.setDictationSessionTelemetry(ka)}}Object(m.a)(Sg,"AugloopVoiceCommandObserverAbstractDecorator",null,[1235]);class Jk extends Sg{constructor(ka,ib,Rb){super(ka);this.L8a=ib;this.Nc=Rb}onVoiceCommand(ka){this.apj()&&this.L8a.M6n();super.onVoiceCommand(ka)}setDictationSessionTelemetry(ka){super.setDictationSessionTelemetry(ka)}apj(){const ka=
this.Nc.Ua.mb.Xa;return ka.Ib!==ka.Va?!1:!0}}Object(m.a)(Jk,"AugloopVoiceCommandObserverDecorator",Sg,[]);class lk{constructor(ka){this.Co=ka}tFl(ka){const ib=u.AFrameworkApplication.ye;if(ib){var Rb=this.Co.Xsl;Rb&&""!==Rb&&ib.rk(String.format("https://{0}/SpeechHandler.ashx?action=SendCorrectionTelemetry",Rb),2,ka,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(m.a)(lk,"FrontdoorCorrectionsTelemetryLogger",null,[1234]);class Bi{constructor(){this.properties=
this.useCorrections=this.useAutoPunctuation=this.dictationLanguage=null}}Object(m.a)(Bi,"SpeechDictationSettings",null,[]);var wk=a(1584);class Cl{constructor(ka,ib,Rb,tc){this.BHh=this.T2=null;this.L8a=ka;this.Iyb=ib;this.sja=Rb;this.rwe=tc;this.initializeCommandsDictionary()}onVoiceCommand(ka){if(this.BHh)this.BHh.onCommandCalled();var ib=4;if(({value:ib}=this.T2.Uh(ka.commandId,0)).returnValue&&4!==ib){let Rb=null;ka.commandValue&&(Rb=new wk.a(dj.a.Wn()),Rb.add("commandValue",ka.commandValue));
this.sja.jtc(!1);ib=this.L8a.executeCommand(ib,Rb);if(ka.offset&&ka.duration)this.rwe.onCommandFinished(ka.commandId,ib,ka.offset,ka.duration)}}setDictationSessionTelemetry(ka){this.BHh=ka}initializeCommandsDictionary(){this.T2=new wk.a(dj.a.Wn());this.T2.add("Word.Editing.Undo",2);this.T2.add("Word.Editing.Bold",5);this.T2.add("Word.Editing.Italics",6);this.T2.add("Word.Editing.Underline",10);this.T2.add("Word.Editing.StrikeThrough",20);this.T2.add("Word.Editing.Subscript",19);this.T2.add("Word.Editing.Superscript",
18);this.T2.add("Word.Editing.RemoveBold",11);this.T2.add("Word.Editing.RemoveUnderline",13);this.T2.add("Word.Editing.RemoveItalics",12);this.T2.add("Word.Editing.RemoveStrikeThrough",21);this.T2.add("Word.Editing.RemoveSubscript",22);this.T2.add("Word.Editing.RemoveSuperscript",24);this.T2.add("Word.Editing.Paste",7);this.T2.add("Word.Editing.InsertTable",8);this.T2.add("Word.Editing.InsertComment",9);this.T2.add("Word.Editing.InsertBullet",23);this.T2.add("Word.Editing.FullJustify",14);this.T2.add("Word.Editing.CenterJustify",
15);this.T2.add("Word.Editing.LeftJustify",16);this.T2.add("Word.Editing.RightJustify",17);this.T2.add("Command.Exit",1);this.T2.add("Command.Pause",0);this.T2.add("Command.ShowHelp",26);this.T2.add("Command.ShowCommand",27);this.T2.add("Word.Editing.RemoveFormatting",28)}}Object(m.a)(Cl,"VoiceCommandObserver",null,[1235]);var Ul=a(1516);class Ql{constructor(ka,ib,Rb,tc,xc,hd,Fd){this.OM=this.z8e=null;this.A0m=0;this.rwe=xc;this.Co=Fd;xc=new Bi;xc.dictationLanguage=Fd.QIa;xc.useAutoPunctuation=Fd.useAutoPunctuation?
"Intelligent":"Explicit";xc.useCorrections=Fd.VQf.toString();alVoiceClient.DictationSettingsManager.dictationSettings=xc;this.$eb=new Dj(ka,hd,tc);this.fdl=new Jk(new Cl(ib,ka,hd,this.rwe),ib,tc);this.n7g=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.l4k=Array(Rb);this.n7g.setAnnotationResultCallback(Object.assign(new Ul.a,{handler:Td=>{for(const na of this.l4k)na.onAnnotationResult(Td)}}));this.Q6e=new alVoiceClient.SpeechToTextClient(this.n7g,this.$eb,Fd.Mue||Fd.Nzh,!1);this.Jdl(this.Q6e.getAnnotationObserver());
this.y8e=new alVoiceClient.VoiceCommandingClient(this.n7g,this.fdl,this.$eb);this.Jdl(this.y8e.getAnnotationObserver());Fd.VQf&&(ka=new lk(Fd),(ib=Rc.App.ecb)&&ib.UXl(ka))}TAl(ka,ib){return new Promise(Rb=>{const tc=new Bi;tc.dictationLanguage=ka;tc.useAutoPunctuation=this.Co.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings=tc;this.OM=ib;Rb(this.V1m())})}Upe(ka){if(!this.Q6e)return 3;this.z8e.startVoiceSessionFromMicrophoneInput();this.$eb.Zed(this.OM,
ka);ka=this.Co.lPe;this.Q6e.initializeAsync(ka?[1]:[1,0],this.OM);ka&&this.tSn();return 0}QQa(ka){if(ka&&this.$eb)this.$eb.onSpeechEnd();this.Q6e&&this.Q6e.uninitializeAsync();this.z8e&&(this.z8e.stopVoiceSession(),this.z8e=null);this.OM=null;this.Co.lPe&&this.LSn()}tna(){return this.$eb.tna()}V1m(){this.Co.lPe&&this.fdl.setDictationSessionTelemetry(this.OM);this.z8e=new alVoiceClient.VoiceSession(this.n7g,this.$eb,this.Co.Mue,this.rwe,this.OM);return 0}tSn(){this.y8e&&this.y8e.initializeAsync(this.OM)}LSn(){this.y8e&&
this.y8e.uninitializeAsync()}Jdl(ka){this.l4k[this.A0m++]=ka}}Object(m.a)(Ql,"AugloopSpeechClientProxy",null,[1216]);class Vl extends Ck{constructor(ka,ib){super();this.Co=ka;this.Mm=(new Date).getTime();this.Un=ib;this.Gfd=Mc.a.create().toString();this.Qr=new kl.a;this.Qr.dataFields=[];this.a7g="Office.Voice.Online.DictationSession"}endActivity(){this.Syb+=this.sjc;this.xz=(new Date).getTime();this.Qr.succeeded=this.Lyb;this.Qr.durationMs=this.xz-this.Mm;Array.add(this.Qr.dataFields,Object.assign(new se.a,
{name:"Success",bool:this.Lyb}));this.Lyb||Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"error",string:this.i8g}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"SessionID",string:this.jec}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"SpeechSessionID",string:this.RTh}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"TurnID",string:this.Gfd}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"NumberOfWords",int64:0<this.sjc?this.sjc+this.Syb:
this.Syb}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"NumberOfFragments",int64:this.rjc}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"NumberOfFinalPhrases",int64:this.pHb}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"Language",string:this.Co.QIa}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"connectionID",string:this.nVa}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Qr.dataFields,
Object.assign(new se.a,{name:"IsUsingFloatie",bool:this.Co.Rsa}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"UseAutoPunctuation",bool:this.Co.useAutoPunctuation}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"EndReason",string:this.gIh}));this.S2c&&Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"TimeToGetFirstResult",int64:this.S2c-this.gVe}));this.Lyb&&(Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"TimeToStartRecording",int64:this.H4e-this.Mm})),
Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"TimeToOpenConnection",int64:this.gVe-this.H4e})));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"FocusLost",bool:this.WIh}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"FocusLostWhileStarting",bool:this.XIh}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"FailedToStartTurn",bool:this.CIh}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"AverageFragmentLatency",double:this.N8a?this.N8a.lMm():
0<this.rjc?this.Zrd/this.rjc:0}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"AveragePhraseLatency",double:this.N8a?this.N8a.Ltl():0<this.pHb?this.asd/this.pHb:0}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"AveragePhraseInsertionLatency",double:0<this.pHb?this.tVh/this.pHb:0}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"AverageFragmentInsertionLatency",double:0<this.rjc?this.Ecl/this.rjc:0}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"MaxTimeToInsertFragment",
int64:this.v9g}));Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"MaxTimeToInsertPhrase",int64:this.w9g}));let ka=Ak.seen;this.Lyb&&0<this.Syb&&(ka=0<this.pHb?Ak.xEl:Ak.V7l);Array.add(this.Qr.dataFields,Object.assign(new se.a,{name:"DictationFunnel",contract:Object.assign(new Pk,{name:"Office.System.Funnel",dataFields:[Object.assign(new se.a,{name:"Name",string:"Dictation"}),Object.assign(new se.a,{name:"State",string:ka})]})}));this.Qr.name=this.a7g;this.Qr.samplingPolicy=2;$h.a.sendActivityEvent(this.Qr)}}
Object(m.a)(Vl,"DictationSessionTelemetry",Ck,[]);var Il=a(172);class Qk{constructor(ka,ib){this.t3c=ka;this.Mim=ib}getAccessToken(ka){this.Mim&&this.t3c?this.t3c.qN("OfficeDictation",u.AFrameworkApplication.ga.La("DictationResourceID")).then(ib=>{ib.IsSuccess?ka(ib.Token):ka(Qk.lxi)}).catch(()=>{ka(Qk.lxi)}):ka(Qk.lxi)}}Qk.lxi="dictation access token";Object(m.a)(Qk,"AuthenticationProvider",null,[]);class oa{constructor(ka){this.Qim=ka;this.aah=new Rj.a}debugAssertTag(ka,ib,Rb,tc){this.nAh(tc);this.aah.debugAssertTag(ka,
ib,Rb,tc)}debugTraceTag(ka,ib,Rb,tc){this.nAh(tc);this.aah.debugTraceTag(ka,ib,Rb,tc)}sendTraceTag(ka,ib,Rb,tc){this.nAh(tc);this.aah.sendTraceTag(ka,ib,Rb,tc)}shipAssertTag(ka,ib,Rb,tc){this.nAh(tc);this.aah.shipAssertTag(ka,ib,Rb,tc)}nAh(ka){if(this.Qim){const ib=window.console;ib&&ib.log(String.format("FDSpeechService: {0}",ka))}}}Object(m.a)(oa,"FrontdoorExternalLogger",null,[173]);class Ia{constructor(){this.accessToken=null}}Object(m.a)(Ia,"IAuthenticationProvider",null,[]);class Db{constructor(){this.customEndpointConfig=
this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(m.a)(Db,"ISpeechConfig",null,[]);class Vb{constructor(ka,ib,Rb,tc,xc){this.OM=this.aye=null;this.lUh=!1;this.$eb=new Xg(Rb,tc);this.$Ra=ka;this.Co=ib;this.Tfm=new Qk(xc,ib.m4m);this.Co.VQf&&(ka=new lk(ib),(ib=Rc.App.ecb)&&ib.UXl(ka))}TAl(ka,
ib){return new Promise(Rb=>{this.Tfm.getAccessToken(tc=>{Rb(this.I1m(ka,ib,tc))})})}I1m(ka,ib,Rb){this.OM=ib;ka=this.vmf(ka);Rb=Object.assign(new Ia,{accessToken:Rb});ib=new oa(this.Co.tkh);this.aye=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(ka,this.$eb,Rb,null,ib);return this.aye?0:(n.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}Upe(ka){if(!this.aye)return 3;this.$eb.Zed(this.OM,ka);this.aye.startSpeechRecognition();return 0}QQa(ka){if(!this.lUh){this.lUh=
!0;if(this.aye)try{this.aye.stopSpeechRecognition()}catch(ib){n.ULS.shipAssertTag(593277727,394,!1,ib.message)}if(ka&&this.$eb)this.$eb.onSpeechEnd();this.OM=null;this.lUh=!1}}tna(){return this.$eb.tna()}vmf(ka){const ib=new Db;ib.speechMode="Dictation";ib.sourceLanguage=ka;(ka=this.Co.Xsl)&&""!==ka&&(ib.speechFDBase=String.format("wss://{0}/",ka));ib.properties=new Map;this.$Ra&&(ib.properties.set("DictationInsertionPointLeft",this.$Ra.QXi()),ib.properties.set("DictationInsertionPointRight",this.$Ra.bxl()));
ib.properties.set("Corrections","true");ib.properties.set("punctuation",this.Co&&this.Co.useAutoPunctuation?"Intelligent":"Explicit");this.Co.tkh&&ib.properties.set("EnableAudioLogging",this.Co.tkh.toString());switch(Il.a.w4h){case "Word":ib.clientApp=1;break;case "PowerPoint":ib.clientApp=0;break;case "OneNote":ib.clientApp=2}return ib}}Object(m.a)(Vb,"FrontdoorSpeechClientProxy",null,[1216]);var Ic=a(167);class Pc{static hPn(){Pc.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage)}static yPn(){Pc.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,
Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage)}static eQn(ka){Pc.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,ka)}static MQn(){Pc.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}static showDialog(ka,ib){Pc.zh||(Pc.zh=new P.a,Pc.zh.zz=u.AFrameworkApplication.vEa,Pc.zh.gf=0,Pc.zh.Fg(1,CommonUIStrings.l_DialogClose),Pc.zh.m7(ka,ib,()=>{Pc.zh=null}))}}Pc.zh=null;Object(m.a)(Pc,"Dialogs",null,[]);class bd{constructor(ka,
ib,Rb,tc,xc,hd,Fd,Td){this.sxe=this.mye=!1;this.q2=null;this.$Ra=ka;this.DBl=ib;this.ya=Rb;this.v2c=tc;this.Co=xc;this.L8a=hd;this.bVe=Fd;this.Iyb=Td;this.Dal=new Ic.a;for(ka=0;ka<bd.Cal.length;ka++)this.Dal.add(bd.Cal.charAt(ka).toString())}onFinalPhrase(ka,ib=null){let Rb=!0;if(this.q2)this.q2.onFinalPhrase(ka);if(this.bVe&&this.L8a){var tc=this.bVe.k5n(ka);if(tc){this.jtc(!1);this.L8a.executeCommand(tc.commandId,null);return}}tc=(new Date).getTime();if(1===ka.length&&"\n"===ka)this.n2i("",null),
this.Fql();else{let xc=ka.indexOf("\n");for(0<xc&&xc!==ka.length-1&&(Rb=!1);0<=xc;)this.n2i(ka.substr(0,xc),Rb?ib:null),this.Fql(),ka=ka.substr(xc+1),xc=ka.indexOf("\n"),Rb=!1;this.n2i(ka,Rb?ib:null)}ka=(new Date).getTime();if(this.q2)this.q2.onTextInserted(!0,ka-tc)}onFragment(ka){if(this.mye)var ib=this.qih(ka);else{if(!this.HWg())return;ib=this.sxe?this.qih(ka):ka}if(this.q2)this.q2.onFragment(ka);ka=!0;const Rb=(new Date).getTime();this.$Ra&&!this.$Ra.Hgl(ib)&&(this.hyl(),ka=!1);ib=(new Date).getTime();
if(this.q2)this.q2.onTextInserted(!1,ib-Rb);ka&&this.L8a&&this.L8a.b5n()}onRecordingStarted(){this.ya.Cb(X.a.Mui,2);if(this.q2)this.q2.onRecordingStarted()}onMicrophoneError(ka=""){this.uyl(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,ka)}GIe(ka){if(this.q2)this.q2.onCustomError(ka);this.ya.Qa(X.a.Gui,2,ka)}Inn(ka){this.GIe(ka);Pc.hPn()}Qon(ka){this.GIe(ka);Pc.yPn()}Lsn(ka){this.GIe(ka);Pc.MQn()}jN(ka){this.q2&&this.q2.setEndReason(ka);this.ya.Qa(X.a.Lui,2,ka)}oqn(ka){this.jN(ka);this.CQn()}Arn(){this.jtc(!1);
this.ya.Cb(X.a.Nui,2)}onConnectionStarted(ka){if(this.q2)this.q2.onConnectionStarted(ka)}x_j(ka){this.uyl(this.vQm(ka),ka)}onFocusLost(){if(this.q2)this.q2.onFocusLost();this.ya.Cb(X.a.Iui,2)}I6m(ka){return this.DBl&&!ra.a.Blh(ka)&&!this.Dal.contains(ka.toString())}qih(ka){return 0<ka.length&&this.I6m(ka.charAt(0))?" "+ka:ka}HWg(){if(this.mye)return!0;if(this.$Ra){const ka=this.$Ra.QXi();this.sxe=!1;ka&&0<ka.length&&(this.sxe=!ra.a.Blh(ka.charAt(ka.length-1))&&!ka.endsWith("\u201c"));return this.mye=
this.$Ra.HWg()}if(this.q2)this.q2.onFailedToStartTurn();this.L8a&&this.L8a.d5n();return!1}jtc(ka){this.sxe=this.mye=!1;this.$Ra&&(ka&&this.$Ra.QNl(),this.$Ra.jtc())}onSpeechSessionStarted(ka){if(this.q2)this.q2.onSpeechSessionStarted(ka);this.Co.tkh&&this.kxh(ka)}uyl(ka,ib=""){if(this.q2)this.q2.onMicrophoneError(ib);this.ya.Cb(X.a.Jui,2);Pc.eQn(ka)}vQm(ka){ka=ka.trimStart();return ka.startsWith("NotAllowedError")||ka.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:
ka.startsWith("NotFoundError")||ka.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:ka.startsWith("NotReadableError")||ka.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}CQn(){this.v2c&&this.v2c.execute(ka=>{ka.F4l(Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage)})}kxh(ka){this.v2c&&this.v2c.execute(ib=>
{ib.kxh(String.format("ServiceSessionID:{0} ClientSessionId: {1}",ka,this.$xm))})}n2i(ka,ib){if(this.mye||this.HWg()){if(this.$Ra){const Rb=this.sxe?this.qih(ka):ka;(this.Co.VQf&&Object(Kd.a)(1217,this.$Ra)?this.$Ra.b4n(Rb,ib,0<ka.length&&ka.charAt(0)!==Rb.charAt(0)):this.$Ra.$Al(this.sxe?this.qih(ka):ka))||this.hyl()}this.jtc(!0)}}hyl(){if(this.q2)this.q2.onTextInsertionError();this.ya.Cb(X.a.Pui,2)}Fql(){this.ya.Cb(X.a.QA,2)}get $xm(){return Rc.App.hJa?Rc.App.hJa.jec:""}}bd.Cal='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d';
Object(m.a)(bd,"SpeechClientObserverController",null,[]);class qd{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb,Xb){this.clc=null;this.OTh=new Map;this.bVe=this.L8a=this.Iyb=this.OM=null;this.LW=ka;this.Zgm=ib;this.Nc=Rb;this.v2c=tc;this.Un=xc;this.Co=hd;this.t3c=Fb;this.Nbl=Xb;this.Co.Rsa&&(this.Iyb=Fd);if(this.Co.dCl||this.Co.Mue)this.L8a=Td;this.Co.dCl&&(this.bVe=na);this.rwe=$a}Upe(ka){this.v2c&&this.v2c.execute(tc=>{tc.fzl()});const ib=this.Zgm.value,Rb=null!==ka&&void 0!==ka?ka:"Box4.Dictation.IDictationHost";
return new Promise((tc,xc)=>{this.OTh.has(Rb)?(this.clc=this.OTh.get(Rb),this.Jql(tc,xc)):this.q9m().then(()=>{if(ib){const hd=ib.IAm(Rb);this.clc=this.uCm(hd);this.OTh.set(Rb,this.clc);this.Jql(tc,xc)}else xc(4)}).catch(()=>{xc(2)})})}Jql(ka,ib){this.Zed().then(Rb=>{0===Rb?ka(0):ib(Rb)}).catch(Rb=>{ib(Rb)})}Zed(){return new Promise((ka,ib)=>{this.OM=new Vl(this.Co,this.Un);if(this.Co.Nzh||this.Co.Mue)this.OM=new vl(this.Co,this.Un);this.clc.TAl(this.Co.QIa,this.OM).then(Rb=>{0!==Rb?ka(Rb):ka(this.clc.Upe(this.pEl()))}).catch(Rb=>
{ib(Rb)})})}q9m(){return this.Co.Nzh||this.Co.Mue?this.eFl("alVoiceClient",!0):this.eFl("PPTSpeechClient")}eFl(ka,ib=!1){return!ib&&this.Nbl&&u.AFrameworkApplication.Ea.Kb.Hij?(ib=u.AFrameworkApplication.xh(ka,2),ge.a(this.Nbl.Jbc(ib))):this.LW?this.LW.loadScript(ka):new Promise((Rb,tc)=>{tc("Unable to load speech client "+ka)})}QQa(ka=!0){0!==this.tna()&&(this.clc&&this.clc.QQa(ka),this.OM&&(this.OM.endActivity(),this.OM=null))}tna(){return this.clc?this.clc.tna():0}pEl(){return"zh-CN"!==this.Co.QIa&&
"ja-JP"!==this.Co.QIa}uCm(ka){const ib=new bd(ka,this.pEl(),u.AFrameworkApplication.vb,this.v2c,this.Co,this.L8a,this.bVe,this.Iyb);return this.Co.Nzh||this.Co.Mue?new Ql(this.Iyb,this.L8a,2,this.Nc,this.rwe,ib,this.Co):new Vb(ka,this.Co,this.Iyb,ib,this.t3c)}}Object(m.a)(qd,"DictationManager",null,[]);class td{constructor(){this.fal=[];this.Gfd=this.HSh=""}startSession(){this.HSh=Mc.a.create().toString();this.fal=[]}endSession(){this.HSh=""}get jec(){return this.HSh}get ITl(){return this.fal}}Object(m.a)(td,
"DictationSessionInfo",null,[1168]);class Nd{constructor(ka,ib,Rb){this.oWh=this.f8e=this.jWh=this.b8e=!1;this.D2c="";this.Ba=ka?ka:u.AFrameworkApplication.ga;this.Myb=ib;this.Nc=Rb}get useAutoPunctuation(){if(!this.Rsa||!this.Jfj)return!1;if(this.jWh)return this.b8e;const ka=Ad.a.instance.getItem("WACDictationFUseAutoPunctuation");this.b8e=void 0===ka||null===ka?this.Ba.getBooleanAppSetting("DictationAutoPunctuationEnglishDefaultOnIsEnabled")?Array.contains(Zi.otm,this.QIa):!1:Boolean.parse(ka);
this.jWh=!0;return this.b8e}set useAutoPunctuation(ka){this.Rsa&&this.Jfj&&(this.b8e=ka,this.jWh=!0,Ad.a.instance.setItem("WACDictationFUseAutoPunctuation",this.b8e.toString()))}get lPe(){if(!this.Rsa||!this.urj)return!1;if(this.oWh)return this.f8e;const ka=Ad.a.instance.getItem("WACDictationFloatieUseVoiceCommands");this.f8e=void 0===ka||null===ka?!0:Boolean.parse(ka);this.oWh=!0;return this.f8e}set lPe(ka){this.Rsa&&this.urj&&(this.f8e=ka,this.oWh=!0,Ad.a.instance.setItem("WACDictationFloatieUseVoiceCommands",
this.f8e.toString()))}get Jfj(){return Array.contains(Zi.ptm,this.QIa)}get urj(){return this.Mue&&Array.contains(Zi.K_n,this.QIa)}get QIa(){""===this.D2c&&(this.D2c=this.PNm());return this.D2c}set QIa(ka){ka&&(this.D2c=ka)}get VQf(){return this.Rsa}get Rsa(){return this.Ba.getBooleanAppSetting("WacBox4DictationFloatieIsEnabled")}get dZn(){return this.Ba.getBooleanAppSetting("WacBox4DictationInternalArticle")}get Xsl(){return this.Ba.La("DictationFrontdoorDomain")}get Nzh(){return this.Ba.getBooleanAppSetting("WacBox4DictationUseAugloopService")}get dCl(){return this.Ba.getBooleanAppSetting("WacBox4DictationCommandsIsEnabled")&&
this.Rsa}get Mue(){return this.Ba.getBooleanAppSetting("WacBox4DictationUseAugloopServiceWithFrontdoor")}get m4m(){return this.Ba.getBooleanAppSetting("WacDictationAuthenticationEnabled")}get tkh(){return this.Ba.getBooleanAppSetting("DictationDebugModeEnabled")}get fWl(){return this.getSupportedLanguages(0)}get EVl(){return this.getSupportedLanguages(1)}get n4m(){return Gb.a.oNk&&this.Ba.getBooleanAppSetting("UserCanUseDictation")}getSupportedLanguages(ka){const ib=[];ka=0===ka?Zi.productionLanguages:
Zi.previewLanguages;for(const Rb of ka)Array.add(ib,new Sj(Rb));ib.sort((Rb,tc)=>Rb.displayName.localeCompare(tc.displayName));return ib}PNm(){if(this.Myb&&this.Nc){const ka=this.Myb.HCe(this.Nc.Wj);for(const ib of this.fWl)if(ib.LCID===ka)return ib.Glh;for(const ib of this.EVl)if(ib.LCID===ka)return ib.Glh}return Zi.nDm}}Object(m.a)(Nd,"DictationSettings",null,[]);class Zd{constructor(){this.R5k=this.Ha=null}get name(){return"Box4.Dictation"}lc(ka){this.Ha=ka;const ib=Mb.a.instance.yb("Common.IDynamicScriptLoaderProvider");
let Rb=null;ib&&(Rb=ib.LW);const tc=Mb.a.instance.ge("Box4.Dictation.IDictationHostFactory");this.Ha.register(Nd,"Box4.Dictation.DictationSettings").ma().na(()=>new Nd(this.Ha.resolve("Common.IAppSettingsManager"),this.Ha.resolve("Box4.ILanguageReader"),this.Ha.resolve("Box4.ISelectionManager")));const xc=Mb.a.instance.ge("Common.IDictationFloatieController");this.Ha.register(nl,"Box4.Dictation.DictationFloatieManager").ma().na(()=>new nl(xc,this.Ha.resolve("Box4.Dictation.DictationSettings")));this.Ha.register(qd,
"Box4.Dictation.DictationManager").ma().na(()=>new qd(Rb,tc,this.Ha.resolve("Box4.ISelectionManager"),ka.Na("Box4.IBusinessBarController"),ka.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Ha.resolve("Box4.Dictation.DictationSettings"),this.Ha.resolve("Box4.Dictation.DictationFloatieManager"),this.Ha.yb("Box4.DictationCommands.IDictationCommandManager"),this.Ha.yb("Box4.DictationCommands.IDictationCommandParser"),this.Ha.yb("Box4.DictationCommands.IDictationCommandsTelemetry"),
this.Ha.resolve("Common.App.OAuth.IOAuthManager"),this.Ha.resolve("Common.ISharedDependencyLoader")));this.Ha.register(1168,"Box4.Dictation.IDictationSessionInfo").ma().na(()=>new td)}init(){this.Ha.resolve("Box4.Dictation.IDictationSessionInfo");this.R5k=Ei.createInstance(this.Ha.ge("Common.IRibbonButtonUpdater"),this.Ha.resolve("Box4.Dictation.DictationManager"),this.Ha.resolve("Box4.IFormattingEditor"),this.Ha.resolve("Box4.IFormattingReader"),this.Ha.resolve("Box4.Dictation.DictationFloatieManager"),
this.Ha.resolve("Box4.Dictation.DictationSettings"),this.Ha.ge("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Yb.FocusManager.instance());this.R5k.Hb();Rc.App.Vb.Zf()}dispose(){}}Object(m.a)(Zd,"DictationPackageManager",null,[3,4]);class Sd{constructor(ka){this.$=ka}IAm(ka){return this.$.resolve(ka)}}Object(m.a)(Sd,"DictationHostFactory",null,[1166]);class qe{constructor(ka,ib,Rb){this.WTa=null;this.Lga=this.LTa=-1;this.DGe=!1;this.xH=ka;this.pa=ib;this.ia=Rb}QXi(){return this.cxl(!1)}bxl(){return this.cxl(!0)}HWg(){this.WTa&&
this.jtc();const ka=this.pa.Ua.mb;if(ka){const ib=ka.Xa;if(ib&&Me.ParagraphReader.me(ib.node))return this.WTa=ib.node,this.Lga=ka.Xa.e9a,this.LTa=ka.Xa.sJb,this.DGe=!0}return!1}jtc(){this.WTa=null;this.DGe=!1;this.LTa=this.Lga=-1}Hgl(ka){if(this.WTa){const ib=new Pe.GraphTransaction(15);try{ib.hd(this.WTa);const Rb=this.DGe&&this.Lga!==this.LTa?jc.a.createTextRange(this.WTa,this.Lga,this.LTa):jc.a.yj(this.WTa,this.LTa);this.xH.replaceTextRange(Rb,ka);this.LTa=this.DGe?this.Lga+ka.length:this.LTa+
ka.length;const tc=Kh.SelectionFactory.Ig(this.WTa,this.LTa);this.pa.setSelection(tc);this.DGe=!1;return!0}finally{ib&&ib.dispose()}}return!1}$Al(ka){if(this.WTa){const ib=new Pe.GraphTransaction(15);try{ib.hd(this.WTa);const Rb=this.Lga!==this.LTa?jc.a.createTextRange(this.WTa,this.Lga,this.LTa):jc.a.yj(this.WTa,this.LTa);this.xH.replaceTextRange(Rb,ka);this.LTa=this.Lga+ka.length;const tc=Kh.SelectionFactory.Ig(this.WTa,this.LTa);this.pa.setSelection(tc);this.DGe=!1;return!0}finally{ib&&ib.dispose()}}return!1}QNl(){var ka=
this.hOm();this.ia&&ka&&ka.e9a!==ka.sJb&&0<=ka.e9a&&(ka=jc.a.createTextRange(ka.node,ka.e9a,ka.sJb),this.ia.Qa(X.a.Kui,2,ka))}hOm(){return this.WTa?this.Lga!==this.LTa?jc.a.createTextRange(this.WTa,this.Lga,this.LTa):jc.a.yj(this.WTa,this.LTa):null}cxl(ka){var ib=this.pa.Ua.mb;if(ib){var Rb=ib.Xa;if(Rb&&(ib=Rb.node,Me.ParagraphReader.me(ib)&&(Rb=ka?Rb.sJb:Rb.e9a,ib=Me.ParagraphReader.text(ib),Rb<=ib.length)))return ka?ib.substring(Rb,ib.length):ib.substring(0,Rb)}return""}}Object(m.a)(qe,"DictationHost",
null,[1165]);class Xe{get name(){return"PowerPointWebEditor.Dictation"}lc(ka){ka.register(Sd,"PowerPointWebEditor.Dictation.DictationHostFactory").as("Box4.Dictation.IDictationHostFactory").ma().na(()=>new Sd(ka));ka.register(qe,"PowerPointWebEditor.Dictation.DictationHost").as("Box4.Dictation.IDictationHost").ma().na(()=>new qe(ka.resolve("Box4.ICharacterPropertiesEditor"),ka.resolve("Box4.ISelectionManager"),u.AFrameworkApplication.vb))}init(){}dispose(){}static main(){L.a.instance.Fc(new Xe)}}
Object(m.a)(Xe,"PPTWebEditorDictationPackage",null,[3,4]);var Te=a(707);class af{constructor(ka,ib,Rb=null){this.id=ka.Id;Rb||(Rb="");this.rDn=Rb;this.sensitivityLabel=ka}}Object(m.a)(af,"AutoPolicyLabelData",null,[]);class nf{constructor(ka,ib){this.Tfb=ka;this.displayName=ib}}Object(m.a)(nf,"PolicyLabelRequestState",null,[]);class mf{constructor(){this.zwk=this.UWj=""}}Object(m.a)(mf,"PolicyStrings",null,[]);class Mf extends Ta.a{constructor(ka,ib){super(!1,!1,!0);this.DZ=null;this.g7g=!1;this.cXl=
Rb=>{let tc="";1===Rb&&this.DZ&&(tc=this.DZ);this.BZ(Rb,this.ySh,tc)};this.uqn=Rb=>{this.DZ=Rb;Rb=this.validate();this.g7g!==Rb&&(this.g7g=Rb,this.o8a(Object(Y.a)("SensitivityJustificationTitle"),this.cXl,this.hwl(this.g7g)))};this.ySh=ka;this.BZ=ib;this.uk=Mf.id;this.Fg(1,Object(Y.a)("DialogChange"));this.l_(1,!1);this.uvb(0)}BIk(){this.Dq(Object(Y.a)("SensitivityJustificationTitle"),this.cXl,this.hwl(this.g7g))}hwl(ka){return{["id"]:this.uk,["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:Object(Y.a)("SensitivityJustificationPlaceholder")}},
["actionButtonProps"]:{["label"]:Object(Y.a)("DialogChange"),["disabled"]:!ka},["infoMessage"]:Object(Y.a)("SensitivityJustificationMessage"),["justificationIrrelevantLabel"]:Object(Y.a)("SensitivityJustificationNoLongerApplies"),["justificationIncorrectLabel"]:Object(Y.a)("SensitivityJustificationIncorrect"),["justificationOtherLabel"]:Object(Y.a)("SensitivityJustificationOther"),["onJustificationUpdated"]:this.uqn}}static get t1c(){return u.AFrameworkApplication.Ea.Kb.XV&&u.AFrameworkApplication.Ea.Kb.alh}}
Mf.id="JustificationDialog";Object(m.a)(Mf,"JustificationDialog",Ta.a,[]);class Mg extends Ta.a{constructor(ka,ib,Rb){super(!1,!1,!0);this.ufn=(xc,hd)=>{1===xc&&hd.selectedLabel&&(xc=hd.selectedLabel,""!==xc&&this.Wgm(xc))};if(ka&&Rb){var tc={["id"]:"MandatoryLabellingDialog"};this.Wgm=Rb;this.gNh=ib;if(!u.AFrameworkApplication.ga.getBooleanAppSetting("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.gNh&&""!==this.gNh)ib={["href"]:this.gNh,["target"]:"_blank"},tc.learnMoreLink={["type"]:"AppLinkProps",
["id"]:"mandatoryLabellingLearnMoreLink",["text"]:Object(Y.a)("LearnMore"),["handler"]:ib,["customTooltip"]:Object(Y.a)("LearnMoreTooltip")};ib={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(ib.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:ka});tc.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:ib};ka={["id"]:"MandatoryLabellingDialog",["bodyControls"]:tc};
tc.initialLabelText=Object(Y.a)("MandatoryLabellingDialogInitialLabelText");tc.descriptionText=Object(Y.a)("MandatoryLabellingDialogDescriptionText");this.Dq(Object(Y.a)("MandatoryLabellingDialogBusinessBarTitle"),this.ufn,ka)}else n.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}}Object(m.a)(Mg,"MandatoryLabellingDialog",Ta.a,[]);class Sf{constructor(){this.Nua=!!u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.Kb.XV}mBm(ka,ib,Rb){this.Nua&&new Mg(ka,
ib,Rb)}static get instance(){return Sf.Wa||(Sf.Wa=new Sf)}}Sf.Wa=null;Object(m.a)(Sf,"MandatoryLabellingDialogFactory",null,[1211]);class Kf{}Kf.wSn="sbProtectForm14";Kf.ySn="SBStatusBarMarkAsReadOnly14";Kf.P8m="Info_16x16x32";Kf.Cjl="QuickSearchCompletedToday_16x16x32";Kf.bik="CommonControlCheckboxCheck_16";Kf.I7l="On";Kf.visible="Visible";Kf.NJm="ImageIsVisible";Kf.Bw="SourceControlId";Kf.menuItemId="MenuItemId";Kf.menu="Menu";Kf.vgl="AppLockId";Kf.value="Value";Kf.labelText="LabelText";Kf.alt=
"Alt";Kf.tAl="Image16by16";Kf.DAb="Image16by16Class";Kf.vSn="SBProtectForm_16";Kf.xSn="SBStatusBarMarkAsReadOnly_16";Kf.icon="Icon";Kf.iconColor="IconColor";Kf.customTooltip="CustomTooltip";Kf.VCn="MipTagDynamicFillWithOutline_20";Kf.WCn="MipTagLockDynamicFillWithOutline_20";Kf.UCn="MipTagErrorOutline_20";Kf.XCn="MipTagQuestionOutline_20";Kf.Yyh="transparent";Kf.nWn="UILocation";Object(m.a)(Kf,"PolicyConstants",null,[]);class fh extends Ta.a{constructor(ka,ib,Rb){super(!1,!1,fh.t1c);this.xZn=tc=>
{1!==tc&&this.BZ(tc,this.ySh,"",this.DZ)};this.ySh=ka;this.DZ=ib;this.BZ=Rb;this.gf=1;this.uk=fh.id;this.uvb(1);this.uvb(0)}HJk(){const ka={["id"]:"UserDefinedPermissionsDialog"};fh.t1c&&this.Dq("Defined Permissions",this.xZn,ka)}static get t1c(){return u.AFrameworkApplication.Ea.Kb.XV&&u.AFrameworkApplication.Ea.Kb.alh}}fh.id="UserDefinedPermissionsDialog";Object(m.a)(fh,"UserDefinedPermissionsDialog",Ta.a,[]);var xh=a(852),Qg=a(36);const th=ka=>{var ib;return ka?ka.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnablePolicyPackageRefactoring",
!1):null===(ib=u.AFrameworkApplication.ga)||void 0===ib?void 0:ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnablePolicyPackageRefactoring",!1)};class Hh{constructor(ka,ib,Rb,tc){this.P0e=this.Kic=null;this.YLh=this.rMh=this.o0e=this.N8k=this.C9k=this.ZGh=!1;this.uwe=this.Dgc=this.J9b=this.r2c=this.DZ=this.V8a=this.z3c=this.JGb=null;this.Egm=this.EEh=0;this.FIh=this.C8k=this.H4k=this.lQh=null;this.RDn=()=>{this.YLh&&!this.ukh()&&(this.YLh=!1,this.zu.value.QDn())};this.tfn=xc=>{this.tAi(this.E9k[xc])};
this.Eck=()=>{if(!this.zu.value.ADl()){var xc=this.Cca[this.wv.AppliedPolicyId];this.o0e&&this.r2c&&this.uwe!==this.r2c.id&&(!xc||xc.Order<this.r2c.sensitivityLabel.Order)&&(xc=this.ued(this.r2c.id,{},4),32!==xc?n.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+xc):(this.uwe=this.r2c.id,this.Dgc&&(xc=this.Cca[this.Dgc])&&xc.Order<=this.r2c.sensitivityLabel.Order&&(this.zu.value.Odc(29),this.Dgc=null)));xc=this.Cca[this.wv.AppliedPolicyId];
if(this.J9b&&this.Dgc!==this.J9b.id&&(!xc||xc.Order<this.J9b.sensitivityLabel.Order)){const hd=this.J9b.id;this.zu.value.Odc(29);xc=th(this.Ba)?this.zu.value.Oac(this.J9b.sensitivityLabel):this.Oac(this.J9b.sensitivityLabel);this.zu.value.v9e(29,Object(Y.a)("PolicyBusinessBarTitle"),String.format(Object(Y.a)("PolicyLabelRecommendationMessage"),xc)+" "+this.J9b.rDn,Object(Y.a)("PolicyLabelRecommendationButton"),()=>{this.ued(hd,{},8)});this.Dgc=this.J9b.id}this.J9b=this.r2c=null}};this.Bzm=(xc,hd,
Fd,Td)=>{1===xc&&this.CXc(hd,Td)};this.Azm=(xc,hd,Fd)=>{1===xc?this.xlh()?(this.DZ=Fd,this.ued(hd,null,2)):this.CXc(hd===this.wv.AppliedPolicyId?"":hd,Fd):this.jo.Zf()};this.Ttm=xc=>{1===xc&&this.zu.value.BCn()};this.Oeh=()=>32;this.Msn=(xc,hd)=>{hd.vw&&this.Cca&&(xc=this.Cca[this.wv.AppliedPolicyId])&&(this.Dgc&&(hd=this.Cca[this.Dgc])&&hd.Order<=xc.Order&&(this.zu.value.Odc(29),this.Dgc=null),this.uwe&&this.uwe!==xc.Id&&(this.zu.value.Odc(28),this.uwe=null))};this.ya=ka;this.jo=ib;this.Ba=Rb;this.zu=
tc;this.n2e={};this.ial={};this.E9k={};this.ikh=Rb.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled");this.zu.value.J1h(this.Eck);this.zu.value.qfl(this.Eck);this.zu.value.Y9b(this.Msn);u.AFrameworkApplication.Ea&&u.AFrameworkApplication.Ea.PM(this.RDn);Rb.getBooleanAppSetting("SupportsPolicies")&&Rb.La("AppliedPolicyId")&&(this.Kic=Rb.La("IrmPolicyTitle"),this.P0e=Rb.La("IrmPolicyDescription"));this.Ufm=this.Ba.Jc("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.Vfm=this.Ba.Jc("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",
5E3)}get R$a(){return u.AFrameworkApplication.R$a||!!this.C8k&&this.C8k()}Hb(){this.ya.za(ba.a.fsh,I.a.frame,this.Oeh);this.ya.sa(ba.a.Phe,I.a.frame,Object(K.a)(this,this.Phe,"queryPolicyLabel"),96);this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.ya.za(ba.a.rSl,I.a.frame,this.Oeh),this.ya.sa(ba.a.VGg,I.a.frame,Object(K.a)(this,this.VGg,"queryPolicyShortLabel"),96));this.ya.za(ba.a.rse,I.a.frame,Object(K.a)(this,this.rse,"toggleSensitivity"));this.ya.za(ba.a.Dee,
I.a.frame,Object(K.a)(this,this.Dee,"populateSensitivityFlyout"));this.ya.za(ba.a.IXc,I.a.frame,Object(K.a)(this,this.IXc,"setSensitivity"));this.ya.sa(ba.a.$Gg,I.a.frame,Object(K.a)(this,this.$Gg,"querySensitivity"),96);this.ya.za(ba.a.rTc,I.a.frame,Object(K.a)(this,this.rTc,"querySensitivityToggleButton"));this.ya.za(ba.a.fdd,I.a.frame,Object(K.a)(this,this.fdd,"querySensitivitySubFlyout"));this.Y8e(ba.a.rse)||this.ya.ue(ba.a.rse,4);this.Y8e(ba.a.Dee)||this.ya.ue(ba.a.Dee,4);this.Y8e(ba.a.IXc)||
this.ya.ue(ba.a.IXc,4);this.Y8e(ba.a.rTc)||this.ya.ue(ba.a.rTc,4);this.Y8e(ba.a.fdd)||this.ya.ue(ba.a.fdd,4);this.jo.Zf();u.AFrameworkApplication.ga&&wc.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.zu.value.YFn(Object(K.a)(this,this.JXl,"registerActionsHandler"))}JXl(){this.Hb()}Z8l(){this.ya.h_(ba.a.fsh,I.a.frame,this.Oeh);this.ya.h_(ba.a.Phe,I.a.frame,Object(K.a)(this,this.Phe,"queryPolicyLabel"));this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",
!1)&&(this.ya.h_(ba.a.rSl,I.a.frame,this.Oeh),this.ya.h_(ba.a.VGg,I.a.frame,Object(K.a)(this,this.VGg,"queryPolicyShortLabel")));this.ya.h_(ba.a.rse,I.a.frame,Object(K.a)(this,this.rse,"toggleSensitivity"));this.ya.h_(ba.a.Dee,I.a.frame,Object(K.a)(this,this.Dee,"populateSensitivityFlyout"));this.ya.h_(ba.a.IXc,I.a.frame,Object(K.a)(this,this.IXc,"setSensitivity"));this.ya.h_(ba.a.$Gg,I.a.frame,Object(K.a)(this,this.$Gg,"querySensitivity"));this.ya.h_(ba.a.rTc,I.a.frame,Object(K.a)(this,this.rTc,
"querySensitivityToggleButton"));this.ya.h_(ba.a.fdd,I.a.frame,Object(K.a)(this,this.fdd,"querySensitivitySubFlyout"))}rse(){return 32}Htl(ka){const ib="mandatoryLabelling_"+ka.Id;this.E9k[ib]=ka.Id;return{["type"]:"AppToggleButtonProps",["id"]:ib,["label"]:ka.DisplayName,["hideLabel"]:!1,["customTooltip"]:ka.Tooltip}}xlh(){return this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",!1)}wlj(){return this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",
!1)}get wv(){if(th(this.Ba))return this.zu.value.uD;this.JGb||(this.JGb=this.zu.value.uD);return this.JGb}get Cca(){return th(this.Ba)?this.zu.value.VVa:this.V8a}get Wce(){return th(this.Ba)?this.zu.value.O3e:this.z3c}pQm(){const ka=[];for(const Rb in this.Wce){var ib=this.Wce[Rb];const tc=this.Cca[Rb];if(tc&&tc.Enabled&&!tc.HasUserDefinedPermissions)if(ib.count){const xc={["sections"]:[],["shouldAutoOpen"]:!1},hd={["id"]:"mandatoryLabelling_flyoutMenuSection_"+tc.Id,["controls"]:[]};for(const Fd of ib)(ib=
this.Cca[Fd])&&ib.Enabled&&!ib.HasUserDefinedPermissions&&Array.add(hd.controls,this.Htl(ib));Array.add(xc.sections,hd);Array.add(ka,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+tc.Id,["label"]:tc.DisplayName,["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:xc})}else Array.add(ka,this.Htl(tc))}return ka}Dee(ka,ib,Rb,tc,xc){if(1===Rb||!this.zu.value.p9a(!0))return 32;xc.MenuItems=Object.assign(new Ld.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});
Array.add(xc.MenuItems.MenuSectionList,this.Vdh(!this.isReactRibbonEnabled()));this.wv.CustomUrl&&Array.add(xc.MenuItems.MenuSectionList,this.iBm(this.isReactRibbonEnabled()?this.wv.CustomUrl:ra.a.Re(this.wv.CustomUrl)));this.isReactRibbonEnabled()||(xc.PopulationXML=vk.l(xc.MenuItems));return 32}$Gg(ka,ib,Rb,tc,xc){if(1===Rb||!xc||!this.ikh)return 32;th(this.Ba)||(this.JGb=this.zu.value.uD);if(this.zu.value.p9a(!0)&&(xc[Kf.visible]=!0,this.N8k||(nb.a("MipLabelsAvailable"),this.N8k=!0),this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",
!1)&&this.wv.AreLabelsAvailable&&(ka=Mb.a.instance.Na("Common.ISystemInitiatedFeedback")))){let hd;hd=th(this.Ba)?this.wv.AppliedPolicyId?"LouderLabel_LabelExistsOnLoadActivity":"LouderLabel_NoLabelAppliedOnLoadActivity":Hh.rb(this.wv.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";ka.execute(Fd=>{Fd.logActivity(hd,null)})}return 32}rTc(ka,ib,Rb,tc,xc){if(1===Rb||!xc)return 32;let hd,Fd;xc[Kf.I7l]=!!(hd=xc[Kf.menuItemId])&&!!(Fd=this.n2e[hd])&&Fd===
this.wv.AppliedPolicyId;return 32}fdd(ka,ib,Rb,tc,xc){if(1===Rb||!xc)return 32;let hd,Fd,Td;ka=!!(hd=xc[Kf.Bw])&&!!(Fd=this.n2e[hd])&&!!(Td=this.Wce[Fd])&&Td.contains(this.wv.AppliedPolicyId);xc[Kf.NJm]=ka;xc[Kf.I7l]=ka;return 32}IXc(ka,ib,Rb,tc,xc){if(1===Rb||!xc)return 32;ka=this.n2e[xc[Kf.Bw]];ib=this.oWn(xc[Kf.nWn]);Rb=new se.a;Rb.name="SensitivityPickerLocation";Rb.int64=ib;nb.a("SensitivityPickerUsage",void 0,void 0,[Rb]);return this.ued(ka,xc,2)}ukh(){return!!u.AFrameworkApplication.Ea&&1===
u.AFrameworkApplication.Ea.mode}oVn(){this.wv.DefaultLabelId&&this.wv.MandatoryLabelingEnforced?this.ZGh||this.ukh()?this.wv.AppliedPolicyId?this.tAi(""):(this.zu.value.T5m(this.zu.value.ZWf)||this.ukh())&&this.Zpl():this.h2l():this.wv.DefaultLabelId?this.h2l():this.wv.MandatoryLabelingEnforced&&(this.wv.AppliedPolicyId?this.tAi(""):this.Zpl())}HCl(){return this.wv.MandatoryLabelingEnforced?this.wv&&this.wv.AreLabelsAvailable?this.Ba.getBooleanAppSetting("TestOverrideIsReactDialogEnabled")||this.jo&&
this.jo.Kb&&this.jo.Kb.XV?!0:(n.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(n.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(n.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}Zpl(){!this.HCl()||u.AFrameworkApplication.boa||this.C9k||(this.C9k=u.AFrameworkApplication.boa=!0,n.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),
this.zu.value.IWl("",1),this.zu.value.qZh(37,Object(Y.a)("MandatoryLabellingDialogBusinessBarTitle"),Object(Y.a)("MandatoryLabellingDialogDescriptionText"),Object(Y.a)("MandatoryLabellingDialogBusinessBarButton"),()=>{this.sfn()}))}tAi(ka){this.HCl()&&u.AFrameworkApplication.boa&&(u.AFrameworkApplication.boa=!1,n.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.zu.value.wnk(),this.zu.value.IWl(ka,2))}sfn(){Sf.instance.mBm(this.pQm(),this.wv.CustomUrl,this.tfn)}nhl(){return this.Ba.getBooleanAppSetting("CoAuthForProtectedFilesEnabled")&&
this.Ba.getBooleanAppSetting("SupportsOfficeClientCoauthoring")&&this.Ba.getBooleanAppSetting("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.FIh&&this.R$a}ued(ka,ib,Rb){this.zu.value.wCn(Rb);let tc=32,xc=!1,hd=!0;const Fd=this.Cca[ka],Td=2===Rb||8===Rb||16===Rb,na=ka===this.wv.AppliedPolicyId;if(this.H4k&&this.H4k(ka,Td))n.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",Rb),this.jo.Zf();else if(ib&&
Kf.vgl in ib&&this.zu.value.ZAk(ib[Kf.vgl]),ka)if(this.zu.value.ADl()||this.nhl()&&this.rMh)n.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",Rb),this.jo.Zf(),Td&&this.sbh(Object(Y.a)("SensitivityApplicationDialogErrorTitle"),Object(Y.a)("SensitivityQuickApplicationErrorMessage"));else if(this.Ba.getBooleanAppSetting("HasDocumentEditRights"))if(this.zu.value.zwm(ka))if(!this.xlh()&&(th(this.Ba)?null===Fd||
void 0===Fd?0:Fd.HasUserDefinedPermissions:this.V8a[ka]&&this.V8a[ka].HasUserDefinedPermissions)&&!na)n.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",Rb),1!==Rb&&4!==Rb&&this.Crm();else if(Td&&this.wv.MandatoryLabelingEnforced&&na)n.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",Rb),this.sbh(Object(Y.a)("MandatoryLabellingBlockLabelRemovalDialogTitle"),Object(Y.a)("MandatoryLabellingBlockLabelRemovalDialogDescriptionText"));
else{if(Td&&this.Ba.getBooleanAppSetting("WacLabelingJustificationDialogIsEnabled")&&this.wv.RequiredDowngradeJustification&&(na||(th(this.Ba)?null===Fd||void 0===Fd?0:Fd.RequiredDowngradeJustification:this.V8a[ka].RequiredDowngradeJustification))&&!this.DZ)return n.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",Rb),this.BIk(ka),tc;if(this.xlh()&&(th(this.Ba)?null===Fd||void 0===Fd?0:Fd.HasUserDefinedPermissions:this.V8a[ka].HasUserDefinedPermissions)&&
!na)return n.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",Rb),this.HJk(ka,this.DZ),tc;if(this.nhl()&&!this.FIh())this.EEh<this.Ufm?(n.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.EEh,Rb),this.rMh=!0,this.EEh++,oc.Task.delay(this.Vfm).continueWith(()=>{this.rMh=!1;this.ued(ka,ib,Rb)})):(n.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",
Rb),xc=1!==Rb,hd=!1,tc=8);else{if(this.A5m(ka)&&(n.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",Rb),1===Rb||8===Rb||4===Rb))return tc;n.ULS.sendTraceTag(570972056,306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",Rb);this.CXc(na?"":ka,this.DZ,Rb);return tc}}else n.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",Rb),this.jo.Zf(),
Td&&this.sbh(Object(Y.a)("SensitivityApplicationDialogErrorTitle"),Object(Y.a)("SensitivityCoauthApplicationErrorMessage"));else n.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",Rb),this.jo.Zf(),Td&&this.sbh(Object(Y.a)("SensitivityApplicationDialogErrorTitle"),Object(Y.a)("SensitivityNoEditRightsErrorMessage"));else n.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",
Rb),this.jo.Zf(),xc=Td,hd=!1,tc=8;this.zu.value.WWl(0,Rb,xc,hd);return tc}Lgl(ka,ib,Rb=null,tc=!1){Bb.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",uc.b.FailureBased,"wordclpfc",null);this.Ba.getBooleanAppSetting("SupportsOfficeClientCoauthoring")&&this.Ba.getBooleanAppSetting("CoAuthForProtectedFilesIsEnabled")?(this.o0e=!1,th(this.Ba)||(this.JGb=this.zu.value.uD),this.wv&&!this.wv.AppliedPolicyId?this.o0e=!0:this.wv&&this.wv.PolicyLabelAssignmentMethod&&(this.o0e=Qg.e(this.wv.PolicyLabelAssignmentMethod)===
Qg.e("standard"))):this.o0e=tc;th(this.Ba)?(ka=ka?this.Cca[ka]:null,ib=ib?this.Cca[ib]:null):(ka=Hh.rb(ka)?null:this.V8a[ka],ib=Hh.rb(ib)?null:this.V8a[ib]);ib?this.J9b=new af(ib,!0,Rb):(this.zu.value.Odc(29),this.Dgc=null);ka?this.r2c=new af(ka,!1):this.uwe=null;this.Eck(null,null)}zsm(ka){this.ued(ka,null,16)}dMn(){this.V8a={};th(this.Ba)||(this.JGb=this.zu.value.uD);if(this.wv)for(const ka of this.wv.SensitivityLabels)this.V8a[ka.Id]=ka}A5m(ka){if(!th(this.Ba)&&!this.z3c)return!1;if(ka in this.Wce){ka=
this.Wce[ka];for(const ib of ka)if((ka=this.Cca[ib])&&ka.Enabled)return!0}return!1}zMn(){this.z3c={};th(this.Ba)||(this.JGb=this.zu.value.uD);if(this.wv){for(const ka of this.wv.SensitivityLabels)ka.ParentId||(this.z3c[ka.Id]=new N.a);for(const ka of this.wv.SensitivityLabels)this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)?ka.ParentId&&ka.ParentId in this.z3c&&(this.V8a[ka.ParentId]&&(ka.ParentName=this.V8a[ka.ParentId].DisplayName),ka.Enabled&&
this.z3c[ka.ParentId].add(ka.Id)):ka.ParentId&&ka.ParentId in this.z3c&&ka.Enabled&&this.z3c[ka.ParentId].add(ka.Id)}}LBn(){th(this.Ba)||(this.JGb=this.zu.value.uD);const ka=this.ikh&&this.isReactRibbonEnabled()&&this.zu.value.p9a();Hh.Iuh(ka)}pEn(ka){this.FIh=ka}h2l(){if(this.Ba.getBooleanAppSetting("WacApplyDefaultPolicyLabelIsEnabled"))if(this.ukh())this.YLh=!0;else if(!this.ZGh&&(this.ZGh=!0,th(this.Ba)||(this.JGb=this.zu.value.uD),this.wv&&this.wv.DefaultLabelId))if(!this.wv.AppliedPolicyId)n.ULS.sendTraceTag(509732190,
306,50,"Default labeling triggered. DefaultLabelType: {0}",this.wv.DefaultLabelType),this.ued(this.wv.DefaultLabelId,null,1);else if(dj.a.Wn().equals(this.wv.DefaultLabelType,"documentLibraryDefault")){const ka=this.Cca[this.wv.AppliedPolicyId],ib=this.Cca[this.wv.DefaultLabelId];this.wv.AppliedPolicyId!==this.wv.DefaultLabelId&&dj.a.Wn().equals(this.wv.PolicyLabelAssignmentMethod,"standard")&&ka.Order<ib.Order&&(n.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",
this.wv.DefaultLabelType),this.ued(this.wv.DefaultLabelId,null,1))}}CXc(ka,ib,Rb=2){this.xlh()||(this.DZ=ib);this.zu.value.CXc(ka);this.jo.Zf();ib=this.Cca[ka];ib=th(this.Ba)?this.zu.value.Oac(ib):this.Oac(ib);Rb=new nf(Rb,ib);this.zu.value.PMe(ka,this.DZ,Rb)}BIk(ka){(new Mf(ka,this.Azm)).BIk()}HJk(ka,ib){(new fh(ka,ib,this.Bzm)).HJk()}sbh(ka="",ib=""){const Rb=new P.a;Rb.zz=u.AFrameworkApplication.vEa;Rb.gf=0;Rb.Fg(1,Object(Y.a)("DialogClose"));Rb.m7(ka,ib,null)}Crm(){const ka=new P.a;ka.zz=u.AFrameworkApplication.vEa;
ka.gf=1;ka.Fg(1,Object(Y.a)("OICDownLoadACopyDialogOpenButton"));ka.Fg(0,Object(Y.a)("DialogClose"));ka.m7(Object(Y.a)("SensitivityApplicationDialogErrorTitle"),Object(Y.a)("SensitivityBlockUDPSetLabelMessage"),this.Ttm)}isReactRibbonEnabled(){return!!this.jo&&!!this.jo.Kb&&this.jo.Kb.JD}I9c(){return this.jo&&this.jo.Kb?this.jo.Kb.I9c:!1}HMn(ka,ib,Rb,tc){ka?(tc[Kf.value]=ka,tc[Kf.labelText]=ka,tc[Kf.customTooltip]=ib,this.z2l(Rb,u.AFrameworkApplication.RA,tc)):(tc[Kf.iconColor]=Kf.Yyh,this.wv.MandatoryLabelingEnforced?
(tc[Kf.value]=tc[Kf.labelText]=this.Rhh().zwk,tc[Kf.icon]=Kf.UCn):(tc[Kf.value]=tc[Kf.labelText]=this.Rhh().UWj,tc[Kf.icon]=Kf.XCn));tc[Kf.visible]=!0}kMn(ka){let ib="",Rb="",tc="";if(this.wv.AreLabelsAvailable){let xc=null;this.Cca&&(xc=this.Cca[this.wv.AppliedPolicyId]);xc&&(ib=th(this.Ba)?this.zu.value.Oac(xc):this.Oac(xc),Rb=xc.Tooltip,this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",!1)||(u.AFrameworkApplication.RA=this.zu.value.WAb(xc)),tc=this.GKi(xc));
if(!this.zu.value.p9a()&&!xc)return}else{if(this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TitleBarSensitivityBufferEnabled",!1))ib=this.Kic?this.Kic:"";else{if(!this.Kic)return;ib=this.Kic}tc=Kf.Yyh;Rb=this.P0e?this.P0e:""}this.HMn(ib,Rb,tc,ka)}Phe(ka,ib,Rb,tc,xc){if(1===Rb)return 32;th(this.Ba)||(this.JGb=this.zu.value.uD);if(!this.wv||!xc)return 32;xc[Kf.value]="";xc[Kf.labelText]="";xc[Kf.alt]=null;xc[Kf.tAl]=null;xc[Kf.DAb]=null;xc[Kf.customTooltip]="";xc[Kf.visible]=!1;xc[Kf.iconColor]=
"";xc[Kf.icon]="";if(this.wlj())this.kMn(xc);else{Rb=ib=ka="";if(!this.wv.AreLabelsAvailable){if(!this.Kic)return 32;ka=this.Kic;Rb=Kf.Yyh;this.P0e&&(ib=this.P0e)}else if(this.wv.AppliedPolicyId){tc=null;for(const hd of this.wv.SensitivityLabels)if(hd.Id.toLowerCase()===this.wv.AppliedPolicyId.toLowerCase()){tc=hd;break}tc&&(ka=th(this.Ba)?this.zu.value.Oac(tc):this.Oac(tc),ib=tc.Tooltip,this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",!1)||(u.AFrameworkApplication.RA=
this.zu.value.WAb(tc)),Rb=this.GKi(tc))}ka&&(xc[Kf.value]=ka,xc[Kf.labelText]=ka,this.I9c()?xc[Kf.customTooltip]=ib:xc[Kf.alt]=ib,this.z2l(Rb,u.AFrameworkApplication.RA,xc),xc[Kf.visible]=!0)}return 32}VGg(ka,ib,Rb,tc,xc){if(1===Rb)return 32;th(this.Ba)||(this.JGb=this.zu.value.uD);if(!this.wv||!xc)return 32;xc[Kf.labelText]="";if(this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpUseHideBarByDefaultSetting",!1)&&this.wv.HideBarByDefault)return 32;ka="";if(this.wv.AreLabelsAvailable)if(this.wv.AppliedPolicyId){if(!this.Cca)return 32;
(ib=this.Cca[this.wv.AppliedPolicyId])&&(ka=ib.ParentId&&this.Cca[ib.ParentId]?th(this.Ba)?ib.ParentName:this.Cca[ib.ParentId].DisplayName:ib.DisplayName)}else ka=this.wv.MandatoryLabelingEnforced?this.Rhh().zwk:this.Rhh().UWj;else{if(!this.Kic)return 32;ka=this.Kic}xc[Kf.labelText]=ka;return 32}Oac(ka){return ka?this.V8a?ka.ParentId&&this.V8a[ka.ParentId]?this.V8a[ka.ParentId].DisplayName+"\\"+ka.DisplayName:ka.DisplayName:(n.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),
ka.DisplayName):""}z2l(ka,ib,Rb){this.wlj()?(Rb[Kf.icon]=this.Wwl(ib),Rb[Kf.iconColor]=this.Xwl(ka)):this.I9c()?Rb[Kf.icon]=ib?Kf.vSn:Kf.xSn:(Rb[Kf.tAl]=u.AFrameworkApplication.jp,Rb[Kf.DAb]=ib?kk.d(Kf.wSn):kk.d(Kf.ySn))}iBm(ka){const ib=this.Cu("LearnMoreSection",!0);ka=Object.assign(new Gj.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:ka,LabelText:Object(Y.a)("LearnMore"),Command:th(this.Ba)?ba.a.cFa.toString():"1959943459",Image16by16:u.AFrameworkApplication.jp,Image16by16Class:kk.d(Kf.P8m),
Visible:!0,Alt:Object(Y.a)("LearnMoreTooltip"),KeyTip:"L"});Array.add(ib.ControlList,ka);return ib}cnl(ka,ib,Rb=!1){let tc;tc="Toggle_"+ka.Id;tc="Sensitivity_"+tc;const xc=ka.DisplayName,hd=ka.Tooltip;var Fd=ka.Id===this.wv.AppliedPolicyId,Td=Rb?ra.a.Re(tc):tc;this.wlj()?(Fd=this.GKi(ka),ib=Object.assign(new pg.a,{Id:Td,ExternalId:Td,LabelText:Rb?ra.a.Re(xc):xc,Command:th(this.Ba)?ba.a.IXc.toString():"2935633379",MenuItemId:Td,QueryCommand:th(this.Ba)?ba.a.rTc.toString():"991261903",Visible:!0,Alt:Rb?
ra.a.Re(hd):hd,AriaLabel:Ha.a.lvd,IconColor:this.Xwl(Fd),KeyTip:ib}),ib.ExternalImageId=this.Wwl(this.zu.value.WAb(ka))):(Td=Object.assign(new xh.a,{Id:Td,ExternalId:Td,LabelText:Rb?ra.a.Re(xc):xc,Command:th(this.Ba)?ba.a.IXc.toString():"2935633379",MenuItemId:Td,QueryCommand:th(this.Ba)?ba.a.rTc.toString():"991261903",CheckedImage:u.AFrameworkApplication.jp,Visible:!0,Alt:Rb?ra.a.Re(hd):hd,IsChecked:Fd,AriaLabel:Ha.a.lvd,KeyTip:ib}),this.isReactRibbonEnabled()?(Td.CheckedImageClass=kk.d(Kf.bik),
Td.ExternalImageId=Kf.bik):Td.CheckedImageClass=kk.d(Kf.Cjl),ib=Td);Td=tc;this.n2e[Td]=ka.Id;this.ial[ka.Id]=Td;return ib}Cu(ka,ib=!1){return Object.assign(new eg.a,{Title:"",Id:ka,DisplayMode:Kf.menu,ShowMenuSectionSeparator:ib,ControlsId:"Ctrl_"+ka,ControlList:[]})}vCm(ka,ib,Rb){ka=this.Cu(ka+"Sub");let tc=1;for(const xc of ib)(ib=this.Cca[xc])&&ib.Enabled&&(Array.add(ka.ControlList,this.cnl(ib,tc.toString(),Rb)),tc++);return ka}Vdh(ka=!1){const ib=this.Cu("SensitivitySection");let Rb=1;for(const tc in this.Wce){const xc=
this.Wce[tc],hd=this.Cca[tc];if(hd&&hd.Enabled){if(xc.count){const Fd="Label"+this.Egm++,Td=Object.assign(new Pi.a,{Id:Fd,ExternalId:Fd,LabelText:ka?ra.a.Re(hd.DisplayName):hd.DisplayName,Command:th(this.Ba)?ba.a.ZW.toString():"798637440",QueryCommand:th(this.Ba)?ba.a.fdd.toString():"2875864574",Menu:Object.assign(new Ld.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:Ha.a.lvd,KeyTip:Rb.toString(),Alt:ka?ra.a.Re(hd.Tooltip):
hd.Tooltip});this.isReactRibbonEnabled()?Td.ExternalImageId=Kf.bik:(Td.Image16by16=u.AFrameworkApplication.jp,Td.Image16by16Class=kk.d(Kf.Cjl));Array.add(Td.Menu.MenuSectionList,this.vCm(Fd,xc,ka));Array.add(ib.ControlList,Td);this.n2e[Td.Id]=hd.Id;this.ial[hd.Id]=Td.Id}else Array.add(ib.ControlList,this.cnl(hd,Rb.toString(),ka));Rb++}}return ib}Y8e(ka){return!!this.ya.g3(ka)&&!!this.ya.g3(ka).flags&&!!this.ya.g3(ka).flags.length}Wwl(ka){return ka?Kf.WCn:Kf.VCn}Xwl(ka){return ka?ka:Kf.Yyh}GKi(ka){if(ka.Color||
!ka.ParentId)return ka.Color;const ib=this.Cca[ka.ParentId];return ib?ib.Color:ka.Color}oWn(ka){switch(ka){case 2:case 14:case 15:return 1;case 21:return 2;default:return 0}}Rhh(){this.lQh||(this.lQh=Object.assign(new mf,{UWj:HeaderStrings.NoSensitivityLabel,zwk:HeaderStrings.SelectASensitivityLabel}));return this.lQh}static pYn(){u.AFrameworkApplication.ga&&!u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)||!wc.c()||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("OpenDocumentLabelPane",
!0))}static Iuh(ka){wc.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!ka))}static rb(ka){return ka&&ka.length?!1:!0}}Object(m.a)(Hh,"PolicyActor",null,[1187]);var Fg=a(232),Ij=a(1355),ej;(function(ka){ka[ka.unknown=0]="unknown";ka[ka.boot=1]="boot";ka[ka.refresh=2]="refresh";ka[ka.e6n=3]="selfSetPolicyLabel"})(ej||(ej={}));Object(m.b)("GetPolicyLabelsReason",ej);class Yj extends Sys.EventArgs{constructor(ka,ib,Rb,tc,xc,hd){super();this.Lze=ka;this.title=ib;this.message=
Rb;this.buttonText=tc;this.xff=xc;this.blh=hd}}Object(m.a)(Yj,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Qe extends Sys.EventArgs{constructor(ka,ib,Rb,tc,xc){super();this.Lze=ka;this.title=ib;this.message=Rb;this.buttonText=tc;this.xff=xc}}Object(m.a)(Qe,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var ef;(function(ka){ka[ka.none=0]="none";ka[ka.D5n=1]="reasonDefaultLabel";ka[ka.F5n=2]="reasonManual";ka[ka.C5n=4]="reasonAutomatic";ka[ka.G5n=8]="reasonRecommended";
ka[ka.E5n=16]="reasonMandatory";ka[ka.B5n=32]="reasonAI"})(ef||(ef={}));Object(m.b)("ApplyLabelFlags",ef);class Ig extends Sys.EventArgs{constructor(ka,ib,Rb){super();this.qkl=ka;this.pkl=ib;this.existingLabelPriority=Rb}}Object(m.a)(Ig,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class Wg extends Sys.EventArgs{constructor(){super()}}Object(m.a)(Wg,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class Vh extends Sys.EventArgs{constructor(){super()}}Object(m.a)(Vh,"GetPolicyLabelFailureEventArgs",
Sys.EventArgs,[]);var zi=a(1187),di=a(871);class ph extends Sys.EventArgs{constructor(ka=!1,ib=null,Rb=null,tc=null){super();this.vw=ka;this.Xbf=ib;this.context=Rb;this.Q2l=tc}}Object(m.a)(ph,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class ki extends Sys.EventArgs{constructor(ka,ib){super();this.VMl=ka;this.M3h=ib}}Object(m.a)(ki,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class Yh extends Sys.EventArgs{constructor(ka,ib,Rb,tc){super();this.title=ka;this.fwn=ib;this.buttonText=Rb;
this.xon=tc}}Object(m.a)(Yh,"PolicyTipEventArgs",Sys.EventArgs,[]);class Xh extends Sys.EventArgs{constructor(ka,ib){super();this.Lze=ka;this.blh=ib}}Object(m.a)(Xh,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Li extends Sys.EventArgs{constructor(){super()}}Object(m.a)(Li,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class ij extends Sys.EventArgs{constructor(ka,ib){super();this.XTl=ka;this.Tfb=ib}}Object(m.a)(ij,"SetPolicyLabelEventArgs",Sys.EventArgs,
[]);class Nk extends Sys.EventArgs{constructor(ka,ib,Rb,tc=null,xc=null,hd=null,Fd=null){super();this.errorType=ka;this.cQn=Rb;this.title=tc;this.message=xc;this.buttonText=hd;this.xff=Fd}}Object(m.a)(Nk,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class xk extends Sys.EventArgs{constructor(){super()}}Object(m.a)(xk,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class ui extends Sys.EventArgs{constructor(ka){super();this.wOn=ka}}Object(m.a)(ui,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,
[]);var pj=a(869),wj=a(870);class ok{static NLn(ka,ib){if(!ka||!ib||ka.count!==ib.count)return!1;for(const Rb of ka)if(!ib.contains(Rb))return!1;return!0}static toArray(ka){if(!ka)return null;const ib=Array(ka.count);let Rb=0;for(const tc of ka)ib[Rb]=tc,Rb++;return ib}}Object(m.a)(ok,"HashSetUtils",null,[]);var Lj=a(687),Tj=a(155);class rk{constructor(ka,ib,Rb,tc=0,xc=null){this.XGh=this.m6k=null;this.R3c=this.kYe=this.mYe=0;this.AZ="";this.Bqd=this.M8k=this.uEh=this.aLh=this.s9b=this.rNh=null;this.f8k=
!1;this.fhd=null;this.XJh=0;this.$9g=this.Jqd=this.zkd=this.Z9g=null;this.kb=new Gg.a;this.rRg=this.xFf=this.mHa=null;this.QKh=!1;this.VVa={};this.O3e={};this.ZWf=null;this.i7h=hd=>{if(!this.rDl){var Fd=hd.BO.task;Fd.continueWith(()=>{this.mHa=Fd.result;this.mHa.Zmc(this.zqn)})}};this.zqn=(hd,Fd)=>{12===Fd.type&&(this.M8k?this.M8k():this.Jac(this.AZ,2,this.s9b,!0))};this.Ba=ka;this.$m=ib;this.Un=Rb;this.u9g=tc;this.uD=new zi.a;this.F8l();this.hal=this.Ba.La("PolicyHandlerEndpointName")||"PolicyHandler.ashx";
this.Cda=xc;this.ikh=ka.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled");this.lQf=ka.getBooleanAppSetting("CoAuthForProtectedFilesIsEnabled");this.Gqe=ka.getBooleanAppSetting("SupportsOfficeClientCoauthoring");this.l6m=!1;this.FMn=3E4;this.ze=ea.TaskManager.instance;ka.getBooleanAppSetting("SupportsPolicies")&&nb.a("MipSupportsPolicies");this.lQf&&this.Gqe&&nb.a("MipSupportsOfficeClientCoauthoring")}get MBl(){return this.QKh}Bqm(ka){this.kb.addHandler("PolicyTipEvent",ka)}Y9b(ka){this.kb.addHandler("LabelInfoUpdateEvent",
ka)}YFn(ka){this.kb.removeHandler("LabelInfoUpdateEvent",ka)}J1h(ka){this.kb.addHandler("SetPolicyLabelEventKey",ka)}tZl(ka){this.kb.removeHandler("SetPolicyLabelEventKey",ka)}qfl(ka){this.kb.addHandler("SetPolicyLabelFailureEventKey",ka)}Vpm(ka){this.kb.addHandler("GetAutoPolicyLabelEventKey",ka);this.MBl&&(n.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.Zfk(new Wg(0)))}Spm(ka){this.kb.addHandler("CreateAutoCLPSecurityNodesEventKey",
ka)}Uqm(ka){this.kb.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",ka)}Vqm(ka){this.kb.addHandler("UpdateAutoCLPSITNodesEventKey",ka)}Jpm(ka){this.kb.addHandler("AddAutoPolicyBusinessBarEntryEventKey",ka)}Gqm(ka){this.kb.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",ka)}Kpm(ka){this.kb.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",ka)}Hqm(ka){this.kb.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",ka)}cqm(ka){this.kb.addHandler("MandatoryLabellingAppHandlerEventKey",
ka)}Tqm(ka){this.kb.addHandler("UDPLabelingAppHandlerEventKey",ka)}cMn(){this.VVa={};for(const ka of this.uD.SensitivityLabels)this.VVa[ka.Id]=ka}yMn(){this.O3e={};for(const ka of this.uD.SensitivityLabels)ka.ParentId||(this.O3e[ka.Id]=new N.a);for(const ka of this.uD.SensitivityLabels)ka.ParentId&&ka.ParentId in this.O3e&&(this.VVa[ka.ParentId]&&(ka.ParentName=this.VVa[ka.ParentId].DisplayName),ka.Enabled&&this.O3e[ka.ParentId].add(ka.Id))}get v4m(){if(!this.m6k)return!1;for(const ka of this.m6k.kCe())if(!ka.Capabilities||
!ka.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get rDl(){return!!this.mHa}w1m(ka){ka&&this.lQf&&this.Gqe&&ka.execute(this.i7h)}DEn(ka){this.aLh=ka}exm(){return this.aLh?this.aLh():!1}gEn(ka){this.uEh=ka}getCurrentTime(){return(new Date).getTime()}XAb(){return this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)}EMi(){this.Un&&(this.Z9g=this.Un.wl("WebServiceCall","Call Get Policy Endpoint On Server"));var ka=Lj.a.N9a(1,1);this.Ba.getBooleanAppSetting("SendHostAttributionInfoForPolicyLabelEnabled")?
(ka=new wj.a(this.fFg("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ka),this.$m.send(ka).vUc(Object(K.a)(this,this.GPl,"onDataLossPolicySuccessCallback"),Object(K.a)(this,this.FPl,"onDataLossPolicyFailureCallback"))):this.$m.rk(this.fFg("datalosspolicy"),1,null,null,!0,2,Object(K.a)(this,this.GPl,"onDataLossPolicySuccessCallback"),Object(K.a)(this,this.FPl,"onDataLossPolicyFailureCallback"),null);this.mYe++;n.ULS.sendTraceTag(25565151,
306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.hal,this.mYe)}QDn(){this.Jac(this.AZ,2,this.s9b)}Jac(ka,ib=0,Rb=null,tc=!1,xc=null){Bb.Health.instance.recordKpiUsage("MipGetPolicyLabel",uc.b.FailureBased,"officewebclp",this.xNi(void 0,ib));this.xFf=this.getCurrentTime();const hd=this.Qni(ib);this.ihh(ka,hd,Rb,tc,ib,xc);this.Nqk(!0)}F8l(){const ka=Object(di.b)();if(this.n8k=!!ka)this.uD=ka}Bnj(){this.F8l();return this.n8k}GPl(ka){this.WTl();let ib=
"";({data:ib}=this.cte(ka)).returnValue&&(n.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.mYe=0,this.Un&&(this.$9g=this.Un.wl("Task","Parse and Handle Get Policy Response")),this.eun(ib),this.$9g&&(this.$9g.stop(),this.$9g=null))}FPl(ka){this.WTl();this.mYe<=this.u9g?this.EMi():(n.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",ka?ka.data?ka.data.Zdc:null:null),this.mYe=0)}ADl(){return 0<this.R3c}CXc(ka){this.uD.AppliedPolicyId=
ka}PMe(ka,ib,Rb=null,tc=null){const xc=this.dBm(Rb);this.EMn(ka,ib,xc,Rb,tc)}rRl(ka){this.Jqd&&(this.Jqd.stop(),this.Jqd=null);const {u1l:ib,R2l:Rb,QBa:tc}=this.wwl(ka),xc=ka.data.state,hd=xc?xc.Tfb:2;let Fd="";({data:Fd}=this.cte(ka)).returnValue?(n.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",hd),this.R3c=0,this.uun(Fd,ib,Rb,xc,tc)):this.xtk(hd,tc)}wCn(ka){Bb.Health.instance.recordKpiUsage("MipSetPolicyLabel",uc.b.FailureBased,"officewebclp",
this.xNi(ka));this.rRg=this.getCurrentTime();n.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.kb.raiseEvent("SetPolicyLabelTriggeredEventKey",new xk(ka))}jnn(){this.lQf&&this.Gqe&&this.rDl&&this.mHa.mvb(12,null,!0)}qRl(ka){this.Jqd&&(this.Jqd.stop(),this.Jqd=null);const {u1l:ib,R2l:Rb,QBa:tc}=this.wwl(ka);if(this.R3c<=this.u9g)this.PMe(ib,Rb,null,tc);else{var xc=ka.data.state;xc=xc?xc.Tfb:2;n.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",
ka?ka.data?ka.data.Zdc:null:null,xc);this.ZWf="WACServerConnectionFailed";this.R3c=0;this.xtk(xc,tc)}}T5m(ka){if(ka&&("LabelNotSupported"===ka||"LabelErrorRetryLater"===ka||"CoherencyFailure"===ka||"LabelIdNotFound"===ka||"LabelDisabled"===ka))return n.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",ka),!0;n.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",ka);return!1}WAb(ka){return ka.IsEndpointProtectionEnabled||ka.HasUserDefinedPermissions}zwm(ka){if(!ka)return!1;
let ib=null,Rb=null;if(th(this.Ba))ib=this.VVa[ka],Rb=this.VVa[this.AZ];else for(const tc of this.uD.SensitivityLabels)tc.Id===ka&&(ib=tc),tc.Id===this.AZ&&(Rb=tc);if(!ib)return!1;if(this.lQf&&this.Gqe){if(this.uEh&&this.uEh()||this.v4m)return!0}else if(u.AFrameworkApplication.NZ&&u.AFrameworkApplication.NZ.g$a||this.s9b&&this.s9b())return!0;return this.WAb(ib)===(!!Rb&&this.WAb(Rb))}v9e(ka,ib,Rb,tc,xc){28===ka?this.zWl(new Yj(ka,ib,Rb,tc,xc,!1)):this.zWl(new Yj(ka,ib,Rb,tc,xc,!0))}Odc(ka){28===ka?
this.NWl(new Xh(ka,!1)):this.NWl(new Xh(ka,!0))}gCn(ka,ib,Rb){n.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.kb.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new Ig(ka,ib,Rb))}CCn(ka){n.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.kb.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new Ig(null,null,ka))}DCn(ka,ib){n.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.kb.raiseEvent("UpdateAutoCLPSITNodesEventKey",
new Ig(ka,ib,null))}IWl(ka,ib){n.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===ib?"Reading":"Edit")+" switch event.");this.kb.raiseEvent("MandatoryLabellingAppHandlerEventKey",new ki(ka,ib))}qZh(ka,ib,Rb,tc,xc){37===ka&&this.eCn(new Qe(37,ib,Rb,tc,xc))}wnk(){this.sCn(new Li)}BCn(){n.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.kb.raiseEvent("UDPLabelingAppHandlerEventKey",new ui(!0))}p9a(ka=!1){const ib=Object(pj.a)(this.uD);ib||ka||Hh.Iuh(!1);return ib}jKn(){window.postMessage(JSON.stringify({type:"mipProperties",
isProtected:u.AFrameworkApplication.RA,sensitivity:{labelId:this.AZ},usageRights:{docEdit:this.uD.EditEnabled,extract:u.AFrameworkApplication.ZSa,print:u.AFrameworkApplication.stb,export:u.AFrameworkApplication.hfh,objModel:u.AFrameworkApplication.eDd,owner:u.AFrameworkApplication.jfh}}),"*")}gUl(ka){ka&&(this.s9b=ka);n.ULS.shipAssertTag(507888257,306,this.Bnj(),"populatePolicyLabelsDataFromCache was called with no cached response");Object(di.c)()?(n.ULS.sendTraceTag(507847580,306,50,"Policy label boot call is still pending response."),
Object(di.e)(this.IAl.bind(this))):(n.ULS.sendTraceTag(507847579,306,50,"Policy label boot call is being used to populate policy label info"),this.IAl())}IAl(){this.JAl(Object(di.b)(),Object(di.a)());this.GWl(1,!0)}GWl(ka,ib){this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",!1)&&this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableEdgeBlockScreenCapture",!1)&&ib&&this.jKn();Bb.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.Jgh(void 0,
ka,this.xFf));this.xFf=null;ka=new Wg(ka);this.hCn(ka);ib&&this.gOn()?(this.MBl?this.iXn():(this.Zfk(ka),this.QKh=!0),this.Zfk(ka),this.QKh=!0):ib||this.$fk()}BPc(ka){this.zkd&&(this.zkd.stop(),this.zkd=null);var ib=null;ka&&ka.data&&(ib=ka.data.QBa);let Rb;this.Nqk(!1);({data:Rb}=this.cte(ka)).returnValue?(n.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.kYe=0,ib=this.kun(Rb,ib),this.GWl(this.Yvl(ka.data),ib)):this.$fk()}gOn(){if(!this.Ba.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled"))return n.ULS.sendTraceTag(539877667,
306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.Csm())return!1;if(""===this.AZ)return n.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),!0;if(this.fhd===this.XJh)return n.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;n.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");
return!0}Cmi(){this.p9l();n.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.Bqd.count,this.fhd);const ka=ok.toArray(this.Bqd);this.gCn(ka,ka,this.fhd)}iXn(){var ka=this.Bqd;this.p9l();ok.NLn(ka,this.Bqd)||(n.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.Bqd.count),ka=ok.toArray(this.Bqd),this.DCn(ka,ka));this.f8k&&(n.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",
this.fhd),this.CCn(this.fhd))}p9l(){var ka;const ib=new Fg.a(dj.a.Wn());for(const Rb of this.uD.SensitivityLabels)if(0<(null===(ka=null===Rb||void 0===Rb?void 0:Rb.AutoLabelingSensitiveTypeIds)||void 0===ka?void 0:ka.length))for(const tc of Rb.AutoLabelingSensitiveTypeIds)tc&&ib.add(tc);this.Bqd=ib}APc(ka){const ib=this.Yvl(ka.data);let Rb=null;ka&&ka.data&&(Rb=ka.data.QBa);Bb.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.Jgh(void 0,ib,this.xFf));this.xFf=
null;this.zkd&&(this.zkd.stop(),this.zkd=null);if(this.kYe<=this.u9g){if(this.Ba.getBooleanAppSetting("SendHostAttributionInfoForPolicyLabelEnabled")){const tc=ka.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in tc&&tc[Lj.a.ded]&&"HostAttributionInfo.ScenarioTypeParamName"in tc&&tc[Lj.a.aWc]){ka.data.request.get_headers();ka.data.request.get_headers()[Lj.a.aWc];ka=this.Qni(ib);this.ihh(this.AZ,ka,this.s9b,void 0,ib,Rb);return}}this.Jac(this.AZ,ib,this.s9b,!1,Rb)}else n.ULS.sendTraceTag(34996494,
306,15,"Request to get label policy failed with error response: {0}.",ka?ka.data?ka.data.Zdc:null:null),this.$fk(),this.kYe=0,this.Nqk(!1)}Yvl(ka){return ka.state?ka.state:0}fFg(ka,ib=!1){return Object(pj.c)(this.Ba.La("PolicyHandlerWebServiceBase")||u.AFrameworkApplication.Ea.Kb.f2,this.hal,u.AFrameworkApplication.ui,ka===pj.e&&u.AFrameworkApplication.NZ&&u.AFrameworkApplication.NZ.Ckh,ka,ib)}wwl(ka){let ib=null,Rb=null,tc=null;ka&&ka.data&&ka.data.request&&ka.data.request.get_headers()&&(ib=ka.data.request.get_headers()[Tj.a.v1l],
Rb=ka.data.request.get_headers()[Tj.a.S2l],tc=ka.data.QBa);return{u1l:ib,R2l:Rb,QBa:tc}}cte(ka){ka=ka?ka.data?ka.data.responseData:null:null;return ka&&ka.length&&!this.KUf(ka)?{returnValue:!0,data:ka}:(n.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:ka})}eun(ka){let ib;try{ib=ca.b(ka)}catch(Rb){n.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(ib)if(ib.IsPolicyTipAvailable)switch(ib.IsPolicyTipAvailable.toLowerCase()){case "false":n.ULS.sendTraceTag(26007261,
306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":n.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.XGh=ib.NavigateUrl;this.nQn(ib.GeneralText,Object(K.a)(this,this.$on,"onDataLossPolicyOverrideButtonClick"));break;default:n.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",ib.IsPolicyTipAvailable)}else n.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");
else n.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")}Tzm(ka){switch(ka){case "CoherencyFailure":return 1;case "DisabledByPolicy":return 2;case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;
case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}uun(ka,ib,Rb,tc,xc=null){var hd=tc?tc.Tfb:2;let Fd=0;var Td="";let na;if(({BD:na}=ca.d(ka)).returnValue)if(na){Td="Success";ka=this.Qni(3);if(na.IsSuccessful){Bb.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.Jgh(hd,void 0,this.rRg));this.ZWf=this.rRg=null;n.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",
hd);2===hd&&this.Odc(29);this.RMn(ib,hd);this.jnn();this.Odc(28);this.XAb()?tc&&4===hd&&(Td=xc.startsWith("OFFICEJS_SENSITIVITY_CONTEXT_"),this.v9e(28,Td?"SENSITIVITY":Object(Y.a)("PolicyBusinessBarTitle"),String.format(Td?"Due to content created by Copilot, your organization automatically applied the sensitivity label: {0}.":Object(Y.a)("PolicyLabelAutomaticallyAppliedMessage"),tc.displayName),Object(Y.a)("DialogOk"),()=>{})):tc&&4===hd&&this.v9e(28,Object(Y.a)("PolicyBusinessBarTitle"),String.format(Object(Y.a)("PolicyLabelAutomaticallyAppliedMessage"),
tc.displayName),Object(Y.a)("DialogOk"),()=>{});nb.a("MipAppliedLabels",void 0,void 0,[Object.assign(new se.a,{name:"SetPolicyLabelApplyFlag",string:ef[hd]})]);this.ihh(ib,ka,this.s9b,void 0,3,xc);return}n.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",hd,na.FailureReason);this.ZWf=na.FailureReason;Fd=this.Tzm(na.FailureReason);this.l6m&&0<=na.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&
(tc=new Wa.a(2,1,this.FMn,()=>{n.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",this.R3c);this.R3c<=this.u9g&&this.PMe(ib,Rb,null,xc)}),this.ze.Qb(tc));this.lQf&&this.Gqe&&this.ihh(this.uD.AppliedPolicyId,ka,this.s9b,!0,3,xc)}else Td="setPolicyLabelData null.",n.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",hd);else Td="TryDeserialize failed.",
n.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",hd);this.xtk(hd,xc,Fd);hd=this.Jgh(hd,void 0,this.rRg);this.rRg=null;hd.extendedProperties.set("SetPolicyLabelDataFailureReason",this.ZWf);hd.extendedProperties.set("SetPolicyLabelDataParseStatus",Td.toString());Bb.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,hd)}SDf(ka){if(""===ka)return null;for(const ib of this.uD.SensitivityLabels)if((null===ib||
void 0===ib?void 0:ib.Id)===ka)return ib;return null}eXn(){if(""!==this.AZ)if(th(this.Ba)){var ka=this.VVa[this.AZ];ka&&(ka.HasExtractForUser=this.WAb(ka)?this.uD.ExtractEnabled:!0)}else for(ka of this.uD.SensitivityLabels)(null===ka||void 0===ka?void 0:ka.Id)===this.AZ&&(ka.HasExtractForUser=this.WAb(ka)?this.uD.ExtractEnabled:!0)}xtk(ka,ib=null,Rb=0){const tc=2===ka||8===ka||16===ka,xc=new ph;this.CXc(this.AZ);this.XAb()&&(th(this.Ba)?xc.Xbf=this.VVa[this.AZ]:xc.Xbf=this.SDf(this.AZ),xc.context=
ib,xc.Q2l=Rb);this.HWl(xc);this.WWl(Rb,ka,tc,!1)}RMn(ka,ib){this.CXc(this.AZ=ka);if(!this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",!1))if(""===ka)u.AFrameworkApplication.RA=!1,u.AFrameworkApplication.eDd=!1;else for(const Rb of this.uD.SensitivityLabels)if(Rb.Id===ka){u.AFrameworkApplication.RA=this.WAb(Rb);break}this.vCn(new ij(ka,ib))}NXn(){for(const ka of this.uD.SensitivityLabels)if(null===ka||void 0===ka?0:ka.Enabled)ka.Id===this.AZ&&(this.f8k=
this.fhd!==ka.Order,this.fhd=ka.Order),ka.Order>this.XJh&&(this.XJh=ka.Order)}S9l(){this.Ba.appSettings&&(this.Ba.appSettings.AppliedPolicyId=this.AZ);let ka=!1;if(""!==this.AZ)if(th(this.Ba))ka=this.WAb(this.VVa[this.AZ]);else for(const ib of this.uD.SensitivityLabels)if(ib.Id===this.AZ){ka=this.WAb(ib);break}u.AFrameworkApplication.RA=ka;u.AFrameworkApplication.fD=ka?this.uD.ViewEnabled&&!this.uD.EditEnabled:!1;u.AFrameworkApplication.stb=ka?this.uD.PrintEnabled:!1;u.AFrameworkApplication.eDd=ka?
this.uD.MacrosEnabled:!1;u.AFrameworkApplication.ZSa=ka?this.uD.ExtractEnabled:!1;u.AFrameworkApplication.hfh=ka?this.uD.ExportEnabled:!1;u.AFrameworkApplication.jfh=ka?this.uD.FullControlEnabled:!1}JAl(ka,ib){if(!ka)return n.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!ka.AreLabelsAvailable)return!1;this.uD=ka;this.AZ=ka.AppliedPolicyId;this.XAb()&&this.eXn();this.Ba.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",
!1)?th(this.Ba)||this.S9l():this.Ba.appSettings&&(this.Ba.appSettings.AppliedPolicyId=this.AZ);this.NXn();this.p9a()&&n.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");ka=new ph(!0);this.XAb()&&(th(this.Ba)?ka.Xbf=this.VVa[this.AZ]:ka.Xbf=this.SDf(this.AZ),ka.context=ib);this.HWl(ka);return!0}kun(ka,ib=null){return({BD:ka}=ca.d(ka)).returnValue?this.JAl(ka,ib):(n.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),
!1)}Csm(){var ka;if(!this.p9a())return n.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const ib of this.uD.SensitivityLabels)if(0<(null===(ka=null===ib||void 0===ib?void 0:ib.AutoLabelingSensitiveTypeIds)||void 0===ka?void 0:ka.length))return!0;n.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}HWl(ka){n.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");
th(this.Ba)&&(this.cMn(),this.yMn(),this.S9l());this.kb.raiseEvent("LabelInfoUpdateEvent",ka)}hCn(ka){n.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.kb.raiseEvent("GetPolicyLabelEventKey",ka)}$fk(){Hh.Iuh(!1);this.kb.raiseEvent("GetPolicyLabelFailureEventKey",new Vh)}Zfk(ka){this.Cda&&this.Cda.execute(ib=>{ib=[ib.isFeatureEnabled("MsoClpSpTwo",!0),ib.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(ib).then(Rb=>{Oi.a.any(Rb,tc=>tc)&&(n.ULS.sendTraceTag(50944077,306,
50,"Raising get auto policy label event."),this.kb.raiseEvent("GetAutoPolicyLabelEventKey",ka),this.Cmi(),nb.a("MipAutoClassificationEnabled"));return null})})}xNi(ka=null,ib=null){const Rb=new Map;Rb.set("ClpCoauth",this.Gqe.toString());null!=ka&&Rb.set("ApplyLabelFlags",ef[ka]);null!=ib&&Rb.set("GetPolicyLabelsReason",ej[ib]);return Rb}Jgh(ka=null,ib=null,Rb=null){const tc={};tc.extendedProperties=this.xNi(ka,ib);null!=Rb&&(tc.durationMs=this.getCurrentTime()-Rb);return tc}vCn(ka){n.ULS.sendTraceTag(41799710,
306,50,"Raising set policy label event.");this.kb.raiseEvent("SetPolicyLabelEventKey",ka)}zWl(ka){n.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");ka&&ka.blh&&nb.a("MipRecommendations");this.kb.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",ka)}NWl(ka){n.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.kb.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",ka)}eCn(ka){n.ULS.sendTraceTag(573842331,306,50,
"Raising an add mandatory labelling business bar entry event.");this.kb.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",ka)}sCn(ka){n.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");this.kb.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",ka)}nQn(ka,ib=null){n.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.kb.raiseEvent("PolicyTipEvent",new Yh(Object(Y.a)("PolicyBusinessBarTitle"),ka,Object(Y.a)("PolicyOverrideButton"),
ib))}WWl(ka,ib,Rb,tc=!0){n.ULS.sendTraceTag(42074656,306,tc?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",ib);tc=Object(Y.a)("SensitivityApplicationErrorBusinessBarTitle");let xc=Object(Y.a)("SensitivityApplicationErrorBusinessBarMessage"),hd=null,Fd=null;switch(ka){case 2:tc=Object(Y.a)("SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle");xc=Object(Y.a)("SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage");break;case 5:xc=Object(Y.a)("SensitivityApplicationErrorFileLockedBusinessBarMessage");
break;case 7:tc=Object(Y.a)("SensitivityApplicationErrorFileTooLargeBusinessBarTitle");xc=Object(Y.a)("SensitivityApplicationErrorFileTooLargeBusinessBarMessage");break;case 13:tc=Object(Y.a)("SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle");xc=Object(Y.a)("SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage");break;case 9:tc=Object(Y.a)("SensitivityApplicationErrorLabelDisabledBusinessBarTitle");xc=Object(Y.a)("SensitivityApplicationErrorLabelDisabledBusinessBarMessage");
break;case 10:xc=Object(Y.a)("SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage");break;case 14:tc=Object(Y.a)("SensitivityCoauthMandatoryApplicationErrorTitle");xc=Object(Y.a)("SensitivityCoauthMandatoryApplicationErrorMessage");break;case 15:tc=Object(Y.a)("SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle"),xc=Object(Y.a)("SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage"),hd=Object(Y.a)("LearnMore"),Fd=()=>{this.GMn()}}ka=new Nk(ka,ib,Rb,
tc,xc,hd,Fd);this.kb.raiseEvent("SetPolicyLabelFailureEventKey",ka)}ZAk(ka){this.rNh=ka}$on(){this.XGh?(n.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),gb.a.aCe(this.XGh)):n.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}KUf(ka){if(!ka.startsWith("<")||-1===ka.indexOf("Error")&&-1===ka.indexOf("Unavailable"))return!1;n.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");
return!0}WTl(){this.Z9g&&(this.Z9g.stop(),this.Z9g=null)}tLm(ka){if(!ka)return"manual";switch(ka.Tfb){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";case 32:return"ai";default:return"manual"}}gMm(ka){if(!ka)return"privileged";ka=ka.Tfb;let ib="privileged";if(4===ka||1===ka||32===ka)ib="standard";return ib}ihh(ka,ib,Rb=null,tc=!1,xc=0,hd=null){this.Ba.getBooleanAppSetting("WacLabelingGetPolicyLabelsIsEnabled")&&
(this.AZ=ka,this.s9b=Rb,this.Un&&(this.zkd=this.Un.wl("WebServiceCall","Call Get Policy Endpoint On Server")),Object(pj.d)(this.Ba,this.$m,Object(K.a)(this,this.BPc,"onGetPolicyLabelsSuccessCallback"),Object(K.a)(this,this.APc,"onGetPolicyLabelsFailureCallback"),this.fFg("getpolicylabels",tc),ka,ib,xc,hd),this.kYe++,n.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.kYe))}EMn(ka,ib,Rb,tc=null,xc=null){if(this.ikh){this.Un&&(this.Jqd=this.Un.wl("WebServiceCall",
"Call Set Policy Endpoint On Server"));var hd={};hd[Tj.a.v1l]=ka;ib&&(hd[Tj.a.S2l]=encodeURIComponent(ib));this.rNh&&(hd[Tj.a.csm]=this.rNh);tc?(hd[Tj.a.O2l]=this.tLm(tc),hd[Tj.a.P2l]=this.gMm(tc),1===tc.Tfb&&this.uD.DefaultLabelType&&(hd[Tj.a.CMn]=this.uD.DefaultLabelType)):(hd[Tj.a.O2l]="manual",hd[Tj.a.P2l]="privileged");this.Gqe&&this.uD&&(hd[Tj.a.ewn]=this.uD.PolicyLabelVersionToken);this.Ba.getBooleanAppSetting("SendHostAttributionInfoForPolicyLabelEnabled")?(ka=new wj.a(this.fFg(pj.e,!0),1,
null,hd,!0,2,tc,void 0,this.XAb()?xc:void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Rb),this.$m.send(ka).vUc(Object(K.a)(this,this.rRl,"onSetPolicyLabelSuccessCallback"),Object(K.a)(this,this.qRl,"onSetPolicyLabelFailureCallback"))):this.$m.rk(this.fFg(pj.e,!0),1,null,hd,!0,2,Object(K.a)(this,this.rRl,"onSetPolicyLabelSuccessCallback"),Object(K.a)(this,this.qRl,"onSetPolicyLabelFailureCallback"),tc,this.XAb()?xc:void 0,void 0,void 0,void 0,"32");this.R3c++;n.ULS.sendTraceTag(41799706,
306,50,"Set policy label request sent to server. Policy call times: {0}",this.R3c)}else n.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}GMn(){const ka=new P.a,ib=this.Ba.La("BreadcrumbFolderUrl");ib?(ka.gf=11,ka.Fg(1,Object(Y.a)("SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction")),ka.Fg(2,Object(Y.a)("DialogOk"))):(ka.gf=0,ka.Fg(1,Object(Y.a)("DialogOk")));ka.b$e(Object(Y.a)("SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText"),
"0f6cd105-974f-44a4-aadb-43ac5bdfd247");ka.xFn();ka.m7(Object(Y.a)("SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle"),Object(Y.a)("SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage"),Rb=>{1===Rb&&ib&&gb.a.jq(ib,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}Qni(ka){return Object(pj.b)(ka)}dBm(ka=null){if(!ka)return Lj.a.N9a(8,0);switch(ka.Tfb){case 1:case 16:return Lj.a.N9a(1,1);case 4:case 2:case 8:return Lj.a.N9a(8,1);default:return Lj.a.N9a(8,
0)}}Nqk(ka){wc.c()&&appChrome.api.setAsyncRequestStatus("sensitivity",ka)}Oac(ka){return ka?ka.ParentId&&ka.ParentName?ka.ParentName+"\\"+ka.DisplayName:ka.DisplayName:""}getHighestSensitivityLabel(ka){if(!ka||0==ka.length)return null;let ib=null;for(const Rb of ka)if(""!==Rb)if(th(this.Ba))if(ka=this.VVa[Rb]){if(!ib||ka.Order>ib.Order)ib=ka}else return null;else{ka=!1;for(const tc of this.uD.SensitivityLabels)(null===tc||void 0===tc?void 0:tc.Id)===Rb&&(ka=!0,!ib||tc.Order>ib.Order)&&(ib=tc);if(!ka)return null}ib||
(ib=new Ij.a);return ib}fMm(){return""===this.AZ?new Ij.a:th(this.Ba)?this.VVa[this.AZ]:this.SDf(this.AZ)}tryUpgradeLabel(ka,ib){if(""===ka.Id)return 0;var Rb=th(this.Ba)?this.VVa[this.AZ]:this.SDf(this.AZ);ka=th(this.Ba)?this.VVa[ka.Id]:this.SDf(ka.Id);if(!ka)return 2147205112;if(!ka.Enabled)return 2147205117;if(ka.HasUserDefinedPermissions)return 2147205116;if(1==u.AFrameworkApplication.vb.mode)return 2147205119;if(ka.RequiredDowngradeJustification||(null===Rb||void 0===Rb?void 0:Rb.Order)>=ka.Order)return 2147205105;
Rb=new nf(4,this.Oac(ka));this.PMe(ka.Id,"",Rb,ib);return 0}}Object(m.a)(rk,"PolicyManager",null,[1164]);class Kk{constructor(){this.KSh=this.mQh=this.D9k=this.Nal=this.x4k=this.Rp=this.D3c=this.Ha=this.zu=null;this.VOl=()=>{this.Rp=this.Ha.yb("CommonUI.BusinessBar");this.zu||(this.zu=this.Ha.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.D3c=this.Ha.resolve("Common.App.Policy.PolicyActor");wc.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?
this.zu.Y9b(Object(K.a)(this.D3c,this.D3c.JXl,"registerActionsHandler")):this.D3c.Hb();this.zu.Y9b(this.MXn);u.AFrameworkApplication.ga.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled")&&(this.zu.qfl(this.lXm),this.zu.Jpm(this.v9e),this.zu.Gqm(this.Odc),this.zu.Kpm(this.qZh),this.zu.Hqm(this.wnk))};this.MXn=()=>{th()||(this.D3c.dMn(),this.D3c.zMn());this.D3c.LBn();const ka=this.zu.exm();u.AFrameworkApplication.ga.getBooleanAppSetting("HasDocumentEditRights")&&!ka?this.D3c.oVn():n.ULS.sendTraceTag(558682911,
306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",u.AFrameworkApplication.ga.getBooleanAppSetting("HasDocumentEditRights"),ka);u.AFrameworkApplication.Ea.Zf()};this.mQn=(ka,ib)=>{this.mQh&&this.Rp.v0a(38)&&this.Rp.removeEntry(this.mQh);ka=this.Wvl(ib.title,ib.fwn,38,ib.xon,ib.buttonText);u.AFrameworkApplication.Ea.Kb.yye(ka,!0)?(this.mQh=ka,n.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):
n.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")};this.lXm=(ka,ib)=>{ib.cQn&&(this.KSh&&this.Rp.v0a(21)&&this.Rp.removeEntry(this.KSh),ka=this.Wvl(ib.title,ib.message,21,null,null,ib.xff,ib.buttonText),u.AFrameworkApplication.Ea.Kb.yye(ka,!0)?(this.KSh=ka,n.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):n.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))};
this.Odc=(ka,ib)=>{(ka=ib.blh?this.Nal:this.x4k)&&this.Rp&&this.Rp.v0a(ib.Lze)&&this.Rp.removeEntry(ka)};this.v9e=(ka,ib)=>{this.Rp&&(this.zu.Odc(ib.Lze),ka=new Te.a(ib.title,ib.message,null),ka.id=ib.Lze,ka.closeable=!0,ka.image=3,ka.addButton(ib.buttonText,ib.xff,ib.buttonText,!0),this.Rp.Vh(ka,!1),ib.blh?this.Nal=ka:this.x4k=ka)};this.qZh=(ka,ib)=>{this.Rp&&(ka=new Te.a(ib.title,ib.message,null),ka.id=ib.Lze,ka.closeable=!1,ka.image=3,ka.addButton(ib.buttonText,ib.xff,ib.buttonText,!1),this.Rp.Vh(ka,
!1),this.D9k=ka)};this.wnk=()=>{const ka=this.D9k;ka&&this.Rp&&this.Rp.v0a(ka.id)&&this.Rp.removeEntry(ka)}}get name(){return"Common.App.Policy"}init(){u.AFrameworkApplication.ga.getBooleanAppSetting("ShouldInitCommonPolicyPackage")&&(u.AFrameworkApplication.ga.getBooleanAppSetting("IsDataLossPreventionEnabledForUser")&&u.AFrameworkApplication.Ea&&(this.zu=this.Ha.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.zu.Bqm(this.mQn),n.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),
u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?Wf.a.get_instance().$i(5,()=>{this.zu.EMi()}):Wf.a.get_instance().$i(6,()=>{this.zu.EMi()})),u.AFrameworkApplication.ga.getBooleanAppSetting("WacLabelingPoliciesIsEnabled")&&u.AFrameworkApplication.ga.getBooleanAppSetting("SupportsPolicies")?u.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?Wf.a.get_instance().$i(5,
this.VOl):Wf.a.get_instance().$i(6,this.VOl):(Hh.pYn(),Hh.Iuh(!1)))}dispose(){}lc(ka){ka.register(1164,"Common.App.Policy.Contracts.IPolicyManager").ma().na(()=>new rk(u.AFrameworkApplication.ga,u.AFrameworkApplication.ye,u.AFrameworkApplication.Ea.Rba,u.AFrameworkApplication.ga.Jc("MaxGetPolicyRetries",1),ka.Na("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),u.AFrameworkApplication.Ea.Kb.Im));ka.register(Hh,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ma().na(()=>
new Hh(u.AFrameworkApplication.vb,u.AFrameworkApplication.Ea,u.AFrameworkApplication.ga,ka.ge("Common.App.Policy.Contracts.IPolicyManager")));this.Ha=ka}Wvl(ka,ib,Rb,tc=null,xc=null,hd=null,Fd=null){ka=new Te.a(ka,ib,null);ka.id=Rb;ka.closeable=!0;tc&&ka.Bye(xc,tc);hd&&ka.addButton(Fd,hd,Fd);return ka}static main(){L.a.instance.Fc(new Kk)}}Object(m.a)(Kk,"PackageManager",null,[3,4]);var ol=a(485),pi=a(454),Uj=a(330);class sk extends pi.a{constructor(){super();this.fullDocSITs=this.partialDocSITs=
null;this.H_=Object.assign(new Uj.a,{T_:sk.getTypeName(),B_:sk.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static getBaseTypes(){return[]}}Object(m.a)(sk,"SecurityShared",pi.a,[]);class $i extends sk{constructor(){super();this.existingLabelPriority=null;this.H_=Object.assign(new Uj.a,{T_:$i.getTypeName(),B_:$i.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}Object(m.a)($i,
"CLP",sk,[]);var Dl=a(431),El=a(422),Rl=a(696);class mk extends sj.a{constructor(ka){super();this.TenantId=null;this.TenantId=ka}Gn(){return 103}}Object(m.a)(mk,"GetAppliedPolicyIdRequest",sj.a,[]);class al extends Sys.EventArgs{constructor(ka){super();this.mzb=ka}}Object(m.a)(al,"OnAppliedPolicyReceivedEventArgs",Sys.EventArgs,[]);class fl{constructor(ka,ib,Rb){this.ota=this.AFj=this.Rnh=null;this.ua=new Gg.a;this.VEe=!1;this.qm=ka;this.vYd=ib;this.Fb=Rb;this.vYd.uel(Object(K.a)(this,this.fPl,"onAppliedPolicyIdReady"));
this.vYd.Lel(Object(K.a)(this,this.sQl,"onIsManuallyAppliedReady"))}eqm(ka){this.ua.addHandler("AppliedPolicyEventReceivedKey",ka)}dispose(){this.vYd.KYl(Object(K.a)(this,this.fPl,"onAppliedPolicyIdReady"));this.vYd.WYl(Object(K.a)(this,this.sQl,"onIsManuallyAppliedReady"))}pCe(ka,ib){ka?(this.ota=ka,this.Rnh=ib,ka=new nh.a(new mk(ka),Rb=>{this.$bd(Rb)},Rb=>this.bbb(Rb)),this.qm.Qb(ka)):Ob.a.J(507843486,822,15,"GetAppliedPolicyIdAsync: tenantId is null or empty")}MPm(ka,ib){!ib||ra.a.rb(ka)?Ob.a.J(507843485,
822,15,"GetIsManuallyAppliedAsync: tenantId or callback is null or empty"):(this.ota=ka,this.AFj=ib,ka=new nh.a(new mk(ka),Rb=>{this.$bd(Rb)},Rb=>this.bbb(Rb)),this.qm.Qb(ka))}fPl(ka,ib){ka="";ra.a.rb(ib.mzb)||(ka=ib.mzb);"00000000-0000-0000-0000-000000000000"===ka?(ib=ra.a.rb(this.ota)?this.Fb.La("TenantId"):this.ota,this.pCe(ib,this.Rnh)):this.GYj(ka,null)}sQl(ka,ib){this.tqn(ib.VEe)}$bd(ka){let ib=null;ka.ServerError&&0!==ka.ServerError.Code?ib=Bg.a[ka.ServerError.Code]:0!==ka.StatusCode&&(ib=
Hf.a[ka.StatusCode]);ib&&this.GYj("",ib)}bbb(){Ob.a.J(507843484,822,15,"OnGetAppliedPolicyIdFailed()");this.GYj("","ErrorGetAppliedPolicyIdFailed");return!0}GYj(ka,ib){ib&&Ob.a.J(507843483,822,15,"OnAppliedPolicyIdReceived: error: "+ib);this.Rnh?this.Rnh(ka,ib):Ob.a.J(507843482,822,15,"m_getAppliedPolicyIdCallback is null");Ob.a.J(507843481,822,50,"OnAppliedPolicyIdReceived: Triggering OnAppliedPolicyReceivedEvent");ka=new al(ka);this.ua.raiseEvent("AppliedPolicyEventReceivedKey",ka)}tqn(ka){this.AFj?
this.AFj(ka,null):Ob.a.J(507843479,822,15,"m_getIsManuallyAppliedCallback is null")}}Object(m.a)(fl,"AppliedPolicyIdService",null,[1136,24]);class nk{constructor(ka,ib,Rb,tc){this.tHe=ka;this.BEc=ib;this.ANa=Rb;this.la=tc}Fna(ka){const ib=(ka.automatic||{}).id;var Rb=ka.recommended||{};ka=Rb.id;Rb=Rb.policyTip;this.la.pKe?this.tHe.Lgl(ib,ka,Rb,!this.ANa.uD.AppliedPolicyId||!this.BEc.VEe):this.tHe.Lgl(ib,ka,Rb,!this.ANa.uD.AppliedPolicyId)}}Object(m.a)(nk,"AutoClpAnnotationEventHandler",null,[]);class ii{constructor(){this.ApplyLabelType=
0;this.LabelJson=this.LabelId=this.DocLocation=null;this.SkipContentMarking=!1;this.UserPrincipalName=this.UserName=this.TenantId=null}}Object(m.a)(ii,"PolicyInfo",null,[]);var gl=a(1229);class Xk{constructor(){this.uJe=this.startTime=null}}Object(m.a)(Xk,"PollingData",null,[]);class hl{constructor(ka,ib,Rb,tc,xc,hd,Fd,Td,na,$a,Fb,Xb){this.ULl=this.QGe=!1;this.fnh=null;this.JJl=!1;this.ia=ka;this.tHe=ib;this.ANa=Rb;this.ota=tc;this.yHl=new N.a;this.ccn=xc;this.BEc=hd;this.Tb=Fd;this.SLl=Td;this.Gr=
na;this.Oca=$a;this.fv=Fb;this.fc=Xb;this.YKl=u.AFrameworkApplication.ga.Jc("ClpLabelPollingIntervalMs",3E4);this.tLj=u.AFrameworkApplication.ga.Jc("ClpLabelPollingTimeoutMs",3E5);this.VEa=u.AFrameworkApplication.ga.La("UserName");this.cfn=u.AFrameworkApplication.ga.La("UserPrincipalName");this.zbn=this.mOm()}mOm(){let ka;(ka=u.AFrameworkApplication.ga.La("EditDocInClientUrl"))||(ka=u.AFrameworkApplication.ga.La("WOPISrc"));return ka}dispose(){this.tHe=null;if(this.QGe){this.ANa.tZl(Object(K.a)(this,
this.pRl,"onSetLabelSucceeded"));for(const ka of this.yHl)this.ANa.tZl(ka)}}init(){this.tHe.Hb();this.tHe.ve();if(u.AFrameworkApplication.ga.getBooleanAppSetting("PPTClpSwitchEnabled")&&u.AFrameworkApplication.ga.getBooleanAppSetting("SupportsOfficeClientCoauthoring")){const ka=Object(fe.a)(gl.a,Rc.App.ji);ka&&this.ANa.gEn(Object(K.a)(ka,ka.Ugl,"areAllCoauthorsInSessionClientMipTrusted"));this.ANa.w1m(this.ccn);0<this.YKl&&0<this.tLj&&this.BEc.eqm(Object(K.a)(this,this.zpn,"onDocumentContentPolicyChanged"));
u.AFrameworkApplication.R$a&&this.SLl.pEn(()=>this.Gr.uAh);this.Gr.Nca&&(Ob.a.J(512263630,822,50,"PPTPolicyManager::Init - Setting LockId to {0}",this.Gr.Nca),this.ANa.ZAk(this.Gr.Nca));this.Oca.qel(()=>{Ob.a.J(512263629,822,50,"PPTPolicyManager::LockIdChanged - Setting LockId to {0}",this.Gr.Nca);this.ANa.ZAk(this.Gr.Nca)})}this.ANa.Tqm(Object(K.a)(this,this.Bsm,"applyUdpLabeling"));this.ANa.DEn(Object(K.a)(this,this.T3m,"isClpBlockedByAppSpecificScenario"));this.ANa.cqm(Object(K.a)(this,this.ysm,
"applyMandatoryLabeling"));this.ANa.J1h(Object(K.a)(this,this.pRl,"onSetLabelSucceeded"));this.QGe=!0}Bsm(ka,ib){ib.wOn&&u.AFrameworkApplication.vb.Cb(Pb.a.openInClient,2)}T3m(){const ka=!this.fc.getState(2)&&!this.fc.v9c;this.ULl!==ka&&(this.fc.Dzj(),Ob.a.J(512263628,822,50,"PPTPolicyManager::IsClpBlockedByAppSpecificScenario - {0}",ka),this.ULl=ka);return ka}get mzb(){return this.ANa.uD.AppliedPolicyId}IEn(ka){this.ANa.J1h(ka);this.yHl.add(ka)}bvn(ka,ib,Rb){const tc=new ii;tc.TenantId=this.ota;
tc.LabelId=ka;tc.ApplyLabelType=ib;tc.LabelJson=hl.EJm(ca.c(Rb));tc.SkipContentMarking=!1;tc.UserName=this.VEa;tc.UserPrincipalName=this.cfn;tc.DocLocation=this.zbn;Ob.a.J(512263627,822,50,"PersistLabelToWorker: Updating worker with received policy");this.ia.Qa(Pb.a.Ish,2,tc)}ysm(ka,ib){if(ib&&0!==ib.M3h){(ka=1===ib.M3h)?this.fv.syh():(this.fv.ryh(),""!==ib.VMl&&this.SLl.zsm(ib.VMl));ib=ka?1:3;var Rb=u.AFrameworkApplication.vb.mode;ib!==Rb?Ob.a.J(512263625,822,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",
ib,Rb):this.JJl=ka}else Ob.a.J(512263626,822,50,"ApplyMandatoryLabelling is called with invalid inputs.")}pRl(ka,ib){this.bvn(ib.XTl,ib.Tfb,this.ANa.uD);Ob.a.J(512263624,822,50,"OnSetLabelSucceeded: Set policy label to ppt file after set label succeeded on host.")}kCi(ka){ka&&this.mzb?ka=this.mzb.toLowerCase()===ka.toLowerCase():(Ob.a.J(512263623,822,50,"FLabelIdMatchesPolicyManager: null labelId or null AppliedPolicyId, can't compare case insensitively. fNullLabelId:{0} fNullAppliedPolicyId:{1}",
!ka,!this.mzb),ka=ka===this.mzb);Ob.a.J(512263622,822,50,"FLabelIdMatchesPolicyManager: fLabelIdMatchesPolicyManager:{0}",ka);return ka}iwn(ka){const ib=Object(fe.a)(Xk,ka.customData);if(ib){var Rb=+new Date-+ib.startTime;Ob.a.J(512263620,822,50,"PollingTaskCallback: Callback received, durationMs:{0}",Rb);this.kCi(ib.uJe)||Rb>this.tLj||ib.uJe!==this.fnh?(Ob.a.J(512263619,822,50,"PollingTaskCallback: Stopping loop due to FAreInSync:{0} fDidTimeout:{1} fStaleLabelId:{2}",this.kCi(ib.uJe),Rb>this.tLj,
ib.uJe!==this.fnh),this.Tb.li(ka)):(Ob.a.J(512263618,822,50,"PollingTaskCallback: Triggering GetPolicy call"),this.ANa.Jac(ib.uJe,void 0,hl.bKb,!0))}else Ob.a.J(512263621,822,15,"PollingTaskCallback: Failed to get pollingData from taskItem, removing task"),this.Tb.li(ka)}WSn(ka){Ob.a.J(512263617,822,50,"SubmitPollingTask: Submitting new polling task");const ib=new Wa.a(2,2,this.YKl,Object(K.a)(this,this.iwn,"pollingTaskCallback"),90,"113");ib.customData=Object.assign(new Xk,{startTime:new Date,uJe:ka});
this.Tb.Qb(ib)}zpn(ka,ib){Ob.a.J(512263616,822,50,"OnDocumentContentPolicyChanged: Notification received");ib.mzb||Ob.a.J(512263587,822,50,"OnDocumentContentPolicyChanged: Empty labelId - could indicate bug or all labels removed");this.fnh=ib.mzb;this.kCi(this.fnh)?Ob.a.J(512263586,822,50,"OnDocumentContentPolicyChanged: PODS is in agreement with SPO, no need to poll"):this.WSn(ib.mzb)}static bKb(){const ka=Rc.App.ji.amIAlone,ib=Rc.App.ji.bKb;let Rb=!1;const tc=Object(fe.a)(gl.a,Rc.App.ji);tc&&(Rb=
tc.Vgl());Ob.a.J(512263585,822,50,"AmITheOnlyCoauthor: Used block self coauth flow, fAmIAlone:{0} fAmITheOnlyCoauthor:{1} fAreAllCoauthorsWebClients:{2}",ka,ib,Rb);return ka||ib&&Rb}static EJm(ka){ka=ka.replace(RegExp(":null","gi"),':""');return ka=ka.replace(RegExp('"LabelActions":',"gi"),'"Actions":')}}Object(m.a)(hl,"PptPolicyManager",null,[24]);class wl{constructor(ka,ib,Rb,tc){this.Fan=ka;this.oc=ib;this.Mb=Rb;this.la=tc}Hb(){this.Fan.sa(Pb.a.Ish,sg.a.application,Object(K.a)(this,this.XVm,"handleApplySensitivity"),
4)}ve(){}XVm(ka,ib,Rb,tc,xc){if(!(u.AFrameworkApplication.ga.getBooleanAppSetting("WacLabelingPoliciesIsEnabled")&&u.AFrameworkApplication.ga.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled")&&this.la.P2b&&this.la.Icd&&u.AFrameworkApplication.ga.getBooleanAppSetting("SupportsPolicies")))return 16;if(ib.contextId!==sg.a.application)return 2;if(!xc||!Object(Kd.a)(ii,xc))return 8;ka=Object(fe.a)(ii,xc);if(ra.a.rb(ka.TenantId))return Ob.a.J(507843082,808,10,"The tenant id of policy info is empty or null"),
8;if(ra.a.rb(ka.LabelJson))return Ob.a.J(507843081,808,10,"The label json of policy info is empty or null"),8;if(1===Rb)return 32;Rb=this.oc.jn;ib=this.Mb.Fd(7);try{ib.rc(Rb),Rb.mbb=ka}finally{ib&&ib.dispose()}return 32}}Object(m.a)(wl,"SetPolicyActor",null,[743]);class Sl{constructor(){this.EBj=this.dph=this.Fb=this.BEc=this.$=null;this.eLl=!0}get name(){return"PowerPointWebEditor.Policy"}lc(ka){this.$=ka;this.$.register(1136,"PowerPointWebEditor.Policy.IAppliedPolicyIdService").ma().na(()=>new fl(this.$.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.$.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler"),this.$.resolve("Common.IAppSettingsManager")))}init(){this.Fb=this.$.resolve("Common.IAppSettingsManager");this.Fb.N$a(Object(K.a)(this,this.su,"onFullAppSettingsReady"))}dispose(){}su(){this.Fb.getBooleanAppSetting("WacLabelingPoliciesIsEnabled")&&this.Fb.getBooleanAppSetting("SupportsPolicies")&&this.Fb.getBooleanAppSetting(Dc.a.P2b)&&(this.BEc=this.$.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),Wf.a.get_instance().$i(10,
Object(K.a)(this,this.gwg,"onAfterRibbonDisplayed")),ol.a.aG(this.$.Na("Common.App.Policy.Contracts.IPolicyManager")).continueWith(ka=>{const ib=new wl(this.$.resolve("Common.IActionManagerExtended"),this.$.resolve("PowerPointWebEditor.IPresentationReader"),this.$.resolve("Common.Transaction.ITransactionFactory"),this.$.resolve("PowerPointWebEditor.IApplicationSettings"));ka=ka.result;this.dph=new hl(this.$.resolve("Common.IActionManagerExtended"),ib,ka,this.Fb.La("TenantId"),this.$.Na("Common.Interface.IRtcBasicProvider"),
this.$.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),this.$.resolve("Common.ITaskManager"),this.$.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.$.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.$.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.$.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),this.$.resolve("PowerPointWebEditor.Core.IUnifiedAppState"));this.dph.init()}))}gwg(){ol.a.aG(this.$.Na("Common.App.Policy.Contracts.IPolicyManager")).continueWith(ka=>
{const ib=ka.result;u.AFrameworkApplication.ga.getBooleanAppSetting("AutoClpIsEnabled")&&(Ob.a.J(512274584,822,50,"OnAfterRibbonDisplayed: Registering with GetAutoPolicyLabelHandler API"),this.EBj=new M.a(()=>new nk(this.$.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.$.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),ib,this.$.resolve("PowerPointWebEditor.IApplicationSettings"),this.Fb.La("TenantId"))),ib.Vpm(Object(K.a)(this,this.hEn,"registerAutoClpAnnotationEventHandler")),
ib.Spm(Object(K.a)(this,this.Cmi,"createAutoCLPSecurityNodes")),ib.Uqm(Object(K.a)(this,this.gXn,"updateAutoCLPLabelPriorityNode")),ib.Vqm(Object(K.a)(this,this.hXn,"updateAutoCLPSITNodes")));ka=this.Fb.La("AppliedPolicyId");const Rb=u.AFrameworkApplication.ga.getBooleanAppSetting("PPTOCoauthorPopUpFixManualCLPEnabled")?hl.bKb:void 0;ka||u.AFrameworkApplication.ga.getBooleanAppSetting("PPTClpSwitchEnabled")&&u.AFrameworkApplication.ga.getBooleanAppSetting("SupportsOfficeClientCoauthoring")?ib.Bnj()?
ib.gUl(Rb):ib.Jac(ka,void 0,Rb):(ka=this.Fb.La("TenantId"),ra.a.rb(ka)?Ob.a.J(512274583,822,15,"OnAfterRibbonDisplayed: tenantId is null or empty"):(Ob.a.J(512274582,822,50,"OnAfterRibbonDisplayed: Call AppliedPolicyIdService.GetAppliedPolicyIdAsync"),this.BEc.pCe(ka,(tc,xc)=>{xc&&Ob.a.J(512274581,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync failed: "+xc);ra.a.rb(tc)&&(tc="",Ob.a.J(512274580,822,50,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync: appliedPolicyIdInFile is empty"));
ib.Bnj()?ib.gUl(Rb):ib.Jac(tc,void 0,Rb)}),this.BEc.MPm(ka,(tc,xc)=>{xc?Ob.a.J(512274579,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetIsManuallyAppliedAsync failed: "+xc):this.BEc.VEe=tc}),this.dph.IEn(Object(K.a)(this,this.KXn,"updateIsManuallyApplied"))))})}hEn(){const ka=this.$.resolve("PowerPointWebEditor.Core.IUnifiedAppState");this.eLl&&(ka.Mp||this.dph.JJl&&ka.F9c)&&(this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(ib=>{Ob.a.J(512274578,822,50,
"RegisterAutoClpAnnotationEventHandler: Registering with AugLoopRuntimeManager");ib.e0("AugLoop_SecurityClp_LabellingAnnotation");ib.GBa("AugLoop_SecurityClp_LabellingAnnotation",Object(K.a)(this.EBj.value,this.EBj.value.Fna,"handleAnnotationEvent"))}),this.eLl=!1)}Cmi(ka,ib){ka=[Object.assign(new El.a,{id:"clp",body:Object.assign(new $i,{existingLabelPriority:ib.existingLabelPriority,partialDocSITs:ib.qkl,fullDocSITs:ib.pkl})})];const Rb=Object.assign(new Dl.a,{parentPath:["session","doc","security"],
items:ka});this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(tc=>{Ob.a.J(512274577,822,50,"CreateAutoCLPSecurityNodes: Submit AddOperations to AugLoopRuntimeManager");tc.submitOperation(Rb)})}gXn(ka,ib){ka=[Object.assign(new El.a,{id:"clp",body:Object.assign(new $i,{existingLabelPriority:ib.existingLabelPriority})})];const Rb=Object.assign(new Rl.a,{parentPath:["session","doc","security"],items:ka});this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(tc=>
{Ob.a.J(512274576,822,50,"UpdateAutoCLPLabelPriorityNode: Submit UpdateOperation to AugLoopRuntimeManager");tc.submitOperation(Rb)})}hXn(ka,ib){ka=[Object.assign(new El.a,{id:"clp",body:Object.assign(new $i,{partialDocSITs:ib.qkl,fullDocSITs:ib.pkl})})];const Rb=Object.assign(new Rl.a,{parentPath:["session","doc","security"],items:ka});this.$.Na("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(tc=>{Ob.a.J(512274575,822,50,"updateAutoCLPSITNodes: Submit UpdateOperation to AugLoopRuntimeManager");
tc.submitOperation(Rb)})}KXn(ka,ib){ib&&(this.BEc.VEe=ib.XTl&&0!==ib.Tfb?2===ib.Tfb||8===ib.Tfb||16===ib.Tfb?!0:!1:!1)}static main(){L.a.instance.Fc(new Sl)}}Object(m.a)(Sl,"PPTWebEditorPolicyPackage",null,[3,4]);var $l=a(154);Type.registerNamespace("B4Intent");Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCorrections");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");
Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointSafeLinks");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Activity");Type.registerNamespace("PowerPointWebEditor.Animations");Type.registerNamespace("PowerPointWebEditor.Dictation");Type.registerNamespace("PowerPointWebEditor.FirstRunExperience");Type.registerNamespace("PowerPointWebEditor.Policy");Type.registerNamespace("PowerPointWebEditor.RevisionTracking");
Object($l.c)("Chronosslim");(()=>{var ka;null!==(ka=u.AFrameworkApplication.ga)&&void 0!==ka&&ka.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DemandLoadApplicationFeatureHelper",!1)||(Type.registerNamespace("Common"),Type.registerNamespace("Common.App.ApplicationFeatureHelper"),h.ApplicationFeatureHelperPackage.main())})();Type.registerNamespace("Common.App.CatchUpActivity");O.main();Type.registerNamespace("Common.App.Rename");L.a.instance.Fc(new Cb,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");
L.a.instance.Fc(new rb);Type.registerNamespace("Common.App.SafeLinks");cc.main();xe.main();vh.main();Ff.main();bj.main();tg.main();ud.main();Ni.main();L.a.instance.Fc(new mg);Ji.main();L.a.instance.Fc(new Zd);Xe.main();Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");Kk.main();Sl.main();ak.main();Object($l.b)("Chronosslim")},428:function(x,G,a){a.r(G);a.d(G,"CuiHelperStatic",function(){return b});
x=a(0);var c=a(329);class b{static addButton(f,e,h,u,m,n,l,r){e=c.a(f,e,h,u,null,null,null,n,null,null,void 0,void 0,m);(f=r.hostControl(f,e,n))&&l.appendChild(f);return f}}b.Dta="btnReplyWithChanges";Object(x.a)(b,"CuiHelperStatic",null,[])},447:function(x,G,a){a.d(G,"a",function(){return W});x=a(0);var c=a(17),b=a(528);a(649);var f=a(4),e=a(22),h=a(19),u=a(10),m=a(6);class n{}Object(x.a)(n,"RibbonUpsellButtonCreator",null,[]);class l extends Sys.EventArgs{constructor(L){super();this.l6g=L}}Object(x.a)(l,
"TopRowCreatedEventArgs",Sys.EventArgs,[]);var r=a(576),w=a(483);a(47);var y=a(329);a(37);a(135);var z=a(391),A=a(79),B=a(3);class H{constructor(L,O){this.cluster=L;this.p6c=O}}Object(x.a)(H,"ImageInfo",null,[]);class v{constructor(L,O,M,K,P,V,Y,ta,fa,Ta,ha,qa,ra,I,ba=null,Ga=null){this.id=L;this.l4c=O;this.p4c=M;this.o4c=K;this.n4c=P;this.m4c=V;this.Ysd=Y;this.uye=ta;this.g7b=new H(fa,Ta);this.ope=new H(ha,qa);this.$9d=new H(ra,I);ba&&Ga&&new H(ba,Ga)}}Object(x.a)(v,"PeoplesWellBaseSettings",null,
[]);class C{constructor(){this.FKb=null}}Object(x.a)(C,"BreadcrumbControls",null,[]);class F{constructor(L){this.id=L}}new F("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32");Object(x.a)(F,"ChatButtonSettings",null,[]);class D{constructor(){this.id=this.image=this.label=this.command=null}}Object(x.a)(D,"SkypeButtonInfo",null,[]);class N{constructor(){this.u8a=this.l8b=this.aYa=null}}Object(x.a)(N,"TopRowControls",null,[]);var U=a(94);a(5);class W{constructor(L,
O,M=null,K=null,P=null){var V;this.i9=L;this.gWa=U.a.Xqh(O,P);(null===(V=f.AFrameworkApplication.ga)||void 0===V?0:V.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableNewCommonStringLoad",!1))?(this.gWa.push(CommonUiStrings),"undefined"!==typeof CommonUIStrings&&this.gWa.push(CommonUIStrings)):this.gWa.push(CommonUIStrings);b.b();W.ya=void 0===M||null===M?f.AFrameworkApplication.vb:M;void 0!==K&&null!==K||this.iwd()}iwd(){Object(m.a)("SignoutLink");Object(m.a)("SignIn")}static get yMd(){return W.tja||
(W.tja=h.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static Mhh(L,O,M,K,P,V){return new v(W.iCb,u.a.edh,u.a.Q5c,u.a.hdh,u.a.gdh,u.a.fdh,u.a.idh,u.a.Dzb,L,O,M,K,P,V,null,null)}static xrf(L){L.aYa&&(W.jCd(L.aYa),L.aYa=null);L.l8b&&(W.iCd(),L.l8b=null);L.u8a&&(W.kCd(L.u8a),L.u8a=null);W.yMd.yHg();let O;({C$a:O}=w.a.jcb(!1)).returnValue&&e.a.LDa(O)}static ORb(){f.AFrameworkApplication.vb.Cb(u.a.ORb,2)}static iCd(){f.AFrameworkApplication.bac&&A.EventHandlerManager.instance.H0c(f.AFrameworkApplication.bac)}static addButton(L,
O,M,K,P,V,Y,ta){O=y.a(L,O,M,K,null,null,null,V,null,null,void 0,void 0,P);(L=ta.hostControl(L,O,V))&&Y.appendChild(L);return L}static yMb(L,O,M,K,P){let V;K?(V=document.createElement("a"),V.href=K,V.target="_top",z.a.instance.xbb(B.a.click,V,W.tae,null,!0)):P?(V=document.createElement("div"),V.tabIndex=0):V=document.createElement("span");V.className="BreadcrumbItem"+(P?" Selectable":"");V.id=O;V.innerText=M;V.setAttribute("dir","auto");L.appendChild(V);return V}static jCd(L){L.FKb&&A.EventHandlerManager.instance.vzh(L.FKb)}static tae(L){const O=
r.a.instance.Ao(u.a.ech);O.properties.add("id",L.Oj.id);O.end();c.ULS.sendTraceTag(595732178,207,50,"Breadcrumb link clicked: {0}",{["id"]:L.Oj.id});return W.qEb?W.qEb(L):!1}static kCd(L){z.a.instance.Fte(B.a.click,L,W.Xbe,!0)}static Xbe(){f.AFrameworkApplication.w1c?(f.AFrameworkApplication.Ea.ywb(f.AFrameworkApplication.Ea.Kb.RCe()),f.AFrameworkApplication.w1c=!1):window.top.location=f.AFrameworkApplication.signInUrl;return!0}static bBb(){return!!f.AFrameworkApplication.Ea&&f.AFrameworkApplication.Ea.Kb.bBb}}
W.tja=null;W.VSg="ShareServerWhite_20x20x32";W.nac="ExternalHeaderFullTopBars";W.uDe="HeaderTopBars";W.w$b="BreadcrumbBrand";W.x$b="BreadcrumbFolder";W.y$b="BreadcrumbTitle";W.s7c="FolderSeparator";W.hOe="sbTellMe";W.vNe="TellMe-SearchBox";W.icd="btnOpenInClient";W.yec="btnFileSharing";W.yVg="BasicChat";W.Dta="btnReplyWithChanges";W.g7c="jbtnGiveFeedback";W.iCb="PeoplesWellControl";W.Usf="EditableBreadcrumbItem";W.ya=null;W.qEb=null;W.G0c=50;W.cMf=null;Object(x.a)(W,"CuiHelper",null,[67])},459:function(x,
G,a){a.d(G,"f",function(){return v});a.d(G,"e",function(){return C});a.d(G,"d",function(){return F});a.d(G,"c",function(){return D});a.d(G,"g",function(){return N});a.d(G,"b",function(){return U});a.d(G,"a",function(){return W});a.d(G,"h",function(){return L});var c=a(435),b=a(923),f=a(1612),e=a(5),h=a(387),u=a(4);x=a(0);class m{constructor(){this.g=this.b=0;this.hex=null;this.r=0}}Object(x.a)(m,"RecentColor",null,[]);var n=a(370),l=a(357),r=a(362),w=a(405),y=a(845),z=a(567),A=a(248),B=a(491),H=a(250);
const v=(M,K,P,V,Y,ta,fa)=>C(M,K,P,V,Y,ta,fa,!1),C=(M,K,P,V,Y,ta,fa,Ta)=>{K=Object.assign(new c.a,{Id:K,ControlsId:P,Title:ResourceStrings.L_ThemeFontColor,ControlList:[]});V=Object.assign(new b.a,{Id:V,ExternalId:Y,McuExternalId:String.format("{0}MCU",Y),McuLayout:!0,Command:ta,Width:10});if(M)if(Y=[],1===fa||2===fa){Ta=(new y.a).eBf(M);({themeColors:M,Z7b:fa}=O(Ta,M));for(var ha=0;6>ha;ha++)for(var qa=0;qa<M.length;qa++){ta=Y;P=ta.push;var ra=Ta;var I=M[qa][ha],ba=M[qa][0],Ga=fa[qa],Oa=ha,Ja=qa;
I=e.a.Fw(I.r,2)+e.a.Fw(I.g,2)+e.a.Fw(I.b,2);const {J9a:Qa,Uta:Pa}=ra.kPb(ba,I,Ga,Oa,Ja);ra=Object.assign(new f.a,{Color:"#"+Qa,DisplayColor:"#"+I,Alt:Pa});P.call(ta,ra)}}else for(Ta=(new y.a).PGd(M,Ta),{themeColors:M,Z7b:fa}=O(Ta,M),ha=0;6>ha;ha++)for(qa=0;qa<M.length;qa++){ta=Y;P=ta.push;ra=Ta;I=M[qa][ha];ba=M[qa][0];Ga=fa[qa];Oa=ha;Ja=qa;I=e.a.Fw(I.r,2)+e.a.Fw(I.g,2)+e.a.Fw(I.b,2);const {J9a:Qa,Uta:Pa}=ra.kPb(ba,I,Ga,Oa,Ja),{rgb:ja,OOg:va,Uta:Ha}={rgb:I,OOg:Qa,Uta:Pa};ra=Object.assign(new f.a,{Color:va,
DisplayColor:"#"+ja,Alt:Ha});P.call(ta,ra)}else Y=null;V.Colors=Y;Array.add(K.ControlList,V);return K},F=(M,K,P,V,Y,ta)=>{M=Object.assign(new c.a,{Id:M,ControlsId:K,Title:ResourceStrings.L_StandardFontColor,ControlList:[]});P=Object.assign(new b.a,{Id:P,ExternalId:V,Command:Y,Width:10,Colors:[]});ta?(P.Colors.push(Object.assign(new f.a,{Color:"0000C0",Alt:e.a.Re(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),P.Colors.push(Object.assign(new f.a,{Color:"0000FF",Alt:e.a.Re(ResourceStrings.L_FontColorRed),
DisplayColor:"#FF0000"})),P.Colors.push(Object.assign(new f.a,{Color:"00C0FF",Alt:e.a.Re(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),P.Colors.push(Object.assign(new f.a,{Color:"00FFFF",Alt:e.a.Re(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),P.Colors.push(Object.assign(new f.a,{Color:"50D092",Alt:e.a.Re(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),P.Colors.push(Object.assign(new f.a,{Color:"50B000",Alt:e.a.Re(ResourceStrings.L_FontColorDarkGreen),
DisplayColor:"#00B050"})),P.Colors.push(Object.assign(new f.a,{Color:"F0B000",Alt:e.a.Re(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),P.Colors.push(Object.assign(new f.a,{Color:"C07000",Alt:e.a.Re(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),P.Colors.push(Object.assign(new f.a,{Color:"602000",Alt:e.a.Re(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),P.Colors.push(Object.assign(new f.a,{Color:"A03070",Alt:e.a.Re(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"}))):
(P.Colors.push(Object.assign(new f.a,{Color:"#C00000",Alt:e.a.Re(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),P.Colors.push(Object.assign(new f.a,{Color:"#FF0000",Alt:e.a.Re(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),P.Colors.push(Object.assign(new f.a,{Color:"#FFC000",Alt:e.a.Re(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),P.Colors.push(Object.assign(new f.a,{Color:"#FFFF00",Alt:e.a.Re(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),P.Colors.push(Object.assign(new f.a,
{Color:"#92D050",Alt:e.a.Re(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),P.Colors.push(Object.assign(new f.a,{Color:"#00B050",Alt:e.a.Re(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),P.Colors.push(Object.assign(new f.a,{Color:"#00B0F0",Alt:e.a.Re(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),P.Colors.push(Object.assign(new f.a,{Color:"#0070C0",Alt:e.a.Re(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),P.Colors.push(Object.assign(new f.a,
{Color:"#002060",Alt:e.a.Re(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),P.Colors.push(Object.assign(new f.a,{Color:"#7030A0",Alt:e.a.Re(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"})));Array.add(M.ControlList,P);return M},D=(M,K,P,V,Y,ta,fa)=>{K=Object.assign(new c.a,{Id:K,ControlsId:P,Title:ResourceStrings.L_RecentColors,ControlList:[]});V=Object.assign(new b.a,{Id:V,ExternalId:Y,Command:ta,Width:10,Colors:[]});if(fa)for(fa=0;M&&fa<M.length&&M[fa];fa++)Y=M[fa],V.Colors.push(Object.assign(new f.a,
{Color:Y.hex,Alt:e.a.Re(Y.hex),DisplayColor:Y.hex}));else for(fa=0;M&&fa<M.length&&M[fa];fa++)Y=M[fa],V.Colors.push(Object.assign(new f.a,{Color:"#"+Y.hex,Alt:B.a.W7c("#"+Y.hex).toString(),DisplayColor:"#"+Y.hex}));Array.add(K.ControlList,V);return K},N=(M,K)=>{if(!K)return M;var P=new m;P.hex=K;const V=[];let Y=0;V[Y++]=P;for(P=0;M&&P<M.length&&10>P&&10>Y&&M[P];P++)M[P].hex!==K&&(V[Y++]=M[P]);return V},U=(M,K,P,V,Y,ta,fa,Ta)=>{M=Object.assign(new c.a,{Id:M,ControlsId:K,DisplayMode:"Menu16",ControlList:[]});
P=Object.assign(new h.a,{Command:P,LabelText:V,Image16by16:u.AFrameworkApplication.jp,Image16by16Class:fa,Id:Y,ExternalId:ta,KeyTip:Ta});Array.add(M.ControlList,P);return M},W=(M,K,P,V,Y,ta,fa,Ta)=>{M=Object.assign(new c.a,{Id:M,ControlsId:K,DisplayMode:"Menu16",ControlList:[]});P=Object.assign(new h.a,{Command:P,LabelText:V,Image16by16:u.AFrameworkApplication.jp,Image16by16Class:fa,Id:Y,ExternalId:ta,KeyTip:Ta});Array.add(M.ControlList,P);return M},L=(M,K,P)=>{for(let ra=0;ra<M.MenuSectionList.length;ra++){var V=
M.MenuSectionList[ra],Y=V.ControlList;if(Y&&0<Y.length&&(Y=Y[0]))if(K)if(V.Id===z.a.themeColors&&P){var ta=r.i(K.VA)||"";V=P;var fa=Y.Colors,Ta="#";if(fa&&fa.length)if(e.a.rb(ta))A.a.J(508694662,820,10,"selectedFontColor should not be empty in FindSelectedThemeColor");else for(var ha=0;ha<fa.length;ha++){var qa=fa[ha].Color;if(!e.a.rb(qa)&&(qa=(qa=l.a.parse(fa[ha].Color))?qa.LUa():w.SchemeColor.parse(fa[ha].Color),V&&qa&&qa.ndd(V)&&qa.Rja&&(qa=r.i(qa.SM),qa.toLowerCase()===ta.toLowerCase()))){Ta=
fa[ha].Color;break}}V=Ta;Y.SelectedColorId=V}else{fa=r.i(r.g(K.VA))||"";V=Y.Colors;ta="#";if(V&&V.length)if(e.a.rb(fa))A.a.J(508694661,820,10,"selectedFontColor should not be empty in FindSelectedStandardColor");else for(Ta=0;Ta<V.length;Ta++)if(ha=V[Ta].DisplayColor,!e.a.rb(ha)&&ha.replace("#","").toLowerCase()===fa.toLowerCase()){ta=V[Ta].Color;break}V=ta;Y.SelectedColorId=V}else Y.SelectedColorId="#"}},O=(M,K)=>{if(H.a("PPTO_PICTURES_BUG_7720204_PERF_FIX")&&(!K||null===K.PresetSchemeColorMapping))return{themeColors:[],
Z7b:[]};const P=Array(10);P[0]=M.Nv(n.Color.oh(K.PresetSchemeColorMapping.Background1));P[1]=M.Nv(n.Color.oh(K.PresetSchemeColorMapping.Text1));P[2]=M.Nv(n.Color.oh(K.PresetSchemeColorMapping.Background2));P[3]=M.Nv(n.Color.oh(K.PresetSchemeColorMapping.Text2));P[4]=M.Nv(n.Color.oh(K.PresetSchemeColorMapping.Accent1));P[5]=M.Nv(n.Color.oh(K.PresetSchemeColorMapping.Accent2));P[6]=M.Nv(n.Color.oh(K.PresetSchemeColorMapping.Accent3));P[7]=M.Nv(n.Color.oh(K.PresetSchemeColorMapping.Accent4));P[8]=M.Nv(n.Color.oh(K.PresetSchemeColorMapping.Accent5));
P[9]=M.Nv(n.Color.oh(K.PresetSchemeColorMapping.Accent6));M=Array(10);M[0]=ResourceStrings.l_ThemeLabel1;M[1]=ResourceStrings.l_ThemeLabel2;M[2]=ResourceStrings.l_ThemeLabel3;M[3]=ResourceStrings.l_ThemeLabel4;M[4]=ResourceStrings.l_ThemeLabel5;M[5]=ResourceStrings.l_ThemeLabel6;M[6]=ResourceStrings.l_ThemeLabel7;M[7]=ResourceStrings.l_ThemeLabel8;M[8]=ResourceStrings.l_ThemeLabel9;M[9]=ResourceStrings.l_ThemeLabel10;return{themeColors:P,Z7b:M}}},489:function(x,G,a){a.d(G,"a",function(){return c});
x=a(0);var c;(function(b){b[b.unknown=0]="unknown";b[b.excel=1]="excel";b[b.powerPoint=2]="powerPoint";b[b.word=3]="word";b[b.oneNote=4]="oneNote";b[b.Z5g=5]="visio"})(c||(c={}));Object(x.b)("OfficeAppType",c)},491:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(370);class b{}var f=b;b.$dd={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",
brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",
darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",
lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",
mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",
powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",
yellow:"#ffff00",yellowgreen:"#9acd32"};b.V7=e=>{e=e.toLowerCase().trim().replace(/\s/g,"");return b.$dd[e]?b.$dd[e]:""};b.x5c=e=>e?""!==f.V7(e):!1;b.W7c=e=>{var h=/^#([0-9a-f])*$/i;if(!e||!e.match(h))throw Error("invalid hex color string provided");h=new c.Color;switch(e.length){case 7:h.a=1;h.r=parseInt(e.substring(1,3),16);h.g=parseInt(e.substring(3,5),16);h.b=parseInt(e.substring(5,7),16);break;case 9:h.r=parseInt(e.substring(1,3),16);h.g=parseInt(e.substring(3,5),16);h.b=parseInt(e.substring(5,
7),16);h.a=parseInt(e.substring(7,9),16);break;default:throw Error("unsupported color string provided");}return h};Object(x.a)(b,"ColorTranslator",null,[])},492:function(x,G,a){a.d(G,"a",function(){return e});x=a(0);var c=a(19);class b{constructor(h,u,m,n,l){this.gta=!1;this.IGe=h;this.lGe=u;this.KXd=m;this.zcn=l;this.nHe=n.oAb(m,u.name)}get mch(){return this.KXd}lc(h){this.nHe.Zbh();this.lGe.lc(h);this.nHe.lfh()}init(){this.nHe.qI(this.lGe.name+"_d");this.zcn?this.IGe.MAl(this,this.KXd):this.IGe.LAl(this,
this.KXd)}KAl(){this.nHe.uI(this.lGe.name+"_d");this.nHe.$bh();this.lGe.init();this.gta=!0;this.nHe.nfh()}dispose(){this.gta&&this.lGe.dispose()}get name(){return this.lGe.name}}Object(x.a)(b,"DelayLoadedPackage",null,[1218,3,4]);class f{constructor(h,u){this.IGe=null;h.execute(m=>{this.IGe=m});this.bbn=u}create(h,u,m){return this.IGe?new b(this.IGe,h,u,this.bbn.value,m):h}static get instance(){return f.Wa||(f.Wa=new f(c.a.instance.Na("PowerPointWebEditor.DelayLoadedPackageInitializer"),c.a.instance.ge("PowerPointWebEditor.Core.IBundleMetricRecorder")))}}
f.Wa=null;Object(x.a)(f,"DelayLoadedPackageFactory",null,[]);const e=(h,u)=>f.instance.create(h,u,!1)},515:function(x,G,a){a.d(G,"a",function(){return f});a.d(G,"b",function(){return e});a.d(G,"c",function(){return h});var c=a(4),b=a(489);const f=()=>{const u=c.AFrameworkApplication.Ea.Kb.Im;return(3===u||1===u||2===u||4===u)&&c.AFrameworkApplication.ga.getBooleanAppSetting("PremiumUpsellIsEnabled")},e=(u,m,n,l=!1)=>{m=1===m;1===u&&(m=2===c.AFrameworkApplication.Ea.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",
b.a[u],m?"Editor":"Viewer",l?"Dime":"Unknown",n?n:"dimedefault")},h=u=>{switch(u){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},528:function(x,G,a){a.d(G,"b",function(){return m});a.d(G,"h",function(){return n});a.d(G,"d",function(){return l});a.d(G,"g",function(){return r});a.d(G,"f",function(){return y});a.d(G,"e",function(){return z});a.d(G,"c",function(){return A});a.d(G,"a",function(){return B});
var c=a(4);a(123);var b=a(638),f=a(515);a(58);var e=a(7),h=a(6),u;const m=()=>c.AFrameworkApplication.h8,n=()=>{const H=c.AFrameworkApplication.Ea.Kb.eO;return!m()&&!c.AFrameworkApplication.hideHeader&&f.a()&&(H||1===c.AFrameworkApplication.Zyf)},l=()=>c.AFrameworkApplication.ga.getBooleanAppSetting("DiscoverPremiumButtonEnabled"),r=()=>c.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AnonymousSignInButtonExperiment",!1)&&c.AFrameworkApplication.ga.getBooleanAppSetting("IsAnonymousUser"),
w=()=>c.AFrameworkApplication.hNe&&!m()&&!c.AFrameworkApplication.hideHeader,y=()=>w()&&"officecomhwa"!==(c.AFrameworkApplication.ga.La(c.AFrameworkApplication.QI)||"").toLowerCase()&&!c.AFrameworkApplication.wDe&&!e.a.qTf,z=()=>!c.AFrameworkApplication.V8c&&w(),A=()=>!m()&&!c.AFrameworkApplication.hideHeader&&c.AFrameworkApplication.ga.getBooleanAppSetting("BasicChatIsEnabled"),B=()=>{if(c.AFrameworkApplication.BDe)return null;var H=!!c.AFrameworkApplication.Ea&&c.AFrameworkApplication.Ea.Kb.eO;
if((c.AFrameworkApplication.K9c&&c.AFrameworkApplication.gFa||c.AFrameworkApplication.NDb)&&H)return Object.assign(new b.a,{command:"1197060601",label:Object(h.a)("ReplyWithChanges"),id:a(428).CuiHelperStatic.Dta});if(c.AFrameworkApplication.ifc){H="";switch(c.AFrameworkApplication.l9b){case "Assign":H=Object(h.a)("Assign");break;case "Submit":H=Object(h.a)("Submit")}if(""!==H)return Object.assign(new b.a,{command:"2988588587",label:H,id:"btnWorkflow"})}return null};null===(u=c.AFrameworkApplication.ga)||
void 0===u||u.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HeaderPlaceholderAddNewUx",!1)},530:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);a=a(30);class c extends a.a{constructor(b){super();this._element=null;this.element=b}get element(){return this._element}set element(b){this._element=b}get visible(){return"visible"===this.element.style.visibility}set visible(b){this.element.style.visibility=b?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(b){this.element.dir=
b?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(b){this.element.style.zIndex=String(b)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(b){return this.element.ownerDocument.createElement(b)}q_(){return!0}static GAe(b,f){return b+(f?"Rtl":"")}}Object(x.a)(c,"BasePresenceControl",a.a,[24,62])},531:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c extends Sys.EventArgs{constructor(b,
f){super();this.type=b;this.$g=f}}c.xI="InteractivityChanged";Object(x.a)(c,"InteractivityChangedEventArgs",Sys.EventArgs,[])},567:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.themeColors="Theme Colors";Object(x.a)(c,"ReactColorConstants",null,[])},596:function(x,G,a){a.d(G,"a",function(){return b});var c=a(63);const b=(f,e,h)=>{const u=new c.a;u.gf=0;u.m7(f,e,h);return u}},601:function(x,G,a){a.d(G,"a",function(){return l});x=a(0);var c=a(68),b=a(5),f=a(862),e=a(370),h=a(357),
u=a(362),m=a(526);class n{constructor(r,w){this.Iqa=r;this.description=w}}Object(x.a)(n,"ColorEntry",null,[]);class l{constructor(r){this.vVb={};this.i_b=null;this.Ek=r}get jWg(){if(!this.i_b){const r=new Sys.StringBuilder;for(const w of this.standardColors)r.append(String.format(l.QKb,this.vfd(w.Iqa),this.m8b(w.Iqa),w.description));this.i_b=r.toString()}return this.i_b}get standardColors(){let r;return r=new c.a,r.add(new n(12582912,ResourceStrings.L_FontColorDarkRed)),r.add(new n(16711680,ResourceStrings.L_FontColorRed)),
r.add(new n(16760832,ResourceStrings.L_FontColorOrange)),r.add(new n(16776960,ResourceStrings.L_FontColorYellow)),r.add(new n(9621584,ResourceStrings.L_FontColorLightGreen)),r.add(new n(45136,ResourceStrings.L_FontColorDarkGreen)),r.add(new n(45296,ResourceStrings.L_FontColorLightBlue)),r.add(new n(28864,ResourceStrings.L_FontColorBlue)),r.add(new n(8288,ResourceStrings.L_FontColorDarkBlue)),r.add(new n(7352480,ResourceStrings.L_FontColorPurple)),r}vfd(r){return String.format("#{0}",u.i(r))}m8b(r){return u.i(r)}LUa(r){return Object.assign(new h.a,
{ThemeColor:r.ThemeColor,ColorLuminance:r.ColorLuminance,FTintColor:r.FTintColor}).toString()}Mxc(r,w,y){const z=new Sys.StringBuilder;z.append(this.KKb("ThemeColors",ResourceStrings.L_ThemeFontColor,"ColorPicker",!0,r));this.O$e(z);z.append(this.JKb());z.append(this.KKb("StandardColors",ResourceStrings.L_StandardFontColor,"ColorPicker",!1,r));z.append(this.jWg);z.append(this.JKb());w&&0<w.length&&(z.append(this.KKb("RecentColors",ResourceStrings.L_RecentColors,"ColorPicker",!1,y)),z.append(this.SFf(w)),
z.append(this.JKb()));return z.toString()}SFf(r){const w=new Sys.StringBuilder;for(let y=0;y<r.length;y++){const z=r[y];w.append(String.format(l.QKb,"#"+z.hex,z.hex,"#"+z.hex))}return w.toString()}KKb(r,w,y,z,A){return String.format(l.Qff,r,w,y,z?'McuLayout = "true" ':"",A)}JKb(){return l.Pff}O$e(r){const w=Array(10);w[0]=this.Nv(e.Color.oh(this.Ek.PresetSchemeColorMapping.Background1));w[1]=this.Nv(e.Color.oh(this.Ek.PresetSchemeColorMapping.Text1));w[2]=this.Nv(e.Color.oh(this.Ek.PresetSchemeColorMapping.Background2));
w[3]=this.Nv(e.Color.oh(this.Ek.PresetSchemeColorMapping.Text2));w[4]=this.Nv(e.Color.oh(this.Ek.PresetSchemeColorMapping.Accent1));w[5]=this.Nv(e.Color.oh(this.Ek.PresetSchemeColorMapping.Accent2));w[6]=this.Nv(e.Color.oh(this.Ek.PresetSchemeColorMapping.Accent3));w[7]=this.Nv(e.Color.oh(this.Ek.PresetSchemeColorMapping.Accent4));w[8]=this.Nv(e.Color.oh(this.Ek.PresetSchemeColorMapping.Accent5));w[9]=this.Nv(e.Color.oh(this.Ek.PresetSchemeColorMapping.Accent6));const y=Array(10);y[0]=ResourceStrings.l_ThemeLabel1;
y[1]=ResourceStrings.l_ThemeLabel2;y[2]=ResourceStrings.l_ThemeLabel3;y[3]=ResourceStrings.l_ThemeLabel4;y[4]=ResourceStrings.l_ThemeLabel5;y[5]=ResourceStrings.l_ThemeLabel6;y[6]=ResourceStrings.l_ThemeLabel7;y[7]=ResourceStrings.l_ThemeLabel8;y[8]=ResourceStrings.l_ThemeLabel9;y[9]=ResourceStrings.l_ThemeLabel10;for(let z=0;5>=z;z++)for(let A=0;A<w.length;A++)r.append(this.Dzf(w[A][z],w[A][0],y[A],z,A))}Nv(r){const w=b.a.Fw(r.r,2)+b.a.Fw(r.g,2)+b.a.Fw(r.b,2);if(this.vVb[w])return this.vVb[w];const y=
m.HSLColor.Qwa(r),z=[];Array.add(z,r);if(r.f7c())for(var A=0;A<f.a.xve.length;++A)r=m.HSLColor.cTa(y),r.darken(f.a.xve[A]/100),Array.add(z,r.d8());else if(r.Jfh())for(A=0;A<f.a.Lvd.length;++A)r=m.HSLColor.cTa(y),r.lighten(f.a.Lvd[A]/100),Array.add(z,r.d8());else if(y.lum<l.Gff)for(A=0;A<f.a.HWd.length;++A)r=m.HSLColor.cTa(y),r.lighten(f.a.HWd[A]/100),Array.add(z,r.d8());else if(y.lum>l.Fff)for(A=0;A<f.a.GWd.length;++A)r=m.HSLColor.cTa(y),r.darken(f.a.GWd[A]/100),Array.add(z,r.d8());else for(A=0;A<
f.a.Xgb.length+f.a.myd.length;++A)r=m.HSLColor.cTa(y),A<f.a.Xgb.length?r.lighten(f.a.Xgb[A]/100):r.darken(f.a.myd[A-f.a.Xgb.length]/100),Array.add(z,r.d8());return this.vVb[w]=z}Dzf(r,w,y,z,A){r=this.m8b(r.Iqa);const {J9a:B,Uta:H}=this.kPb(w,r,y,z,A);return String.format(l.QKb,B,r,H)}kPb(r,w,y,z,A){var B;var H=B=null;if(0>z)return{J9a:B,Uta:H};w=Object.assign(new h.a,{RGBColor:w,ThemeColor:A,ColorLuminance:0,FTintColor:!1});z?(A=m.HSLColor.Qwa(r),H=z-1,A.lum?1===A.lum?(z=!1,H=[242,217,191,166,127][H]):
.8<A.lum?(z=!1,H=[229,191,127,64,25][H]):.2>A.lum?(z=!0,H=[25,64,127,191,229][H]):(A=[51,102,153],B=[191,127],H=(z=H<A.length)?A[H]:B[H-A.length]):(z=!0,H=[127,166,191,217,242][H]),H=255-H,H=Math.round(100*H/255),w.ColorLuminance=100-H,w.FTintColor=z,H=String.format(z?ResourceStrings.l_ColorPickerTooltipTint:ResourceStrings.l_ColorPickerTooltipShade,r.toString(),y,H)):H=String.format(ResourceStrings.l_ColorPickerTooltipBase,r.toString(),y);B=this.LUa(w);return{J9a:B,Uta:H}}}l.Qff='<MenuSection Id="{0}" Title="{1}"><Controls Id="Color.Menu.Controls"><ColorPicker Id="{2}" {3}Width="10" Command="{4}"><Colors>';
l.Pff="</Colors></ColorPicker></Controls></MenuSection>";l.QKb='<Color Color="{0}" DisplayColor="#{1}" Alt="{2}" />';l.Gff=.2;l.Fff=.8;Object(x.a)(l,"ColorPickerBuilder",null,[])},638:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(x.a)(c,"HeaderButtonInfo",null,[])},647:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.open="open";c.refresh="refresh";c.nOg="saveAs";c.translate="translate";
c.modeSwitch="modeSwitch";c.Joi="createNew";c.convert="convert";Object(x.a)(c,"ReasonList",null,[])},649:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}Object(x.a)(c,"RibbonPeripheralSection",null,[])},664:function(x,G,a){a.d(G,"a",function(){return b});x=a(0);var c=a(1233);class b{constructor(f){this.Bm=new c.a;this.rbd=f}w$(f){const e=f.id;let h=null;this.Bm.Ob(e)?h=this.Bm.ha(e):(this.rbd&&(h=this.rbd(f,()=>{this.QJg(e)})),h&&this.Bm.K(e,h));return h}k5(f){f=f.id;return this.Bm.Ob(f)?
this.Bm.ha(f):null}QJg(f){this.Bm.remove(f)}}Object(x.a)(b,"ShapeComponentViewManager",null,[738])},812:function(x,G,a){a.d(G,"a",function(){return b});a.d(G,"b",function(){return e});var c=a(87);a(219);const b=u=>f(u),f=u=>new Promise((m,n)=>{u.continueWith(l=>{l.vm?n(l.oj.message):l.In?n(c.a.d6c()):m(null)})}),e=u=>h(u),h=u=>new Promise((m,n)=>{u.continueWith(()=>{u.vm?n(u.oj.message):u.In?n(c.a.d6c()):m(u.result)})})},820:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{constructor(){this.message=
this.title=null;this.Q8c=!1;this.sbb=null;this.R8c=!1;this.gec=null;this.XOg=this.BFg=0;this.ZOg=this.CFg=null;this.timeoutInSeconds=0;this.GLf=!1;this.Nsa=null}}Object(x.a)(c,"CalloutNotificationMessageAttributes",null,[])},845:function(x,G,a){a.d(G,"a",function(){return h});x=a(0);var c=a(4),b=a(601),f=a(362);class e extends b.a{constructor(u,m){super(u);this.Q_f=m}vfd(u){return f.i(f.g(u))}m8b(u){return f.i(u)}LUa(u){return this.Q_f?u.Bze:u.LUa().toString()}kch(u,m,n){const l=new Sys.StringBuilder;
l.append(String.format('<Menu Id="{0}">',"menuFontColor"));l.append(this.Mxc(u,m,n));l.append('<MenuSection Id="More Font Colors"><Controls Id="Color.Menu.Controls">');l.append(String.format('<Button Id="Color.Menu.MoreFontColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />',"862825906",c.AFrameworkApplication.jp,ResourceStrings.l_MoreFontColors,ResourceStrings.l_MoreFontColorsKeytip));l.append("</Controls> </MenuSection>");l.append("</Menu>");
return l.toString()}}Object(x.a)(e,"ColorMenuBuilder",b.a,[]);class h{eBf(u){return new b.a(u)}PGd(u,m){return new e(u,m)}}Object(x.a)(h,"ColorPickerBuilderFactory",null,[823])},884:function(x,G,a){a.d(G,"a",function(){return c});x=a(0);class c{}c.IsFreeForm="IsFreeForm";c.Value="Value";c.Key="Key";c.FontStyle="FontStyle";Object(x.a)(c,"ComboBoxCommandProperties",null,[])},885:function(x,G,a){a.d(G,"a",function(){return n});x=a(0);var c=a(447),b=a(4),f=a(483),e=a(71),h=a(22),u=a(26),m=a(428);class n{static Lbb(l){const {m_g:r,
n_g:w}=n.Ywf();n.COg(r,w,l)}static Ywf(){({C$a:r}=f.a.jcb(!b.AFrameworkApplication.QV));var l=$get(c.a.uDe);if(r)var r=document.getElementById(c.a.nac);else r=l.childNodes[0],l=l.childNodes[1];return{m_g:r,n_g:l}}static COg(l,r,w){if(l&&r&&0<r.clientHeight){const y=-1!==r.parentNode.parentNode.className.indexOf("cui-ribbon");n.ced(l,r,w,y)}}static ced(l,r,w,y){let z=null,A=null,B=null,H=null,v=null,C=null,F=null,D=null,N=null,U=null,W=null,L=null,O=null,M=null,K=null,P=null,V=null,Y=null,ta=null,
fa=null;({T6c:z,S6c:A,U6c:B,ZDa:H,$Da:v,xsa:C,VM:F,Nt:D,ysa:N,MK:U,zsa:W,V6c:fa}=n.k7c(l,z,A,B,H,v,C,F,D,N,U,W,fa));({T9a:L,VC:O,R6c:M,P6c:K,aEa:P,XSa:V,YSa:Y,Q6c:ta}=n.l7c(r,L,O,M,K,P,V,Y,ta));l=[z,A,B,H,v,C,F,D,N,U,W,M,K,P,V,Y,ta,fa];for(var Ta of l)n.AUg(Ta);Ta=[z,A,B,v,F,D,U,W,K,V,Y,ta];for(const ha of Ta)n.K8b(ha);n.Jke(A);n.qed(O,0);n.nuf(z,A,B,H,v,C,F,D,N,U,W,L,O,M,K,P,V,Y,ta,fa,y,w);n.Paf(C,F)}static tvh(l,r){n.ced(l,null,r,!1)}static Paf(l,r){l&&r&&(l.style.marginTop=(r.offsetHeight-l.offsetHeight)/
2+"px")}static k7c(l,r,w,y,z,A,B,H,v,C,F,D,N){for(let U=0;l&&U<l.childNodes.length;U++){const W=l.childNodes[U],L=h.a.sna(W),O=!!W.id;-1!==L.indexOf("cui-QATRowLeft")?r=W:-1!==L.indexOf("cui-QATRowCenter")?w=W:-1!==L.indexOf("cui-QATRowRight")?y=W:-1!==L.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?z=W:W.id===c.a.w$b?A=W:W.id===c.a.s7c?B=W:W.id===c.a.x$b?H=W:W.id===c.a.y$b?v=W:O&&n.iRf(W)?C=W:-1!==L.indexOf("UsernameNameContainer")?F=W:-1!==L.indexOf("UsernameNameItem")?D=W:-1!==L.indexOf("FreemiumUpsellButton")&&
(N=W);({T6c:r,S6c:w,U6c:y,ZDa:z,$Da:A,xsa:B,VM:H,Nt:v,ysa:C,MK:F,zsa:D,V6c:N}=n.k7c(W,r,w,y,z,A,B,H,v,C,F,D,N))}return{T6c:r,S6c:w,U6c:y,ZDa:z,$Da:A,xsa:B,VM:H,Nt:v,ysa:C,MK:F,zsa:D,V6c:N}}static l7c(l,r,w,y,z,A,B,H,v){for(let C=0;l&&C<l.childNodes.length;C++){const F=l.childNodes[C],D=h.a.sna(F),N=!!F.id;-1!==D.indexOf("cui-jewel-container")?r=F:-1!==D.indexOf("cui-tts")?w=F:-1!==D.indexOf("cui-TabRowInline")?z=F:-1!==D.indexOf("cui-TabRowRight")?v=F:-1!==D.indexOf("cui-separator")?y=F:N&&F.id.startsWith(c.a.icd)&&
!A?A=F:N&&F.id.startsWith(c.a.g7c)?B=F:N&&F.id.startsWith(c.a.iCb)&&(H=F);({T9a:r,VC:w,R6c:y,P6c:z,aEa:A,XSa:B,YSa:H,Q6c:v}=n.l7c(F,r,w,y,z,A,B,H,v))}return{T9a:r,VC:w,R6c:y,P6c:z,aEa:A,XSa:B,YSa:H,Q6c:v}}static BOg(l,r,w,y,z,A,B,H,v){n.wy(l,r,v)&&(n.D$a(r),n.wy(l,r,v)&&n.D$a(r));n.wy(r,y,v)&&(n.Qv(w),n.Qv(z),n.wy(r,y,v)&&(n.D$a(r),n.wy(r,y,v)&&(n.D$a(r),n.wy(r,y,v)&&n.Qv(y))));n.wy(y,H,v)&&(n.Qv(w),n.Qv(z));l=[A,B,H];n.U8c(y,H,l,v);n.U8c(r,H,l,v)}static U8c(l,r,w,y){let z=0;for(;z<w.length&&n.wy(l,
r,y);)n.Qv(w[z]),z++}static nGf(l){if(!l)return 0;if(void 0===l._scaleStep||null===l._scaleStep){let r=0;-1!==l.className.indexOf("cui-tts-scale1")?r=1:-1!==l.className.indexOf("cui-tts-scale2")&&(r=2);l._scaleStep=r}return parseInt(l._scaleStep)}static D$a(l){let r=n.nGf(l);2>r&&n.qed(l,++r)}static qed(l,r){l&&(l.className=n.kNg[r],l._scaleStep=r)}static wy(l,r,w){return l&&r?u.a.mXf(u.a.Ni(l),u.a.Ni(r),w):!1}static xta(l,r,w){let y=0;l&&r&&(y=u.a.HFe(u.a.Ni(l),u.a.Ni(r),w));return y}static oqc(l){for(let r=
0;l&&r<l.childNodes.length;r++)if(-1!==l.childNodes[r].className.indexOf("cui-cg"))return!0;return!1}static Lvc(l){let r=null;for(let w=l.childNodes.length-1;l&&0<=w;w--){const y=l.childNodes[w];if(-1===y.className.indexOf("cui-cg"))break;r=y}return r}static Vta(l,r,w){if(l&&!n.ol(l)){var y=e.a.zt(l);y=h.a.dD(y.paddingLeft)+h.a.dD(y.paddingRight);w=l.offsetWidth-w-y;let z=0;for(;r&&r!==l;)(y=e.a.zt(r))&&(z+=h.a.dD(y.paddingLeft)+h.a.dD(y.paddingRight)),r=r.parentNode;w=Math.max(w,75+z);l.style.width=
w+"px"}}static VLg(l,r,w){if(l&&r){let y=0,z=0;({left:y,top:z}=u.a.oCf(r,y,z));n.Ytg(l,w?y-l.offsetWidth:y+r.offsetWidth)}}static nuf(l,r,w,y,z,A,B,H,v,C,F,D,N,U,W,L,O,M,K,P,V,Y){V&&n.BOg(D,N,U,W,L,O,M,K,Y);n.oqc(N)?n.HOg(N,l,r,w,y,z,A,B,H,v,C,F,P,Y):n.GOg(l,r,w,y,z,A,B,H,v,C,F,P,Y)}static GOg(l,r,w,y,z,A,B,H,v,C,F,D,N){const U=!!z,W=!!B,L=!!H;let O=0;if((W||L)&&0<(O=n.xta(l,r,N))){let M=W;L&&(!W||H.offsetWidth>B.offsetWidth)&&(M=!1);n.Vta(M?B:H,M?B:H,M?O:2*O);W&&L&&0<(O=n.xta(l,r,N))&&n.Vta(M?B:
H,M?B:H,M?O:2*O)}if(W&&n.wy(B,r,N)||U&&n.wy(z,r,N))n.Qv(y),n.Qv(z),n.Qv(A),n.Qv(B),L&&(n.K8b(r),n.K8b(H));n.vdd(r,w,H,v,C,F,D,N);L&&n.z5c(H,l,w,N)}static HOg(l,r,w,y,z,A,B,H,v,C,F,D,N,U){const W=!!H,L=!!v,O=!!C,M=!!N,K=n.Lvc(l);0<(r=n.xta(r,K,U))&&(W&&n.Vta(H,H,r),!W||n.wy(H,K,U))&&(n.Qv(z),n.Qv(A),n.Qv(B),n.Qv(H));n.wy(l,w,U)&&n.VLg(w,l,U);n.vdd(w,y,v,C,F,D,N,U);0<(r=n.xta(l,y,U))&&(n.Vta(F,D,r),M&&n.wy(l,y,U)&&n.Qv(N),O&&n.wy(l,y,U)&&n.Qv(C));L&&!n.ol(w)&&n.z5c(v,l,y,U)}static vdd(l,r,w,y,z,A,B,
H){const v=!!w,C=!!y,F=!!z,D=!!B;let N=0;if((v||F)&&0<(N=n.xta(l,r,H))){const U=!!l&&"absolute"!==l.style.position;let W=v;F&&(!v||z.offsetWidth>w.offsetWidth)&&(W=!1);n.Vta(W?w:z,W?w:A,W&&U?2*N:N);v&&F?(0<(N=n.xta(l,z,H))&&(W=!W,n.Vta(W?w:z,W?w:A,W&&U?2*N:N)),n.wy(l,z,H)&&n.Qv(l)):v&&n.wy(l,r,H)&&n.Qv(l)}D&&n.wy(l,r,H)&&n.Qv(B);C&&n.wy(l,r,H)&&n.Qv(y)}static ol(l){if(!l)return!0;l=l._isHidden;return!(void 0===l||null===l||"0"===l)}static Qv(l){l&&!n.ol(l)&&(l.style.display="none",l._isHidden="1")}static AUg(l){l&&
n.ol(l)&&(l.style.display="",l._isHidden="0")}static K8b(l){l&&(l.style.width="auto",l.style.maxWidth="none")}static Ytg(l,r){l&&(l.style.position="absolute",l.style.left=r+"px")}static Jke(l){l&&(l.style.position="static",l.style.left="auto")}static z5c(l,r,w,y){if(l&&l.parentNode&&l.parentNode.parentNode){var z=n.yCg(l);"auto"!==l.parentNode.style.width&&(l.style.width=l.parentNode.offsetWidth-z+"px");var A=y?w:r;r=y?r:w;w=u.a.Ni(l.parentNode.parentNode);A=A?u.a.Ni(A):new Sys.UI.Bounds(w.x,0,0,
0);r=r?u.a.jEa(r):new Sys.UI.Point(w.x+w.width,0);"absolute"===l.parentNode.style.position?z=r.x-(A.x+A.width)-z-1:(w=u.a.Ni(l.nextSibling?l.parentNode:l),w=w.x+w.width/2,z=2*Math.min(w-(A.x+A.width),r.x-w)-z-1);l.style.maxWidth=z+"px"}}static yCg(l){var r=e.a.zt(l);r=r?h.a.dD(r.paddingLeft)+h.a.dD(r.paddingRight):0;var w=e.a.zt(l.parentNode);w=w?h.a.dD(w.paddingLeft)+h.a.dD(w.paddingRight):0;let y=0;for(;l.nextSibling;)l=l.nextSibling,y+=l.offsetWidth;return r+w+y}static iRf(l){return!!l.id&&(l.id.startsWith(c.a.yec)||
l.id.startsWith(m.CuiHelperStatic.Dta))}}n.kNg=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(x.a)(n,"RibbonTabScalingActor",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25391670/wdjs/ppteditDS.chronosslim.js.map